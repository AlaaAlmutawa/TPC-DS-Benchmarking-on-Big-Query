{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3270744c_1770_4fd1_994f_b51138ce60a8" }, "priority": "INTERACTIVE", "query": "-- start query 70 in stream 0 using template query70.tpl\nWITH results AS\n (SELECT sum(ss_net_profit) AS total_sum,\n s_state,\n s_county,\n 0 AS gstate,\n 0 AS g_county\n FROM store_sales ,\n date_dim d1 ,\n store\n WHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d1.d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n AND s_state IN\n (SELECT s_state\n FROM\n (SELECT s_state AS s_state,\n rank() OVER (PARTITION BY s_state\n ORDER BY sum(ss_net_profit) DESC) AS ranking\n FROM store_sales,\n store,\n date_dim\n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n GROUP BY s_state ) tmp1\n WHERE ranking <= 5)\n GROUP BY s_state,\n s_county),\n results_rollup AS\n (SELECT total_sum,\n s_state,\n s_county,\n 0 AS g_state,\n 0 AS g_county,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT sum(total_sum) AS total_sum,\n s_state,\n NULL AS s_county,\n 0 AS g_state,\n 1 AS g_county,\n 1 AS lochierarchy\n FROM results\n GROUP BY s_state\n UNION ALL SELECT sum(total_sum) AS total_sum,\n NULL AS s_state,\n NULL AS s_county,\n 1 AS g_state,\n 1 AS g_county,\n 2 AS lochierarchy\n FROM results)\nSELECT total_sum,\n s_state,\n s_county,\n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN g_county = 0 THEN s_state\n END\n ORDER BY total_sum DESC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN s_state\n END ,\n rank_within_parent\nLIMIT 100;\n-- end query 70 in stream 0 using template query70.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "hO2ENLlVMZnY74rfKXAPFg==", "id": "test-project-364309:europe-west1.query70_1665768440", "jobReference": { "jobId": "query70_1665768440", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query70_1665768440?location=europe-west1", "statistics": { "creationTime": "1665768440845", "endTime": "1665768442239", "finalExecutionDurationMs": "1161", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89176796", "performanceInsights": { "avgPreviousExecutionMs": "1264" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0625, "computeRatioMax": 0.0625, "endMs": "1665768441055", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.052083333333333336, "readRatioMax": 0.052083333333333336, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768441017", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_month_seq", "FROM date_dim", "WHERE between($171, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.057291666666666664, "computeRatioMax": 0.057291666666666664, "endMs": "1665768441069", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768441031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:s_store_sk, $161:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.11458333333333333, "writeRatioMax": 0.11458333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0625, "computeRatioMax": 0.0625, "endMs": "1665768441090", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.046875, "readRatioMax": 0.046875, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768441059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_month_seq", "FROM date_dim", "WHERE between($141, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07291666666666667, "writeRatioMax": 0.07291666666666667 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.041666666666666664, "endMs": "1665768441112", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.026041666666666668, "readRatioMax": 0.026041666666666668, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768441071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:s_store_sk, $131:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.09375, "writeRatioMax": 0.09375 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.06770833333333333, "computeRatioMax": 0.06770833333333333, "endMs": "1665768441138", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768441097", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_month_seq", "FROM date_dim", "WHERE between($111, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage06_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.14583333333333334, "writeRatioMax": 0.14583333333333334 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.046875, "computeRatioMax": 0.046875, "endMs": "1665768441153", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768441111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:s_store_sk, $101:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.08854166666666667, "writeRatioMax": 0.08854166666666667 }, { "completedParallelInputs": "6", "computeMsAvg": "129", "computeMsMax": "145", "computeRatioAvg": 0.671875, "computeRatioMax": 0.7552083333333334, "endMs": "1665768441257", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.0625, "readRatioMax": 0.08333333333333333, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "778", "startMs": "1665768441138", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ss_sold_date_sk, $151:ss_store_sk, $152:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1251", "$740 := SUM($1250)" ] }, { "kind": "JOIN", "substeps": [ "$1250 := $1241, $1251 := $1242", "INNER HASH JOIN EACH WITH ALL ON $1240 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $150, $1241 := $152, $1242 := $161", "INNER HASH JOIN EACH WITH ALL ON $151 = $160" ] }, { "kind": "WRITE", "substeps": [ "$1260, $740", "TO __stage09_output", "BY HASH($1260)" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.036458333333333336, "writeRatioMax": 0.046875 }, { "completedParallelInputs": "6", "computeMsAvg": "136", "computeMsMax": "192", "computeRatioAvg": 0.7083333333333334, "computeRatioMax": 1, "endMs": "1665768441289", "id": "10", "inputStages": [ "3", "4" ], "name": "S0A: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.052083333333333336, "readRatioMax": 0.0625, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "794", "startMs": "1665768441155", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ss_sold_date_sk, $121:ss_store_sk, $122:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1081", "$670 := SUM($1080)" ] }, { "kind": "JOIN", "substeps": [ "$1080 := $1071, $1081 := $1072", "INNER HASH JOIN EACH WITH ALL ON $1070 = $140" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $120, $1071 := $122, $1072 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$1090, $670", "TO __stage0A_output", "BY HASH($1090)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "8", "writeMsMax": "11", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.057291666666666664 }, { "completedParallelInputs": "6", "computeMsAvg": "139", "computeMsMax": "162", "computeRatioAvg": 0.7239583333333334, "computeRatioMax": 0.84375, "endMs": "1665768441298", "id": "11", "inputStages": [ "7", "6" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "17", "readRatioAvg": 0.0625, "readRatioMax": 0.08854166666666667, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "782", "startMs": "1665768441175", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_store_sk, $92:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $911", "$620 := SUM($910)" ] }, { "kind": "JOIN", "substeps": [ "$910 := $901, $911 := $902", "INNER HASH JOIN EACH WITH ALL ON $900 = $110" ] }, { "kind": "JOIN", "substeps": [ "$900 := $90, $901 := $92, $902 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$920, $620", "TO __stage0B_output", "BY HASH($920)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "8", "writeMsMax": "15", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.078125 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.09895833333333333, "computeRatioMax": 0.09895833333333333, "endMs": "1665768441316", "id": "12", "inputStages": [ "9" ], "name": "S0C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665768441275", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1260, $740", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1270 := $1260", "$600 := SUM($740)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $600", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010416666666666666, "waitRatioMax": 0.010416666666666666, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0625, "computeRatioMax": 0.0625, "endMs": "1665768441341", "id": "13", "inputStages": [ "10" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768441306", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1090, $670", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$530 := SUM($670)" ] }, { "kind": "WRITE", "substeps": [ "$1100, $530", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.078125, "writeRatioMax": 0.078125 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.036458333333333336, "computeRatioMax": 0.036458333333333336, "endMs": "1665768441382", "id": "14", "inputStages": [ "11" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768441322", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$920, $620", "FROM __stage0B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $930 := $920", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$930, $510", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "52", "writeMsMax": "52", "writeRatioAvg": 0.2708333333333333, "writeRatioMax": 0.2708333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03125, "computeRatioMax": 0.03125, "endMs": "1665768441374", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768441337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$860, $1330, $1331", "FROM __SHUFFLE16" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := coalesce($1340, '')", "$731 := coalesce($1340, '0')", "$732 := coalesce($1341, NUMERIC<...>)", "$733 := coalesce($1341, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1340 := $1330, $1341 := $1331", "$780 := MIN($860)" ] }, { "kind": "WRITE", "substeps": [ "$730, $731, $732, $733, $780", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.09895833333333333, "writeRatioMax": 0.09895833333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.036458333333333336, "computeRatioMax": 0.036458333333333336, "endMs": "1665768441400", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.015625, "readRatioMax": 0.015625, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665768441364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage11_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.08333333333333333, "writeRatioMax": 0.08333333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.08854166666666667, "computeRatioMax": 0.08854166666666667, "endMs": "1665768441416", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.06770833333333333, "readRatioMax": 0.06770833333333333, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768441381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.057291666666666664, "writeRatioMax": 0.057291666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.026041666666666668, "computeRatioMax": 0.026041666666666668, "endMs": "1665768441449", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768441413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$820, $1160, $1161", "FROM __SHUFFLE10" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := coalesce($1170, '')", "$591 := coalesce($1170, '0')", "$592 := coalesce($1171, NUMERIC<...>)", "$593 := coalesce($1171, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1170 := $1160, $1171 := $1161", "$710 := MIN($820)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $710", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.09895833333333333, "writeRatioMax": 0.09895833333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.036458333333333336, "computeRatioMax": 0.036458333333333336, "endMs": "1665768441483", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.020833333333333332, "readRatioMax": 0.020833333333333332, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768441442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.08333333333333333, "writeRatioMax": 0.08333333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.08333333333333333, "computeRatioMax": 0.08333333333333333, "endMs": "1665768441500", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.07291666666666667, "readRatioMax": 0.07291666666666667, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768441462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.08333333333333333, "endMs": "1665768441525", "id": "25", "inputStages": [ "15" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3242", "startMs": "1665768441474", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.015625, "waitRatioMax": 0.020833333333333332, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.07291666666666667, "writeRatioMax": 0.140625 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.046875, "computeRatioMax": 0.109375, "endMs": "1665768441535", "id": "26", "inputStages": [ "12", "25" ], "name": "S1A: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2898", "startMs": "1665768441490", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $600", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$760, $1310, $1311", "FROM __SHUFFLE15" ] }, { "kind": "READ", "substeps": [ "$730, $731, $732, $733, $780", "FROM __stage19_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($501, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$550 := RANK() OVER (PARTITION BY $1280 ORDER BY $1281 DESC)" ] }, { "kind": "SORT", "substeps": [ "$750 ASC, $751 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1350 := $770, $1351 := $780", "INNER HASH JOIN EACH WITH ALL ON $720 = $730, $721 = $731, $722 = $732, $723 = $733" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($770, '')", "$721 := coalesce($770, '0')", "$722 := coalesce($771, NUMERIC<...>)", "$723 := coalesce($771, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$500", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.015625, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.07291666666666667, "writeRatioMax": 0.08854166666666667 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03125, "computeRatioMax": 0.03125, "endMs": "1665768441535", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665768441503", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $990, $991", "FROM __SHUFFLE4" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := coalesce($1000, '')", "$571 := coalesce($1000, '0')", "$572 := coalesce($1001, NUMERIC<...>)", "$573 := coalesce($1001, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1000 := $990, $1001 := $991", "$660 := MIN($800)" ] }, { "kind": "WRITE", "substeps": [ "$570, $571, $572, $573, $660", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.08333333333333333, "writeRatioMax": 0.08333333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.036458333333333336, "computeRatioMax": 0.036458333333333336, "endMs": "1665768441567", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.020833333333333332, "readRatioMax": 0.020833333333333332, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "456", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768441526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_county, $3:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage1D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.09375, "writeRatioMax": 0.09375 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.046875, "computeRatioMax": 0.046875, "endMs": "1665768441595", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768441547", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.078125, "writeRatioMax": 0.078125 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.052083333333333336, "computeRatioMax": 0.10416666666666667, "endMs": "1665768441643", "id": "32", "inputStages": [ "20" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4700", "startMs": "1665768441563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.010416666666666666, "waitRatioMax": 0.020833333333333332, "writeMsAvg": "26", "writeMsMax": "33", "writeRatioAvg": 0.13541666666666666, "writeRatioMax": 0.171875 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.052083333333333336, "computeRatioMax": 0.10416666666666667, "endMs": "1665768441670", "id": "33", "inputStages": [ "32", "13" ], "name": "S21: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "5363", "startMs": "1665768441591", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1100, $530", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$690, $1140, $1141", "FROM __SHUFFLE9" ] }, { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $710", "FROM __stage20_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($461, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := RANK() OVER (PARTITION BY $1110 ORDER BY $1111 DESC)" ] }, { "kind": "SORT", "substeps": [ "$680 ASC, $681 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $700, $1181 := $710", "INNER HASH JOIN EACH WITH ALL ON $580 = $590, $581 = $591, $582 = $592, $583 = $593" ] }, { "kind": "COMPUTE", "substeps": [ "$580 := coalesce($700, '')", "$581 := coalesce($700, '0')", "$582 := coalesce($701, NUMERIC<...>)", "$583 := coalesce($701, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$460", "TO __stage21_output" ] } ], "waitMsAvg": "13", "waitMsMax": "18", "waitRatioAvg": 0.06770833333333333, "waitRatioMax": 0.09375, "writeMsAvg": "47", "writeMsMax": "59", "writeRatioAvg": 0.24479166666666666, "writeRatioMax": 0.3072916666666667 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.09375, "endMs": "1665768441725", "id": "34", "inputStages": [ "26" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3410", "startMs": "1665768441664", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.015625, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.07291666666666667, "writeRatioMax": 0.13541666666666666 }, { "completedParallelInputs": "6", "computeMsAvg": "124", "computeMsMax": "164", "computeRatioAvg": 0.6458333333333334, "computeRatioMax": 0.8541666666666666, "endMs": "1665768441815", "id": "35", "inputStages": [ "18", "34", "17" ], "name": "S23: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "14", "readRatioAvg": 0.052083333333333336, "readRatioMax": 0.07291666666666667, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "102", "shuffleOutputBytesSpilled": "0", "slotMs": "855", "startMs": "1665768441669", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_store_sk, $72:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$500", "FROM __stage22_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$420 := SUM($1360)" ] }, { "kind": "JOIN", "substeps": [ "$1360 := $1230", "SEMI HASH JOIN EACH WITH ALL ON $1231 = $500" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1221, $1231 := $41", "INNER HASH JOIN EACH WITH ALL ON $1220 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $71, $1221 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$420", "TO __stage23_output" ] } ], "waitMsAvg": "4", "waitMsMax": "7", "waitRatioAvg": 0.020833333333333332, "waitRatioMax": 0.036458333333333336, "writeMsAvg": "4", "writeMsMax": "7", "writeRatioAvg": 0.020833333333333332, "writeRatioMax": 0.036458333333333336 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.036458333333333336, "computeRatioMax": 0.036458333333333336, "endMs": "1665768441823", "id": "36", "inputStages": [ "35" ], "name": "S24: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665768441671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420", "FROM __stage23_output" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := NULL", "$351 := 1", "$352 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($420)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $360", "TO __stage24_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.03125, "waitRatioMax": 0.03125, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.005208333333333333, "writeRatioMax": 0.005208333333333333 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.10416666666666667, "endMs": "1665768441743", "id": "37", "inputStages": [ "27" ], "name": "S25: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4638", "startMs": "1665768441670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.026041666666666668, "waitRatioMax": 0.03125, "writeMsAvg": "37", "writeMsMax": "57", "writeRatioAvg": 0.19270833333333334, "writeRatioMax": 0.296875 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.052083333333333336, "computeRatioMax": 0.10416666666666667, "endMs": "1665768441731", "id": "38", "inputStages": [ "14", "37" ], "name": "S26: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3469", "startMs": "1665768441684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$930, $510", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$640, $970, $971", "FROM __SHUFFLE3" ] }, { "kind": "READ", "substeps": [ "$570, $571, $572, $573, $660", "FROM __stage25_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($441, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$470 := RANK() OVER (PARTITION BY $940 ORDER BY $941 DESC)" ] }, { "kind": "SORT", "substeps": [ "$630 ASC, $631 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $650, $1011 := $660", "INNER HASH JOIN EACH WITH ALL ON $560 = $570, $561 = $571, $562 = $572, $563 = $573" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($650, '')", "$561 := coalesce($650, '0')", "$562 := coalesce($651, NUMERIC<...>)", "$563 := coalesce($651, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$440", "TO __stage26_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.010416666666666666, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.09375, "writeRatioMax": 0.15104166666666666 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.046875, "computeRatioMax": 0.09375, "endMs": "1665768441752", "id": "39", "inputStages": [ "33" ], "name": "S27: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3330", "startMs": "1665768441694", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.010416666666666666, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.078125, "writeRatioMax": 0.15104166666666666 }, { "completedParallelInputs": "6", "computeMsAvg": "137", "computeMsMax": "172", "computeRatioAvg": 0.7135416666666666, "computeRatioMax": 0.8958333333333334, "endMs": "1665768441864", "id": "40", "inputStages": [ "23", "22", "39" ], "name": "S28: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.06770833333333333, "readRatioMax": 0.08333333333333333, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "861", "startMs": "1665768441710", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$460", "FROM __stage27_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$400 := SUM($1191)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1061, $1191 := $1060", "SEMI HASH JOIN EACH WITH ALL ON $1061 = $460" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $1051, $1061 := $11", "INNER HASH JOIN EACH WITH ALL ON $1050 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $31, $1051 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$1200, $400", "TO __stage28_output", "BY HASH($1200)" ] } ], "waitMsAvg": "0", "waitMsMax": "3", "waitRatioAvg": 0, "waitRatioMax": 0.015625, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.03125, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.08854166666666667, "endMs": "1665768441797", "id": "41", "inputStages": [ "38" ], "name": "S29: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3679", "startMs": "1665768441735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage26_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.015625, "waitRatioMax": 0.020833333333333332, "writeMsAvg": "27", "writeMsMax": "53", "writeRatioAvg": 0.140625, "writeRatioMax": 0.2760416666666667 }, { "completedParallelInputs": "6", "computeMsAvg": "139", "computeMsMax": "163", "computeRatioAvg": 0.7239583333333334, "computeRatioMax": 0.8489583333333334, "endMs": "1665768441920", "id": "42", "inputStages": [ "30", "29", "41" ], "name": "S2A: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.07291666666666667, "readRatioMax": 0.09895833333333333, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "276", "shuffleOutputBytesSpilled": "0", "slotMs": "946", "startMs": "1665768441748", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_store_sk, $22:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$440", "FROM __stage29_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1021, $1031 := $1020", "$390 := SUM($1022)" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $891, $1021 := $892, $1022 := $890", "SEMI HASH JOIN EACH WITH ALL ON $892 = $440" ] }, { "kind": "JOIN", "substeps": [ "$890 := $881, $891 := $2, $892 := $3", "INNER HASH JOIN EACH WITH ALL ON $880 = $1" ] }, { "kind": "JOIN", "substeps": [ "$880 := $21, $881 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1031, $1030, $390", "TO __stage2A_output", "BY HASH($1030, $1031)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.015625, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.046875 }, { "completedParallelInputs": "43", "computeMsAvg": "10", "computeMsMax": "16", "computeRatioAvg": 0.052083333333333336, "computeRatioMax": 0.08333333333333333, "endMs": "1665768442008", "id": "43", "inputStages": [ "36", "40", "42" ], "name": "S2B: Aggregate+", "parallelInputs": "43", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13", "recordsWritten": "3", "shuffleOutputBytes": "126", "shuffleOutputBytesSpilled": "0", "slotMs": "1536", "startMs": "1665768441954", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1031, $1030, $390", "FROM __stage2A_output" ] }, { "kind": "READ", "substeps": [ "$1200, $400", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $360", "FROM __stage24_output" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := case_no_value(equal($243, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030, $1041 := $1031", "$330 := SUM($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := NULL", "$281 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200", "$340 := SUM($400)" ] }, { "kind": "WRITE", "substeps": [ "$220, $240, $241, $242, $244", "TO __stage2B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.010416666666666666, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.078125, "writeRatioMax": 0.109375 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.026041666666666668, "computeRatioMax": 0.026041666666666668, "endMs": "1665768442062", "id": "44", "name": "S2C: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768442029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $1431, $1432, $1430", "FROM __SHUFFLE20" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := coalesce($1440, 0)", "$261 := coalesce($1440, 1)", "$262 := coalesce($1441, '')", "$263 := coalesce($1441, '0')", "$264 := coalesce($1442, NUMERIC<...>)", "$265 := coalesce($1442, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1440 := $1430, $1441 := $1431, $1442 := $1432", "$320 := MIN($380)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "TO __stage2C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.08854166666666667, "writeRatioMax": 0.08854166666666667 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.08333333333333333, "endMs": "1665768442120", "id": "46", "inputStages": [ "44" ], "name": "S2E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3071", "startMs": "1665768442073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage2C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.010416666666666666, "waitRatioMax": 0.015625, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.07291666666666667, "writeRatioMax": 0.10416666666666667 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.046875, "computeRatioMax": 0.09375, "endMs": "1665768442122", "id": "47", "inputStages": [ "46", "43" ], "name": "S2F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "153", "shuffleOutputBytesSpilled": "0", "slotMs": "3240", "startMs": "1665768442078", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $240, $241, $242, $244", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$300, $1400, $1401, $1402, $1403, $1404", "FROM __SHUFFLE19" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "FROM __stage2E_output" ] }, { "kind": "SORT", "substeps": [ "$204 DESC, $180 ASC, $200 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := case_no_value(equal($204, 0), $202, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1374, $1370 ORDER BY $1371 DESC)" ] }, { "kind": "SORT", "substeps": [ "$294 ASC, $290 ASC, $291 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1450 := $311, $1451 := $312, $1452 := $313, $1453 := $314, $1454 := $320", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261, $252 = $262, $253 = $263, $254 = $264, $255 = $265" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := coalesce($314, 0)", "$251 := coalesce($314, 1)", "$252 := coalesce($310, '')", "$253 := coalesce($310, '0')", "$254 := coalesce($311, NUMERIC<...>)", "$255 := coalesce($311, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "TO __stage2F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.020833333333333332, "waitRatioMax": 0.026041666666666668, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.07291666666666667, "writeRatioMax": 0.10416666666666667 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.046875, "computeRatioMax": 0.046875, "endMs": "1665768442135", "id": "48", "inputStages": [ "47" ], "name": "S30: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665768442088", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "FROM __stage2F_output" ] }, { "kind": "SORT", "substeps": [ "$1465 DESC, $1460 ASC, $1461 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1470, $1471, $1472, $1473, $1474", "TO __stage30_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.015625, "waitRatioMax": 0.015625, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.020833333333333332, "writeRatioMax": 0.020833333333333332 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "116", "completedUnits": "128", "elapsedMs": "619", "estimatedRunnableUnits": "0", "pendingUnits": "122", "totalSlotMs": "6166" }, { "activeUnits": "93", "completedUnits": "1204", "elapsedMs": "1288", "estimatedRunnableUnits": "1", "pendingUnits": "0", "totalSlotMs": "48307" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89176796", "totalPartitionsProcessed": "0", "totalSlotMs": "48307", "transferredBytes": "0" }, "startTime": "1665768440901", "totalBytesProcessed": "89176796", "totalSlotMs": "48307" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon65f1c73a_2861_4337_9556_53e5c1304ad2" }, "priority": "INTERACTIVE", "query": "-- start query 70 in stream 0 using template query70.tpl\nWITH results AS\n (SELECT sum(ss_net_profit) AS total_sum,\n s_state,\n s_county,\n 0 AS gstate,\n 0 AS g_county\n FROM store_sales ,\n date_dim d1 ,\n store\n WHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d1.d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n AND s_state IN\n (SELECT s_state\n FROM\n (SELECT s_state AS s_state,\n rank() OVER (PARTITION BY s_state\n ORDER BY sum(ss_net_profit) DESC) AS ranking\n FROM store_sales,\n store,\n date_dim\n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n GROUP BY s_state ) tmp1\n WHERE ranking <= 5)\n GROUP BY s_state,\n s_county),\n results_rollup AS\n (SELECT total_sum,\n s_state,\n s_county,\n 0 AS g_state,\n 0 AS g_county,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT sum(total_sum) AS total_sum,\n s_state,\n NULL AS s_county,\n 0 AS g_state,\n 1 AS g_county,\n 1 AS lochierarchy\n FROM results\n GROUP BY s_state\n UNION ALL SELECT sum(total_sum) AS total_sum,\n NULL AS s_state,\n NULL AS s_county,\n 1 AS g_state,\n 1 AS g_county,\n 2 AS lochierarchy\n FROM results)\nSELECT total_sum,\n s_state,\n s_county,\n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN g_county = 0 THEN s_state\n END\n ORDER BY total_sum DESC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN s_state\n END ,\n rank_within_parent\nLIMIT 100;\n-- end query 70 in stream 0 using template query70.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "pM3xfezazzFnOnIOPtfPjQ==", "id": "test-project-364309:europe-west1.query70_1665778429", "jobReference": { "jobId": "query70_1665778429", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query70_1665778429?location=europe-west1", "statistics": { "creationTime": "1665778429971", "endTime": "1665778431521", "finalExecutionDurationMs": "1255", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89176796", "performanceInsights": { "avgPreviousExecutionMs": "1249" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.046218487394957986, "computeRatioMax": 0.046218487394957986, "endMs": "1665778430201", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02100840336134454, "readRatioMax": 0.02100840336134454, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778430158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_month_seq", "FROM date_dim", "WHERE between($171, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03361344537815126, "computeRatioMax": 0.03361344537815126, "endMs": "1665778430214", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01680672268907563, "readRatioMax": 0.01680672268907563, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778430174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:s_store_sk, $161:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04201680672268908, "computeRatioMax": 0.04201680672268908, "endMs": "1665778430253", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02100840336134454, "readRatioMax": 0.02100840336134454, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778430215", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_month_seq", "FROM date_dim", "WHERE between($141, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage03_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.046218487394957986, "waitRatioMax": 0.046218487394957986, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06302521008403361, "writeRatioMax": 0.06302521008403361 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.02100840336134454, "computeRatioMax": 0.02100840336134454, "endMs": "1665778430288", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.012605042016806723, "readRatioMax": 0.012605042016806723, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778430254", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:s_store_sk, $131:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage04_output" ] } ], "waitMsAvg": "36", "waitMsMax": "36", "waitRatioAvg": 0.15126050420168066, "waitRatioMax": 0.15126050420168066, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06302521008403361, "writeRatioMax": 0.06302521008403361 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.037815126050420166, "computeRatioMax": 0.037815126050420166, "endMs": "1665778430323", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03361344537815126, "readRatioMax": 0.03361344537815126, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778430280", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_month_seq", "FROM date_dim", "WHERE between($111, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage06_output" ] } ], "waitMsAvg": "33", "waitMsMax": "33", "waitRatioAvg": 0.13865546218487396, "waitRatioMax": 0.13865546218487396, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06722689075630252, "writeRatioMax": 0.06722689075630252 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.029411764705882353, "endMs": "1665778430310", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02100840336134454, "readRatioMax": 0.02100840336134454, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778430280", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:s_store_sk, $101:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage07_output" ] } ], "waitMsAvg": "19", "waitMsMax": "19", "waitRatioAvg": 0.07983193277310924, "waitRatioMax": 0.07983193277310924, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07563025210084033, "writeRatioMax": 0.07563025210084033 }, { "completedParallelInputs": "6", "computeMsAvg": "145", "computeMsMax": "220", "computeRatioAvg": 0.6092436974789915, "computeRatioMax": 0.9243697478991597, "endMs": "1665778430422", "id": "9", "inputStages": [ "1", "0" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "13", "readRatioAvg": 0.046218487394957986, "readRatioMax": 0.0546218487394958, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "812", "startMs": "1665778430292", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ss_sold_date_sk, $151:ss_store_sk, $152:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1251", "$740 := SUM($1250)" ] }, { "kind": "JOIN", "substeps": [ "$1250 := $1241, $1251 := $1242", "INNER HASH JOIN EACH WITH ALL ON $1240 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $150, $1241 := $152, $1242 := $161", "INNER HASH JOIN EACH WITH ALL ON $151 = $160" ] }, { "kind": "WRITE", "substeps": [ "$1260, $740", "TO __stage09_output", "BY HASH($1260)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.025210084033613446, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "6", "computeMsAvg": "152", "computeMsMax": "202", "computeRatioAvg": 0.6386554621848739, "computeRatioMax": 0.8487394957983193, "endMs": "1665778430451", "id": "10", "inputStages": [ "3", "4" ], "name": "S0A: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.05042016806722689, "readRatioMax": 0.06302521008403361, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "890", "startMs": "1665778430321", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ss_sold_date_sk, $121:ss_store_sk, $122:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1081", "$670 := SUM($1080)" ] }, { "kind": "JOIN", "substeps": [ "$1080 := $1071, $1081 := $1072", "INNER HASH JOIN EACH WITH ALL ON $1070 = $140" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $120, $1071 := $122, $1072 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$1090, $670", "TO __stage0A_output", "BY HASH($1090)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.025210084033613446, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "6", "computeMsAvg": "157", "computeMsMax": "238", "computeRatioAvg": 0.6596638655462185, "computeRatioMax": 1, "endMs": "1665778430497", "id": "12", "inputStages": [ "6", "7" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "20", "readRatioAvg": 0.0546218487394958, "readRatioMax": 0.08403361344537816, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "898", "startMs": "1665778430352", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_store_sk, $92:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $911", "$620 := SUM($910)" ] }, { "kind": "JOIN", "substeps": [ "$910 := $901, $911 := $902", "INNER HASH JOIN EACH WITH ALL ON $900 = $110" ] }, { "kind": "JOIN", "substeps": [ "$900 := $90, $901 := $92, $902 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$920, $620", "TO __stage0C_output", "BY HASH($920)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.04201680672268908 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.029411764705882353, "endMs": "1665778430477", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778430443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1260, $740", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1270 := $1260", "$600 := SUM($740)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $600", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.1092436974789916, "writeRatioMax": 0.1092436974789916 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.02100840336134454, "computeRatioMax": 0.02100840336134454, "endMs": "1665778430517", "id": "14", "inputStages": [ "10" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778430482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1090, $670", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$530 := SUM($670)" ] }, { "kind": "WRITE", "substeps": [ "$1100, $530", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06722689075630252, "writeRatioMax": 0.06722689075630252 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.025210084033613446, "computeRatioMax": 0.025210084033613446, "endMs": "1665778430547", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778430513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$860, $1330, $1331", "FROM __SHUFFLE16" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := coalesce($1340, '')", "$731 := coalesce($1340, '0')", "$732 := coalesce($1341, NUMERIC<...>)", "$733 := coalesce($1341, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1340 := $1330, $1341 := $1331", "$780 := MIN($860)" ] }, { "kind": "WRITE", "substeps": [ "$730, $731, $732, $733, $780", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07563025210084033, "writeRatioMax": 0.07563025210084033 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03361344537815126, "computeRatioMax": 0.03361344537815126, "endMs": "1665778430584", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03361344537815126, "readRatioMax": 0.03361344537815126, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778430546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.09243697478991597, "writeRatioMax": 0.09243697478991597 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.037815126050420166, "computeRatioMax": 0.037815126050420166, "endMs": "1665778430602", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.05042016806722689, "readRatioMax": 0.05042016806722689, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778430563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04201680672268908, "computeRatioMax": 0.04201680672268908, "endMs": "1665778430631", "id": "20", "inputStages": [ "12" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778430593", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$920, $620", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $930 := $920", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$930, $510", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06302521008403361, "writeRatioMax": 0.06302521008403361 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05042016806722689, "computeRatioMax": 0.05042016806722689, "endMs": "1665778430640", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778430612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$820, $1160, $1161", "FROM __SHUFFLE10" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := coalesce($1170, '')", "$591 := coalesce($1170, '0')", "$592 := coalesce($1171, NUMERIC<...>)", "$593 := coalesce($1171, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1170 := $1160, $1171 := $1161", "$710 := MIN($820)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $710", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.008403361344537815, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.07983193277310924, "writeRatioMax": 0.07983193277310924 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.02100840336134454, "computeRatioMax": 0.02100840336134454, "endMs": "1665778430678", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01680672268907563, "readRatioMax": 0.01680672268907563, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778430639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06722689075630252, "writeRatioMax": 0.06722689075630252 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03361344537815126, "computeRatioMax": 0.03361344537815126, "endMs": "1665778430698", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.029411764705882353, "readRatioMax": 0.029411764705882353, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778430657", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0546218487394958, "writeRatioMax": 0.0546218487394958 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.06722689075630252, "endMs": "1665778430730", "id": "26", "inputStages": [ "15" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3361", "startMs": "1665778430671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.012605042016806723, "waitRatioMax": 0.01680672268907563, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.10504201680672269 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.03361344537815126, "computeRatioMax": 0.07563025210084033, "endMs": "1665778430731", "id": "27", "inputStages": [ "13", "26" ], "name": "S1B: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2935", "startMs": "1665778430691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $600", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$760, $1310, $1311", "FROM __SHUFFLE15" ] }, { "kind": "READ", "substeps": [ "$730, $731, $732, $733, $780", "FROM __stage1A_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($501, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$550 := RANK() OVER (PARTITION BY $1280 ORDER BY $1281 DESC)" ] }, { "kind": "SORT", "substeps": [ "$750 ASC, $751 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1350 := $770, $1351 := $780", "INNER HASH JOIN EACH WITH ALL ON $720 = $730, $721 = $731, $722 = $732, $723 = $733" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($770, '')", "$721 := coalesce($770, '0')", "$722 := coalesce($771, NUMERIC<...>)", "$723 := coalesce($771, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$500", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.01680672268907563, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.0546218487394958, "writeRatioMax": 0.07983193277310924 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.037815126050420166, "computeRatioMax": 0.037815126050420166, "endMs": "1665778430748", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778430712", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $990, $991", "FROM __SHUFFLE4" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := coalesce($1000, '')", "$571 := coalesce($1000, '0')", "$572 := coalesce($1001, NUMERIC<...>)", "$573 := coalesce($1001, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1000 := $990, $1001 := $991", "$660 := MIN($800)" ] }, { "kind": "WRITE", "substeps": [ "$570, $571, $572, $573, $660", "TO __stage1C_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07563025210084033, "writeRatioMax": 0.07563025210084033 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.029411764705882353, "endMs": "1665778430784", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01680672268907563, "readRatioMax": 0.01680672268907563, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "456", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778430742", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_county, $3:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06722689075630252, "writeRatioMax": 0.06722689075630252 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0546218487394958, "computeRatioMax": 0.0546218487394958, "endMs": "1665778430801", "id": "31", "name": "S1F: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.029411764705882353, "readRatioMax": 0.029411764705882353, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778430759", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.058823529411764705, "endMs": "1665778430843", "id": "33", "inputStages": [ "21" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3633", "startMs": "1665778430774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.025210084033613446, "waitRatioMax": 0.03361344537815126, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.08403361344537816, "writeRatioMax": 0.13025210084033614 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.037815126050420166, "computeRatioMax": 0.07142857142857142, "endMs": "1665778430853", "id": "34", "inputStages": [ "33", "14" ], "name": "S22: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3346", "startMs": "1665778430795", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1100, $530", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$690, $1140, $1141", "FROM __SHUFFLE9" ] }, { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $710", "FROM __stage21_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($461, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := RANK() OVER (PARTITION BY $1110 ORDER BY $1111 DESC)" ] }, { "kind": "SORT", "substeps": [ "$680 ASC, $681 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $700, $1181 := $710", "INNER HASH JOIN EACH WITH ALL ON $580 = $590, $581 = $591, $582 = $592, $583 = $593" ] }, { "kind": "COMPUTE", "substeps": [ "$580 := coalesce($700, '')", "$581 := coalesce($700, '0')", "$582 := coalesce($701, NUMERIC<...>)", "$583 := coalesce($701, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$460", "TO __stage22_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.012605042016806723, "waitRatioMax": 0.02100840336134454, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.08403361344537816 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.06722689075630252, "endMs": "1665778430890", "id": "35", "inputStages": [ "27" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3323", "startMs": "1665778430832", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.01680672268907563, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.08403361344537816, "writeRatioMax": 0.13025210084033614 }, { "completedParallelInputs": "6", "computeMsAvg": "111", "computeMsMax": "152", "computeRatioAvg": 0.46638655462184875, "computeRatioMax": 0.6386554621848739, "endMs": "1665778430989", "id": "36", "inputStages": [ "18", "35", "17" ], "name": "S24: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.046218487394957986, "readRatioMax": 0.058823529411764705, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "102", "shuffleOutputBytesSpilled": "0", "slotMs": "770", "startMs": "1665778430841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_store_sk, $72:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$500", "FROM __stage23_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$420 := SUM($1360)" ] }, { "kind": "JOIN", "substeps": [ "$1360 := $1230", "SEMI HASH JOIN EACH WITH ALL ON $1231 = $500" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1221, $1231 := $41", "INNER HASH JOIN EACH WITH ALL ON $1220 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $71, $1221 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$420", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.012605042016806723, "writeMsAvg": "3", "writeMsMax": "4", "writeRatioAvg": 0.012605042016806723, "writeRatioMax": 0.01680672268907563 }, { "completedParallelInputs": "1", "computeMsAvg": "2", "computeMsMax": "2", "computeRatioAvg": 0.008403361344537815, "computeRatioMax": 0.008403361344537815, "endMs": "1665778430996", "id": "37", "inputStages": [ "36" ], "name": "S25: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "83", "startMs": "1665778430843", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420", "FROM __stage24_output" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := NULL", "$351 := 1", "$352 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($420)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $360", "TO __stage25_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.008403361344537815, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "23", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.09663865546218488, "endMs": "1665778430902", "id": "38", "inputStages": [ "28" ], "name": "S26: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3356", "startMs": "1665778430845", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.012605042016806723, "waitRatioMax": 0.01680672268907563, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.11764705882352941 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.037815126050420166, "computeRatioMax": 0.09243697478991597, "endMs": "1665778430906", "id": "39", "inputStages": [ "20", "38" ], "name": "S27: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3556", "startMs": "1665778430858", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$930, $510", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$640, $970, $971", "FROM __SHUFFLE3" ] }, { "kind": "READ", "substeps": [ "$570, $571, $572, $573, $660", "FROM __stage26_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($441, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$470 := RANK() OVER (PARTITION BY $940 ORDER BY $941 DESC)" ] }, { "kind": "SORT", "substeps": [ "$630 ASC, $631 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $650, $1011 := $660", "INNER HASH JOIN EACH WITH ALL ON $560 = $570, $561 = $571, $562 = $572, $563 = $573" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($650, '')", "$561 := coalesce($650, '0')", "$562 := coalesce($651, NUMERIC<...>)", "$563 := coalesce($651, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$440", "TO __stage27_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.012605042016806723, "waitRatioMax": 0.029411764705882353, "writeMsAvg": "19", "writeMsMax": "30", "writeRatioAvg": 0.07983193277310924, "writeRatioMax": 0.12605042016806722 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.058823529411764705, "endMs": "1665778431015", "id": "40", "inputStages": [ "34" ], "name": "S28: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3329", "startMs": "1665778430965", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage22_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.01680672268907563, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.0546218487394958, "writeRatioMax": 0.07563025210084033 }, { "completedParallelInputs": "6", "computeMsAvg": "139", "computeMsMax": "174", "computeRatioAvg": 0.5840336134453782, "computeRatioMax": 0.7310924369747899, "endMs": "1665778431103", "id": "41", "inputStages": [ "23", "24", "40" ], "name": "S29: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.05042016806722689, "readRatioMax": 0.06302521008403361, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "852", "startMs": "1665778430980", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$460", "FROM __stage28_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$400 := SUM($1191)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1061, $1191 := $1060", "SEMI HASH JOIN EACH WITH ALL ON $1061 = $460" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $1051, $1061 := $11", "INNER HASH JOIN EACH WITH ALL ON $1050 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $31, $1051 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$1200, $400", "TO __stage29_output", "BY HASH($1200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.025210084033613446, "writeRatioMax": 0.03361344537815126 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.05042016806722689, "endMs": "1665778431054", "id": "42", "inputStages": [ "39" ], "name": "S2A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3165", "startMs": "1665778431002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage27_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.012605042016806723, "waitRatioMax": 0.01680672268907563, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.11764705882352941 }, { "completedParallelInputs": "6", "computeMsAvg": "138", "computeMsMax": "172", "computeRatioAvg": 0.5798319327731093, "computeRatioMax": 0.7226890756302521, "endMs": "1665778431148", "id": "43", "inputStages": [ "42", "31", "30" ], "name": "S2B: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.046218487394957986, "readRatioMax": 0.06302521008403361, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "276", "shuffleOutputBytesSpilled": "0", "slotMs": "826", "startMs": "1665778431020", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_store_sk, $22:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$440", "FROM __stage2A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1021, $1031 := $1020", "$390 := SUM($1022)" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $891, $1021 := $892, $1022 := $890", "SEMI HASH JOIN EACH WITH ALL ON $892 = $440" ] }, { "kind": "JOIN", "substeps": [ "$890 := $881, $891 := $2, $892 := $3", "INNER HASH JOIN EACH WITH ALL ON $880 = $1" ] }, { "kind": "JOIN", "substeps": [ "$880 := $21, $881 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1031, $1030, $390", "TO __stage2B_output", "BY HASH($1030, $1031)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.025210084033613446, "writeRatioMax": 0.03361344537815126 }, { "completedParallelInputs": "43", "computeMsAvg": "10", "computeMsMax": "17", "computeRatioAvg": 0.04201680672268908, "computeRatioMax": 0.07142857142857142, "endMs": "1665778431223", "id": "44", "inputStages": [ "41", "43", "37" ], "name": "S2C: Aggregate+", "parallelInputs": "43", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13", "recordsWritten": "3", "shuffleOutputBytes": "126", "shuffleOutputBytesSpilled": "0", "slotMs": "1568", "startMs": "1665778431173", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1031, $1030, $390", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$1200, $400", "FROM __stage29_output" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $360", "FROM __stage25_output" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := case_no_value(equal($243, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030, $1041 := $1031", "$330 := SUM($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := NULL", "$281 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200", "$340 := SUM($400)" ] }, { "kind": "WRITE", "substeps": [ "$220, $240, $241, $242, $244", "TO __stage2C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.012605042016806723, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.06302521008403361, "writeRatioMax": 0.1134453781512605 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.025210084033613446, "computeRatioMax": 0.025210084033613446, "endMs": "1665778431287", "id": "45", "name": "S2D: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778431251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $1431, $1432, $1430", "FROM __SHUFFLE20" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := coalesce($1440, 0)", "$261 := coalesce($1440, 1)", "$262 := coalesce($1441, '')", "$263 := coalesce($1441, '0')", "$264 := coalesce($1442, NUMERIC<...>)", "$265 := coalesce($1442, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1440 := $1430, $1441 := $1431, $1442 := $1432", "$320 := MIN($380)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "TO __stage2D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.08403361344537816, "writeRatioMax": 0.08403361344537816 }, { "completedParallelInputs": "94", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.0546218487394958, "endMs": "1665778431354", "id": "47", "inputStages": [ "45" ], "name": "S2F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3227", "startMs": "1665778431300", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage2D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.012605042016806723, "writeMsAvg": "18", "writeMsMax": "30", "writeRatioAvg": 0.07563025210084033, "writeRatioMax": 0.12605042016806722 }, { "completedParallelInputs": "101", "computeMsAvg": "7", "computeMsMax": "17", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.07142857142857142, "endMs": "1665778431353", "id": "48", "inputStages": [ "47", "44" ], "name": "S30: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "153", "shuffleOutputBytesSpilled": "0", "slotMs": "3155", "startMs": "1665778431305", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $240, $241, $242, $244", "FROM __stage2C_output" ] }, { "kind": "READ", "substeps": [ "$300, $1400, $1401, $1402, $1403, $1404", "FROM __SHUFFLE19" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "FROM __stage2F_output" ] }, { "kind": "SORT", "substeps": [ "$204 DESC, $180 ASC, $200 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := case_no_value(equal($204, 0), $202, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1374, $1370 ORDER BY $1371 DESC)" ] }, { "kind": "SORT", "substeps": [ "$294 ASC, $290 ASC, $291 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1450 := $311, $1451 := $312, $1452 := $313, $1453 := $314, $1454 := $320", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261, $252 = $262, $253 = $263, $254 = $264, $255 = $265" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := coalesce($314, 0)", "$251 := coalesce($314, 1)", "$252 := coalesce($310, '')", "$253 := coalesce($310, '0')", "$254 := coalesce($311, NUMERIC<...>)", "$255 := coalesce($311, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "TO __stage30_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.01680672268907563, "waitRatioMax": 0.025210084033613446, "writeMsAvg": "20", "writeMsMax": "33", "writeRatioAvg": 0.08403361344537816, "writeRatioMax": 0.13865546218487396 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.01680672268907563, "endMs": "1665778431364", "id": "49", "inputStages": [ "48" ], "name": "S31: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665778431318", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "FROM __stage30_output" ] }, { "kind": "SORT", "substeps": [ "$1465 DESC, $1460 ASC, $1461 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1470, $1471, $1472, $1473, $1474", "TO __stage31_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.008403361344537815, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01680672268907563, "writeRatioMax": 0.01680672268907563 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "9", "completedUnits": "32", "elapsedMs": "639", "estimatedRunnableUnits": "0", "pendingUnits": "15", "totalSlotMs": "3138" }, { "activeUnits": "0", "completedUnits": "1198", "elapsedMs": "1425", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "43885" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89176796", "totalPartitionsProcessed": "0", "totalSlotMs": "43885", "transferredBytes": "0" }, "startTime": "1665778430021", "totalBytesProcessed": "89176796", "totalSlotMs": "43885" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc12dd0a4_a152_49b3_8d11_6dd1ba890fc7" }, "priority": "INTERACTIVE", "query": "-- start query 70 in stream 0 using template query70.tpl\nWITH results AS\n (SELECT sum(ss_net_profit) AS total_sum,\n s_state,\n s_county,\n 0 AS gstate,\n 0 AS g_county\n FROM store_sales ,\n date_dim d1 ,\n store\n WHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d1.d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n AND s_state IN\n (SELECT s_state\n FROM\n (SELECT s_state AS s_state,\n rank() OVER (PARTITION BY s_state\n ORDER BY sum(ss_net_profit) DESC) AS ranking\n FROM store_sales,\n store,\n date_dim\n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n GROUP BY s_state ) tmp1\n WHERE ranking <= 5)\n GROUP BY s_state,\n s_county),\n results_rollup AS\n (SELECT total_sum,\n s_state,\n s_county,\n 0 AS g_state,\n 0 AS g_county,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT sum(total_sum) AS total_sum,\n s_state,\n NULL AS s_county,\n 0 AS g_state,\n 1 AS g_county,\n 1 AS lochierarchy\n FROM results\n GROUP BY s_state\n UNION ALL SELECT sum(total_sum) AS total_sum,\n NULL AS s_state,\n NULL AS s_county,\n 1 AS g_state,\n 1 AS g_county,\n 2 AS lochierarchy\n FROM results)\nSELECT total_sum,\n s_state,\n s_county,\n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN g_county = 0 THEN s_state\n END\n ORDER BY total_sum DESC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN s_state\n END ,\n rank_within_parent\nLIMIT 100;\n-- end query 70 in stream 0 using template query70.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ULLbLQHrzd4HEWrg9eA/ng==", "id": "test-project-364309:europe-west1.query70_1665778433", "jobReference": { "jobId": "query70_1665778433", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query70_1665778433?location=europe-west1", "statistics": { "creationTime": "1665778434026", "endTime": "1665778435323", "finalExecutionDurationMs": "1040", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89176796", "performanceInsights": { "avgPreviousExecutionMs": "1250" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.0867579908675799, "computeRatioMax": 0.0867579908675799, "endMs": "1665778434225", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.045662100456621, "readRatioMax": 0.045662100456621, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778434193", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_month_seq", "FROM date_dim", "WHERE between($171, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0410958904109589, "writeRatioMax": 0.0410958904109589 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0319634703196347, "endMs": "1665778434237", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0182648401826484, "readRatioMax": 0.0182648401826484, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778434206", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:s_store_sk, $161:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage01_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0867579908675799, "writeRatioMax": 0.0867579908675799 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0365296803652968, "endMs": "1665778434274", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.0639269406392694, "readRatioMax": 0.0639269406392694, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778434237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_month_seq", "FROM date_dim", "WHERE between($141, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage03_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0182648401826484, "waitRatioMax": 0.0182648401826484, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0547945205479452, "writeRatioMax": 0.0547945205479452 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0273972602739726, "computeRatioMax": 0.0273972602739726, "endMs": "1665778434305", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0228310502283105, "readRatioMax": 0.0228310502283105, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778434274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:s_store_sk, $131:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage04_output" ] } ], "waitMsAvg": "27", "waitMsMax": "27", "waitRatioAvg": 0.1232876712328767, "waitRatioMax": 0.1232876712328767, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0867579908675799, "writeRatioMax": 0.0867579908675799 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0319634703196347, "endMs": "1665778434344", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0273972602739726, "readRatioMax": 0.0273972602739726, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665778434317", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_month_seq", "FROM date_dim", "WHERE between($111, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage06_output" ] } ], "waitMsAvg": "38", "waitMsMax": "38", "waitRatioAvg": 0.1735159817351598, "waitRatioMax": 0.1735159817351598, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0639269406392694 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0410958904109589, "computeRatioMax": 0.0410958904109589, "endMs": "1665778434354", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0182648401826484, "readRatioMax": 0.0182648401826484, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778434317", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:s_store_sk, $101:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage07_output" ] } ], "waitMsAvg": "24", "waitMsMax": "24", "waitRatioAvg": 0.1095890410958904, "waitRatioMax": 0.1095890410958904, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0730593607305936, "writeRatioMax": 0.0730593607305936 }, { "completedParallelInputs": "6", "computeMsAvg": "138", "computeMsMax": "173", "computeRatioAvg": 0.6301369863013698, "computeRatioMax": 0.7899543378995434, "endMs": "1665778434456", "id": "9", "inputStages": [ "1", "0" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "22", "readRatioAvg": 0.0593607305936073, "readRatioMax": 0.1004566210045662, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "866", "startMs": "1665778434322", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ss_sold_date_sk, $151:ss_store_sk, $152:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1251", "$740 := SUM($1250)" ] }, { "kind": "JOIN", "substeps": [ "$1250 := $1241, $1251 := $1242", "INNER HASH JOIN EACH WITH ALL ON $1240 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $150, $1241 := $152, $1242 := $161", "INNER HASH JOIN EACH WITH ALL ON $151 = $160" ] }, { "kind": "WRITE", "substeps": [ "$1260, $740", "TO __stage09_output", "BY HASH($1260)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "7", "writeMsMax": "11", "writeRatioAvg": 0.0319634703196347, "writeRatioMax": 0.0502283105022831 }, { "completedParallelInputs": "6", "computeMsAvg": "165", "computeMsMax": "219", "computeRatioAvg": 0.7534246575342466, "computeRatioMax": 1, "endMs": "1665778434469", "id": "10", "inputStages": [ "3", "4" ], "name": "S0A: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.0593607305936073, "readRatioMax": 0.0730593607305936, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "954", "startMs": "1665778434338", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ss_sold_date_sk, $121:ss_store_sk, $122:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1081", "$670 := SUM($1080)" ] }, { "kind": "JOIN", "substeps": [ "$1080 := $1071, $1081 := $1072", "INNER HASH JOIN EACH WITH ALL ON $1070 = $140" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $120, $1071 := $122, $1072 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$1090, $670", "TO __stage0A_output", "BY HASH($1090)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0319634703196347, "writeRatioMax": 0.0319634703196347 }, { "completedParallelInputs": "6", "computeMsAvg": "131", "computeMsMax": "149", "computeRatioAvg": 0.5981735159817352, "computeRatioMax": 0.680365296803653, "endMs": "1665778434503", "id": "11", "inputStages": [ "7", "6" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.0639269406392694, "readRatioMax": 0.0867579908675799, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "814", "startMs": "1665778434377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_store_sk, $92:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $911", "$620 := SUM($910)" ] }, { "kind": "JOIN", "substeps": [ "$910 := $901, $911 := $902", "INNER HASH JOIN EACH WITH ALL ON $900 = $110" ] }, { "kind": "JOIN", "substeps": [ "$900 := $90, $901 := $92, $902 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$920, $620", "TO __stage0B_output", "BY HASH($920)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.0365296803652968, "writeRatioMax": 0.0410958904109589 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0319634703196347, "endMs": "1665778434507", "id": "12", "inputStages": [ "9" ], "name": "S0C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778434475", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1260, $740", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1270 := $1260", "$600 := SUM($740)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $600", "TO __stage0C_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0684931506849315, "writeRatioMax": 0.0684931506849315 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0273972602739726, "computeRatioMax": 0.0273972602739726, "endMs": "1665778434522", "id": "13", "inputStages": [ "10" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778434491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1090, $670", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$530 := SUM($670)" ] }, { "kind": "WRITE", "substeps": [ "$1100, $530", "TO __stage0D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0547945205479452, "writeRatioMax": 0.0547945205479452 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0365296803652968, "endMs": "1665778434555", "id": "14", "inputStages": [ "11" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778434518", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$920, $620", "FROM __stage0B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $930 := $920", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$930, $510", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0639269406392694 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0410958904109589, "computeRatioMax": 0.0410958904109589, "endMs": "1665778434567", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778434532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$860, $1330, $1331", "FROM __SHUFFLE16" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := coalesce($1340, '')", "$731 := coalesce($1340, '0')", "$732 := coalesce($1341, NUMERIC<...>)", "$733 := coalesce($1341, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1340 := $1330, $1341 := $1331", "$780 := MIN($860)" ] }, { "kind": "WRITE", "substeps": [ "$730, $731, $732, $733, $780", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0776255707762557, "writeRatioMax": 0.0776255707762557 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0365296803652968, "endMs": "1665778434587", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0273972602739726, "readRatioMax": 0.0273972602739726, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778434559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0684931506849315, "writeRatioMax": 0.0684931506849315 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.045662100456621, "computeRatioMax": 0.045662100456621, "endMs": "1665778434609", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.045662100456621, "readRatioMax": 0.045662100456621, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778434571", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0365296803652968, "writeRatioMax": 0.0365296803652968 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0410958904109589, "computeRatioMax": 0.0410958904109589, "endMs": "1665778434623", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778434595", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$820, $1160, $1161", "FROM __SHUFFLE10" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := coalesce($1170, '')", "$591 := coalesce($1170, '0')", "$592 := coalesce($1171, NUMERIC<...>)", "$593 := coalesce($1171, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1170 := $1160, $1171 := $1161", "$710 := MIN($820)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $710", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0091324200913242, "waitRatioMax": 0.0091324200913242, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.1004566210045662, "writeRatioMax": 0.1004566210045662 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0273972602739726, "computeRatioMax": 0.0273972602739726, "endMs": "1665778434661", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0182648401826484, "readRatioMax": 0.0182648401826484, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778434622", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0821917808219178, "writeRatioMax": 0.0821917808219178 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0319634703196347, "endMs": "1665778434659", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0228310502283105, "readRatioMax": 0.0228310502283105, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778434635", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0547945205479452, "writeRatioMax": 0.0547945205479452 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0228310502283105, "computeRatioMax": 0.0228310502283105, "endMs": "1665778434690", "id": "25", "name": "S19: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778434659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $990, $991", "FROM __SHUFFLE4" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := coalesce($1000, '')", "$571 := coalesce($1000, '0')", "$572 := coalesce($1001, NUMERIC<...>)", "$573 := coalesce($1001, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1000 := $990, $1001 := $991", "$660 := MIN($800)" ] }, { "kind": "WRITE", "substeps": [ "$570, $571, $572, $573, $660", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0730593607305936, "writeRatioMax": 0.0730593607305936 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0319634703196347, "endMs": "1665778434710", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0182648401826484, "readRatioMax": 0.0182648401826484, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "456", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778434686", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_county, $3:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0684931506849315, "writeRatioMax": 0.0684931506849315 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0365296803652968, "endMs": "1665778434732", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0319634703196347, "readRatioMax": 0.0319634703196347, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778434699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0228310502283105, "writeRatioMax": 0.0228310502283105 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0684931506849315, "endMs": "1665778434780", "id": "30", "inputStages": [ "15" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3613", "startMs": "1665778434720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0136986301369863, "waitRatioMax": 0.0182648401826484, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.0684931506849315, "writeRatioMax": 0.1232876712328767 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0776255707762557, "endMs": "1665778434794", "id": "31", "inputStages": [ "12", "30" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2987", "startMs": "1665778434741", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $600", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$760, $1310, $1311", "FROM __SHUFFLE15" ] }, { "kind": "READ", "substeps": [ "$730, $731, $732, $733, $780", "FROM __stage1E_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($501, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$550 := RANK() OVER (PARTITION BY $1280 ORDER BY $1281 DESC)" ] }, { "kind": "SORT", "substeps": [ "$750 ASC, $751 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1350 := $770, $1351 := $780", "INNER HASH JOIN EACH WITH ALL ON $720 = $730, $721 = $731, $722 = $732, $723 = $733" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($770, '')", "$721 := coalesce($770, '0')", "$722 := coalesce($771, NUMERIC<...>)", "$723 := coalesce($771, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$500", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.0684931506849315, "writeRatioMax": 0.1415525114155251 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0593607305936073, "endMs": "1665778434794", "id": "32", "inputStages": [ "20" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3001", "startMs": "1665778434743", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0136986301369863, "waitRatioMax": 0.0182648401826484, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0821917808219178 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0684931506849315, "endMs": "1665778434798", "id": "33", "inputStages": [ "32", "13" ], "name": "S21: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2777", "startMs": "1665778434755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1100, $530", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$690, $1140, $1141", "FROM __SHUFFLE9" ] }, { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $710", "FROM __stage20_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($461, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := RANK() OVER (PARTITION BY $1110 ORDER BY $1111 DESC)" ] }, { "kind": "SORT", "substeps": [ "$680 ASC, $681 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $700, $1181 := $710", "INNER HASH JOIN EACH WITH ALL ON $580 = $590, $581 = $591, $582 = $592, $583 = $593" ] }, { "kind": "COMPUTE", "substeps": [ "$580 := coalesce($700, '')", "$581 := coalesce($700, '0')", "$582 := coalesce($701, NUMERIC<...>)", "$583 := coalesce($701, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$460", "TO __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0091324200913242, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0867579908675799 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0639269406392694, "endMs": "1665778434818", "id": "35", "inputStages": [ "25" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2551", "startMs": "1665778434769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0091324200913242, "waitRatioMax": 0.0182648401826484, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0821917808219178 }, { "completedParallelInputs": "101", "computeMsAvg": "7", "computeMsMax": "22", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.1004566210045662, "endMs": "1665778434821", "id": "36", "inputStages": [ "35", "14" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2622", "startMs": "1665778434783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$930, $510", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$640, $970, $971", "FROM __SHUFFLE3" ] }, { "kind": "READ", "substeps": [ "$570, $571, $572, $573, $660", "FROM __stage23_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($441, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$470 := RANK() OVER (PARTITION BY $940 ORDER BY $941 DESC)" ] }, { "kind": "SORT", "substeps": [ "$630 ASC, $631 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $650, $1011 := $660", "INNER HASH JOIN EACH WITH ALL ON $560 = $570, $561 = $571, $562 = $572, $563 = $573" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($650, '')", "$561 := coalesce($650, '0')", "$562 := coalesce($651, NUMERIC<...>)", "$563 := coalesce($651, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$440", "TO __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "12", "writeMsMax": "19", "writeRatioAvg": 0.0547945205479452, "writeRatioMax": 0.0867579908675799 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0730593607305936, "endMs": "1665778434848", "id": "37", "inputStages": [ "31" ], "name": "S25: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2891", "startMs": "1665778434801", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0867579908675799 }, { "completedParallelInputs": "6", "computeMsAvg": "106", "computeMsMax": "120", "computeRatioAvg": 0.4840182648401826, "computeRatioMax": 0.547945205479452, "endMs": "1665778434942", "id": "38", "inputStages": [ "17", "18", "37" ], "name": "S26: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.0593607305936073, "readRatioMax": 0.0821917808219178, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "102", "shuffleOutputBytesSpilled": "0", "slotMs": "727", "startMs": "1665778434809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_store_sk, $72:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$500", "FROM __stage25_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$420 := SUM($1360)" ] }, { "kind": "JOIN", "substeps": [ "$1360 := $1230", "SEMI HASH JOIN EACH WITH ALL ON $1231 = $500" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1221, $1231 := $41", "INNER HASH JOIN EACH WITH ALL ON $1220 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $71, $1221 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$420", "TO __stage26_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0091324200913242, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "3", "writeMsMax": "5", "writeRatioAvg": 0.0136986301369863, "writeRatioMax": 0.0228310502283105 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0273972602739726, "computeRatioMax": 0.0273972602739726, "endMs": "1665778434943", "id": "39", "inputStages": [ "38" ], "name": "S27: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778434809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420", "FROM __stage26_output" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := NULL", "$351 := 1", "$352 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($420)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $360", "TO __stage27_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0136986301369863, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0045662100456621, "writeRatioMax": 0.0045662100456621 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0730593607305936, "endMs": "1665778434858", "id": "40", "inputStages": [ "33" ], "name": "S28: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3140", "startMs": "1665778434809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0091324200913242, "waitRatioMax": 0.0091324200913242, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0821917808219178 }, { "completedParallelInputs": "6", "computeMsAvg": "143", "computeMsMax": "184", "computeRatioAvg": 0.6529680365296804, "computeRatioMax": 0.8401826484018264, "endMs": "1665778434965", "id": "41", "inputStages": [ "23", "22", "40" ], "name": "S29: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.0593607305936073, "readRatioMax": 0.0821917808219178, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "879", "startMs": "1665778434818", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$460", "FROM __stage28_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$400 := SUM($1191)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1061, $1191 := $1060", "SEMI HASH JOIN EACH WITH ALL ON $1061 = $460" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $1051, $1061 := $11", "INNER HASH JOIN EACH WITH ALL ON $1050 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $31, $1051 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$1200, $400", "TO __stage29_output", "BY HASH($1200)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.0273972602739726, "writeRatioMax": 0.0410958904109589 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0684931506849315, "endMs": "1665778434872", "id": "42", "inputStages": [ "36" ], "name": "S2A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3085", "startMs": "1665778434825", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0091324200913242, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0821917808219178 }, { "completedParallelInputs": "6", "computeMsAvg": "132", "computeMsMax": "218", "computeRatioAvg": 0.6027397260273972, "computeRatioMax": 0.9954337899543378, "endMs": "1665778435001", "id": "43", "inputStages": [ "28", "42", "27" ], "name": "S2B: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "17", "readRatioAvg": 0.0547945205479452, "readRatioMax": 0.0776255707762557, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "276", "shuffleOutputBytesSpilled": "0", "slotMs": "832", "startMs": "1665778434837", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_store_sk, $22:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$440", "FROM __stage2A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1021, $1031 := $1020", "$390 := SUM($1022)" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $891, $1021 := $892, $1022 := $890", "SEMI HASH JOIN EACH WITH ALL ON $892 = $440" ] }, { "kind": "JOIN", "substeps": [ "$890 := $881, $891 := $2, $892 := $3", "INNER HASH JOIN EACH WITH ALL ON $880 = $1" ] }, { "kind": "JOIN", "substeps": [ "$880 := $21, $881 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1031, $1030, $390", "TO __stage2B_output", "BY HASH($1030, $1031)" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.0228310502283105, "writeRatioMax": 0.0319634703196347 }, { "completedParallelInputs": "43", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.0410958904109589, "computeRatioMax": 0.0639269406392694, "endMs": "1665778435064", "id": "44", "inputStages": [ "39", "43", "41" ], "name": "S2C: Aggregate+", "parallelInputs": "43", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13", "recordsWritten": "3", "shuffleOutputBytes": "126", "shuffleOutputBytesSpilled": "0", "slotMs": "1557", "startMs": "1665778435021", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1031, $1030, $390", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$1200, $400", "FROM __stage29_output" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $360", "FROM __stage27_output" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := case_no_value(equal($243, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030, $1041 := $1031", "$330 := SUM($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := NULL", "$281 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200", "$340 := SUM($400)" ] }, { "kind": "WRITE", "substeps": [ "$220, $240, $241, $242, $244", "TO __stage2C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0091324200913242, "writeMsAvg": "18", "writeMsMax": "28", "writeRatioAvg": 0.0821917808219178, "writeRatioMax": 0.1278538812785388 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.045662100456621, "computeRatioMax": 0.045662100456621, "endMs": "1665778435125", "id": "45", "name": "S2D: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778435086", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $1431, $1432, $1430", "FROM __SHUFFLE20" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := coalesce($1440, 0)", "$261 := coalesce($1440, 1)", "$262 := coalesce($1441, '')", "$263 := coalesce($1441, '0')", "$264 := coalesce($1442, NUMERIC<...>)", "$265 := coalesce($1442, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1440 := $1430, $1441 := $1431, $1442 := $1432", "$320 := MIN($380)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "TO __stage2D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0867579908675799, "writeRatioMax": 0.0867579908675799 }, { "completedParallelInputs": "94", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0365296803652968, "computeRatioMax": 0.0730593607305936, "endMs": "1665778435175", "id": "47", "inputStages": [ "45" ], "name": "S2F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3069", "startMs": "1665778435131", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage2D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.0684931506849315, "writeRatioMax": 0.0821917808219178 }, { "completedParallelInputs": "101", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.0319634703196347, "computeRatioMax": 0.0593607305936073, "endMs": "1665778435175", "id": "48", "inputStages": [ "47", "44" ], "name": "S30: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "153", "shuffleOutputBytesSpilled": "0", "slotMs": "2132", "startMs": "1665778435136", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $240, $241, $242, $244", "FROM __stage2C_output" ] }, { "kind": "READ", "substeps": [ "$300, $1400, $1401, $1402, $1403, $1404", "FROM __SHUFFLE19" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "FROM __stage2F_output" ] }, { "kind": "SORT", "substeps": [ "$204 DESC, $180 ASC, $200 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := case_no_value(equal($204, 0), $202, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1374, $1370 ORDER BY $1371 DESC)" ] }, { "kind": "SORT", "substeps": [ "$294 ASC, $290 ASC, $291 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1450 := $311, $1451 := $312, $1452 := $313, $1453 := $314, $1454 := $320", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261, $252 = $262, $253 = $263, $254 = $264, $255 = $265" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := coalesce($314, 0)", "$251 := coalesce($314, 1)", "$252 := coalesce($310, '')", "$253 := coalesce($310, '0')", "$254 := coalesce($311, NUMERIC<...>)", "$255 := coalesce($311, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "TO __stage30_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.0182648401826484, "waitRatioMax": 0.0228310502283105, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.0639269406392694, "writeRatioMax": 0.0958904109589041 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0410958904109589, "computeRatioMax": 0.0410958904109589, "endMs": "1665778435194", "id": "49", "inputStages": [ "48" ], "name": "S31: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778435143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "FROM __stage30_output" ] }, { "kind": "SORT", "substeps": [ "$1465 DESC, $1460 ASC, $1461 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1470, $1471, $1472, $1473, $1474", "TO __stage31_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0136986301369863, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0182648401826484, "writeRatioMax": 0.0182648401826484 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "36", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "15", "totalSlotMs": "3670" }, { "activeUnits": "0", "completedUnits": "1198", "elapsedMs": "1164", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "39938" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89176796", "totalPartitionsProcessed": "0", "totalSlotMs": "39938", "transferredBytes": "0" }, "startTime": "1665778434088", "totalBytesProcessed": "89176796", "totalSlotMs": "39938" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon259f8f32_48aa_4269_8021_148df64715e1" }, "priority": "INTERACTIVE", "query": "-- start query 70 in stream 0 using template query70.tpl\nWITH results AS\n (SELECT sum(ss_net_profit) AS total_sum,\n s_state,\n s_county,\n 0 AS gstate,\n 0 AS g_county\n FROM store_sales ,\n date_dim d1 ,\n store\n WHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d1.d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n AND s_state IN\n (SELECT s_state\n FROM\n (SELECT s_state AS s_state,\n rank() OVER (PARTITION BY s_state\n ORDER BY sum(ss_net_profit) DESC) AS ranking\n FROM store_sales,\n store,\n date_dim\n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n GROUP BY s_state ) tmp1\n WHERE ranking <= 5)\n GROUP BY s_state,\n s_county),\n results_rollup AS\n (SELECT total_sum,\n s_state,\n s_county,\n 0 AS g_state,\n 0 AS g_county,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT sum(total_sum) AS total_sum,\n s_state,\n NULL AS s_county,\n 0 AS g_state,\n 1 AS g_county,\n 1 AS lochierarchy\n FROM results\n GROUP BY s_state\n UNION ALL SELECT sum(total_sum) AS total_sum,\n NULL AS s_state,\n NULL AS s_county,\n 1 AS g_state,\n 1 AS g_county,\n 2 AS lochierarchy\n FROM results)\nSELECT total_sum,\n s_state,\n s_county,\n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN g_county = 0 THEN s_state\n END\n ORDER BY total_sum DESC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN s_state\n END ,\n rank_within_parent\nLIMIT 100;\n-- end query 70 in stream 0 using template query70.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "n5zvjlbWq90mg3A7/eWmOQ==", "id": "test-project-364309:europe-west1.query70_1665778436", "jobReference": { "jobId": "query70_1665778436", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query70_1665778436?location=europe-west1", "statistics": { "creationTime": "1665778437092", "endTime": "1665778438444", "finalExecutionDurationMs": "1110", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89176796", "performanceInsights": { "avgPreviousExecutionMs": "1226" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.061855670103092786, "computeRatioMax": 0.061855670103092786, "endMs": "1665778437295", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.05670103092783505, "readRatioMax": 0.05670103092783505, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778437256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_month_seq", "FROM date_dim", "WHERE between($171, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04639175257731959, "writeRatioMax": 0.04639175257731959 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.061855670103092786, "computeRatioMax": 0.061855670103092786, "endMs": "1665778437318", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.030927835051546393, "readRatioMax": 0.030927835051546393, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778437272", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:s_store_sk, $161:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.08762886597938144, "writeRatioMax": 0.08762886597938144 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05154639175257732, "computeRatioMax": 0.05154639175257732, "endMs": "1665778437352", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.07731958762886598, "readRatioMax": 0.07731958762886598, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778437318", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_month_seq", "FROM date_dim", "WHERE between($141, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage03_output" ] } ], "waitMsAvg": "20", "waitMsMax": "20", "waitRatioAvg": 0.10309278350515463, "waitRatioMax": 0.10309278350515463, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.02577319587628866, "writeRatioMax": 0.02577319587628866 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.061855670103092786, "computeRatioMax": 0.061855670103092786, "endMs": "1665778437395", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.030927835051546393, "readRatioMax": 0.030927835051546393, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778437352", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:s_store_sk, $131:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage04_output" ] } ], "waitMsAvg": "42", "waitMsMax": "42", "waitRatioAvg": 0.21649484536082475, "waitRatioMax": 0.21649484536082475, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.08247422680412371, "writeRatioMax": 0.08247422680412371 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.061855670103092786, "computeRatioMax": 0.061855670103092786, "endMs": "1665778437400", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.041237113402061855, "readRatioMax": 0.041237113402061855, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778437354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_month_seq", "FROM date_dim", "WHERE between($111, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage06_output" ] } ], "waitMsAvg": "17", "waitMsMax": "17", "waitRatioAvg": 0.08762886597938144, "waitRatioMax": 0.08762886597938144, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07731958762886598, "writeRatioMax": 0.07731958762886598 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04639175257731959, "computeRatioMax": 0.04639175257731959, "endMs": "1665778437395", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.020618556701030927, "readRatioMax": 0.020618556701030927, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778437354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:s_store_sk, $101:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage07_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.020618556701030927, "waitRatioMax": 0.020618556701030927, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0979381443298969, "writeRatioMax": 0.0979381443298969 }, { "completedParallelInputs": "6", "computeMsAvg": "143", "computeMsMax": "178", "computeRatioAvg": 0.7371134020618557, "computeRatioMax": 0.9175257731958762, "endMs": "1665778437519", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "28", "readRatioAvg": 0.0979381443298969, "readRatioMax": 0.14432989690721648, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "894", "startMs": "1665778437391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ss_sold_date_sk, $151:ss_store_sk, $152:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1251", "$740 := SUM($1250)" ] }, { "kind": "JOIN", "substeps": [ "$1250 := $1241, $1251 := $1242", "INNER HASH JOIN EACH WITH ALL ON $1240 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $150, $1241 := $152, $1242 := $161", "INNER HASH JOIN EACH WITH ALL ON $151 = $160" ] }, { "kind": "WRITE", "substeps": [ "$1260, $740", "TO __stage09_output", "BY HASH($1260)" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.04639175257731959, "waitRatioMax": 0.04639175257731959, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.041237113402061855, "writeRatioMax": 0.05154639175257732 }, { "completedParallelInputs": "6", "computeMsAvg": "133", "computeMsMax": "194", "computeRatioAvg": 0.6855670103092784, "computeRatioMax": 1, "endMs": "1665778437556", "id": "10", "inputStages": [ "4", "3" ], "name": "S0A: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "18", "readRatioAvg": 0.061855670103092786, "readRatioMax": 0.09278350515463918, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "839", "startMs": "1665778437413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ss_sold_date_sk, $121:ss_store_sk, $122:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1081", "$670 := SUM($1080)" ] }, { "kind": "JOIN", "substeps": [ "$1080 := $1071, $1081 := $1072", "INNER HASH JOIN EACH WITH ALL ON $1070 = $140" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $120, $1071 := $122, $1072 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$1090, $670", "TO __stage0A_output", "BY HASH($1090)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.010309278350515464, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.041237113402061855, "writeRatioMax": 0.05154639175257732 }, { "completedParallelInputs": "6", "computeMsAvg": "139", "computeMsMax": "179", "computeRatioAvg": 0.7164948453608248, "computeRatioMax": 0.9226804123711341, "endMs": "1665778437560", "id": "12", "inputStages": [ "7", "6" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "14", "readRatioAvg": 0.05154639175257732, "readRatioMax": 0.07216494845360824, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "743", "startMs": "1665778437442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_store_sk, $92:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $911", "$620 := SUM($910)" ] }, { "kind": "JOIN", "substeps": [ "$910 := $901, $911 := $902", "INNER HASH JOIN EACH WITH ALL ON $900 = $110" ] }, { "kind": "JOIN", "substeps": [ "$900 := $90, $901 := $92, $902 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$920, $620", "TO __stage0C_output", "BY HASH($920)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.03608247422680412, "writeRatioMax": 0.041237113402061855 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.0979381443298969, "computeRatioMax": 0.0979381443298969, "endMs": "1665778437565", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778437538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1260, $740", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1270 := $1260", "$600 := SUM($740)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $600", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06701030927835051, "writeRatioMax": 0.06701030927835051 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05670103092783505, "computeRatioMax": 0.05670103092783505, "endMs": "1665778437606", "id": "14", "inputStages": [ "10" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778437573", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1090, $670", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$530 := SUM($670)" ] }, { "kind": "WRITE", "substeps": [ "$1100, $530", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07216494845360824, "writeRatioMax": 0.07216494845360824 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.041237113402061855, "endMs": "1665778437624", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778437589", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$920, $620", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $930 := $920", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$930, $510", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.08247422680412371, "writeRatioMax": 0.08247422680412371 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.041237113402061855, "endMs": "1665778437638", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778437604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$860, $1330, $1331", "FROM __SHUFFLE16" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := coalesce($1340, '')", "$731 := coalesce($1340, '0')", "$732 := coalesce($1341, NUMERIC<...>)", "$733 := coalesce($1341, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1340 := $1330, $1341 := $1331", "$780 := MIN($860)" ] }, { "kind": "WRITE", "substeps": [ "$730, $731, $732, $733, $780", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.09278350515463918, "writeRatioMax": 0.09278350515463918 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.041237113402061855, "endMs": "1665778437677", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02577319587628866, "readRatioMax": 0.02577319587628866, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778437633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0979381443298969, "writeRatioMax": 0.0979381443298969 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.08762886597938144, "computeRatioMax": 0.08762886597938144, "endMs": "1665778437686", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.061855670103092786, "readRatioMax": 0.061855670103092786, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778437651", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05670103092783505, "writeRatioMax": 0.05670103092783505 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.030927835051546393, "computeRatioMax": 0.030927835051546393, "endMs": "1665778437716", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778437680", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$820, $1160, $1161", "FROM __SHUFFLE10" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := coalesce($1170, '')", "$591 := coalesce($1170, '0')", "$592 := coalesce($1171, NUMERIC<...>)", "$593 := coalesce($1171, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1170 := $1160, $1171 := $1161", "$710 := MIN($820)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $710", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0979381443298969, "writeRatioMax": 0.0979381443298969 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05670103092783505, "computeRatioMax": 0.05670103092783505, "endMs": "1665778437756", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.030927835051546393, "readRatioMax": 0.030927835051546393, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778437717", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.05154639175257732, "writeRatioMax": 0.05154639175257732 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05154639175257732, "computeRatioMax": 0.05154639175257732, "endMs": "1665778437774", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03608247422680412, "readRatioMax": 0.03608247422680412, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778437732", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07216494845360824, "writeRatioMax": 0.07216494845360824 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.030927835051546393, "computeRatioMax": 0.030927835051546393, "endMs": "1665778437796", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778437762", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $990, $991", "FROM __SHUFFLE4" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := coalesce($1000, '')", "$571 := coalesce($1000, '0')", "$572 := coalesce($1001, NUMERIC<...>)", "$573 := coalesce($1001, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1000 := $990, $1001 := $991", "$660 := MIN($800)" ] }, { "kind": "WRITE", "substeps": [ "$570, $571, $572, $573, $660", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.14432989690721648, "writeRatioMax": 0.14432989690721648 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03608247422680412, "computeRatioMax": 0.03608247422680412, "endMs": "1665778437828", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.020618556701030927, "readRatioMax": 0.020618556701030927, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "456", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778437789", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_county, $3:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07731958762886598, "writeRatioMax": 0.07731958762886598 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.08247422680412371, "computeRatioMax": 0.08247422680412371, "endMs": "1665778437847", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.07731958762886598, "readRatioMax": 0.07731958762886598, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778437806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06701030927835051, "writeRatioMax": 0.06701030927835051 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.07731958762886598, "endMs": "1665778437910", "id": "31", "inputStages": [ "16" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4577", "startMs": "1665778437822", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.020618556701030927, "writeMsAvg": "21", "writeMsMax": "33", "writeRatioAvg": 0.10824742268041238, "writeRatioMax": 0.17010309278350516 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.04639175257731959, "computeRatioMax": 0.08762886597938144, "endMs": "1665778437916", "id": "32", "inputStages": [ "31", "13" ], "name": "S20: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3796", "startMs": "1665778437837", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $600", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$760, $1310, $1311", "FROM __SHUFFLE15" ] }, { "kind": "READ", "substeps": [ "$730, $731, $732, $733, $780", "FROM __stage1F_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($501, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$550 := RANK() OVER (PARTITION BY $1280 ORDER BY $1281 DESC)" ] }, { "kind": "SORT", "substeps": [ "$750 ASC, $751 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1350 := $770, $1351 := $780", "INNER HASH JOIN EACH WITH ALL ON $720 = $730, $721 = $731, $722 = $732, $723 = $733" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($770, '')", "$721 := coalesce($770, '0')", "$722 := coalesce($771, NUMERIC<...>)", "$723 := coalesce($771, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$500", "TO __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.015463917525773196, "writeMsAvg": "26", "writeMsMax": "54", "writeRatioAvg": 0.13402061855670103, "writeRatioMax": 0.27835051546391754 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.07731958762886598, "endMs": "1665778437913", "id": "33", "inputStages": [ "21" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3514", "startMs": "1665778437839", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.015463917525773196, "waitRatioMax": 0.020618556701030927, "writeMsAvg": "17", "writeMsMax": "28", "writeRatioAvg": 0.08762886597938144, "writeRatioMax": 0.14432989690721648 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.04639175257731959, "computeRatioMax": 0.07731958762886598, "endMs": "1665778437925", "id": "34", "inputStages": [ "14", "33" ], "name": "S22: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3416", "startMs": "1665778437857", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1100, $530", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$690, $1140, $1141", "FROM __SHUFFLE9" ] }, { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $710", "FROM __stage21_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($461, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := RANK() OVER (PARTITION BY $1110 ORDER BY $1111 DESC)" ] }, { "kind": "SORT", "substeps": [ "$680 ASC, $681 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $700, $1181 := $710", "INNER HASH JOIN EACH WITH ALL ON $580 = $590, $581 = $591, $582 = $592, $583 = $593" ] }, { "kind": "COMPUTE", "substeps": [ "$580 := coalesce($700, '')", "$581 := coalesce($700, '0')", "$582 := coalesce($701, NUMERIC<...>)", "$583 := coalesce($701, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$460", "TO __stage22_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.020618556701030927, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.07731958762886598, "writeRatioMax": 0.15463917525773196 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.03608247422680412, "computeRatioMax": 0.07731958762886598, "endMs": "1665778437943", "id": "35", "inputStages": [ "26" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2939", "startMs": "1665778437862", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.015463917525773196, "waitRatioMax": 0.020618556701030927, "writeMsAvg": "11", "writeMsMax": "19", "writeRatioAvg": 0.05670103092783505, "writeRatioMax": 0.0979381443298969 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.0979381443298969, "endMs": "1665778437943", "id": "36", "inputStages": [ "35", "15" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3118", "startMs": "1665778437881", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$930, $510", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$640, $970, $971", "FROM __SHUFFLE3" ] }, { "kind": "READ", "substeps": [ "$570, $571, $572, $573, $660", "FROM __stage23_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($441, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$470 := RANK() OVER (PARTITION BY $940 ORDER BY $941 DESC)" ] }, { "kind": "SORT", "substeps": [ "$630 ASC, $631 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $650, $1011 := $660", "INNER HASH JOIN EACH WITH ALL ON $560 = $570, $561 = $571, $562 = $572, $563 = $573" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($650, '')", "$561 := coalesce($650, '0')", "$562 := coalesce($651, NUMERIC<...>)", "$563 := coalesce($651, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$440", "TO __stage24_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.015463917525773196, "waitRatioMax": 0.020618556701030927, "writeMsAvg": "8", "writeMsMax": "31", "writeRatioAvg": 0.041237113402061855, "writeRatioMax": 0.15979381443298968 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.07216494845360824, "endMs": "1665778437986", "id": "37", "inputStages": [ "32" ], "name": "S25: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "4385", "startMs": "1665778437926", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.015463917525773196, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.07731958762886598, "writeRatioMax": 0.14948453608247422 }, { "completedParallelInputs": "6", "computeMsAvg": "123", "computeMsMax": "148", "computeRatioAvg": 0.634020618556701, "computeRatioMax": 0.7628865979381443, "endMs": "1665778438073", "id": "38", "inputStages": [ "37", "19", "18" ], "name": "S26: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "21", "readRatioAvg": 0.07216494845360824, "readRatioMax": 0.10824742268041238, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "102", "shuffleOutputBytesSpilled": "0", "slotMs": "945", "startMs": "1665778437933", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_store_sk, $72:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$500", "FROM __stage25_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$420 := SUM($1360)" ] }, { "kind": "JOIN", "substeps": [ "$1360 := $1230", "SEMI HASH JOIN EACH WITH ALL ON $1231 = $500" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1221, $1231 := $41", "INNER HASH JOIN EACH WITH ALL ON $1220 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $71, $1221 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$420", "TO __stage26_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.010309278350515464, "writeMsAvg": "5", "writeMsMax": "9", "writeRatioAvg": 0.02577319587628866, "writeRatioMax": 0.04639175257731959 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.020618556701030927, "computeRatioMax": 0.020618556701030927, "endMs": "1665778438079", "id": "39", "inputStages": [ "38" ], "name": "S27: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665778437934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420", "FROM __stage26_output" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := NULL", "$351 := 1", "$352 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($420)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $360", "TO __stage27_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.020618556701030927, "waitRatioMax": 0.020618556701030927, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.005154639175257732, "writeRatioMax": 0.005154639175257732 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.08762886597938144, "endMs": "1665778437992", "id": "40", "inputStages": [ "34" ], "name": "S28: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3709", "startMs": "1665778437936", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage22_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.015463917525773196, "waitRatioMax": 0.020618556701030927, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.08247422680412371, "writeRatioMax": 0.15463917525773196 }, { "completedParallelInputs": "6", "computeMsAvg": "120", "computeMsMax": "148", "computeRatioAvg": 0.6185567010309279, "computeRatioMax": 0.7628865979381443, "endMs": "1665778438088", "id": "41", "inputStages": [ "40", "24", "23" ], "name": "S29: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.05670103092783505, "readRatioMax": 0.08762886597938144, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "880", "startMs": "1665778437943", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$460", "FROM __stage28_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$400 := SUM($1191)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1061, $1191 := $1060", "SEMI HASH JOIN EACH WITH ALL ON $1061 = $460" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $1051, $1061 := $11", "INNER HASH JOIN EACH WITH ALL ON $1050 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $31, $1051 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$1200, $400", "TO __stage29_output", "BY HASH($1200)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.02577319587628866, "writeRatioMax": 0.030927835051546393 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.08762886597938144, "endMs": "1665778438005", "id": "42", "inputStages": [ "36" ], "name": "S2A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3502", "startMs": "1665778437946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.015463917525773196, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.08762886597938144, "writeRatioMax": 0.15463917525773196 }, { "completedParallelInputs": "6", "computeMsAvg": "142", "computeMsMax": "188", "computeRatioAvg": 0.7319587628865979, "computeRatioMax": 0.9690721649484536, "endMs": "1665778438107", "id": "43", "inputStages": [ "29", "42", "28" ], "name": "S2B: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.061855670103092786, "readRatioMax": 0.08247422680412371, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "276", "shuffleOutputBytesSpilled": "0", "slotMs": "885", "startMs": "1665778437964", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_store_sk, $22:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$440", "FROM __stage2A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1021, $1031 := $1020", "$390 := SUM($1022)" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $891, $1021 := $892, $1022 := $890", "SEMI HASH JOIN EACH WITH ALL ON $892 = $440" ] }, { "kind": "JOIN", "substeps": [ "$890 := $881, $891 := $2, $892 := $3", "INNER HASH JOIN EACH WITH ALL ON $880 = $1" ] }, { "kind": "JOIN", "substeps": [ "$880 := $21, $881 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1031, $1030, $390", "TO __stage2B_output", "BY HASH($1030, $1031)" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.030927835051546393, "writeRatioMax": 0.03608247422680412 }, { "completedParallelInputs": "43", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.04639175257731959, "computeRatioMax": 0.07731958762886598, "endMs": "1665778438179", "id": "44", "inputStages": [ "39", "41", "43" ], "name": "S2C: Aggregate+", "parallelInputs": "43", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13", "recordsWritten": "3", "shuffleOutputBytes": "126", "shuffleOutputBytesSpilled": "0", "slotMs": "1475", "startMs": "1665778438135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1031, $1030, $390", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$1200, $400", "FROM __stage29_output" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $360", "FROM __stage27_output" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := case_no_value(equal($243, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030, $1041 := $1031", "$330 := SUM($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := NULL", "$281 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200", "$340 := SUM($400)" ] }, { "kind": "WRITE", "substeps": [ "$220, $240, $241, $242, $244", "TO __stage2C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.010309278350515464, "writeMsAvg": "20", "writeMsMax": "29", "writeRatioAvg": 0.10309278350515463, "writeRatioMax": 0.14948453608247422 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04639175257731959, "computeRatioMax": 0.04639175257731959, "endMs": "1665778438238", "id": "45", "name": "S2D: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778438199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $1431, $1432, $1430", "FROM __SHUFFLE20" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := coalesce($1440, 0)", "$261 := coalesce($1440, 1)", "$262 := coalesce($1441, '')", "$263 := coalesce($1441, '0')", "$264 := coalesce($1442, NUMERIC<...>)", "$265 := coalesce($1442, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1440 := $1430, $1441 := $1431, $1442 := $1432", "$320 := MIN($380)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "TO __stage2D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0979381443298969, "writeRatioMax": 0.0979381443298969 }, { "completedParallelInputs": "95", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.10824742268041238, "endMs": "1665778438299", "id": "47", "inputStages": [ "45" ], "name": "S2F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3372", "startMs": "1665778438248", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage2D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.015463917525773196, "writeMsAvg": "19", "writeMsMax": "31", "writeRatioAvg": 0.0979381443298969, "writeRatioMax": 0.15979381443298968 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.09278350515463918, "endMs": "1665778438299", "id": "48", "inputStages": [ "44", "47" ], "name": "S30: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "153", "shuffleOutputBytesSpilled": "0", "slotMs": "3052", "startMs": "1665778438255", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $240, $241, $242, $244", "FROM __stage2C_output" ] }, { "kind": "READ", "substeps": [ "$300, $1400, $1401, $1402, $1403, $1404", "FROM __SHUFFLE19" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "FROM __stage2F_output" ] }, { "kind": "SORT", "substeps": [ "$204 DESC, $180 ASC, $200 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := case_no_value(equal($204, 0), $202, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1374, $1370 ORDER BY $1371 DESC)" ] }, { "kind": "SORT", "substeps": [ "$294 ASC, $290 ASC, $291 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1450 := $311, $1451 := $312, $1452 := $313, $1453 := $314, $1454 := $320", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261, $252 = $262, $253 = $263, $254 = $264, $255 = $265" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := coalesce($314, 0)", "$251 := coalesce($314, 1)", "$252 := coalesce($310, '')", "$253 := coalesce($310, '0')", "$254 := coalesce($311, NUMERIC<...>)", "$255 := coalesce($311, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "TO __stage30_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.020618556701030927, "waitRatioMax": 0.02577319587628866, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.07216494845360824, "writeRatioMax": 0.13917525773195877 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.02577319587628866, "computeRatioMax": 0.02577319587628866, "endMs": "1665778438313", "id": "49", "inputStages": [ "48" ], "name": "S31: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665778438264", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "FROM __stage30_output" ] }, { "kind": "SORT", "substeps": [ "$1465 DESC, $1460 ASC, $1461 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1470, $1471, $1472, $1473, $1474", "TO __stage31_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.010309278350515464, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.020618556701030927, "writeRatioMax": 0.020618556701030927 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "33", "elapsedMs": "617", "estimatedRunnableUnits": "0", "pendingUnits": "15", "totalSlotMs": "3247" }, { "activeUnits": "201", "completedUnits": "1199", "elapsedMs": "1241", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "47558" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89176796", "totalPartitionsProcessed": "0", "totalSlotMs": "47558", "transferredBytes": "0" }, "startTime": "1665778437140", "totalBytesProcessed": "89176796", "totalSlotMs": "47558" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7e51596d_bd33_4735_b5b3_c19215ad187d" }, "priority": "INTERACTIVE", "query": "-- start query 70 in stream 0 using template query70.tpl\nWITH results AS\n (SELECT sum(ss_net_profit) AS total_sum,\n s_state,\n s_county,\n 0 AS gstate,\n 0 AS g_county\n FROM store_sales ,\n date_dim d1 ,\n store\n WHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d1.d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n AND s_state IN\n (SELECT s_state\n FROM\n (SELECT s_state AS s_state,\n rank() OVER (PARTITION BY s_state\n ORDER BY sum(ss_net_profit) DESC) AS ranking\n FROM store_sales,\n store,\n date_dim\n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n GROUP BY s_state ) tmp1\n WHERE ranking <= 5)\n GROUP BY s_state,\n s_county),\n results_rollup AS\n (SELECT total_sum,\n s_state,\n s_county,\n 0 AS g_state,\n 0 AS g_county,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT sum(total_sum) AS total_sum,\n s_state,\n NULL AS s_county,\n 0 AS g_state,\n 1 AS g_county,\n 1 AS lochierarchy\n FROM results\n GROUP BY s_state\n UNION ALL SELECT sum(total_sum) AS total_sum,\n NULL AS s_state,\n NULL AS s_county,\n 1 AS g_state,\n 1 AS g_county,\n 2 AS lochierarchy\n FROM results)\nSELECT total_sum,\n s_state,\n s_county,\n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN g_county = 0 THEN s_state\n END\n ORDER BY total_sum DESC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN s_state\n END ,\n rank_within_parent\nLIMIT 100;\n-- end query 70 in stream 0 using template query70.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "WOqu8R5WAV7UCPnu4g4G/w==", "id": "test-project-364309:europe-west1.query70_1665778440", "jobReference": { "jobId": "query70_1665778440", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query70_1665778440?location=europe-west1", "statistics": { "creationTime": "1665778441077", "endTime": "1665778442535", "finalExecutionDurationMs": "1191", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89176796", "performanceInsights": { "avgPreviousExecutionMs": "1215" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0391304347826087, "computeRatioMax": 0.0391304347826087, "endMs": "1665778441282", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02608695652173913, "readRatioMax": 0.02608695652173913, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778441242", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_month_seq", "FROM date_dim", "WHERE between($171, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06086956521739131, "writeRatioMax": 0.06086956521739131 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.030434782608695653, "computeRatioMax": 0.030434782608695653, "endMs": "1665778441298", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.017391304347826087, "readRatioMax": 0.017391304347826087, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778441258", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:s_store_sk, $161:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.12173913043478261, "writeRatioMax": 0.12173913043478261 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04782608695652174, "computeRatioMax": 0.04782608695652174, "endMs": "1665778441340", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030434782608695653, "readRatioMax": 0.030434782608695653, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778441299", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_month_seq", "FROM date_dim", "WHERE between($141, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage03_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.06086956521739131, "waitRatioMax": 0.06086956521739131, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06086956521739131, "writeRatioMax": 0.06086956521739131 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.02608695652173913, "computeRatioMax": 0.02608695652173913, "endMs": "1665778441379", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.017391304347826087, "readRatioMax": 0.017391304347826087, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778441340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:s_store_sk, $131:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage04_output" ] } ], "waitMsAvg": "36", "waitMsMax": "36", "waitRatioAvg": 0.1565217391304348, "waitRatioMax": 0.1565217391304348, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.12608695652173912, "writeRatioMax": 0.12608695652173912 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0391304347826087, "computeRatioMax": 0.0391304347826087, "endMs": "1665778441384", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030434782608695653, "readRatioMax": 0.030434782608695653, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778441345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_month_seq", "FROM date_dim", "WHERE between($111, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage06_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.017391304347826087, "waitRatioMax": 0.017391304347826087, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06086956521739131, "writeRatioMax": 0.06086956521739131 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.034782608695652174, "computeRatioMax": 0.034782608695652174, "endMs": "1665778441414", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.021739130434782608, "readRatioMax": 0.021739130434782608, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778441373", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:s_store_sk, $101:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage07_output" ] } ], "waitMsAvg": "17", "waitMsMax": "17", "waitRatioAvg": 0.07391304347826087, "waitRatioMax": 0.07391304347826087, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0782608695652174, "writeRatioMax": 0.0782608695652174 }, { "completedParallelInputs": "6", "computeMsAvg": "145", "computeMsMax": "230", "computeRatioAvg": 0.6304347826086957, "computeRatioMax": 1, "endMs": "1665778441534", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "21", "readRatioAvg": 0.06086956521739131, "readRatioMax": 0.09130434782608696, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "964", "startMs": "1665778441390", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ss_sold_date_sk, $151:ss_store_sk, $152:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1251", "$740 := SUM($1250)" ] }, { "kind": "JOIN", "substeps": [ "$1250 := $1241, $1251 := $1242", "INNER HASH JOIN EACH WITH ALL ON $1240 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $150, $1241 := $152, $1242 := $161", "INNER HASH JOIN EACH WITH ALL ON $151 = $160" ] }, { "kind": "WRITE", "substeps": [ "$1260, $740", "TO __stage09_output", "BY HASH($1260)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "15", "writeMsMax": "54", "writeRatioAvg": 0.06521739130434782, "writeRatioMax": 0.23478260869565218 }, { "completedParallelInputs": "6", "computeMsAvg": "131", "computeMsMax": "178", "computeRatioAvg": 0.5695652173913044, "computeRatioMax": 0.7739130434782608, "endMs": "1665778441532", "id": "10", "inputStages": [ "3", "4" ], "name": "S0A: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.06086956521739131, "readRatioMax": 0.0782608695652174, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "801", "startMs": "1665778441406", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ss_sold_date_sk, $121:ss_store_sk, $122:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1081", "$670 := SUM($1080)" ] }, { "kind": "JOIN", "substeps": [ "$1080 := $1071, $1081 := $1072", "INNER HASH JOIN EACH WITH ALL ON $1070 = $140" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $120, $1071 := $122, $1072 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$1090, $670", "TO __stage0A_output", "BY HASH($1090)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.034782608695652174, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "6", "computeMsAvg": "137", "computeMsMax": "177", "computeRatioAvg": 0.5956521739130435, "computeRatioMax": 0.7695652173913043, "endMs": "1665778441579", "id": "11", "inputStages": [ "7", "6" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "19", "readRatioAvg": 0.05652173913043478, "readRatioMax": 0.08260869565217391, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "855", "startMs": "1665778441436", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_store_sk, $92:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $911", "$620 := SUM($910)" ] }, { "kind": "JOIN", "substeps": [ "$910 := $901, $911 := $902", "INNER HASH JOIN EACH WITH ALL ON $900 = $110" ] }, { "kind": "JOIN", "substeps": [ "$900 := $90, $901 := $92, $902 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$920, $620", "TO __stage0B_output", "BY HASH($920)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "8", "writeMsMax": "13", "writeRatioAvg": 0.034782608695652174, "writeRatioMax": 0.05652173913043478 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.02608695652173913, "computeRatioMax": 0.02608695652173913, "endMs": "1665778441589", "id": "12", "inputStages": [ "10" ], "name": "S0C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778441552", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1090, $670", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$530 := SUM($670)" ] }, { "kind": "WRITE", "substeps": [ "$1100, $530", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.12173913043478261, "writeRatioMax": 0.12173913043478261 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05652173913043478, "computeRatioMax": 0.05652173913043478, "endMs": "1665778441609", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778441571", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1260, $740", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1270 := $1260", "$600 := SUM($740)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $600", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.12608695652173912, "writeRatioMax": 0.12608695652173912 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665778441640", "id": "14", "inputStages": [ "11" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778441602", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$920, $620", "FROM __stage0B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $930 := $920", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$930, $510", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.07391304347826087, "writeRatioMax": 0.07391304347826087 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.02608695652173913, "computeRatioMax": 0.02608695652173913, "endMs": "1665778441681", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778441625", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$820, $1160, $1161", "FROM __SHUFFLE10" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := coalesce($1170, '')", "$591 := coalesce($1170, '0')", "$592 := coalesce($1171, NUMERIC<...>)", "$593 := coalesce($1171, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1170 := $1160, $1171 := $1161", "$710 := MIN($820)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $710", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "51", "writeMsMax": "51", "writeRatioAvg": 0.2217391304347826, "writeRatioMax": 0.2217391304347826 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.030434782608695653, "computeRatioMax": 0.030434782608695653, "endMs": "1665778441723", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.017391304347826087, "readRatioMax": 0.017391304347826087, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778441683", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.08260869565217391, "writeRatioMax": 0.08260869565217391 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04782608695652174, "computeRatioMax": 0.04782608695652174, "endMs": "1665778441743", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02608695652173913, "readRatioMax": 0.02608695652173913, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778441704", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.11304347826086956, "writeRatioMax": 0.11304347826086956 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.030434782608695653, "computeRatioMax": 0.030434782608695653, "endMs": "1665778441777", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778441732", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$860, $1330, $1331", "FROM __SHUFFLE16" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := coalesce($1340, '')", "$731 := coalesce($1340, '0')", "$732 := coalesce($1341, NUMERIC<...>)", "$733 := coalesce($1341, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1340 := $1330, $1341 := $1331", "$780 := MIN($860)" ] }, { "kind": "WRITE", "substeps": [ "$730, $731, $732, $733, $780", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.10869565217391304, "writeRatioMax": 0.10869565217391304 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.034782608695652174, "computeRatioMax": 0.034782608695652174, "endMs": "1665778441799", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.021739130434782608, "readRatioMax": 0.021739130434782608, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778441761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06956521739130435, "writeRatioMax": 0.06956521739130435 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06086956521739131, "computeRatioMax": 0.06086956521739131, "endMs": "1665778441819", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.04782608695652174, "readRatioMax": 0.04782608695652174, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778441776", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0391304347826087, "writeRatioMax": 0.0391304347826087 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0391304347826087, "computeRatioMax": 0.0391304347826087, "endMs": "1665778441845", "id": "25", "name": "S19: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778441808", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $990, $991", "FROM __SHUFFLE4" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := coalesce($1000, '')", "$571 := coalesce($1000, '0')", "$572 := coalesce($1001, NUMERIC<...>)", "$573 := coalesce($1001, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1000 := $990, $1001 := $991", "$660 := MIN($800)" ] }, { "kind": "WRITE", "substeps": [ "$570, $571, $572, $573, $660", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0782608695652174, "writeRatioMax": 0.0782608695652174 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.02608695652173913, "computeRatioMax": 0.02608695652173913, "endMs": "1665778441877", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.013043478260869565, "readRatioMax": 0.013043478260869565, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "456", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778441841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_county, $3:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.11739130434782609, "writeRatioMax": 0.11739130434782609 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665778441904", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030434782608695653, "readRatioMax": 0.030434782608695653, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778441861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06521739130434782, "writeRatioMax": 0.06521739130434782 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.034782608695652174, "computeRatioMax": 0.06521739130434782, "endMs": "1665778441969", "id": "30", "inputStages": [ "15" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3287", "startMs": "1665778441877", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.017391304347826087, "waitRatioMax": 0.021739130434782608, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.06086956521739131, "writeRatioMax": 0.10434782608695652 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.0391304347826087, "computeRatioMax": 0.0782608695652174, "endMs": "1665778441971", "id": "31", "inputStages": [ "30", "12" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3469", "startMs": "1665778441894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1100, $530", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$690, $1140, $1141", "FROM __SHUFFLE9" ] }, { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $710", "FROM __stage1E_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($461, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := RANK() OVER (PARTITION BY $1110 ORDER BY $1111 DESC)" ] }, { "kind": "SORT", "substeps": [ "$680 ASC, $681 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $700, $1181 := $710", "INNER HASH JOIN EACH WITH ALL ON $580 = $590, $581 = $591, $582 = $592, $583 = $593" ] }, { "kind": "COMPUTE", "substeps": [ "$580 := coalesce($700, '')", "$581 := coalesce($700, '0')", "$582 := coalesce($701, NUMERIC<...>)", "$583 := coalesce($701, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$460", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.021739130434782608, "writeMsAvg": "21", "writeMsMax": "30", "writeRatioAvg": 0.09130434782608696, "writeRatioMax": 0.13043478260869565 }, { "completedParallelInputs": "99", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.030434782608695653, "computeRatioMax": 0.05652173913043478, "endMs": "1665778441992", "id": "32", "inputStages": [ "20" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3220", "startMs": "1665778441895", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.013043478260869565, "waitRatioMax": 0.021739130434782608, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.06086956521739131, "writeRatioMax": 0.08260869565217391 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "19", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.08260869565217391, "endMs": "1665778441986", "id": "33", "inputStages": [ "32", "13" ], "name": "S21: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3822", "startMs": "1665778441912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $600", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$760, $1310, $1311", "FROM __SHUFFLE15" ] }, { "kind": "READ", "substeps": [ "$730, $731, $732, $733, $780", "FROM __stage20_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($501, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$550 := RANK() OVER (PARTITION BY $1280 ORDER BY $1281 DESC)" ] }, { "kind": "SORT", "substeps": [ "$750 ASC, $751 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1350 := $770, $1351 := $780", "INNER HASH JOIN EACH WITH ALL ON $720 = $730, $721 = $731, $722 = $732, $723 = $733" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($770, '')", "$721 := coalesce($770, '0')", "$722 := coalesce($771, NUMERIC<...>)", "$723 := coalesce($771, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$500", "TO __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.021739130434782608, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.06521739130434782, "writeRatioMax": 0.10869565217391304 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "17", "computeRatioAvg": 0.030434782608695653, "computeRatioMax": 0.07391304347826087, "endMs": "1665778442001", "id": "34", "inputStages": [ "25" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3349", "startMs": "1665778441914", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.02608695652173913, "waitRatioMax": 0.034782608695652174, "writeMsAvg": "13", "writeMsMax": "26", "writeRatioAvg": 0.05652173913043478, "writeRatioMax": 0.11304347826086956 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.034782608695652174, "computeRatioMax": 0.06956521739130435, "endMs": "1665778442002", "id": "35", "inputStages": [ "14", "34" ], "name": "S23: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3649", "startMs": "1665778441934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$930, $510", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$640, $970, $971", "FROM __SHUFFLE3" ] }, { "kind": "READ", "substeps": [ "$570, $571, $572, $573, $660", "FROM __stage22_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($441, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$470 := RANK() OVER (PARTITION BY $940 ORDER BY $941 DESC)" ] }, { "kind": "SORT", "substeps": [ "$630 ASC, $631 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $650, $1011 := $660", "INNER HASH JOIN EACH WITH ALL ON $560 = $570, $561 = $571, $562 = $572, $563 = $573" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($650, '')", "$561 := coalesce($650, '0')", "$562 := coalesce($651, NUMERIC<...>)", "$563 := coalesce($651, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$440", "TO __stage23_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.013043478260869565, "writeMsAvg": "20", "writeMsMax": "30", "writeRatioAvg": 0.08695652173913043, "writeRatioMax": 0.13043478260869565 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.034782608695652174, "computeRatioMax": 0.0782608695652174, "endMs": "1665778442033", "id": "36", "inputStages": [ "31" ], "name": "S24: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "4263", "startMs": "1665778441987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.013043478260869565, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.06521739130434782, "writeRatioMax": 0.09130434782608696 }, { "completedParallelInputs": "6", "computeMsAvg": "125", "computeMsMax": "135", "computeRatioAvg": 0.5434782608695652, "computeRatioMax": 0.5869565217391305, "endMs": "1665778442139", "id": "37", "inputStages": [ "18", "17", "36" ], "name": "S25: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.06086956521739131, "readRatioMax": 0.0782608695652174, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "802", "startMs": "1665778441998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$460", "FROM __stage24_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$400 := SUM($1191)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1061, $1191 := $1060", "SEMI HASH JOIN EACH WITH ALL ON $1061 = $460" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $1051, $1061 := $11", "INNER HASH JOIN EACH WITH ALL ON $1050 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $31, $1051 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$1200, $400", "TO __stage25_output", "BY HASH($1200)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.034782608695652174 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.030434782608695653, "computeRatioMax": 0.05652173913043478, "endMs": "1665778442057", "id": "38", "inputStages": [ "33" ], "name": "S26: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3383", "startMs": "1665778442002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.013043478260869565, "waitRatioMax": 0.021739130434782608, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.06521739130434782, "writeRatioMax": 0.11739130434782609 }, { "completedParallelInputs": "6", "computeMsAvg": "127", "computeMsMax": "207", "computeRatioAvg": 0.5521739130434783, "computeRatioMax": 0.9, "endMs": "1665778442162", "id": "39", "inputStages": [ "22", "23", "38" ], "name": "S27: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.04782608695652174, "readRatioMax": 0.06086956521739131, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "102", "shuffleOutputBytesSpilled": "0", "slotMs": "873", "startMs": "1665778442006", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_store_sk, $72:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$500", "FROM __stage26_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$420 := SUM($1360)" ] }, { "kind": "JOIN", "substeps": [ "$1360 := $1230", "SEMI HASH JOIN EACH WITH ALL ON $1231 = $500" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1221, $1231 := $41", "INNER HASH JOIN EACH WITH ALL ON $1220 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $71, $1221 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$420", "TO __stage27_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.017391304347826087, "waitRatioMax": 0.017391304347826087, "writeMsAvg": "3", "writeMsMax": "5", "writeRatioAvg": 0.013043478260869565, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.030434782608695653, "computeRatioMax": 0.030434782608695653, "endMs": "1665778442164", "id": "40", "inputStages": [ "39" ], "name": "S28: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778442007", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420", "FROM __stage27_output" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := NULL", "$351 := 1", "$352 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($420)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $360", "TO __stage28_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.021739130434782608, "waitRatioMax": 0.021739130434782608, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.034782608695652174, "computeRatioMax": 0.06521739130434782, "endMs": "1665778442063", "id": "41", "inputStages": [ "35" ], "name": "S29: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3476", "startMs": "1665778442007", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage23_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.013043478260869565, "writeMsAvg": "20", "writeMsMax": "30", "writeRatioAvg": 0.08695652173913043, "writeRatioMax": 0.13043478260869565 }, { "completedParallelInputs": "6", "computeMsAvg": "135", "computeMsMax": "169", "computeRatioAvg": 0.5869565217391305, "computeRatioMax": 0.7347826086956522, "endMs": "1665778442159", "id": "42", "inputStages": [ "27", "41", "28" ], "name": "S2A: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.05652173913043478, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "276", "shuffleOutputBytesSpilled": "0", "slotMs": "796", "startMs": "1665778442021", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_store_sk, $22:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$440", "FROM __stage29_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1021, $1031 := $1020", "$390 := SUM($1022)" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $891, $1021 := $892, $1022 := $890", "SEMI HASH JOIN EACH WITH ALL ON $892 = $440" ] }, { "kind": "JOIN", "substeps": [ "$890 := $881, $891 := $2, $892 := $3", "INNER HASH JOIN EACH WITH ALL ON $880 = $1" ] }, { "kind": "JOIN", "substeps": [ "$880 := $21, $881 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1031, $1030, $390", "TO __stage2A_output", "BY HASH($1030, $1031)" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "43", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.0391304347826087, "computeRatioMax": 0.07391304347826087, "endMs": "1665778442242", "id": "43", "inputStages": [ "37", "42", "40" ], "name": "S2B: Aggregate+", "parallelInputs": "43", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13", "recordsWritten": "3", "shuffleOutputBytes": "126", "shuffleOutputBytesSpilled": "0", "slotMs": "1443", "startMs": "1665778442190", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1031, $1030, $390", "FROM __stage2A_output" ] }, { "kind": "READ", "substeps": [ "$1200, $400", "FROM __stage25_output" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $360", "FROM __stage28_output" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := case_no_value(equal($243, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030, $1041 := $1031", "$330 := SUM($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := NULL", "$281 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200", "$340 := SUM($400)" ] }, { "kind": "WRITE", "substeps": [ "$220, $240, $241, $242, $244", "TO __stage2B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.06521739130434782, "writeRatioMax": 0.08260869565217391 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.02608695652173913, "computeRatioMax": 0.02608695652173913, "endMs": "1665778442310", "id": "44", "name": "S2C: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778442272", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $1431, $1432, $1430", "FROM __SHUFFLE20" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := coalesce($1440, 0)", "$261 := coalesce($1440, 1)", "$262 := coalesce($1441, '')", "$263 := coalesce($1441, '0')", "$264 := coalesce($1442, NUMERIC<...>)", "$265 := coalesce($1442, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1440 := $1430, $1441 := $1431, $1442 := $1432", "$320 := MIN($380)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "TO __stage2C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004347826086956522, "waitRatioMax": 0.004347826086956522, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.14347826086956522, "writeRatioMax": 0.14347826086956522 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.034782608695652174, "computeRatioMax": 0.0782608695652174, "endMs": "1665778442363", "id": "46", "inputStages": [ "44" ], "name": "S2E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3277", "startMs": "1665778442314", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage2C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.017391304347826087, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.06086956521739131, "writeRatioMax": 0.09130434782608696 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.0391304347826087, "computeRatioMax": 0.1, "endMs": "1665778442367", "id": "47", "inputStages": [ "43", "46" ], "name": "S2F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "153", "shuffleOutputBytesSpilled": "0", "slotMs": "3376", "startMs": "1665778442319", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $240, $241, $242, $244", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$300, $1400, $1401, $1402, $1403, $1404", "FROM __SHUFFLE19" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "FROM __stage2E_output" ] }, { "kind": "SORT", "substeps": [ "$204 DESC, $180 ASC, $200 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := case_no_value(equal($204, 0), $202, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1374, $1370 ORDER BY $1371 DESC)" ] }, { "kind": "SORT", "substeps": [ "$294 ASC, $290 ASC, $291 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1450 := $311, $1451 := $312, $1452 := $313, $1453 := $314, $1454 := $320", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261, $252 = $262, $253 = $263, $254 = $264, $255 = $265" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := coalesce($314, 0)", "$251 := coalesce($314, 1)", "$252 := coalesce($310, '')", "$253 := coalesce($310, '0')", "$254 := coalesce($311, NUMERIC<...>)", "$255 := coalesce($311, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "TO __stage2F_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.021739130434782608, "waitRatioMax": 0.02608695652173913, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.0782608695652174, "writeRatioMax": 0.12608695652173912 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05652173913043478, "computeRatioMax": 0.05652173913043478, "endMs": "1665778442387", "id": "48", "inputStages": [ "47" ], "name": "S30: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778442329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "FROM __stage2F_output" ] }, { "kind": "SORT", "substeps": [ "$1465 DESC, $1460 ASC, $1461 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1470, $1471, $1472, $1473, $1474", "TO __stage30_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.034782608695652174, "writeRatioMax": 0.034782608695652174 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "8", "completedUnits": "30", "elapsedMs": "631", "estimatedRunnableUnits": "0", "pendingUnits": "9", "totalSlotMs": "3201" }, { "activeUnits": "0", "completedUnits": "1203", "elapsedMs": "1361", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "46653" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89176796", "totalPartitionsProcessed": "0", "totalSlotMs": "46653", "transferredBytes": "0" }, "startTime": "1665778441113", "totalBytesProcessed": "89176796", "totalSlotMs": "46653" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona6f62c28_7fac_4868_ac82_16fd8de60c60" }, "priority": "INTERACTIVE", "query": "-- start query 70 in stream 0 using template query70.tpl\nWITH results AS\n (SELECT sum(ss_net_profit) AS total_sum,\n s_state,\n s_county,\n 0 AS gstate,\n 0 AS g_county\n FROM store_sales ,\n date_dim d1 ,\n store\n WHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d1.d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n AND s_state IN\n (SELECT s_state\n FROM\n (SELECT s_state AS s_state,\n rank() OVER (PARTITION BY s_state\n ORDER BY sum(ss_net_profit) DESC) AS ranking\n FROM store_sales,\n store,\n date_dim\n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n AND d_date_sk = ss_sold_date_sk\n AND s_store_sk = ss_store_sk\n GROUP BY s_state ) tmp1\n WHERE ranking <= 5)\n GROUP BY s_state,\n s_county),\n results_rollup AS\n (SELECT total_sum,\n s_state,\n s_county,\n 0 AS g_state,\n 0 AS g_county,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT sum(total_sum) AS total_sum,\n s_state,\n NULL AS s_county,\n 0 AS g_state,\n 1 AS g_county,\n 1 AS lochierarchy\n FROM results\n GROUP BY s_state\n UNION ALL SELECT sum(total_sum) AS total_sum,\n NULL AS s_state,\n NULL AS s_county,\n 1 AS g_state,\n 1 AS g_county,\n 2 AS lochierarchy\n FROM results)\nSELECT total_sum,\n s_state,\n s_county,\n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN g_county = 0 THEN s_state\n END\n ORDER BY total_sum DESC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN s_state\n END ,\n rank_within_parent\nLIMIT 100;\n-- end query 70 in stream 0 using template query70.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Jr0Jifgrp2W9xy2KezsAZw==", "id": "test-project-364309:europe-west1.query70_1665778444", "jobReference": { "jobId": "query70_1665778444", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query70_1665778444?location=europe-west1", "statistics": { "creationTime": "1665778445005", "endTime": "1665778446323", "finalExecutionDurationMs": "1087", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89176796", "performanceInsights": { "avgPreviousExecutionMs": "1213" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04868913857677903, "computeRatioMax": 0.04868913857677903, "endMs": "1665778445205", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.026217228464419477, "readRatioMax": 0.026217228464419477, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778445163", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_month_seq", "FROM date_dim", "WHERE between($171, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04868913857677903, "writeRatioMax": 0.04868913857677903 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04119850187265917, "computeRatioMax": 0.04119850187265917, "endMs": "1665778445212", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.026217228464419477, "readRatioMax": 0.026217228464419477, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778445177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:s_store_sk, $161:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.033707865168539325, "writeRatioMax": 0.033707865168539325 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0449438202247191, "computeRatioMax": 0.0449438202247191, "endMs": "1665778445243", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.033707865168539325, "readRatioMax": 0.033707865168539325, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778445205", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_month_seq", "FROM date_dim", "WHERE between($141, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0299625468164794, "writeRatioMax": 0.0299625468164794 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.0299625468164794, "endMs": "1665778445274", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02247191011235955, "readRatioMax": 0.02247191011235955, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778445244", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:s_store_sk, $131:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage04_output" ] } ], "waitMsAvg": "27", "waitMsMax": "27", "waitRatioAvg": 0.10112359550561797, "waitRatioMax": 0.10112359550561797, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.06741573033707865, "writeRatioMax": 0.06741573033707865 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03745318352059925, "computeRatioMax": 0.03745318352059925, "endMs": "1665778445304", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0299625468164794, "readRatioMax": 0.0299625468164794, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778445270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_month_seq", "FROM date_dim", "WHERE between($111, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage06_output" ] } ], "waitMsAvg": "25", "waitMsMax": "25", "waitRatioAvg": 0.09363295880149813, "waitRatioMax": 0.09363295880149813, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.026217228464419477, "writeRatioMax": 0.026217228464419477 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.0299625468164794, "endMs": "1665778445308", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0149812734082397, "readRatioMax": 0.0149812734082397, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778445269", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:s_store_sk, $101:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage07_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.04868913857677903, "waitRatioMax": 0.04868913857677903, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.056179775280898875, "writeRatioMax": 0.056179775280898875 }, { "completedParallelInputs": "6", "computeMsAvg": "161", "computeMsMax": "267", "computeRatioAvg": 0.602996254681648, "computeRatioMax": 1, "endMs": "1665778445443", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "17", "readRatioAvg": 0.0449438202247191, "readRatioMax": 0.06367041198501873, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "828", "startMs": "1665778445282", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ss_sold_date_sk, $151:ss_store_sk, $152:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1251", "$740 := SUM($1250)" ] }, { "kind": "JOIN", "substeps": [ "$1250 := $1241, $1251 := $1242", "INNER HASH JOIN EACH WITH ALL ON $1240 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $150, $1241 := $152, $1242 := $161", "INNER HASH JOIN EACH WITH ALL ON $151 = $160" ] }, { "kind": "WRITE", "substeps": [ "$1260, $740", "TO __stage09_output", "BY HASH($1260)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.02247191011235955, "writeRatioMax": 0.0299625468164794 }, { "completedParallelInputs": "6", "computeMsAvg": "130", "computeMsMax": "165", "computeRatioAvg": 0.4868913857677903, "computeRatioMax": 0.6179775280898876, "endMs": "1665778445408", "id": "10", "inputStages": [ "4", "3" ], "name": "S0A: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "14", "readRatioAvg": 0.0449438202247191, "readRatioMax": 0.052434456928838954, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "770", "startMs": "1665778445303", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ss_sold_date_sk, $121:ss_store_sk, $122:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1081", "$670 := SUM($1080)" ] }, { "kind": "JOIN", "substeps": [ "$1080 := $1071, $1081 := $1072", "INNER HASH JOIN EACH WITH ALL ON $1070 = $140" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $120, $1071 := $122, $1072 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$1090, $670", "TO __stage0A_output", "BY HASH($1090)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.02247191011235955, "writeRatioMax": 0.0299625468164794 }, { "completedParallelInputs": "6", "computeMsAvg": "142", "computeMsMax": "176", "computeRatioAvg": 0.5318352059925093, "computeRatioMax": 0.6591760299625468, "endMs": "1665778445474", "id": "11", "inputStages": [ "7", "6" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.0449438202247191, "readRatioMax": 0.056179775280898875, "recordsRead": "2882672", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "1114", "startMs": "1665778445329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_store_sk, $92:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $911", "$620 := SUM($910)" ] }, { "kind": "JOIN", "substeps": [ "$910 := $901, $911 := $902", "INNER HASH JOIN EACH WITH ALL ON $900 = $110" ] }, { "kind": "JOIN", "substeps": [ "$900 := $90, $901 := $92, $902 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$920, $620", "TO __stage0B_output", "BY HASH($920)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "7", "writeMsMax": "11", "writeRatioAvg": 0.026217228464419477, "writeRatioMax": 0.04119850187265917 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04119850187265917, "computeRatioMax": 0.04119850187265917, "endMs": "1665778445469", "id": "12", "inputStages": [ "10" ], "name": "S0C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778445434", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1090, $670", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$530 := SUM($670)" ] }, { "kind": "WRITE", "substeps": [ "$1100, $530", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.10112359550561797, "writeRatioMax": 0.10112359550561797 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.052434456928838954, "computeRatioMax": 0.052434456928838954, "endMs": "1665778445498", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778445460", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1260, $740", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1270 := $1260", "$600 := SUM($740)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $600", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.052434456928838954 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.018726591760299626, "computeRatioMax": 0.018726591760299626, "endMs": "1665778445528", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778445489", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$820, $1160, $1161", "FROM __SHUFFLE10" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := coalesce($1170, '')", "$591 := coalesce($1170, '0')", "$592 := coalesce($1171, NUMERIC<...>)", "$593 := coalesce($1171, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1170 := $1160, $1171 := $1161", "$710 := MIN($820)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $710", "TO __stage0E_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.07116104868913857, "writeRatioMax": 0.07116104868913857 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.018726591760299626, "computeRatioMax": 0.018726591760299626, "endMs": "1665778445538", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0149812734082397, "readRatioMax": 0.0149812734082397, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778445513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.056179775280898875, "writeRatioMax": 0.056179775280898875 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.033707865168539325, "computeRatioMax": 0.033707865168539325, "endMs": "1665778445566", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02247191011235955, "readRatioMax": 0.02247191011235955, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778445524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.056179775280898875, "writeRatioMax": 0.056179775280898875 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.02247191011235955, "computeRatioMax": 0.02247191011235955, "endMs": "1665778445585", "id": "19", "inputStages": [ "11" ], "name": "S13: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "24", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778445551", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$920, $620", "FROM __stage0B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $930 := $920", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$930, $510", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0599250936329588, "writeRatioMax": 0.0599250936329588 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04868913857677903, "computeRatioMax": 0.04868913857677903, "endMs": "1665778445594", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778445567", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$860, $1330, $1331", "FROM __SHUFFLE16" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := coalesce($1340, '')", "$731 := coalesce($1340, '0')", "$732 := coalesce($1341, NUMERIC<...>)", "$733 := coalesce($1341, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1340 := $1330, $1341 := $1331", "$780 := MIN($860)" ] }, { "kind": "WRITE", "substeps": [ "$730, $731, $732, $733, $780", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.0749063670411985, "writeRatioMax": 0.0749063670411985 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.052434456928838954, "computeRatioMax": 0.052434456928838954, "endMs": "1665778445632", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.033707865168539325, "readRatioMax": 0.033707865168539325, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778445594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage16_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0299625468164794, "writeRatioMax": 0.0299625468164794 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04119850187265917, "computeRatioMax": 0.04119850187265917, "endMs": "1665778445648", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03745318352059925, "readRatioMax": 0.03745318352059925, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778445609", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.026217228464419477, "writeRatioMax": 0.026217228464419477 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.026217228464419477, "computeRatioMax": 0.0599250936329588, "endMs": "1665778445676", "id": "25", "inputStages": [ "14" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3205", "startMs": "1665778445621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.0149812734082397, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.07865168539325842 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.056179775280898875, "endMs": "1665778445676", "id": "26", "inputStages": [ "25", "12" ], "name": "S1A: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2914", "startMs": "1665778445636", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1100, $530", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$690, $1140, $1141", "FROM __SHUFFLE9" ] }, { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $710", "FROM __stage19_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($461, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := RANK() OVER (PARTITION BY $1110 ORDER BY $1111 DESC)" ] }, { "kind": "SORT", "substeps": [ "$680 ASC, $681 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $700, $1181 := $710", "INNER HASH JOIN EACH WITH ALL ON $580 = $590, $581 = $591, $582 = $592, $583 = $593" ] }, { "kind": "COMPUTE", "substeps": [ "$580 := coalesce($700, '')", "$581 := coalesce($700, '0')", "$582 := coalesce($701, NUMERIC<...>)", "$583 := coalesce($701, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$460", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.0149812734082397, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.06367041198501873 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.02247191011235955, "computeRatioMax": 0.02247191011235955, "endMs": "1665778445683", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778445648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $990, $991", "FROM __SHUFFLE4" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := coalesce($1000, '')", "$571 := coalesce($1000, '0')", "$572 := coalesce($1001, NUMERIC<...>)", "$573 := coalesce($1001, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1000 := $990, $1001 := $991", "$660 := MIN($800)" ] }, { "kind": "WRITE", "substeps": [ "$570, $571, $572, $573, $660", "TO __stage1B_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06367041198501873, "writeRatioMax": 0.06367041198501873 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.026217228464419477, "computeRatioMax": 0.026217228464419477, "endMs": "1665778445719", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0149812734082397, "readRatioMax": 0.0149812734082397, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "456", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778445680", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_county, $3:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06367041198501873, "writeRatioMax": 0.06367041198501873 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.026217228464419477, "computeRatioMax": 0.026217228464419477, "endMs": "1665778445719", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.026217228464419477, "readRatioMax": 0.026217228464419477, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778445692", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04868913857677903, "writeRatioMax": 0.04868913857677903 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.056179775280898875, "endMs": "1665778445779", "id": "32", "inputStages": [ "20" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3907", "startMs": "1665778445712", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.0149812734082397, "waitRatioMax": 0.02247191011235955, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.10112359550561797 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.033707865168539325, "computeRatioMax": 0.0749063670411985, "endMs": "1665778445783", "id": "33", "inputStages": [ "32", "13" ], "name": "S21: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2948", "startMs": "1665778445724", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $600", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$760, $1310, $1311", "FROM __SHUFFLE15" ] }, { "kind": "READ", "substeps": [ "$730, $731, $732, $733, $780", "FROM __stage20_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($501, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$550 := RANK() OVER (PARTITION BY $1280 ORDER BY $1281 DESC)" ] }, { "kind": "SORT", "substeps": [ "$750 ASC, $751 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1350 := $770, $1351 := $780", "INNER HASH JOIN EACH WITH ALL ON $720 = $730, $721 = $731, $722 = $732, $723 = $733" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($770, '')", "$721 := coalesce($770, '0')", "$722 := coalesce($771, NUMERIC<...>)", "$723 := coalesce($771, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$500", "TO __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.00749063670411985, "waitRatioMax": 0.0149812734082397, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.08239700374531835 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.052434456928838954, "endMs": "1665778445828", "id": "34", "inputStages": [ "26" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3083", "startMs": "1665778445774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.00749063670411985, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.07116104868913857 }, { "completedParallelInputs": "6", "computeMsAvg": "131", "computeMsMax": "153", "computeRatioAvg": 0.49063670411985016, "computeRatioMax": 0.5730337078651685, "endMs": "1665778445922", "id": "35", "inputStages": [ "17", "16", "34" ], "name": "S23: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "24", "readRatioAvg": 0.056179775280898875, "readRatioMax": 0.0898876404494382, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "747", "startMs": "1665778445786", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$460", "FROM __stage22_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$400 := SUM($1191)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1061, $1191 := $1060", "SEMI HASH JOIN EACH WITH ALL ON $1061 = $460" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $1051, $1061 := $11", "INNER HASH JOIN EACH WITH ALL ON $1050 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $31, $1051 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$1200, $400", "TO __stage23_output", "BY HASH($1200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02247191011235955, "writeRatioMax": 0.02247191011235955 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.052434456928838954, "endMs": "1665778445843", "id": "36", "inputStages": [ "27" ], "name": "S24: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3507", "startMs": "1665778445790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.0149812734082397, "writeMsAvg": "20", "writeMsMax": "30", "writeRatioAvg": 0.0749063670411985, "writeRatioMax": 0.11235955056179775 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.033707865168539325, "computeRatioMax": 0.06741573033707865, "endMs": "1665778445854", "id": "37", "inputStages": [ "36", "19" ], "name": "S25: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3487", "startMs": "1665778445800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$930, $510", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$640, $970, $971", "FROM __SHUFFLE3" ] }, { "kind": "READ", "substeps": [ "$570, $571, $572, $573, $660", "FROM __stage24_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($441, 5)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$470 := RANK() OVER (PARTITION BY $940 ORDER BY $941 DESC)" ] }, { "kind": "SORT", "substeps": [ "$630 ASC, $631 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $650, $1011 := $660", "INNER HASH JOIN EACH WITH ALL ON $560 = $570, $561 = $571, $562 = $572, $563 = $573" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($650, '')", "$561 := coalesce($650, '0')", "$562 := coalesce($651, NUMERIC<...>)", "$563 := coalesce($651, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$440", "TO __stage25_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.00749063670411985, "waitRatioMax": 0.0149812734082397, "writeMsAvg": "24", "writeMsMax": "46", "writeRatioAvg": 0.0898876404494382, "writeRatioMax": 0.17228464419475656 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.026217228464419477, "computeRatioMax": 0.0449438202247191, "endMs": "1665778445852", "id": "38", "inputStages": [ "33" ], "name": "S26: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "3075", "startMs": "1665778445804", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00749063670411985, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.04868913857677903, "writeRatioMax": 0.0749063670411985 }, { "completedParallelInputs": "6", "computeMsAvg": "118", "computeMsMax": "143", "computeRatioAvg": 0.4419475655430712, "computeRatioMax": 0.5355805243445693, "endMs": "1665778445932", "id": "39", "inputStages": [ "23", "38", "22" ], "name": "S27: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "19", "readRatioAvg": 0.04868913857677903, "readRatioMax": 0.07116104868913857, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "102", "shuffleOutputBytesSpilled": "0", "slotMs": "741", "startMs": "1665778445813", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_store_sk, $72:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$500", "FROM __stage26_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$420 := SUM($1360)" ] }, { "kind": "JOIN", "substeps": [ "$1360 := $1230", "SEMI HASH JOIN EACH WITH ALL ON $1231 = $500" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1221, $1231 := $41", "INNER HASH JOIN EACH WITH ALL ON $1220 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $71, $1221 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$420", "TO __stage27_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00749063670411985, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "3", "writeMsMax": "4", "writeRatioAvg": 0.011235955056179775, "writeRatioMax": 0.0149812734082397 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.0149812734082397, "computeRatioMax": 0.0149812734082397, "endMs": "1665778445944", "id": "40", "inputStages": [ "39" ], "name": "S28: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665778445813", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420", "FROM __stage27_output" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := NULL", "$351 := 1", "$352 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($420)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $360", "TO __stage28_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0149812734082397, "waitRatioMax": 0.0149812734082397, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.003745318352059925, "writeRatioMax": 0.003745318352059925 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.056179775280898875, "endMs": "1665778445915", "id": "41", "inputStages": [ "37" ], "name": "S29: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "7", "shuffleOutputBytesSpilled": "0", "slotMs": "2962", "startMs": "1665778445869", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage25_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.00749063670411985, "writeMsAvg": "13", "writeMsMax": "17", "writeRatioAvg": 0.04868913857677903, "writeRatioMax": 0.06367041198501873 }, { "completedParallelInputs": "6", "computeMsAvg": "145", "computeMsMax": "202", "computeRatioAvg": 0.5430711610486891, "computeRatioMax": 0.7565543071161048, "endMs": "1665778446030", "id": "42", "inputStages": [ "29", "41", "30" ], "name": "S2A: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "20", "readRatioAvg": 0.04868913857677903, "readRatioMax": 0.0749063670411985, "recordsRead": "2882678", "recordsWritten": "6", "shuffleOutputBytes": "276", "shuffleOutputBytesSpilled": "0", "slotMs": "970", "startMs": "1665778445883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_store_sk, $22:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$440", "FROM __stage29_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1021, $1031 := $1020", "$390 := SUM($1022)" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $891, $1021 := $892, $1022 := $890", "SEMI HASH JOIN EACH WITH ALL ON $892 = $440" ] }, { "kind": "JOIN", "substeps": [ "$890 := $881, $891 := $2, $892 := $3", "INNER HASH JOIN EACH WITH ALL ON $880 = $1" ] }, { "kind": "JOIN", "substeps": [ "$880 := $21, $881 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1031, $1030, $390", "TO __stage2A_output", "BY HASH($1030, $1031)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.02247191011235955, "writeRatioMax": 0.026217228464419477 }, { "completedParallelInputs": "43", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.033707865168539325, "computeRatioMax": 0.06367041198501873, "endMs": "1665778446094", "id": "43", "inputStages": [ "40", "35", "42" ], "name": "S2B: Aggregate+", "parallelInputs": "43", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13", "recordsWritten": "3", "shuffleOutputBytes": "126", "shuffleOutputBytesSpilled": "0", "slotMs": "1435", "startMs": "1665778446055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1031, $1030, $390", "FROM __stage2A_output" ] }, { "kind": "READ", "substeps": [ "$1200, $400", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $360", "FROM __stage28_output" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := case_no_value(equal($243, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030, $1041 := $1031", "$330 := SUM($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := NULL", "$281 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200", "$340 := SUM($400)" ] }, { "kind": "WRITE", "substeps": [ "$220, $240, $241, $242, $244", "TO __stage2B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.00749063670411985, "writeMsAvg": "14", "writeMsMax": "16", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.0599250936329588 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.026217228464419477, "computeRatioMax": 0.026217228464419477, "endMs": "1665778446147", "id": "44", "name": "S2C: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778446114", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $1431, $1432, $1430", "FROM __SHUFFLE20" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := coalesce($1440, 0)", "$261 := coalesce($1440, 1)", "$262 := coalesce($1441, '')", "$263 := coalesce($1441, '0')", "$264 := coalesce($1442, NUMERIC<...>)", "$265 := coalesce($1442, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1440 := $1430, $1441 := $1431, $1442 := $1432", "$320 := MIN($380)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "TO __stage2C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06367041198501873, "writeRatioMax": 0.06367041198501873 }, { "completedParallelInputs": "96", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.052434456928838954, "endMs": "1665778446202", "id": "46", "inputStages": [ "44" ], "name": "S2E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3152", "startMs": "1665778446158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage2C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.00749063670411985, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.07865168539325842 }, { "completedParallelInputs": "101", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.026217228464419477, "computeRatioMax": 0.056179775280898875, "endMs": "1665778446202", "id": "47", "inputStages": [ "46", "43" ], "name": "S2F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "153", "shuffleOutputBytesSpilled": "0", "slotMs": "2745", "startMs": "1665778446163", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $240, $241, $242, $244", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$300, $1400, $1401, $1402, $1403, $1404", "FROM __SHUFFLE19" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264, $265, $320", "FROM __stage2E_output" ] }, { "kind": "SORT", "substeps": [ "$204 DESC, $180 ASC, $200 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := case_no_value(equal($204, 0), $202, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1374, $1370 ORDER BY $1371 DESC)" ] }, { "kind": "SORT", "substeps": [ "$294 ASC, $290 ASC, $291 DESC" ] }, { "kind": "JOIN", "substeps": [ "$1450 := $311, $1451 := $312, $1452 := $313, $1453 := $314, $1454 := $320", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261, $252 = $262, $253 = $263, $254 = $264, $255 = $265" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := coalesce($314, 0)", "$251 := coalesce($314, 1)", "$252 := coalesce($310, '')", "$253 := coalesce($310, '0')", "$254 := coalesce($311, NUMERIC<...>)", "$255 := coalesce($311, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "TO __stage2F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.00749063670411985, "waitRatioMax": 0.0149812734082397, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.052434456928838954, "writeRatioMax": 0.07116104868913857 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0299625468164794, "computeRatioMax": 0.0299625468164794, "endMs": "1665778446214", "id": "48", "inputStages": [ "47" ], "name": "S30: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "144", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665778446173", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1460, $1461, $1462, $1463, $1464, $1465", "FROM __stage2F_output" ] }, { "kind": "SORT", "substeps": [ "$1465 DESC, $1460 ASC, $1461 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1470, $1471, $1472, $1473, $1474", "TO __stage30_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00749063670411985, "waitRatioMax": 0.00749063670411985, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.011235955056179775, "writeRatioMax": 0.011235955056179775 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "110", "completedUnits": "123", "elapsedMs": "616", "estimatedRunnableUnits": "0", "pendingUnits": "120", "totalSlotMs": "6434" }, { "activeUnits": "202", "completedUnits": "1200", "elapsedMs": "1217", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "42252" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89176796", "totalPartitionsProcessed": "0", "totalSlotMs": "42252", "transferredBytes": "0" }, "startTime": "1665778445051", "totalBytesProcessed": "89176796", "totalSlotMs": "42252" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
