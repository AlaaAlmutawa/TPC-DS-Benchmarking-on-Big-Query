{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon06b46767_3585_42de_ae9c_0391087fd28c" }, "priority": "INTERACTIVE", "query": "WITH results AS\n (SELECT sum(ss_net_profit) AS ss_net_profit,\n sum(ss_ext_sales_price) AS ss_ext_sales_price,\n (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin ,\n i_category ,\n i_class \n FROM store_sales ,\n date_dim d1 ,\n item ,\n store\n WHERE d1.d_year = 2001\n AND d1.d_date_sk = ss_sold_date_sk\n AND i_item_sk = ss_item_sk\n AND s_store_sk = ss_store_sk\n AND s_state in ('TN')\n GROUP BY i_category,\n i_class) ,\n results_rollup AS\n (SELECT gross_margin,\n i_category,\n i_class,\n 0 AS t_category,\n 0 AS t_class,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n i_category,\n NULL AS i_class,\n 0 AS t_category,\n 1 AS t_class,\n 1 AS lochierarchy\n FROM results\n GROUP BY i_category\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n NULL AS i_category,\n NULL AS i_class,\n 1 AS t_category,\n 1 AS t_class,\n 2 AS lochierarchy\n FROM results)\nSELECT gross_margin,\n i_category,\n i_class, \n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN t_class = 0 THEN i_category\n END\n ORDER BY gross_margin ASC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN i_category\n END ,\n rank_within_parent\nLIMIT 100;\n\n\n-- select \n-- sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n-- ,i_category\n-- ,i_class\n-- ,grouping(i_category)+grouping(i_class) as lochierarchy\n-- ,rank() over (\n-- \tpartition by grouping(i_category)+grouping(i_class),\n-- \tcase when grouping(i_class) = 0 then i_category end \n-- \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n-- from\n-- store_sales\n-- ,date_dim d1\n-- ,item\n-- ,store\n-- where\n-- d1.d_year = 2001 \n-- and d1.d_date_sk = ss_sold_date_sk\n-- and i_item_sk = ss_item_sk \n-- and s_store_sk = ss_store_sk\n-- and s_state in ('TN','TN','TN','TN',\n-- 'TN','TN','TN','TN')\n-- group by rollup(i_category,i_class)\n-- order by\n-- lochierarchy desc\n-- ,case when lochierarchy = 0 then i_category end\n-- ,rank_within_parent\n-- limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "J/FIID90Hy1//QagP+5Q/g==", "id": "test-project-364309:europe-west1.query36_1665768330", "jobReference": { "jobId": "query36_1665768330", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query36_1665768330?location=europe-west1", "statistics": { "creationTime": "1665768330932", "endTime": "1665768331887", "finalExecutionDurationMs": "754", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156682367", "performanceInsights": { "avgPreviousExecutionMs": "806" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.024324324324324326, "computeRatioMax": 0.024324324324324326, "endMs": "1665768331130", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.016216216216216217, "readRatioMax": 0.016216216216216217, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768331093", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:s_store_sk, $71:s_state", "FROM store", "WHERE in($71, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.024324324324324326, "writeRatioMax": 0.024324324324324326 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.04594594594594595, "computeRatioMax": 0.04594594594594595, "endMs": "1665768331138", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02702702702702703, "readRatioMax": 0.02702702702702703, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768331108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.021621621621621623, "writeRatioMax": 0.021621621621621623 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02702702702702703, "computeRatioMax": 0.02702702702702703, "endMs": "1665768331163", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01891891891891892, "readRatioMax": 0.01891891891891892, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768331121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03783783783783784, "writeRatioMax": 0.03783783783783784 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.032432432432432434, "computeRatioMax": 0.032432432432432434, "endMs": "1665768331189", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.016216216216216217, "readRatioMax": 0.016216216216216217, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768331150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_state", "FROM store", "WHERE in($31, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.024324324324324326, "writeRatioMax": 0.024324324324324326 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.05405405405405406, "computeRatioMax": 0.05405405405405406, "endMs": "1665768331194", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013513513513513514, "readRatioMax": 0.013513513513513514, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768331163", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03783783783783784, "writeRatioMax": 0.03783783783783784 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03513513513513514, "computeRatioMax": 0.03513513513513514, "endMs": "1665768331216", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01891891891891892, "readRatioMax": 0.01891891891891892, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665768331177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03513513513513514, "writeRatioMax": 0.03513513513513514 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.021621621621621623, "computeRatioMax": 0.021621621621621623, "endMs": "1665768331234", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013513513513513514, "readRatioMax": 0.013513513513513514, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768331206", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04054054054054054, "writeRatioMax": 0.04054054054054054 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.051351351351351354, "computeRatioMax": 0.051351351351351354, "endMs": "1665768331272", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.032432432432432434, "readRatioMax": 0.032432432432432434, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768331226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.05675675675675676, "writeRatioMax": 0.05675675675675676 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.032432432432432434, "computeRatioMax": 0.032432432432432434, "endMs": "1665768331272", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.032432432432432434, "readRatioMax": 0.032432432432432434, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768331240", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02702702702702703, "writeRatioMax": 0.02702702702702703 }, { "completedParallelInputs": "6", "computeMsAvg": "260", "computeMsMax": "370", "computeRatioAvg": 0.7027027027027027, "computeRatioMax": 1, "endMs": "1665768331482", "id": "12", "inputStages": [ "0", "1", "2" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "34", "readRatioAvg": 0.062162162162162166, "readRatioMax": 0.0918918918918919, "recordsRead": "2990666", "recordsWritten": "6", "shuffleOutputBytes": "204", "shuffleOutputBytesSpilled": "0", "slotMs": "1537", "startMs": "1665768331256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_ext_sales_price, $104:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($491)", "$361 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482", "INNER HASH JOIN EACH WITH ALL ON $480 = $70" ] }, { "kind": "JOIN", "substeps": [ "$480 := $471, $481 := $472, $482 := $473", "INNER HASH JOIN EACH WITH ALL ON $470 = $60" ] }, { "kind": "JOIN", "substeps": [ "$470 := $101, $471 := $102, $472 := $103, $473 := $104", "INNER HASH JOIN EACH WITH ALL ON $100 = $110" ] }, { "kind": "WRITE", "substeps": [ "$360, $361", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005405405405405406, "waitRatioMax": 0.005405405405405406, "writeMsAvg": "1", "writeMsMax": "4", "writeRatioAvg": 0.002702702702702703, "writeRatioMax": 0.010810810810810811 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.013513513513513514, "computeRatioMax": 0.013513513513513514, "endMs": "1665768331489", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665768331258", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := NULL", "$291 := divide(multiply($300, NUMERIC<...>), $301)", "$292 := 1", "$293 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.010810810810810811, "waitRatioMax": 0.010810810810810811, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002702702702702703, "writeRatioMax": 0.002702702702702703 }, { "completedParallelInputs": "6", "computeMsAvg": "305", "computeMsMax": "362", "computeRatioAvg": 0.8243243243243243, "computeRatioMax": 0.9783783783783784, "endMs": "1665768331585", "id": "14", "inputStages": [ "6", "4", "5" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "46", "readRatioAvg": 0.06486486486486487, "readRatioMax": 0.12432432432432433, "recordsRead": "2990666", "recordsWritten": "66", "shuffleOutputBytes": "2904", "shuffleOutputBytesSpilled": "0", "slotMs": "1783", "startMs": "1665768331276", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_item_sk, $52:ss_store_sk, $53:ss_ext_sales_price, $54:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$340 := SUM($442)", "$341 := SUM($441)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $433, $441 := $431, $442 := $432", "INNER HASH JOIN EACH WITH ALL ON $430 = $30" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $21", "INNER HASH JOIN EACH WITH ALL ON $420 = $20" ] }, { "kind": "JOIN", "substeps": [ "$420 := $51, $421 := $52, $422 := $53, $423 := $54", "INNER HASH JOIN EACH WITH ALL ON $50 = $90" ] }, { "kind": "WRITE", "substeps": [ "$450, $340, $341", "TO __stage0E_output", "BY HASH($450)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "9", "writeMsMax": "16", "writeRatioAvg": 0.024324324324324326, "writeRatioMax": 0.043243243243243246 }, { "completedParallelInputs": "6", "computeMsAvg": "314", "computeMsMax": "366", "computeRatioAvg": 0.8486486486486486, "computeRatioMax": 0.9891891891891892, "endMs": "1665768331527", "id": "15", "inputStages": [ "10", "9", "8" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "27", "readRatioAvg": 0.05405405405405406, "readRatioMax": 0.07297297297297298, "recordsRead": "2990666", "recordsWritten": "726", "shuffleOutputBytes": "40800", "shuffleOutputBytesSpilled": "0", "slotMs": "1927", "startMs": "1665768331298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_ext_sales_price, $44:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391, $401 := $390", "$330 := SUM($393)", "$331 := SUM($392)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $383, $391 := $384, $392 := $381, $393 := $382", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $2, $384 := $3", "INNER HASH JOIN EACH WITH ALL ON $370 = $1" ] }, { "kind": "JOIN", "substeps": [ "$370 := $41, $371 := $42, $372 := $43, $373 := $44", "INNER HASH JOIN EACH WITH ALL ON $40 = $80" ] }, { "kind": "WRITE", "substeps": [ "$401, $400, $330, $331", "TO __stage0F_output", "BY HASH($400, $401)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.021621621621621623, "writeRatioMax": 0.02702702702702703 }, { "completedParallelInputs": "3", "computeMsAvg": "9", "computeMsMax": "11", "computeRatioAvg": 0.024324324324324326, "computeRatioMax": 0.02972972972972973, "endMs": "1665768331672", "id": "16", "inputStages": [ "14", "15", "13" ], "name": "S10: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "793", "recordsWritten": "133", "shuffleOutputBytes": "7516", "shuffleOutputBytesSpilled": "0", "slotMs": "137", "startMs": "1665768331620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$401, $400, $330, $331", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$450, $340, $341", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := case_no_value(equal($183, 0), $181, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := 0", "$211 := divide(multiply($270, NUMERIC<...>), $271)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := NULL", "$221 := divide(multiply($280, NUMERIC<...>), $281)", "$222 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$160, $180, $181, $182, $184", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "27", "writeMsMax": "29", "writeRatioAvg": 0.07297297297297298, "writeRatioMax": 0.07837837837837838 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01891891891891892, "computeRatioMax": 0.01891891891891892, "endMs": "1665768331732", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768331699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $561, $562, $560", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($570, 0)", "$201 := coalesce($570, 1)", "$202 := coalesce($571, '')", "$203 := coalesce($571, '0')", "$204 := coalesce($572, NUMERIC<...>)", "$205 := coalesce($572, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$260 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.07837837837837838, "writeRatioMax": 0.07837837837837838 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.021621621621621623, "computeRatioMax": 0.04594594594594595, "endMs": "1665768331786", "id": "19", "inputStages": [ "17" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3752", "startMs": "1665768331738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005405405405405406, "waitRatioMax": 0.008108108108108109, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.03783783783783784, "writeRatioMax": 0.05675675675675676 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.021621621621621623, "computeRatioMax": 0.04594594594594595, "endMs": "1665768331802", "id": "20", "inputStages": [ "16", "19" ], "name": "S14: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8713", "shuffleOutputBytesSpilled": "0", "slotMs": "2886", "startMs": "1665768331744", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $180, $181, $182, $184", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$240, $530, $531, $532, $533, $534", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$144 DESC, $120 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := case_no_value(equal($144, 0), $142, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := RANK() OVER (PARTITION BY $504, $500 ORDER BY $501 ASC)" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC, $231 ASC" ] }, { "kind": "JOIN", "substeps": [ "$580 := $251, $581 := $252, $582 := $253, $583 := $254, $584 := $260", "INNER HASH JOIN EACH WITH ALL ON $190 = $200, $191 = $201, $192 = $202, $193 = $203, $194 = $204, $195 = $205" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($254, 0)", "$191 := coalesce($254, 1)", "$192 := coalesce($250, '')", "$193 := coalesce($250, '0')", "$194 := coalesce($251, NUMERIC<...>)", "$195 := coalesce($251, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $594, $595", "TO __stage14_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.010810810810810811, "waitRatioMax": 0.013513513513513514, "writeMsAvg": "13", "writeMsMax": "22", "writeRatioAvg": 0.03513513513513514, "writeRatioMax": 0.05945945945945946 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03513513513513514, "computeRatioMax": 0.03513513513513514, "endMs": "1665768331813", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5627", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768331753", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $594, $595", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$595 DESC, $590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002702702702702703, "waitRatioMax": 0.002702702702702703, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.013513513513513514, "writeRatioMax": 0.013513513513513514 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "28", "elapsedMs": "618", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5987" }, { "activeUnits": "0", "completedUnits": "234", "elapsedMs": "875", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12842" } ], "totalBytesBilled": "157286400", "totalBytesProcessed": "156682367", "totalPartitionsProcessed": "0", "totalSlotMs": "12842", "transferredBytes": "0" }, "startTime": "1665768330976", "totalBytesProcessed": "156682367", "totalSlotMs": "12842" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond8d8aebc_708f_43c0_9cec_24664f46c30d" }, "priority": "INTERACTIVE", "query": "WITH results AS\n (SELECT sum(ss_net_profit) AS ss_net_profit,\n sum(ss_ext_sales_price) AS ss_ext_sales_price,\n (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin ,\n i_category ,\n i_class \n FROM store_sales ,\n date_dim d1 ,\n item ,\n store\n WHERE d1.d_year = 2001\n AND d1.d_date_sk = ss_sold_date_sk\n AND i_item_sk = ss_item_sk\n AND s_store_sk = ss_store_sk\n AND s_state in ('TN')\n GROUP BY i_category,\n i_class) ,\n results_rollup AS\n (SELECT gross_margin,\n i_category,\n i_class,\n 0 AS t_category,\n 0 AS t_class,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n i_category,\n NULL AS i_class,\n 0 AS t_category,\n 1 AS t_class,\n 1 AS lochierarchy\n FROM results\n GROUP BY i_category\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n NULL AS i_category,\n NULL AS i_class,\n 1 AS t_category,\n 1 AS t_class,\n 2 AS lochierarchy\n FROM results)\nSELECT gross_margin,\n i_category,\n i_class, \n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN t_class = 0 THEN i_category\n END\n ORDER BY gross_margin ASC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN i_category\n END ,\n rank_within_parent\nLIMIT 100;\n\n\n-- select \n-- sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n-- ,i_category\n-- ,i_class\n-- ,grouping(i_category)+grouping(i_class) as lochierarchy\n-- ,rank() over (\n-- \tpartition by grouping(i_category)+grouping(i_class),\n-- \tcase when grouping(i_class) = 0 then i_category end \n-- \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n-- from\n-- store_sales\n-- ,date_dim d1\n-- ,item\n-- ,store\n-- where\n-- d1.d_year = 2001 \n-- and d1.d_date_sk = ss_sold_date_sk\n-- and i_item_sk = ss_item_sk \n-- and s_store_sk = ss_store_sk\n-- and s_state in ('TN','TN','TN','TN',\n-- 'TN','TN','TN','TN')\n-- group by rollup(i_category,i_class)\n-- order by\n-- lochierarchy desc\n-- ,case when lochierarchy = 0 then i_category end\n-- ,rank_within_parent\n-- limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "F+QyftVamz0dMDhLoiYI8w==", "id": "test-project-364309:europe-west1.query36_1665777333", "jobReference": { "jobId": "query36_1665777333", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query36_1665777333?location=europe-west1", "statistics": { "creationTime": "1665777334222", "endTime": "1665777335244", "finalExecutionDurationMs": "752", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156682367", "performanceInsights": { "avgPreviousExecutionMs": "798" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.05597964376590331, "computeRatioMax": 0.05597964376590331, "endMs": "1665777334468", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.030534351145038167, "readRatioMax": 0.030534351145038167, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777334414", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:s_store_sk, $71:s_state", "FROM store", "WHERE in($71, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005089058524173028, "waitRatioMax": 0.005089058524173028, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.061068702290076333, "writeRatioMax": 0.061068702290076333 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03816793893129771, "computeRatioMax": 0.03816793893129771, "endMs": "1665777334477", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015267175572519083, "readRatioMax": 0.015267175572519083, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777334434", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03307888040712468, "writeRatioMax": 0.03307888040712468 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04071246819338423, "computeRatioMax": 0.04071246819338423, "endMs": "1665777334478", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02544529262086514, "readRatioMax": 0.02544529262086514, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777334448", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.022900763358778626, "writeRatioMax": 0.022900763358778626 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03816793893129771, "computeRatioMax": 0.03816793893129771, "endMs": "1665777334520", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020356234096692113, "readRatioMax": 0.020356234096692113, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777334479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_state", "FROM store", "WHERE in($31, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05597964376590331, "writeRatioMax": 0.05597964376590331 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03307888040712468, "computeRatioMax": 0.03307888040712468, "endMs": "1665777334535", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017811704834605598, "readRatioMax": 0.017811704834605598, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777334495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.058524173027989825, "writeRatioMax": 0.058524173027989825 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.035623409669211195, "computeRatioMax": 0.035623409669211195, "endMs": "1665777334551", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020356234096692113, "readRatioMax": 0.020356234096692113, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777334516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.017811704834605598, "writeRatioMax": 0.017811704834605598 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.017811704834605598, "computeRatioMax": 0.017811704834605598, "endMs": "1665777334575", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.010178117048346057, "readRatioMax": 0.010178117048346057, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777334546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04580152671755725, "writeRatioMax": 0.04580152671755725 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.05089058524173028, "computeRatioMax": 0.05089058524173028, "endMs": "1665777334618", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015267175572519083, "readRatioMax": 0.015267175572519083, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777334561", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.06870229007633588, "writeRatioMax": 0.06870229007633588 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02544529262086514, "computeRatioMax": 0.02544529262086514, "endMs": "1665777334637", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.03307888040712468, "readRatioMax": 0.03307888040712468, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777334576", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.07124681933842239, "writeRatioMax": 0.07124681933842239 }, { "completedParallelInputs": "6", "computeMsAvg": "252", "computeMsMax": "269", "computeRatioAvg": 0.6412213740458015, "computeRatioMax": 0.6844783715012722, "endMs": "1665777334790", "id": "12", "inputStages": [ "2", "1", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "25", "readRatioAvg": 0.05343511450381679, "readRatioMax": 0.06361323155216285, "recordsRead": "2990666", "recordsWritten": "6", "shuffleOutputBytes": "204", "shuffleOutputBytesSpilled": "0", "slotMs": "1428", "startMs": "1665777334598", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_ext_sales_price, $104:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($491)", "$361 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482", "INNER HASH JOIN EACH WITH ALL ON $480 = $70" ] }, { "kind": "JOIN", "substeps": [ "$480 := $471, $481 := $472, $482 := $473", "INNER HASH JOIN EACH WITH ALL ON $470 = $60" ] }, { "kind": "JOIN", "substeps": [ "$470 := $101, $471 := $102, $472 := $103, $473 := $104", "INNER HASH JOIN EACH WITH ALL ON $100 = $110" ] }, { "kind": "WRITE", "substeps": [ "$360, $361", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.005089058524173028, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002544529262086514, "writeRatioMax": 0.002544529262086514 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.017811704834605598, "computeRatioMax": 0.017811704834605598, "endMs": "1665777334799", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777334600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := NULL", "$291 := divide(multiply($300, NUMERIC<...>), $301)", "$292 := 1", "$293 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007633587786259542, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002544529262086514, "writeRatioMax": 0.002544529262086514 }, { "completedParallelInputs": "6", "computeMsAvg": "317", "computeMsMax": "393", "computeRatioAvg": 0.806615776081425, "computeRatioMax": 1, "endMs": "1665777334849", "id": "14", "inputStages": [ "6", "5", "4" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "24", "readRatioAvg": 0.05343511450381679, "readRatioMax": 0.061068702290076333, "recordsRead": "2990666", "recordsWritten": "66", "shuffleOutputBytes": "2904", "shuffleOutputBytesSpilled": "0", "slotMs": "1592", "startMs": "1665777334617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_item_sk, $52:ss_store_sk, $53:ss_ext_sales_price, $54:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$340 := SUM($442)", "$341 := SUM($441)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $433, $441 := $431, $442 := $432", "INNER HASH JOIN EACH WITH ALL ON $430 = $30" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $21", "INNER HASH JOIN EACH WITH ALL ON $420 = $20" ] }, { "kind": "JOIN", "substeps": [ "$420 := $51, $421 := $52, $422 := $53, $423 := $54", "INNER HASH JOIN EACH WITH ALL ON $50 = $90" ] }, { "kind": "WRITE", "substeps": [ "$450, $340, $341", "TO __stage0E_output", "BY HASH($450)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.005089058524173028, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.017811704834605598, "writeRatioMax": 0.017811704834605598 }, { "completedParallelInputs": "6", "computeMsAvg": "305", "computeMsMax": "361", "computeRatioAvg": 0.7760814249363868, "computeRatioMax": 0.9185750636132316, "endMs": "1665777334927", "id": "15", "inputStages": [ "9", "10", "8" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "46", "readRatioAvg": 0.07124681933842239, "readRatioMax": 0.11704834605597965, "recordsRead": "2990666", "recordsWritten": "726", "shuffleOutputBytes": "40800", "shuffleOutputBytesSpilled": "0", "slotMs": "1875", "startMs": "1665777334656", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_ext_sales_price, $44:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391, $401 := $390", "$330 := SUM($393)", "$331 := SUM($392)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $383, $391 := $384, $392 := $381, $393 := $382", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $2, $384 := $3", "INNER HASH JOIN EACH WITH ALL ON $370 = $1" ] }, { "kind": "JOIN", "substeps": [ "$370 := $41, $371 := $42, $372 := $43, $373 := $44", "INNER HASH JOIN EACH WITH ALL ON $40 = $80" ] }, { "kind": "WRITE", "substeps": [ "$401, $400, $330, $331", "TO __stage0F_output", "BY HASH($400, $401)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "10", "writeMsMax": "14", "writeRatioAvg": 0.02544529262086514, "writeRatioMax": 0.035623409669211195 }, { "completedParallelInputs": "3", "computeMsAvg": "11", "computeMsMax": "15", "computeRatioAvg": 0.027989821882951654, "computeRatioMax": 0.03816793893129771, "endMs": "1665777334997", "id": "16", "inputStages": [ "13", "15", "14" ], "name": "S10: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "793", "recordsWritten": "133", "shuffleOutputBytes": "7516", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665777334948", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$401, $400, $330, $331", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$450, $340, $341", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := case_no_value(equal($183, 0), $181, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := 0", "$211 := divide(multiply($270, NUMERIC<...>), $271)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := NULL", "$221 := divide(multiply($280, NUMERIC<...>), $281)", "$222 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$160, $180, $181, $182, $184", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005089058524173028, "waitRatioMax": 0.005089058524173028, "writeMsAvg": "29", "writeMsMax": "37", "writeRatioAvg": 0.0737913486005089, "writeRatioMax": 0.09414758269720101 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.027989821882951654, "computeRatioMax": 0.027989821882951654, "endMs": "1665777335051", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777335017", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $561, $562, $560", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($570, 0)", "$201 := coalesce($570, 1)", "$202 := coalesce($571, '')", "$203 := coalesce($571, '0')", "$204 := coalesce($572, NUMERIC<...>)", "$205 := coalesce($572, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$260 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05597964376590331, "writeRatioMax": 0.05597964376590331 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.020356234096692113, "computeRatioMax": 0.03816793893129771, "endMs": "1665777335103", "id": "19", "inputStages": [ "17" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3290", "startMs": "1665777335054", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005089058524173028, "waitRatioMax": 0.010178117048346057, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.035623409669211195, "writeRatioMax": 0.05089058524173028 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.022900763358778626, "computeRatioMax": 0.04834605597964377, "endMs": "1665777335111", "id": "20", "inputStages": [ "19", "16" ], "name": "S14: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8713", "shuffleOutputBytesSpilled": "0", "slotMs": "2799", "startMs": "1665777335062", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $180, $181, $182, $184", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$240, $530, $531, $532, $533, $534", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$144 DESC, $120 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := case_no_value(equal($144, 0), $142, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := RANK() OVER (PARTITION BY $504, $500 ORDER BY $501 ASC)" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC, $231 ASC" ] }, { "kind": "JOIN", "substeps": [ "$580 := $251, $581 := $252, $582 := $253, $583 := $254, $584 := $260", "INNER HASH JOIN EACH WITH ALL ON $190 = $200, $191 = $201, $192 = $202, $193 = $203, $194 = $204, $195 = $205" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($254, 0)", "$191 := coalesce($254, 1)", "$192 := coalesce($250, '')", "$193 := coalesce($250, '0')", "$194 := coalesce($251, NUMERIC<...>)", "$195 := coalesce($251, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $594, $595", "TO __stage14_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.01272264631043257, "waitRatioMax": 0.015267175572519083, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.03307888040712468, "writeRatioMax": 0.04580152671755725 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02544529262086514, "computeRatioMax": 0.02544529262086514, "endMs": "1665777335135", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5627", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665777335071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $594, $595", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$595 DESC, $590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005089058524173028, "waitRatioMax": 0.005089058524173028, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007633587786259542, "writeRatioMax": 0.007633587786259542 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "26", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "4988" }, { "activeUnits": "4", "completedUnits": "234", "elapsedMs": "883", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11641" } ], "totalBytesBilled": "157286400", "totalBytesProcessed": "156682367", "totalPartitionsProcessed": "0", "totalSlotMs": "11641", "transferredBytes": "0" }, "startTime": "1665777334308", "totalBytesProcessed": "156682367", "totalSlotMs": "11641" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon532ad54f_0d40_4cb8_bc2b_baae794d526c" }, "priority": "INTERACTIVE", "query": "WITH results AS\n (SELECT sum(ss_net_profit) AS ss_net_profit,\n sum(ss_ext_sales_price) AS ss_ext_sales_price,\n (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin ,\n i_category ,\n i_class \n FROM store_sales ,\n date_dim d1 ,\n item ,\n store\n WHERE d1.d_year = 2001\n AND d1.d_date_sk = ss_sold_date_sk\n AND i_item_sk = ss_item_sk\n AND s_store_sk = ss_store_sk\n AND s_state in ('TN')\n GROUP BY i_category,\n i_class) ,\n results_rollup AS\n (SELECT gross_margin,\n i_category,\n i_class,\n 0 AS t_category,\n 0 AS t_class,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n i_category,\n NULL AS i_class,\n 0 AS t_category,\n 1 AS t_class,\n 1 AS lochierarchy\n FROM results\n GROUP BY i_category\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n NULL AS i_category,\n NULL AS i_class,\n 1 AS t_category,\n 1 AS t_class,\n 2 AS lochierarchy\n FROM results)\nSELECT gross_margin,\n i_category,\n i_class, \n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN t_class = 0 THEN i_category\n END\n ORDER BY gross_margin ASC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN i_category\n END ,\n rank_within_parent\nLIMIT 100;\n\n\n-- select \n-- sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n-- ,i_category\n-- ,i_class\n-- ,grouping(i_category)+grouping(i_class) as lochierarchy\n-- ,rank() over (\n-- \tpartition by grouping(i_category)+grouping(i_class),\n-- \tcase when grouping(i_class) = 0 then i_category end \n-- \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n-- from\n-- store_sales\n-- ,date_dim d1\n-- ,item\n-- ,store\n-- where\n-- d1.d_year = 2001 \n-- and d1.d_date_sk = ss_sold_date_sk\n-- and i_item_sk = ss_item_sk \n-- and s_store_sk = ss_store_sk\n-- and s_state in ('TN','TN','TN','TN',\n-- 'TN','TN','TN','TN')\n-- group by rollup(i_category,i_class)\n-- order by\n-- lochierarchy desc\n-- ,case when lochierarchy = 0 then i_category end\n-- ,rank_within_parent\n-- limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ZohG638Bc7CwhGYz1sZg4g==", "id": "test-project-364309:europe-west1.query36_1665777336", "jobReference": { "jobId": "query36_1665777336", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query36_1665777336?location=europe-west1", "statistics": { "creationTime": "1665777336907", "endTime": "1665777337994", "finalExecutionDurationMs": "800", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156682367", "performanceInsights": { "avgPreviousExecutionMs": "791" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.026442307692307692, "computeRatioMax": 0.026442307692307692, "endMs": "1665777337172", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016826923076923076, "readRatioMax": 0.016826923076923076, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777337135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:s_store_sk, $71:s_state", "FROM store", "WHERE in($71, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02403846153846154, "writeRatioMax": 0.02403846153846154 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.038461538461538464, "computeRatioMax": 0.038461538461538464, "endMs": "1665777337197", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.009615384615384616, "readRatioMax": 0.009615384615384616, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777337152", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.038461538461538464 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.019230769230769232, "computeRatioMax": 0.019230769230769232, "endMs": "1665777337210", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01201923076923077, "readRatioMax": 0.01201923076923077, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777337171", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03365384615384615, "writeRatioMax": 0.03365384615384615 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02403846153846154, "computeRatioMax": 0.02403846153846154, "endMs": "1665777337245", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.009615384615384616, "readRatioMax": 0.009615384615384616, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777337205", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_state", "FROM store", "WHERE in($31, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.040865384615384616, "writeRatioMax": 0.040865384615384616 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.055288461538461536, "computeRatioMax": 0.055288461538461536, "endMs": "1665777337272", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777337225", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.026442307692307692, "writeRatioMax": 0.026442307692307692 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03125, "computeRatioMax": 0.03125, "endMs": "1665777337287", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777337243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03125, "writeRatioMax": 0.03125 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04567307692307692, "computeRatioMax": 0.04567307692307692, "endMs": "1665777337315", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777337277", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.026442307692307692, "writeRatioMax": 0.026442307692307692 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.06490384615384616, "computeRatioMax": 0.06490384615384616, "endMs": "1665777337356", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777337293", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.0673076923076923, "writeRatioMax": 0.0673076923076923 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02403846153846154, "computeRatioMax": 0.02403846153846154, "endMs": "1665777337350", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014423076923076924, "readRatioMax": 0.014423076923076924, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777337310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03365384615384615, "writeRatioMax": 0.03365384615384615 }, { "completedParallelInputs": "6", "computeMsAvg": "280", "computeMsMax": "340", "computeRatioAvg": 0.6730769230769231, "computeRatioMax": 0.8173076923076923, "endMs": "1665777337532", "id": "12", "inputStages": [ "2", "1", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "21", "readRatioAvg": 0.04567307692307692, "readRatioMax": 0.05048076923076923, "recordsRead": "2990666", "recordsWritten": "6", "shuffleOutputBytes": "204", "shuffleOutputBytesSpilled": "0", "slotMs": "1467", "startMs": "1665777337330", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_ext_sales_price, $104:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($491)", "$361 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482", "INNER HASH JOIN EACH WITH ALL ON $480 = $70" ] }, { "kind": "JOIN", "substeps": [ "$480 := $471, $481 := $472, $482 := $473", "INNER HASH JOIN EACH WITH ALL ON $470 = $60" ] }, { "kind": "JOIN", "substeps": [ "$470 := $101, $471 := $102, $472 := $103, $473 := $104", "INNER HASH JOIN EACH WITH ALL ON $100 = $110" ] }, { "kind": "WRITE", "substeps": [ "$360, $361", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002403846153846154, "writeRatioMax": 0.002403846153846154 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03365384615384615, "computeRatioMax": 0.03365384615384615, "endMs": "1665777337565", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665777337332", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := NULL", "$291 := divide(multiply($300, NUMERIC<...>), $301)", "$292 := 1", "$293 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.009615384615384616, "writeRatioMax": 0.009615384615384616 }, { "completedParallelInputs": "6", "computeMsAvg": "275", "computeMsMax": "336", "computeRatioAvg": 0.6610576923076923, "computeRatioMax": 0.8076923076923077, "endMs": "1665777337587", "id": "14", "inputStages": [ "6", "5", "4" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "21", "readRatioAvg": 0.04807692307692308, "readRatioMax": 0.05048076923076923, "recordsRead": "2990666", "recordsWritten": "66", "shuffleOutputBytes": "2904", "shuffleOutputBytesSpilled": "0", "slotMs": "1631", "startMs": "1665777337349", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_item_sk, $52:ss_store_sk, $53:ss_ext_sales_price, $54:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$340 := SUM($442)", "$341 := SUM($441)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $433, $441 := $431, $442 := $432", "INNER HASH JOIN EACH WITH ALL ON $430 = $30" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $21", "INNER HASH JOIN EACH WITH ALL ON $420 = $20" ] }, { "kind": "JOIN", "substeps": [ "$420 := $51, $421 := $52, $422 := $53, $423 := $54", "INNER HASH JOIN EACH WITH ALL ON $50 = $90" ] }, { "kind": "WRITE", "substeps": [ "$450, $340, $341", "TO __stage0E_output", "BY HASH($450)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.021634615384615384 }, { "completedParallelInputs": "6", "computeMsAvg": "345", "computeMsMax": "416", "computeRatioAvg": 0.8293269230769231, "computeRatioMax": 1, "endMs": "1665777337664", "id": "16", "inputStages": [ "9", "8", "10" ], "name": "S10: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "30", "readRatioAvg": 0.055288461538461536, "readRatioMax": 0.07211538461538461, "recordsRead": "2990666", "recordsWritten": "726", "shuffleOutputBytes": "40800", "shuffleOutputBytesSpilled": "0", "slotMs": "1982", "startMs": "1665777337398", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_ext_sales_price, $44:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391, $401 := $390", "$330 := SUM($393)", "$331 := SUM($392)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $383, $391 := $384, $392 := $381, $393 := $382", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $2, $384 := $3", "INNER HASH JOIN EACH WITH ALL ON $370 = $1" ] }, { "kind": "JOIN", "substeps": [ "$370 := $41, $371 := $42, $372 := $43, $373 := $44", "INNER HASH JOIN EACH WITH ALL ON $40 = $80" ] }, { "kind": "WRITE", "substeps": [ "$401, $400, $330, $331", "TO __stage10_output", "BY HASH($400, $401)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "10", "writeMsMax": "16", "writeRatioAvg": 0.02403846153846154, "writeRatioMax": 0.038461538461538464 }, { "completedParallelInputs": "3", "computeMsAvg": "13", "computeMsMax": "15", "computeRatioAvg": 0.03125, "computeRatioMax": 0.036057692307692304, "endMs": "1665777337744", "id": "17", "inputStages": [ "14", "16", "13" ], "name": "S11: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "793", "recordsWritten": "133", "shuffleOutputBytes": "7516", "shuffleOutputBytesSpilled": "0", "slotMs": "139", "startMs": "1665777337691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$401, $400, $330, $331", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$450, $340, $341", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := case_no_value(equal($183, 0), $181, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := 0", "$211 := divide(multiply($270, NUMERIC<...>), $271)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := NULL", "$221 := divide(multiply($280, NUMERIC<...>), $281)", "$222 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$160, $180, $181, $182, $184", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "23", "writeMsMax": "41", "writeRatioAvg": 0.055288461538461536, "writeRatioMax": 0.0985576923076923 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.021634615384615384, "computeRatioMax": 0.021634615384615384, "endMs": "1665777337800", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777337766", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $561, $562, $560", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($570, 0)", "$201 := coalesce($570, 1)", "$202 := coalesce($571, '')", "$203 := coalesce($571, '0')", "$204 := coalesce($572, NUMERIC<...>)", "$205 := coalesce($572, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$260 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.0673076923076923, "writeRatioMax": 0.0673076923076923 }, { "completedParallelInputs": "98", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.021634615384615384, "computeRatioMax": 0.040865384615384616, "endMs": "1665777337857", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3426", "startMs": "1665777337804", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "17", "writeMsMax": "31", "writeRatioAvg": 0.040865384615384616, "writeRatioMax": 0.07451923076923077 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.021634615384615384, "computeRatioMax": 0.040865384615384616, "endMs": "1665777337857", "id": "21", "inputStages": [ "20", "17" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8713", "shuffleOutputBytesSpilled": "0", "slotMs": "3335", "startMs": "1665777337812", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $180, $181, $182, $184", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$240, $530, $531, $532, $533, $534", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$144 DESC, $120 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := case_no_value(equal($144, 0), $142, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := RANK() OVER (PARTITION BY $504, $500 ORDER BY $501 ASC)" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC, $231 ASC" ] }, { "kind": "JOIN", "substeps": [ "$580 := $251, $581 := $252, $582 := $253, $583 := $254, $584 := $260", "INNER HASH JOIN EACH WITH ALL ON $190 = $200, $191 = $201, $192 = $202, $193 = $203, $194 = $204, $195 = $205" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($254, 0)", "$191 := coalesce($254, 1)", "$192 := coalesce($250, '')", "$193 := coalesce($250, '0')", "$194 := coalesce($251, NUMERIC<...>)", "$195 := coalesce($251, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $594, $595", "TO __stage15_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.014423076923076924, "waitRatioMax": 0.016826923076923076, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.03365384615384615, "writeRatioMax": 0.05048076923076923 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.038461538461538464, "computeRatioMax": 0.038461538461538464, "endMs": "1665777337884", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5627", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777337826", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $594, $595", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$595 DESC, $590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002403846153846154, "waitRatioMax": 0.002403846153846154, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01201923076923077, "writeRatioMax": 0.01201923076923077 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "24", "elapsedMs": "650", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "4599" }, { "activeUnits": "4", "completedUnits": "232", "elapsedMs": "954", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "12686" } ], "totalBytesBilled": "157286400", "totalBytesProcessed": "156682367", "totalPartitionsProcessed": "0", "totalSlotMs": "12686", "transferredBytes": "0" }, "startTime": "1665777336986", "totalBytesProcessed": "156682367", "totalSlotMs": "12686" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9c994f12_55eb_4772_b037_3cfd992803bd" }, "priority": "INTERACTIVE", "query": "WITH results AS\n (SELECT sum(ss_net_profit) AS ss_net_profit,\n sum(ss_ext_sales_price) AS ss_ext_sales_price,\n (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin ,\n i_category ,\n i_class \n FROM store_sales ,\n date_dim d1 ,\n item ,\n store\n WHERE d1.d_year = 2001\n AND d1.d_date_sk = ss_sold_date_sk\n AND i_item_sk = ss_item_sk\n AND s_store_sk = ss_store_sk\n AND s_state in ('TN')\n GROUP BY i_category,\n i_class) ,\n results_rollup AS\n (SELECT gross_margin,\n i_category,\n i_class,\n 0 AS t_category,\n 0 AS t_class,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n i_category,\n NULL AS i_class,\n 0 AS t_category,\n 1 AS t_class,\n 1 AS lochierarchy\n FROM results\n GROUP BY i_category\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n NULL AS i_category,\n NULL AS i_class,\n 1 AS t_category,\n 1 AS t_class,\n 2 AS lochierarchy\n FROM results)\nSELECT gross_margin,\n i_category,\n i_class, \n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN t_class = 0 THEN i_category\n END\n ORDER BY gross_margin ASC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN i_category\n END ,\n rank_within_parent\nLIMIT 100;\n\n\n-- select \n-- sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n-- ,i_category\n-- ,i_class\n-- ,grouping(i_category)+grouping(i_class) as lochierarchy\n-- ,rank() over (\n-- \tpartition by grouping(i_category)+grouping(i_class),\n-- \tcase when grouping(i_class) = 0 then i_category end \n-- \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n-- from\n-- store_sales\n-- ,date_dim d1\n-- ,item\n-- ,store\n-- where\n-- d1.d_year = 2001 \n-- and d1.d_date_sk = ss_sold_date_sk\n-- and i_item_sk = ss_item_sk \n-- and s_store_sk = ss_store_sk\n-- and s_state in ('TN','TN','TN','TN',\n-- 'TN','TN','TN','TN')\n-- group by rollup(i_category,i_class)\n-- order by\n-- lochierarchy desc\n-- ,case when lochierarchy = 0 then i_category end\n-- ,rank_within_parent\n-- limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "dLNZFApGMg5EtfcRMXnWWw==", "id": "test-project-364309:europe-west1.query36_1665777339", "jobReference": { "jobId": "query36_1665777339", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query36_1665777339?location=europe-west1", "statistics": { "creationTime": "1665777340144", "endTime": "1665777341250", "finalExecutionDurationMs": "860", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156682367", "performanceInsights": { "avgPreviousExecutionMs": "792" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.025787965616045846, "computeRatioMax": 0.025787965616045846, "endMs": "1665777340377", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.014326647564469915, "readRatioMax": 0.014326647564469915, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777340324", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:s_store_sk, $71:s_state", "FROM store", "WHERE in($71, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07736389684813753, "writeRatioMax": 0.07736389684813753 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03724928366762178, "computeRatioMax": 0.03724928366762178, "endMs": "1665777340386", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.017191977077363897, "readRatioMax": 0.017191977077363897, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777340343", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.08022922636103152, "writeRatioMax": 0.08022922636103152 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.034383954154727794, "computeRatioMax": 0.034383954154727794, "endMs": "1665777340413", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.017191977077363897, "readRatioMax": 0.017191977077363897, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777340368", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0057306590257879654, "waitRatioMax": 0.0057306590257879654, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.045845272206303724, "writeRatioMax": 0.045845272206303724 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.034383954154727794, "computeRatioMax": 0.034383954154727794, "endMs": "1665777340460", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.011461318051575931, "readRatioMax": 0.011461318051575931, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777340408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_state", "FROM store", "WHERE in($31, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.0830945558739255, "writeRatioMax": 0.0830945558739255 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.054441260744985676, "computeRatioMax": 0.054441260744985676, "endMs": "1665777340470", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.017191977077363897, "readRatioMax": 0.017191977077363897, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777340424", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04297994269340974, "writeRatioMax": 0.04297994269340974 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02865329512893983, "computeRatioMax": 0.02865329512893983, "endMs": "1665777340501", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.017191977077363897, "readRatioMax": 0.017191977077363897, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777340450", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07449856733524356, "writeRatioMax": 0.07449856733524356 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02865329512893983, "computeRatioMax": 0.02865329512893983, "endMs": "1665777340543", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.011461318051575931, "readRatioMax": 0.011461318051575931, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777340493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07449856733524356, "writeRatioMax": 0.07449856733524356 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.05730659025787966, "computeRatioMax": 0.05730659025787966, "endMs": "1665777340580", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.017191977077363897, "readRatioMax": 0.017191977077363897, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777340522", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07736389684813753, "writeRatioMax": 0.07736389684813753 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.05157593123209169, "computeRatioMax": 0.05157593123209169, "endMs": "1665777340595", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03151862464183381, "readRatioMax": 0.03151862464183381, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777340542", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0057306590257879654, "waitRatioMax": 0.0057306590257879654, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04297994269340974, "writeRatioMax": 0.04297994269340974 }, { "completedParallelInputs": "6", "computeMsAvg": "267", "computeMsMax": "313", "computeRatioAvg": 0.7650429799426934, "computeRatioMax": 0.8968481375358166, "endMs": "1665777340783", "id": "12", "inputStages": [ "0", "2", "1" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "26", "readMsMax": "33", "readRatioAvg": 0.07449856733524356, "readRatioMax": 0.09455587392550144, "recordsRead": "2990666", "recordsWritten": "6", "shuffleOutputBytes": "204", "shuffleOutputBytesSpilled": "0", "slotMs": "1483", "startMs": "1665777340567", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_ext_sales_price, $104:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($491)", "$361 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482", "INNER HASH JOIN EACH WITH ALL ON $480 = $70" ] }, { "kind": "JOIN", "substeps": [ "$480 := $471, $481 := $472, $482 := $473", "INNER HASH JOIN EACH WITH ALL ON $470 = $60" ] }, { "kind": "JOIN", "substeps": [ "$470 := $101, $471 := $102, $472 := $103, $473 := $104", "INNER HASH JOIN EACH WITH ALL ON $100 = $110" ] }, { "kind": "WRITE", "substeps": [ "$360, $361", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0057306590257879654, "waitRatioMax": 0.0057306590257879654, "writeMsAvg": "1", "writeMsMax": "2", "writeRatioAvg": 0.0028653295128939827, "writeRatioMax": 0.0057306590257879654 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02005730659025788, "computeRatioMax": 0.02005730659025788, "endMs": "1665777340788", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "127", "startMs": "1665777340570", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := NULL", "$291 := divide(multiply($300, NUMERIC<...>), $301)", "$292 := 1", "$293 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.011461318051575931, "waitRatioMax": 0.011461318051575931, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0028653295128939827, "writeRatioMax": 0.0028653295128939827 }, { "completedParallelInputs": "6", "computeMsAvg": "249", "computeMsMax": "295", "computeRatioAvg": 0.7134670487106017, "computeRatioMax": 0.8452722063037249, "endMs": "1665777340830", "id": "14", "inputStages": [ "6", "5", "4" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "26", "readMsMax": "34", "readRatioAvg": 0.07449856733524356, "readRatioMax": 0.09742120343839542, "recordsRead": "2990666", "recordsWritten": "66", "shuffleOutputBytes": "2904", "shuffleOutputBytesSpilled": "0", "slotMs": "1526", "startMs": "1665777340594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_item_sk, $52:ss_store_sk, $53:ss_ext_sales_price, $54:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$340 := SUM($442)", "$341 := SUM($441)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $433, $441 := $431, $442 := $432", "INNER HASH JOIN EACH WITH ALL ON $430 = $30" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $21", "INNER HASH JOIN EACH WITH ALL ON $420 = $20" ] }, { "kind": "JOIN", "substeps": [ "$420 := $51, $421 := $52, $422 := $53, $423 := $54", "INNER HASH JOIN EACH WITH ALL ON $50 = $90" ] }, { "kind": "WRITE", "substeps": [ "$450, $340, $341", "TO __stage0E_output", "BY HASH($450)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0057306590257879654, "writeMsAvg": "9", "writeMsMax": "11", "writeRatioAvg": 0.025787965616045846, "writeRatioMax": 0.03151862464183381 }, { "completedParallelInputs": "6", "computeMsAvg": "298", "computeMsMax": "349", "computeRatioAvg": 0.8538681948424068, "computeRatioMax": 1, "endMs": "1665777340863", "id": "15", "inputStages": [ "10", "9", "8" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "38", "readRatioAvg": 0.08022922636103152, "readRatioMax": 0.10888252148997135, "recordsRead": "2990666", "recordsWritten": "726", "shuffleOutputBytes": "40800", "shuffleOutputBytesSpilled": "0", "slotMs": "1781", "startMs": "1665777340617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_ext_sales_price, $44:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391, $401 := $390", "$330 := SUM($393)", "$331 := SUM($392)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $383, $391 := $384, $392 := $381, $393 := $382", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $2, $384 := $3", "INNER HASH JOIN EACH WITH ALL ON $370 = $1" ] }, { "kind": "JOIN", "substeps": [ "$370 := $41, $371 := $42, $372 := $43, $373 := $44", "INNER HASH JOIN EACH WITH ALL ON $40 = $80" ] }, { "kind": "WRITE", "substeps": [ "$401, $400, $330, $331", "TO __stage0F_output", "BY HASH($400, $401)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0057306590257879654, "writeMsAvg": "8", "writeMsMax": "11", "writeRatioAvg": 0.022922636103151862, "writeRatioMax": 0.03151862464183381 }, { "completedParallelInputs": "3", "computeMsAvg": "14", "computeMsMax": "20", "computeRatioAvg": 0.04011461318051576, "computeRatioMax": 0.05730659025787966, "endMs": "1665777340961", "id": "16", "inputStages": [ "14", "13", "15" ], "name": "S10: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "793", "recordsWritten": "133", "shuffleOutputBytes": "7516", "shuffleOutputBytesSpilled": "0", "slotMs": "154", "startMs": "1665777340893", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$401, $400, $330, $331", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$450, $340, $341", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := case_no_value(equal($183, 0), $181, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := 0", "$211 := divide(multiply($270, NUMERIC<...>), $271)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := NULL", "$221 := divide(multiply($280, NUMERIC<...>), $281)", "$222 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$160, $180, $181, $182, $184", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "33", "writeMsMax": "40", "writeRatioAvg": 0.09455587392550144, "writeRatioMax": 0.11461318051575932 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.034383954154727794, "computeRatioMax": 0.034383954154727794, "endMs": "1665777341043", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777340996", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $561, $562, $560", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($570, 0)", "$201 := coalesce($570, 1)", "$202 := coalesce($571, '')", "$203 := coalesce($571, '0')", "$204 := coalesce($572, NUMERIC<...>)", "$205 := coalesce($572, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$260 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.08595988538681948, "writeRatioMax": 0.08595988538681948 }, { "completedParallelInputs": "99", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.025787965616045846, "computeRatioMax": 0.05730659025787966, "endMs": "1665777341116", "id": "19", "inputStages": [ "17" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3853", "startMs": "1665777341054", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "7", "waitRatioAvg": 0.0057306590257879654, "waitRatioMax": 0.02005730659025788, "writeMsAvg": "24", "writeMsMax": "32", "writeRatioAvg": 0.06876790830945559, "writeRatioMax": 0.09169054441260745 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.025787965616045846, "computeRatioMax": 0.04871060171919771, "endMs": "1665777341116", "id": "20", "inputStages": [ "19", "16" ], "name": "S14: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8713", "shuffleOutputBytesSpilled": "0", "slotMs": "3876", "startMs": "1665777341061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $180, $181, $182, $184", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$240, $530, $531, $532, $533, $534", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$144 DESC, $120 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := case_no_value(equal($144, 0), $142, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := RANK() OVER (PARTITION BY $504, $500 ORDER BY $501 ASC)" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC, $231 ASC" ] }, { "kind": "JOIN", "substeps": [ "$580 := $251, $581 := $252, $582 := $253, $583 := $254, $584 := $260", "INNER HASH JOIN EACH WITH ALL ON $190 = $200, $191 = $201, $192 = $202, $193 = $203, $194 = $204, $195 = $205" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($254, 0)", "$191 := coalesce($254, 1)", "$192 := coalesce($250, '')", "$193 := coalesce($250, '0')", "$194 := coalesce($251, NUMERIC<...>)", "$195 := coalesce($251, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $594, $595", "TO __stage14_output" ] } ], "waitMsAvg": "8", "waitMsMax": "9", "waitRatioAvg": 0.022922636103151862, "waitRatioMax": 0.025787965616045846, "writeMsAvg": "26", "writeMsMax": "37", "writeRatioAvg": 0.07449856733524356, "writeRatioMax": 0.10601719197707736 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.045845272206303724, "computeRatioMax": 0.045845272206303724, "endMs": "1665777341134", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5627", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777341075", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $594, $595", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$595 DESC, $590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02005730659025788, "writeRatioMax": 0.02005730659025788 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "22", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "4099" }, { "activeUnits": "7", "completedUnits": "233", "elapsedMs": "990", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "13327" } ], "totalBytesBilled": "157286400", "totalBytesProcessed": "156682367", "totalPartitionsProcessed": "0", "totalSlotMs": "13327", "transferredBytes": "0" }, "startTime": "1665777340200", "totalBytesProcessed": "156682367", "totalSlotMs": "13327" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone0f41986_eb66_4dc5_8796_76bf5f792eb8" }, "priority": "INTERACTIVE", "query": "WITH results AS\n (SELECT sum(ss_net_profit) AS ss_net_profit,\n sum(ss_ext_sales_price) AS ss_ext_sales_price,\n (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin ,\n i_category ,\n i_class \n FROM store_sales ,\n date_dim d1 ,\n item ,\n store\n WHERE d1.d_year = 2001\n AND d1.d_date_sk = ss_sold_date_sk\n AND i_item_sk = ss_item_sk\n AND s_store_sk = ss_store_sk\n AND s_state in ('TN')\n GROUP BY i_category,\n i_class) ,\n results_rollup AS\n (SELECT gross_margin,\n i_category,\n i_class,\n 0 AS t_category,\n 0 AS t_class,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n i_category,\n NULL AS i_class,\n 0 AS t_category,\n 1 AS t_class,\n 1 AS lochierarchy\n FROM results\n GROUP BY i_category\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n NULL AS i_category,\n NULL AS i_class,\n 1 AS t_category,\n 1 AS t_class,\n 2 AS lochierarchy\n FROM results)\nSELECT gross_margin,\n i_category,\n i_class, \n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN t_class = 0 THEN i_category\n END\n ORDER BY gross_margin ASC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN i_category\n END ,\n rank_within_parent\nLIMIT 100;\n\n\n-- select \n-- sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n-- ,i_category\n-- ,i_class\n-- ,grouping(i_category)+grouping(i_class) as lochierarchy\n-- ,rank() over (\n-- \tpartition by grouping(i_category)+grouping(i_class),\n-- \tcase when grouping(i_class) = 0 then i_category end \n-- \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n-- from\n-- store_sales\n-- ,date_dim d1\n-- ,item\n-- ,store\n-- where\n-- d1.d_year = 2001 \n-- and d1.d_date_sk = ss_sold_date_sk\n-- and i_item_sk = ss_item_sk \n-- and s_store_sk = ss_store_sk\n-- and s_state in ('TN','TN','TN','TN',\n-- 'TN','TN','TN','TN')\n-- group by rollup(i_category,i_class)\n-- order by\n-- lochierarchy desc\n-- ,case when lochierarchy = 0 then i_category end\n-- ,rank_within_parent\n-- limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "mIAsI6RTXquHhJgfbWCAUQ==", "id": "test-project-364309:europe-west1.query36_1665777342", "jobReference": { "jobId": "query36_1665777342", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query36_1665777342?location=europe-west1", "statistics": { "creationTime": "1665777343365", "endTime": "1665777344281", "finalExecutionDurationMs": "711", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156682367", "performanceInsights": { "avgPreviousExecutionMs": "800" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.023965141612200435, "computeRatioMax": 0.023965141612200435, "endMs": "1665777343552", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010893246187363835, "readRatioMax": 0.010893246187363835, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777343519", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:s_store_sk, $71:s_state", "FROM store", "WHERE in($71, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.04357298474945534, "writeRatioMax": 0.04357298474945534 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.0392156862745098, "computeRatioMax": 0.0392156862745098, "endMs": "1665777343574", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015250544662309368, "readRatioMax": 0.015250544662309368, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777343532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.030501089324618737, "writeRatioMax": 0.030501089324618737 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.037037037037037035, "computeRatioMax": 0.037037037037037035, "endMs": "1665777343585", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013071895424836602, "readRatioMax": 0.013071895424836602, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777343548", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.030501089324618737, "writeRatioMax": 0.030501089324618737 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.023965141612200435, "computeRatioMax": 0.023965141612200435, "endMs": "1665777343613", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008714596949891068, "readRatioMax": 0.008714596949891068, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777343575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_state", "FROM store", "WHERE in($31, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.06100217864923747, "writeRatioMax": 0.06100217864923747 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0457516339869281, "computeRatioMax": 0.0457516339869281, "endMs": "1665777343636", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013071895424836602, "readRatioMax": 0.013071895424836602, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777343591", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02832244008714597, "writeRatioMax": 0.02832244008714597 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.030501089324618737, "computeRatioMax": 0.030501089324618737, "endMs": "1665777343633", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015250544662309368, "readRatioMax": 0.015250544662309368, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777343604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.030501089324618737, "writeRatioMax": 0.030501089324618737 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.017429193899782137, "computeRatioMax": 0.017429193899782137, "endMs": "1665777343677", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010893246187363835, "readRatioMax": 0.010893246187363835, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777343634", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0392156862745098, "writeRatioMax": 0.0392156862745098 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.037037037037037035, "computeRatioMax": 0.037037037037037035, "endMs": "1665777343689", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008714596949891068, "readRatioMax": 0.008714596949891068, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777343648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.054466230936819175, "writeRatioMax": 0.054466230936819175 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.026143790849673203, "computeRatioMax": 0.026143790849673203, "endMs": "1665777343705", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017429193899782137, "readRatioMax": 0.017429193899782137, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777343663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0196078431372549, "writeRatioMax": 0.0196078431372549 }, { "completedParallelInputs": "6", "computeMsAvg": "259", "computeMsMax": "365", "computeRatioAvg": 0.5642701525054467, "computeRatioMax": 0.7952069716775599, "endMs": "1665777343910", "id": "12", "inputStages": [ "2", "0", "1" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "31", "readRatioAvg": 0.05228758169934641, "readRatioMax": 0.06753812636165578, "recordsRead": "2990666", "recordsWritten": "6", "shuffleOutputBytes": "204", "shuffleOutputBytesSpilled": "0", "slotMs": "1469", "startMs": "1665777343677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_ext_sales_price, $104:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($491)", "$361 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482", "INNER HASH JOIN EACH WITH ALL ON $480 = $70" ] }, { "kind": "JOIN", "substeps": [ "$480 := $471, $481 := $472, $482 := $473", "INNER HASH JOIN EACH WITH ALL ON $470 = $60" ] }, { "kind": "JOIN", "substeps": [ "$470 := $101, $471 := $102, $472 := $103, $473 := $104", "INNER HASH JOIN EACH WITH ALL ON $100 = $110" ] }, { "kind": "WRITE", "substeps": [ "$360, $361", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.004357298474945534, "writeMsAvg": "1", "writeMsMax": "3", "writeRatioAvg": 0.002178649237472767, "writeRatioMax": 0.006535947712418301 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.008714596949891068, "computeRatioMax": 0.008714596949891068, "endMs": "1665777343917", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777343678", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := NULL", "$291 := divide(multiply($300, NUMERIC<...>), $301)", "$292 := 1", "$293 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006535947712418301, "waitRatioMax": 0.006535947712418301, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002178649237472767, "writeRatioMax": 0.002178649237472767 }, { "completedParallelInputs": "6", "computeMsAvg": "306", "computeMsMax": "418", "computeRatioAvg": 0.6666666666666666, "computeRatioMax": 0.9106753812636166, "endMs": "1665777343977", "id": "15", "inputStages": [ "6", "5", "4" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "29", "readRatioAvg": 0.05228758169934641, "readRatioMax": 0.06318082788671024, "recordsRead": "2990666", "recordsWritten": "66", "shuffleOutputBytes": "2904", "shuffleOutputBytesSpilled": "0", "slotMs": "1692", "startMs": "1665777343710", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_item_sk, $52:ss_store_sk, $53:ss_ext_sales_price, $54:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$340 := SUM($442)", "$341 := SUM($441)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $433, $441 := $431, $442 := $432", "INNER HASH JOIN EACH WITH ALL ON $430 = $30" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $21", "INNER HASH JOIN EACH WITH ALL ON $420 = $20" ] }, { "kind": "JOIN", "substeps": [ "$420 := $51, $421 := $52, $422 := $53, $423 := $54", "INNER HASH JOIN EACH WITH ALL ON $50 = $90" ] }, { "kind": "WRITE", "substeps": [ "$450, $340, $341", "TO __stage0F_output", "BY HASH($450)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "9", "writeMsMax": "12", "writeRatioAvg": 0.0196078431372549, "writeRatioMax": 0.026143790849673203 }, { "completedParallelInputs": "6", "computeMsAvg": "341", "computeMsMax": "459", "computeRatioAvg": 0.7429193899782135, "computeRatioMax": 1, "endMs": "1665777344006", "id": "16", "inputStages": [ "8", "10", "9" ], "name": "S10: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "27", "readRatioAvg": 0.04357298474945534, "readRatioMax": 0.058823529411764705, "recordsRead": "2990666", "recordsWritten": "726", "shuffleOutputBytes": "40800", "shuffleOutputBytesSpilled": "0", "slotMs": "1758", "startMs": "1665777343726", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_ext_sales_price, $44:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391, $401 := $390", "$330 := SUM($393)", "$331 := SUM($392)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $383, $391 := $384, $392 := $381, $393 := $382", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $2, $384 := $3", "INNER HASH JOIN EACH WITH ALL ON $370 = $1" ] }, { "kind": "JOIN", "substeps": [ "$370 := $41, $371 := $42, $372 := $43, $373 := $44", "INNER HASH JOIN EACH WITH ALL ON $40 = $80" ] }, { "kind": "WRITE", "substeps": [ "$401, $400, $330, $331", "TO __stage10_output", "BY HASH($400, $401)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.013071895424836602, "writeRatioMax": 0.017429193899782137 }, { "completedParallelInputs": "3", "computeMsAvg": "12", "computeMsMax": "13", "computeRatioAvg": 0.026143790849673203, "computeRatioMax": 0.02832244008714597, "endMs": "1665777344074", "id": "17", "inputStages": [ "16", "15", "13" ], "name": "S11: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "793", "recordsWritten": "133", "shuffleOutputBytes": "7516", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665777344026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$401, $400, $330, $331", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$450, $340, $341", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := case_no_value(equal($183, 0), $181, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := 0", "$211 := divide(multiply($270, NUMERIC<...>), $271)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := NULL", "$221 := divide(multiply($280, NUMERIC<...>), $281)", "$222 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$160, $180, $181, $182, $184", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "19", "writeMsMax": "25", "writeRatioAvg": 0.04139433551198257, "writeRatioMax": 0.054466230936819175 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0196078431372549, "computeRatioMax": 0.0196078431372549, "endMs": "1665777344137", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777344098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $561, $562, $560", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($570, 0)", "$201 := coalesce($570, 1)", "$202 := coalesce($571, '')", "$203 := coalesce($571, '0')", "$204 := coalesce($572, NUMERIC<...>)", "$205 := coalesce($572, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$260 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.06753812636165578, "writeRatioMax": 0.06753812636165578 }, { "completedParallelInputs": "99", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.0196078431372549, "computeRatioMax": 0.030501089324618737, "endMs": "1665777344193", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3214", "startMs": "1665777344140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.006535947712418301, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.030501089324618737, "writeRatioMax": 0.05228758169934641 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.02178649237472767, "computeRatioMax": 0.0392156862745098, "endMs": "1665777344193", "id": "21", "inputStages": [ "20", "17" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8713", "shuffleOutputBytesSpilled": "0", "slotMs": "3269", "startMs": "1665777344145", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $180, $181, $182, $184", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$240, $530, $531, $532, $533, $534", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$144 DESC, $120 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := case_no_value(equal($144, 0), $142, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := RANK() OVER (PARTITION BY $504, $500 ORDER BY $501 ASC)" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC, $231 ASC" ] }, { "kind": "JOIN", "substeps": [ "$580 := $251, $581 := $252, $582 := $253, $583 := $254, $584 := $260", "INNER HASH JOIN EACH WITH ALL ON $190 = $200, $191 = $201, $192 = $202, $193 = $203, $194 = $204, $195 = $205" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($254, 0)", "$191 := coalesce($254, 1)", "$192 := coalesce($250, '')", "$193 := coalesce($250, '0')", "$194 := coalesce($251, NUMERIC<...>)", "$195 := coalesce($251, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $594, $595", "TO __stage15_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.008714596949891068, "waitRatioMax": 0.010893246187363835, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.030501089324618737, "writeRatioMax": 0.06318082788671024 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.013071895424836602, "computeRatioMax": 0.013071895424836602, "endMs": "1665777344202", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5627", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665777344157", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $594, $595", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$595 DESC, $590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004357298474945534, "waitRatioMax": 0.004357298474945534, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.010893246187363835, "writeRatioMax": 0.010893246187363835 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "28", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "5437" }, { "activeUnits": "0", "completedUnits": "233", "elapsedMs": "825", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "12005" } ], "totalBytesBilled": "157286400", "totalBytesProcessed": "156682367", "totalPartitionsProcessed": "0", "totalSlotMs": "12005", "transferredBytes": "0" }, "startTime": "1665777343408", "totalBytesProcessed": "156682367", "totalSlotMs": "12005" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5738e690_4765_49ff_9bfd_7f636d3abbc4" }, "priority": "INTERACTIVE", "query": "WITH results AS\n (SELECT sum(ss_net_profit) AS ss_net_profit,\n sum(ss_ext_sales_price) AS ss_ext_sales_price,\n (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin ,\n i_category ,\n i_class \n FROM store_sales ,\n date_dim d1 ,\n item ,\n store\n WHERE d1.d_year = 2001\n AND d1.d_date_sk = ss_sold_date_sk\n AND i_item_sk = ss_item_sk\n AND s_store_sk = ss_store_sk\n AND s_state in ('TN')\n GROUP BY i_category,\n i_class) ,\n results_rollup AS\n (SELECT gross_margin,\n i_category,\n i_class,\n 0 AS t_category,\n 0 AS t_class,\n 0 AS lochierarchy\n FROM results\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n i_category,\n NULL AS i_class,\n 0 AS t_category,\n 1 AS t_class,\n 1 AS lochierarchy\n FROM results\n GROUP BY i_category\n UNION ALL SELECT (sum(ss_net_profit)*1.0000)/sum(ss_ext_sales_price) AS gross_margin,\n NULL AS i_category,\n NULL AS i_class,\n 1 AS t_category,\n 1 AS t_class,\n 2 AS lochierarchy\n FROM results)\nSELECT gross_margin,\n i_category,\n i_class, \n lochierarchy,\n rank() OVER ( PARTITION BY lochierarchy,\n CASE\n WHEN t_class = 0 THEN i_category\n END\n ORDER BY gross_margin ASC) AS rank_within_parent\nFROM results_rollup\nORDER BY lochierarchy DESC ,\n CASE\n WHEN lochierarchy = 0 THEN i_category\n END ,\n rank_within_parent\nLIMIT 100;\n\n\n-- select \n-- sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n-- ,i_category\n-- ,i_class\n-- ,grouping(i_category)+grouping(i_class) as lochierarchy\n-- ,rank() over (\n-- \tpartition by grouping(i_category)+grouping(i_class),\n-- \tcase when grouping(i_class) = 0 then i_category end \n-- \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n-- from\n-- store_sales\n-- ,date_dim d1\n-- ,item\n-- ,store\n-- where\n-- d1.d_year = 2001 \n-- and d1.d_date_sk = ss_sold_date_sk\n-- and i_item_sk = ss_item_sk \n-- and s_store_sk = ss_store_sk\n-- and s_state in ('TN','TN','TN','TN',\n-- 'TN','TN','TN','TN')\n-- group by rollup(i_category,i_class)\n-- order by\n-- lochierarchy desc\n-- ,case when lochierarchy = 0 then i_category end\n-- ,rank_within_parent\n-- limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "YZUTzN7UOCaFXJx5ZKgAiw==", "id": "test-project-364309:europe-west1.query36_1665777345", "jobReference": { "jobId": "query36_1665777345", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query36_1665777345?location=europe-west1", "statistics": { "creationTime": "1665777346026", "endTime": "1665777347024", "finalExecutionDurationMs": "758", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156682367", "performanceInsights": { "avgPreviousExecutionMs": "791" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.045714285714285714, "computeRatioMax": 0.045714285714285714, "endMs": "1665777346246", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.025714285714285714, "readRatioMax": 0.025714285714285714, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777346208", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:s_store_sk, $71:s_state", "FROM store", "WHERE in($71, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005714285714285714, "waitRatioMax": 0.005714285714285714, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03428571428571429, "writeRatioMax": 0.03428571428571429 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.05142857142857143, "computeRatioMax": 0.05142857142857143, "endMs": "1665777346256", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.017142857142857144, "readRatioMax": 0.017142857142857144, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777346223", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04, "writeRatioMax": 0.04 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.04857142857142857, "computeRatioMax": 0.04857142857142857, "endMs": "1665777346283", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02857142857142857, "readRatioMax": 0.02857142857142857, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777346239", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.025714285714285714, "writeRatioMax": 0.025714285714285714 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03142857142857143, "computeRatioMax": 0.03142857142857143, "endMs": "1665777346318", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.011428571428571429, "readRatioMax": 0.011428571428571429, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777346274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_state", "FROM store", "WHERE in($31, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.054285714285714284, "writeRatioMax": 0.054285714285714284 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.05714285714285714, "endMs": "1665777346329", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.014285714285714285, "readRatioMax": 0.014285714285714285, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777346288", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04, "writeRatioMax": 0.04 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02857142857142857, "computeRatioMax": 0.02857142857142857, "endMs": "1665777346351", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.022857142857142857, "readRatioMax": 0.022857142857142857, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777346305", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04285714285714286, "writeRatioMax": 0.04285714285714286 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03142857142857143, "computeRatioMax": 0.03142857142857143, "endMs": "1665777346376", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02, "readRatioMax": 0.02, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777346340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005714285714285714, "waitRatioMax": 0.005714285714285714, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.05142857142857143, "writeRatioMax": 0.05142857142857143 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.09714285714285714, "computeRatioMax": 0.09714285714285714, "endMs": "1665777346423", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.03428571428571429, "readRatioMax": 0.03428571428571429, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665777346357", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005714285714285714, "waitRatioMax": 0.005714285714285714, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.08857142857142856, "writeRatioMax": 0.08857142857142856 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03142857142857143, "computeRatioMax": 0.03142857142857143, "endMs": "1665777346411", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02, "readRatioMax": 0.02, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777346373", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.06, "writeRatioMax": 0.06 }, { "completedParallelInputs": "6", "computeMsAvg": "250", "computeMsMax": "318", "computeRatioAvg": 0.7142857142857143, "computeRatioMax": 0.9085714285714286, "endMs": "1665777346586", "id": "12", "inputStages": [ "1", "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "25", "readRatioAvg": 0.06, "readRatioMax": 0.07142857142857142, "recordsRead": "2990666", "recordsWritten": "6", "shuffleOutputBytes": "204", "shuffleOutputBytesSpilled": "0", "slotMs": "1246", "startMs": "1665777346391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_ext_sales_price, $104:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$360 := SUM($491)", "$361 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482", "INNER HASH JOIN EACH WITH ALL ON $480 = $70" ] }, { "kind": "JOIN", "substeps": [ "$480 := $471, $481 := $472, $482 := $473", "INNER HASH JOIN EACH WITH ALL ON $470 = $60" ] }, { "kind": "JOIN", "substeps": [ "$470 := $101, $471 := $102, $472 := $103, $473 := $104", "INNER HASH JOIN EACH WITH ALL ON $100 = $110" ] }, { "kind": "WRITE", "substeps": [ "$360, $361", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005714285714285714, "waitRatioMax": 0.005714285714285714, "writeMsAvg": "2", "writeMsMax": "6", "writeRatioAvg": 0.005714285714285714, "writeRatioMax": 0.017142857142857144 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.017142857142857144, "computeRatioMax": 0.017142857142857144, "endMs": "1665777346594", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777346394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := NULL", "$291 := divide(multiply($300, NUMERIC<...>), $301)", "$292 := 1", "$293 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008571428571428572, "waitRatioMax": 0.008571428571428572, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002857142857142857, "writeRatioMax": 0.002857142857142857 }, { "completedParallelInputs": "6", "computeMsAvg": "290", "computeMsMax": "348", "computeRatioAvg": 0.8285714285714286, "computeRatioMax": 0.9942857142857143, "endMs": "1665777346686", "id": "14", "inputStages": [ "4", "6", "5" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "40", "readRatioAvg": 0.08, "readRatioMax": 0.11428571428571428, "recordsRead": "2990666", "recordsWritten": "66", "shuffleOutputBytes": "2904", "shuffleOutputBytesSpilled": "0", "slotMs": "1820", "startMs": "1665777346413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_item_sk, $52:ss_store_sk, $53:ss_ext_sales_price, $54:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$340 := SUM($442)", "$341 := SUM($441)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $433, $441 := $431, $442 := $432", "INNER HASH JOIN EACH WITH ALL ON $430 = $30" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $21", "INNER HASH JOIN EACH WITH ALL ON $420 = $20" ] }, { "kind": "JOIN", "substeps": [ "$420 := $51, $421 := $52, $422 := $53, $423 := $54", "INNER HASH JOIN EACH WITH ALL ON $50 = $90" ] }, { "kind": "WRITE", "substeps": [ "$450, $340, $341", "TO __stage0E_output", "BY HASH($450)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.005714285714285714, "writeMsAvg": "10", "writeMsMax": "18", "writeRatioAvg": 0.02857142857142857, "writeRatioMax": 0.05142857142857143 }, { "completedParallelInputs": "6", "computeMsAvg": "309", "computeMsMax": "350", "computeRatioAvg": 0.8828571428571429, "computeRatioMax": 1, "endMs": "1665777346682", "id": "16", "inputStages": [ "8", "9", "10" ], "name": "S10: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "22", "readRatioAvg": 0.054285714285714284, "readRatioMax": 0.06285714285714286, "recordsRead": "2990666", "recordsWritten": "726", "shuffleOutputBytes": "40800", "shuffleOutputBytesSpilled": "0", "slotMs": "1518", "startMs": "1665777346453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_ext_sales_price, $44:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391, $401 := $390", "$330 := SUM($393)", "$331 := SUM($392)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $383, $391 := $384, $392 := $381, $393 := $382", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $2, $384 := $3", "INNER HASH JOIN EACH WITH ALL ON $370 = $1" ] }, { "kind": "JOIN", "substeps": [ "$370 := $41, $371 := $42, $372 := $43, $373 := $44", "INNER HASH JOIN EACH WITH ALL ON $40 = $80" ] }, { "kind": "WRITE", "substeps": [ "$401, $400, $330, $331", "TO __stage10_output", "BY HASH($400, $401)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.017142857142857144, "writeRatioMax": 0.022857142857142857 }, { "completedParallelInputs": "3", "computeMsAvg": "10", "computeMsMax": "12", "computeRatioAvg": 0.02857142857142857, "computeRatioMax": 0.03428571428571429, "endMs": "1665777346779", "id": "17", "inputStages": [ "13", "14", "16" ], "name": "S11: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "793", "recordsWritten": "133", "shuffleOutputBytes": "7516", "shuffleOutputBytesSpilled": "0", "slotMs": "108", "startMs": "1665777346730", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$401, $400, $330, $331", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$450, $340, $341", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := case_no_value(equal($183, 0), $181, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := 0", "$211 := divide(multiply($270, NUMERIC<...>), $271)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := NULL", "$221 := divide(multiply($280, NUMERIC<...>), $281)", "$222 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$160, $180, $181, $182, $184", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "20", "writeMsMax": "28", "writeRatioAvg": 0.05714285714285714, "writeRatioMax": 0.08 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02, "computeRatioMax": 0.02, "endMs": "1665777346837", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777346799", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $561, $562, $560", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($570, 0)", "$201 := coalesce($570, 1)", "$202 := coalesce($571, '')", "$203 := coalesce($571, '0')", "$204 := coalesce($572, NUMERIC<...>)", "$205 := coalesce($572, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$260 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002857142857142857, "waitRatioMax": 0.002857142857142857, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.09142857142857143, "writeRatioMax": 0.09142857142857143 }, { "completedParallelInputs": "99", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.022857142857142857, "computeRatioMax": 0.04857142857142857, "endMs": "1665777346906", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3679", "startMs": "1665777346850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005714285714285714, "waitRatioMax": 0.008571428571428572, "writeMsAvg": "21", "writeMsMax": "32", "writeRatioAvg": 0.06, "writeRatioMax": 0.09142857142857143 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.025714285714285714, "computeRatioMax": 0.054285714285714284, "endMs": "1665777346905", "id": "21", "inputStages": [ "20", "17" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8713", "shuffleOutputBytesSpilled": "0", "slotMs": "3113", "startMs": "1665777346857", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $180, $181, $182, $184", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$240, $530, $531, $532, $533, $534", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $260", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$144 DESC, $120 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := case_no_value(equal($144, 0), $142, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := RANK() OVER (PARTITION BY $504, $500 ORDER BY $501 ASC)" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC, $231 ASC" ] }, { "kind": "JOIN", "substeps": [ "$580 := $251, $581 := $252, $582 := $253, $583 := $254, $584 := $260", "INNER HASH JOIN EACH WITH ALL ON $190 = $200, $191 = $201, $192 = $202, $193 = $203, $194 = $204, $195 = $205" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($254, 0)", "$191 := coalesce($254, 1)", "$192 := coalesce($250, '')", "$193 := coalesce($250, '0')", "$194 := coalesce($251, NUMERIC<...>)", "$195 := coalesce($251, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $593, $594, $595", "TO __stage15_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.011428571428571429, "waitRatioMax": 0.017142857142857144, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.04, "writeRatioMax": 0.07714285714285714 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03428571428571429, "computeRatioMax": 0.03428571428571429, "endMs": "1665777346919", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5627", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665777346869", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $593, $594, $595", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$595 DESC, $590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005714285714285714, "waitRatioMax": 0.005714285714285714, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.008571428571428572, "writeRatioMax": 0.008571428571428572 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "28", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "5469" }, { "activeUnits": "0", "completedUnits": "233", "elapsedMs": "889", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "12328" } ], "totalBytesBilled": "157286400", "totalBytesProcessed": "156682367", "totalPartitionsProcessed": "0", "totalSlotMs": "12328", "transferredBytes": "0" }, "startTime": "1665777346084", "totalBytesProcessed": "156682367", "totalSlotMs": "12328" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
