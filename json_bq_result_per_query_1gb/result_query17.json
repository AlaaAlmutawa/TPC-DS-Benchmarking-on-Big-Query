{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon297888ba_47ff_4738_817c_13319d050854" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc\n ,s_state\n ,count(ss_quantity) as store_sales_quantitycount\n ,avg(ss_quantity) as store_sales_quantityave\n ,stddev_samp(ss_quantity) as store_sales_quantitystdev\n ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\n ,count(sr_return_quantity) as store_returns_quantitycount\n ,avg(sr_return_quantity) as store_returns_quantityave\n ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\n ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\n ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\n ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\n ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\n from store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where d1.d_quarter_name = '2001Q1'\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n group by i_item_id\n ,i_item_desc\n ,s_state\n order by i_item_id\n ,i_item_desc\n ,s_state\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "e7JjpY4q2tZeAj7lmU9m7w==", "id": "test-project-364309:europe-west1.query17_1665768252", "jobReference": { "jobId": "query17_1665768252", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query17_1665768252?location=europe-west1", "statistics": { "creationTime": "1665768253061", "endTime": "1665768255322", "finalExecutionDurationMs": "2029", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "194794892", "performanceInsights": { "avgPreviousExecutionMs": "1986" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.02047244094488189, "computeRatioMax": 0.02047244094488189, "endMs": "1665768253344", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.003543307086614173, "readRatioMax": 0.003543307086614173, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "107", "startMs": "1665768253249", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003937007874015748, "waitRatioMax": 0.0003937007874015748, "writeMsAvg": "43", "writeMsMax": "43", "writeRatioAvg": 0.016929133858267716, "writeRatioMax": 0.016929133858267716 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.002362204724409449, "computeRatioMax": 0.002362204724409449, "endMs": "1665768253306", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0015748031496062992, "readRatioMax": 0.0015748031496062992, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768253265", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007874015748031496, "waitRatioMax": 0.0007874015748031496, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0066929133858267716, "writeRatioMax": 0.0066929133858267716 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.005118110236220472, "computeRatioMax": 0.005118110236220472, "endMs": "1665768253326", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.004330708661417323, "readRatioMax": 0.004330708661417323, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665768253281", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_quarter_name", "FROM date_dim", "WHERE in($21, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003937007874015748, "waitRatioMax": 0.0003937007874015748, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.003937007874015748, "writeRatioMax": 0.003937007874015748 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.004724409448818898, "computeRatioMax": 0.004724409448818898, "endMs": "1665768253333", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.003937007874015748, "readRatioMax": 0.003937007874015748, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768253294", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_quarter_name", "FROM date_dim", "WHERE in($31, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003937007874015748, "waitRatioMax": 0.0003937007874015748, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0031496062992125984, "writeRatioMax": 0.0031496062992125984 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.003937007874015748, "computeRatioMax": 0.003937007874015748, "endMs": "1665768253361", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0031496062992125984, "readRatioMax": 0.0031496062992125984, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768253328", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_quarter_name", "FROM date_dim", "WHERE equal($51, '2001Q1')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "19", "waitMsMax": "19", "waitRatioAvg": 0.007480314960629921, "waitRatioMax": 0.007480314960629921, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0066929133858267716, "writeRatioMax": 0.0066929133858267716 }, { "completedParallelInputs": "5", "computeMsAvg": "236", "computeMsMax": "327", "computeRatioAvg": 0.09291338582677165, "computeRatioMax": 0.12874015748031495, "endMs": "1665768253522", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.005905511811023622, "readRatioMax": 0.007086614173228346, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1224", "startMs": "1665768253333", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "14", "waitMsMax": "15", "waitRatioAvg": 0.005511811023622047, "waitRatioMax": 0.005905511811023622, "writeMsAvg": "15", "writeMsMax": "16", "writeRatioAvg": 0.005905511811023622, "writeRatioMax": 0.006299212598425197 }, { "completedParallelInputs": "1", "computeMsAvg": "266", "computeMsMax": "266", "computeRatioAvg": 0.1047244094488189, "computeRatioMax": 0.1047244094488189, "endMs": "1665768253556", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.005511811023622047, "readRatioMax": 0.005511811023622047, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "278", "startMs": "1665768253344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.001968503937007874, "waitRatioMax": 0.001968503937007874, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.005118110236220472, "writeRatioMax": 0.005118110236220472 }, { "completedParallelInputs": "6", "computeMsAvg": "2150", "computeMsMax": "2540", "computeRatioAvg": 0.8464566929133859, "computeRatioMax": 1, "endMs": "1665768255156", "id": "8", "inputStages": [ "6", "4", "3", "2", "5", "1", "0" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "24", "readRatioAvg": 0.007086614173228346, "readRatioMax": 0.009448818897637795, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "197", "shuffleOutputBytesSpilled": "0", "slotMs": "11295", "startMs": "1665768253600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $204, $211 := $205, $212 := $200", "$100 := COUNT($202)", "$101 := VAR_POP($110)", "$102 := SHARD_AVG($202)", "$103 := COUNT($203)", "$104 := VAR_POP($111)", "$105 := SHARD_AVG($203)", "$106 := COUNT($201)", "$107 := VAR_POP($112)", "$108 := SHARD_AVG($201)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := CAST($202 AS DOUBLE)", "$111 := CAST($203 AS DOUBLE)", "$112 := CAST($201 AS DOUBLE)" ] }, { "kind": "JOIN", "substeps": [ "$200 := $194, $201 := $190, $202 := $192, $203 := $193, $204 := $2, $205 := $3", "INNER HASH JOIN EACH WITH ALL ON $191 = $1" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $181, $192 := $183, $193 := $184, $194 := $11", "INNER HASH JOIN EACH WITH ALL ON $182 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $171, $181 := $172, $182 := $173, $183 := $174, $184 := $175", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $156", "INNER HASH JOIN EACH WITH ALL ON $155 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $136, $151 := $137, $152 := $131, $153 := $132, $154 := $133, $155 := $134, $156 := $135", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $120, $131 := $121, $132 := $122, $133 := $123, $134 := $124, $135 := $127, $136 := $40, $137 := $43", "INNER HASH JOIN EACH WITH ALL ON $126 = $41, $125 = $42" ] }, { "kind": "JOIN", "substeps": [ "$120 := $60, $121 := $61, $122 := $63, $123 := $65, $124 := $70, $125 := $71, $126 := $72, $127 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "TO __stage08_output", "BY HASH($210, $211, $212)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0003937007874015748, "waitRatioMax": 0.0007874015748031496, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0015748031496062992, "writeRatioMax": 0.001968503937007874 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.001968503937007874, "computeRatioMax": 0.001968503937007874, "endMs": "1665768255194", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665768255185", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "FROM __stage08_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($234, $235)", "$81 := divide($237, $238)", "$82 := divide($240, $241)" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212", "$90 := SUM_OF_COUNTS($100)", "$91 := ROOT_STDDEV_SAMP($101)", "$92 := ROOT_AVG($102)", "$93 := SUM_OF_COUNTS($103)", "$94 := ROOT_STDDEV_SAMP($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := ROOT_STDDEV_SAMP($107)", "$98 := ROOT_AVG($108)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003937007874015748, "waitRatioMax": 0.0003937007874015748, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.003937007874015748, "computeRatioMax": 0.003937007874015748, "endMs": "1665768255247", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768255213", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC, $231 ASC, $232 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $261, $262, $263, $264", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003937007874015748, "waitRatioMax": 0.0003937007874015748, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.010236220472440945, "writeRatioMax": 0.010236220472440945 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "643", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2234" }, { "activeUnits": "4", "completedUnits": "19", "elapsedMs": "2167", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13354" } ], "totalBytesBilled": "195035136", "totalBytesProcessed": "194794892", "totalPartitionsProcessed": "0", "totalSlotMs": "13354", "transferredBytes": "0" }, "startTime": "1665768253107", "totalBytesProcessed": "194794892", "totalSlotMs": "13354" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond5f28285_f8c7_48c2_aa71_ecb93c6cf796" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc\n ,s_state\n ,count(ss_quantity) as store_sales_quantitycount\n ,avg(ss_quantity) as store_sales_quantityave\n ,stddev_samp(ss_quantity) as store_sales_quantitystdev\n ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\n ,count(sr_return_quantity) as store_returns_quantitycount\n ,avg(sr_return_quantity) as store_returns_quantityave\n ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\n ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\n ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\n ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\n ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\n from store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where d1.d_quarter_name = '2001Q1'\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n group by i_item_id\n ,i_item_desc\n ,s_state\n order by i_item_id\n ,i_item_desc\n ,s_state\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "fC4tShOBA0H0LqJ0c/sPAg==", "id": "test-project-364309:europe-west1.query17_1665776941", "jobReference": { "jobId": "query17_1665776941", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query17_1665776941?location=europe-west1", "statistics": { "creationTime": "1665776942309", "endTime": "1665776944474", "finalExecutionDurationMs": "1913", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "194794892", "performanceInsights": { "avgPreviousExecutionMs": "1997" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "54", "computeMsMax": "54", "computeRatioAvg": 0.018960674157303372, "computeRatioMax": 0.018960674157303372, "endMs": "1665776942581", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0031601123595505617, "readRatioMax": 0.0031601123595505617, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665776942516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035112359550561797, "waitRatioMax": 0.00035112359550561797, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0031601123595505617, "writeRatioMax": 0.0031601123595505617 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0035112359550561797, "computeRatioMax": 0.0035112359550561797, "endMs": "1665776942582", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0017556179775280898, "readRatioMax": 0.0017556179775280898, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776942543", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.0035112359550561797, "waitRatioMax": 0.0035112359550561797, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0052668539325842695, "writeRatioMax": 0.0052668539325842695 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0035112359550561797, "computeRatioMax": 0.0035112359550561797, "endMs": "1665776942590", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0024578651685393258, "readRatioMax": 0.0024578651685393258, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776942557", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_quarter_name", "FROM date_dim", "WHERE in($21, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007022471910112359, "waitRatioMax": 0.0007022471910112359, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.006320224719101123, "writeRatioMax": 0.006320224719101123 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.004213483146067416, "computeRatioMax": 0.004213483146067416, "endMs": "1665776942612", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0017556179775280898, "readRatioMax": 0.0017556179775280898, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776942575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_quarter_name", "FROM date_dim", "WHERE in($31, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035112359550561797, "waitRatioMax": 0.00035112359550561797, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0052668539325842695, "writeRatioMax": 0.0052668539325842695 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.004213483146067416, "computeRatioMax": 0.004213483146067416, "endMs": "1665776942650", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002106741573033708, "readRatioMax": 0.002106741573033708, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776942592", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_quarter_name", "FROM date_dim", "WHERE equal($51, '2001Q1')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0056179775280898875, "writeRatioMax": 0.0056179775280898875 }, { "completedParallelInputs": "5", "computeMsAvg": "275", "computeMsMax": "353", "computeRatioAvg": 0.09655898876404495, "computeRatioMax": 0.12394662921348315, "endMs": "1665776942820", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "17", "readRatioAvg": 0.0052668539325842695, "readRatioMax": 0.0059691011235955055, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1232", "startMs": "1665776942612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00035112359550561797, "waitRatioMax": 0.0007022471910112359, "writeMsAvg": "15", "writeMsMax": "17", "writeRatioAvg": 0.0052668539325842695, "writeRatioMax": 0.0059691011235955055 }, { "completedParallelInputs": "1", "computeMsAvg": "177", "computeMsMax": "177", "computeRatioAvg": 0.06214887640449438, "computeRatioMax": 0.06214887640449438, "endMs": "1665776942791", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.004213483146067416, "readRatioMax": 0.004213483146067416, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "188", "startMs": "1665776942630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035112359550561797, "waitRatioMax": 0.00035112359550561797, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.004564606741573034, "writeRatioMax": 0.004564606741573034 }, { "completedParallelInputs": "6", "computeMsAvg": "2062", "computeMsMax": "2848", "computeRatioAvg": 0.7240168539325843, "computeRatioMax": 1, "endMs": "1665776944317", "id": "9", "inputStages": [ "5", "2", "4", "1", "3", "0", "6" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "21", "readRatioAvg": 0.0056179775280898875, "readRatioMax": 0.007373595505617977, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "197", "shuffleOutputBytesSpilled": "0", "slotMs": "9615", "startMs": "1665776942854", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $204, $211 := $205, $212 := $200", "$100 := COUNT($202)", "$101 := VAR_POP($110)", "$102 := SHARD_AVG($202)", "$103 := COUNT($203)", "$104 := VAR_POP($111)", "$105 := SHARD_AVG($203)", "$106 := COUNT($201)", "$107 := VAR_POP($112)", "$108 := SHARD_AVG($201)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := CAST($202 AS DOUBLE)", "$111 := CAST($203 AS DOUBLE)", "$112 := CAST($201 AS DOUBLE)" ] }, { "kind": "JOIN", "substeps": [ "$200 := $194, $201 := $190, $202 := $192, $203 := $193, $204 := $2, $205 := $3", "INNER HASH JOIN EACH WITH ALL ON $191 = $1" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $181, $192 := $183, $193 := $184, $194 := $11", "INNER HASH JOIN EACH WITH ALL ON $182 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $171, $181 := $172, $182 := $173, $183 := $174, $184 := $175", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $156", "INNER HASH JOIN EACH WITH ALL ON $155 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $136, $151 := $137, $152 := $131, $153 := $132, $154 := $133, $155 := $134, $156 := $135", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $120, $131 := $121, $132 := $122, $133 := $123, $134 := $124, $135 := $127, $136 := $40, $137 := $43", "INNER HASH JOIN EACH WITH ALL ON $126 = $41, $125 = $42" ] }, { "kind": "JOIN", "substeps": [ "$120 := $60, $121 := $61, $122 := $63, $123 := $65, $124 := $70, $125 := $71, $126 := $72, $127 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "TO __stage09_output", "BY HASH($210, $211, $212)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007022471910112359, "waitRatioMax": 0.0007022471910112359, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0014044943820224719, "writeRatioMax": 0.0017556179775280898 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0017556179775280898, "computeRatioMax": 0.0017556179775280898, "endMs": "1665776944340", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665776944329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($234, $235)", "$81 := divide($237, $238)", "$82 := divide($240, $241)" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212", "$90 := SUM_OF_COUNTS($100)", "$91 := ROOT_STDDEV_SAMP($101)", "$92 := ROOT_AVG($102)", "$93 := SUM_OF_COUNTS($103)", "$94 := ROOT_STDDEV_SAMP($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := ROOT_STDDEV_SAMP($107)", "$98 := ROOT_AVG($108)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007022471910112359, "waitRatioMax": 0.0007022471910112359, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0007022471910112359, "writeRatioMax": 0.0007022471910112359 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0035112359550561797, "computeRatioMax": 0.0035112359550561797, "endMs": "1665776944384", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776944348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC, $231 ASC, $232 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $261, $262, $263, $264", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007022471910112359, "waitRatioMax": 0.0007022471910112359, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0049157303370786515, "writeRatioMax": 0.0049157303370786515 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "641", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2244" }, { "activeUnits": "4", "completedUnits": "19", "elapsedMs": "2048", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11673" } ], "totalBytesBilled": "195035136", "totalBytesProcessed": "194794892", "totalPartitionsProcessed": "0", "totalSlotMs": "11673", "transferredBytes": "0" }, "startTime": "1665776942376", "totalBytesProcessed": "194794892", "totalSlotMs": "11673" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb8769dfb_dea4_4049_adb5_4e9c382f0963" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc\n ,s_state\n ,count(ss_quantity) as store_sales_quantitycount\n ,avg(ss_quantity) as store_sales_quantityave\n ,stddev_samp(ss_quantity) as store_sales_quantitystdev\n ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\n ,count(sr_return_quantity) as store_returns_quantitycount\n ,avg(sr_return_quantity) as store_returns_quantityave\n ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\n ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\n ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\n ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\n ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\n from store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where d1.d_quarter_name = '2001Q1'\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n group by i_item_id\n ,i_item_desc\n ,s_state\n order by i_item_id\n ,i_item_desc\n ,s_state\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NaZDJpF2yBgmKM722Ef2ww==", "id": "test-project-364309:europe-west1.query17_1665776945", "jobReference": { "jobId": "query17_1665776945", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query17_1665776945?location=europe-west1", "statistics": { "creationTime": "1665776946297", "endTime": "1665776948405", "finalExecutionDurationMs": "1872", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "194794892", "performanceInsights": { "avgPreviousExecutionMs": "1980" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "59", "computeMsMax": "59", "computeRatioAvg": 0.024481327800829875, "computeRatioMax": 0.024481327800829875, "endMs": "1665776946549", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0037344398340248964, "readRatioMax": 0.0037344398340248964, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "77", "startMs": "1665776946479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.004149377593360996, "writeRatioMax": 0.004149377593360996 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0037344398340248964, "computeRatioMax": 0.0037344398340248964, "endMs": "1665776946537", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0016597510373443983, "readRatioMax": 0.0016597510373443983, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776946495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.006639004149377593, "writeRatioMax": 0.006639004149377593 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.004979253112033195, "computeRatioMax": 0.004979253112033195, "endMs": "1665776946558", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002904564315352697, "readRatioMax": 0.002904564315352697, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776946510", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_quarter_name", "FROM date_dim", "WHERE in($21, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005809128630705394, "writeRatioMax": 0.005809128630705394 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0053941908713692945, "computeRatioMax": 0.0053941908713692945, "endMs": "1665776946571", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0037344398340248964, "readRatioMax": 0.0037344398340248964, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776946527", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_quarter_name", "FROM date_dim", "WHERE in($31, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.006224066390041493, "writeRatioMax": 0.006224066390041493 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.005809128630705394, "computeRatioMax": 0.005809128630705394, "endMs": "1665776946583", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.006639004149377593, "readRatioMax": 0.006639004149377593, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776946546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_quarter_name", "FROM date_dim", "WHERE equal($51, '2001Q1')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0033195020746887966, "writeRatioMax": 0.0033195020746887966 }, { "completedParallelInputs": "5", "computeMsAvg": "288", "computeMsMax": "389", "computeRatioAvg": 0.11950207468879669, "computeRatioMax": 0.16141078838174275, "endMs": "1665776946810", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.006639004149377593, "readRatioMax": 0.008298755186721992, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1268", "startMs": "1665776946560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "13", "writeMsMax": "17", "writeRatioAvg": 0.0053941908713692945, "writeRatioMax": 0.007053941908713693 }, { "completedParallelInputs": "1", "computeMsAvg": "378", "computeMsMax": "378", "computeRatioAvg": 0.15684647302904564, "computeRatioMax": 0.15684647302904564, "endMs": "1665776946810", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0053941908713692945, "readRatioMax": 0.0053941908713692945, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "319", "startMs": "1665776946570", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0053941908713692945, "writeRatioMax": 0.0053941908713692945 }, { "completedParallelInputs": "6", "computeMsAvg": "2040", "computeMsMax": "2410", "computeRatioAvg": 0.8464730290456431, "computeRatioMax": 1, "endMs": "1665776948258", "id": "9", "inputStages": [ "3", "4", "5", "6", "2", "1", "0" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "24", "readRatioAvg": 0.006639004149377593, "readRatioMax": 0.00995850622406639, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "197", "shuffleOutputBytesSpilled": "0", "slotMs": "9070", "startMs": "1665776946883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $204, $211 := $205, $212 := $200", "$100 := COUNT($202)", "$101 := VAR_POP($110)", "$102 := SHARD_AVG($202)", "$103 := COUNT($203)", "$104 := VAR_POP($111)", "$105 := SHARD_AVG($203)", "$106 := COUNT($201)", "$107 := VAR_POP($112)", "$108 := SHARD_AVG($201)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := CAST($202 AS DOUBLE)", "$111 := CAST($203 AS DOUBLE)", "$112 := CAST($201 AS DOUBLE)" ] }, { "kind": "JOIN", "substeps": [ "$200 := $194, $201 := $190, $202 := $192, $203 := $193, $204 := $2, $205 := $3", "INNER HASH JOIN EACH WITH ALL ON $191 = $1" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $181, $192 := $183, $193 := $184, $194 := $11", "INNER HASH JOIN EACH WITH ALL ON $182 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $171, $181 := $172, $182 := $173, $183 := $174, $184 := $175", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $156", "INNER HASH JOIN EACH WITH ALL ON $155 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $136, $151 := $137, $152 := $131, $153 := $132, $154 := $133, $155 := $134, $156 := $135", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $120, $131 := $121, $132 := $122, $133 := $123, $134 := $124, $135 := $127, $136 := $40, $137 := $43", "INNER HASH JOIN EACH WITH ALL ON $126 = $41, $125 = $42" ] }, { "kind": "JOIN", "substeps": [ "$120 := $60, $121 := $61, $122 := $63, $123 := $65, $124 := $70, $125 := $71, $126 := $72, $127 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "TO __stage09_output", "BY HASH($210, $211, $212)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "3", "writeMsMax": "5", "writeRatioAvg": 0.0012448132780082987, "writeRatioMax": 0.002074688796680498 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0033195020746887966, "computeRatioMax": 0.0033195020746887966, "endMs": "1665776948276", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665776948262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($234, $235)", "$81 := divide($237, $238)", "$82 := divide($240, $241)" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212", "$90 := SUM_OF_COUNTS($100)", "$91 := ROOT_STDDEV_SAMP($101)", "$92 := ROOT_AVG($102)", "$93 := SUM_OF_COUNTS($103)", "$94 := ROOT_STDDEV_SAMP($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := ROOT_STDDEV_SAMP($107)", "$98 := ROOT_AVG($108)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0004149377593360996, "writeRatioMax": 0.0004149377593360996 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.004149377593360996, "computeRatioMax": 0.004149377593360996, "endMs": "1665776948323", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776948286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC, $231 ASC, $232 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $261, $262, $263, $264", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004149377593360996, "waitRatioMax": 0.0004149377593360996, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005809128630705394, "writeRatioMax": 0.005809128630705394 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "630", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "3088" }, { "activeUnits": "3", "completedUnits": "19", "elapsedMs": "2002", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12171" } ], "totalBytesBilled": "195035136", "totalBytesProcessed": "194794892", "totalPartitionsProcessed": "0", "totalSlotMs": "12171", "transferredBytes": "0" }, "startTime": "1665776946351", "totalBytesProcessed": "194794892", "totalSlotMs": "12171" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9d601fa7_6222_4a01_ba26_50a4e665c283" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc\n ,s_state\n ,count(ss_quantity) as store_sales_quantitycount\n ,avg(ss_quantity) as store_sales_quantityave\n ,stddev_samp(ss_quantity) as store_sales_quantitystdev\n ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\n ,count(sr_return_quantity) as store_returns_quantitycount\n ,avg(sr_return_quantity) as store_returns_quantityave\n ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\n ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\n ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\n ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\n ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\n from store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where d1.d_quarter_name = '2001Q1'\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n group by i_item_id\n ,i_item_desc\n ,s_state\n order by i_item_id\n ,i_item_desc\n ,s_state\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "6LmdYmeBfX8VrV9mCfGgOw==", "id": "test-project-364309:europe-west1.query17_1665776949", "jobReference": { "jobId": "query17_1665776949", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query17_1665776949?location=europe-west1", "statistics": { "creationTime": "1665776950496", "endTime": "1665776952628", "finalExecutionDurationMs": "1899", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "194794892", "performanceInsights": { "avgPreviousExecutionMs": "1962" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "64", "computeMsMax": "64", "computeRatioAvg": 0.027187765505522515, "computeRatioMax": 0.027187765505522515, "endMs": "1665776950747", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002973661852166525, "readRatioMax": 0.002973661852166525, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776950687", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004248088360237893, "waitRatioMax": 0.0004248088360237893, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0033984706881903144, "writeRatioMax": 0.0033984706881903144 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.002973661852166525, "computeRatioMax": 0.002973661852166525, "endMs": "1665776950737", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002548853016142736, "readRatioMax": 0.002548853016142736, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665776950706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004248088360237893, "waitRatioMax": 0.0004248088360237893, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0076465590484282074, "writeRatioMax": 0.0076465590484282074 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.006372132540356839, "computeRatioMax": 0.006372132540356839, "endMs": "1665776950758", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002548853016142736, "readRatioMax": 0.002548853016142736, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776950722", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_quarter_name", "FROM date_dim", "WHERE in($21, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004248088360237893, "waitRatioMax": 0.0004248088360237893, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.009770603228547154, "writeRatioMax": 0.009770603228547154 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.005097706032285472, "computeRatioMax": 0.005097706032285472, "endMs": "1665776950769", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002973661852166525, "readRatioMax": 0.002973661852166525, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776950735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_quarter_name", "FROM date_dim", "WHERE in($31, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004248088360237893, "waitRatioMax": 0.0004248088360237893, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.002973661852166525, "writeRatioMax": 0.002973661852166525 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.008496176720475786, "computeRatioMax": 0.008496176720475786, "endMs": "1665776950791", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.00594732370433305, "readRatioMax": 0.00594732370433305, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776950750", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_quarter_name", "FROM date_dim", "WHERE equal($51, '2001Q1')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008496176720475786, "waitRatioMax": 0.0008496176720475786, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0055225148683092605, "writeRatioMax": 0.0055225148683092605 }, { "completedParallelInputs": "5", "computeMsAvg": "232", "computeMsMax": "301", "computeRatioAvg": 0.09855564995751911, "computeRatioMax": 0.12786745964316057, "endMs": "1665776950957", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.00594732370433305, "readRatioMax": 0.006796941376380629, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1146", "startMs": "1665776950765", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0004248088360237893, "waitRatioMax": 0.0008496176720475786, "writeMsAvg": "13", "writeMsMax": "15", "writeRatioAvg": 0.0055225148683092605, "writeRatioMax": 0.006372132540356839 }, { "completedParallelInputs": "1", "computeMsAvg": "227", "computeMsMax": "227", "computeRatioAvg": 0.09643160577740018, "computeRatioMax": 0.09643160577740018, "endMs": "1665776950975", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.006796941376380629, "readRatioMax": 0.006796941376380629, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "266", "startMs": "1665776950780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008496176720475786, "waitRatioMax": 0.0008496176720475786, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.009770603228547154, "writeRatioMax": 0.009770603228547154 }, { "completedParallelInputs": "6", "computeMsAvg": "1918", "computeMsMax": "2354", "computeRatioAvg": 0.8147833474936279, "computeRatioMax": 1, "endMs": "1665776952470", "id": "8", "inputStages": [ "3", "2", "5", "1", "4", "6", "0" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.006796941376380629, "readRatioMax": 0.008071367884451997, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "197", "shuffleOutputBytesSpilled": "0", "slotMs": "9627", "startMs": "1665776951009", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $204, $211 := $205, $212 := $200", "$100 := COUNT($202)", "$101 := VAR_POP($110)", "$102 := SHARD_AVG($202)", "$103 := COUNT($203)", "$104 := VAR_POP($111)", "$105 := SHARD_AVG($203)", "$106 := COUNT($201)", "$107 := VAR_POP($112)", "$108 := SHARD_AVG($201)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := CAST($202 AS DOUBLE)", "$111 := CAST($203 AS DOUBLE)", "$112 := CAST($201 AS DOUBLE)" ] }, { "kind": "JOIN", "substeps": [ "$200 := $194, $201 := $190, $202 := $192, $203 := $193, $204 := $2, $205 := $3", "INNER HASH JOIN EACH WITH ALL ON $191 = $1" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $181, $192 := $183, $193 := $184, $194 := $11", "INNER HASH JOIN EACH WITH ALL ON $182 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $171, $181 := $172, $182 := $173, $183 := $174, $184 := $175", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $156", "INNER HASH JOIN EACH WITH ALL ON $155 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $136, $151 := $137, $152 := $131, $153 := $132, $154 := $133, $155 := $134, $156 := $135", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $120, $131 := $121, $132 := $122, $133 := $123, $134 := $124, $135 := $127, $136 := $40, $137 := $43", "INNER HASH JOIN EACH WITH ALL ON $126 = $41, $125 = $42" ] }, { "kind": "JOIN", "substeps": [ "$120 := $60, $121 := $61, $122 := $63, $123 := $65, $124 := $70, $125 := $71, $126 := $72, $127 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "TO __stage08_output", "BY HASH($210, $211, $212)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008496176720475786, "waitRatioMax": 0.0008496176720475786, "writeMsAvg": "3", "writeMsMax": "4", "writeRatioAvg": 0.001274426508071368, "writeRatioMax": 0.0016992353440951572 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0038232795242141037, "computeRatioMax": 0.0038232795242141037, "endMs": "1665776952508", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665776952494", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "FROM __stage08_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($234, $235)", "$81 := divide($237, $238)", "$82 := divide($240, $241)" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212", "$90 := SUM_OF_COUNTS($100)", "$91 := ROOT_STDDEV_SAMP($101)", "$92 := ROOT_AVG($102)", "$93 := SUM_OF_COUNTS($103)", "$94 := ROOT_STDDEV_SAMP($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := ROOT_STDDEV_SAMP($107)", "$98 := ROOT_AVG($108)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004248088360237893, "waitRatioMax": 0.0004248088360237893, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.001274426508071368, "writeRatioMax": 0.001274426508071368 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.004672897196261682, "computeRatioMax": 0.004672897196261682, "endMs": "1665776952551", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776952510", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC, $231 ASC, $232 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $261, $262, $263, $264", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004248088360237893, "waitRatioMax": 0.0004248088360237893, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.007221750212404418, "writeRatioMax": 0.007221750212404418 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "640", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2317" }, { "activeUnits": "6", "completedUnits": "19", "elapsedMs": "2034", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11826" } ], "totalBytesBilled": "195035136", "totalBytesProcessed": "194794892", "totalPartitionsProcessed": "0", "totalSlotMs": "11826", "transferredBytes": "0" }, "startTime": "1665776950548", "totalBytesProcessed": "194794892", "totalSlotMs": "11826" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb54f57e3_ef75_4070_9cc8_d8e992232543" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc\n ,s_state\n ,count(ss_quantity) as store_sales_quantitycount\n ,avg(ss_quantity) as store_sales_quantityave\n ,stddev_samp(ss_quantity) as store_sales_quantitystdev\n ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\n ,count(sr_return_quantity) as store_returns_quantitycount\n ,avg(sr_return_quantity) as store_returns_quantityave\n ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\n ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\n ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\n ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\n ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\n from store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where d1.d_quarter_name = '2001Q1'\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n group by i_item_id\n ,i_item_desc\n ,s_state\n order by i_item_id\n ,i_item_desc\n ,s_state\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "jMOfu7iPifWLo9UKuJAC0A==", "id": "test-project-364309:europe-west1.query17_1665776953", "jobReference": { "jobId": "query17_1665776953", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query17_1665776953?location=europe-west1", "statistics": { "creationTime": "1665776954458", "endTime": "1665776956551", "finalExecutionDurationMs": "1859", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "194794892", "performanceInsights": { "avgPreviousExecutionMs": "1953" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.021449704142011833, "computeRatioMax": 0.021449704142011833, "endMs": "1665776954704", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0029585798816568047, "readRatioMax": 0.0029585798816568047, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776954639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0036982248520710057, "writeRatioMax": 0.0036982248520710057 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0029585798816568047, "computeRatioMax": 0.0029585798816568047, "endMs": "1665776954680", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0011094674556213018, "readRatioMax": 0.0011094674556213018, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776954654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.005917159763313609, "writeRatioMax": 0.005917159763313609 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0033284023668639054, "computeRatioMax": 0.0033284023668639054, "endMs": "1665776954695", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0025887573964497044, "readRatioMax": 0.0025887573964497044, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776954667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_quarter_name", "FROM date_dim", "WHERE in($21, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.004807692307692308, "writeRatioMax": 0.004807692307692308 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0036982248520710057, "computeRatioMax": 0.0036982248520710057, "endMs": "1665776954707", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0018491124260355029, "readRatioMax": 0.0018491124260355029, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776954681", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_quarter_name", "FROM date_dim", "WHERE in($31, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005177514792899409, "writeRatioMax": 0.005177514792899409 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0036982248520710057, "computeRatioMax": 0.0036982248520710057, "endMs": "1665776954719", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0018491124260355029, "readRatioMax": 0.0018491124260355029, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776954695", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_quarter_name", "FROM date_dim", "WHERE equal($51, '2001Q1')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0040680473372781065, "writeRatioMax": 0.0040680473372781065 }, { "completedParallelInputs": "5", "computeMsAvg": "281", "computeMsMax": "288", "computeRatioAvg": 0.10392011834319527, "computeRatioMax": 0.10650887573964497, "endMs": "1665776954910", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.005177514792899409, "readRatioMax": 0.005917159763313609, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1210", "startMs": "1665776954707", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007396449704142012, "waitRatioMax": 0.0007396449704142012, "writeMsAvg": "12", "writeMsMax": "17", "writeRatioAvg": 0.004437869822485207, "writeRatioMax": 0.00628698224852071 }, { "completedParallelInputs": "1", "computeMsAvg": "246", "computeMsMax": "246", "computeRatioAvg": 0.09097633136094675, "computeRatioMax": 0.09097633136094675, "endMs": "1665776954958", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.004437869822485207, "readRatioMax": 0.004437869822485207, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "269", "startMs": "1665776954719", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.005547337278106509, "writeRatioMax": 0.005547337278106509 }, { "completedParallelInputs": "6", "computeMsAvg": "2070", "computeMsMax": "2704", "computeRatioAvg": 0.7655325443786982, "computeRatioMax": 1, "endMs": "1665776956378", "id": "8", "inputStages": [ "5", "4", "3", "1", "6", "2", "0" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.005177514792899409, "readRatioMax": 0.006656804733727811, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "197", "shuffleOutputBytesSpilled": "0", "slotMs": "9949", "startMs": "1665776954983", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $204, $211 := $205, $212 := $200", "$100 := COUNT($202)", "$101 := VAR_POP($110)", "$102 := SHARD_AVG($202)", "$103 := COUNT($203)", "$104 := VAR_POP($111)", "$105 := SHARD_AVG($203)", "$106 := COUNT($201)", "$107 := VAR_POP($112)", "$108 := SHARD_AVG($201)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := CAST($202 AS DOUBLE)", "$111 := CAST($203 AS DOUBLE)", "$112 := CAST($201 AS DOUBLE)" ] }, { "kind": "JOIN", "substeps": [ "$200 := $194, $201 := $190, $202 := $192, $203 := $193, $204 := $2, $205 := $3", "INNER HASH JOIN EACH WITH ALL ON $191 = $1" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $181, $192 := $183, $193 := $184, $194 := $11", "INNER HASH JOIN EACH WITH ALL ON $182 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $171, $181 := $172, $182 := $173, $183 := $174, $184 := $175", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $156", "INNER HASH JOIN EACH WITH ALL ON $155 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $136, $151 := $137, $152 := $131, $153 := $132, $154 := $133, $155 := $134, $156 := $135", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $120, $131 := $121, $132 := $122, $133 := $123, $134 := $124, $135 := $127, $136 := $40, $137 := $43", "INNER HASH JOIN EACH WITH ALL ON $126 = $41, $125 = $42" ] }, { "kind": "JOIN", "substeps": [ "$120 := $60, $121 := $61, $122 := $63, $123 := $65, $124 := $70, $125 := $71, $126 := $72, $127 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "TO __stage08_output", "BY HASH($210, $211, $212)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "3", "writeMsMax": "4", "writeRatioAvg": 0.0011094674556213018, "writeRatioMax": 0.0014792899408284023 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0022189349112426036, "computeRatioMax": 0.0022189349112426036, "endMs": "1665776956422", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665776956411", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "FROM __stage08_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($234, $235)", "$81 := divide($237, $238)", "$82 := divide($240, $241)" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212", "$90 := SUM_OF_COUNTS($100)", "$91 := ROOT_STDDEV_SAMP($101)", "$92 := ROOT_AVG($102)", "$93 := SUM_OF_COUNTS($103)", "$94 := ROOT_STDDEV_SAMP($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := ROOT_STDDEV_SAMP($107)", "$98 := ROOT_AVG($108)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0003698224852071006, "writeRatioMax": 0.0003698224852071006 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0036982248520710057, "computeRatioMax": 0.0036982248520710057, "endMs": "1665776956465", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776956427", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC, $231 ASC, $232 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $261, $262, $263, $264", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003698224852071006, "waitRatioMax": 0.0003698224852071006, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.005547337278106509, "writeRatioMax": 0.005547337278106509 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "628", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "3076" }, { "activeUnits": "2", "completedUnits": "19", "elapsedMs": "1989", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12624" } ], "totalBytesBilled": "195035136", "totalBytesProcessed": "194794892", "totalPartitionsProcessed": "0", "totalSlotMs": "12624", "transferredBytes": "0" }, "startTime": "1665776954512", "totalBytesProcessed": "194794892", "totalSlotMs": "12624" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone6482768_d5e3_44cf_a520_a30b522f9006" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc\n ,s_state\n ,count(ss_quantity) as store_sales_quantitycount\n ,avg(ss_quantity) as store_sales_quantityave\n ,stddev_samp(ss_quantity) as store_sales_quantitystdev\n ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\n ,count(sr_return_quantity) as store_returns_quantitycount\n ,avg(sr_return_quantity) as store_returns_quantityave\n ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\n ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\n ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\n ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\n ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\n from store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where d1.d_quarter_name = '2001Q1'\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n group by i_item_id\n ,i_item_desc\n ,s_state\n order by i_item_id\n ,i_item_desc\n ,s_state\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "U5ya9M0AD4CTAWQ+M116ig==", "id": "test-project-364309:europe-west1.query17_1665776957", "jobReference": { "jobId": "query17_1665776957", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query17_1665776957?location=europe-west1", "statistics": { "creationTime": "1665776958434", "endTime": "1665776960548", "finalExecutionDurationMs": "1857", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "194794892", "performanceInsights": { "avgPreviousExecutionMs": "1941" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.022755482002482418, "computeRatioMax": 0.022755482002482418, "endMs": "1665776958689", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.004137360364087712, "readRatioMax": 0.004137360364087712, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665776958623", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008274720728175424, "waitRatioMax": 0.0008274720728175424, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.004137360364087712, "writeRatioMax": 0.004137360364087712 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.005378568473314025, "computeRatioMax": 0.005378568473314025, "endMs": "1665776958683", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.002068680182043856, "readRatioMax": 0.002068680182043856, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776958638", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004137360364087712, "waitRatioMax": 0.0004137360364087712, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.007447248655357882, "writeRatioMax": 0.007447248655357882 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.003723624327678941, "computeRatioMax": 0.003723624327678941, "endMs": "1665776958687", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.002068680182043856, "readRatioMax": 0.002068680182043856, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776958654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_quarter_name", "FROM date_dim", "WHERE in($21, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004137360364087712, "waitRatioMax": 0.0004137360364087712, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0028961522548613984, "writeRatioMax": 0.0028961522548613984 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.006206040546131568, "computeRatioMax": 0.006206040546131568, "endMs": "1665776958708", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.003723624327678941, "readRatioMax": 0.003723624327678941, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776958670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_quarter_name", "FROM date_dim", "WHERE in($31, '2001Q1', '2001Q2', '2001Q3')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004137360364087712, "waitRatioMax": 0.0004137360364087712, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.003723624327678941, "writeRatioMax": 0.003723624327678941 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.003723624327678941, "computeRatioMax": 0.003723624327678941, "endMs": "1665776958728", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0024824162184526274, "readRatioMax": 0.0024824162184526274, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776958688", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_quarter_name", "FROM date_dim", "WHERE equal($51, '2001Q1')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004137360364087712, "waitRatioMax": 0.0004137360364087712, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005792304509722797, "writeRatioMax": 0.005792304509722797 }, { "completedParallelInputs": "5", "computeMsAvg": "303", "computeMsMax": "364", "computeRatioAvg": 0.12536201903185767, "computeRatioMax": 0.15059991725279273, "endMs": "1665776958922", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "20", "readRatioAvg": 0.006206040546131568, "readRatioMax": 0.008274720728175424, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1386", "startMs": "1665776958702", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008274720728175424, "waitRatioMax": 0.0008274720728175424, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.006206040546131568, "writeRatioMax": 0.008274720728175424 }, { "completedParallelInputs": "1", "computeMsAvg": "238", "computeMsMax": "238", "computeRatioAvg": 0.09846917666528755, "computeRatioMax": 0.09846917666528755, "endMs": "1665776958921", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.006206040546131568, "readRatioMax": 0.006206040546131568, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "270", "startMs": "1665776958717", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004137360364087712, "waitRatioMax": 0.0004137360364087712, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.005378568473314025, "writeRatioMax": 0.005378568473314025 }, { "completedParallelInputs": "6", "computeMsAvg": "2088", "computeMsMax": "2417", "computeRatioAvg": 0.8638808440215143, "computeRatioMax": 1, "endMs": "1665776960383", "id": "9", "inputStages": [ "4", "3", "0", "5", "2", "6", "1" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "23", "readRatioAvg": 0.007860984691766652, "readRatioMax": 0.009515928837401738, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "197", "shuffleOutputBytesSpilled": "0", "slotMs": "11159", "startMs": "1665776958985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $204, $211 := $205, $212 := $200", "$100 := COUNT($202)", "$101 := VAR_POP($110)", "$102 := SHARD_AVG($202)", "$103 := COUNT($203)", "$104 := VAR_POP($111)", "$105 := SHARD_AVG($203)", "$106 := COUNT($201)", "$107 := VAR_POP($112)", "$108 := SHARD_AVG($201)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := CAST($202 AS DOUBLE)", "$111 := CAST($203 AS DOUBLE)", "$112 := CAST($201 AS DOUBLE)" ] }, { "kind": "JOIN", "substeps": [ "$200 := $194, $201 := $190, $202 := $192, $203 := $193, $204 := $2, $205 := $3", "INNER HASH JOIN EACH WITH ALL ON $191 = $1" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $181, $192 := $183, $193 := $184, $194 := $11", "INNER HASH JOIN EACH WITH ALL ON $182 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $171, $181 := $172, $182 := $173, $183 := $174, $184 := $175", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $156", "INNER HASH JOIN EACH WITH ALL ON $155 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $136, $151 := $137, $152 := $131, $153 := $132, $154 := $133, $155 := $134, $156 := $135", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $120, $131 := $121, $132 := $122, $133 := $123, $134 := $124, $135 := $127, $136 := $40, $137 := $43", "INNER HASH JOIN EACH WITH ALL ON $126 = $41, $125 = $42" ] }, { "kind": "JOIN", "substeps": [ "$120 := $60, $121 := $61, $122 := $63, $123 := $65, $124 := $70, $125 := $71, $126 := $72, $127 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "TO __stage09_output", "BY HASH($210, $211, $212)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008274720728175424, "waitRatioMax": 0.0008274720728175424, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.002068680182043856, "writeRatioMax": 0.002068680182043856 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.0016549441456350847, "computeRatioMax": 0.0016549441456350847, "endMs": "1665776960397", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665776960390", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($234, $235)", "$81 := divide($237, $238)", "$82 := divide($240, $241)" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212", "$90 := SUM_OF_COUNTS($100)", "$91 := ROOT_STDDEV_SAMP($101)", "$92 := ROOT_AVG($102)", "$93 := SUM_OF_COUNTS($103)", "$94 := ROOT_STDDEV_SAMP($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := ROOT_STDDEV_SAMP($107)", "$98 := ROOT_AVG($108)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004137360364087712, "waitRatioMax": 0.0004137360364087712, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0033098882912701694, "computeRatioMax": 0.0033098882912701694, "endMs": "1665776960441", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "107", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776960407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $240, $241", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC, $231 ASC, $232 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $261, $262, $263, $264", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004137360364087712, "waitRatioMax": 0.0004137360364087712, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005792304509722797, "writeRatioMax": 0.005792304509722797 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "634", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2083" }, { "activeUnits": "5", "completedUnits": "19", "elapsedMs": "1988", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13283" } ], "totalBytesBilled": "195035136", "totalBytesProcessed": "194794892", "totalPartitionsProcessed": "0", "totalSlotMs": "13283", "transferredBytes": "0" }, "startTime": "1665776958491", "totalBytesProcessed": "194794892", "totalSlotMs": "13283" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
