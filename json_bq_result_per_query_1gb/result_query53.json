{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2d1b4d50_b2a9_42f9_9f4d_a961eb1699ab" }, "priority": "INTERACTIVE", "query": "select benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "CEuXJl3kij0f4vUZSpJZow==", "id": "test-project-364309:europe-west1.query53_1665768384", "jobReference": { "jobId": "query53_1665768384", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query53_1665768384?location=europe-west1", "statistics": { "creationTime": "1665768384983", "endTime": "1665768385609", "finalExecutionDurationMs": "413", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745604", "performanceInsights": { "avgPreviousExecutionMs": "386" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06666666666666667, "computeRatioMax": 0.06666666666666667, "endMs": "1665768385183", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.02962962962962963, "readRatioMax": 0.02962962962962963, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768385146", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007407407407407408, "waitRatioMax": 0.007407407407407408, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.13333333333333333, "writeRatioMax": 0.13333333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08888888888888889, "computeRatioMax": 0.08888888888888889, "endMs": "1665768385211", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.044444444444444446, "readRatioMax": 0.044444444444444446, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768385163", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_qoy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007407407407407408, "waitRatioMax": 0.007407407407407408, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.14074074074074075, "writeRatioMax": 0.14074074074074075 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.11851851851851852, "computeRatioMax": 0.11851851851851852, "endMs": "1665768385241", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05925925925925926, "readRatioMax": 0.05925925925925926, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768385194", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manufact_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007407407407407408, "waitRatioMax": 0.007407407407407408, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.1259259259259259, "writeRatioMax": 0.1259259259259259 }, { "completedParallelInputs": "6", "computeMsAvg": "118", "computeMsMax": "135", "computeRatioAvg": 0.8740740740740741, "computeRatioMax": 1, "endMs": "1665768385364", "id": "4", "inputStages": [ "1", "0", "3" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.08148148148148149, "readRatioMax": 0.1037037037037037, "recordsRead": "2888276", "recordsWritten": "5702", "shuffleOutputBytes": "199250", "shuffleOutputBytesSpilled": "0", "slotMs": "692", "startMs": "1665768385255", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.007407407407407408, "waitRatioMax": 0.014814814814814815, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.02962962962962963, "writeRatioMax": 0.037037037037037035 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.11851851851851852, "computeRatioMax": 0.11851851851851852, "endMs": "1665768385389", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5702", "recordsWritten": "1099", "shuffleOutputBytes": "28574", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665768385371", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007407407407407408, "waitRatioMax": 0.007407407407407408, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.044444444444444446, "writeRatioMax": 0.044444444444444446 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05925925925925926, "computeRatioMax": 0.05925925925925926, "endMs": "1665768385456", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768385420", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007407407407407408, "waitRatioMax": 0.007407407407407408, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.1259259259259259, "writeRatioMax": 0.1259259259259259 }, { "completedParallelInputs": "61", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.05925925925925926, "computeRatioMax": 0.1259259259259259, "endMs": "1665768385513", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2075", "startMs": "1665768385466", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.014814814814814815, "waitRatioMax": 0.022222222222222223, "writeMsAvg": "18", "writeMsMax": "27", "writeRatioAvg": 0.13333333333333333, "writeRatioMax": 0.2 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.05925925925925926, "computeRatioMax": 0.13333333333333333, "endMs": "1665768385512", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1099", "recordsWritten": "932", "shuffleOutputBytes": "40076", "shuffleOutputBytesSpilled": "0", "slotMs": "2978", "startMs": "1665768385471", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$51 ASC, $52 ASC, $50 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "21", "waitRatioAvg": 0.02962962962962963, "waitRatioMax": 0.15555555555555556, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.0962962962962963, "writeRatioMax": 0.14074074074074075 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07407407407407407, "computeRatioMax": 0.07407407407407407, "endMs": "1665768385525", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "932", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665768385488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$291 ASC, $292 ASC, $290 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.044444444444444446, "waitRatioMax": 0.044444444444444446, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02962962962962963, "writeRatioMax": 0.02962962962962963 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "174", "elapsedMs": "509", "estimatedRunnableUnits": "0", "pendingUnits": "39", "totalSlotMs": "5854" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745604", "totalPartitionsProcessed": "0", "totalSlotMs": "5854", "transferredBytes": "0" }, "startTime": "1665768385049", "totalBytesProcessed": "113745604", "totalSlotMs": "5854" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc960e112_727a_4cdb_aa4a_75f3b1dfd43b" }, "priority": "INTERACTIVE", "query": "select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "fLG6N2kRDOSe3P//9YVGCA==", "id": "test-project-364309:europe-west1.query53_1665777770", "jobReference": { "jobId": "query53_1665777770", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query53_1665777770?location=europe-west1", "statistics": { "creationTime": "1665777771076", "endTime": "1665777771743", "finalExecutionDurationMs": "447", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745604", "performanceInsights": { "avgPreviousExecutionMs": "395" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.041884816753926704, "computeRatioMax": 0.041884816753926704, "endMs": "1665777771261", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.020942408376963352, "readRatioMax": 0.020942408376963352, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777771232", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005235602094240838, "waitRatioMax": 0.005235602094240838, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.08900523560209424, "writeRatioMax": 0.08900523560209424 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05235602094240838, "computeRatioMax": 0.05235602094240838, "endMs": "1665777771273", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03664921465968586, "readRatioMax": 0.03664921465968586, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777771246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_qoy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005235602094240838, "waitRatioMax": 0.005235602094240838, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.06282722513089005, "writeRatioMax": 0.06282722513089005 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04712041884816754, "computeRatioMax": 0.04712041884816754, "endMs": "1665777771306", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.05759162303664921, "readRatioMax": 0.05759162303664921, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777771275", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manufact_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010471204188481676, "waitRatioMax": 0.010471204188481676, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.02617801047120419, "writeRatioMax": 0.02617801047120419 }, { "completedParallelInputs": "6", "computeMsAvg": "135", "computeMsMax": "191", "computeRatioAvg": 0.7068062827225131, "computeRatioMax": 1, "endMs": "1665777771465", "id": "4", "inputStages": [ "3", "0", "1" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "15", "readRatioAvg": 0.05235602094240838, "readRatioMax": 0.07853403141361257, "recordsRead": "2888276", "recordsWritten": "5702", "shuffleOutputBytes": "199250", "shuffleOutputBytesSpilled": "0", "slotMs": "730", "startMs": "1665777771327", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005235602094240838, "waitRatioMax": 0.010471204188481676, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.020942408376963352, "writeRatioMax": 0.02617801047120419 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05235602094240838, "computeRatioMax": 0.05235602094240838, "endMs": "1665777771505", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5702", "recordsWritten": "1099", "shuffleOutputBytes": "28574", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665777771486", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.041884816753926704, "waitRatioMax": 0.041884816753926704, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.015706806282722512, "writeRatioMax": 0.015706806282722512 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.041884816753926704, "computeRatioMax": 0.041884816753926704, "endMs": "1665777771568", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777771545", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $140, $141", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005235602094240838, "waitRatioMax": 0.005235602094240838, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07853403141361257, "writeRatioMax": 0.07853403141361257 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.041884816753926704, "computeRatioMax": 0.07329842931937172, "endMs": "1665777771631", "id": "8", "inputStages": [ "7" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3117", "startMs": "1665777771574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.010471204188481676, "waitRatioMax": 0.02617801047120419, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.07329842931937172, "writeRatioMax": 0.13612565445026178 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.041884816753926704, "computeRatioMax": 0.09424083769633508, "endMs": "1665777771631", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1099", "recordsWritten": "932", "shuffleOutputBytes": "40076", "shuffleOutputBytesSpilled": "0", "slotMs": "3270", "startMs": "1665777771582", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "READ", "substeps": [ "$90, $91, $140, $141", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$51 ASC, $52 ASC, $50 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$282 := $150, $280 := $140, $281 := $141", "INNER HASH JOIN EACH WITH ALL ON $100 = $90, $101 = $91" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.05235602094240838, "waitRatioMax": 0.06282722513089005, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.07853403141361257, "writeRatioMax": 0.1518324607329843 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06282722513089005, "computeRatioMax": 0.06282722513089005, "endMs": "1665777771646", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "932", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665777771588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$291 ASC, $292 ASC, $290 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.015706806282722512, "waitRatioMax": 0.015706806282722512, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.015706806282722512, "writeRatioMax": 0.015706806282722512 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "559", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7212" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745604", "totalPartitionsProcessed": "0", "totalSlotMs": "7212", "transferredBytes": "0" }, "startTime": "1665777771127", "totalBytesProcessed": "113745604", "totalSlotMs": "7212" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3902a299_b3e1_477d_8f3f_26b02d7d5ffd" }, "priority": "INTERACTIVE", "query": "select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ICs6/KviH0fcGC/ac5X80g==", "id": "test-project-364309:europe-west1.query53_1665777772", "jobReference": { "jobId": "query53_1665777772", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query53_1665777772?location=europe-west1", "statistics": { "creationTime": "1665777773360", "endTime": "1665777774038", "finalExecutionDurationMs": "447", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745604", "performanceInsights": { "avgPreviousExecutionMs": "408" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05263157894736842, "computeRatioMax": 0.05263157894736842, "endMs": "1665777773552", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.039473684210526314, "readRatioMax": 0.039473684210526314, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777773521", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.11842105263157894, "writeRatioMax": 0.11842105263157894 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.09868421052631579, "computeRatioMax": 0.09868421052631579, "endMs": "1665777773581", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.07894736842105263, "readRatioMax": 0.07894736842105263, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777773546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_qoy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07236842105263158, "writeRatioMax": 0.07236842105263158 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.09210526315789473, "computeRatioMax": 0.09210526315789473, "endMs": "1665777773622", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.039473684210526314, "readRatioMax": 0.039473684210526314, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777773586", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manufact_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.046052631578947366, "writeRatioMax": 0.046052631578947366 }, { "completedParallelInputs": "6", "computeMsAvg": "114", "computeMsMax": "152", "computeRatioAvg": 0.75, "computeRatioMax": 1, "endMs": "1665777773741", "id": "4", "inputStages": [ "3", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.07236842105263158, "readRatioMax": 0.1118421052631579, "recordsRead": "2888276", "recordsWritten": "5702", "shuffleOutputBytes": "199250", "shuffleOutputBytesSpilled": "0", "slotMs": "714", "startMs": "1665777773633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "2", "waitMsMax": "12", "waitRatioAvg": 0.013157894736842105, "waitRatioMax": 0.07894736842105263, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.03289473684210526, "writeRatioMax": 0.046052631578947366 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.03289473684210526, "computeRatioMax": 0.03289473684210526, "endMs": "1665777773766", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5702", "recordsWritten": "1099", "shuffleOutputBytes": "28574", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665777773755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.019736842105263157, "writeRatioMax": 0.019736842105263157 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.046052631578947366, "computeRatioMax": 0.046052631578947366, "endMs": "1665777773845", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777773810", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.1118421052631579, "writeRatioMax": 0.1118421052631579 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.05263157894736842, "computeRatioMax": 0.11842105263157894, "endMs": "1665777773920", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3562", "startMs": "1665777773860", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.019736842105263157, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.10526315789473684, "writeRatioMax": 0.19078947368421054 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.05921052631578947, "computeRatioMax": 0.125, "endMs": "1665777773921", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1099", "recordsWritten": "932", "shuffleOutputBytes": "40076", "shuffleOutputBytesSpilled": "0", "slotMs": "3544", "startMs": "1665777773867", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$51 ASC, $52 ASC, $50 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.02631578947368421, "waitRatioMax": 0.03289473684210526, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.08552631578947369, "writeRatioMax": 0.125 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06578947368421052, "computeRatioMax": 0.06578947368421052, "endMs": "1665777773931", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "932", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777773876", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$291 ASC, $292 ASC, $290 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.019736842105263157, "waitRatioMax": 0.019736842105263157, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "556", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8024" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745604", "totalPartitionsProcessed": "0", "totalSlotMs": "8024", "transferredBytes": "0" }, "startTime": "1665777773414", "totalBytesProcessed": "113745604", "totalSlotMs": "8024" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2eee8135_e311_430a_9fbe_a7ac765a80c9" }, "priority": "INTERACTIVE", "query": "select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "kSJAuzizwfnXgYjoM54uog==", "id": "test-project-364309:europe-west1.query53_1665777775", "jobReference": { "jobId": "query53_1665777775", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query53_1665777775?location=europe-west1", "statistics": { "creationTime": "1665777775703", "endTime": "1665777776350", "finalExecutionDurationMs": "426", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745604", "performanceInsights": { "avgPreviousExecutionMs": "416" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.04487179487179487, "computeRatioMax": 0.04487179487179487, "endMs": "1665777775895", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777775856", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00641025641025641, "waitRatioMax": 0.00641025641025641, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.10256410256410256, "writeRatioMax": 0.10256410256410256 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.04487179487179487, "computeRatioMax": 0.04487179487179487, "endMs": "1665777775908", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05128205128205128, "readRatioMax": 0.05128205128205128, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777775875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_qoy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01282051282051282, "waitRatioMax": 0.01282051282051282, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.11538461538461539, "writeRatioMax": 0.11538461538461539 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.09615384615384616, "computeRatioMax": 0.09615384615384616, "endMs": "1665777775949", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03205128205128205, "readRatioMax": 0.03205128205128205, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777775909", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manufact_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.019230769230769232, "waitRatioMax": 0.019230769230769232, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.07692307692307693, "writeRatioMax": 0.07692307692307693 }, { "completedParallelInputs": "6", "computeMsAvg": "116", "computeMsMax": "156", "computeRatioAvg": 0.7435897435897436, "computeRatioMax": 1, "endMs": "1665777776074", "id": "4", "inputStages": [ "1", "0", "3" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.0641025641025641, "readRatioMax": 0.08333333333333333, "recordsRead": "2888276", "recordsWritten": "5702", "shuffleOutputBytes": "199250", "shuffleOutputBytesSpilled": "0", "slotMs": "808", "startMs": "1665777775965", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00641025641025641, "waitRatioMax": 0.00641025641025641, "writeMsAvg": "9", "writeMsMax": "13", "writeRatioAvg": 0.057692307692307696, "writeRatioMax": 0.08333333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.07692307692307693, "endMs": "1665777776103", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5702", "recordsWritten": "1099", "shuffleOutputBytes": "28574", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665777776084", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00641025641025641, "waitRatioMax": 0.00641025641025641, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.038461538461538464 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.04487179487179487, "computeRatioMax": 0.04487179487179487, "endMs": "1665777776169", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777776132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00641025641025641, "waitRatioMax": 0.00641025641025641, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.12179487179487179, "writeRatioMax": 0.12179487179487179 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.05128205128205128, "computeRatioMax": 0.09615384615384616, "endMs": "1665777776239", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3725", "startMs": "1665777776183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.00641025641025641, "waitRatioMax": 0.019230769230769232, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.09615384615384616, "writeRatioMax": 0.1794871794871795 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.057692307692307696, "computeRatioMax": 0.14102564102564102, "endMs": "1665777776238", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1099", "recordsWritten": "932", "shuffleOutputBytes": "40076", "shuffleOutputBytesSpilled": "0", "slotMs": "3855", "startMs": "1665777776187", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$51 ASC, $52 ASC, $50 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.019230769230769232, "waitRatioMax": 0.03205128205128205, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.08333333333333333, "writeRatioMax": 0.11538461538461539 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.057692307692307696, "computeRatioMax": 0.057692307692307696, "endMs": "1665777776247", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "932", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665777776204", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$291 ASC, $292 ASC, $290 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.019230769230769232, "waitRatioMax": 0.019230769230769232, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03205128205128205, "writeRatioMax": 0.03205128205128205 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "535", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8570" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745604", "totalPartitionsProcessed": "0", "totalSlotMs": "8570", "transferredBytes": "0" }, "startTime": "1665777775755", "totalBytesProcessed": "113745604", "totalSlotMs": "8570" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbdd6eb6b_7529_4855_b23d_83a5d6f0a940" }, "priority": "INTERACTIVE", "query": "select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "C5qLHbbVR1cHepE/43FeQw==", "id": "test-project-364309:europe-west1.query53_1665777777", "jobReference": { "jobId": "query53_1665777777", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query53_1665777777?location=europe-west1", "statistics": { "creationTime": "1665777777971", "endTime": "1665777778699", "finalExecutionDurationMs": "469", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745604", "performanceInsights": { "avgPreviousExecutionMs": "418" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.072992700729927, "computeRatioMax": 0.072992700729927, "endMs": "1665777778198", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.051094890510948905, "readRatioMax": 0.051094890510948905, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777778153", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014598540145985401, "waitRatioMax": 0.014598540145985401, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.13138686131386862, "writeRatioMax": 0.13138686131386862 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06569343065693431, "computeRatioMax": 0.06569343065693431, "endMs": "1665777778231", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0364963503649635, "readRatioMax": 0.0364963503649635, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777778176", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_qoy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.021897810218978103, "waitRatioMax": 0.021897810218978103, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.043795620437956206, "writeRatioMax": 0.043795620437956206 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06569343065693431, "computeRatioMax": 0.06569343065693431, "endMs": "1665777778272", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0364963503649635, "readRatioMax": 0.0364963503649635, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777778232", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manufact_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "21", "waitMsMax": "21", "waitRatioAvg": 0.15328467153284672, "waitRatioMax": 0.15328467153284672, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10218978102189781, "writeRatioMax": 0.10218978102189781 }, { "completedParallelInputs": "6", "computeMsAvg": "119", "computeMsMax": "137", "computeRatioAvg": 0.8686131386861314, "computeRatioMax": 1, "endMs": "1665777778392", "id": "4", "inputStages": [ "3", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.08759124087591241, "readRatioMax": 0.10948905109489052, "recordsRead": "2888276", "recordsWritten": "5702", "shuffleOutputBytes": "199250", "shuffleOutputBytesSpilled": "0", "slotMs": "707", "startMs": "1665777778288", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.014598540145985401, "waitRatioMax": 0.021897810218978103, "writeMsAvg": "6", "writeMsMax": "11", "writeRatioAvg": 0.043795620437956206, "writeRatioMax": 0.08029197080291971 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.058394160583941604, "computeRatioMax": 0.058394160583941604, "endMs": "1665777778418", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5702", "recordsWritten": "1099", "shuffleOutputBytes": "28574", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665777778404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014598540145985401, "waitRatioMax": 0.014598540145985401, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.029197080291970802, "writeRatioMax": 0.029197080291970802 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0364963503649635, "computeRatioMax": 0.0364963503649635, "endMs": "1665777778479", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665777778444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014598540145985401, "waitRatioMax": 0.014598540145985401, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.21897810218978103, "writeRatioMax": 0.21897810218978103 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.06569343065693431, "computeRatioMax": 0.10948905109489052, "endMs": "1665777778578", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3777", "startMs": "1665777778493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "4", "waitMsMax": "15", "waitRatioAvg": 0.029197080291970802, "waitRatioMax": 0.10948905109489052, "writeMsAvg": "21", "writeMsMax": "34", "writeRatioAvg": 0.15328467153284672, "writeRatioMax": 0.24817518248175183 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.058394160583941604, "computeRatioMax": 0.10218978102189781, "endMs": "1665777778578", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1099", "recordsWritten": "932", "shuffleOutputBytes": "40076", "shuffleOutputBytesSpilled": "0", "slotMs": "3333", "startMs": "1665777778508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$51 ASC, $52 ASC, $50 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "22", "waitMsMax": "32", "waitRatioAvg": 0.16058394160583941, "waitRatioMax": 0.23357664233576642, "writeMsAvg": "21", "writeMsMax": "44", "writeRatioAvg": 0.15328467153284672, "writeRatioMax": 0.32116788321167883 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06569343065693431, "computeRatioMax": 0.06569343065693431, "endMs": "1665777778577", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "932", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777778528", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$291 ASC, $292 ASC, $290 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014598540145985401, "waitRatioMax": 0.014598540145985401, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.051094890510948905, "writeRatioMax": 0.051094890510948905 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "590", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7983" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745604", "totalPartitionsProcessed": "0", "totalSlotMs": "7983", "transferredBytes": "0" }, "startTime": "1665777778035", "totalBytesProcessed": "113745604", "totalSlotMs": "7983" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonfca8f08c_14c6_45df_8c66_36dc6416c772" }, "priority": "INTERACTIVE", "query": "select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "5Jpgh88NzRHKj3xKbloY3g==", "id": "test-project-364309:europe-west1.query53_1665777779", "jobReference": { "jobId": "query53_1665777779", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query53_1665777779?location=europe-west1", "statistics": { "creationTime": "1665777780258", "endTime": "1665777780911", "finalExecutionDurationMs": "466", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745604", "performanceInsights": { "avgPreviousExecutionMs": "425" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06329113924050633, "computeRatioMax": 0.06329113924050633, "endMs": "1665777780437", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03164556962025317, "readRatioMax": 0.03164556962025317, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777780395", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.11392405063291139, "writeRatioMax": 0.11392405063291139 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06329113924050633, "computeRatioMax": 0.06329113924050633, "endMs": "1665777780452", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.06329113924050633, "readRatioMax": 0.06329113924050633, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777780413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_qoy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05063291139240506, "writeRatioMax": 0.05063291139240506 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06329113924050633, "computeRatioMax": 0.06329113924050633, "endMs": "1665777780493", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03164556962025317, "readRatioMax": 0.03164556962025317, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777780453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manufact_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.06329113924050633, "waitRatioMax": 0.06329113924050633, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08860759493670886, "writeRatioMax": 0.08860759493670886 }, { "completedParallelInputs": "6", "computeMsAvg": "126", "computeMsMax": "158", "computeRatioAvg": 0.7974683544303798, "computeRatioMax": 1, "endMs": "1665777780640", "id": "4", "inputStages": [ "1", "0", "3" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.0759493670886076, "readRatioMax": 0.10126582278481013, "recordsRead": "2888276", "recordsWritten": "5702", "shuffleOutputBytes": "199250", "shuffleOutputBytesSpilled": "0", "slotMs": "807", "startMs": "1665777780507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "6", "writeMsMax": "11", "writeRatioAvg": 0.0379746835443038, "writeRatioMax": 0.06962025316455696 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.05063291139240506, "endMs": "1665777780668", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5702", "recordsWritten": "1099", "shuffleOutputBytes": "28574", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665777780654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03164556962025317, "writeRatioMax": 0.03164556962025317 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.04430379746835443, "computeRatioMax": 0.04430379746835443, "endMs": "1665777780728", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777780691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.20253164556962025, "writeRatioMax": 0.20253164556962025 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.11392405063291139, "endMs": "1665777780790", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3909", "startMs": "1665777780731", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012658227848101266, "waitRatioMax": 0.0189873417721519, "writeMsAvg": "25", "writeMsMax": "32", "writeRatioAvg": 0.15822784810126583, "writeRatioMax": 0.20253164556962025 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "27", "computeRatioAvg": 0.056962025316455694, "computeRatioMax": 0.17088607594936708, "endMs": "1665777780806", "id": "9", "inputStages": [ "5", "8" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1099", "recordsWritten": "932", "shuffleOutputBytes": "40076", "shuffleOutputBytesSpilled": "0", "slotMs": "3541", "startMs": "1665777780738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$51 ASC, $52 ASC, $50 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.03164556962025317, "waitRatioMax": 0.0379746835443038, "writeMsAvg": "24", "writeMsMax": "60", "writeRatioAvg": 0.1518987341772152, "writeRatioMax": 0.379746835443038 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06329113924050633, "computeRatioMax": 0.06329113924050633, "endMs": "1665777780815", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "932", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665777780760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$291 ASC, $292 ASC, $290 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0189873417721519, "waitRatioMax": 0.0189873417721519, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02531645569620253, "writeRatioMax": 0.02531645569620253 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "559", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8363" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745604", "totalPartitionsProcessed": "0", "totalSlotMs": "8363", "transferredBytes": "0" }, "startTime": "1665777780299", "totalBytesProcessed": "113745604", "totalSlotMs": "8363" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
