{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0dc2d17b_b7b7_47f1_9e81_a9356893430c" }, "priority": "INTERACTIVE", "query": "with ssci as (\nselect ss_customer_sk customer_sk\n ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by ss_customer_sk\n ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by cs_bill_customer_sk\n ,cs_item_sk)\n select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n and ssci.item_sk = csci.item_sk)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "+G/J0Cy/8W9NRon040GIpA==", "id": "test-project-364309:europe-west1.query97_1665768532", "jobReference": { "jobId": "query97_1665768532", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query97_1665768532?location=europe-west1", "statistics": { "creationTime": "1665768532670", "endTime": "1665768533754", "finalExecutionDurationMs": "881", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "102703200", "performanceInsights": { "avgPreviousExecutionMs": "759" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009876543209876543, "computeRatioMax": 0.009876543209876543, "endMs": "1665768532850", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009876543209876543, "readRatioMax": 0.009876543209876543, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665768532821", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012345679012345679, "waitRatioMax": 0.0012345679012345679, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01728395061728395, "writeRatioMax": 0.01728395061728395 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012345679012345678, "computeRatioMax": 0.012345679012345678, "endMs": "1665768532883", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008641975308641974, "readRatioMax": 0.008641975308641974, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768532849", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012345679012345679, "waitRatioMax": 0.0012345679012345679, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.007407407407407408, "writeRatioMax": 0.007407407407407408 }, { "completedParallelInputs": "5", "computeMsAvg": "123", "computeMsMax": "143", "computeRatioAvg": 0.15185185185185185, "computeRatioMax": 0.1765432098765432, "endMs": "1665768532977", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "12", "readRatioAvg": 0.013580246913580247, "readRatioMax": 0.014814814814814815, "recordsRead": "1443378", "recordsWritten": "287515", "shuffleOutputBytes": "5169790", "shuffleOutputBytesSpilled": "0", "slotMs": "574", "startMs": "1665768532869", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101" ] }, { "kind": "JOIN", "substeps": [ "$100 := $11, $101 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output", "BY HASH($110, $111)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012345679012345679, "waitRatioMax": 0.0012345679012345679, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.007407407407407408, "writeRatioMax": 0.008641975308641974 }, { "completedParallelInputs": "6", "computeMsAvg": "249", "computeMsMax": "310", "computeRatioAvg": 0.3074074074074074, "computeRatioMax": 0.38271604938271603, "endMs": "1665768533115", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "22", "readRatioAvg": 0.019753086419753086, "readRatioMax": 0.027160493827160494, "recordsRead": "2882600", "recordsWritten": "552378", "shuffleOutputBytes": "9849876", "shuffleOutputBytesSpilled": "0", "slotMs": "1327", "startMs": "1665768532904", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $71, $81 := $70" ] }, { "kind": "JOIN", "substeps": [ "$70 := $2, $71 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$81, $80", "TO __stage05_output", "BY HASH($80, $81)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024691358024691358, "waitRatioMax": 0.0024691358024691358, "writeMsAvg": "9", "writeMsMax": "12", "writeRatioAvg": 0.011111111111111112, "writeRatioMax": 0.014814814814814815 }, { "completedParallelInputs": "1", "computeMsAvg": "330", "computeMsMax": "330", "computeRatioAvg": 0.4074074074074074, "computeRatioMax": 0.4074074074074074, "endMs": "1665768533359", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "287515", "recordsWritten": "287466", "shuffleOutputBytes": "5169076", "shuffleOutputBytesSpilled": "0", "slotMs": "288", "startMs": "1665768533137", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012345679012345679, "waitRatioMax": 0.0012345679012345679, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.0345679012345679, "writeRatioMax": 0.0345679012345679 }, { "completedParallelInputs": "1", "computeMsAvg": "810", "computeMsMax": "810", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768533612", "id": "7", "inputStages": [ "5" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "552378", "recordsWritten": "547500", "shuffleOutputBytes": "9799600", "shuffleOutputBytesSpilled": "0", "slotMs": "628", "startMs": "1665768533153", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81, $80", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80, $91 := $81" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012345679012345679, "waitRatioMax": 0.0012345679012345679, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.03950617283950617, "writeRatioMax": 0.03950617283950617 }, { "completedParallelInputs": "100", "computeMsAvg": "15", "computeMsMax": "23", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.028395061728395062, "endMs": "1665768533660", "id": "8", "inputStages": [ "7", "6" ], "name": "S08: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "834966", "recordsWritten": "100", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "2627", "startMs": "1665768533615", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($62)", "$51 := SUM($61)", "$52 := SUM($60)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)", "$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)", "$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $90, $131 := $120", "FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "8", "waitRatioAvg": 0.0024691358024691358, "waitRatioMax": 0.009876543209876543, "writeMsAvg": "7", "writeMsMax": "13", "writeRatioAvg": 0.008641975308641974, "writeRatioMax": 0.016049382716049384 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.008641975308641974, "computeRatioMax": 0.008641975308641974, "endMs": "1665768533666", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "1", "shuffleOutputBytes": "25", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665768533629", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$40 := SUM($50)", "$41 := SUM($51)", "$42 := SUM($52)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024691358024691358, "waitRatioMax": 0.0024691358024691358, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.003703703703703704, "writeRatioMax": 0.003703703703703704 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "13", "elapsedMs": "600", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "1980" }, { "activeUnits": "2", "completedUnits": "116", "elapsedMs": "980", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5470" } ], "totalBytesBilled": "102760448", "totalBytesProcessed": "102703200", "totalPartitionsProcessed": "0", "totalSlotMs": "5470", "transferredBytes": "0" }, "startTime": "1665768532721", "totalBytesProcessed": "102703200", "totalSlotMs": "5470" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0008bee8_b55c_4d75_bca5_8881890b5c6c" }, "priority": "INTERACTIVE", "query": "with ssci as (\nselect ss_customer_sk customer_sk\n ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by ss_customer_sk\n ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by cs_bill_customer_sk\n ,cs_item_sk)\n select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n and ssci.item_sk = csci.item_sk)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "eMJCUNtMLev6T1nvkq5drA==", "id": "test-project-364309:europe-west1.query97_1665778885", "jobReference": { "jobId": "query97_1665778885", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query97_1665778885?location=europe-west1", "statistics": { "creationTime": "1665778885772", "endTime": "1665778887092", "finalExecutionDurationMs": "1140", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "102703200", "performanceInsights": { "avgPreviousExecutionMs": "790" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.009226401703335699, "computeRatioMax": 0.009226401703335699, "endMs": "1665778885945", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0063875088715401, "readRatioMax": 0.0063875088715401, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778885906", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007097232079489, "waitRatioMax": 0.0007097232079489, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0056777856635912, "writeRatioMax": 0.0056777856635912 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0113555713271824, "computeRatioMax": 0.0113555713271824, "endMs": "1665778885976", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0063875088715401, "readRatioMax": 0.0063875088715401, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778885935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014194464158978, "waitRatioMax": 0.0014194464158978, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.007806955287437899, "writeRatioMax": 0.007806955287437899 }, { "completedParallelInputs": "5", "computeMsAvg": "123", "computeMsMax": "170", "computeRatioAvg": 0.08729595457771469, "computeRatioMax": 0.12065294535131299, "endMs": "1665778886053", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "11", "readRatioAvg": 0.007097232079488999, "readRatioMax": 0.007806955287437899, "recordsRead": "1443378", "recordsWritten": "287515", "shuffleOutputBytes": "5169790", "shuffleOutputBytesSpilled": "0", "slotMs": "586", "startMs": "1665778885956", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101" ] }, { "kind": "JOIN", "substeps": [ "$100 := $11, $101 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output", "BY HASH($110, $111)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007097232079489, "waitRatioMax": 0.0014194464158978, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.0035486160397444995, "writeRatioMax": 0.0042583392476933995 }, { "completedParallelInputs": "6", "computeMsAvg": "182", "computeMsMax": "236", "computeRatioAvg": 0.12916962384669978, "computeRatioMax": 0.16749467707594037, "endMs": "1665778886121", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.007097232079488999, "readRatioMax": 0.008516678495386799, "recordsRead": "2882600", "recordsWritten": "552378", "shuffleOutputBytes": "9849876", "shuffleOutputBytesSpilled": "0", "slotMs": "952", "startMs": "1665778885989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $71, $81 := $70" ] }, { "kind": "JOIN", "substeps": [ "$70 := $2, $71 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$81, $80", "TO __stage05_output", "BY HASH($80, $81)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007097232079489, "waitRatioMax": 0.0007097232079489, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0042583392476933995, "writeRatioMax": 0.0042583392476933995 }, { "completedParallelInputs": "1", "computeMsAvg": "440", "computeMsMax": "440", "computeRatioAvg": 0.31227821149751595, "computeRatioMax": 0.31227821149751595, "endMs": "1665778886424", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "287515", "recordsWritten": "287466", "shuffleOutputBytes": "5169076", "shuffleOutputBytesSpilled": "0", "slotMs": "411", "startMs": "1665778886139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007097232079489, "waitRatioMax": 0.0007097232079489, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.021291696238467, "writeRatioMax": 0.021291696238467 }, { "completedParallelInputs": "1", "computeMsAvg": "1409", "computeMsMax": "1409", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778886946", "id": "7", "inputStages": [ "5" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "552378", "recordsWritten": "547500", "shuffleOutputBytes": "9799600", "shuffleOutputBytesSpilled": "0", "slotMs": "1275", "startMs": "1665778886152", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81, $80", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80, $91 := $81" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007097232079489, "waitRatioMax": 0.0007097232079489, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.027679205110007096, "writeRatioMax": 0.027679205110007096 }, { "completedParallelInputs": "100", "computeMsAvg": "15", "computeMsMax": "24", "computeRatioAvg": 0.0106458481192335, "computeRatioMax": 0.017033356990773598, "endMs": "1665778887007", "id": "8", "inputStages": [ "7", "6" ], "name": "S08: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "834966", "recordsWritten": "100", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "3580", "startMs": "1665778886954", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($62)", "$51 := SUM($61)", "$52 := SUM($60)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)", "$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)", "$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $90, $131 := $120", "FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0014194464158978, "waitRatioMax": 0.0021291696238466998, "writeMsAvg": "9", "writeMsMax": "24", "writeRatioAvg": 0.0063875088715401, "writeRatioMax": 0.017033356990773598 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007806955287437899, "computeRatioMax": 0.007806955287437899, "endMs": "1665778887015", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "1", "shuffleOutputBytes": "25", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778886970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$40 := SUM($50)", "$41 := SUM($51)", "$42 := SUM($52)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014194464158978, "waitRatioMax": 0.0014194464158978, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0028388928317956, "writeRatioMax": 0.0028388928317956 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "13", "elapsedMs": "591", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "1709" }, { "activeUnits": "1", "completedUnits": "116", "elapsedMs": "1228", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6901" } ], "totalBytesBilled": "102760448", "totalBytesProcessed": "102703200", "totalPartitionsProcessed": "0", "totalSlotMs": "6901", "transferredBytes": "0" }, "startTime": "1665778885815", "totalBytesProcessed": "102703200", "totalSlotMs": "6901" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbf056f97_4588_4b45_b8bb_032860be2be3" }, "priority": "INTERACTIVE", "query": "with ssci as (\nselect ss_customer_sk customer_sk\n ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by ss_customer_sk\n ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by cs_bill_customer_sk\n ,cs_item_sk)\n select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n and ssci.item_sk = csci.item_sk)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "a6o3OQYS0o1PfizooTtO1g==", "id": "test-project-364309:europe-west1.query97_1665778889", "jobReference": { "jobId": "query97_1665778889", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query97_1665778889?location=europe-west1", "statistics": { "creationTime": "1665778889758", "endTime": "1665778890852", "finalExecutionDurationMs": "896", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "102703200", "performanceInsights": { "avgPreviousExecutionMs": "860" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011574074074074073, "computeRatioMax": 0.011574074074074073, "endMs": "1665778889948", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006944444444444444, "readRatioMax": 0.006944444444444444, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778889901", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011574074074074073, "waitRatioMax": 0.0011574074074074073, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.023148148148148147, "writeRatioMax": 0.023148148148148147 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.017361111111111112, "computeRatioMax": 0.017361111111111112, "endMs": "1665778889965", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.013888888888888888, "readRatioMax": 0.013888888888888888, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778889925", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011574074074074073, "waitRatioMax": 0.0011574074074074073, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.016203703703703703, "writeRatioMax": 0.016203703703703703 }, { "completedParallelInputs": "5", "computeMsAvg": "139", "computeMsMax": "182", "computeRatioAvg": 0.16087962962962962, "computeRatioMax": 0.21064814814814814, "endMs": "1665778890070", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "14", "readRatioAvg": 0.013888888888888888, "readRatioMax": 0.016203703703703703, "recordsRead": "1443378", "recordsWritten": "287515", "shuffleOutputBytes": "5169790", "shuffleOutputBytesSpilled": "0", "slotMs": "687", "startMs": "1665778889954", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101" ] }, { "kind": "JOIN", "substeps": [ "$100 := $11, $101 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output", "BY HASH($110, $111)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011574074074074073, "waitRatioMax": 0.0011574074074074073, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.008101851851851851, "writeRatioMax": 0.008101851851851851 }, { "completedParallelInputs": "6", "computeMsAvg": "220", "computeMsMax": "258", "computeRatioAvg": 0.25462962962962965, "computeRatioMax": 0.2986111111111111, "endMs": "1665778890158", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.015046296296296295, "readRatioMax": 0.020833333333333332, "recordsRead": "2882600", "recordsWritten": "552378", "shuffleOutputBytes": "9849876", "shuffleOutputBytesSpilled": "0", "slotMs": "1288", "startMs": "1665778889976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $71, $81 := $70" ] }, { "kind": "JOIN", "substeps": [ "$70 := $2, $71 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$81, $80", "TO __stage05_output", "BY HASH($80, $81)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011574074074074073, "waitRatioMax": 0.0011574074074074073, "writeMsAvg": "9", "writeMsMax": "13", "writeRatioAvg": 0.010416666666666666, "writeRatioMax": 0.015046296296296295 }, { "completedParallelInputs": "1", "computeMsAvg": "411", "computeMsMax": "411", "computeRatioAvg": 0.4756944444444444, "computeRatioMax": 0.4756944444444444, "endMs": "1665778890475", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "287515", "recordsWritten": "287466", "shuffleOutputBytes": "5169076", "shuffleOutputBytesSpilled": "0", "slotMs": "450", "startMs": "1665778890179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011574074074074073, "waitRatioMax": 0.0011574074074074073, "writeMsAvg": "43", "writeMsMax": "43", "writeRatioAvg": 0.04976851851851852, "writeRatioMax": 0.04976851851851852 }, { "completedParallelInputs": "1", "computeMsAvg": "864", "computeMsMax": "864", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778890649", "id": "7", "inputStages": [ "5" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "552378", "recordsWritten": "547500", "shuffleOutputBytes": "9799600", "shuffleOutputBytesSpilled": "0", "slotMs": "796", "startMs": "1665778890195", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81, $80", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80, $91 := $81" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011574074074074073, "waitRatioMax": 0.0011574074074074073, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "100", "computeMsAvg": "15", "computeMsMax": "25", "computeRatioAvg": 0.017361111111111112, "computeRatioMax": 0.028935185185185185, "endMs": "1665778890751", "id": "8", "inputStages": [ "7", "6" ], "name": "S08: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "834966", "recordsWritten": "100", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "3331", "startMs": "1665778890705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($62)", "$51 := SUM($61)", "$52 := SUM($60)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)", "$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)", "$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $90, $131 := $120", "FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0011574074074074073, "waitRatioMax": 0.003472222222222222, "writeMsAvg": "10", "writeMsMax": "23", "writeRatioAvg": 0.011574074074074073, "writeRatioMax": 0.02662037037037037 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009259259259259259, "computeRatioMax": 0.009259259259259259, "endMs": "1665778890762", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "1", "shuffleOutputBytes": "25", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665778890721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$40 := SUM($50)", "$41 := SUM($51)", "$42 := SUM($52)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003472222222222222, "waitRatioMax": 0.003472222222222222, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.003472222222222222, "writeRatioMax": 0.003472222222222222 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "13", "elapsedMs": "588", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "2059" }, { "activeUnits": "2", "completedUnits": "116", "elapsedMs": "977", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6652" } ], "totalBytesBilled": "102760448", "totalBytesProcessed": "102703200", "totalPartitionsProcessed": "0", "totalSlotMs": "6652", "transferredBytes": "0" }, "startTime": "1665778889814", "totalBytesProcessed": "102703200", "totalSlotMs": "6652" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb3a61605_c468_40fa_b3c0_2b7039b8eb9a" }, "priority": "INTERACTIVE", "query": "with ssci as (\nselect ss_customer_sk customer_sk\n ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by ss_customer_sk\n ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by cs_bill_customer_sk\n ,cs_item_sk)\n select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n and ssci.item_sk = csci.item_sk)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "gwl2hns3pVUXLCxLdSNWXw==", "id": "test-project-364309:europe-west1.query97_1665778891", "jobReference": { "jobId": "query97_1665778891", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query97_1665778891?location=europe-west1", "statistics": { "creationTime": "1665778892490", "endTime": "1665778893704", "finalExecutionDurationMs": "1023", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "102703200", "performanceInsights": { "avgPreviousExecutionMs": "866" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.006796116504854369, "computeRatioMax": 0.006796116504854369, "endMs": "1665778892660", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.006796116504854369, "readRatioMax": 0.006796116504854369, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778892631", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000970873786407767, "waitRatioMax": 0.000970873786407767, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.013592233009708738, "writeRatioMax": 0.013592233009708738 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.010679611650485437, "computeRatioMax": 0.010679611650485437, "endMs": "1665778892697", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005825242718446602, "readRatioMax": 0.005825242718446602, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778892656", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000970873786407767, "waitRatioMax": 0.000970873786407767, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.014563106796116505, "writeRatioMax": 0.014563106796116505 }, { "completedParallelInputs": "5", "computeMsAvg": "134", "computeMsMax": "163", "computeRatioAvg": 0.13009708737864079, "computeRatioMax": 0.15825242718446603, "endMs": "1665778892775", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "13", "readRatioAvg": 0.011650485436893204, "readRatioMax": 0.01262135922330097, "recordsRead": "1443378", "recordsWritten": "287515", "shuffleOutputBytes": "5169790", "shuffleOutputBytesSpilled": "0", "slotMs": "703", "startMs": "1665778892673", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101" ] }, { "kind": "JOIN", "substeps": [ "$100 := $11, $101 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output", "BY HASH($110, $111)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000970873786407767, "waitRatioMax": 0.000970873786407767, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.005825242718446602, "writeRatioMax": 0.006796116504854369 }, { "completedParallelInputs": "6", "computeMsAvg": "176", "computeMsMax": "229", "computeRatioAvg": 0.170873786407767, "computeRatioMax": 0.22233009708737864, "endMs": "1665778892861", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.010679611650485437, "readRatioMax": 0.014563106796116505, "recordsRead": "2882600", "recordsWritten": "552378", "shuffleOutputBytes": "9849876", "shuffleOutputBytesSpilled": "0", "slotMs": "1121", "startMs": "1665778892709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $71, $81 := $70" ] }, { "kind": "JOIN", "substeps": [ "$70 := $2, $71 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$81, $80", "TO __stage05_output", "BY HASH($80, $81)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000970873786407767, "waitRatioMax": 0.000970873786407767, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.006796116504854369, "writeRatioMax": 0.008737864077669903 }, { "completedParallelInputs": "1", "computeMsAvg": "339", "computeMsMax": "339", "computeRatioAvg": 0.329126213592233, "computeRatioMax": 0.329126213592233, "endMs": "1665778893098", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "287515", "recordsWritten": "287466", "shuffleOutputBytes": "5169076", "shuffleOutputBytesSpilled": "0", "slotMs": "346", "startMs": "1665778892891", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000970873786407767, "waitRatioMax": 0.000970873786407767, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.02524271844660194, "writeRatioMax": 0.02524271844660194 }, { "completedParallelInputs": "1", "computeMsAvg": "1030", "computeMsMax": "1030", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778893417", "id": "7", "inputStages": [ "5" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "552378", "recordsWritten": "547500", "shuffleOutputBytes": "9799600", "shuffleOutputBytesSpilled": "0", "slotMs": "907", "startMs": "1665778892904", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81, $80", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80, $91 := $81" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000970873786407767, "waitRatioMax": 0.000970873786407767, "writeMsAvg": "45", "writeMsMax": "45", "writeRatioAvg": 0.043689320388349516, "writeRatioMax": 0.043689320388349516 }, { "completedParallelInputs": "100", "computeMsAvg": "15", "computeMsMax": "25", "computeRatioAvg": 0.014563106796116505, "computeRatioMax": 0.024271844660194174, "endMs": "1665778893608", "id": "8", "inputStages": [ "6", "7" ], "name": "S08: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "834966", "recordsWritten": "100", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "3620", "startMs": "1665778893565", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($62)", "$51 := SUM($61)", "$52 := SUM($60)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)", "$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)", "$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $90, $131 := $120", "FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.001941747572815534, "waitRatioMax": 0.002912621359223301, "writeMsAvg": "8", "writeMsMax": "20", "writeRatioAvg": 0.007766990291262136, "writeRatioMax": 0.019417475728155338 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.008737864077669903, "computeRatioMax": 0.008737864077669903, "endMs": "1665778893619", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "1", "shuffleOutputBytes": "25", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665778893577", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$40 := SUM($50)", "$41 := SUM($51)", "$42 := SUM($52)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000970873786407767, "waitRatioMax": 0.000970873786407767, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.002912621359223301, "writeRatioMax": 0.002912621359223301 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "599", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2398" }, { "activeUnits": "1", "completedUnits": "116", "elapsedMs": "1118", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6758" } ], "totalBytesBilled": "102760448", "totalBytesProcessed": "102703200", "totalPartitionsProcessed": "0", "totalSlotMs": "6758", "transferredBytes": "0" }, "startTime": "1665778892533", "totalBytesProcessed": "102703200", "totalSlotMs": "6758" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon99599c9b_a71c_4bfb_84dd_3f576424f222" }, "priority": "INTERACTIVE", "query": "with ssci as (\nselect ss_customer_sk customer_sk\n ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by ss_customer_sk\n ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by cs_bill_customer_sk\n ,cs_item_sk)\n select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n and ssci.item_sk = csci.item_sk)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "aft4EjgQKvBQMoTdgGDRow==", "id": "test-project-364309:europe-west1.query97_1665778894", "jobReference": { "jobId": "query97_1665778894", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query97_1665778894?location=europe-west1", "statistics": { "creationTime": "1665778895260", "endTime": "1665778896208", "finalExecutionDurationMs": "753", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "102703200", "performanceInsights": { "avgPreviousExecutionMs": "888" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01929824561403509, "computeRatioMax": 0.01929824561403509, "endMs": "1665778895452", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.014035087719298246, "readRatioMax": 0.014035087719298246, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778895408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017543859649122807, "waitRatioMax": 0.0017543859649122807, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.02456140350877193, "writeRatioMax": 0.02456140350877193 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02280701754385965, "computeRatioMax": 0.02280701754385965, "endMs": "1665778895484", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.021052631578947368, "readRatioMax": 0.021052631578947368, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778895440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017543859649122807, "waitRatioMax": 0.0017543859649122807, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.014035087719298246, "writeRatioMax": 0.014035087719298246 }, { "completedParallelInputs": "5", "computeMsAvg": "115", "computeMsMax": "151", "computeRatioAvg": 0.20175438596491227, "computeRatioMax": 0.2649122807017544, "endMs": "1665778895556", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "13", "readRatioAvg": 0.01929824561403509, "readRatioMax": 0.02280701754385965, "recordsRead": "1443378", "recordsWritten": "287515", "shuffleOutputBytes": "5169790", "shuffleOutputBytesSpilled": "0", "slotMs": "578", "startMs": "1665778895462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101" ] }, { "kind": "JOIN", "substeps": [ "$100 := $11, $101 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output", "BY HASH($110, $111)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017543859649122807, "waitRatioMax": 0.0017543859649122807, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.010526315789473684, "writeRatioMax": 0.010526315789473684 }, { "completedParallelInputs": "6", "computeMsAvg": "151", "computeMsMax": "181", "computeRatioAvg": 0.2649122807017544, "computeRatioMax": 0.3175438596491228, "endMs": "1665778895620", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.01929824561403509, "readRatioMax": 0.02631578947368421, "recordsRead": "2882600", "recordsWritten": "552378", "shuffleOutputBytes": "9849876", "shuffleOutputBytesSpilled": "0", "slotMs": "902", "startMs": "1665778895491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $71, $81 := $70" ] }, { "kind": "JOIN", "substeps": [ "$70 := $2, $71 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$81, $80", "TO __stage05_output", "BY HASH($80, $81)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017543859649122807, "waitRatioMax": 0.0017543859649122807, "writeMsAvg": "9", "writeMsMax": "13", "writeRatioAvg": 0.015789473684210527, "writeRatioMax": 0.02280701754385965 }, { "completedParallelInputs": "1", "computeMsAvg": "359", "computeMsMax": "359", "computeRatioAvg": 0.6298245614035087, "computeRatioMax": 0.6298245614035087, "endMs": "1665778895878", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "287515", "recordsWritten": "287466", "shuffleOutputBytes": "5169076", "shuffleOutputBytesSpilled": "0", "slotMs": "339", "startMs": "1665778895643", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017543859649122807, "waitRatioMax": 0.0017543859649122807, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.05263157894736842, "writeRatioMax": 0.05263157894736842 }, { "completedParallelInputs": "1", "computeMsAvg": "570", "computeMsMax": "570", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778896019", "id": "7", "inputStages": [ "5" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "552378", "recordsWritten": "547500", "shuffleOutputBytes": "9799600", "shuffleOutputBytesSpilled": "0", "slotMs": "495", "startMs": "1665778895660", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81, $80", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80, $91 := $81" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017543859649122807, "waitRatioMax": 0.0017543859649122807, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.06315789473684211, "writeRatioMax": 0.06315789473684211 }, { "completedParallelInputs": "100", "computeMsAvg": "15", "computeMsMax": "23", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.04035087719298246, "endMs": "1665778896112", "id": "8", "inputStages": [ "6", "7" ], "name": "S08: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "834966", "recordsWritten": "100", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "3520", "startMs": "1665778896061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($62)", "$51 := SUM($61)", "$52 := SUM($60)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)", "$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)", "$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $90, $131 := $120", "FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "6", "writeMsMax": "24", "writeRatioAvg": 0.010526315789473684, "writeRatioMax": 0.042105263157894736 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.02456140350877193, "computeRatioMax": 0.02456140350877193, "endMs": "1665778896122", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "1", "shuffleOutputBytes": "25", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778896077", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$40 := SUM($50)", "$41 := SUM($51)", "$42 := SUM($52)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.0035087719298245615, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007017543859649123, "writeRatioMax": 0.007017543859649123 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "601", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1919" }, { "activeUnits": "1", "completedUnits": "116", "elapsedMs": "852", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5961" } ], "totalBytesBilled": "102760448", "totalBytesProcessed": "102703200", "totalPartitionsProcessed": "0", "totalSlotMs": "5961", "transferredBytes": "0" }, "startTime": "1665778895308", "totalBytesProcessed": "102703200", "totalSlotMs": "5961" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3b434534_43de_40bd_8022_9609a53ea7ff" }, "priority": "INTERACTIVE", "query": "with ssci as (\nselect ss_customer_sk customer_sk\n ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by ss_customer_sk\n ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n and d_month_seq between 1200 and 1200 + 11\ngroup by cs_bill_customer_sk\n ,cs_item_sk)\n select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n and ssci.item_sk = csci.item_sk)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "YAIrElZIUZyVud/GA+d0LQ==", "id": "test-project-364309:europe-west1.query97_1665778897", "jobReference": { "jobId": "query97_1665778897", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query97_1665778897?location=europe-west1", "statistics": { "creationTime": "1665778897837", "endTime": "1665778898921", "finalExecutionDurationMs": "893", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "102703200", "performanceInsights": { "avgPreviousExecutionMs": "871" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.011221945137157107, "computeRatioMax": 0.011221945137157107, "endMs": "1665778898013", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.016209476309226933, "readRatioMax": 0.016209476309226933, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778897983", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012468827930174563, "waitRatioMax": 0.0012468827930174563, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.011221945137157107, "writeRatioMax": 0.011221945137157107 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.017456359102244388, "computeRatioMax": 0.017456359102244388, "endMs": "1665778898043", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008728179551122194, "readRatioMax": 0.008728179551122194, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778898012", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012468827930174563, "waitRatioMax": 0.0012468827930174563, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.017456359102244388, "writeRatioMax": 0.017456359102244388 }, { "completedParallelInputs": "5", "computeMsAvg": "120", "computeMsMax": "139", "computeRatioAvg": 0.14962593516209477, "computeRatioMax": 0.17331670822942644, "endMs": "1665778898171", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "35", "readRatioAvg": 0.0199501246882793, "readRatioMax": 0.043640897755610975, "recordsRead": "1443378", "recordsWritten": "287515", "shuffleOutputBytes": "5169790", "shuffleOutputBytesSpilled": "0", "slotMs": "662", "startMs": "1665778898032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101" ] }, { "kind": "JOIN", "substeps": [ "$100 := $11, $101 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output", "BY HASH($110, $111)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012468827930174563, "waitRatioMax": 0.0012468827930174563, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.008728179551122194, "writeRatioMax": 0.011221945137157107 }, { "completedParallelInputs": "6", "computeMsAvg": "205", "computeMsMax": "257", "computeRatioAvg": 0.25561097256857856, "computeRatioMax": 0.3204488778054863, "endMs": "1665778898215", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "21", "readRatioAvg": 0.016209476309226933, "readRatioMax": 0.026184538653366583, "recordsRead": "2882600", "recordsWritten": "552378", "shuffleOutputBytes": "9849876", "shuffleOutputBytesSpilled": "0", "slotMs": "1177", "startMs": "1665778898050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $71, $81 := $70" ] }, { "kind": "JOIN", "substeps": [ "$70 := $2, $71 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$81, $80", "TO __stage05_output", "BY HASH($80, $81)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012468827930174563, "waitRatioMax": 0.0012468827930174563, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.008728179551122194, "writeRatioMax": 0.011221945137157107 }, { "completedParallelInputs": "1", "computeMsAvg": "473", "computeMsMax": "473", "computeRatioAvg": 0.5897755610972568, "computeRatioMax": 0.5897755610972568, "endMs": "1665778898492", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "287515", "recordsWritten": "287466", "shuffleOutputBytes": "5169076", "shuffleOutputBytesSpilled": "0", "slotMs": "290", "startMs": "1665778898242", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012468827930174563, "waitRatioMax": 0.0012468827930174563, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.0399002493765586, "writeRatioMax": 0.0399002493765586 }, { "completedParallelInputs": "1", "computeMsAvg": "802", "computeMsMax": "802", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778898716", "id": "7", "inputStages": [ "5" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "552378", "recordsWritten": "547500", "shuffleOutputBytes": "9799600", "shuffleOutputBytesSpilled": "0", "slotMs": "652", "startMs": "1665778898262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81, $80", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80, $91 := $81" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.0024937655860349127, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.04114713216957606, "writeRatioMax": 0.04114713216957606 }, { "completedParallelInputs": "100", "computeMsAvg": "14", "computeMsMax": "23", "computeRatioAvg": 0.017456359102244388, "computeRatioMax": 0.028678304239401497, "endMs": "1665778898826", "id": "8", "inputStages": [ "7", "6" ], "name": "S08: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "834966", "recordsWritten": "100", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "3244", "startMs": "1665778898781", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($62)", "$51 := SUM($61)", "$52 := SUM($60)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)", "$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)", "$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $90, $131 := $120", "FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.003740648379052369, "writeMsAvg": "7", "writeMsMax": "13", "writeRatioAvg": 0.008728179551122194, "writeRatioMax": 0.016209476309226933 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.008728179551122194, "computeRatioMax": 0.008728179551122194, "endMs": "1665778898835", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "1", "shuffleOutputBytes": "25", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665778898797", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$40 := SUM($50)", "$41 := SUM($51)", "$42 := SUM($52)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003740648379052369, "waitRatioMax": 0.003740648379052369, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.003740648379052369, "writeRatioMax": 0.003740648379052369 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "13", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "1907" }, { "activeUnits": "2", "completedUnits": "116", "elapsedMs": "982", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6064" } ], "totalBytesBilled": "102760448", "totalBytesProcessed": "102703200", "totalPartitionsProcessed": "0", "totalSlotMs": "6064", "transferredBytes": "0" }, "startTime": "1665778897888", "totalBytesProcessed": "102703200", "totalSlotMs": "6064" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
