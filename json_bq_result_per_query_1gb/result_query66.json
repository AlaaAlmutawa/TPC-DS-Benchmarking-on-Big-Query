{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2a37b030_db16_4bba_b23b_82262e50aea0" }, "priority": "INTERACTIVE", "query": "-- start query 66 in stream 0 using template query66.tpl\nselect \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,ship_carriers\n ,year\n \t,sum(jan_sales) as jan_sales\n \t,sum(feb_sales) as feb_sales\n \t,sum(mar_sales) as mar_sales\n \t,sum(apr_sales) as apr_sales\n \t,sum(may_sales) as may_sales\n \t,sum(jun_sales) as jun_sales\n \t,sum(jul_sales) as jul_sales\n \t,sum(aug_sales) as aug_sales\n \t,sum(sep_sales) as sep_sales\n \t,sum(oct_sales) as oct_sales\n \t,sum(nov_sales) as nov_sales\n \t,sum(dec_sales) as dec_sales\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\n \t,sum(jan_net) as jan_net\n \t,sum(feb_net) as feb_net\n \t,sum(mar_net) as mar_net\n \t,sum(apr_net) as apr_net\n \t,sum(may_net) as may_net\n \t,sum(jun_net) as jun_net\n \t,sum(jul_net) as jul_net\n \t,sum(aug_net) as aug_net\n \t,sum(sep_net) as sep_net\n \t,sum(oct_net) as oct_net\n \t,sum(nov_net) as nov_net\n \t,sum(dec_net) as dec_net\n from (\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as dec_net\n from\n web_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n ws_warehouse_sk = w_warehouse_sk\n and ws_sold_date_sk = d_date_sk\n and ws_sold_time_sk = t_time_sk\n \tand ws_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 and 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n union all\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen cs_net_paid benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as dec_net\n from\n catalog_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n cs_warehouse_sk = w_warehouse_sk\n and cs_sold_date_sk = d_date_sk\n and cs_sold_time_sk = t_time_sk\n \tand cs_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 AND 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n ) x\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,ship_carriers\n ,year\n order by w_warehouse_name\n limit 100\n ;\n\n-- end query 66 in stream 0 using template query66.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "c1gRSQagD66TH2IzSoLgow==", "id": "test-project-364309:europe-west1.query66_1665768425", "jobReference": { "jobId": "query66_1665768425", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query66_1665768425?location=europe-west1", "statistics": { "creationTime": "1665768425975", "endTime": "1665768427177", "finalExecutionDurationMs": "871", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "158201227", "performanceInsights": { "avgPreviousExecutionMs": "695" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012422360248447204, "computeRatioMax": 0.012422360248447204, "endMs": "1665768426284", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010351966873706004, "readRatioMax": 0.010351966873706004, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768426246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sm_ship_mode_sk, $11:sm_carrier", "FROM ship_mode", "WHERE in($11, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.035196687370600416, "writeRatioMax": 0.035196687370600416 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.045548654244306416, "computeRatioMax": 0.045548654244306416, "endMs": "1665768426326", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "43", "readMsMax": "43", "readRatioAvg": 0.08902691511387163, "readRatioMax": 0.08902691511387163, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665768426261", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:t_time_sk, $31:t_time", "FROM time_dim", "WHERE between($31, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.016563146997929608, "writeRatioMax": 0.016563146997929608 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.018633540372670808, "computeRatioMax": 0.018633540372670808, "endMs": "1665768426333", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010351966873706004, "readRatioMax": 0.010351966873706004, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768426283", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year, $92:d_moy", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.053830227743271224, "writeRatioMax": 0.053830227743271224 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.014492753623188406, "computeRatioMax": 0.014492753623188406, "endMs": "1665768426369", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.018633540372670808, "readRatioMax": 0.018633540372670808, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768426326", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name, $82:w_warehouse_sq_ft, $83:w_city, $84:w_county, $85:w_state, $86:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "TO __stage03_output" ] } ], "waitMsAvg": "28", "waitMsMax": "28", "waitRatioAvg": 0.057971014492753624, "waitRatioMax": 0.057971014492753624, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.033126293995859216, "writeRatioMax": 0.033126293995859216 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.020703933747412008, "computeRatioMax": 0.020703933747412008, "endMs": "1665768426388", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010351966873706004, "readRatioMax": 0.010351966873706004, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768426345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:sm_ship_mode_sk, $2:sm_carrier", "FROM ship_mode", "WHERE in($2, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.033126293995859216, "writeRatioMax": 0.033126293995859216 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.045548654244306416, "computeRatioMax": 0.045548654244306416, "endMs": "1665768426409", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.016563146997929608, "readRatioMax": 0.016563146997929608, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768426361", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:t_time_sk, $21:t_time", "FROM time_dim", "WHERE between($21, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.022774327122153208, "writeRatioMax": 0.022774327122153208 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.024844720496894408, "computeRatioMax": 0.024844720496894408, "endMs": "1665768426417", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014492753623188406, "readRatioMax": 0.014492753623188406, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768426377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE equal($61, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.026915113871635612, "writeRatioMax": 0.026915113871635612 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.022774327122153208, "computeRatioMax": 0.022774327122153208, "endMs": "1665768426439", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010351966873706004, "readRatioMax": 0.010351966873706004, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768426394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:w_warehouse_sk, $51:w_warehouse_name, $52:w_warehouse_sq_ft, $53:w_city, $54:w_county, $55:w_state, $56:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.035196687370600416, "writeRatioMax": 0.035196687370600416 }, { "completedParallelInputs": "5", "computeMsAvg": "242", "computeMsMax": "303", "computeRatioAvg": 0.5010351966873706, "computeRatioMax": 0.6273291925465838, "endMs": "1665768426642", "id": "10", "inputStages": [ "0", "3", "1", "2" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "21", "readMsMax": "35", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.07246376811594203, "recordsRead": "1587413", "recordsWritten": "25", "shuffleOutputBytes": "12565", "shuffleOutputBytesSpilled": "0", "slotMs": "1154", "startMs": "1665768426417", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_sold_time_sk, $72:cs_ship_mode_sk, $73:cs_warehouse_sk, $74:cs_quantity, $75:cs_ext_list_price, $76:cs_net_paid", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $603, $621 := $604, $622 := $605, $623 := $606, $624 := $607, $625 := $608, $626 := $609", "$350 := SUM($433)", "$351 := SUM($432)", "$352 := SUM($431)", "$353 := SUM($430)", "$354 := SUM($429)", "$355 := SUM($428)", "$356 := SUM($427)", "$357 := SUM($426)", "$358 := SUM($425)", "$359 := SUM($424)", "$360 := SUM($423)", "$361 := SUM($422)", "$362 := SUM($421)", "$363 := SUM($420)", "$364 := SUM($419)", "$365 := SUM($418)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := case_no_value(equal($610, 12), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$411 := case_no_value(equal($610, 11), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$412 := case_no_value(equal($610, 10), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$413 := case_no_value(equal($610, 9), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$414 := case_no_value(equal($610, 8), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$415 := case_no_value(equal($610, 7), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$416 := case_no_value(equal($610, 6), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$417 := case_no_value(equal($610, 5), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$418 := case_no_value(equal($610, 4), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$419 := case_no_value(equal($610, 3), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$420 := case_no_value(equal($610, 2), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$421 := case_no_value(equal($610, 1), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$422 := case_no_value(equal($610, 12), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$423 := case_no_value(equal($610, 11), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$424 := case_no_value(equal($610, 10), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$425 := case_no_value(equal($610, 9), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $589, $609 := $590, $610 := $591", "INNER HASH JOIN EACH WITH ALL ON $580 = $10" ] }, { "kind": "JOIN", "substeps": [ "$580 := $561, $581 := $562, $582 := $563, $583 := $564, $584 := $565, $585 := $566, $586 := $567, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $572", "INNER HASH JOIN EACH WITH ALL ON $560 = $30" ] }, { "kind": "JOIN", "substeps": [ "$560 := $541, $561 := $542, $562 := $543, $563 := $544, $564 := $545, $565 := $546, $566 := $547, $567 := $548, $568 := $549, $569 := $550, $570 := $551, $571 := $91, $572 := $92", "INNER HASH JOIN EACH WITH ALL ON $540 = $90" ] }, { "kind": "JOIN", "substeps": [ "$540 := $70, $541 := $71, $542 := $72, $543 := $74, $544 := $75, $545 := $76, $546 := $81, $547 := $82, $548 := $83, $549 := $84, $550 := $85, $551 := $86", "INNER HASH JOIN EACH WITH ALL ON $73 = $80" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "TO __stage0A_output", "BY HASH($620, $621, $622, $623, $624, $625, $626)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.004140786749482402, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.008281573498964804, "writeRatioMax": 0.012422360248447204 }, { "completedParallelInputs": "1", "computeMsAvg": "483", "computeMsMax": "483", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768426844", "id": "11", "inputStages": [ "7", "6", "5", "8" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "72", "readMsMax": "72", "readRatioAvg": 0.14906832298136646, "readRatioMax": 0.14906832298136646, "recordsRead": "748557", "recordsWritten": "5", "shuffleOutputBytes": "2513", "shuffleOutputBytesSpilled": "0", "slotMs": "508", "startMs": "1665768426448", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_sold_time_sk, $42:ws_ship_mode_sk, $43:ws_warehouse_sk, $44:ws_quantity, $45:ws_ext_sales_price, $46:ws_net_paid_inc_ship", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $503, $521 := $504, $522 := $505, $523 := $506, $524 := $507, $525 := $508, $526 := $509", "$320 := SUM($403)", "$321 := SUM($402)", "$322 := SUM($401)", "$323 := SUM($400)", "$324 := SUM($399)", "$325 := SUM($398)", "$326 := SUM($397)", "$327 := SUM($396)", "$328 := SUM($395)", "$329 := SUM($394)", "$330 := SUM($393)", "$331 := SUM($392)", "$332 := SUM($391)", "$333 := SUM($390)", "$334 := SUM($389)", "$335 := SUM($388)" ] }, { "kind": "COMPUTE", "substeps": [ "$380 := case_no_value(equal($510, 12), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$381 := case_no_value(equal($510, 11), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$382 := case_no_value(equal($510, 10), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$383 := case_no_value(equal($510, 9), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$384 := case_no_value(equal($510, 8), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$385 := case_no_value(equal($510, 7), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$386 := case_no_value(equal($510, 6), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$387 := case_no_value(equal($510, 5), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$388 := case_no_value(equal($510, 4), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$389 := case_no_value(equal($510, 3), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$390 := case_no_value(equal($510, 2), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$391 := case_no_value(equal($510, 1), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$392 := case_no_value(equal($510, 12), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$393 := case_no_value(equal($510, 11), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$394 := case_no_value(equal($510, 10), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$395 := case_no_value(equal($510, 9), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $481, $501 := $482, $502 := $483, $503 := $484, $504 := $485, $505 := $486, $506 := $487, $507 := $488, $508 := $489, $509 := $490, $510 := $491", "INNER HASH JOIN EACH WITH ALL ON $480 = $1" ] }, { "kind": "JOIN", "substeps": [ "$480 := $461, $481 := $462, $482 := $463, $483 := $464, $484 := $465, $485 := $466, $486 := $467, $487 := $468, $488 := $469, $489 := $470, $490 := $471, $491 := $472", "INNER HASH JOIN EACH WITH ALL ON $460 = $20" ] }, { "kind": "JOIN", "substeps": [ "$460 := $441, $461 := $442, $462 := $443, $463 := $444, $464 := $445, $465 := $446, $466 := $447, $467 := $448, $468 := $449, $469 := $450, $470 := $451, $471 := $61, $472 := $62", "INNER HASH JOIN EACH WITH ALL ON $440 = $60" ] }, { "kind": "JOIN", "substeps": [ "$440 := $40, $441 := $41, $442 := $42, $443 := $44, $444 := $45, $445 := $46, $446 := $51, $447 := $52, $448 := $53, $449 := $54, $450 := $55, $451 := $56", "INNER HASH JOIN EACH WITH ALL ON $43 = $50" ] }, { "kind": "WRITE", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "TO __stage0B_output", "BY HASH($520, $521, $522, $523, $524, $525, $526)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.012422360248447204, "writeRatioMax": 0.012422360248447204 }, { "completedParallelInputs": "2", "computeMsAvg": "9", "computeMsMax": "10", "computeRatioAvg": 0.018633540372670808, "computeRatioMax": 0.020703933747412008, "endMs": "1665768427015", "id": "12", "inputStages": [ "11", "10" ], "name": "S0C: Aggregate+", "parallelInputs": "2", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "10", "shuffleOutputBytes": "6922", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665768426964", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $200, $641 := $201, $642 := $202, $643 := $203, $644 := $204, $645 := $205, $646 := $206, $647 := $207", "$140 := SUM($208)", "$141 := SUM($209)", "$142 := SUM($210)", "$143 := SUM($211)", "$144 := SUM($212)", "$145 := SUM($213)", "$146 := SUM($214)", "$147 := SUM($215)", "$148 := SUM($216)", "$149 := SUM($217)", "$150 := SUM($218)", "$151 := SUM($219)", "$152 := SUM($180)", "$153 := SUM($181)", "$154 := SUM($182)", "$155 := SUM($183)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($208, CAST($201 AS NUMERIC))", "$181 := divide($209, CAST($201 AS NUMERIC))", "$182 := divide($210, CAST($201 AS NUMERIC))", "$183 := divide($211, CAST($201 AS NUMERIC))", "$184 := divide($212, CAST($201 AS NUMERIC))", "$185 := divide($213, CAST($201 AS NUMERIC))", "$186 := divide($214, CAST($201 AS NUMERIC))", "$187 := divide($215, CAST($201 AS NUMERIC))", "$188 := divide($216, CAST($201 AS NUMERIC))", "$189 := divide($217, CAST($201 AS NUMERIC))", "$190 := divide($218, CAST($201 AS NUMERIC))", "$191 := divide($219, CAST($201 AS NUMERIC))" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $520, $531 := $521, $532 := $522, $533 := $523, $534 := $524, $535 := $525, $536 := $526", "$260 := SUM($320)", "$261 := SUM($321)", "$262 := SUM($322)", "$263 := SUM($323)", "$264 := SUM($324)", "$265 := SUM($325)", "$266 := SUM($326)", "$267 := SUM($327)", "$268 := SUM($328)", "$269 := SUM($329)", "$270 := SUM($330)", "$271 := SUM($331)", "$272 := SUM($332)", "$273 := SUM($333)", "$274 := SUM($334)", "$275 := SUM($335)" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622, $633 := $623, $634 := $624, $635 := $625, $636 := $626", "$290 := SUM($350)", "$291 := SUM($351)", "$292 := SUM($352)", "$293 := SUM($353)", "$294 := SUM($354)", "$295 := SUM($355)", "$296 := SUM($356)", "$297 := SUM($357)", "$298 := SUM($358)", "$299 := SUM($359)", "$300 := SUM($360)", "$301 := SUM($361)", "$302 := SUM($362)", "$303 := SUM($363)", "$304 := SUM($364)", "$305 := SUM($365)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "TO __stage0C_output", "BY HASH($640, $641, $642, $643, $644, $645, $646, $647)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.055900621118012424, "writeRatioMax": 0.055900621118012424 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.035196687370600416, "computeRatioMax": 0.035196687370600416, "endMs": "1665768427069", "id": "13", "inputStages": [ "12" ], "name": "S0D: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768427026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$650 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $650 := $640, $651 := $641, $652 := $642, $653 := $643, $654 := $644, $655 := $645, $656 := $646, $657 := $647", "$100 := SUM($140)", "$101 := SUM($141)", "$102 := SUM($142)", "$103 := SUM($143)", "$104 := SUM($144)", "$105 := SUM($145)", "$106 := SUM($146)", "$107 := SUM($147)", "$108 := SUM($148)", "$109 := SUM($149)", "$110 := SUM($150)", "$111 := SUM($151)", "$112 := SUM($152)", "$113 := SUM($153)", "$114 := SUM($154)", "$115 := SUM($155)" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.039337474120082816, "writeRatioMax": 0.039337474120082816 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.020703933747412008, "computeRatioMax": 0.020703933747412008, "endMs": "1665768427086", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768427041", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$696 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719, $720, $721, $722, $723, $724, $725", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002070393374741201, "waitRatioMax": 0.002070393374741201, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.014492753623188406, "writeRatioMax": 0.014492753623188406 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "13", "elapsedMs": "705", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1766" }, { "activeUnits": "1", "completedUnits": "18", "elapsedMs": "1081", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2191" } ], "totalBytesBilled": "158334976", "totalBytesProcessed": "158201227", "totalPartitionsProcessed": "0", "totalSlotMs": "2191", "transferredBytes": "0" }, "startTime": "1665768426042", "totalBytesProcessed": "158201227", "totalSlotMs": "2191" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0382bd4f_c57b_4d0e_b8a6_7fa290177597" }, "priority": "INTERACTIVE", "query": "-- start query 66 in stream 0 using template query66.tpl\nselect \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,ship_carriers\n ,year\n \t,sum(jan_sales) as jan_sales\n \t,sum(feb_sales) as feb_sales\n \t,sum(mar_sales) as mar_sales\n \t,sum(apr_sales) as apr_sales\n \t,sum(may_sales) as may_sales\n \t,sum(jun_sales) as jun_sales\n \t,sum(jul_sales) as jul_sales\n \t,sum(aug_sales) as aug_sales\n \t,sum(sep_sales) as sep_sales\n \t,sum(oct_sales) as oct_sales\n \t,sum(nov_sales) as nov_sales\n \t,sum(dec_sales) as dec_sales\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\n \t,sum(jan_net) as jan_net\n \t,sum(feb_net) as feb_net\n \t,sum(mar_net) as mar_net\n \t,sum(apr_net) as apr_net\n \t,sum(may_net) as may_net\n \t,sum(jun_net) as jun_net\n \t,sum(jul_net) as jul_net\n \t,sum(aug_net) as aug_net\n \t,sum(sep_net) as sep_net\n \t,sum(oct_net) as oct_net\n \t,sum(nov_net) as nov_net\n \t,sum(dec_net) as dec_net\n from (\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as dec_net\n from\n web_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n ws_warehouse_sk = w_warehouse_sk\n and ws_sold_date_sk = d_date_sk\n and ws_sold_time_sk = t_time_sk\n \tand ws_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 and 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n union all\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as dec_net\n from\n catalog_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n cs_warehouse_sk = w_warehouse_sk\n and cs_sold_date_sk = d_date_sk\n and cs_sold_time_sk = t_time_sk\n \tand cs_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 AND 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n ) x\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,ship_carriers\n ,year\n order by w_warehouse_name\n limit 100\n ;\n\n-- end query 66 in stream 0 using template query66.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Q7IC+j6yjvH12KhiItt8fg==", "id": "test-project-364309:europe-west1.query66_1665778353", "jobReference": { "jobId": "query66_1665778353", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query66_1665778353?location=europe-west1", "statistics": { "creationTime": "1665778354332", "endTime": "1665778355329", "finalExecutionDurationMs": "712", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "158201227", "performanceInsights": { "avgPreviousExecutionMs": "725" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.01126126126126126, "computeRatioMax": 0.01126126126126126, "endMs": "1665778354577", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013513513513513514, "readRatioMax": 0.013513513513513514, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778354546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sm_ship_mode_sk, $11:sm_carrier", "FROM ship_mode", "WHERE in($11, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04054054054054054, "writeRatioMax": 0.04054054054054054 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.04504504504504504, "computeRatioMax": 0.04504504504504504, "endMs": "1665778354593", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.018018018018018018, "readRatioMax": 0.018018018018018018, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778354560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:t_time_sk, $31:t_time", "FROM time_dim", "WHERE between($31, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.024774774774774775, "writeRatioMax": 0.024774774774774775 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.024774774774774775, "computeRatioMax": 0.024774774774774775, "endMs": "1665778354605", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03153153153153153, "readRatioMax": 0.03153153153153153, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778354574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year, $92:d_moy", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02027027027027027, "writeRatioMax": 0.02027027027027027 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.015765765765765764, "computeRatioMax": 0.015765765765765764, "endMs": "1665778354637", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013513513513513514, "readRatioMax": 0.013513513513513514, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778354593", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name, $82:w_warehouse_sq_ft, $83:w_city, $84:w_county, $85:w_state, $86:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "TO __stage03_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.02027027027027027, "waitRatioMax": 0.02027027027027027, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04054054054054054, "writeRatioMax": 0.04054054054054054 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02702702702702703, "computeRatioMax": 0.02702702702702703, "endMs": "1665778354663", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015765765765765764, "readRatioMax": 0.015765765765765764, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778354620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:sm_ship_mode_sk, $2:sm_carrier", "FROM ship_mode", "WHERE in($2, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.038288288288288286, "writeRatioMax": 0.038288288288288286 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.06306306306306306, "computeRatioMax": 0.06306306306306306, "endMs": "1665778354666", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015765765765765764, "readRatioMax": 0.015765765765765764, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778354635", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:t_time_sk, $21:t_time", "FROM time_dim", "WHERE between($21, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02027027027027027, "writeRatioMax": 0.02027027027027027 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.018018018018018018, "computeRatioMax": 0.018018018018018018, "endMs": "1665778354679", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013513513513513514, "readRatioMax": 0.013513513513513514, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778354651", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE equal($61, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03153153153153153, "writeRatioMax": 0.03153153153153153 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02927927927927928, "computeRatioMax": 0.02927927927927928, "endMs": "1665778354695", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02252252252252252, "readRatioMax": 0.02252252252252252, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778354666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:w_warehouse_sk, $51:w_warehouse_name, $52:w_warehouse_sq_ft, $53:w_city, $54:w_county, $55:w_state, $56:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.015765765765765764, "writeRatioMax": 0.015765765765765764 }, { "completedParallelInputs": "5", "computeMsAvg": "252", "computeMsMax": "293", "computeRatioAvg": 0.5675675675675675, "computeRatioMax": 0.6599099099099099, "endMs": "1665778354893", "id": "10", "inputStages": [ "1", "3", "0", "2" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "25", "readMsMax": "29", "readRatioAvg": 0.05630630630630631, "readRatioMax": 0.06531531531531531, "recordsRead": "1587413", "recordsWritten": "25", "shuffleOutputBytes": "12565", "shuffleOutputBytesSpilled": "0", "slotMs": "1435", "startMs": "1665778354686", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_sold_time_sk, $72:cs_ship_mode_sk, $73:cs_warehouse_sk, $74:cs_quantity, $75:cs_ext_list_price, $76:cs_net_paid", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $603, $621 := $604, $622 := $605, $623 := $606, $624 := $607, $625 := $608, $626 := $609", "$350 := SUM($433)", "$351 := SUM($432)", "$352 := SUM($431)", "$353 := SUM($430)", "$354 := SUM($429)", "$355 := SUM($428)", "$356 := SUM($427)", "$357 := SUM($426)", "$358 := SUM($425)", "$359 := SUM($424)", "$360 := SUM($423)", "$361 := SUM($422)", "$362 := SUM($421)", "$363 := SUM($420)", "$364 := SUM($419)", "$365 := SUM($418)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := case_no_value(equal($610, 12), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$411 := case_no_value(equal($610, 11), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$412 := case_no_value(equal($610, 10), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$413 := case_no_value(equal($610, 9), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$414 := case_no_value(equal($610, 8), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$415 := case_no_value(equal($610, 7), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$416 := case_no_value(equal($610, 6), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$417 := case_no_value(equal($610, 5), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$418 := case_no_value(equal($610, 4), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$419 := case_no_value(equal($610, 3), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$420 := case_no_value(equal($610, 2), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$421 := case_no_value(equal($610, 1), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$422 := case_no_value(equal($610, 12), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$423 := case_no_value(equal($610, 11), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$424 := case_no_value(equal($610, 10), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$425 := case_no_value(equal($610, 9), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $589, $609 := $590, $610 := $591", "INNER HASH JOIN EACH WITH ALL ON $580 = $10" ] }, { "kind": "JOIN", "substeps": [ "$580 := $561, $581 := $562, $582 := $563, $583 := $564, $584 := $565, $585 := $566, $586 := $567, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $572", "INNER HASH JOIN EACH WITH ALL ON $560 = $30" ] }, { "kind": "JOIN", "substeps": [ "$560 := $541, $561 := $542, $562 := $543, $563 := $544, $564 := $545, $565 := $546, $566 := $547, $567 := $548, $568 := $549, $569 := $550, $570 := $551, $571 := $91, $572 := $92", "INNER HASH JOIN EACH WITH ALL ON $540 = $90" ] }, { "kind": "JOIN", "substeps": [ "$540 := $70, $541 := $71, $542 := $72, $543 := $74, $544 := $75, $545 := $76, $546 := $81, $547 := $82, $548 := $83, $549 := $84, $550 := $85, $551 := $86", "INNER HASH JOIN EACH WITH ALL ON $73 = $80" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "TO __stage0A_output", "BY HASH($620, $621, $622, $623, $624, $625, $626)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.01126126126126126, "writeRatioMax": 0.015765765765765764 }, { "completedParallelInputs": "1", "computeMsAvg": "444", "computeMsMax": "444", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778355008", "id": "11", "inputStages": [ "7", "8", "6", "5" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "32", "readMsMax": "32", "readRatioAvg": 0.07207207207207207, "readRatioMax": 0.07207207207207207, "recordsRead": "748557", "recordsWritten": "5", "shuffleOutputBytes": "2513", "shuffleOutputBytesSpilled": "0", "slotMs": "473", "startMs": "1665778354701", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_sold_time_sk, $42:ws_ship_mode_sk, $43:ws_warehouse_sk, $44:ws_quantity, $45:ws_ext_sales_price, $46:ws_net_paid_inc_ship", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $503, $521 := $504, $522 := $505, $523 := $506, $524 := $507, $525 := $508, $526 := $509", "$320 := SUM($403)", "$321 := SUM($402)", "$322 := SUM($401)", "$323 := SUM($400)", "$324 := SUM($399)", "$325 := SUM($398)", "$326 := SUM($397)", "$327 := SUM($396)", "$328 := SUM($395)", "$329 := SUM($394)", "$330 := SUM($393)", "$331 := SUM($392)", "$332 := SUM($391)", "$333 := SUM($390)", "$334 := SUM($389)", "$335 := SUM($388)" ] }, { "kind": "COMPUTE", "substeps": [ "$380 := case_no_value(equal($510, 12), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$381 := case_no_value(equal($510, 11), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$382 := case_no_value(equal($510, 10), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$383 := case_no_value(equal($510, 9), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$384 := case_no_value(equal($510, 8), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$385 := case_no_value(equal($510, 7), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$386 := case_no_value(equal($510, 6), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$387 := case_no_value(equal($510, 5), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$388 := case_no_value(equal($510, 4), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$389 := case_no_value(equal($510, 3), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$390 := case_no_value(equal($510, 2), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$391 := case_no_value(equal($510, 1), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$392 := case_no_value(equal($510, 12), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$393 := case_no_value(equal($510, 11), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$394 := case_no_value(equal($510, 10), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$395 := case_no_value(equal($510, 9), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $481, $501 := $482, $502 := $483, $503 := $484, $504 := $485, $505 := $486, $506 := $487, $507 := $488, $508 := $489, $509 := $490, $510 := $491", "INNER HASH JOIN EACH WITH ALL ON $480 = $1" ] }, { "kind": "JOIN", "substeps": [ "$480 := $461, $481 := $462, $482 := $463, $483 := $464, $484 := $465, $485 := $466, $486 := $467, $487 := $468, $488 := $469, $489 := $470, $490 := $471, $491 := $472", "INNER HASH JOIN EACH WITH ALL ON $460 = $20" ] }, { "kind": "JOIN", "substeps": [ "$460 := $441, $461 := $442, $462 := $443, $463 := $444, $464 := $445, $465 := $446, $466 := $447, $467 := $448, $468 := $449, $469 := $450, $470 := $451, $471 := $61, $472 := $62", "INNER HASH JOIN EACH WITH ALL ON $440 = $60" ] }, { "kind": "JOIN", "substeps": [ "$440 := $40, $441 := $41, $442 := $42, $443 := $44, $444 := $45, $445 := $46, $446 := $51, $447 := $52, $448 := $53, $449 := $54, $450 := $55, $451 := $56", "INNER HASH JOIN EACH WITH ALL ON $43 = $50" ] }, { "kind": "WRITE", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "TO __stage0B_output", "BY HASH($520, $521, $522, $523, $524, $525, $526)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01126126126126126, "writeRatioMax": 0.01126126126126126 }, { "completedParallelInputs": "2", "computeMsAvg": "15", "computeMsMax": "17", "computeRatioAvg": 0.033783783783783786, "computeRatioMax": 0.038288288288288286, "endMs": "1665778355158", "id": "12", "inputStages": [ "11", "10" ], "name": "S0C: Aggregate+", "parallelInputs": "2", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "10", "shuffleOutputBytes": "6922", "shuffleOutputBytesSpilled": "0", "slotMs": "103", "startMs": "1665778355119", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $200, $641 := $201, $642 := $202, $643 := $203, $644 := $204, $645 := $205, $646 := $206, $647 := $207", "$140 := SUM($208)", "$141 := SUM($209)", "$142 := SUM($210)", "$143 := SUM($211)", "$144 := SUM($212)", "$145 := SUM($213)", "$146 := SUM($214)", "$147 := SUM($215)", "$148 := SUM($216)", "$149 := SUM($217)", "$150 := SUM($218)", "$151 := SUM($219)", "$152 := SUM($180)", "$153 := SUM($181)", "$154 := SUM($182)", "$155 := SUM($183)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($208, CAST($201 AS NUMERIC))", "$181 := divide($209, CAST($201 AS NUMERIC))", "$182 := divide($210, CAST($201 AS NUMERIC))", "$183 := divide($211, CAST($201 AS NUMERIC))", "$184 := divide($212, CAST($201 AS NUMERIC))", "$185 := divide($213, CAST($201 AS NUMERIC))", "$186 := divide($214, CAST($201 AS NUMERIC))", "$187 := divide($215, CAST($201 AS NUMERIC))", "$188 := divide($216, CAST($201 AS NUMERIC))", "$189 := divide($217, CAST($201 AS NUMERIC))", "$190 := divide($218, CAST($201 AS NUMERIC))", "$191 := divide($219, CAST($201 AS NUMERIC))" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $520, $531 := $521, $532 := $522, $533 := $523, $534 := $524, $535 := $525, $536 := $526", "$260 := SUM($320)", "$261 := SUM($321)", "$262 := SUM($322)", "$263 := SUM($323)", "$264 := SUM($324)", "$265 := SUM($325)", "$266 := SUM($326)", "$267 := SUM($327)", "$268 := SUM($328)", "$269 := SUM($329)", "$270 := SUM($330)", "$271 := SUM($331)", "$272 := SUM($332)", "$273 := SUM($333)", "$274 := SUM($334)", "$275 := SUM($335)" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622, $633 := $623, $634 := $624, $635 := $625, $636 := $626", "$290 := SUM($350)", "$291 := SUM($351)", "$292 := SUM($352)", "$293 := SUM($353)", "$294 := SUM($354)", "$295 := SUM($355)", "$296 := SUM($356)", "$297 := SUM($357)", "$298 := SUM($358)", "$299 := SUM($359)", "$300 := SUM($360)", "$301 := SUM($361)", "$302 := SUM($362)", "$303 := SUM($363)", "$304 := SUM($364)", "$305 := SUM($365)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "TO __stage0C_output", "BY HASH($640, $641, $642, $643, $644, $645, $646, $647)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "13", "writeMsMax": "14", "writeRatioAvg": 0.02927927927927928, "writeRatioMax": 0.03153153153153153 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.024774774774774775, "computeRatioMax": 0.024774774774774775, "endMs": "1665778355200", "id": "13", "inputStages": [ "12" ], "name": "S0D: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778355165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$650 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $650 := $640, $651 := $641, $652 := $642, $653 := $643, $654 := $644, $655 := $645, $656 := $646, $657 := $647", "$100 := SUM($140)", "$101 := SUM($141)", "$102 := SUM($142)", "$103 := SUM($143)", "$104 := SUM($144)", "$105 := SUM($145)", "$106 := SUM($146)", "$107 := SUM($147)", "$108 := SUM($148)", "$109 := SUM($149)", "$110 := SUM($150)", "$111 := SUM($151)", "$112 := SUM($152)", "$113 := SUM($153)", "$114 := SUM($154)", "$115 := SUM($155)" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02927927927927928, "writeRatioMax": 0.02927927927927928 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02702702702702703, "computeRatioMax": 0.02702702702702703, "endMs": "1665778355225", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778355183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$696 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719, $720, $721, $722, $723, $724, $725", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022522522522522522, "waitRatioMax": 0.0022522522522522522, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.018018018018018018, "writeRatioMax": 0.018018018018018018 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "14", "elapsedMs": "653", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2230" }, { "activeUnits": "0", "completedUnits": "18", "elapsedMs": "874", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2432" } ], "totalBytesBilled": "158334976", "totalBytesProcessed": "158201227", "totalPartitionsProcessed": "0", "totalSlotMs": "2432", "transferredBytes": "0" }, "startTime": "1665778354395", "totalBytesProcessed": "158201227", "totalSlotMs": "2432" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon16b744a5_48ee_414b_b3a9_c7bf8dacbbfe" }, "priority": "INTERACTIVE", "query": "-- start query 66 in stream 0 using template query66.tpl\nselect \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,ship_carriers\n ,year\n \t,sum(jan_sales) as jan_sales\n \t,sum(feb_sales) as feb_sales\n \t,sum(mar_sales) as mar_sales\n \t,sum(apr_sales) as apr_sales\n \t,sum(may_sales) as may_sales\n \t,sum(jun_sales) as jun_sales\n \t,sum(jul_sales) as jul_sales\n \t,sum(aug_sales) as aug_sales\n \t,sum(sep_sales) as sep_sales\n \t,sum(oct_sales) as oct_sales\n \t,sum(nov_sales) as nov_sales\n \t,sum(dec_sales) as dec_sales\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\n \t,sum(jan_net) as jan_net\n \t,sum(feb_net) as feb_net\n \t,sum(mar_net) as mar_net\n \t,sum(apr_net) as apr_net\n \t,sum(may_net) as may_net\n \t,sum(jun_net) as jun_net\n \t,sum(jul_net) as jul_net\n \t,sum(aug_net) as aug_net\n \t,sum(sep_net) as sep_net\n \t,sum(oct_net) as oct_net\n \t,sum(nov_net) as nov_net\n \t,sum(dec_net) as dec_net\n from (\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as dec_net\n from\n web_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n ws_warehouse_sk = w_warehouse_sk\n and ws_sold_date_sk = d_date_sk\n and ws_sold_time_sk = t_time_sk\n \tand ws_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 and 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n union all\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as dec_net\n from\n catalog_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n cs_warehouse_sk = w_warehouse_sk\n and cs_sold_date_sk = d_date_sk\n and cs_sold_time_sk = t_time_sk\n \tand cs_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 AND 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n ) x\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,ship_carriers\n ,year\n order by w_warehouse_name\n limit 100\n ;\n\n-- end query 66 in stream 0 using template query66.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "R8Wz3Jkf+IDHONkwnzXQEA==", "id": "test-project-364309:europe-west1.query66_1665778356", "jobReference": { "jobId": "query66_1665778356", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query66_1665778356?location=europe-west1", "statistics": { "creationTime": "1665778356972", "endTime": "1665778358022", "finalExecutionDurationMs": "768", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "158201227", "performanceInsights": { "avgPreviousExecutionMs": "723" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015717092337917484, "computeRatioMax": 0.015717092337917484, "endMs": "1665778357210", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007858546168958742, "readRatioMax": 0.007858546168958742, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778357184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sm_ship_mode_sk, $11:sm_carrier", "FROM ship_mode", "WHERE in($11, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.029469548133595286, "writeRatioMax": 0.029469548133595286 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0412573673870334, "computeRatioMax": 0.0412573673870334, "endMs": "1665778357239", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007858546168958742, "readRatioMax": 0.007858546168958742, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778357197", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:t_time_sk, $31:t_time", "FROM time_dim", "WHERE between($31, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.025540275049115914, "writeRatioMax": 0.025540275049115914 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01768172888015717, "computeRatioMax": 0.01768172888015717, "endMs": "1665778357245", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0137524557956778, "readRatioMax": 0.0137524557956778, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778357211", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year, $92:d_moy", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage02_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.011787819253438114, "writeRatioMax": 0.011787819253438114 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.011787819253438114, "computeRatioMax": 0.011787819253438114, "endMs": "1665778357253", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007858546168958742, "readRatioMax": 0.007858546168958742, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778357226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name, $82:w_warehouse_sq_ft, $83:w_city, $84:w_county, $85:w_state, $86:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005893909626719057, "waitRatioMax": 0.005893909626719057, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03536345776031434, "writeRatioMax": 0.03536345776031434 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01768172888015717, "computeRatioMax": 0.01768172888015717, "endMs": "1665778357274", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.005893909626719057, "readRatioMax": 0.005893909626719057, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665778357251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:sm_ship_mode_sk, $2:sm_carrier", "FROM ship_mode", "WHERE in($2, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0275049115913556, "writeRatioMax": 0.0275049115913556 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.03732809430255403, "computeRatioMax": 0.03732809430255403, "endMs": "1665778357289", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009823182711198428, "readRatioMax": 0.009823182711198428, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778357262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:t_time_sk, $21:t_time", "FROM time_dim", "WHERE between($21, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.019646365422396856, "writeRatioMax": 0.019646365422396856 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0137524557956778, "computeRatioMax": 0.0137524557956778, "endMs": "1665778357319", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.015717092337917484, "readRatioMax": 0.015717092337917484, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778357273", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE equal($61, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.03929273084479371, "writeRatioMax": 0.03929273084479371 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0137524557956778, "computeRatioMax": 0.0137524557956778, "endMs": "1665778357314", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007858546168958742, "readRatioMax": 0.007858546168958742, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778357286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:w_warehouse_sk, $51:w_warehouse_name, $52:w_warehouse_sq_ft, $53:w_city, $54:w_county, $55:w_state, $56:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03536345776031434, "writeRatioMax": 0.03536345776031434 }, { "completedParallelInputs": "5", "computeMsAvg": "266", "computeMsMax": "349", "computeRatioAvg": 0.5225933202357563, "computeRatioMax": 0.6856581532416502, "endMs": "1665778357514", "id": "10", "inputStages": [ "0", "3", "2", "1" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "19", "readMsMax": "20", "readRatioAvg": 0.03732809430255403, "readRatioMax": 0.03929273084479371, "recordsRead": "1587413", "recordsWritten": "25", "shuffleOutputBytes": "12565", "shuffleOutputBytesSpilled": "0", "slotMs": "1354", "startMs": "1665778357304", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_sold_time_sk, $72:cs_ship_mode_sk, $73:cs_warehouse_sk, $74:cs_quantity, $75:cs_ext_list_price, $76:cs_net_paid", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $603, $621 := $604, $622 := $605, $623 := $606, $624 := $607, $625 := $608, $626 := $609", "$350 := SUM($433)", "$351 := SUM($432)", "$352 := SUM($431)", "$353 := SUM($430)", "$354 := SUM($429)", "$355 := SUM($428)", "$356 := SUM($427)", "$357 := SUM($426)", "$358 := SUM($425)", "$359 := SUM($424)", "$360 := SUM($423)", "$361 := SUM($422)", "$362 := SUM($421)", "$363 := SUM($420)", "$364 := SUM($419)", "$365 := SUM($418)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := case_no_value(equal($610, 12), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$411 := case_no_value(equal($610, 11), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$412 := case_no_value(equal($610, 10), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$413 := case_no_value(equal($610, 9), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$414 := case_no_value(equal($610, 8), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$415 := case_no_value(equal($610, 7), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$416 := case_no_value(equal($610, 6), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$417 := case_no_value(equal($610, 5), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$418 := case_no_value(equal($610, 4), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$419 := case_no_value(equal($610, 3), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$420 := case_no_value(equal($610, 2), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$421 := case_no_value(equal($610, 1), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$422 := case_no_value(equal($610, 12), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$423 := case_no_value(equal($610, 11), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$424 := case_no_value(equal($610, 10), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$425 := case_no_value(equal($610, 9), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $589, $609 := $590, $610 := $591", "INNER HASH JOIN EACH WITH ALL ON $580 = $10" ] }, { "kind": "JOIN", "substeps": [ "$580 := $561, $581 := $562, $582 := $563, $583 := $564, $584 := $565, $585 := $566, $586 := $567, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $572", "INNER HASH JOIN EACH WITH ALL ON $560 = $30" ] }, { "kind": "JOIN", "substeps": [ "$560 := $541, $561 := $542, $562 := $543, $563 := $544, $564 := $545, $565 := $546, $566 := $547, $567 := $548, $568 := $549, $569 := $550, $570 := $551, $571 := $91, $572 := $92", "INNER HASH JOIN EACH WITH ALL ON $540 = $90" ] }, { "kind": "JOIN", "substeps": [ "$540 := $70, $541 := $71, $542 := $72, $543 := $74, $544 := $75, $545 := $76, $546 := $81, $547 := $82, $548 := $83, $549 := $84, $550 := $85, $551 := $86", "INNER HASH JOIN EACH WITH ALL ON $73 = $80" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "TO __stage0A_output", "BY HASH($620, $621, $622, $623, $624, $625, $626)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007858546168958742, "writeRatioMax": 0.007858546168958742 }, { "completedParallelInputs": "1", "computeMsAvg": "509", "computeMsMax": "509", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778357742", "id": "12", "inputStages": [ "7", "8", "5", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.07072691552062868, "readRatioMax": 0.07072691552062868, "recordsRead": "748557", "recordsWritten": "5", "shuffleOutputBytes": "2513", "shuffleOutputBytesSpilled": "0", "slotMs": "648", "startMs": "1665778357333", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_sold_time_sk, $42:ws_ship_mode_sk, $43:ws_warehouse_sk, $44:ws_quantity, $45:ws_ext_sales_price, $46:ws_net_paid_inc_ship", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $503, $521 := $504, $522 := $505, $523 := $506, $524 := $507, $525 := $508, $526 := $509", "$320 := SUM($403)", "$321 := SUM($402)", "$322 := SUM($401)", "$323 := SUM($400)", "$324 := SUM($399)", "$325 := SUM($398)", "$326 := SUM($397)", "$327 := SUM($396)", "$328 := SUM($395)", "$329 := SUM($394)", "$330 := SUM($393)", "$331 := SUM($392)", "$332 := SUM($391)", "$333 := SUM($390)", "$334 := SUM($389)", "$335 := SUM($388)" ] }, { "kind": "COMPUTE", "substeps": [ "$380 := case_no_value(equal($510, 12), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$381 := case_no_value(equal($510, 11), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$382 := case_no_value(equal($510, 10), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$383 := case_no_value(equal($510, 9), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$384 := case_no_value(equal($510, 8), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$385 := case_no_value(equal($510, 7), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$386 := case_no_value(equal($510, 6), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$387 := case_no_value(equal($510, 5), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$388 := case_no_value(equal($510, 4), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$389 := case_no_value(equal($510, 3), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$390 := case_no_value(equal($510, 2), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$391 := case_no_value(equal($510, 1), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$392 := case_no_value(equal($510, 12), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$393 := case_no_value(equal($510, 11), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$394 := case_no_value(equal($510, 10), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$395 := case_no_value(equal($510, 9), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $481, $501 := $482, $502 := $483, $503 := $484, $504 := $485, $505 := $486, $506 := $487, $507 := $488, $508 := $489, $509 := $490, $510 := $491", "INNER HASH JOIN EACH WITH ALL ON $480 = $1" ] }, { "kind": "JOIN", "substeps": [ "$480 := $461, $481 := $462, $482 := $463, $483 := $464, $484 := $465, $485 := $466, $486 := $467, $487 := $468, $488 := $469, $489 := $470, $490 := $471, $491 := $472", "INNER HASH JOIN EACH WITH ALL ON $460 = $20" ] }, { "kind": "JOIN", "substeps": [ "$460 := $441, $461 := $442, $462 := $443, $463 := $444, $464 := $445, $465 := $446, $466 := $447, $467 := $448, $468 := $449, $469 := $450, $470 := $451, $471 := $61, $472 := $62", "INNER HASH JOIN EACH WITH ALL ON $440 = $60" ] }, { "kind": "JOIN", "substeps": [ "$440 := $40, $441 := $41, $442 := $42, $443 := $44, $444 := $45, $445 := $46, $446 := $51, $447 := $52, $448 := $53, $449 := $54, $450 := $55, $451 := $56", "INNER HASH JOIN EACH WITH ALL ON $43 = $50" ] }, { "kind": "WRITE", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "TO __stage0C_output", "BY HASH($520, $521, $522, $523, $524, $525, $526)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.011787819253438114, "writeRatioMax": 0.011787819253438114 }, { "completedParallelInputs": "2", "computeMsAvg": "15", "computeMsMax": "17", "computeRatioAvg": 0.029469548133595286, "computeRatioMax": 0.03339882121807466, "endMs": "1665778357874", "id": "13", "inputStages": [ "10", "12" ], "name": "S0D: Aggregate+", "parallelInputs": "2", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "10", "shuffleOutputBytes": "6922", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665778357838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $200, $641 := $201, $642 := $202, $643 := $203, $644 := $204, $645 := $205, $646 := $206, $647 := $207", "$140 := SUM($208)", "$141 := SUM($209)", "$142 := SUM($210)", "$143 := SUM($211)", "$144 := SUM($212)", "$145 := SUM($213)", "$146 := SUM($214)", "$147 := SUM($215)", "$148 := SUM($216)", "$149 := SUM($217)", "$150 := SUM($218)", "$151 := SUM($219)", "$152 := SUM($180)", "$153 := SUM($181)", "$154 := SUM($182)", "$155 := SUM($183)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($208, CAST($201 AS NUMERIC))", "$181 := divide($209, CAST($201 AS NUMERIC))", "$182 := divide($210, CAST($201 AS NUMERIC))", "$183 := divide($211, CAST($201 AS NUMERIC))", "$184 := divide($212, CAST($201 AS NUMERIC))", "$185 := divide($213, CAST($201 AS NUMERIC))", "$186 := divide($214, CAST($201 AS NUMERIC))", "$187 := divide($215, CAST($201 AS NUMERIC))", "$188 := divide($216, CAST($201 AS NUMERIC))", "$189 := divide($217, CAST($201 AS NUMERIC))", "$190 := divide($218, CAST($201 AS NUMERIC))", "$191 := divide($219, CAST($201 AS NUMERIC))" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $520, $531 := $521, $532 := $522, $533 := $523, $534 := $524, $535 := $525, $536 := $526", "$260 := SUM($320)", "$261 := SUM($321)", "$262 := SUM($322)", "$263 := SUM($323)", "$264 := SUM($324)", "$265 := SUM($325)", "$266 := SUM($326)", "$267 := SUM($327)", "$268 := SUM($328)", "$269 := SUM($329)", "$270 := SUM($330)", "$271 := SUM($331)", "$272 := SUM($332)", "$273 := SUM($333)", "$274 := SUM($334)", "$275 := SUM($335)" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622, $633 := $623, $634 := $624, $635 := $625, $636 := $626", "$290 := SUM($350)", "$291 := SUM($351)", "$292 := SUM($352)", "$293 := SUM($353)", "$294 := SUM($354)", "$295 := SUM($355)", "$296 := SUM($356)", "$297 := SUM($357)", "$298 := SUM($358)", "$299 := SUM($359)", "$300 := SUM($360)", "$301 := SUM($361)", "$302 := SUM($362)", "$303 := SUM($363)", "$304 := SUM($364)", "$305 := SUM($365)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "TO __stage0D_output", "BY HASH($640, $641, $642, $643, $644, $645, $646, $647)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "12", "writeMsMax": "14", "writeRatioAvg": 0.023575638506876228, "writeRatioMax": 0.0275049115913556 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.011787819253438114, "computeRatioMax": 0.011787819253438114, "endMs": "1665778357918", "id": "14", "inputStages": [ "13" ], "name": "S0E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778357883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$650 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $650 := $640, $651 := $641, $652 := $642, $653 := $643, $654 := $644, $655 := $645, $656 := $646, $657 := $647", "$100 := SUM($140)", "$101 := SUM($141)", "$102 := SUM($142)", "$103 := SUM($143)", "$104 := SUM($144)", "$105 := SUM($145)", "$106 := SUM($146)", "$107 := SUM($147)", "$108 := SUM($148)", "$109 := SUM($149)", "$110 := SUM($150)", "$111 := SUM($151)", "$112 := SUM($152)", "$113 := SUM($153)", "$114 := SUM($154)", "$115 := SUM($155)" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.05108055009823183, "writeRatioMax": 0.05108055009823183 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015717092337917484, "computeRatioMax": 0.015717092337917484, "endMs": "1665778357924", "id": "15", "inputStages": [ "14" ], "name": "S0F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778357894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$696 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719, $720, $721, $722, $723, $724, $725", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019646365422396855, "waitRatioMax": 0.0019646365422396855, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.011787819253438114, "writeRatioMax": 0.011787819253438114 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "13", "elapsedMs": "651", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1817" }, { "activeUnits": "1", "completedUnits": "18", "elapsedMs": "927", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2506" } ], "totalBytesBilled": "158334976", "totalBytesProcessed": "158201227", "totalPartitionsProcessed": "0", "totalSlotMs": "2506", "transferredBytes": "0" }, "startTime": "1665778357035", "totalBytesProcessed": "158201227", "totalSlotMs": "2506" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5dcb1518_a752_4add_87ab_6fc90dcecbe8" }, "priority": "INTERACTIVE", "query": "-- start query 66 in stream 0 using template query66.tpl\nselect \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,ship_carriers\n ,year\n \t,sum(jan_sales) as jan_sales\n \t,sum(feb_sales) as feb_sales\n \t,sum(mar_sales) as mar_sales\n \t,sum(apr_sales) as apr_sales\n \t,sum(may_sales) as may_sales\n \t,sum(jun_sales) as jun_sales\n \t,sum(jul_sales) as jul_sales\n \t,sum(aug_sales) as aug_sales\n \t,sum(sep_sales) as sep_sales\n \t,sum(oct_sales) as oct_sales\n \t,sum(nov_sales) as nov_sales\n \t,sum(dec_sales) as dec_sales\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\n \t,sum(jan_net) as jan_net\n \t,sum(feb_net) as feb_net\n \t,sum(mar_net) as mar_net\n \t,sum(apr_net) as apr_net\n \t,sum(may_net) as may_net\n \t,sum(jun_net) as jun_net\n \t,sum(jul_net) as jul_net\n \t,sum(aug_net) as aug_net\n \t,sum(sep_net) as sep_net\n \t,sum(oct_net) as oct_net\n \t,sum(nov_net) as nov_net\n \t,sum(dec_net) as dec_net\n from (\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as dec_net\n from\n web_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n ws_warehouse_sk = w_warehouse_sk\n and ws_sold_date_sk = d_date_sk\n and ws_sold_time_sk = t_time_sk\n \tand ws_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 and 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n union all\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as dec_net\n from\n catalog_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n cs_warehouse_sk = w_warehouse_sk\n and cs_sold_date_sk = d_date_sk\n and cs_sold_time_sk = t_time_sk\n \tand cs_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 AND 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n ) x\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,ship_carriers\n ,year\n order by w_warehouse_name\n limit 100\n ;\n\n-- end query 66 in stream 0 using template query66.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "QXiD5t7jXA2VVRRq0txwuA==", "id": "test-project-364309:europe-west1.query66_1665778359", "jobReference": { "jobId": "query66_1665778359", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query66_1665778359?location=europe-west1", "statistics": { "creationTime": "1665778359740", "endTime": "1665778360848", "finalExecutionDurationMs": "759", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "158201227", "performanceInsights": { "avgPreviousExecutionMs": "728" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0175054704595186, "computeRatioMax": 0.0175054704595186, "endMs": "1665778360038", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010940919037199124, "readRatioMax": 0.010940919037199124, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778359998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sm_ship_mode_sk, $11:sm_carrier", "FROM ship_mode", "WHERE in($11, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.037199124726477024, "writeRatioMax": 0.037199124726477024 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.037199124726477024, "computeRatioMax": 0.037199124726477024, "endMs": "1665778360049", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01312910284463895, "readRatioMax": 0.01312910284463895, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778360018", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:t_time_sk, $31:t_time", "FROM time_dim", "WHERE between($31, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0262582056892779, "writeRatioMax": 0.0262582056892779 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.030634573304157548, "computeRatioMax": 0.030634573304157548, "endMs": "1665778360075", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015317286652078774, "readRatioMax": 0.015317286652078774, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778360030", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year, $92:d_moy", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0350109409190372, "writeRatioMax": 0.0350109409190372 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.010940919037199124, "computeRatioMax": 0.010940919037199124, "endMs": "1665778360090", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.006564551422319475, "readRatioMax": 0.006564551422319475, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778360050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name, $82:w_warehouse_sq_ft, $83:w_city, $84:w_county, $85:w_state, $86:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "TO __stage03_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.01312910284463895, "waitRatioMax": 0.01312910284463895, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.06783369803063458, "writeRatioMax": 0.06783369803063458 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.01312910284463895, "computeRatioMax": 0.01312910284463895, "endMs": "1665778360126", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0087527352297593, "readRatioMax": 0.0087527352297593, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778360090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:sm_ship_mode_sk, $2:sm_carrier", "FROM ship_mode", "WHERE in($2, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage05_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.024070021881838075, "waitRatioMax": 0.024070021881838075, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.05689277899343545, "writeRatioMax": 0.05689277899343545 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04157549234135667, "computeRatioMax": 0.04157549234135667, "endMs": "1665778360137", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01312910284463895, "readRatioMax": 0.01312910284463895, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778360096", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:t_time_sk, $21:t_time", "FROM time_dim", "WHERE between($21, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0262582056892779, "writeRatioMax": 0.0262582056892779 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0262582056892779, "computeRatioMax": 0.0262582056892779, "endMs": "1665778360150", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015317286652078774, "readRatioMax": 0.015317286652078774, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778360111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE equal($61, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0262582056892779, "writeRatioMax": 0.0262582056892779 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02188183807439825, "computeRatioMax": 0.02188183807439825, "endMs": "1665778360169", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010940919037199124, "readRatioMax": 0.010940919037199124, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778360128", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:w_warehouse_sk, $51:w_warehouse_name, $52:w_warehouse_sq_ft, $53:w_city, $54:w_county, $55:w_state, $56:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.061269146608315096, "writeRatioMax": 0.061269146608315096 }, { "completedParallelInputs": "5", "computeMsAvg": "293", "computeMsMax": "386", "computeRatioAvg": 0.6411378555798687, "computeRatioMax": 0.8446389496717724, "endMs": "1665778360392", "id": "10", "inputStages": [ "2", "3", "0", "1" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "40", "readRatioAvg": 0.05689277899343545, "readRatioMax": 0.087527352297593, "recordsRead": "1587413", "recordsWritten": "25", "shuffleOutputBytes": "12565", "shuffleOutputBytesSpilled": "0", "slotMs": "1535", "startMs": "1665778360152", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_sold_time_sk, $72:cs_ship_mode_sk, $73:cs_warehouse_sk, $74:cs_quantity, $75:cs_ext_list_price, $76:cs_net_paid", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $603, $621 := $604, $622 := $605, $623 := $606, $624 := $607, $625 := $608, $626 := $609", "$350 := SUM($433)", "$351 := SUM($432)", "$352 := SUM($431)", "$353 := SUM($430)", "$354 := SUM($429)", "$355 := SUM($428)", "$356 := SUM($427)", "$357 := SUM($426)", "$358 := SUM($425)", "$359 := SUM($424)", "$360 := SUM($423)", "$361 := SUM($422)", "$362 := SUM($421)", "$363 := SUM($420)", "$364 := SUM($419)", "$365 := SUM($418)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := case_no_value(equal($610, 12), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$411 := case_no_value(equal($610, 11), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$412 := case_no_value(equal($610, 10), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$413 := case_no_value(equal($610, 9), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$414 := case_no_value(equal($610, 8), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$415 := case_no_value(equal($610, 7), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$416 := case_no_value(equal($610, 6), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$417 := case_no_value(equal($610, 5), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$418 := case_no_value(equal($610, 4), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$419 := case_no_value(equal($610, 3), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$420 := case_no_value(equal($610, 2), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$421 := case_no_value(equal($610, 1), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$422 := case_no_value(equal($610, 12), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$423 := case_no_value(equal($610, 11), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$424 := case_no_value(equal($610, 10), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$425 := case_no_value(equal($610, 9), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $589, $609 := $590, $610 := $591", "INNER HASH JOIN EACH WITH ALL ON $580 = $10" ] }, { "kind": "JOIN", "substeps": [ "$580 := $561, $581 := $562, $582 := $563, $583 := $564, $584 := $565, $585 := $566, $586 := $567, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $572", "INNER HASH JOIN EACH WITH ALL ON $560 = $30" ] }, { "kind": "JOIN", "substeps": [ "$560 := $541, $561 := $542, $562 := $543, $563 := $544, $564 := $545, $565 := $546, $566 := $547, $567 := $548, $568 := $549, $569 := $550, $570 := $551, $571 := $91, $572 := $92", "INNER HASH JOIN EACH WITH ALL ON $540 = $90" ] }, { "kind": "JOIN", "substeps": [ "$540 := $70, $541 := $71, $542 := $72, $543 := $74, $544 := $75, $545 := $76, $546 := $81, $547 := $82, $548 := $83, $549 := $84, $550 := $85, $551 := $86", "INNER HASH JOIN EACH WITH ALL ON $73 = $80" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "TO __stage0A_output", "BY HASH($620, $621, $622, $623, $624, $625, $626)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.006564551422319475, "writeMsAvg": "6", "writeMsMax": "13", "writeRatioAvg": 0.01312910284463895, "writeRatioMax": 0.028446389496717725 }, { "completedParallelInputs": "1", "computeMsAvg": "457", "computeMsMax": "457", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778360492", "id": "11", "inputStages": [ "7", "8", "6", "5" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "30", "readMsMax": "30", "readRatioAvg": 0.06564551422319474, "readRatioMax": 0.06564551422319474, "recordsRead": "748557", "recordsWritten": "5", "shuffleOutputBytes": "2513", "shuffleOutputBytesSpilled": "0", "slotMs": "467", "startMs": "1665778360178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_sold_time_sk, $42:ws_ship_mode_sk, $43:ws_warehouse_sk, $44:ws_quantity, $45:ws_ext_sales_price, $46:ws_net_paid_inc_ship", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $503, $521 := $504, $522 := $505, $523 := $506, $524 := $507, $525 := $508, $526 := $509", "$320 := SUM($403)", "$321 := SUM($402)", "$322 := SUM($401)", "$323 := SUM($400)", "$324 := SUM($399)", "$325 := SUM($398)", "$326 := SUM($397)", "$327 := SUM($396)", "$328 := SUM($395)", "$329 := SUM($394)", "$330 := SUM($393)", "$331 := SUM($392)", "$332 := SUM($391)", "$333 := SUM($390)", "$334 := SUM($389)", "$335 := SUM($388)" ] }, { "kind": "COMPUTE", "substeps": [ "$380 := case_no_value(equal($510, 12), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$381 := case_no_value(equal($510, 11), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$382 := case_no_value(equal($510, 10), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$383 := case_no_value(equal($510, 9), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$384 := case_no_value(equal($510, 8), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$385 := case_no_value(equal($510, 7), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$386 := case_no_value(equal($510, 6), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$387 := case_no_value(equal($510, 5), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$388 := case_no_value(equal($510, 4), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$389 := case_no_value(equal($510, 3), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$390 := case_no_value(equal($510, 2), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$391 := case_no_value(equal($510, 1), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$392 := case_no_value(equal($510, 12), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$393 := case_no_value(equal($510, 11), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$394 := case_no_value(equal($510, 10), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$395 := case_no_value(equal($510, 9), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $481, $501 := $482, $502 := $483, $503 := $484, $504 := $485, $505 := $486, $506 := $487, $507 := $488, $508 := $489, $509 := $490, $510 := $491", "INNER HASH JOIN EACH WITH ALL ON $480 = $1" ] }, { "kind": "JOIN", "substeps": [ "$480 := $461, $481 := $462, $482 := $463, $483 := $464, $484 := $465, $485 := $466, $486 := $467, $487 := $468, $488 := $469, $489 := $470, $490 := $471, $491 := $472", "INNER HASH JOIN EACH WITH ALL ON $460 = $20" ] }, { "kind": "JOIN", "substeps": [ "$460 := $441, $461 := $442, $462 := $443, $463 := $444, $464 := $445, $465 := $446, $466 := $447, $467 := $448, $468 := $449, $469 := $450, $470 := $451, $471 := $61, $472 := $62", "INNER HASH JOIN EACH WITH ALL ON $440 = $60" ] }, { "kind": "JOIN", "substeps": [ "$440 := $40, $441 := $41, $442 := $42, $443 := $44, $444 := $45, $445 := $46, $446 := $51, $447 := $52, $448 := $53, $449 := $54, $450 := $55, $451 := $56", "INNER HASH JOIN EACH WITH ALL ON $43 = $50" ] }, { "kind": "WRITE", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "TO __stage0B_output", "BY HASH($520, $521, $522, $523, $524, $525, $526)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00437636761487965, "waitRatioMax": 0.00437636761487965, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.010940919037199124, "writeRatioMax": 0.010940919037199124 }, { "completedParallelInputs": "2", "computeMsAvg": "12", "computeMsMax": "13", "computeRatioAvg": 0.0262582056892779, "computeRatioMax": 0.028446389496717725, "endMs": "1665778360647", "id": "12", "inputStages": [ "10", "11" ], "name": "S0C: Aggregate+", "parallelInputs": "2", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "10", "shuffleOutputBytes": "6922", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665778360606", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $200, $641 := $201, $642 := $202, $643 := $203, $644 := $204, $645 := $205, $646 := $206, $647 := $207", "$140 := SUM($208)", "$141 := SUM($209)", "$142 := SUM($210)", "$143 := SUM($211)", "$144 := SUM($212)", "$145 := SUM($213)", "$146 := SUM($214)", "$147 := SUM($215)", "$148 := SUM($216)", "$149 := SUM($217)", "$150 := SUM($218)", "$151 := SUM($219)", "$152 := SUM($180)", "$153 := SUM($181)", "$154 := SUM($182)", "$155 := SUM($183)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($208, CAST($201 AS NUMERIC))", "$181 := divide($209, CAST($201 AS NUMERIC))", "$182 := divide($210, CAST($201 AS NUMERIC))", "$183 := divide($211, CAST($201 AS NUMERIC))", "$184 := divide($212, CAST($201 AS NUMERIC))", "$185 := divide($213, CAST($201 AS NUMERIC))", "$186 := divide($214, CAST($201 AS NUMERIC))", "$187 := divide($215, CAST($201 AS NUMERIC))", "$188 := divide($216, CAST($201 AS NUMERIC))", "$189 := divide($217, CAST($201 AS NUMERIC))", "$190 := divide($218, CAST($201 AS NUMERIC))", "$191 := divide($219, CAST($201 AS NUMERIC))" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $520, $531 := $521, $532 := $522, $533 := $523, $534 := $524, $535 := $525, $536 := $526", "$260 := SUM($320)", "$261 := SUM($321)", "$262 := SUM($322)", "$263 := SUM($323)", "$264 := SUM($324)", "$265 := SUM($325)", "$266 := SUM($326)", "$267 := SUM($327)", "$268 := SUM($328)", "$269 := SUM($329)", "$270 := SUM($330)", "$271 := SUM($331)", "$272 := SUM($332)", "$273 := SUM($333)", "$274 := SUM($334)", "$275 := SUM($335)" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622, $633 := $623, $634 := $624, $635 := $625, $636 := $626", "$290 := SUM($350)", "$291 := SUM($351)", "$292 := SUM($352)", "$293 := SUM($353)", "$294 := SUM($354)", "$295 := SUM($355)", "$296 := SUM($356)", "$297 := SUM($357)", "$298 := SUM($358)", "$299 := SUM($359)", "$300 := SUM($360)", "$301 := SUM($361)", "$302 := SUM($362)", "$303 := SUM($363)", "$304 := SUM($364)", "$305 := SUM($365)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "TO __stage0C_output", "BY HASH($640, $641, $642, $643, $644, $645, $646, $647)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.037199124726477024, "writeRatioMax": 0.037199124726477024 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0262582056892779, "computeRatioMax": 0.0262582056892779, "endMs": "1665778360697", "id": "13", "inputStages": [ "12" ], "name": "S0D: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778360660", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$650 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $650 := $640, $651 := $641, $652 := $642, $653 := $643, $654 := $644, $655 := $645, $656 := $646, $657 := $647", "$100 := SUM($140)", "$101 := SUM($141)", "$102 := SUM($142)", "$103 := SUM($143)", "$104 := SUM($144)", "$105 := SUM($145)", "$106 := SUM($146)", "$107 := SUM($147)", "$108 := SUM($148)", "$109 := SUM($149)", "$110 := SUM($150)", "$111 := SUM($151)", "$112 := SUM($152)", "$113 := SUM($153)", "$114 := SUM($154)", "$115 := SUM($155)" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.030634573304157548, "writeRatioMax": 0.030634573304157548 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.028446389496717725, "computeRatioMax": 0.028446389496717725, "endMs": "1665778360718", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778360676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$696 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719, $720, $721, $722, $723, $724, $725", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.010940919037199124, "writeRatioMax": 0.010940919037199124 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "14", "elapsedMs": "699", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2394" }, { "activeUnits": "0", "completedUnits": "18", "elapsedMs": "978", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2554" } ], "totalBytesBilled": "158334976", "totalBytesProcessed": "158201227", "totalPartitionsProcessed": "0", "totalSlotMs": "2554", "transferredBytes": "0" }, "startTime": "1665778359801", "totalBytesProcessed": "158201227", "totalSlotMs": "2554" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9ebf2dab_4816_45b1_a94a_42b6ed34698b" }, "priority": "INTERACTIVE", "query": "-- start query 66 in stream 0 using template query66.tpl\nselect \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,ship_carriers\n ,year\n \t,sum(jan_sales) as jan_sales\n \t,sum(feb_sales) as feb_sales\n \t,sum(mar_sales) as mar_sales\n \t,sum(apr_sales) as apr_sales\n \t,sum(may_sales) as may_sales\n \t,sum(jun_sales) as jun_sales\n \t,sum(jul_sales) as jul_sales\n \t,sum(aug_sales) as aug_sales\n \t,sum(sep_sales) as sep_sales\n \t,sum(oct_sales) as oct_sales\n \t,sum(nov_sales) as nov_sales\n \t,sum(dec_sales) as dec_sales\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\n \t,sum(jan_net) as jan_net\n \t,sum(feb_net) as feb_net\n \t,sum(mar_net) as mar_net\n \t,sum(apr_net) as apr_net\n \t,sum(may_net) as may_net\n \t,sum(jun_net) as jun_net\n \t,sum(jul_net) as jul_net\n \t,sum(aug_net) as aug_net\n \t,sum(sep_net) as sep_net\n \t,sum(oct_net) as oct_net\n \t,sum(nov_net) as nov_net\n \t,sum(dec_net) as dec_net\n from (\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as dec_net\n from\n web_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n ws_warehouse_sk = w_warehouse_sk\n and ws_sold_date_sk = d_date_sk\n and ws_sold_time_sk = t_time_sk\n \tand ws_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 and 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n union all\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as dec_net\n from\n catalog_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n cs_warehouse_sk = w_warehouse_sk\n and cs_sold_date_sk = d_date_sk\n and cs_sold_time_sk = t_time_sk\n \tand cs_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 AND 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n ) x\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,ship_carriers\n ,year\n order by w_warehouse_name\n limit 100\n ;\n\n-- end query 66 in stream 0 using template query66.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "HLsszzoZkk3N6ZGYg3cvRw==", "id": "test-project-364309:europe-west1.query66_1665778361", "jobReference": { "jobId": "query66_1665778361", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query66_1665778361?location=europe-west1", "statistics": { "creationTime": "1665778362495", "endTime": "1665778363524", "finalExecutionDurationMs": "713", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "158201227", "performanceInsights": { "avgPreviousExecutionMs": "732" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015968063872255488, "computeRatioMax": 0.015968063872255488, "endMs": "1665778362787", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007984031936127744, "readRatioMax": 0.007984031936127744, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778362744", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sm_ship_mode_sk, $11:sm_carrier", "FROM ship_mode", "WHERE in($11, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003992015968063872, "waitRatioMax": 0.003992015968063872, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.03792415169660679, "writeRatioMax": 0.03792415169660679 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.031936127744510975, "computeRatioMax": 0.031936127744510975, "endMs": "1665778362798", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00998003992015968, "readRatioMax": 0.00998003992015968, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665778362757", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:t_time_sk, $31:t_time", "FROM time_dim", "WHERE between($31, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003992015968063872, "waitRatioMax": 0.003992015968063872, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.021956087824351298, "writeRatioMax": 0.021956087824351298 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.021956087824351298, "computeRatioMax": 0.021956087824351298, "endMs": "1665778362809", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.015968063872255488, "readRatioMax": 0.015968063872255488, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665778362773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year, $92:d_moy", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003992015968063872, "waitRatioMax": 0.003992015968063872, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.015968063872255488, "writeRatioMax": 0.015968063872255488 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01996007984031936, "computeRatioMax": 0.01996007984031936, "endMs": "1665778362817", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011976047904191617, "readRatioMax": 0.011976047904191617, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778362786", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name, $82:w_warehouse_sq_ft, $83:w_city, $84:w_county, $85:w_state, $86:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001996007984031936, "waitRatioMax": 0.001996007984031936, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03592814371257485, "writeRatioMax": 0.03592814371257485 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.023952095808383235, "computeRatioMax": 0.023952095808383235, "endMs": "1665778362851", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00998003992015968, "readRatioMax": 0.00998003992015968, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778362819", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:sm_ship_mode_sk, $2:sm_carrier", "FROM ship_mode", "WHERE in($2, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003992015968063872, "waitRatioMax": 0.003992015968063872, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03592814371257485, "writeRatioMax": 0.03592814371257485 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.03792415169660679, "computeRatioMax": 0.03792415169660679, "endMs": "1665778362868", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011976047904191617, "readRatioMax": 0.011976047904191617, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665778362834", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:t_time_sk, $21:t_time", "FROM time_dim", "WHERE between($21, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003992015968063872, "waitRatioMax": 0.003992015968063872, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.027944111776447105, "writeRatioMax": 0.027944111776447105 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015968063872255488, "computeRatioMax": 0.015968063872255488, "endMs": "1665778362884", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.015968063872255488, "readRatioMax": 0.015968063872255488, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778362848", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE equal($61, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001996007984031936, "waitRatioMax": 0.001996007984031936, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.017964071856287425, "writeRatioMax": 0.017964071856287425 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.023952095808383235, "computeRatioMax": 0.023952095808383235, "endMs": "1665778362910", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011976047904191617, "readRatioMax": 0.011976047904191617, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778362865", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:w_warehouse_sk, $51:w_warehouse_name, $52:w_warehouse_sq_ft, $53:w_city, $54:w_county, $55:w_state, $56:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.031936127744510975, "writeRatioMax": 0.031936127744510975 }, { "completedParallelInputs": "5", "computeMsAvg": "262", "computeMsMax": "319", "computeRatioAvg": 0.5229540918163673, "computeRatioMax": 0.6367265469061876, "endMs": "1665778363112", "id": "10", "inputStages": [ "0", "2", "1", "3" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "23", "readMsMax": "29", "readRatioAvg": 0.04590818363273453, "readRatioMax": 0.05788423153692615, "recordsRead": "1587413", "recordsWritten": "25", "shuffleOutputBytes": "12565", "shuffleOutputBytesSpilled": "0", "slotMs": "1439", "startMs": "1665778362894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_sold_time_sk, $72:cs_ship_mode_sk, $73:cs_warehouse_sk, $74:cs_quantity, $75:cs_ext_list_price, $76:cs_net_paid", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $603, $621 := $604, $622 := $605, $623 := $606, $624 := $607, $625 := $608, $626 := $609", "$350 := SUM($433)", "$351 := SUM($432)", "$352 := SUM($431)", "$353 := SUM($430)", "$354 := SUM($429)", "$355 := SUM($428)", "$356 := SUM($427)", "$357 := SUM($426)", "$358 := SUM($425)", "$359 := SUM($424)", "$360 := SUM($423)", "$361 := SUM($422)", "$362 := SUM($421)", "$363 := SUM($420)", "$364 := SUM($419)", "$365 := SUM($418)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := case_no_value(equal($610, 12), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$411 := case_no_value(equal($610, 11), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$412 := case_no_value(equal($610, 10), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$413 := case_no_value(equal($610, 9), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$414 := case_no_value(equal($610, 8), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$415 := case_no_value(equal($610, 7), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$416 := case_no_value(equal($610, 6), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$417 := case_no_value(equal($610, 5), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$418 := case_no_value(equal($610, 4), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$419 := case_no_value(equal($610, 3), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$420 := case_no_value(equal($610, 2), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$421 := case_no_value(equal($610, 1), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$422 := case_no_value(equal($610, 12), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$423 := case_no_value(equal($610, 11), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$424 := case_no_value(equal($610, 10), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$425 := case_no_value(equal($610, 9), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $589, $609 := $590, $610 := $591", "INNER HASH JOIN EACH WITH ALL ON $580 = $10" ] }, { "kind": "JOIN", "substeps": [ "$580 := $561, $581 := $562, $582 := $563, $583 := $564, $584 := $565, $585 := $566, $586 := $567, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $572", "INNER HASH JOIN EACH WITH ALL ON $560 = $30" ] }, { "kind": "JOIN", "substeps": [ "$560 := $541, $561 := $542, $562 := $543, $563 := $544, $564 := $545, $565 := $546, $566 := $547, $567 := $548, $568 := $549, $569 := $550, $570 := $551, $571 := $91, $572 := $92", "INNER HASH JOIN EACH WITH ALL ON $540 = $90" ] }, { "kind": "JOIN", "substeps": [ "$540 := $70, $541 := $71, $542 := $72, $543 := $74, $544 := $75, $545 := $76, $546 := $81, $547 := $82, $548 := $83, $549 := $84, $550 := $85, $551 := $86", "INNER HASH JOIN EACH WITH ALL ON $73 = $80" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "TO __stage0A_output", "BY HASH($620, $621, $622, $623, $624, $625, $626)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003992015968063872, "waitRatioMax": 0.003992015968063872, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.00998003992015968, "writeRatioMax": 0.011976047904191617 }, { "completedParallelInputs": "1", "computeMsAvg": "501", "computeMsMax": "501", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778363230", "id": "11", "inputStages": [ "6", "8", "7", "5" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "37", "readMsMax": "37", "readRatioAvg": 0.07385229540918163, "readRatioMax": 0.07385229540918163, "recordsRead": "748557", "recordsWritten": "5", "shuffleOutputBytes": "2513", "shuffleOutputBytesSpilled": "0", "slotMs": "374", "startMs": "1665778362924", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_sold_time_sk, $42:ws_ship_mode_sk, $43:ws_warehouse_sk, $44:ws_quantity, $45:ws_ext_sales_price, $46:ws_net_paid_inc_ship", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $503, $521 := $504, $522 := $505, $523 := $506, $524 := $507, $525 := $508, $526 := $509", "$320 := SUM($403)", "$321 := SUM($402)", "$322 := SUM($401)", "$323 := SUM($400)", "$324 := SUM($399)", "$325 := SUM($398)", "$326 := SUM($397)", "$327 := SUM($396)", "$328 := SUM($395)", "$329 := SUM($394)", "$330 := SUM($393)", "$331 := SUM($392)", "$332 := SUM($391)", "$333 := SUM($390)", "$334 := SUM($389)", "$335 := SUM($388)" ] }, { "kind": "COMPUTE", "substeps": [ "$380 := case_no_value(equal($510, 12), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$381 := case_no_value(equal($510, 11), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$382 := case_no_value(equal($510, 10), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$383 := case_no_value(equal($510, 9), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$384 := case_no_value(equal($510, 8), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$385 := case_no_value(equal($510, 7), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$386 := case_no_value(equal($510, 6), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$387 := case_no_value(equal($510, 5), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$388 := case_no_value(equal($510, 4), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$389 := case_no_value(equal($510, 3), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$390 := case_no_value(equal($510, 2), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$391 := case_no_value(equal($510, 1), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$392 := case_no_value(equal($510, 12), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$393 := case_no_value(equal($510, 11), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$394 := case_no_value(equal($510, 10), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$395 := case_no_value(equal($510, 9), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $481, $501 := $482, $502 := $483, $503 := $484, $504 := $485, $505 := $486, $506 := $487, $507 := $488, $508 := $489, $509 := $490, $510 := $491", "INNER HASH JOIN EACH WITH ALL ON $480 = $1" ] }, { "kind": "JOIN", "substeps": [ "$480 := $461, $481 := $462, $482 := $463, $483 := $464, $484 := $465, $485 := $466, $486 := $467, $487 := $468, $488 := $469, $489 := $470, $490 := $471, $491 := $472", "INNER HASH JOIN EACH WITH ALL ON $460 = $20" ] }, { "kind": "JOIN", "substeps": [ "$460 := $441, $461 := $442, $462 := $443, $463 := $444, $464 := $445, $465 := $446, $466 := $447, $467 := $448, $468 := $449, $469 := $450, $470 := $451, $471 := $61, $472 := $62", "INNER HASH JOIN EACH WITH ALL ON $440 = $60" ] }, { "kind": "JOIN", "substeps": [ "$440 := $40, $441 := $41, $442 := $42, $443 := $44, $444 := $45, $445 := $46, $446 := $51, $447 := $52, $448 := $53, $449 := $54, $450 := $55, $451 := $56", "INNER HASH JOIN EACH WITH ALL ON $43 = $50" ] }, { "kind": "WRITE", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "TO __stage0B_output", "BY HASH($520, $521, $522, $523, $524, $525, $526)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001996007984031936, "waitRatioMax": 0.001996007984031936, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.011976047904191617, "writeRatioMax": 0.011976047904191617 }, { "completedParallelInputs": "2", "computeMsAvg": "11", "computeMsMax": "13", "computeRatioAvg": 0.021956087824351298, "computeRatioMax": 0.02594810379241517, "endMs": "1665778363347", "id": "12", "inputStages": [ "11", "10" ], "name": "S0C: Aggregate+", "parallelInputs": "2", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "10", "shuffleOutputBytes": "6922", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665778363310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $200, $641 := $201, $642 := $202, $643 := $203, $644 := $204, $645 := $205, $646 := $206, $647 := $207", "$140 := SUM($208)", "$141 := SUM($209)", "$142 := SUM($210)", "$143 := SUM($211)", "$144 := SUM($212)", "$145 := SUM($213)", "$146 := SUM($214)", "$147 := SUM($215)", "$148 := SUM($216)", "$149 := SUM($217)", "$150 := SUM($218)", "$151 := SUM($219)", "$152 := SUM($180)", "$153 := SUM($181)", "$154 := SUM($182)", "$155 := SUM($183)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($208, CAST($201 AS NUMERIC))", "$181 := divide($209, CAST($201 AS NUMERIC))", "$182 := divide($210, CAST($201 AS NUMERIC))", "$183 := divide($211, CAST($201 AS NUMERIC))", "$184 := divide($212, CAST($201 AS NUMERIC))", "$185 := divide($213, CAST($201 AS NUMERIC))", "$186 := divide($214, CAST($201 AS NUMERIC))", "$187 := divide($215, CAST($201 AS NUMERIC))", "$188 := divide($216, CAST($201 AS NUMERIC))", "$189 := divide($217, CAST($201 AS NUMERIC))", "$190 := divide($218, CAST($201 AS NUMERIC))", "$191 := divide($219, CAST($201 AS NUMERIC))" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $520, $531 := $521, $532 := $522, $533 := $523, $534 := $524, $535 := $525, $536 := $526", "$260 := SUM($320)", "$261 := SUM($321)", "$262 := SUM($322)", "$263 := SUM($323)", "$264 := SUM($324)", "$265 := SUM($325)", "$266 := SUM($326)", "$267 := SUM($327)", "$268 := SUM($328)", "$269 := SUM($329)", "$270 := SUM($330)", "$271 := SUM($331)", "$272 := SUM($332)", "$273 := SUM($333)", "$274 := SUM($334)", "$275 := SUM($335)" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622, $633 := $623, $634 := $624, $635 := $625, $636 := $626", "$290 := SUM($350)", "$291 := SUM($351)", "$292 := SUM($352)", "$293 := SUM($353)", "$294 := SUM($354)", "$295 := SUM($355)", "$296 := SUM($356)", "$297 := SUM($357)", "$298 := SUM($358)", "$299 := SUM($359)", "$300 := SUM($360)", "$301 := SUM($361)", "$302 := SUM($362)", "$303 := SUM($363)", "$304 := SUM($364)", "$305 := SUM($365)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "TO __stage0C_output", "BY HASH($640, $641, $642, $643, $644, $645, $646, $647)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001996007984031936, "waitRatioMax": 0.001996007984031936, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.029940119760479042, "writeRatioMax": 0.029940119760479042 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.017964071856287425, "computeRatioMax": 0.017964071856287425, "endMs": "1665778363395", "id": "13", "inputStages": [ "12" ], "name": "S0D: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778363357", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$650 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $650 := $640, $651 := $641, $652 := $642, $653 := $643, $654 := $644, $655 := $645, $656 := $646, $657 := $647", "$100 := SUM($140)", "$101 := SUM($141)", "$102 := SUM($142)", "$103 := SUM($143)", "$104 := SUM($144)", "$105 := SUM($145)", "$106 := SUM($146)", "$107 := SUM($147)", "$108 := SUM($148)", "$109 := SUM($149)", "$110 := SUM($150)", "$111 := SUM($151)", "$112 := SUM($152)", "$113 := SUM($153)", "$114 := SUM($154)", "$115 := SUM($155)" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001996007984031936, "waitRatioMax": 0.001996007984031936, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.031936127744510975, "writeRatioMax": 0.031936127744510975 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01996007984031936, "computeRatioMax": 0.01996007984031936, "endMs": "1665778363418", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778363375", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$696 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719, $720, $721, $722, $723, $724, $725", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001996007984031936, "waitRatioMax": 0.001996007984031936, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.013972055888223553, "writeRatioMax": 0.013972055888223553 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "14", "elapsedMs": "691", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2318" }, { "activeUnits": "0", "completedUnits": "18", "elapsedMs": "913", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2476" } ], "totalBytesBilled": "158334976", "totalBytesProcessed": "158201227", "totalPartitionsProcessed": "0", "totalSlotMs": "2476", "transferredBytes": "0" }, "startTime": "1665778362555", "totalBytesProcessed": "158201227", "totalSlotMs": "2476" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon52df75ec_c5b8_4b20_9ff3_245ae33219e0" }, "priority": "INTERACTIVE", "query": "-- start query 66 in stream 0 using template query66.tpl\nselect \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,ship_carriers\n ,year\n \t,sum(jan_sales) as jan_sales\n \t,sum(feb_sales) as feb_sales\n \t,sum(mar_sales) as mar_sales\n \t,sum(apr_sales) as apr_sales\n \t,sum(may_sales) as may_sales\n \t,sum(jun_sales) as jun_sales\n \t,sum(jul_sales) as jul_sales\n \t,sum(aug_sales) as aug_sales\n \t,sum(sep_sales) as sep_sales\n \t,sum(oct_sales) as oct_sales\n \t,sum(nov_sales) as nov_sales\n \t,sum(dec_sales) as dec_sales\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\n \t,sum(jan_net) as jan_net\n \t,sum(feb_net) as feb_net\n \t,sum(mar_net) as mar_net\n \t,sum(apr_net) as apr_net\n \t,sum(may_net) as may_net\n \t,sum(jun_net) as jun_net\n \t,sum(jul_net) as jul_net\n \t,sum(aug_net) as aug_net\n \t,sum(sep_net) as sep_net\n \t,sum(oct_net) as oct_net\n \t,sum(nov_net) as nov_net\n \t,sum(dec_net) as dec_net\n from (\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen ws_net_paid_inc_ship benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_quantity else 0 end) as dec_net\n from\n web_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n ws_warehouse_sk = w_warehouse_sk\n and ws_sold_date_sk = d_date_sk\n and ws_sold_time_sk = t_time_sk\n \tand ws_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 and 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n union all\n select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers\n ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen cs_net_paid benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_quantity else 0 end) as dec_net\n from\n catalog_sales\n ,warehouse\n ,date_dim\n ,time_dim\n \t ,ship_mode\n where\n cs_warehouse_sk = w_warehouse_sk\n and cs_sold_date_sk = d_date_sk\n and cs_sold_time_sk = t_time_sk\n \tand cs_ship_mode_sk = sm_ship_mode_sk\n and d_year = 2001\n \tand t_time between 42970 AND 42970+28800 \n \tand sm_carrier in ('ORIENTAL','BOXBUNDLES')\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n ,d_year\n ) x\n group by \n w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,ship_carriers\n ,year\n order by w_warehouse_name\n limit 100\n ;\n\n-- end query 66 in stream 0 using template query66.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "sfnIYDZoYH5QLxfhxNpwXA==", "id": "test-project-364309:europe-west1.query66_1665778364", "jobReference": { "jobId": "query66_1665778364", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query66_1665778364?location=europe-west1", "statistics": { "creationTime": "1665778365301", "endTime": "1665778366311", "finalExecutionDurationMs": "667", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "158201227", "performanceInsights": { "avgPreviousExecutionMs": "730" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.017361111111111112, "computeRatioMax": 0.017361111111111112, "endMs": "1665778365560", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010416666666666666, "readRatioMax": 0.010416666666666666, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778365526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sm_ship_mode_sk, $11:sm_carrier", "FROM ship_mode", "WHERE in($11, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001736111111111111, "waitRatioMax": 0.001736111111111111, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.013888888888888888 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.050347222222222224, "computeRatioMax": 0.050347222222222224, "endMs": "1665778365568", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008680555555555556, "readRatioMax": 0.008680555555555556, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778365540", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:t_time_sk, $31:t_time", "FROM time_dim", "WHERE between($31, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001736111111111111, "waitRatioMax": 0.001736111111111111, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.019097222222222224, "writeRatioMax": 0.019097222222222224 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.019097222222222224, "computeRatioMax": 0.019097222222222224, "endMs": "1665778365589", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010416666666666666, "readRatioMax": 0.010416666666666666, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778365553", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year, $92:d_moy", "FROM date_dim", "WHERE equal($91, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001736111111111111, "waitRatioMax": 0.001736111111111111, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.013888888888888888 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.015625, "computeRatioMax": 0.015625, "endMs": "1665778365605", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006944444444444444, "readRatioMax": 0.006944444444444444, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778365569", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name, $82:w_warehouse_sq_ft, $83:w_city, $84:w_county, $85:w_state, $86:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.026041666666666668, "writeRatioMax": 0.026041666666666668 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.017361111111111112, "computeRatioMax": 0.017361111111111112, "endMs": "1665778365638", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008680555555555556, "readRatioMax": 0.008680555555555556, "recordsRead": "20", "recordsWritten": "2", "shuffleOutputBytes": "18", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778365605", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:sm_ship_mode_sk, $2:sm_carrier", "FROM ship_mode", "WHERE in($2, 'ORIENTAL', 'BOXBUNDLES')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage05_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.017361111111111112, "waitRatioMax": 0.017361111111111112, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.015625, "writeRatioMax": 0.015625 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.024305555555555556, "computeRatioMax": 0.024305555555555556, "endMs": "1665778365639", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006944444444444444, "readRatioMax": 0.006944444444444444, "recordsRead": "86400", "recordsWritten": "28801", "shuffleOutputBytes": "259209", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778365611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:t_time_sk, $21:t_time", "FROM time_dim", "WHERE between($21, 42970, 71770)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001736111111111111, "waitRatioMax": 0.001736111111111111, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.024305555555555556, "writeRatioMax": 0.024305555555555556 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.012152777777777778, "computeRatioMax": 0.012152777777777778, "endMs": "1665778365656", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010416666666666666, "readRatioMax": 0.010416666666666666, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "9855", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778365628", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE equal($61, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001736111111111111, "waitRatioMax": 0.001736111111111111, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.026041666666666668, "writeRatioMax": 0.026041666666666668 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.013888888888888888, "computeRatioMax": 0.013888888888888888, "endMs": "1665778365674", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008680555555555556, "readRatioMax": 0.008680555555555556, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "473", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778365644", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:w_warehouse_sk, $51:w_warehouse_name, $52:w_warehouse_sq_ft, $53:w_city, $54:w_county, $55:w_state, $56:w_country", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003472222222222222, "waitRatioMax": 0.003472222222222222, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03125, "writeRatioMax": 0.03125 }, { "completedParallelInputs": "5", "computeMsAvg": "301", "computeMsMax": "353", "computeRatioAvg": 0.5225694444444444, "computeRatioMax": 0.6128472222222222, "endMs": "1665778365901", "id": "10", "inputStages": [ "3", "1", "0", "2" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "24", "readMsMax": "31", "readRatioAvg": 0.041666666666666664, "readRatioMax": 0.05381944444444445, "recordsRead": "1587413", "recordsWritten": "25", "shuffleOutputBytes": "12565", "shuffleOutputBytesSpilled": "0", "slotMs": "1343", "startMs": "1665778365663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_sold_time_sk, $72:cs_ship_mode_sk, $73:cs_warehouse_sk, $74:cs_quantity, $75:cs_ext_list_price, $76:cs_net_paid", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $603, $621 := $604, $622 := $605, $623 := $606, $624 := $607, $625 := $608, $626 := $609", "$350 := SUM($433)", "$351 := SUM($432)", "$352 := SUM($431)", "$353 := SUM($430)", "$354 := SUM($429)", "$355 := SUM($428)", "$356 := SUM($427)", "$357 := SUM($426)", "$358 := SUM($425)", "$359 := SUM($424)", "$360 := SUM($423)", "$361 := SUM($422)", "$362 := SUM($421)", "$363 := SUM($420)", "$364 := SUM($419)", "$365 := SUM($418)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := case_no_value(equal($610, 12), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$411 := case_no_value(equal($610, 11), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$412 := case_no_value(equal($610, 10), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$413 := case_no_value(equal($610, 9), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$414 := case_no_value(equal($610, 8), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$415 := case_no_value(equal($610, 7), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$416 := case_no_value(equal($610, 6), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$417 := case_no_value(equal($610, 5), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$418 := case_no_value(equal($610, 4), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$419 := case_no_value(equal($610, 3), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$420 := case_no_value(equal($610, 2), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$421 := case_no_value(equal($610, 1), multiply($602, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$422 := case_no_value(equal($610, 12), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$423 := case_no_value(equal($610, 11), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$424 := case_no_value(equal($610, 10), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)", "$425 := case_no_value(equal($610, 9), multiply($601, CAST($600 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $589, $609 := $590, $610 := $591", "INNER HASH JOIN EACH WITH ALL ON $580 = $10" ] }, { "kind": "JOIN", "substeps": [ "$580 := $561, $581 := $562, $582 := $563, $583 := $564, $584 := $565, $585 := $566, $586 := $567, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $572", "INNER HASH JOIN EACH WITH ALL ON $560 = $30" ] }, { "kind": "JOIN", "substeps": [ "$560 := $541, $561 := $542, $562 := $543, $563 := $544, $564 := $545, $565 := $546, $566 := $547, $567 := $548, $568 := $549, $569 := $550, $570 := $551, $571 := $91, $572 := $92", "INNER HASH JOIN EACH WITH ALL ON $540 = $90" ] }, { "kind": "JOIN", "substeps": [ "$540 := $70, $541 := $71, $542 := $72, $543 := $74, $544 := $75, $545 := $76, $546 := $81, $547 := $82, $548 := $83, $549 := $84, $550 := $85, $551 := $86", "INNER HASH JOIN EACH WITH ALL ON $73 = $80" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "TO __stage0A_output", "BY HASH($620, $621, $622, $623, $624, $625, $626)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001736111111111111, "waitRatioMax": 0.001736111111111111, "writeMsAvg": "9", "writeMsMax": "27", "writeRatioAvg": 0.015625, "writeRatioMax": 0.046875 }, { "completedParallelInputs": "1", "computeMsAvg": "576", "computeMsMax": "576", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778366028", "id": "11", "inputStages": [ "6", "7", "5", "8" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.0625, "readRatioMax": 0.0625, "recordsRead": "748557", "recordsWritten": "5", "shuffleOutputBytes": "2513", "shuffleOutputBytesSpilled": "0", "slotMs": "528", "startMs": "1665778365682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_sold_time_sk, $42:ws_ship_mode_sk, $43:ws_warehouse_sk, $44:ws_quantity, $45:ws_ext_sales_price, $46:ws_net_paid_inc_ship", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53, $54, $55, $56", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $503, $521 := $504, $522 := $505, $523 := $506, $524 := $507, $525 := $508, $526 := $509", "$320 := SUM($403)", "$321 := SUM($402)", "$322 := SUM($401)", "$323 := SUM($400)", "$324 := SUM($399)", "$325 := SUM($398)", "$326 := SUM($397)", "$327 := SUM($396)", "$328 := SUM($395)", "$329 := SUM($394)", "$330 := SUM($393)", "$331 := SUM($392)", "$332 := SUM($391)", "$333 := SUM($390)", "$334 := SUM($389)", "$335 := SUM($388)" ] }, { "kind": "COMPUTE", "substeps": [ "$380 := case_no_value(equal($510, 12), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$381 := case_no_value(equal($510, 11), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$382 := case_no_value(equal($510, 10), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$383 := case_no_value(equal($510, 9), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$384 := case_no_value(equal($510, 8), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$385 := case_no_value(equal($510, 7), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$386 := case_no_value(equal($510, 6), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$387 := case_no_value(equal($510, 5), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$388 := case_no_value(equal($510, 4), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$389 := case_no_value(equal($510, 3), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$390 := case_no_value(equal($510, 2), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$391 := case_no_value(equal($510, 1), multiply($502, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$392 := case_no_value(equal($510, 12), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$393 := case_no_value(equal($510, 11), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$394 := case_no_value(equal($510, 10), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)", "$395 := case_no_value(equal($510, 9), multiply($501, CAST($500 AS NUMERIC)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $481, $501 := $482, $502 := $483, $503 := $484, $504 := $485, $505 := $486, $506 := $487, $507 := $488, $508 := $489, $509 := $490, $510 := $491", "INNER HASH JOIN EACH WITH ALL ON $480 = $1" ] }, { "kind": "JOIN", "substeps": [ "$480 := $461, $481 := $462, $482 := $463, $483 := $464, $484 := $465, $485 := $466, $486 := $467, $487 := $468, $488 := $469, $489 := $470, $490 := $471, $491 := $472", "INNER HASH JOIN EACH WITH ALL ON $460 = $20" ] }, { "kind": "JOIN", "substeps": [ "$460 := $441, $461 := $442, $462 := $443, $463 := $444, $464 := $445, $465 := $446, $466 := $447, $467 := $448, $468 := $449, $469 := $450, $470 := $451, $471 := $61, $472 := $62", "INNER HASH JOIN EACH WITH ALL ON $440 = $60" ] }, { "kind": "JOIN", "substeps": [ "$440 := $40, $441 := $41, $442 := $42, $443 := $44, $444 := $45, $445 := $46, $446 := $51, $447 := $52, $448 := $53, $449 := $54, $450 := $55, $451 := $56", "INNER HASH JOIN EACH WITH ALL ON $43 = $50" ] }, { "kind": "WRITE", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "TO __stage0B_output", "BY HASH($520, $521, $522, $523, $524, $525, $526)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003472222222222222, "waitRatioMax": 0.003472222222222222, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.012152777777777778, "writeRatioMax": 0.012152777777777778 }, { "completedParallelInputs": "2", "computeMsAvg": "11", "computeMsMax": "14", "computeRatioAvg": 0.019097222222222224, "computeRatioMax": 0.024305555555555556, "endMs": "1665778366114", "id": "12", "inputStages": [ "11", "10" ], "name": "S0C: Aggregate+", "parallelInputs": "2", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "10", "shuffleOutputBytes": "6922", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665778366072", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$520, $521, $522, $523, $524, $525, $526, $320, $321, $322, $323, $324, $325, $326, $327, $328", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$620, $621, $622, $623, $624, $625, $626, $350, $351, $352, $353, $354, $355, $356, $357, $358", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $200, $641 := $201, $642 := $202, $643 := $203, $644 := $204, $645 := $205, $646 := $206, $647 := $207", "$140 := SUM($208)", "$141 := SUM($209)", "$142 := SUM($210)", "$143 := SUM($211)", "$144 := SUM($212)", "$145 := SUM($213)", "$146 := SUM($214)", "$147 := SUM($215)", "$148 := SUM($216)", "$149 := SUM($217)", "$150 := SUM($218)", "$151 := SUM($219)", "$152 := SUM($180)", "$153 := SUM($181)", "$154 := SUM($182)", "$155 := SUM($183)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($208, CAST($201 AS NUMERIC))", "$181 := divide($209, CAST($201 AS NUMERIC))", "$182 := divide($210, CAST($201 AS NUMERIC))", "$183 := divide($211, CAST($201 AS NUMERIC))", "$184 := divide($212, CAST($201 AS NUMERIC))", "$185 := divide($213, CAST($201 AS NUMERIC))", "$186 := divide($214, CAST($201 AS NUMERIC))", "$187 := divide($215, CAST($201 AS NUMERIC))", "$188 := divide($216, CAST($201 AS NUMERIC))", "$189 := divide($217, CAST($201 AS NUMERIC))", "$190 := divide($218, CAST($201 AS NUMERIC))", "$191 := divide($219, CAST($201 AS NUMERIC))" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $520, $531 := $521, $532 := $522, $533 := $523, $534 := $524, $535 := $525, $536 := $526", "$260 := SUM($320)", "$261 := SUM($321)", "$262 := SUM($322)", "$263 := SUM($323)", "$264 := SUM($324)", "$265 := SUM($325)", "$266 := SUM($326)", "$267 := SUM($327)", "$268 := SUM($328)", "$269 := SUM($329)", "$270 := SUM($330)", "$271 := SUM($331)", "$272 := SUM($332)", "$273 := SUM($333)", "$274 := SUM($334)", "$275 := SUM($335)" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'ORIENTAL,BOXBUNDLES'" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622, $633 := $623, $634 := $624, $635 := $625, $636 := $626", "$290 := SUM($350)", "$291 := SUM($351)", "$292 := SUM($352)", "$293 := SUM($353)", "$294 := SUM($354)", "$295 := SUM($355)", "$296 := SUM($356)", "$297 := SUM($357)", "$298 := SUM($358)", "$299 := SUM($359)", "$300 := SUM($360)", "$301 := SUM($361)", "$302 := SUM($362)", "$303 := SUM($363)", "$304 := SUM($364)", "$305 := SUM($365)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "TO __stage0C_output", "BY HASH($640, $641, $642, $643, $644, $645, $646, $647)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003472222222222222, "waitRatioMax": 0.003472222222222222, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03125, "writeRatioMax": 0.03125 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.013888888888888888, "computeRatioMax": 0.013888888888888888, "endMs": "1665778366156", "id": "13", "inputStages": [ "12" ], "name": "S0D: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778366123", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147, $148, $149, $150, $151, $152, $153, $154, $155", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$650 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $650 := $640, $651 := $641, $652 := $642, $653 := $643, $654 := $644, $655 := $645, $656 := $646, $657 := $647", "$100 := SUM($140)", "$101 := SUM($141)", "$102 := SUM($142)", "$103 := SUM($143)", "$104 := SUM($144)", "$105 := SUM($145)", "$106 := SUM($146)", "$107 := SUM($147)", "$108 := SUM($148)", "$109 := SUM($149)", "$110 := SUM($150)", "$111 := SUM($151)", "$112 := SUM($152)", "$113 := SUM($153)", "$114 := SUM($154)", "$115 := SUM($155)" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001736111111111111, "waitRatioMax": 0.001736111111111111, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.017361111111111112, "writeRatioMax": 0.017361111111111112 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.012152777777777778, "computeRatioMax": 0.012152777777777778, "endMs": "1665778366162", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "3461", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778366135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$660, $661, $662, $663, $664, $665, $666, $667, $668, $669, $670, $671, $672, $673, $674, $675", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$696 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719, $720, $721, $722, $723, $724, $725", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001736111111111111, "waitRatioMax": 0.001736111111111111, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.010416666666666666, "writeRatioMax": 0.010416666666666666 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "13", "elapsedMs": "663", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1806" }, { "activeUnits": "1", "completedUnits": "18", "elapsedMs": "843", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2384" } ], "totalBytesBilled": "158334976", "totalBytesProcessed": "158201227", "totalPartitionsProcessed": "0", "totalSlotMs": "2384", "transferredBytes": "0" }, "startTime": "1665778365366", "totalBytesProcessed": "158201227", "totalSlotMs": "2384" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
