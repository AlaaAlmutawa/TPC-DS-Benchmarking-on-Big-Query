{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8432bbdd_f464_44f1_8f7e_fe4eaf7d950a" }, "priority": "INTERACTIVE", "query": "-- start query 91 in stream 0 using template query91.tpl\n\n/*\nDisplay total returns of catalog sales by call center and manager in a particular month \nfor male customers of unknown education or female customers \nwith advanced degrees with a specified buy potential and from a particular time zone.\n*/\n\nselect \n cc_call_center_id Call_Center,\n cc_name Call_Center_Name,\n cc_manager Manager,\n sum(cr_net_loss) Returns_Loss\nfrom\n call_center,\n catalog_returns,\n date_dim,\n customer,\n customer_address,\n customer_demographics,\n household_demographics\nwhere\n cr_call_center_sk = cc_call_center_sk\nand cr_returned_date_sk = d_date_sk\nand cr_returning_customer_sk= c_customer_sk\nand cd_demo_sk = c_current_cdemo_sk\nand hd_demo_sk = c_current_hdemo_sk\nand ca_address_sk = c_current_addr_sk\nand d_year = 1998\nand d_moy = 11\nand ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')\n or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree'))\nand hd_buy_potential = 'Unknown'\nand ca_gmt_offset = -7\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;\n\n-- end query 91 in stream 0 using template query91.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "xl9pKuDmhPYzQIq204hyYg==", "id": "test-project-364309:europe-west1.query91_1665768512", "jobReference": { "jobId": "query91_1665768512", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query91_1665768512?location=europe-west1", "statistics": { "creationTime": "1665768513342", "endTime": "1665768514039", "finalExecutionDurationMs": "450", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "55225798", "performanceInsights": { "avgPreviousExecutionMs": "475" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.046948356807511735, "computeRatioMax": 0.046948356807511735, "endMs": "1665768513579", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.023474178403755867, "readRatioMax": 0.023474178403755867, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768513538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:hd_demo_sk, $2:hd_buy_potential", "FROM household_demographics", "WHERE equal($2, 'Unknown')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009389671361502348, "waitRatioMax": 0.009389671361502348, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.08450704225352113, "writeRatioMax": 0.08450704225352113 }, { "completedParallelInputs": "1", "computeMsAvg": "213", "computeMsMax": "213", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768513689", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.051643192488262914, "readRatioMax": 0.051643192488262914, "recordsRead": "1920800", "recordsWritten": "109760", "shuffleOutputBytes": "3402560", "shuffleOutputBytesSpilled": "0", "slotMs": "151", "startMs": "1665768513554", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status", "FROM customer_demographics", "WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009389671361502348, "waitRatioMax": 0.009389671361502348, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04225352112676056, "writeRatioMax": 0.04225352112676056 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.046948356807511735, "computeRatioMax": 0.046948356807511735, "endMs": "1665768513611", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.023474178403755867, "readRatioMax": 0.023474178403755867, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768513569", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07042253521126761, "writeRatioMax": 0.07042253521126761 }, { "completedParallelInputs": "1", "computeMsAvg": "78", "computeMsMax": "78", "computeRatioAvg": 0.36619718309859156, "computeRatioMax": 0.36619718309859156, "endMs": "1665768513673", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03286384976525822, "readRatioMax": 0.03286384976525822, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3545048", "shuffleOutputBytesSpilled": "0", "slotMs": "96", "startMs": "1665768513583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.051643192488262914, "writeRatioMax": 0.051643192488262914 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.09389671361502347, "computeRatioMax": 0.09389671361502347, "endMs": "1665768513635", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.056338028169014086, "readRatioMax": 0.056338028169014086, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768513599", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04225352112676056, "writeRatioMax": 0.04225352112676056 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03755868544600939, "computeRatioMax": 0.03755868544600939, "endMs": "1665768513667", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03286384976525822, "readRatioMax": 0.03286384976525822, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "386", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768513627", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.1267605633802817, "writeRatioMax": 0.1267605633802817 }, { "completedParallelInputs": "1", "computeMsAvg": "211", "computeMsMax": "211", "computeRatioAvg": 0.9906103286384976, "computeRatioMax": 0.9906103286384976, "endMs": "1665768513854", "id": "9", "inputStages": [ "1", "3", "0", "4", "2", "6" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.056338028169014086, "readRatioMax": 0.056338028169014086, "recordsRead": "360512", "recordsWritten": "1", "shuffleOutputBytes": "92", "shuffleOutputBytesSpilled": "0", "slotMs": "190", "startMs": "1665768513717", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171", "$80 := SUM($175)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $155, $171 := $156, $172 := $151, $173 := $152, $174 := $153, $175 := $154", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $11, $156 := $12", "INNER HASH JOIN EACH WITH ALL ON $130 = $10" ] }, { "kind": "JOIN", "substeps": [ "$130 := $124, $131 := $125, $132 := $120, $133 := $121, $134 := $122, $135 := $123", "INNER HASH JOIN EACH WITH ALL ON $126 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $110, $121 := $111, $122 := $112, $123 := $114, $124 := $21, $125 := $22, $126 := $23", "INNER HASH JOIN EACH WITH ALL ON $113 = $20" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $60" ] }, { "kind": "JOIN", "substeps": [ "$93 := $50, $94 := $51, $95 := $53, $90 := $41, $91 := $42, $92 := $43", "INNER HASH JOIN EACH WITH ALL ON $52 = $40" ] }, { "kind": "WRITE", "substeps": [ "$183, $184, $180, $181, $182, $80", "TO __stage09_output", "BY HASH($180, $181, $182, $183, $184)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009389671361502348, "waitRatioMax": 0.009389671361502348, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.018779342723004695, "writeRatioMax": 0.018779342723004695 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04225352112676056, "computeRatioMax": 0.04225352112676056, "endMs": "1665768513901", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665768513889", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$183, $184, $180, $181, $182, $80", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184", "$70 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $70", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.014084507042253521, "writeRatioMax": 0.014084507042253521 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.046948356807511735, "computeRatioMax": 0.046948356807511735, "endMs": "1665768513958", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768513910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $70", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$70 DESC" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.12206572769953052, "writeRatioMax": 0.12206572769953052 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "9", "elapsedMs": "583", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "634" } ], "totalBytesBilled": "73400320", "totalBytesProcessed": "55225798", "totalPartitionsProcessed": "0", "totalSlotMs": "634", "transferredBytes": "0" }, "startTime": "1665768513398", "totalBytesProcessed": "55225798", "totalSlotMs": "634" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf94a4aaa_07d9_4175_8ab2_579429ef4ee7" }, "priority": "INTERACTIVE", "query": "-- start query 91 in stream 0 using template query91.tpl\n\n/*\nDisplay total returns of catalog sales by call center and manager in a particular month \nfor male customers of unknown education or female customers \nwith advanced degrees with a specified buy potential and from a particular time zone.\n*/\n\nselect \n cc_call_center_id Call_Center,\n cc_name Call_Center_Name,\n cc_manager Manager,\n sum(cr_net_loss) Returns_Loss\nfrom\n call_center,\n catalog_returns,\n date_dim,\n customer,\n customer_address,\n customer_demographics,\n household_demographics\nwhere\n cr_call_center_sk = cc_call_center_sk\nand cr_returned_date_sk = d_date_sk\nand cr_returning_customer_sk= c_customer_sk\nand cd_demo_sk = c_current_cdemo_sk\nand hd_demo_sk = c_current_hdemo_sk\nand ca_address_sk = c_current_addr_sk\nand d_year = 1998\nand d_moy = 11\nand ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')\n or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree'))\nand hd_buy_potential = 'Unknown'\nand ca_gmt_offset = -7\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;\n\n-- end query 91 in stream 0 using template query91.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "elkeMuS7EnA3CtPbbG9/1w==", "id": "test-project-364309:europe-west1.query91_1665778794", "jobReference": { "jobId": "query91_1665778794", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query91_1665778794?location=europe-west1", "statistics": { "creationTime": "1665778795525", "endTime": "1665778796293", "finalExecutionDurationMs": "526", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "55225798", "performanceInsights": { "avgPreviousExecutionMs": "467" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03823529411764706, "computeRatioMax": 0.03823529411764706, "endMs": "1665778795769", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.020588235294117647, "readRatioMax": 0.020588235294117647, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778795724", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:hd_demo_sk, $2:hd_buy_potential", "FROM household_demographics", "WHERE equal($2, 'Unknown')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008823529411764706, "waitRatioMax": 0.008823529411764706, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.052941176470588235, "writeRatioMax": 0.052941176470588235 }, { "completedParallelInputs": "1", "computeMsAvg": "340", "computeMsMax": "340", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778795969", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.03823529411764706, "readRatioMax": 0.03823529411764706, "recordsRead": "1920800", "recordsWritten": "109760", "shuffleOutputBytes": "3402560", "shuffleOutputBytesSpilled": "0", "slotMs": "314", "startMs": "1665778795740", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status", "FROM customer_demographics", "WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029411764705882353, "waitRatioMax": 0.0029411764705882353, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03235294117647059, "writeRatioMax": 0.03235294117647059 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.047058823529411764, "computeRatioMax": 0.047058823529411764, "endMs": "1665778795818", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.023529411764705882, "readRatioMax": 0.023529411764705882, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778795760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029411764705882353, "waitRatioMax": 0.0029411764705882353, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.08235294117647059, "writeRatioMax": 0.08235294117647059 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.28823529411764703, "computeRatioMax": 0.28823529411764703, "endMs": "1665778795884", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03235294117647059, "readRatioMax": 0.03235294117647059, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3545048", "shuffleOutputBytesSpilled": "0", "slotMs": "117", "startMs": "1665778795776", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029411764705882353, "waitRatioMax": 0.0029411764705882353, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04411764705882353, "writeRatioMax": 0.04411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03235294117647059, "computeRatioMax": 0.03235294117647059, "endMs": "1665778795846", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.026470588235294117, "readRatioMax": 0.026470588235294117, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778795796", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029411764705882353, "waitRatioMax": 0.0029411764705882353, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.05, "writeRatioMax": 0.05 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.029411764705882353, "endMs": "1665778795872", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.014705882352941176, "readRatioMax": 0.014705882352941176, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "386", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778795830", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029411764705882353, "waitRatioMax": 0.0029411764705882353, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.052941176470588235, "writeRatioMax": 0.052941176470588235 }, { "completedParallelInputs": "1", "computeMsAvg": "157", "computeMsMax": "157", "computeRatioAvg": 0.46176470588235297, "computeRatioMax": 0.46176470588235297, "endMs": "1665778796125", "id": "9", "inputStages": [ "6", "2", "0", "3", "1", "4" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.03529411764705882, "readRatioMax": 0.03529411764705882, "recordsRead": "360512", "recordsWritten": "1", "shuffleOutputBytes": "92", "shuffleOutputBytesSpilled": "0", "slotMs": "147", "startMs": "1665778796003", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171", "$80 := SUM($175)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $155, $171 := $156, $172 := $151, $173 := $152, $174 := $153, $175 := $154", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $11, $156 := $12", "INNER HASH JOIN EACH WITH ALL ON $130 = $10" ] }, { "kind": "JOIN", "substeps": [ "$130 := $124, $131 := $125, $132 := $120, $133 := $121, $134 := $122, $135 := $123", "INNER HASH JOIN EACH WITH ALL ON $126 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $110, $121 := $111, $122 := $112, $123 := $114, $124 := $21, $125 := $22, $126 := $23", "INNER HASH JOIN EACH WITH ALL ON $113 = $20" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $60" ] }, { "kind": "JOIN", "substeps": [ "$93 := $50, $94 := $51, $95 := $53, $90 := $41, $91 := $42, $92 := $43", "INNER HASH JOIN EACH WITH ALL ON $52 = $40" ] }, { "kind": "WRITE", "substeps": [ "$183, $184, $180, $181, $182, $80", "TO __stage09_output", "BY HASH($180, $181, $182, $183, $184)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029411764705882353, "waitRatioMax": 0.0029411764705882353, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.014705882352941176, "writeRatioMax": 0.014705882352941176 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.011764705882352941, "computeRatioMax": 0.011764705882352941, "endMs": "1665778796159", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665778796147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$183, $184, $180, $181, $182, $80", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184", "$70 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $70", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029411764705882353, "waitRatioMax": 0.0029411764705882353, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.014705882352941176, "writeRatioMax": 0.014705882352941176 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.023529411764705882, "computeRatioMax": 0.023529411764705882, "endMs": "1665778796212", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778796165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $70", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$70 DESC" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029411764705882353, "waitRatioMax": 0.0029411764705882353, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07647058823529412, "writeRatioMax": 0.07647058823529412 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "9", "elapsedMs": "640", "pendingUnits": "0", "totalSlotMs": "826" }, { "activeUnits": "0", "completedUnits": "9", "elapsedMs": "657", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "826" } ], "totalBytesBilled": "73400320", "totalBytesProcessed": "55225798", "totalPartitionsProcessed": "0", "totalSlotMs": "826", "transferredBytes": "0" }, "startTime": "1665778795584", "totalBytesProcessed": "55225798", "totalSlotMs": "826" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf130dffe_d172_464f_a996_bfb6ca216f71" }, "priority": "INTERACTIVE", "query": "-- start query 91 in stream 0 using template query91.tpl\n\n/*\nDisplay total returns of catalog sales by call center and manager in a particular month \nfor male customers of unknown education or female customers \nwith advanced degrees with a specified buy potential and from a particular time zone.\n*/\n\nselect \n cc_call_center_id Call_Center,\n cc_name Call_Center_Name,\n cc_manager Manager,\n sum(cr_net_loss) Returns_Loss\nfrom\n call_center,\n catalog_returns,\n date_dim,\n customer,\n customer_address,\n customer_demographics,\n household_demographics\nwhere\n cr_call_center_sk = cc_call_center_sk\nand cr_returned_date_sk = d_date_sk\nand cr_returning_customer_sk= c_customer_sk\nand cd_demo_sk = c_current_cdemo_sk\nand hd_demo_sk = c_current_hdemo_sk\nand ca_address_sk = c_current_addr_sk\nand d_year = 1998\nand d_moy = 11\nand ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')\n or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree'))\nand hd_buy_potential = 'Unknown'\nand ca_gmt_offset = -7\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;\n\n-- end query 91 in stream 0 using template query91.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "fb73MBY6s5ZOnTOigSSOtw==", "id": "test-project-364309:europe-west1.query91_1665778797", "jobReference": { "jobId": "query91_1665778797", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query91_1665778797?location=europe-west1", "statistics": { "creationTime": "1665778797877", "endTime": "1665778798628", "finalExecutionDurationMs": "476", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "55225798", "performanceInsights": { "avgPreviousExecutionMs": "481" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03571428571428571, "computeRatioMax": 0.03571428571428571, "endMs": "1665778798115", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03571428571428571, "readRatioMax": 0.03571428571428571, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778798081", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:hd_demo_sk, $2:hd_buy_potential", "FROM household_demographics", "WHERE equal($2, 'Unknown')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.031746031746031744, "writeRatioMax": 0.031746031746031744 }, { "completedParallelInputs": "1", "computeMsAvg": "252", "computeMsMax": "252", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778798254", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03968253968253968, "readRatioMax": 0.03968253968253968, "recordsRead": "1920800", "recordsWritten": "109760", "shuffleOutputBytes": "3402560", "shuffleOutputBytesSpilled": "0", "slotMs": "210", "startMs": "1665778798098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status", "FROM customer_demographics", "WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.03968253968253968, "writeRatioMax": 0.03968253968253968 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.051587301587301584, "computeRatioMax": 0.051587301587301584, "endMs": "1665778798157", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03968253968253968, "readRatioMax": 0.03968253968253968, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778798112", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.03968253968253968, "writeRatioMax": 0.03968253968253968 }, { "completedParallelInputs": "1", "computeMsAvg": "91", "computeMsMax": "91", "computeRatioAvg": 0.3611111111111111, "computeRatioMax": 0.3611111111111111, "endMs": "1665778798231", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.047619047619047616, "readRatioMax": 0.047619047619047616, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3545048", "shuffleOutputBytesSpilled": "0", "slotMs": "135", "startMs": "1665778798129", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06349206349206349, "writeRatioMax": 0.06349206349206349 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.051587301587301584, "computeRatioMax": 0.051587301587301584, "endMs": "1665778798199", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.023809523809523808, "readRatioMax": 0.023809523809523808, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778798156", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007936507936507936, "waitRatioMax": 0.007936507936507936, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06746031746031746, "writeRatioMax": 0.06746031746031746 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.031746031746031744, "computeRatioMax": 0.031746031746031744, "endMs": "1665778798231", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01984126984126984, "readRatioMax": 0.01984126984126984, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "386", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778798189", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06746031746031746, "writeRatioMax": 0.06746031746031746 }, { "completedParallelInputs": "1", "computeMsAvg": "208", "computeMsMax": "208", "computeRatioAvg": 0.8253968253968254, "computeRatioMax": 0.8253968253968254, "endMs": "1665778798425", "id": "8", "inputStages": [ "2", "6", "0", "4", "3", "1" ], "name": "S08: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.06746031746031746, "readRatioMax": 0.06746031746031746, "recordsRead": "360512", "recordsWritten": "1", "shuffleOutputBytes": "92", "shuffleOutputBytesSpilled": "0", "slotMs": "194", "startMs": "1665778798279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171", "$80 := SUM($175)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $155, $171 := $156, $172 := $151, $173 := $152, $174 := $153, $175 := $154", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $11, $156 := $12", "INNER HASH JOIN EACH WITH ALL ON $130 = $10" ] }, { "kind": "JOIN", "substeps": [ "$130 := $124, $131 := $125, $132 := $120, $133 := $121, $134 := $122, $135 := $123", "INNER HASH JOIN EACH WITH ALL ON $126 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $110, $121 := $111, $122 := $112, $123 := $114, $124 := $21, $125 := $22, $126 := $23", "INNER HASH JOIN EACH WITH ALL ON $113 = $20" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $60" ] }, { "kind": "JOIN", "substeps": [ "$93 := $50, $94 := $51, $95 := $53, $90 := $41, $91 := $42, $92 := $43", "INNER HASH JOIN EACH WITH ALL ON $52 = $40" ] }, { "kind": "WRITE", "substeps": [ "$183, $184, $180, $181, $182, $80", "TO __stage08_output", "BY HASH($180, $181, $182, $183, $184)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01984126984126984, "writeRatioMax": 0.01984126984126984 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.027777777777777776, "computeRatioMax": 0.027777777777777776, "endMs": "1665778798485", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665778798471", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$183, $184, $180, $181, $182, $80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184", "$70 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $70", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.011904761904761904, "waitRatioMax": 0.011904761904761904, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.015873015873015872, "writeRatioMax": 0.015873015873015872 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04365079365079365, "computeRatioMax": 0.04365079365079365, "endMs": "1665778798532", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778798491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $70", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$70 DESC" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007936507936507936, "waitRatioMax": 0.007936507936507936, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05555555555555555, "writeRatioMax": 0.05555555555555555 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "9", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "766" } ], "totalBytesBilled": "73400320", "totalBytesProcessed": "55225798", "totalPartitionsProcessed": "0", "totalSlotMs": "766", "transferredBytes": "0" }, "startTime": "1665778797949", "totalBytesProcessed": "55225798", "totalSlotMs": "766" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncaa0a590_b905_4b2d_9006_8ba49b21e42d" }, "priority": "INTERACTIVE", "query": "-- start query 91 in stream 0 using template query91.tpl\n\n/*\nDisplay total returns of catalog sales by call center and manager in a particular month \nfor male customers of unknown education or female customers \nwith advanced degrees with a specified buy potential and from a particular time zone.\n*/\n\nselect \n cc_call_center_id Call_Center,\n cc_name Call_Center_Name,\n cc_manager Manager,\n sum(cr_net_loss) Returns_Loss\nfrom\n call_center,\n catalog_returns,\n date_dim,\n customer,\n customer_address,\n customer_demographics,\n household_demographics\nwhere\n cr_call_center_sk = cc_call_center_sk\nand cr_returned_date_sk = d_date_sk\nand cr_returning_customer_sk= c_customer_sk\nand cd_demo_sk = c_current_cdemo_sk\nand hd_demo_sk = c_current_hdemo_sk\nand ca_address_sk = c_current_addr_sk\nand d_year = 1998\nand d_moy = 11\nand ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')\n or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree'))\nand hd_buy_potential = 'Unknown'\nand ca_gmt_offset = -7\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;\n\n-- end query 91 in stream 0 using template query91.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "e2SgbfDpucCc+e1bdNRr7Q==", "id": "test-project-364309:europe-west1.query91_1665778799", "jobReference": { "jobId": "query91_1665778799", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query91_1665778799?location=europe-west1", "statistics": { "creationTime": "1665778800300", "endTime": "1665778801006", "finalExecutionDurationMs": "468", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "55225798", "performanceInsights": { "avgPreviousExecutionMs": "480" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.043137254901960784, "computeRatioMax": 0.043137254901960784, "endMs": "1665778800540", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0196078431372549, "readRatioMax": 0.0196078431372549, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778800496", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:hd_demo_sk, $2:hd_buy_potential", "FROM household_demographics", "WHERE equal($2, 'Unknown')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00784313725490196, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.07450980392156863, "writeRatioMax": 0.07450980392156863 }, { "completedParallelInputs": "1", "computeMsAvg": "255", "computeMsMax": "255", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778800688", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0392156862745098, "readRatioMax": 0.0392156862745098, "recordsRead": "1920800", "recordsWritten": "109760", "shuffleOutputBytes": "3402560", "shuffleOutputBytesSpilled": "0", "slotMs": "222", "startMs": "1665778800516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status", "FROM customer_demographics", "WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.050980392156862744, "writeRatioMax": 0.050980392156862744 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0392156862745098, "computeRatioMax": 0.0392156862745098, "endMs": "1665778800569", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01568627450980392, "readRatioMax": 0.01568627450980392, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778800533", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.050980392156862744, "writeRatioMax": 0.050980392156862744 }, { "completedParallelInputs": "1", "computeMsAvg": "102", "computeMsMax": "102", "computeRatioAvg": 0.4, "computeRatioMax": 0.4, "endMs": "1665778800634", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0392156862745098, "readRatioMax": 0.0392156862745098, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3545048", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665778800549", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.043137254901960784, "writeRatioMax": 0.043137254901960784 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.023529411764705882, "computeRatioMax": 0.023529411764705882, "endMs": "1665778800606", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0196078431372549, "readRatioMax": 0.0196078431372549, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778800567", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00784313725490196, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.050980392156862744, "computeRatioMax": 0.050980392156862744, "endMs": "1665778800638", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.023529411764705882, "readRatioMax": 0.023529411764705882, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "386", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778800603", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00784313725490196, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07058823529411765, "writeRatioMax": 0.07058823529411765 }, { "completedParallelInputs": "1", "computeMsAvg": "188", "computeMsMax": "188", "computeRatioAvg": 0.7372549019607844, "computeRatioMax": 0.7372549019607844, "endMs": "1665778800829", "id": "8", "inputStages": [ "3", "1", "0", "2", "4", "6" ], "name": "S08: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.050980392156862744, "readRatioMax": 0.050980392156862744, "recordsRead": "360512", "recordsWritten": "1", "shuffleOutputBytes": "92", "shuffleOutputBytesSpilled": "0", "slotMs": "159", "startMs": "1665778800702", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171", "$80 := SUM($175)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $155, $171 := $156, $172 := $151, $173 := $152, $174 := $153, $175 := $154", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $11, $156 := $12", "INNER HASH JOIN EACH WITH ALL ON $130 = $10" ] }, { "kind": "JOIN", "substeps": [ "$130 := $124, $131 := $125, $132 := $120, $133 := $121, $134 := $122, $135 := $123", "INNER HASH JOIN EACH WITH ALL ON $126 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $110, $121 := $111, $122 := $112, $123 := $114, $124 := $21, $125 := $22, $126 := $23", "INNER HASH JOIN EACH WITH ALL ON $113 = $20" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $60" ] }, { "kind": "JOIN", "substeps": [ "$93 := $50, $94 := $51, $95 := $53, $90 := $41, $91 := $42, $92 := $43", "INNER HASH JOIN EACH WITH ALL ON $52 = $40" ] }, { "kind": "WRITE", "substeps": [ "$183, $184, $180, $181, $182, $80", "TO __stage08_output", "BY HASH($180, $181, $182, $183, $184)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01568627450980392, "writeRatioMax": 0.01568627450980392 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0196078431372549, "computeRatioMax": 0.0196078431372549, "endMs": "1665778800873", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665778800861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$183, $184, $180, $181, $182, $80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184", "$70 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $70", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01568627450980392, "writeRatioMax": 0.01568627450980392 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03529411764705882, "computeRatioMax": 0.03529411764705882, "endMs": "1665778800931", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778800882", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $70", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$70 DESC" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00784313725490196, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.10196078431372549, "writeRatioMax": 0.10196078431372549 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "9", "elapsedMs": "602", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "657" } ], "totalBytesBilled": "73400320", "totalBytesProcessed": "55225798", "totalPartitionsProcessed": "0", "totalSlotMs": "657", "transferredBytes": "0" }, "startTime": "1665778800357", "totalBytesProcessed": "55225798", "totalSlotMs": "657" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3efb6c29_4a12_48f8_9804_d3109f98b426" }, "priority": "INTERACTIVE", "query": "-- start query 91 in stream 0 using template query91.tpl\n\n/*\nDisplay total returns of catalog sales by call center and manager in a particular month \nfor male customers of unknown education or female customers \nwith advanced degrees with a specified buy potential and from a particular time zone.\n*/\n\nselect \n cc_call_center_id Call_Center,\n cc_name Call_Center_Name,\n cc_manager Manager,\n sum(cr_net_loss) Returns_Loss\nfrom\n call_center,\n catalog_returns,\n date_dim,\n customer,\n customer_address,\n customer_demographics,\n household_demographics\nwhere\n cr_call_center_sk = cc_call_center_sk\nand cr_returned_date_sk = d_date_sk\nand cr_returning_customer_sk= c_customer_sk\nand cd_demo_sk = c_current_cdemo_sk\nand hd_demo_sk = c_current_hdemo_sk\nand ca_address_sk = c_current_addr_sk\nand d_year = 1998\nand d_moy = 11\nand ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')\n or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree'))\nand hd_buy_potential = 'Unknown'\nand ca_gmt_offset = -7\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;\n\n-- end query 91 in stream 0 using template query91.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "xWzwHUYryXcai9IRT4LjNA==", "id": "test-project-364309:europe-west1.query91_1665778802", "jobReference": { "jobId": "query91_1665778802", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query91_1665778802?location=europe-west1", "statistics": { "creationTime": "1665778802690", "endTime": "1665778803409", "finalExecutionDurationMs": "493", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "55225798", "performanceInsights": { "avgPreviousExecutionMs": "478" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03125, "computeRatioMax": 0.03125, "endMs": "1665778802902", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778802867", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:hd_demo_sk, $2:hd_buy_potential", "FROM household_demographics", "WHERE equal($2, 'Unknown')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02734375, "writeRatioMax": 0.02734375 }, { "completedParallelInputs": "1", "computeMsAvg": "256", "computeMsMax": "256", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778803057", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.05078125, "readRatioMax": 0.05078125, "recordsRead": "1920800", "recordsWritten": "109760", "shuffleOutputBytes": "3402560", "shuffleOutputBytesSpilled": "0", "slotMs": "239", "startMs": "1665778802884", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status", "FROM customer_demographics", "WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.046875, "writeRatioMax": 0.046875 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0390625, "computeRatioMax": 0.0390625, "endMs": "1665778802944", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01953125, "readRatioMax": 0.01953125, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778802901", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06640625, "writeRatioMax": 0.06640625 }, { "completedParallelInputs": "1", "computeMsAvg": "108", "computeMsMax": "108", "computeRatioAvg": 0.421875, "computeRatioMax": 0.421875, "endMs": "1665778803037", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0390625, "readRatioMax": 0.0390625, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3545048", "shuffleOutputBytesSpilled": "0", "slotMs": "95", "startMs": "1665778802937", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage03_output" ] } ], "waitMsAvg": "21", "waitMsMax": "21", "waitRatioAvg": 0.08203125, "waitRatioMax": 0.08203125, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05078125, "writeRatioMax": 0.05078125 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0546875, "computeRatioMax": 0.0546875, "endMs": "1665778802977", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03515625, "readRatioMax": 0.03515625, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778802940", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.03125, "waitRatioMax": 0.03125, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06640625, "writeRatioMax": 0.06640625 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03515625, "computeRatioMax": 0.03515625, "endMs": "1665778803002", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01953125, "readRatioMax": 0.01953125, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "386", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778802962", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.10546875, "writeRatioMax": 0.10546875 }, { "completedParallelInputs": "1", "computeMsAvg": "233", "computeMsMax": "233", "computeRatioAvg": 0.91015625, "computeRatioMax": 0.91015625, "endMs": "1665778803247", "id": "9", "inputStages": [ "0", "3", "1", "6", "2", "4" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.0703125, "readRatioMax": 0.0703125, "recordsRead": "360512", "recordsWritten": "1", "shuffleOutputBytes": "92", "shuffleOutputBytesSpilled": "0", "slotMs": "212", "startMs": "1665778803083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171", "$80 := SUM($175)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $155, $171 := $156, $172 := $151, $173 := $152, $174 := $153, $175 := $154", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $11, $156 := $12", "INNER HASH JOIN EACH WITH ALL ON $130 = $10" ] }, { "kind": "JOIN", "substeps": [ "$130 := $124, $131 := $125, $132 := $120, $133 := $121, $134 := $122, $135 := $123", "INNER HASH JOIN EACH WITH ALL ON $126 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $110, $121 := $111, $122 := $112, $123 := $114, $124 := $21, $125 := $22, $126 := $23", "INNER HASH JOIN EACH WITH ALL ON $113 = $20" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $60" ] }, { "kind": "JOIN", "substeps": [ "$93 := $50, $94 := $51, $95 := $53, $90 := $41, $91 := $42, $92 := $43", "INNER HASH JOIN EACH WITH ALL ON $52 = $40" ] }, { "kind": "WRITE", "substeps": [ "$183, $184, $180, $181, $182, $80", "TO __stage09_output", "BY HASH($180, $181, $182, $183, $184)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01953125, "writeRatioMax": 0.01953125 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03125, "computeRatioMax": 0.03125, "endMs": "1665778803287", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665778803274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$183, $184, $180, $181, $182, $80", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184", "$70 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $70", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.0078125, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.015625, "writeRatioMax": 0.015625 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03125, "computeRatioMax": 0.03125, "endMs": "1665778803335", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778803294", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $70", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$70 DESC" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0703125, "writeRatioMax": 0.0703125 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "9", "elapsedMs": "624", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "741" } ], "totalBytesBilled": "73400320", "totalBytesProcessed": "55225798", "totalPartitionsProcessed": "0", "totalSlotMs": "741", "transferredBytes": "0" }, "startTime": "1665778802741", "totalBytesProcessed": "55225798", "totalSlotMs": "741" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon39c1a395_73f5_40f4_881a_a579a6e164ad" }, "priority": "INTERACTIVE", "query": "-- start query 91 in stream 0 using template query91.tpl\n\n/*\nDisplay total returns of catalog sales by call center and manager in a particular month \nfor male customers of unknown education or female customers \nwith advanced degrees with a specified buy potential and from a particular time zone.\n*/\n\nselect \n cc_call_center_id Call_Center,\n cc_name Call_Center_Name,\n cc_manager Manager,\n sum(cr_net_loss) Returns_Loss\nfrom\n call_center,\n catalog_returns,\n date_dim,\n customer,\n customer_address,\n customer_demographics,\n household_demographics\nwhere\n cr_call_center_sk = cc_call_center_sk\nand cr_returned_date_sk = d_date_sk\nand cr_returning_customer_sk= c_customer_sk\nand cd_demo_sk = c_current_cdemo_sk\nand hd_demo_sk = c_current_hdemo_sk\nand ca_address_sk = c_current_addr_sk\nand d_year = 1998\nand d_moy = 11\nand ( (cd_marital_status = 'M' and cd_education_status = 'Unknown')\n or(cd_marital_status = 'W' and cd_education_status = 'Advanced Degree'))\nand hd_buy_potential = 'Unknown'\nand ca_gmt_offset = -7\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;\n\n-- end query 91 in stream 0 using template query91.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "u22pJmBvUcxecLXFZMYJCw==", "id": "test-project-364309:europe-west1.query91_1665778804", "jobReference": { "jobId": "query91_1665778804", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query91_1665778804?location=europe-west1", "statistics": { "creationTime": "1665778804973", "endTime": "1665778805713", "finalExecutionDurationMs": "501", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "55225798", "performanceInsights": { "avgPreviousExecutionMs": "480" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02557544757033248, "computeRatioMax": 0.02557544757033248, "endMs": "1665778805222", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015345268542199489, "readRatioMax": 0.015345268542199489, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778805176", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:hd_demo_sk, $2:hd_buy_potential", "FROM household_demographics", "WHERE equal($2, 'Unknown')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025575447570332483, "waitRatioMax": 0.0025575447570332483, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.05115089514066496, "writeRatioMax": 0.05115089514066496 }, { "completedParallelInputs": "1", "computeMsAvg": "391", "computeMsMax": "391", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778805366", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.030690537084398978, "readRatioMax": 0.030690537084398978, "recordsRead": "1920800", "recordsWritten": "109760", "shuffleOutputBytes": "3402560", "shuffleOutputBytesSpilled": "0", "slotMs": "332", "startMs": "1665778805195", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status", "FROM customer_demographics", "WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005115089514066497, "waitRatioMax": 0.005115089514066497, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.023017902813299233, "writeRatioMax": 0.023017902813299233 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04859335038363171, "computeRatioMax": 0.04859335038363171, "endMs": "1665778805246", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.028132992327365727, "readRatioMax": 0.028132992327365727, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778805209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025575447570332483, "waitRatioMax": 0.0025575447570332483, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.028132992327365727, "writeRatioMax": 0.028132992327365727 }, { "completedParallelInputs": "1", "computeMsAvg": "97", "computeMsMax": "97", "computeRatioAvg": 0.24808184143222506, "computeRatioMax": 0.24808184143222506, "endMs": "1665778805308", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015345268542199489, "readRatioMax": 0.015345268542199489, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3545048", "shuffleOutputBytesSpilled": "0", "slotMs": "118", "startMs": "1665778805223", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025575447570332483, "waitRatioMax": 0.0025575447570332483, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.028132992327365727, "writeRatioMax": 0.028132992327365727 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03580562659846547, "computeRatioMax": 0.03580562659846547, "endMs": "1665778805281", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.023017902813299233, "readRatioMax": 0.023017902813299233, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778805239", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005115089514066497, "waitRatioMax": 0.005115089514066497, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.028132992327365727, "writeRatioMax": 0.028132992327365727 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015345268542199489, "computeRatioMax": 0.015345268542199489, "endMs": "1665778805310", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.010230179028132993, "readRatioMax": 0.010230179028132993, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "386", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778805270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025575447570332483, "waitRatioMax": 0.0025575447570332483, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.04092071611253197, "writeRatioMax": 0.04092071611253197 }, { "completedParallelInputs": "1", "computeMsAvg": "244", "computeMsMax": "244", "computeRatioAvg": 0.6240409207161125, "computeRatioMax": 0.6240409207161125, "endMs": "1665778805563", "id": "8", "inputStages": [ "3", "2", "1", "4", "6", "0" ], "name": "S08: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03580562659846547, "readRatioMax": 0.03580562659846547, "recordsRead": "360512", "recordsWritten": "1", "shuffleOutputBytes": "92", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665778805399", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171", "$80 := SUM($175)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $155, $171 := $156, $172 := $151, $173 := $152, $174 := $153, $175 := $154", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $11, $156 := $12", "INNER HASH JOIN EACH WITH ALL ON $130 = $10" ] }, { "kind": "JOIN", "substeps": [ "$130 := $124, $131 := $125, $132 := $120, $133 := $121, $134 := $122, $135 := $123", "INNER HASH JOIN EACH WITH ALL ON $126 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $110, $121 := $111, $122 := $112, $123 := $114, $124 := $21, $125 := $22, $126 := $23", "INNER HASH JOIN EACH WITH ALL ON $113 = $20" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $60" ] }, { "kind": "JOIN", "substeps": [ "$93 := $50, $94 := $51, $95 := $53, $90 := $41, $91 := $42, $92 := $43", "INNER HASH JOIN EACH WITH ALL ON $52 = $40" ] }, { "kind": "WRITE", "substeps": [ "$183, $184, $180, $181, $182, $80", "TO __stage08_output", "BY HASH($180, $181, $182, $183, $184)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005115089514066497, "waitRatioMax": 0.005115089514066497, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01278772378516624, "writeRatioMax": 0.01278772378516624 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015345268542199489, "computeRatioMax": 0.015345268542199489, "endMs": "1665778805595", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665778805584", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$183, $184, $180, $181, $182, $80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184", "$70 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $70", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005115089514066497, "waitRatioMax": 0.005115089514066497, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0076726342710997444, "writeRatioMax": 0.0076726342710997444 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.020460358056265986, "computeRatioMax": 0.020460358056265986, "endMs": "1665778805645", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "74", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778805607", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $70", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$70 DESC" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005115089514066497, "waitRatioMax": 0.005115089514066497, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03836317135549872, "writeRatioMax": 0.03836317135549872 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "9", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "900" } ], "totalBytesBilled": "73400320", "totalBytesProcessed": "55225798", "totalPartitionsProcessed": "0", "totalSlotMs": "900", "transferredBytes": "0" }, "startTime": "1665778805038", "totalBytesProcessed": "55225798", "totalSlotMs": "900" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
