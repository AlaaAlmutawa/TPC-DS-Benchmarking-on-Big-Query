{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anondf530fb0_2017_4e33_b896_968c08bb9237" }, "priority": "INTERACTIVE", "query": "-- start query 43 in stream 0 using template query43.tpl\n\n/*\nReport the sum of all sales from Sunday to Saturday for stores in a given data range by stores.\n*/\n\nselect s_store_name, s_store_id,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from date_dim, store_sales, store\n where d_date_sk = ss_sold_date_sk and\n s_store_sk = ss_store_sk and\n s_gmt_offset = -5 and\n d_year = 2000 \n group by s_store_name, s_store_id\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\n limit 100\n ;\n\n-- end query 43 in stream 0 using template query43.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "tKbQDf4UyLWpo1WEsluyxw==", "id": "test-project-364309:europe-west1.query43_1665768354", "jobReference": { "jobId": "query43_1665768354", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query43_1665768354?location=europe-west1", "statistics": { "creationTime": "1665768354976", "endTime": "1665768355502", "finalExecutionDurationMs": "345", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89854496", "performanceInsights": { "avgPreviousExecutionMs": "286" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.051643192488262914, "computeRatioMax": 0.051643192488262914, "endMs": "1665768355152", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.023474178403755867, "readRatioMax": 0.023474178403755867, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768355118", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset", "FROM store", "WHERE equal($13, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03755868544600939, "writeRatioMax": 0.03755868544600939 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04225352112676056, "computeRatioMax": 0.04225352112676056, "endMs": "1665768355186", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.023474178403755867, "readRatioMax": 0.023474178403755867, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "7738", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768355147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_day_name, $21:d_year", "FROM date_dim", "WHERE equal($21, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06572769953051644, "writeRatioMax": 0.06572769953051644 }, { "completedParallelInputs": "6", "computeMsAvg": "182", "computeMsMax": "213", "computeRatioAvg": 0.8544600938967136, "computeRatioMax": 1, "endMs": "1665768355348", "id": "3", "inputStages": [ "2", "0" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "17", "readRatioAvg": 0.046948356807511735, "readRatioMax": 0.07981220657276995, "recordsRead": "2882672", "recordsWritten": "36", "shuffleOutputBytes": "5364", "shuffleOutputBytesSpilled": "0", "slotMs": "1135", "startMs": "1665768355198", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $83, $91 := $82", "$40 := SUM($56)", "$41 := SUM($55)", "$42 := SUM($54)", "$43 := SUM($53)", "$44 := SUM($52)", "$45 := SUM($51)", "$46 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)", "$51 := case_no_value(equal($81, 'Friday'), $80, NULL)", "$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)", "$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)", "$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)", "$55 := case_no_value(equal($81, 'Monday'), $80, NULL)", "$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$80 := $72, $81 := $70, $82 := $11, $83 := $12", "INNER HASH JOIN EACH WITH ALL ON $71 = $10" ] }, { "kind": "JOIN", "substeps": [ "$71 := $2, $72 := $3, $70 := $22", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "TO __stage03_output", "BY HASH($90, $91)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.009389671361502348, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.023474178403755867, "writeRatioMax": 0.028169014084507043 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03286384976525822, "computeRatioMax": 0.03286384976525822, "endMs": "1665768355366", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665768355355", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90, $101 := $91", "$30 := SUM($40)", "$31 := SUM($41)", "$32 := SUM($42)", "$33 := SUM($43)", "$34 := SUM($44)", "$35 := SUM($45)", "$36 := SUM($46)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009389671361502348, "waitRatioMax": 0.009389671361502348, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03286384976525822, "computeRatioMax": 0.03286384976525822, "endMs": "1665768355425", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768355369", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.004694835680751174, "writeMsAvg": "48", "writeMsMax": "48", "writeRatioAvg": 0.22535211267605634, "writeRatioMax": 0.22535211267605634 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "10", "elapsedMs": "442", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1315" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89854496", "totalPartitionsProcessed": "0", "totalSlotMs": "1315", "transferredBytes": "0" }, "startTime": "1665768355020", "totalBytesProcessed": "89854496", "totalSlotMs": "1315" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon65c25b0d_54a3_4807_bb65_5d48cb0a2344" }, "priority": "INTERACTIVE", "query": "-- start query 43 in stream 0 using template query43.tpl\n\n/*\nReport the sum of all sales from Sunday to Saturday for stores in a given data range by stores.\n*/\n\nselect s_store_name, s_store_id,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from date_dim, store_sales, store\n where d_date_sk = ss_sold_date_sk and\n s_store_sk = ss_store_sk and\n s_gmt_offset = -5 and\n d_year = 2000 \n group by s_store_name, s_store_id\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\n limit 100\n ;\n\n-- end query 43 in stream 0 using template query43.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "G3ysqYe3/UMBqf6N+xG1gA==", "id": "test-project-364309:europe-west1.query43_1665777460", "jobReference": { "jobId": "query43_1665777460", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query43_1665777460?location=europe-west1", "statistics": { "creationTime": "1665777462010", "endTime": "1665777462562", "finalExecutionDurationMs": "286", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89854496", "performanceInsights": { "avgPreviousExecutionMs": "301" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03773584905660377, "computeRatioMax": 0.03773584905660377, "endMs": "1665777462183", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02830188679245283, "readRatioMax": 0.02830188679245283, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777462153", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset", "FROM store", "WHERE equal($13, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.08490566037735849, "writeRatioMax": 0.08490566037735849 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0660377358490566, "computeRatioMax": 0.0660377358490566, "endMs": "1665777462212", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.05660377358490566, "readRatioMax": 0.05660377358490566, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "7738", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777462179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_day_name, $21:d_year", "FROM date_dim", "WHERE equal($21, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04245283018867924, "writeRatioMax": 0.04245283018867924 }, { "completedParallelInputs": "6", "computeMsAvg": "173", "computeMsMax": "212", "computeRatioAvg": 0.8160377358490566, "computeRatioMax": 1, "endMs": "1665777462352", "id": "3", "inputStages": [ "0", "2" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.04716981132075472, "readRatioMax": 0.05660377358490566, "recordsRead": "2882672", "recordsWritten": "36", "shuffleOutputBytes": "5364", "shuffleOutputBytesSpilled": "0", "slotMs": "854", "startMs": "1665777462228", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $83, $91 := $82", "$40 := SUM($56)", "$41 := SUM($55)", "$42 := SUM($54)", "$43 := SUM($53)", "$44 := SUM($52)", "$45 := SUM($51)", "$46 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)", "$51 := case_no_value(equal($81, 'Friday'), $80, NULL)", "$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)", "$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)", "$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)", "$55 := case_no_value(equal($81, 'Monday'), $80, NULL)", "$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$80 := $72, $81 := $70, $82 := $11, $83 := $12", "INNER HASH JOIN EACH WITH ALL ON $71 = $10" ] }, { "kind": "JOIN", "substeps": [ "$71 := $2, $72 := $3, $70 := $22", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "TO __stage03_output", "BY HASH($90, $91)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "3", "writeMsMax": "4", "writeRatioAvg": 0.014150943396226415, "writeRatioMax": 0.018867924528301886 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0330188679245283, "computeRatioMax": 0.0330188679245283, "endMs": "1665777462369", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665777462357", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90, $101 := $91", "$30 := SUM($40)", "$31 := SUM($41)", "$32 := SUM($42)", "$33 := SUM($43)", "$34 := SUM($44)", "$35 := SUM($45)", "$36 := SUM($46)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0047169811320754715, "writeRatioMax": 0.0047169811320754715 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0660377358490566, "computeRatioMax": 0.0660377358490566, "endMs": "1665777462407", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777462370", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07075471698113207, "writeRatioMax": 0.07075471698113207 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "10", "elapsedMs": "450", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "971" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89854496", "totalPartitionsProcessed": "0", "totalSlotMs": "971", "transferredBytes": "0" }, "startTime": "1665777462062", "totalBytesProcessed": "89854496", "totalSlotMs": "971" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6256359f_1a9d_41e2_829b_f523b8e7f944" }, "priority": "INTERACTIVE", "query": "-- start query 43 in stream 0 using template query43.tpl\n\n/*\nReport the sum of all sales from Sunday to Saturday for stores in a given data range by stores.\n*/\n\nselect s_store_name, s_store_id,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from date_dim, store_sales, store\n where d_date_sk = ss_sold_date_sk and\n s_store_sk = ss_store_sk and\n s_gmt_offset = -5 and\n d_year = 2000 \n group by s_store_name, s_store_id\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\n limit 100\n ;\n\n-- end query 43 in stream 0 using template query43.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "IUBEQGN0Y90/UCS9Plicaw==", "id": "test-project-364309:europe-west1.query43_1665777463", "jobReference": { "jobId": "query43_1665777463", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query43_1665777463?location=europe-west1", "statistics": { "creationTime": "1665777464171", "endTime": "1665777464751", "finalExecutionDurationMs": "320", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89854496", "performanceInsights": { "avgPreviousExecutionMs": "298" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0673076923076923, "computeRatioMax": 0.0673076923076923, "endMs": "1665777464357", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.028846153846153848, "readRatioMax": 0.028846153846153848, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777464320", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset", "FROM store", "WHERE equal($13, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.09615384615384616, "writeRatioMax": 0.09615384615384616 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04807692307692308, "computeRatioMax": 0.04807692307692308, "endMs": "1665777464393", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02403846153846154, "readRatioMax": 0.02403846153846154, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "7738", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777464352", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_day_name, $21:d_year", "FROM date_dim", "WHERE equal($21, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07692307692307693, "writeRatioMax": 0.07692307692307693 }, { "completedParallelInputs": "6", "computeMsAvg": "172", "computeMsMax": "208", "computeRatioAvg": 0.8269230769230769, "computeRatioMax": 1, "endMs": "1665777464528", "id": "3", "inputStages": [ "2", "0" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "23", "readRatioAvg": 0.052884615384615384, "readRatioMax": 0.11057692307692307, "recordsRead": "2882672", "recordsWritten": "36", "shuffleOutputBytes": "5364", "shuffleOutputBytesSpilled": "0", "slotMs": "857", "startMs": "1665777464407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $83, $91 := $82", "$40 := SUM($56)", "$41 := SUM($55)", "$42 := SUM($54)", "$43 := SUM($53)", "$44 := SUM($52)", "$45 := SUM($51)", "$46 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)", "$51 := case_no_value(equal($81, 'Friday'), $80, NULL)", "$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)", "$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)", "$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)", "$55 := case_no_value(equal($81, 'Monday'), $80, NULL)", "$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$80 := $72, $81 := $70, $82 := $11, $83 := $12", "INNER HASH JOIN EACH WITH ALL ON $71 = $10" ] }, { "kind": "JOIN", "substeps": [ "$71 := $2, $72 := $3, $70 := $22", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "TO __stage03_output", "BY HASH($90, $91)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.02403846153846154, "writeRatioMax": 0.03365384615384615 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.02403846153846154, "computeRatioMax": 0.02403846153846154, "endMs": "1665777464548", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665777464538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90, $101 := $91", "$30 := SUM($40)", "$31 := SUM($41)", "$32 := SUM($42)", "$33 := SUM($43)", "$34 := SUM($44)", "$35 := SUM($45)", "$36 := SUM($46)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.004807692307692308, "writeRatioMax": 0.004807692307692308 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0673076923076923, "computeRatioMax": 0.0673076923076923, "endMs": "1665777464608", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777464557", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004807692307692308, "waitRatioMax": 0.004807692307692308, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.12980769230769232, "writeRatioMax": 0.12980769230769232 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "10", "elapsedMs": "462", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "987" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89854496", "totalPartitionsProcessed": "0", "totalSlotMs": "987", "transferredBytes": "0" }, "startTime": "1665777464223", "totalBytesProcessed": "89854496", "totalSlotMs": "987" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon14b6d341_3e02_410c_8bc7_3f5825a57563" }, "priority": "INTERACTIVE", "query": "-- start query 43 in stream 0 using template query43.tpl\n\n/*\nReport the sum of all sales from Sunday to Saturday for stores in a given data range by stores.\n*/\n\nselect s_store_name, s_store_id,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from date_dim, store_sales, store\n where d_date_sk = ss_sold_date_sk and\n s_store_sk = ss_store_sk and\n s_gmt_offset = -5 and\n d_year = 2000 \n group by s_store_name, s_store_id\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\n limit 100\n ;\n\n-- end query 43 in stream 0 using template query43.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "WcqdyHvvoDPQRXgsqahOGA==", "id": "test-project-364309:europe-west1.query43_1665777465", "jobReference": { "jobId": "query43_1665777465", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query43_1665777465?location=europe-west1", "statistics": { "creationTime": "1665777466464", "endTime": "1665777467048", "finalExecutionDurationMs": "318", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89854496", "performanceInsights": { "avgPreviousExecutionMs": "302" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.11904761904761904, "computeRatioMax": 0.11904761904761904, "endMs": "1665777466674", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0380952380952381, "readRatioMax": 0.0380952380952381, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777466624", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset", "FROM store", "WHERE equal($13, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009523809523809525, "waitRatioMax": 0.009523809523809525, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05714285714285714, "writeRatioMax": 0.05714285714285714 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.05714285714285714, "endMs": "1665777466690", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02857142857142857, "readRatioMax": 0.02857142857142857, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "7738", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777466657", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_day_name, $21:d_year", "FROM date_dim", "WHERE equal($21, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004761904761904762, "waitRatioMax": 0.004761904761904762, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03333333333333333, "writeRatioMax": 0.03333333333333333 }, { "completedParallelInputs": "6", "computeMsAvg": "176", "computeMsMax": "210", "computeRatioAvg": 0.8380952380952381, "computeRatioMax": 1, "endMs": "1665777466833", "id": "3", "inputStages": [ "0", "2" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.047619047619047616, "readRatioMax": 0.06190476190476191, "recordsRead": "2882672", "recordsWritten": "36", "shuffleOutputBytes": "5364", "shuffleOutputBytesSpilled": "0", "slotMs": "855", "startMs": "1665777466708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $83, $91 := $82", "$40 := SUM($56)", "$41 := SUM($55)", "$42 := SUM($54)", "$43 := SUM($53)", "$44 := SUM($52)", "$45 := SUM($51)", "$46 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)", "$51 := case_no_value(equal($81, 'Friday'), $80, NULL)", "$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)", "$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)", "$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)", "$55 := case_no_value(equal($81, 'Monday'), $80, NULL)", "$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$80 := $72, $81 := $70, $82 := $11, $83 := $12", "INNER HASH JOIN EACH WITH ALL ON $71 = $10" ] }, { "kind": "JOIN", "substeps": [ "$71 := $2, $72 := $3, $70 := $22", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "TO __stage03_output", "BY HASH($90, $91)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009523809523809525, "waitRatioMax": 0.009523809523809525, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.01904761904761905, "writeRatioMax": 0.023809523809523808 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.023809523809523808, "computeRatioMax": 0.023809523809523808, "endMs": "1665777466856", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665777466844", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90, $101 := $91", "$30 := SUM($40)", "$31 := SUM($41)", "$32 := SUM($42)", "$33 := SUM($43)", "$34 := SUM($44)", "$35 := SUM($45)", "$36 := SUM($46)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004761904761904762, "waitRatioMax": 0.004761904761904762, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.004761904761904762, "writeRatioMax": 0.004761904761904762 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.11428571428571428, "computeRatioMax": 0.11428571428571428, "endMs": "1665777466905", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777466861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009523809523809525, "waitRatioMax": 0.009523809523809525, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05238095238095238, "writeRatioMax": 0.05238095238095238 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "10", "elapsedMs": "474", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1000" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89854496", "totalPartitionsProcessed": "0", "totalSlotMs": "1000", "transferredBytes": "0" }, "startTime": "1665777466521", "totalBytesProcessed": "89854496", "totalSlotMs": "1000" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon018547b2_5933_49e5_b084_20fbf9ed7b98" }, "priority": "INTERACTIVE", "query": "-- start query 43 in stream 0 using template query43.tpl\n\n/*\nReport the sum of all sales from Sunday to Saturday for stores in a given data range by stores.\n*/\n\nselect s_store_name, s_store_id,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from date_dim, store_sales, store\n where d_date_sk = ss_sold_date_sk and\n s_store_sk = ss_store_sk and\n s_gmt_offset = -5 and\n d_year = 2000 \n group by s_store_name, s_store_id\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\n limit 100\n ;\n\n-- end query 43 in stream 0 using template query43.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/kwFJXDzmE1LlWZeOWDrtQ==", "id": "test-project-364309:europe-west1.query43_1665777468", "jobReference": { "jobId": "query43_1665777468", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query43_1665777468?location=europe-west1", "statistics": { "creationTime": "1665777468700", "endTime": "1665777469223", "finalExecutionDurationMs": "328", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89854496", "performanceInsights": { "avgPreviousExecutionMs": "304" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03409090909090909, "computeRatioMax": 0.03409090909090909, "endMs": "1665777468867", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.015151515151515152, "readRatioMax": 0.015151515151515152, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777468831", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset", "FROM store", "WHERE equal($13, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.056818181818181816, "writeRatioMax": 0.056818181818181816 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.056818181818181816, "computeRatioMax": 0.056818181818181816, "endMs": "1665777468903", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.030303030303030304, "readRatioMax": 0.030303030303030304, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "7738", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777468859", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_day_name, $21:d_year", "FROM date_dim", "WHERE equal($21, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04924242424242424, "writeRatioMax": 0.04924242424242424 }, { "completedParallelInputs": "6", "computeMsAvg": "196", "computeMsMax": "264", "computeRatioAvg": 0.7424242424242424, "computeRatioMax": 1, "endMs": "1665777469076", "id": "3", "inputStages": [ "2", "0" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.03787878787878788, "readRatioMax": 0.04924242424242424, "recordsRead": "2882672", "recordsWritten": "36", "shuffleOutputBytes": "5364", "shuffleOutputBytesSpilled": "0", "slotMs": "1080", "startMs": "1665777468914", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $83, $91 := $82", "$40 := SUM($56)", "$41 := SUM($55)", "$42 := SUM($54)", "$43 := SUM($53)", "$44 := SUM($52)", "$45 := SUM($51)", "$46 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)", "$51 := case_no_value(equal($81, 'Friday'), $80, NULL)", "$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)", "$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)", "$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)", "$55 := case_no_value(equal($81, 'Monday'), $80, NULL)", "$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$80 := $72, $81 := $70, $82 := $11, $83 := $12", "INNER HASH JOIN EACH WITH ALL ON $71 = $10" ] }, { "kind": "JOIN", "substeps": [ "$71 := $2, $72 := $3, $70 := $22", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "TO __stage03_output", "BY HASH($90, $91)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "5", "writeMsMax": "10", "writeRatioAvg": 0.01893939393939394, "writeRatioMax": 0.03787878787878788 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.015151515151515152, "computeRatioMax": 0.015151515151515152, "endMs": "1665777469087", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665777469079", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90, $101 := $91", "$30 := SUM($40)", "$31 := SUM($41)", "$32 := SUM($42)", "$33 := SUM($43)", "$34 := SUM($44)", "$35 := SUM($45)", "$36 := SUM($46)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.003787878787878788, "writeRatioMax": 0.003787878787878788 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.041666666666666664, "endMs": "1665777469128", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777469090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05303030303030303, "writeRatioMax": 0.05303030303030303 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "10", "elapsedMs": "425", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1248" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89854496", "totalPartitionsProcessed": "0", "totalSlotMs": "1248", "transferredBytes": "0" }, "startTime": "1665777468745", "totalBytesProcessed": "89854496", "totalSlotMs": "1248" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4ccfabd3_d3fc_4ff0_a042_8c570d0ec9e8" }, "priority": "INTERACTIVE", "query": "-- start query 43 in stream 0 using template query43.tpl\n\n/*\nReport the sum of all sales from Sunday to Saturday for stores in a given data range by stores.\n*/\n\nselect s_store_name, s_store_id,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from date_dim, store_sales, store\n where d_date_sk = ss_sold_date_sk and\n s_store_sk = ss_store_sk and\n s_gmt_offset = -5 and\n d_year = 2000 \n group by s_store_name, s_store_id\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\n limit 100\n ;\n\n-- end query 43 in stream 0 using template query43.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "t1rGujmC2ObM/dHW8RmGMw==", "id": "test-project-364309:europe-west1.query43_1665777470", "jobReference": { "jobId": "query43_1665777470", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query43_1665777470?location=europe-west1", "statistics": { "creationTime": "1665777470898", "endTime": "1665777471421", "finalExecutionDurationMs": "282", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "89854496", "performanceInsights": { "avgPreviousExecutionMs": "307" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04672897196261682, "computeRatioMax": 0.04672897196261682, "endMs": "1665777471074", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02336448598130841, "readRatioMax": 0.02336448598130841, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777471034", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset", "FROM store", "WHERE equal($13, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07476635514018691, "writeRatioMax": 0.07476635514018691 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.056074766355140186, "computeRatioMax": 0.056074766355140186, "endMs": "1665777471089", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.028037383177570093, "readRatioMax": 0.028037383177570093, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "7738", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777471061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_day_name, $21:d_year", "FROM date_dim", "WHERE equal($21, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07009345794392523, "writeRatioMax": 0.07009345794392523 }, { "completedParallelInputs": "6", "computeMsAvg": "180", "computeMsMax": "214", "computeRatioAvg": 0.8411214953271028, "computeRatioMax": 1, "endMs": "1665777471226", "id": "3", "inputStages": [ "2", "0" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "15", "readRatioAvg": 0.04205607476635514, "readRatioMax": 0.07009345794392523, "recordsRead": "2882672", "recordsWritten": "36", "shuffleOutputBytes": "5364", "shuffleOutputBytesSpilled": "0", "slotMs": "949", "startMs": "1665777471099", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $83, $91 := $82", "$40 := SUM($56)", "$41 := SUM($55)", "$42 := SUM($54)", "$43 := SUM($53)", "$44 := SUM($52)", "$45 := SUM($51)", "$46 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)", "$51 := case_no_value(equal($81, 'Friday'), $80, NULL)", "$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)", "$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)", "$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)", "$55 := case_no_value(equal($81, 'Monday'), $80, NULL)", "$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$80 := $72, $81 := $70, $82 := $11, $83 := $12", "INNER HASH JOIN EACH WITH ALL ON $71 = $10" ] }, { "kind": "JOIN", "substeps": [ "$71 := $2, $72 := $3, $70 := $22", "INNER HASH JOIN EACH WITH ALL ON $1 = $20" ] }, { "kind": "WRITE", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "TO __stage03_output", "BY HASH($90, $91)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.018691588785046728, "writeRatioMax": 0.02336448598130841 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03271028037383177, "computeRatioMax": 0.03271028037383177, "endMs": "1665777471251", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665777471238", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91, $90, $40, $41, $42, $43, $44, $45, $46", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90, $101 := $91", "$30 := SUM($40)", "$31 := SUM($41)", "$32 := SUM($42)", "$33 := SUM($43)", "$34 := SUM($44)", "$35 := SUM($45)", "$36 := SUM($46)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "TO __stage04_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.014018691588785047, "waitRatioMax": 0.014018691588785047, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.004672897196261682, "writeRatioMax": 0.004672897196261682 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04672897196261682, "computeRatioMax": 0.04672897196261682, "endMs": "1665777471288", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "894", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777471248", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $118", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07009345794392523, "writeRatioMax": 0.07009345794392523 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "10", "elapsedMs": "434", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1072" } ], "totalBytesBilled": "90177536", "totalBytesProcessed": "89854496", "totalPartitionsProcessed": "0", "totalSlotMs": "1072", "transferredBytes": "0" }, "startTime": "1665777470942", "totalBytesProcessed": "89854496", "totalSlotMs": "1072" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
