{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon84742eb1_b5a9_4bcb_9712_2413fc26b68a" }, "priority": "INTERACTIVE", "query": "select asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n from (select item_sk,rank() over (order by rank_col asc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V1)V11\n where rnk < 11) asceding,\n (select *\n from (select item_sk,rank() over (order by rank_col desc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V2)V21\n where rnk < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n and i1.i_item_sk=asceding.item_sk\n and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "3FUeq3oGL4V+RKV/FUet1Q==", "id": "test-project-364309:europe-west1.query44_1665768356", "jobReference": { "jobId": "query44_1665768356", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query44_1665768356?location=europe-west1", "statistics": { "creationTime": "1665768357128", "endTime": "1665768358148", "finalExecutionDurationMs": "818", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "111556818", "performanceInsights": { "avgPreviousExecutionMs": "925" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "28", "computeMsMax": "33", "computeRatioAvg": 0.27722772277227725, "computeRatioMax": 0.32673267326732675, "endMs": "1665768357314", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.13861386138613863, "readRatioMax": 0.1782178217821782, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "303", "startMs": "1665768357261", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$51:ss_store_sk, $52:ss_net_profit, $50:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($51, 4), is_null($50))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $51", "$310 := SHARD_AVG($52)" ] }, { "kind": "WRITE", "substeps": [ "$440, $310", "TO __stage00_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.0594059405940594, "writeRatioMax": 0.06930693069306931 }, { "completedParallelInputs": "6", "computeMsAvg": "25", "computeMsMax": "35", "computeRatioAvg": 0.24752475247524752, "computeRatioMax": 0.3465346534653465, "endMs": "1665768357309", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.13861386138613863, "readRatioMax": 0.16831683168316833, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "267", "startMs": "1665768357266", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$41:ss_store_sk, $42:ss_net_profit, $40:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($41, 4), is_null($40))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $41", "$300 := SHARD_AVG($42)" ] }, { "kind": "WRITE", "substeps": [ "$320, $300", "TO __stage01_output", "BY HASH($320)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.04950495049504951, "writeRatioMax": 0.0594059405940594 }, { "completedParallelInputs": "6", "computeMsAvg": "67", "computeMsMax": "76", "computeRatioAvg": 0.6633663366336634, "computeRatioMax": 0.7524752475247525, "endMs": "1665768357366", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.13861386138613863, "readRatioMax": 0.18811881188118812, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "587", "startMs": "1665768357279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_item_sk, $32:ss_net_profit, $31:ss_store_sk", "FROM store_sales", "WHERE equal($31, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $30", "$270 := SHARD_AVG($32)" ] }, { "kind": "WRITE", "substeps": [ "$470, $270", "TO __stage02_output", "BY HASH($470)" ] } ], "waitMsAvg": "2", "waitMsMax": "7", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.06930693069306931, "writeMsAvg": "20", "writeMsMax": "21", "writeRatioAvg": 0.19801980198019803, "writeRatioMax": 0.2079207920792079 }, { "completedParallelInputs": "6", "computeMsAvg": "58", "computeMsMax": "66", "computeRatioAvg": 0.5742574257425742, "computeRatioMax": 0.6534653465346535, "endMs": "1665768357378", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "18", "readRatioAvg": 0.1188118811881188, "readRatioMax": 0.1782178217821782, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "542", "startMs": "1665768357296", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_item_sk, $22:ss_net_profit, $21:ss_store_sk", "FROM store_sales", "WHERE equal($21, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $20", "$260 := SHARD_AVG($22)" ] }, { "kind": "WRITE", "substeps": [ "$350, $260", "TO __stage03_output", "BY HASH($350)" ] } ], "waitMsAvg": "6", "waitMsMax": "9", "waitRatioAvg": 0.0594059405940594, "waitRatioMax": 0.0891089108910891, "writeMsAvg": "20", "writeMsMax": "28", "writeRatioAvg": 0.19801980198019803, "writeRatioMax": 0.27722772277227725 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0594059405940594, "computeRatioMax": 0.0594059405940594, "endMs": "1665768357375", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768357340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $300", "FROM __stage01_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$280 := ROOT_AVG($300)" ] }, { "kind": "WRITE", "substeps": [ "$280", "TO __stage04_output" ] } ], "waitMsAvg": "24", "waitMsMax": "24", "waitRatioAvg": 0.2376237623762376, "waitRatioMax": 0.2376237623762376, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.27722772277227725, "writeRatioMax": 0.27722772277227725 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.07920792079207921, "endMs": "1665768357405", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665768357343", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($280)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage05_output" ] } ], "waitMsAvg": "26", "waitMsMax": "26", "waitRatioAvg": 0.25742574257425743, "waitRatioMax": 0.25742574257425743, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.26732673267326734, "writeRatioMax": 0.26732673267326734 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.04950495049504951, "computeRatioMax": 0.04950495049504951, "endMs": "1665768357389", "id": "6", "inputStages": [ "0" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768357354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $310", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$290 := ROOT_AVG($310)" ] }, { "kind": "WRITE", "substeps": [ "$290", "TO __stage06_output" ] } ], "waitMsAvg": "37", "waitMsMax": "37", "waitRatioAvg": 0.36633663366336633, "waitRatioMax": 0.36633663366336633, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.2871287128712871, "writeRatioMax": 0.2871287128712871 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06930693069306931, "computeRatioMax": 0.06930693069306931, "endMs": "1665768357404", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768357354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($290)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage07_output" ] } ], "waitMsAvg": "37", "waitMsMax": "37", "waitRatioAvg": 0.36633663366336633, "waitRatioMax": 0.36633663366336633, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.019801980198019802, "writeRatioMax": 0.019801980198019802 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.5742574257425742, "computeRatioMax": 0.5742574257425742, "endMs": "1665768357471", "id": "8", "inputStages": [ "2", "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665768357428", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$470, $270", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, multiply(NUMERIC<...>, $240))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$250 := ROOT_AVG($270)" ] }, { "kind": "WRITE", "substeps": [ "$480, $250", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0594059405940594, "writeRatioMax": 0.0594059405940594 }, { "completedParallelInputs": "1", "computeMsAvg": "101", "computeMsMax": "101", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768357506", "id": "9", "inputStages": [ "5", "3" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "96", "startMs": "1665768357444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$350, $260", "FROM __stage03_output" ] }, { "kind": "FILTER", "substeps": [ "greater($230, multiply(NUMERIC<...>, $220))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := ROOT_AVG($260)" ] }, { "kind": "WRITE", "substeps": [ "$360, $230", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.06930693069306931, "writeRatioMax": 0.06930693069306931 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.1188118811881188, "computeRatioMax": 0.1188118811881188, "endMs": "1665768357514", "id": "10", "inputStages": [ "8" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768357479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$482 := shard_sink_stats($481)" ] }, { "kind": "COMPUTE", "substeps": [ "$481 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$482", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.12871287128712872, "writeRatioMax": 0.12871287128712872 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.10891089108910891, "computeRatioMax": 0.10891089108910891, "endMs": "1665768357524", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768357481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$482", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$483 := root_sink_stats($482)" ] }, { "kind": "WRITE", "substeps": [ "$483", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0297029702970297, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.039603960396039604, "writeRatioMax": 0.039603960396039604 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0891089108910891, "computeRatioMax": 0.0891089108910891, "endMs": "1665768357552", "id": "12", "inputStages": [ "9" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768357514", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$362 := shard_sink_stats($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$361 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$362", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.13861386138613863, "writeRatioMax": 0.13861386138613863 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06930693069306931, "computeRatioMax": 0.06930693069306931, "endMs": "1665768357567", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665768357515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$362", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$363 := root_sink_stats($362)" ] }, { "kind": "WRITE", "substeps": [ "$363", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.019801980198019802, "writeRatioMax": 0.019801980198019802 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.18811881188118812, "computeRatioMax": 0.18811881188118812, "endMs": "1665768357599", "id": "14", "inputStages": [ "8", "11" ], "name": "S0E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768357544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$483", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := ROW_NUMBER($483) OVER (ORDER BY $491 DESC)" ] }, { "kind": "SORT", "substeps": [ "$250 DESC" ] }, { "kind": "WRITE", "substeps": [ "$500, $150, $501", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "37", "writeMsMax": "37", "writeRatioAvg": 0.36633663366336633, "writeRatioMax": 0.36633663366336633 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.2079207920792079, "computeRatioMax": 0.2079207920792079, "endMs": "1665768357653", "id": "15", "inputStages": [ "9", "13" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665768357601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$363", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := ROW_NUMBER($363) OVER (ORDER BY $371 ASC)" ] }, { "kind": "SORT", "substeps": [ "$230 ASC" ] }, { "kind": "WRITE", "substeps": [ "$380, $120, $381", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.2376237623762376, "writeRatioMax": 0.2376237623762376 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.0891089108910891, "computeRatioMax": 0.16831683168316833, "endMs": "1665768357665", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "3875", "startMs": "1665768357617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $210", "$190 := MIN($211)" ] }, { "kind": "WRITE", "substeps": [ "$190, $530", "TO __stage10_output", "BY HASH($530)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "15", "writeMsMax": "17", "writeRatioAvg": 0.1485148514851485, "writeRatioMax": 0.16831683168316833 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.09900990099009901, "computeRatioMax": 0.1782178217821782, "endMs": "1665768357729", "id": "17", "inputStages": [ "15" ], "name": "S11: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8420", "shuffleOutputBytes": "218920", "shuffleOutputBytesSpilled": "0", "slotMs": "3719", "startMs": "1665768357685", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $200", "$180 := MIN($201)" ] }, { "kind": "WRITE", "substeps": [ "$180, $410", "TO __stage11_output", "BY HASH($410)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "15", "writeMsMax": "24", "writeRatioAvg": 0.1485148514851485, "writeRatioMax": 0.2376237623762376 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.1782178217821782, "computeRatioMax": 0.1782178217821782, "endMs": "1665768357790", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0594059405940594, "readRatioMax": 0.0594059405940594, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768357747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.09900990099009901, "writeRatioMax": 0.09900990099009901 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.19801980198019803, "computeRatioMax": 0.19801980198019803, "endMs": "1665768357796", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0594059405940594, "readRatioMax": 0.0594059405940594, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768357761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.12871287128712872, "writeRatioMax": 0.12871287128712872 }, { "completedParallelInputs": "10", "computeMsAvg": "13", "computeMsMax": "23", "computeRatioAvg": 0.12871287128712872, "computeRatioMax": 0.22772277227722773, "endMs": "1665768357826", "id": "20", "inputStages": [ "16" ], "name": "S14: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "506", "startMs": "1665768357779", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $530", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($540, NUMERIC<...>)", "$111 := coalesce($540, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530", "$170 := MIN($190)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $170", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "17", "writeMsMax": "27", "writeRatioAvg": 0.16831683168316833, "writeRatioMax": 0.26732673267326734 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "14", "computeRatioAvg": 0.10891089108910891, "computeRatioMax": 0.13861386138613863, "endMs": "1665768357854", "id": "22", "inputStages": [ "17" ], "name": "S16: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8420", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "415", "startMs": "1665768357815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $410", "FROM __stage11_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($420, NUMERIC<...>)", "$91 := coalesce($420, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$140 := MIN($180)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $140", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.13861386138613863, "writeRatioMax": 0.16831683168316833 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "12", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.1188118811881188, "endMs": "1665768357904", "id": "24", "inputStages": [ "20" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "4704", "startMs": "1665768357841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.13861386138613863, "writeRatioMax": 0.22772277227722773 }, { "completedParallelInputs": "100", "computeMsAvg": "16", "computeMsMax": "30", "computeRatioAvg": 0.15841584158415842, "computeRatioMax": 0.297029702970297, "endMs": "1665768357938", "id": "25", "inputStages": [ "24", "14" ], "name": "S19: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "850021", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "6967", "startMs": "1665768357862", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $170", "FROM __stage18_output" ] }, { "kind": "FILTER", "substeps": [ "less($551, 11)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $160, $551 := $170", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($161, NUMERIC<...>)", "$101 := coalesce($161, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$550, $551", "TO __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.04950495049504951, "writeMsAvg": "6", "writeMsMax": "12", "writeRatioAvg": 0.0594059405940594, "writeRatioMax": 0.1188118811881188 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.1782178217821782, "endMs": "1665768357929", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "4081", "startMs": "1665768357869", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.15841584158415842, "writeRatioMax": 0.27722772277227725 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.0891089108910891, "computeRatioMax": 0.1782178217821782, "endMs": "1665768358004", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "4849", "startMs": "1665768357949", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.1485148514851485, "writeRatioMax": 0.27722772277227725 }, { "completedParallelInputs": "100", "computeMsAvg": "17", "computeMsMax": "46", "computeRatioAvg": 0.16831683168316833, "computeRatioMax": 0.45544554455445546, "endMs": "1665768358033", "id": "29", "inputStages": [ "18", "15", "19", "26", "28" ], "name": "S1D: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1210121", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "4712", "startMs": "1665768357955", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $140", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$550, $551", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$581 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$580 := $572, $581 := $570, $582 := $2", "INNER HASH JOIN EACH WITH ALL ON $571 = $1" ] }, { "kind": "JOIN", "substeps": [ "$570 := $561, $571 := $562, $572 := $11", "INNER HASH JOIN EACH WITH ALL ON $560 = $10" ] }, { "kind": "JOIN", "substeps": [ "$560 := $430, $561 := $431, $562 := $550", "INNER HASH JOIN EACH WITH ALL ON $431 = $551" ] }, { "kind": "FILTER", "substeps": [ "less($431, 11)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $130, $431 := $140", "INNER HASH JOIN EACH WITH ALL ON $80 = $90, $81 = $91" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := coalesce($131, NUMERIC<...>)", "$81 := coalesce($131, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592", "TO __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.039603960396039604, "waitRatioMax": 0.04950495049504951, "writeMsAvg": "6", "writeMsMax": "11", "writeRatioAvg": 0.0594059405940594, "writeRatioMax": 0.10891089108910891 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0891089108910891, "computeRatioMax": 0.0891089108910891, "endMs": "1665768358046", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768357970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$592 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602", "TO __stage1E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0297029702970297, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.06930693069306931, "writeRatioMax": 0.06930693069306931 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "236", "elapsedMs": "585", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "9959" }, { "activeUnits": "1", "completedUnits": "759", "elapsedMs": "922", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "39331" } ], "totalBytesBilled": "112197632", "totalBytesProcessed": "111556818", "totalPartitionsProcessed": "0", "totalSlotMs": "39331", "transferredBytes": "0" }, "startTime": "1665768357176", "totalBytesProcessed": "111556818", "totalSlotMs": "39331" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4750bf03_d64a_4958_addd_43a57213bbf2" }, "priority": "INTERACTIVE", "query": "select asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n from (select item_sk,rank() over (order by rank_col asc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V1)V11\n where rnk < 11) asceding,\n (select *\n from (select item_sk,rank() over (order by rank_col desc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V2)V21\n where rnk < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n and i1.i_item_sk=asceding.item_sk\n and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "5DhvRp0yvtQz5Ey0coqFJg==", "id": "test-project-364309:europe-west1.query44_1665777472", "jobReference": { "jobId": "query44_1665777472", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query44_1665777472?location=europe-west1", "statistics": { "creationTime": "1665777473046", "endTime": "1665777474073", "finalExecutionDurationMs": "790", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "111556818", "performanceInsights": { "avgPreviousExecutionMs": "904" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "27", "computeMsMax": "35", "computeRatioAvg": 0.26732673267326734, "computeRatioMax": 0.3465346534653465, "endMs": "1665777473240", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "21", "readRatioAvg": 0.1485148514851485, "readRatioMax": 0.2079207920792079, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "233", "startMs": "1665777473192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$51:ss_store_sk, $52:ss_net_profit, $50:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($51, 4), is_null($50))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $51", "$310 := SHARD_AVG($52)" ] }, { "kind": "WRITE", "substeps": [ "$440, $310", "TO __stage00_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.039603960396039604, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.04950495049504951, "writeRatioMax": 0.06930693069306931 }, { "completedParallelInputs": "6", "computeMsAvg": "28", "computeMsMax": "32", "computeRatioAvg": 0.27722772277227725, "computeRatioMax": 0.31683168316831684, "endMs": "1665777473237", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "19", "readRatioAvg": 0.12871287128712872, "readRatioMax": 0.18811881188118812, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "224", "startMs": "1665777473196", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$41:ss_store_sk, $42:ss_net_profit, $40:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($41, 4), is_null($40))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $41", "$300 := SHARD_AVG($42)" ] }, { "kind": "WRITE", "substeps": [ "$320, $300", "TO __stage01_output", "BY HASH($320)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "3", "writeMsMax": "4", "writeRatioAvg": 0.0297029702970297, "writeRatioMax": 0.039603960396039604 }, { "completedParallelInputs": "6", "computeMsAvg": "71", "computeMsMax": "101", "computeRatioAvg": 0.7029702970297029, "computeRatioMax": 1, "endMs": "1665777473303", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "20", "readRatioAvg": 0.1485148514851485, "readRatioMax": 0.19801980198019803, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "497", "startMs": "1665777473213", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_item_sk, $32:ss_net_profit, $31:ss_store_sk", "FROM store_sales", "WHERE equal($31, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $30", "$270 := SHARD_AVG($32)" ] }, { "kind": "WRITE", "substeps": [ "$470, $270", "TO __stage02_output", "BY HASH($470)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "19", "writeMsMax": "21", "writeRatioAvg": 0.18811881188118812, "writeRatioMax": 0.2079207920792079 }, { "completedParallelInputs": "6", "computeMsAvg": "69", "computeMsMax": "80", "computeRatioAvg": 0.6831683168316832, "computeRatioMax": 0.7920792079207921, "endMs": "1665777473313", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.1485148514851485, "readRatioMax": 0.1782178217821782, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "529", "startMs": "1665777473231", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_item_sk, $22:ss_net_profit, $21:ss_store_sk", "FROM store_sales", "WHERE equal($21, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $20", "$260 := SHARD_AVG($22)" ] }, { "kind": "WRITE", "substeps": [ "$350, $260", "TO __stage03_output", "BY HASH($350)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "19", "writeMsMax": "21", "writeRatioAvg": 0.18811881188118812, "writeRatioMax": 0.2079207920792079 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09900990099009901, "computeRatioMax": 0.09900990099009901, "endMs": "1665777473277", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777473241", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $300", "FROM __stage01_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$280 := ROOT_AVG($300)" ] }, { "kind": "WRITE", "substeps": [ "$280", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1485148514851485, "writeRatioMax": 0.1485148514851485 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.07920792079207921, "endMs": "1665777473281", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777473243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($280)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0297029702970297, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.019801980198019802, "writeRatioMax": 0.019801980198019802 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06930693069306931, "computeRatioMax": 0.06930693069306931, "endMs": "1665777473289", "id": "6", "inputStages": [ "0" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777473248", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $310", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$290 := ROOT_AVG($310)" ] }, { "kind": "WRITE", "substeps": [ "$290", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.16831683168316833, "writeRatioMax": 0.16831683168316833 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0891089108910891, "computeRatioMax": 0.0891089108910891, "endMs": "1665777473305", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777473251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($290)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0297029702970297, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.019801980198019802, "writeRatioMax": 0.019801980198019802 }, { "completedParallelInputs": "1", "computeMsAvg": "71", "computeMsMax": "71", "computeRatioAvg": 0.7029702970297029, "computeRatioMax": 0.7029702970297029, "endMs": "1665777473394", "id": "8", "inputStages": [ "7", "2" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "76", "startMs": "1665777473340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$470, $270", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, multiply(NUMERIC<...>, $240))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$250 := ROOT_AVG($270)" ] }, { "kind": "WRITE", "substeps": [ "$480, $250", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.07920792079207921, "writeRatioMax": 0.07920792079207921 }, { "completedParallelInputs": "1", "computeMsAvg": "89", "computeMsMax": "89", "computeRatioAvg": 0.8811881188118812, "computeRatioMax": 0.8811881188118812, "endMs": "1665777473411", "id": "9", "inputStages": [ "3", "5" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777473354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$350, $260", "FROM __stage03_output" ] }, { "kind": "FILTER", "substeps": [ "greater($230, multiply(NUMERIC<...>, $220))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := ROOT_AVG($260)" ] }, { "kind": "WRITE", "substeps": [ "$360, $230", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0594059405940594, "writeRatioMax": 0.0594059405940594 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.10891089108910891, "computeRatioMax": 0.10891089108910891, "endMs": "1665777473435", "id": "10", "inputStages": [ "8" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777473400", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$482 := shard_sink_stats($481)" ] }, { "kind": "COMPUTE", "substeps": [ "$481 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$482", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.2079207920792079, "writeRatioMax": 0.2079207920792079 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09900990099009901, "computeRatioMax": 0.09900990099009901, "endMs": "1665777473447", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777473402", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$482", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$483 := root_sink_stats($482)" ] }, { "kind": "WRITE", "substeps": [ "$483", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.04950495049504951, "writeRatioMax": 0.04950495049504951 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09900990099009901, "computeRatioMax": 0.09900990099009901, "endMs": "1665777473457", "id": "12", "inputStages": [ "9" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777473420", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$362 := shard_sink_stats($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$361 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$362", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.1188118811881188, "writeRatioMax": 0.1188118811881188 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.07920792079207921, "endMs": "1665777473471", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777473422", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$362", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$363 := root_sink_stats($362)" ] }, { "kind": "WRITE", "substeps": [ "$363", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0297029702970297, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.07920792079207921, "writeRatioMax": 0.07920792079207921 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.297029702970297, "computeRatioMax": 0.297029702970297, "endMs": "1665777473512", "id": "14", "inputStages": [ "11", "8" ], "name": "S0E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777473467", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$483", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := ROW_NUMBER($483) OVER (ORDER BY $491 DESC)" ] }, { "kind": "SORT", "substeps": [ "$250 DESC" ] }, { "kind": "WRITE", "substeps": [ "$500, $150, $501", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.2079207920792079, "writeRatioMax": 0.2079207920792079 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.3564356435643564, "computeRatioMax": 0.3564356435643564, "endMs": "1665777473537", "id": "15", "inputStages": [ "9", "13" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777473488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$363", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := ROW_NUMBER($363) OVER (ORDER BY $371 ASC)" ] }, { "kind": "SORT", "substeps": [ "$230 ASC" ] }, { "kind": "WRITE", "substeps": [ "$380, $120, $381", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.22772277227722773, "writeRatioMax": 0.22772277227722773 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "23", "computeRatioAvg": 0.10891089108910891, "computeRatioMax": 0.22772277227722773, "endMs": "1665777473576", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "3445", "startMs": "1665777473530", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $210", "$190 := MIN($211)" ] }, { "kind": "WRITE", "substeps": [ "$190, $530", "TO __stage10_output", "BY HASH($530)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.0297029702970297, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.1485148514851485, "writeRatioMax": 0.26732673267326734 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "19", "computeRatioAvg": 0.10891089108910891, "computeRatioMax": 0.18811881188118812, "endMs": "1665777473626", "id": "17", "inputStages": [ "15" ], "name": "S11: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8420", "shuffleOutputBytes": "218920", "shuffleOutputBytesSpilled": "0", "slotMs": "3410", "startMs": "1665777473555", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $200", "$180 := MIN($201)" ] }, { "kind": "WRITE", "substeps": [ "$180, $410", "TO __stage11_output", "BY HASH($410)" ] } ], "waitMsAvg": "3", "waitMsMax": "8", "waitRatioAvg": 0.0297029702970297, "waitRatioMax": 0.07920792079207921, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.16831683168316833, "writeRatioMax": 0.297029702970297 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.31683168316831684, "computeRatioMax": 0.31683168316831684, "endMs": "1665777473679", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.06930693069306931, "readRatioMax": 0.06930693069306931, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777473642", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.1188118811881188, "writeRatioMax": 0.1188118811881188 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.15841584158415842, "computeRatioMax": 0.15841584158415842, "endMs": "1665777473707", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.04950495049504951, "readRatioMax": 0.04950495049504951, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777473656", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.12871287128712872, "writeRatioMax": 0.12871287128712872 }, { "completedParallelInputs": "10", "computeMsAvg": "13", "computeMsMax": "17", "computeRatioAvg": 0.12871287128712872, "computeRatioMax": 0.16831683168316833, "endMs": "1665777473744", "id": "20", "inputStages": [ "16" ], "name": "S14: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "483", "startMs": "1665777473672", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $530", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($540, NUMERIC<...>)", "$111 := coalesce($540, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530", "$170 := MIN($190)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $170", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "31", "writeMsMax": "61", "writeRatioAvg": 0.3069306930693069, "writeRatioMax": 0.6039603960396039 }, { "completedParallelInputs": "10", "computeMsAvg": "12", "computeMsMax": "19", "computeRatioAvg": 0.1188118811881188, "computeRatioMax": 0.18811881188118812, "endMs": "1665777473764", "id": "22", "inputStages": [ "17" ], "name": "S16: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8420", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "372", "startMs": "1665777473708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $410", "FROM __stage11_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($420, NUMERIC<...>)", "$91 := coalesce($420, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$140 := MIN($180)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $140", "TO __stage16_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "23", "writeMsMax": "47", "writeRatioAvg": 0.22772277227722773, "writeRatioMax": 0.46534653465346537 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.0891089108910891, "computeRatioMax": 0.1782178217821782, "endMs": "1665777473813", "id": "24", "inputStages": [ "20" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "3587", "startMs": "1665777473759", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "5", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.04950495049504951, "writeMsAvg": "18", "writeMsMax": "30", "writeRatioAvg": 0.1782178217821782, "writeRatioMax": 0.297029702970297 }, { "completedParallelInputs": "100", "computeMsAvg": "15", "computeMsMax": "26", "computeRatioAvg": 0.1485148514851485, "computeRatioMax": 0.25742574257425743, "endMs": "1665777473839", "id": "25", "inputStages": [ "24", "14" ], "name": "S19: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "850021", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "4412", "startMs": "1665777473777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $170", "FROM __stage18_output" ] }, { "kind": "FILTER", "substeps": [ "less($551, 11)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $160, $551 := $170", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($161, NUMERIC<...>)", "$101 := coalesce($161, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$550, $551", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "5", "writeMsMax": "13", "writeRatioAvg": 0.04950495049504951, "writeRatioMax": 0.12871287128712872 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.18811881188118812, "endMs": "1665777473838", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "3221", "startMs": "1665777473782", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.04950495049504951, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.13861386138613863, "writeRatioMax": 0.16831683168316833 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.15841584158415842, "endMs": "1665777473912", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "3261", "startMs": "1665777473850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "15", "writeMsMax": "32", "writeRatioAvg": 0.1485148514851485, "writeRatioMax": 0.31683168316831684 }, { "completedParallelInputs": "100", "computeMsAvg": "18", "computeMsMax": "45", "computeRatioAvg": 0.1782178217821782, "computeRatioMax": 0.44554455445544555, "endMs": "1665777473941", "id": "29", "inputStages": [ "26", "28", "18", "19", "15" ], "name": "S1D: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1210121", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "3728", "startMs": "1665777473855", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $140", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$550, $551", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$581 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$580 := $572, $581 := $570, $582 := $2", "INNER HASH JOIN EACH WITH ALL ON $571 = $1" ] }, { "kind": "JOIN", "substeps": [ "$570 := $561, $571 := $562, $572 := $11", "INNER HASH JOIN EACH WITH ALL ON $560 = $10" ] }, { "kind": "JOIN", "substeps": [ "$560 := $430, $561 := $431, $562 := $550", "INNER HASH JOIN EACH WITH ALL ON $431 = $551" ] }, { "kind": "FILTER", "substeps": [ "less($431, 11)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $130, $431 := $140", "INNER HASH JOIN EACH WITH ALL ON $80 = $90, $81 = $91" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := coalesce($131, NUMERIC<...>)", "$81 := coalesce($131, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592", "TO __stage1D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.04950495049504951, "waitRatioMax": 0.0594059405940594, "writeMsAvg": "8", "writeMsMax": "22", "writeRatioAvg": 0.07920792079207921, "writeRatioMax": 0.21782178217821782 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06930693069306931, "computeRatioMax": 0.06930693069306931, "endMs": "1665777473947", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777473870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$592 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602", "TO __stage1E_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.04950495049504951, "waitRatioMax": 0.04950495049504951, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.039603960396039604, "writeRatioMax": 0.039603960396039604 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "110", "completedUnits": "237", "elapsedMs": "596", "estimatedRunnableUnits": "0", "pendingUnits": "121", "totalSlotMs": "8870" }, { "activeUnits": "111", "completedUnits": "759", "elapsedMs": "897", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "34439" } ], "totalBytesBilled": "112197632", "totalBytesProcessed": "111556818", "totalPartitionsProcessed": "0", "totalSlotMs": "34439", "transferredBytes": "0" }, "startTime": "1665777473112", "totalBytesProcessed": "111556818", "totalSlotMs": "34439" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7e101beb_08ad_4646_9fff_41cf3703e90b" }, "priority": "INTERACTIVE", "query": "select asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n from (select item_sk,rank() over (order by rank_col asc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V1)V11\n where rnk < 11) asceding,\n (select *\n from (select item_sk,rank() over (order by rank_col desc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V2)V21\n where rnk < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n and i1.i_item_sk=asceding.item_sk\n and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "MP3fObpg56yg28tOD/gwog==", "id": "test-project-364309:europe-west1.query44_1665777475", "jobReference": { "jobId": "query44_1665777475", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query44_1665777475?location=europe-west1", "statistics": { "creationTime": "1665777476239", "endTime": "1665777477196", "finalExecutionDurationMs": "755", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "111556818", "performanceInsights": { "avgPreviousExecutionMs": "885" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "31", "computeMsMax": "39", "computeRatioAvg": 0.34831460674157305, "computeRatioMax": 0.43820224719101125, "endMs": "1665777476443", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "30", "readRatioAvg": 0.20224719101123595, "readRatioMax": 0.33707865168539325, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "298", "startMs": "1665777476375", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$51:ss_store_sk, $52:ss_net_profit, $50:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($51, 4), is_null($50))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $51", "$310 := SHARD_AVG($52)" ] }, { "kind": "WRITE", "substeps": [ "$440, $310", "TO __stage00_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.056179775280898875, "writeRatioMax": 0.07865168539325842 }, { "completedParallelInputs": "6", "computeMsAvg": "24", "computeMsMax": "29", "computeRatioAvg": 0.2696629213483146, "computeRatioMax": 0.3258426966292135, "endMs": "1665777476425", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "24", "readRatioAvg": 0.15730337078651685, "readRatioMax": 0.2696629213483146, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "221", "startMs": "1665777476377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$41:ss_store_sk, $42:ss_net_profit, $40:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($41, 4), is_null($40))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $41", "$300 := SHARD_AVG($42)" ] }, { "kind": "WRITE", "substeps": [ "$320, $300", "TO __stage01_output", "BY HASH($320)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.0449438202247191, "writeRatioMax": 0.06741573033707865 }, { "completedParallelInputs": "6", "computeMsAvg": "62", "computeMsMax": "72", "computeRatioAvg": 0.6966292134831461, "computeRatioMax": 0.8089887640449438, "endMs": "1665777476460", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "13", "readRatioAvg": 0.1348314606741573, "readRatioMax": 0.14606741573033707, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "448", "startMs": "1665777476390", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_item_sk, $32:ss_net_profit, $31:ss_store_sk", "FROM store_sales", "WHERE equal($31, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $30", "$270 := SHARD_AVG($32)" ] }, { "kind": "WRITE", "substeps": [ "$470, $270", "TO __stage02_output", "BY HASH($470)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "19", "writeMsMax": "24", "writeRatioAvg": 0.21348314606741572, "writeRatioMax": 0.2696629213483146 }, { "completedParallelInputs": "6", "computeMsAvg": "68", "computeMsMax": "89", "computeRatioAvg": 0.7640449438202247, "computeRatioMax": 1, "endMs": "1665777476490", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.1797752808988764, "readRatioMax": 0.2247191011235955, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "566", "startMs": "1665777476402", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_item_sk, $22:ss_net_profit, $21:ss_store_sk", "FROM store_sales", "WHERE equal($21, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $20", "$260 := SHARD_AVG($22)" ] }, { "kind": "WRITE", "substeps": [ "$350, $260", "TO __stage03_output", "BY HASH($350)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "20", "writeMsMax": "22", "writeRatioAvg": 0.2247191011235955, "writeRatioMax": 0.24719101123595505 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.21348314606741572, "computeRatioMax": 0.21348314606741572, "endMs": "1665777476471", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777476427", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $300", "FROM __stage01_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$280 := ROOT_AVG($300)" ] }, { "kind": "WRITE", "substeps": [ "$280", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.2247191011235955, "writeRatioMax": 0.2247191011235955 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.10112359550561797, "computeRatioMax": 0.10112359550561797, "endMs": "1665777476483", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777476428", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($280)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage05_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0449438202247191, "writeRatioMax": 0.0449438202247191 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.11235955056179775, "computeRatioMax": 0.11235955056179775, "endMs": "1665777476483", "id": "6", "inputStages": [ "0" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777476445", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $310", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$290 := ROOT_AVG($310)" ] }, { "kind": "WRITE", "substeps": [ "$290", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1797752808988764, "writeRatioMax": 0.1797752808988764 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.10112359550561797, "computeRatioMax": 0.10112359550561797, "endMs": "1665777476504", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777476447", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($290)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02247191011235955, "waitRatioMax": 0.02247191011235955, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.033707865168539325, "writeRatioMax": 0.033707865168539325 }, { "completedParallelInputs": "1", "computeMsAvg": "82", "computeMsMax": "82", "computeRatioAvg": 0.9213483146067416, "computeRatioMax": 0.9213483146067416, "endMs": "1665777476579", "id": "8", "inputStages": [ "5", "3" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665777476513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$350, $260", "FROM __stage03_output" ] }, { "kind": "FILTER", "substeps": [ "greater($230, multiply(NUMERIC<...>, $220))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := ROOT_AVG($260)" ] }, { "kind": "WRITE", "substeps": [ "$360, $230", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.07865168539325842, "writeRatioMax": 0.07865168539325842 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.5842696629213483, "computeRatioMax": 0.5842696629213483, "endMs": "1665777476570", "id": "9", "inputStages": [ "2", "7" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777476525", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$470, $270", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, multiply(NUMERIC<...>, $240))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$250 := ROOT_AVG($270)" ] }, { "kind": "WRITE", "substeps": [ "$480, $250", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.056179775280898875, "writeRatioMax": 0.056179775280898875 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0898876404494382, "computeRatioMax": 0.0898876404494382, "endMs": "1665777476623", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777476583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$482 := shard_sink_stats($481)" ] }, { "kind": "COMPUTE", "substeps": [ "$481 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$482", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.16853932584269662, "writeRatioMax": 0.16853932584269662 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0898876404494382, "computeRatioMax": 0.0898876404494382, "endMs": "1665777476635", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777476585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$482", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$483 := root_sink_stats($482)" ] }, { "kind": "WRITE", "substeps": [ "$483", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02247191011235955, "waitRatioMax": 0.02247191011235955, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.033707865168539325, "writeRatioMax": 0.033707865168539325 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.20224719101123595, "computeRatioMax": 0.20224719101123595, "endMs": "1665777476624", "id": "12", "inputStages": [ "8" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777476585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$362 := shard_sink_stats($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$361 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$362", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02247191011235955, "waitRatioMax": 0.02247191011235955, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.11235955056179775, "writeRatioMax": 0.11235955056179775 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.1348314606741573, "computeRatioMax": 0.1348314606741573, "endMs": "1665777476643", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777476585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$362", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$363 := root_sink_stats($362)" ] }, { "kind": "WRITE", "substeps": [ "$363", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02247191011235955, "waitRatioMax": 0.02247191011235955, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.06741573033707865, "writeRatioMax": 0.06741573033707865 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.1797752808988764, "computeRatioMax": 0.1797752808988764, "endMs": "1665777476702", "id": "14", "inputStages": [ "11", "9" ], "name": "S0E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777476664", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$483", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage09_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := ROW_NUMBER($483) OVER (ORDER BY $491 DESC)" ] }, { "kind": "SORT", "substeps": [ "$250 DESC" ] }, { "kind": "WRITE", "substeps": [ "$500, $150, $501", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.23595505617977527, "writeRatioMax": 0.23595505617977527 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.23595505617977527, "computeRatioMax": 0.23595505617977527, "endMs": "1665777476716", "id": "15", "inputStages": [ "8", "13" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777476679", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$363", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage08_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := ROW_NUMBER($363) OVER (ORDER BY $371 ASC)" ] }, { "kind": "SORT", "substeps": [ "$230 ASC" ] }, { "kind": "WRITE", "substeps": [ "$380, $120, $381", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.23595505617977527, "writeRatioMax": 0.23595505617977527 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "22", "computeRatioAvg": 0.12359550561797752, "computeRatioMax": 0.24719101123595505, "endMs": "1665777476773", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "3366", "startMs": "1665777476721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $210", "$190 := MIN($211)" ] }, { "kind": "WRITE", "substeps": [ "$190, $530", "TO __stage10_output", "BY HASH($530)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.02247191011235955, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.15730337078651685, "writeRatioMax": 0.21348314606741572 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "22", "computeRatioAvg": 0.12359550561797752, "computeRatioMax": 0.24719101123595505, "endMs": "1665777476788", "id": "17", "inputStages": [ "15" ], "name": "S11: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8420", "shuffleOutputBytes": "218920", "shuffleOutputBytesSpilled": "0", "slotMs": "3169", "startMs": "1665777476736", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $200", "$180 := MIN($201)" ] }, { "kind": "WRITE", "substeps": [ "$180, $410", "TO __stage11_output", "BY HASH($410)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.033707865168539325, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.15730337078651685, "writeRatioMax": 0.24719101123595505 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.1797752808988764, "computeRatioMax": 0.1797752808988764, "endMs": "1665777476867", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.06741573033707865, "readRatioMax": 0.06741573033707865, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777476822", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.16853932584269662, "writeRatioMax": 0.16853932584269662 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.23595505617977527, "computeRatioMax": 0.23595505617977527, "endMs": "1665777476884", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "24", "readMsMax": "24", "readRatioAvg": 0.2696629213483146, "readRatioMax": 0.2696629213483146, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777476835", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.11235955056179775, "writeRatioMax": 0.11235955056179775 }, { "completedParallelInputs": "10", "computeMsAvg": "14", "computeMsMax": "23", "computeRatioAvg": 0.15730337078651685, "computeRatioMax": 0.25842696629213485, "endMs": "1665777476894", "id": "20", "inputStages": [ "16" ], "name": "S14: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "367", "startMs": "1665777476849", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $530", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($540, NUMERIC<...>)", "$111 := coalesce($540, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530", "$170 := MIN($190)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $170", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "16", "writeMsMax": "26", "writeRatioAvg": 0.1797752808988764, "writeRatioMax": 0.29213483146067415 }, { "completedParallelInputs": "10", "computeMsAvg": "15", "computeMsMax": "22", "computeRatioAvg": 0.16853932584269662, "computeRatioMax": 0.24719101123595505, "endMs": "1665777476916", "id": "22", "inputStages": [ "17" ], "name": "S16: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8420", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "377", "startMs": "1665777476875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $410", "FROM __stage11_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($420, NUMERIC<...>)", "$91 := coalesce($420, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$140 := MIN($180)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $140", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "13", "writeMsMax": "15", "writeRatioAvg": 0.14606741573033707, "writeRatioMax": 0.16853932584269662 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.10112359550561797, "computeRatioMax": 0.1797752808988764, "endMs": "1665777476963", "id": "24", "inputStages": [ "20" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "3187", "startMs": "1665777476905", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.0449438202247191, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.16853932584269662, "writeRatioMax": 0.23595505617977527 }, { "completedParallelInputs": "100", "computeMsAvg": "17", "computeMsMax": "28", "computeRatioAvg": 0.19101123595505617, "computeRatioMax": 0.3146067415730337, "endMs": "1665777476990", "id": "25", "inputStages": [ "24", "14" ], "name": "S19: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "850021", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "5436", "startMs": "1665777476916", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $170", "FROM __stage18_output" ] }, { "kind": "FILTER", "substeps": [ "less($551, 11)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $160, $551 := $170", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($161, NUMERIC<...>)", "$101 := coalesce($161, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$550, $551", "TO __stage19_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.033707865168539325, "waitRatioMax": 0.056179775280898875, "writeMsAvg": "5", "writeMsMax": "12", "writeRatioAvg": 0.056179775280898875, "writeRatioMax": 0.1348314606741573 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0898876404494382, "computeRatioMax": 0.1797752808988764, "endMs": "1665777476979", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "3062", "startMs": "1665777476926", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.02247191011235955, "waitRatioMax": 0.033707865168539325, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.15730337078651685, "writeRatioMax": 0.21348314606741572 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.10112359550561797, "computeRatioMax": 0.24719101123595505, "endMs": "1665777477062", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "3672", "startMs": "1665777476994", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.02247191011235955, "waitRatioMax": 0.033707865168539325, "writeMsAvg": "15", "writeMsMax": "32", "writeRatioAvg": 0.16853932584269662, "writeRatioMax": 0.3595505617977528 }, { "completedParallelInputs": "100", "computeMsAvg": "17", "computeMsMax": "39", "computeRatioAvg": 0.19101123595505617, "computeRatioMax": 0.43820224719101125, "endMs": "1665777477092", "id": "29", "inputStages": [ "19", "18", "26", "28", "15" ], "name": "S1D: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1210121", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "3354", "startMs": "1665777477000", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $140", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$550, $551", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$581 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$580 := $572, $581 := $570, $582 := $2", "INNER HASH JOIN EACH WITH ALL ON $571 = $1" ] }, { "kind": "JOIN", "substeps": [ "$570 := $561, $571 := $562, $572 := $11", "INNER HASH JOIN EACH WITH ALL ON $560 = $10" ] }, { "kind": "JOIN", "substeps": [ "$560 := $430, $561 := $431, $562 := $550", "INNER HASH JOIN EACH WITH ALL ON $431 = $551" ] }, { "kind": "FILTER", "substeps": [ "less($431, 11)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $130, $431 := $140", "INNER HASH JOIN EACH WITH ALL ON $80 = $90, $81 = $91" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := coalesce($131, NUMERIC<...>)", "$81 := coalesce($131, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592", "TO __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.0449438202247191, "waitRatioMax": 0.06741573033707865, "writeMsAvg": "6", "writeMsMax": "21", "writeRatioAvg": 0.06741573033707865, "writeRatioMax": 0.23595505617977527 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.10112359550561797, "computeRatioMax": 0.10112359550561797, "endMs": "1665777477106", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777477012", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$592 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602", "TO __stage1E_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.15730337078651685, "waitRatioMax": 0.15730337078651685, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.12359550561797752, "writeRatioMax": 0.12359550561797752 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "111", "completedUnits": "237", "elapsedMs": "587", "estimatedRunnableUnits": "0", "pendingUnits": "121", "totalSlotMs": "8614" }, { "activeUnits": "111", "completedUnits": "759", "elapsedMs": "859", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "31654" } ], "totalBytesBilled": "112197632", "totalBytesProcessed": "111556818", "totalPartitionsProcessed": "0", "totalSlotMs": "31654", "transferredBytes": "0" }, "startTime": "1665777476289", "totalBytesProcessed": "111556818", "totalSlotMs": "31654" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon01c149c4_02d8_4a46_ad33_f6c08eef720a" }, "priority": "INTERACTIVE", "query": "select asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n from (select item_sk,rank() over (order by rank_col asc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V1)V11\n where rnk < 11) asceding,\n (select *\n from (select item_sk,rank() over (order by rank_col desc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V2)V21\n where rnk < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n and i1.i_item_sk=asceding.item_sk\n and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "H/sCgoZqgfoOBIberXRviA==", "id": "test-project-364309:europe-west1.query44_1665777478", "jobReference": { "jobId": "query44_1665777478", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query44_1665777478?location=europe-west1", "statistics": { "creationTime": "1665777480095", "endTime": "1665777481073", "finalExecutionDurationMs": "775", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "111556818", "performanceInsights": { "avgPreviousExecutionMs": "866" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "30", "computeMsMax": "34", "computeRatioAvg": 0.3448275862068966, "computeRatioMax": 0.39080459770114945, "endMs": "1665777480265", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.16091954022988506, "readRatioMax": 0.19540229885057472, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "232", "startMs": "1665777480223", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$51:ss_store_sk, $52:ss_net_profit, $50:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($51, 4), is_null($50))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $51", "$310 := SHARD_AVG($52)" ] }, { "kind": "WRITE", "substeps": [ "$440, $310", "TO __stage00_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.05747126436781609 }, { "completedParallelInputs": "6", "computeMsAvg": "29", "computeMsMax": "43", "computeRatioAvg": 0.3333333333333333, "computeRatioMax": 0.4942528735632184, "endMs": "1665777480267", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.14942528735632185, "readRatioMax": 0.1839080459770115, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "231", "startMs": "1665777480226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$41:ss_store_sk, $42:ss_net_profit, $40:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($41, 4), is_null($40))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $41", "$300 := SHARD_AVG($42)" ] }, { "kind": "WRITE", "substeps": [ "$320, $300", "TO __stage01_output", "BY HASH($320)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "6", "computeMsAvg": "62", "computeMsMax": "83", "computeRatioAvg": 0.7126436781609196, "computeRatioMax": 0.9540229885057471, "endMs": "1665777480330", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "23", "readRatioAvg": 0.1839080459770115, "readRatioMax": 0.26436781609195403, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "510", "startMs": "1665777480239", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_item_sk, $32:ss_net_profit, $31:ss_store_sk", "FROM store_sales", "WHERE equal($31, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $30", "$270 := SHARD_AVG($32)" ] }, { "kind": "WRITE", "substeps": [ "$470, $270", "TO __stage02_output", "BY HASH($470)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "20", "writeMsMax": "22", "writeRatioAvg": 0.22988505747126436, "writeRatioMax": 0.25287356321839083 }, { "completedParallelInputs": "6", "computeMsAvg": "65", "computeMsMax": "85", "computeRatioAvg": 0.7471264367816092, "computeRatioMax": 0.9770114942528736, "endMs": "1665777480337", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.1839080459770115, "readRatioMax": 0.21839080459770116, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "511", "startMs": "1665777480254", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_item_sk, $22:ss_net_profit, $21:ss_store_sk", "FROM store_sales", "WHERE equal($21, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $20", "$260 := SHARD_AVG($22)" ] }, { "kind": "WRITE", "substeps": [ "$350, $260", "TO __stage03_output", "BY HASH($350)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "19", "writeMsMax": "22", "writeRatioAvg": 0.21839080459770116, "writeRatioMax": 0.25287356321839083 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.09195402298850575, "computeRatioMax": 0.09195402298850575, "endMs": "1665777480303", "id": "4", "inputStages": [ "0" ], "name": "S04: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777480269", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $310", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$290 := ROOT_AVG($310)" ] }, { "kind": "WRITE", "substeps": [ "$290", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.16091954022988506, "writeRatioMax": 0.16091954022988506 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.09195402298850575, "computeRatioMax": 0.09195402298850575, "endMs": "1665777480310", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777480270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($290)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.034482758620689655, "waitRatioMax": 0.034482758620689655, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.034482758620689655, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.05747126436781609, "computeRatioMax": 0.05747126436781609, "endMs": "1665777480307", "id": "6", "inputStages": [ "1" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777480271", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $300", "FROM __stage01_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$280 := ROOT_AVG($300)" ] }, { "kind": "WRITE", "substeps": [ "$280", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1724137931034483, "writeRatioMax": 0.1724137931034483 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665777480321", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777480271", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($280)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.011494252873563218, "writeRatioMax": 0.011494252873563218 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.5517241379310345, "computeRatioMax": 0.5517241379310345, "endMs": "1665777480391", "id": "8", "inputStages": [ "2", "5" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777480352", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$470, $270", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, multiply(NUMERIC<...>, $240))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$250 := ROOT_AVG($270)" ] }, { "kind": "WRITE", "substeps": [ "$480, $250", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "1", "computeMsAvg": "87", "computeMsMax": "87", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777480425", "id": "9", "inputStages": [ "7", "3" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665777480367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$350, $260", "FROM __stage03_output" ] }, { "kind": "FILTER", "substeps": [ "greater($230, multiply(NUMERIC<...>, $220))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := ROOT_AVG($260)" ] }, { "kind": "WRITE", "substeps": [ "$360, $230", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.06896551724137931, "writeRatioMax": 0.06896551724137931 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.14942528735632185, "computeRatioMax": 0.14942528735632185, "endMs": "1665777480434", "id": "10", "inputStages": [ "8" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777480398", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$482 := shard_sink_stats($481)" ] }, { "kind": "COMPUTE", "substeps": [ "$481 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$482", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.16091954022988506, "writeRatioMax": 0.16091954022988506 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665777480439", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777480400", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$482", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$483 := root_sink_stats($482)" ] }, { "kind": "WRITE", "substeps": [ "$483", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.034482758620689655, "waitRatioMax": 0.034482758620689655, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.022988505747126436, "writeRatioMax": 0.022988505747126436 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.12643678160919541, "computeRatioMax": 0.12643678160919541, "endMs": "1665777480469", "id": "12", "inputStages": [ "9" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777480434", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$362 := shard_sink_stats($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$361 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$362", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.16091954022988506, "writeRatioMax": 0.16091954022988506 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665777480473", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777480435", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$362", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$363 := root_sink_stats($362)" ] }, { "kind": "WRITE", "substeps": [ "$363", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.022988505747126436, "writeRatioMax": 0.022988505747126436 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.3103448275862069, "computeRatioMax": 0.3103448275862069, "endMs": "1665777480518", "id": "14", "inputStages": [ "11", "8" ], "name": "S0E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777480464", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$483", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := ROW_NUMBER($483) OVER (ORDER BY $491 DESC)" ] }, { "kind": "SORT", "substeps": [ "$250 DESC" ] }, { "kind": "WRITE", "substeps": [ "$500, $150, $501", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.2413793103448276, "writeRatioMax": 0.2413793103448276 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.26436781609195403, "computeRatioMax": 0.26436781609195403, "endMs": "1665777480554", "id": "15", "inputStages": [ "9", "13" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777480498", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$363", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := ROW_NUMBER($363) OVER (ORDER BY $371 ASC)" ] }, { "kind": "SORT", "substeps": [ "$230 ASC" ] }, { "kind": "WRITE", "substeps": [ "$380, $120, $381", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.25287356321839083, "writeRatioMax": 0.25287356321839083 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "31", "computeRatioAvg": 0.12643678160919541, "computeRatioMax": 0.3563218390804598, "endMs": "1665777480604", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "3999", "startMs": "1665777480546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $210", "$190 := MIN($211)" ] }, { "kind": "WRITE", "substeps": [ "$190, $530", "TO __stage10_output", "BY HASH($530)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.034482758620689655, "waitRatioMax": 0.04597701149425287, "writeMsAvg": "26", "writeMsMax": "30", "writeRatioAvg": 0.2988505747126437, "writeRatioMax": 0.3448275862068966 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "21", "computeRatioAvg": 0.12643678160919541, "computeRatioMax": 0.2413793103448276, "endMs": "1665777480637", "id": "17", "inputStages": [ "15" ], "name": "S11: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8420", "shuffleOutputBytes": "218920", "shuffleOutputBytesSpilled": "0", "slotMs": "3456", "startMs": "1665777480588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $200", "$180 := MIN($201)" ] }, { "kind": "WRITE", "substeps": [ "$180, $410", "TO __stage11_output", "BY HASH($410)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.04597701149425287, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.1724137931034483, "writeRatioMax": 0.3103448275862069 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.2413793103448276, "computeRatioMax": 0.2413793103448276, "endMs": "1665777480687", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.06896551724137931, "readRatioMax": 0.06896551724137931, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777480655", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.13793103448275862, "writeRatioMax": 0.13793103448275862 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.25287356321839083, "computeRatioMax": 0.25287356321839083, "endMs": "1665777480706", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.05747126436781609, "readRatioMax": 0.05747126436781609, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777480666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.09195402298850575, "writeRatioMax": 0.09195402298850575 }, { "completedParallelInputs": "10", "computeMsAvg": "13", "computeMsMax": "18", "computeRatioAvg": 0.14942528735632185, "computeRatioMax": 0.20689655172413793, "endMs": "1665777480721", "id": "20", "inputStages": [ "16" ], "name": "S14: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "368", "startMs": "1665777480680", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $530", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($540, NUMERIC<...>)", "$111 := coalesce($540, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530", "$170 := MIN($190)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $170", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "13", "writeMsMax": "15", "writeRatioAvg": 0.14942528735632185, "writeRatioMax": 0.1724137931034483 }, { "completedParallelInputs": "10", "computeMsAvg": "12", "computeMsMax": "15", "computeRatioAvg": 0.13793103448275862, "computeRatioMax": 0.1724137931034483, "endMs": "1665777480748", "id": "22", "inputStages": [ "17" ], "name": "S16: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8420", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "319", "startMs": "1665777480708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $410", "FROM __stage11_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($420, NUMERIC<...>)", "$91 := coalesce($420, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$140 := MIN($180)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $140", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "13", "writeMsMax": "15", "writeRatioAvg": 0.14942528735632185, "writeRatioMax": 0.1724137931034483 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.10344827586206896, "computeRatioMax": 0.2413793103448276, "endMs": "1665777480815", "id": "24", "inputStages": [ "20" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "5197", "startMs": "1665777480734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.034482758620689655, "waitRatioMax": 0.04597701149425287, "writeMsAvg": "44", "writeMsMax": "57", "writeRatioAvg": 0.5057471264367817, "writeRatioMax": 0.6551724137931034 }, { "completedParallelInputs": "100", "computeMsAvg": "17", "computeMsMax": "30", "computeRatioAvg": 0.19540229885057472, "computeRatioMax": 0.3448275862068966, "endMs": "1665777480852", "id": "25", "inputStages": [ "24", "14" ], "name": "S19: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "850021", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "7075", "startMs": "1665777480745", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $170", "FROM __stage18_output" ] }, { "kind": "FILTER", "substeps": [ "less($551, 11)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $160, $551 := $170", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($161, NUMERIC<...>)", "$101 := coalesce($161, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$550, $551", "TO __stage19_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.05747126436781609, "waitRatioMax": 0.08045977011494253, "writeMsAvg": "5", "writeMsMax": "12", "writeRatioAvg": 0.05747126436781609, "writeRatioMax": 0.13793103448275862 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.10344827586206896, "computeRatioMax": 0.25287356321839083, "endMs": "1665777480832", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "3534", "startMs": "1665777480768", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.05747126436781609, "waitRatioMax": 0.08045977011494253, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.19540229885057472, "writeRatioMax": 0.3448275862068966 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "23", "computeRatioAvg": 0.11494252873563218, "computeRatioMax": 0.26436781609195403, "endMs": "1665777480927", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "4061", "startMs": "1665777480855", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.1724137931034483, "writeRatioMax": 0.3448275862068966 }, { "completedParallelInputs": "100", "computeMsAvg": "18", "computeMsMax": "43", "computeRatioAvg": 0.20689655172413793, "computeRatioMax": 0.4942528735632184, "endMs": "1665777480952", "id": "29", "inputStages": [ "18", "15", "26", "28", "19" ], "name": "S1D: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1210121", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "4649", "startMs": "1665777480860", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $140", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$550, $551", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$581 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$580 := $572, $581 := $570, $582 := $2", "INNER HASH JOIN EACH WITH ALL ON $571 = $1" ] }, { "kind": "JOIN", "substeps": [ "$570 := $561, $571 := $562, $572 := $11", "INNER HASH JOIN EACH WITH ALL ON $560 = $10" ] }, { "kind": "JOIN", "substeps": [ "$560 := $430, $561 := $431, $562 := $550", "INNER HASH JOIN EACH WITH ALL ON $431 = $551" ] }, { "kind": "FILTER", "substeps": [ "less($431, 11)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $130, $431 := $140", "INNER HASH JOIN EACH WITH ALL ON $80 = $90, $81 = $91" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := coalesce($131, NUMERIC<...>)", "$81 := coalesce($131, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592", "TO __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.04597701149425287, "waitRatioMax": 0.05747126436781609, "writeMsAvg": "17", "writeMsMax": "25", "writeRatioAvg": 0.19540229885057472, "writeRatioMax": 0.28735632183908044 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665777480955", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777480873", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$592 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602", "TO __stage1E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.034482758620689655, "waitRatioMax": 0.034482758620689655, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.034482758620689655, "writeRatioMax": 0.034482758620689655 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "204", "completedUnits": "247", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "211", "totalSlotMs": "9944" }, { "activeUnits": "210", "completedUnits": "759", "elapsedMs": "897", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "39339" } ], "totalBytesBilled": "112197632", "totalBytesProcessed": "111556818", "totalPartitionsProcessed": "0", "totalSlotMs": "39339", "transferredBytes": "0" }, "startTime": "1665777480135", "totalBytesProcessed": "111556818", "totalSlotMs": "39339" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon882b5673_f965_4b0e_9647_82d9b60540ac" }, "priority": "INTERACTIVE", "query": "select asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n from (select item_sk,rank() over (order by rank_col asc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V1)V11\n where rnk < 11) asceding,\n (select *\n from (select item_sk,rank() over (order by rank_col desc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V2)V21\n where rnk < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n and i1.i_item_sk=asceding.item_sk\n and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "4U5yVejUrR/Qxn23yqm5bQ==", "id": "test-project-364309:europe-west1.query44_1665777482", "jobReference": { "jobId": "query44_1665777482", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query44_1665777482?location=europe-west1", "statistics": { "creationTime": "1665777483593", "endTime": "1665777484512", "finalExecutionDurationMs": "744", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "111556818", "performanceInsights": { "avgPreviousExecutionMs": "855" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "28", "computeMsMax": "35", "computeRatioAvg": 0.25, "computeRatioMax": 0.3125, "endMs": "1665777483754", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.14285714285714285, "readRatioMax": 0.16964285714285715, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "270", "startMs": "1665777483707", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$51:ss_store_sk, $52:ss_net_profit, $50:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($51, 4), is_null($50))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $51", "$310 := SHARD_AVG($52)" ] }, { "kind": "WRITE", "substeps": [ "$440, $310", "TO __stage00_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.05357142857142857, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "6", "computeMsAvg": "31", "computeMsMax": "44", "computeRatioAvg": 0.2767857142857143, "computeRatioMax": 0.39285714285714285, "endMs": "1665777483753", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.11607142857142858, "readRatioMax": 0.14285714285714285, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "248", "startMs": "1665777483710", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$41:ss_store_sk, $42:ss_net_profit, $40:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($41, 4), is_null($40))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $41", "$300 := SHARD_AVG($42)" ] }, { "kind": "WRITE", "substeps": [ "$320, $300", "TO __stage01_output", "BY HASH($320)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.044642857142857144, "writeRatioMax": 0.05357142857142857 }, { "completedParallelInputs": "6", "computeMsAvg": "76", "computeMsMax": "112", "computeRatioAvg": 0.6785714285714286, "computeRatioMax": 1, "endMs": "1665777483816", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.13392857142857142, "readRatioMax": 0.16071428571428573, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "493", "startMs": "1665777483723", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_item_sk, $32:ss_net_profit, $31:ss_store_sk", "FROM store_sales", "WHERE equal($31, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $30", "$270 := SHARD_AVG($32)" ] }, { "kind": "WRITE", "substeps": [ "$470, $270", "TO __stage02_output", "BY HASH($470)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "22", "writeMsMax": "24", "writeRatioAvg": 0.19642857142857142, "writeRatioMax": 0.21428571428571427 }, { "completedParallelInputs": "6", "computeMsAvg": "64", "computeMsMax": "95", "computeRatioAvg": 0.5714285714285714, "computeRatioMax": 0.8482142857142857, "endMs": "1665777483821", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.125, "readRatioMax": 0.16964285714285715, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "490", "startMs": "1665777483739", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_item_sk, $22:ss_net_profit, $21:ss_store_sk", "FROM store_sales", "WHERE equal($21, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $20", "$260 := SHARD_AVG($22)" ] }, { "kind": "WRITE", "substeps": [ "$350, $260", "TO __stage03_output", "BY HASH($350)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "21", "writeMsMax": "24", "writeRatioAvg": 0.1875, "writeRatioMax": 0.21428571428571427 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.10714285714285714, "computeRatioMax": 0.10714285714285714, "endMs": "1665777483801", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777483764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $300", "FROM __stage01_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$280 := ROOT_AVG($300)" ] }, { "kind": "WRITE", "substeps": [ "$280", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.23214285714285715, "writeRatioMax": 0.23214285714285715 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0625, "computeRatioMax": 0.0625, "endMs": "1665777483808", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777483766", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($280)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.017857142857142856, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.026785714285714284, "writeRatioMax": 0.026785714285714284 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0625, "computeRatioMax": 0.0625, "endMs": "1665777483801", "id": "6", "inputStages": [ "0" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777483766", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $310", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$290 := ROOT_AVG($310)" ] }, { "kind": "WRITE", "substeps": [ "$290", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.23214285714285715, "writeRatioMax": 0.23214285714285715 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.08928571428571429, "computeRatioMax": 0.08928571428571429, "endMs": "1665777483806", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777483767", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($290)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.017857142857142856, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.017857142857142856, "writeRatioMax": 0.017857142857142856 }, { "completedParallelInputs": "1", "computeMsAvg": "68", "computeMsMax": "68", "computeRatioAvg": 0.6071428571428571, "computeRatioMax": 0.6071428571428571, "endMs": "1665777483885", "id": "8", "inputStages": [ "7", "2" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777483831", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$470, $270", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, multiply(NUMERIC<...>, $240))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$250 := ROOT_AVG($270)" ] }, { "kind": "WRITE", "substeps": [ "$480, $250", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "1", "computeMsAvg": "92", "computeMsMax": "92", "computeRatioAvg": 0.8214285714285714, "computeRatioMax": 0.8214285714285714, "endMs": "1665777483913", "id": "9", "inputStages": [ "3", "5" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "93", "startMs": "1665777483848", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$350, $260", "FROM __stage03_output" ] }, { "kind": "FILTER", "substeps": [ "greater($230, multiply(NUMERIC<...>, $220))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := ROOT_AVG($260)" ] }, { "kind": "WRITE", "substeps": [ "$360, $230", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0625, "computeRatioMax": 0.0625, "endMs": "1665777483936", "id": "10", "inputStages": [ "8" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777483900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$482 := shard_sink_stats($481)" ] }, { "kind": "COMPUTE", "substeps": [ "$481 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$482", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.125, "writeRatioMax": 0.125 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0625, "computeRatioMax": 0.0625, "endMs": "1665777483953", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777483902", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$482", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$483 := root_sink_stats($482)" ] }, { "kind": "WRITE", "substeps": [ "$483", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.026785714285714284, "waitRatioMax": 0.026785714285714284, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.026785714285714284, "writeRatioMax": 0.026785714285714284 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.08928571428571429, "computeRatioMax": 0.08928571428571429, "endMs": "1665777483955", "id": "12", "inputStages": [ "9" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777483916", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$362 := shard_sink_stats($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$361 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$362", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.125, "writeRatioMax": 0.125 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.05357142857142857, "computeRatioMax": 0.05357142857142857, "endMs": "1665777483974", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777483918", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$362", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$363 := root_sink_stats($362)" ] }, { "kind": "WRITE", "substeps": [ "$363", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.026785714285714284, "waitRatioMax": 0.026785714285714284, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.1875, "computeRatioMax": 0.1875, "endMs": "1665777484042", "id": "14", "inputStages": [ "8", "11" ], "name": "S0E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777483988", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$483", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := ROW_NUMBER($483) OVER (ORDER BY $491 DESC)" ] }, { "kind": "SORT", "substeps": [ "$250 DESC" ] }, { "kind": "WRITE", "substeps": [ "$500, $150, $501", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.1875, "writeRatioMax": 0.1875 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.23214285714285715, "computeRatioMax": 0.23214285714285715, "endMs": "1665777484047", "id": "15", "inputStages": [ "13", "9" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777484002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$363", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := ROW_NUMBER($363) OVER (ORDER BY $371 ASC)" ] }, { "kind": "SORT", "substeps": [ "$230 ASC" ] }, { "kind": "WRITE", "substeps": [ "$380, $120, $381", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.17857142857142858, "writeRatioMax": 0.17857142857142858 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "20", "computeRatioAvg": 0.09821428571428571, "computeRatioMax": 0.17857142857142858, "endMs": "1665777484113", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "3251", "startMs": "1665777484068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $210", "$190 := MIN($211)" ] }, { "kind": "WRITE", "substeps": [ "$190, $530", "TO __stage10_output", "BY HASH($530)" ] } ], "waitMsAvg": "1", "waitMsMax": "8", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.07142857142857142, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.125, "writeRatioMax": 0.21428571428571427 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "25", "computeRatioAvg": 0.08928571428571429, "computeRatioMax": 0.22321428571428573, "endMs": "1665777484122", "id": "17", "inputStages": [ "15" ], "name": "S11: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8420", "shuffleOutputBytes": "218920", "shuffleOutputBytesSpilled": "0", "slotMs": "2688", "startMs": "1665777484083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $200", "$180 := MIN($201)" ] }, { "kind": "WRITE", "substeps": [ "$180, $410", "TO __stage11_output", "BY HASH($410)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "13", "writeMsMax": "22", "writeRatioAvg": 0.11607142857142858, "writeRatioMax": 0.19642857142857142 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.23214285714285715, "computeRatioMax": 0.23214285714285715, "endMs": "1665777484179", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.08035714285714286, "readRatioMax": 0.08035714285714286, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777484142", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.09821428571428571, "writeRatioMax": 0.09821428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.22321428571428573, "computeRatioMax": 0.22321428571428573, "endMs": "1665777484195", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.07142857142857142, "readRatioMax": 0.07142857142857142, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777484156", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.09821428571428571, "writeRatioMax": 0.09821428571428571 }, { "completedParallelInputs": "10", "computeMsAvg": "13", "computeMsMax": "25", "computeRatioAvg": 0.11607142857142858, "computeRatioMax": 0.22321428571428573, "endMs": "1665777484217", "id": "20", "inputStages": [ "16" ], "name": "S14: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "361", "startMs": "1665777484169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $530", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($540, NUMERIC<...>)", "$111 := coalesce($540, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530", "$170 := MIN($190)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $170", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.125, "writeRatioMax": 0.21428571428571427 }, { "completedParallelInputs": "10", "computeMsAvg": "14", "computeMsMax": "20", "computeRatioAvg": 0.125, "computeRatioMax": 0.17857142857142858, "endMs": "1665777484241", "id": "22", "inputStages": [ "17" ], "name": "S16: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8420", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "352", "startMs": "1665777484198", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $410", "FROM __stage11_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($420, NUMERIC<...>)", "$91 := coalesce($420, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$140 := MIN($180)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $140", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "11", "writeMsMax": "14", "writeRatioAvg": 0.09821428571428571, "writeRatioMax": 0.125 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.08035714285714286, "computeRatioMax": 0.15178571428571427, "endMs": "1665777484287", "id": "24", "inputStages": [ "20" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "3561", "startMs": "1665777484224", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.017857142857142856, "waitRatioMax": 0.03571428571428571, "writeMsAvg": "16", "writeMsMax": "31", "writeRatioAvg": 0.14285714285714285, "writeRatioMax": 0.2767857142857143 }, { "completedParallelInputs": "100", "computeMsAvg": "18", "computeMsMax": "34", "computeRatioAvg": 0.16071428571428573, "computeRatioMax": 0.30357142857142855, "endMs": "1665777484322", "id": "25", "inputStages": [ "24", "14" ], "name": "S19: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "850021", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "6239", "startMs": "1665777484236", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $170", "FROM __stage18_output" ] }, { "kind": "FILTER", "substeps": [ "less($551, 11)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $160, $551 := $170", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($161, NUMERIC<...>)", "$101 := coalesce($161, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$550, $551", "TO __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.017857142857142856, "waitRatioMax": 0.03571428571428571, "writeMsAvg": "5", "writeMsMax": "12", "writeRatioAvg": 0.044642857142857144, "writeRatioMax": 0.10714285714285714 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.07142857142857142, "computeRatioMax": 0.16071428571428573, "endMs": "1665777484312", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "3487", "startMs": "1665777484251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.044642857142857144, "waitRatioMax": 0.05357142857142857, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.13392857142857142, "writeRatioMax": 0.22321428571428573 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.07142857142857142, "computeRatioMax": 0.17857142857142858, "endMs": "1665777484380", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "3219", "startMs": "1665777484332", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.125, "writeRatioMax": 0.21428571428571427 }, { "completedParallelInputs": "100", "computeMsAvg": "17", "computeMsMax": "47", "computeRatioAvg": 0.15178571428571427, "computeRatioMax": 0.41964285714285715, "endMs": "1665777484411", "id": "29", "inputStages": [ "26", "19", "18", "28", "15" ], "name": "S1D: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1210121", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "3212", "startMs": "1665777484337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $140", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$550, $551", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$581 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$580 := $572, $581 := $570, $582 := $2", "INNER HASH JOIN EACH WITH ALL ON $571 = $1" ] }, { "kind": "JOIN", "substeps": [ "$570 := $561, $571 := $562, $572 := $11", "INNER HASH JOIN EACH WITH ALL ON $560 = $10" ] }, { "kind": "JOIN", "substeps": [ "$560 := $430, $561 := $431, $562 := $550", "INNER HASH JOIN EACH WITH ALL ON $431 = $551" ] }, { "kind": "FILTER", "substeps": [ "less($431, 11)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $130, $431 := $140", "INNER HASH JOIN EACH WITH ALL ON $80 = $90, $81 = $91" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := coalesce($131, NUMERIC<...>)", "$81 := coalesce($131, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592", "TO __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.03571428571428571, "waitRatioMax": 0.044642857142857144, "writeMsAvg": "7", "writeMsMax": "12", "writeRatioAvg": 0.0625, "writeRatioMax": 0.10714285714285714 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.05357142857142857, "computeRatioMax": 0.05357142857142857, "endMs": "1665777484414", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777484349", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$592 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602", "TO __stage1E_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.03571428571428571, "waitRatioMax": 0.03571428571428571, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.026785714285714284, "writeRatioMax": 0.026785714285714284 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "114", "completedUnits": "244", "elapsedMs": "575", "estimatedRunnableUnits": "0", "pendingUnits": "214", "totalSlotMs": "8215" }, { "activeUnits": "114", "completedUnits": "759", "elapsedMs": "840", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "32903" } ], "totalBytesBilled": "112197632", "totalBytesProcessed": "111556818", "totalPartitionsProcessed": "0", "totalSlotMs": "32903", "transferredBytes": "0" }, "startTime": "1665777483632", "totalBytesProcessed": "111556818", "totalSlotMs": "32903" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9f528a8a_a7c0_44ce_a0ef_bc3fa77c4b70" }, "priority": "INTERACTIVE", "query": "select asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n from (select item_sk,rank() over (order by rank_col asc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V1)V11\n where rnk < 11) asceding,\n (select *\n from (select item_sk,rank() over (order by rank_col desc) rnk\n from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n from store_sales ss1\n where ss_store_sk = 4\n group by ss_item_sk\n having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n from store_sales\n where ss_store_sk = 4\n and ss_hdemo_sk is null\n group by ss_store_sk))V2)V21\n where rnk < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n and i1.i_item_sk=asceding.item_sk\n and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "uhRb+BNpxkp2jpMXUHWWUA==", "id": "test-project-364309:europe-west1.query44_1665777485", "jobReference": { "jobId": "query44_1665777485", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query44_1665777485?location=europe-west1", "statistics": { "creationTime": "1665777486485", "endTime": "1665777487433", "finalExecutionDurationMs": "729", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "111556818", "performanceInsights": { "avgPreviousExecutionMs": "843" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "28", "computeMsMax": "37", "computeRatioAvg": 0.28, "computeRatioMax": 0.37, "endMs": "1665777486675", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.14, "readRatioMax": 0.17, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "232", "startMs": "1665777486630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$51:ss_store_sk, $52:ss_net_profit, $50:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($51, 4), is_null($50))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $51", "$310 := SHARD_AVG($52)" ] }, { "kind": "WRITE", "substeps": [ "$440, $310", "TO __stage00_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.05, "writeRatioMax": 0.07 }, { "completedParallelInputs": "6", "computeMsAvg": "28", "computeMsMax": "38", "computeRatioAvg": 0.28, "computeRatioMax": 0.38, "endMs": "1665777486678", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.14, "readRatioMax": 0.17, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "270", "startMs": "1665777486633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$41:ss_store_sk, $42:ss_net_profit, $40:ss_hdemo_sk", "FROM store_sales", "WHERE and(equal($41, 4), is_null($40))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $41", "$300 := SHARD_AVG($42)" ] }, { "kind": "WRITE", "substeps": [ "$320, $300", "TO __stage01_output", "BY HASH($320)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.05, "writeRatioMax": 0.06 }, { "completedParallelInputs": "6", "computeMsAvg": "78", "computeMsMax": "100", "computeRatioAvg": 0.78, "computeRatioMax": 1, "endMs": "1665777486736", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "21", "readRatioAvg": 0.16, "readRatioMax": 0.21, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "631", "startMs": "1665777486645", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_item_sk, $32:ss_net_profit, $31:ss_store_sk", "FROM store_sales", "WHERE equal($31, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $30", "$270 := SHARD_AVG($32)" ] }, { "kind": "WRITE", "substeps": [ "$470, $270", "TO __stage02_output", "BY HASH($470)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "20", "writeMsMax": "22", "writeRatioAvg": 0.2, "writeRatioMax": 0.22 }, { "completedParallelInputs": "6", "computeMsAvg": "58", "computeMsMax": "66", "computeRatioAvg": 0.58, "computeRatioMax": 0.66, "endMs": "1665777486735", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.15, "readRatioMax": 0.18, "recordsRead": "2880404", "recordsWritten": "102815", "shuffleOutputBytes": "2447211", "shuffleOutputBytesSpilled": "0", "slotMs": "467", "startMs": "1665777486659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_item_sk, $22:ss_net_profit, $21:ss_store_sk", "FROM store_sales", "WHERE equal($21, 4)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $20", "$260 := SHARD_AVG($22)" ] }, { "kind": "WRITE", "substeps": [ "$350, $260", "TO __stage03_output", "BY HASH($350)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "20", "writeMsMax": "22", "writeRatioAvg": 0.2, "writeRatioMax": 0.22 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09, "computeRatioMax": 0.09, "endMs": "1665777486715", "id": "4", "inputStages": [ "0" ], "name": "S04: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777486677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $310", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$290 := ROOT_AVG($310)" ] }, { "kind": "WRITE", "substeps": [ "$290", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.15, "writeRatioMax": 0.15 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.08, "computeRatioMax": 0.08, "endMs": "1665777486733", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777486679", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($290)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.02, "writeRatioMax": 0.02 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.06, "computeRatioMax": 0.06, "endMs": "1665777486717", "id": "6", "inputStages": [ "1" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777486681", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $300", "FROM __stage01_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$280 := ROOT_AVG($300)" ] }, { "kind": "WRITE", "substeps": [ "$280", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.14, "writeRatioMax": 0.14 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.06, "computeRatioMax": 0.06, "endMs": "1665777486737", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777486684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($280)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.03, "waitRatioMax": 0.03, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.03, "writeRatioMax": 0.03 }, { "completedParallelInputs": "1", "computeMsAvg": "59", "computeMsMax": "59", "computeRatioAvg": 0.59, "computeRatioMax": 0.59, "endMs": "1665777486815", "id": "8", "inputStages": [ "2", "5" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777486769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$470, $270", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, multiply(NUMERIC<...>, $240))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$250 := ROOT_AVG($270)" ] }, { "kind": "WRITE", "substeps": [ "$480, $250", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.08, "writeRatioMax": 0.08 }, { "completedParallelInputs": "1", "computeMsAvg": "88", "computeMsMax": "88", "computeRatioAvg": 0.88, "computeRatioMax": 0.88, "endMs": "1665777486850", "id": "9", "inputStages": [ "7", "3" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "102816", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665777486790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$350, $260", "FROM __stage03_output" ] }, { "kind": "FILTER", "substeps": [ "greater($230, multiply(NUMERIC<...>, $220))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := ROOT_AVG($260)" ] }, { "kind": "WRITE", "substeps": [ "$360, $230", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.08, "writeRatioMax": 0.08 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09, "computeRatioMax": 0.09, "endMs": "1665777486863", "id": "10", "inputStages": [ "8" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777486825", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$482 := shard_sink_stats($481)" ] }, { "kind": "COMPUTE", "substeps": [ "$481 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$482", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.14, "writeRatioMax": 0.14 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.1, "computeRatioMax": 0.1, "endMs": "1665777486874", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777486827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$482", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$483 := root_sink_stats($482)" ] }, { "kind": "WRITE", "substeps": [ "$483", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02, "waitRatioMax": 0.02, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.02, "writeRatioMax": 0.02 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.11, "computeRatioMax": 0.11, "endMs": "1665777486891", "id": "12", "inputStages": [ "9" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777486860", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$362 := shard_sink_stats($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$361 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$362", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.18, "writeRatioMax": 0.18 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09, "computeRatioMax": 0.09, "endMs": "1665777486906", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777486862", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$362", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$363 := root_sink_stats($362)" ] }, { "kind": "WRITE", "substeps": [ "$363", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.03, "waitRatioMax": 0.03, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.02, "writeRatioMax": 0.02 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.32, "computeRatioMax": 0.32, "endMs": "1665777486951", "id": "14", "inputStages": [ "8", "11" ], "name": "S0E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777486900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$483", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$480, $250", "FROM __stage08_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$150 := ROW_NUMBER($483) OVER (ORDER BY $491 DESC)" ] }, { "kind": "SORT", "substeps": [ "$250 DESC" ] }, { "kind": "WRITE", "substeps": [ "$500, $150, $501", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.21, "writeRatioMax": 0.21 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.28, "computeRatioMax": 0.28, "endMs": "1665777486971", "id": "15", "inputStages": [ "13", "9" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8422", "recordsWritten": "8421", "shuffleOutputBytes": "294735", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777486930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$363", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$360, $230", "FROM __stage09_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := ROW_NUMBER($363) OVER (ORDER BY $371 ASC)" ] }, { "kind": "SORT", "substeps": [ "$230 ASC" ] }, { "kind": "WRITE", "substeps": [ "$380, $120, $381", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.2, "writeRatioMax": 0.2 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "24", "computeRatioAvg": 0.11, "computeRatioMax": 0.24, "endMs": "1665777487031", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8421", "shuffleOutputBytes": "218946", "shuffleOutputBytesSpilled": "0", "slotMs": "2989", "startMs": "1665777486984", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $210", "$190 := MIN($211)" ] }, { "kind": "WRITE", "substeps": [ "$190, $530", "TO __stage10_output", "BY HASH($530)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.02, "waitRatioMax": 0.04, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.14, "writeRatioMax": 0.22 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "21", "computeRatioAvg": 0.11, "computeRatioMax": 0.21, "endMs": "1665777487041", "id": "17", "inputStages": [ "15" ], "name": "S11: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8420", "shuffleOutputBytes": "218920", "shuffleOutputBytesSpilled": "0", "slotMs": "3345", "startMs": "1665777486997", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $200", "$180 := MIN($201)" ] }, { "kind": "WRITE", "substeps": [ "$180, $410", "TO __stage11_output", "BY HASH($410)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.02, "waitRatioMax": 0.03, "writeMsAvg": "13", "writeMsMax": "29", "writeRatioAvg": 0.13, "writeRatioMax": 0.29 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.28, "computeRatioMax": 0.28, "endMs": "1665777487105", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.2, "readRatioMax": 0.2, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777487057", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.1, "writeRatioMax": 0.1 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.25, "computeRatioMax": 0.25, "endMs": "1665777487101", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.06, "readRatioMax": 0.06, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "575906", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777487070", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.11, "writeRatioMax": 0.11 }, { "completedParallelInputs": "10", "computeMsAvg": "15", "computeMsMax": "18", "computeRatioAvg": 0.15, "computeRatioMax": 0.18, "endMs": "1665777487119", "id": "20", "inputStages": [ "16" ], "name": "S14: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8421", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "329", "startMs": "1665777487082", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $530", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($540, NUMERIC<...>)", "$111 := coalesce($540, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530", "$170 := MIN($190)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $170", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "13", "writeMsMax": "16", "writeRatioAvg": 0.13, "writeRatioMax": 0.16 }, { "completedParallelInputs": "10", "computeMsAvg": "14", "computeMsMax": "23", "computeRatioAvg": 0.14, "computeRatioMax": 0.23, "endMs": "1665777487153", "id": "22", "inputStages": [ "17" ], "name": "S16: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8420", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "322", "startMs": "1665777487109", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $410", "FROM __stage11_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($420, NUMERIC<...>)", "$91 := coalesce($420, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$140 := MIN($180)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $140", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.15, "writeRatioMax": 0.21 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.08, "computeRatioMax": 0.18, "endMs": "1665777487194", "id": "24", "inputStages": [ "20" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "2960", "startMs": "1665777487141", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage14_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.08, "waitRatioMax": 0.1, "writeMsAvg": "12", "writeMsMax": "18", "writeRatioAvg": 0.12, "writeRatioMax": 0.18 }, { "completedParallelInputs": "100", "computeMsAvg": "19", "computeMsMax": "35", "computeRatioAvg": 0.19, "computeRatioMax": 0.35, "endMs": "1665777487223", "id": "25", "inputStages": [ "14", "24" ], "name": "S19: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "850021", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "5078", "startMs": "1665777487154", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $150, $501", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $170", "FROM __stage18_output" ] }, { "kind": "FILTER", "substeps": [ "less($551, 11)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $160, $551 := $170", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($161, NUMERIC<...>)", "$101 := coalesce($161, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$550, $551", "TO __stage19_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.03, "waitRatioMax": 0.04, "writeMsAvg": "5", "writeMsMax": "13", "writeRatioAvg": 0.05, "writeRatioMax": 0.13 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.09, "computeRatioMax": 0.15, "endMs": "1665777487223", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8416", "recordsWritten": "8416", "shuffleOutputBytes": "361888", "shuffleOutputBytesSpilled": "0", "slotMs": "3243", "startMs": "1665777487168", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "8", "waitRatioAvg": 0.02, "waitRatioMax": 0.08, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.13, "writeRatioMax": 0.2 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.09, "computeRatioMax": 0.19, "endMs": "1665777487289", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "3210", "startMs": "1665777487233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.01, "waitRatioMax": 0.02, "writeMsAvg": "13", "writeMsMax": "25", "writeRatioAvg": 0.13, "writeRatioMax": 0.25 }, { "completedParallelInputs": "100", "computeMsAvg": "19", "computeMsMax": "49", "computeRatioAvg": 0.19, "computeRatioMax": 0.49, "endMs": "1665777487323", "id": "29", "inputStages": [ "15", "28", "19", "18", "26" ], "name": "S1D: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1210121", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "3619", "startMs": "1665777487240", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $120, $381", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $140", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$550, $551", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$581 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$580 := $572, $581 := $570, $582 := $2", "INNER HASH JOIN EACH WITH ALL ON $571 = $1" ] }, { "kind": "JOIN", "substeps": [ "$570 := $561, $571 := $562, $572 := $11", "INNER HASH JOIN EACH WITH ALL ON $560 = $10" ] }, { "kind": "JOIN", "substeps": [ "$560 := $430, $561 := $431, $562 := $550", "INNER HASH JOIN EACH WITH ALL ON $431 = $551" ] }, { "kind": "FILTER", "substeps": [ "less($431, 11)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $130, $431 := $140", "INNER HASH JOIN EACH WITH ALL ON $80 = $90, $81 = $91" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := coalesce($131, NUMERIC<...>)", "$81 := coalesce($131, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592", "TO __stage1D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.03, "waitRatioMax": 0.05, "writeMsAvg": "5", "writeMsMax": "10", "writeRatioAvg": 0.05, "writeRatioMax": 0.1 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.08, "computeRatioMax": 0.08, "endMs": "1665777487330", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "523", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777487252", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$592 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602", "TO __stage1E_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.04, "waitRatioMax": 0.04, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.04, "writeRatioMax": 0.04 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "197", "completedUnits": "248", "elapsedMs": "593", "estimatedRunnableUnits": "0", "pendingUnits": "110", "totalSlotMs": "8926" }, { "activeUnits": "187", "completedUnits": "759", "elapsedMs": "845", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "27692" } ], "totalBytesBilled": "112197632", "totalBytesProcessed": "111556818", "totalPartitionsProcessed": "0", "totalSlotMs": "27692", "transferredBytes": "0" }, "startTime": "1665777486539", "totalBytesProcessed": "111556818", "totalSlotMs": "27692" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
