{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonaed5c5e0_38fa_4e05_a7ab_a68ad0bf77ef" }, "priority": "INTERACTIVE", "query": "-- start query 98 in stream 0 using template query98.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ss_ext_sales_price) as itemrevenue \n ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n \t,item \n \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n \tand i_category in ('Books', 'Sports', 'Home')\n \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio;\n\n-- end query 98 in stream 0 using template query98.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Y8y7A+x+Q8jCpIQ06JkYrg==", "id": "test-project-364309:europe-west1.query98_1665768534", "jobReference": { "jobId": "query98_1665768534", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query98_1665768534?location=europe-west1", "statistics": { "creationTime": "1665768535415", "endTime": "1665768536253", "finalExecutionDurationMs": "639", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "93126955", "performanceInsights": { "avgPreviousExecutionMs": "548" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.05303030303030303, "computeRatioMax": 0.05303030303030303, "endMs": "1665768535597", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.026515151515151516, "readRatioMax": 0.026515151515151516, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768535564", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04924242424242424, "writeRatioMax": 0.04924242424242424 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.14772727272727273, "computeRatioMax": 0.14772727272727273, "endMs": "1665768535638", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03787878787878788, "readRatioMax": 0.03787878787878788, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665768535581", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Books', 'Sports', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.03787878787878788, "writeRatioMax": 0.03787878787878788 }, { "completedParallelInputs": "6", "computeMsAvg": "231", "computeMsMax": "264", "computeRatioAvg": 0.875, "computeRatioMax": 1, "endMs": "1665768535851", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "30", "readRatioAvg": 0.07575757575757576, "readRatioMax": 0.11363636363636363, "recordsRead": "2912528", "recordsWritten": "6166", "shuffleOutputBytes": "1121332", "shuffleOutputBytesSpilled": "0", "slotMs": "1300", "startMs": "1665768535648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.022727272727272728, "writeRatioMax": 0.03409090909090909 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.07196969696969698, "computeRatioMax": 0.07196969696969698, "endMs": "1665768535882", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6166", "recordsWritten": "2516", "shuffleOutputBytes": "459678", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665768535860", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01893939393939394, "writeRatioMax": 0.01893939393939394 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.026515151515151516, "computeRatioMax": 0.026515151515151516, "endMs": "1665768535946", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768535910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.11363636363636363, "writeRatioMax": 0.11363636363636363 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.03409090909090909, "computeRatioMax": 0.06439393939393939, "endMs": "1665768536012", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3467", "startMs": "1665768535951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.011363636363636364, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.06818181818181818, "writeRatioMax": 0.10984848484848485 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "20", "computeRatioAvg": 0.045454545454545456, "computeRatioMax": 0.07575757575757576, "endMs": "1665768536017", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "3506", "startMs": "1665768535968", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "6", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.022727272727272728, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.05303030303030303, "writeRatioMax": 0.06818181818181818 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.06060606060606061, "computeRatioMax": 0.06060606060606061, "endMs": "1665768536144", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768536092", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003787878787878788, "waitRatioMax": 0.003787878787878788, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.09090909090909091, "writeRatioMax": 0.09090909090909091 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "211", "elapsedMs": "602", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8398" }, { "activeUnits": "0", "completedUnits": "212", "elapsedMs": "729", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8441" } ], "totalBytesBilled": "93323264", "totalBytesProcessed": "93126955", "totalPartitionsProcessed": "0", "totalSlotMs": "8441", "transferredBytes": "0" }, "startTime": "1665768535463", "totalBytesProcessed": "93126955", "totalSlotMs": "8441" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon859b6b82_7068_4ced_89bd_fce6293d142f" }, "priority": "INTERACTIVE", "query": "-- start query 98 in stream 0 using template query98.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ss_ext_sales_price) as itemrevenue \n ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n \t,item \n \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n \tand i_category in ('Books', 'Sports', 'Home')\n \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio;\n\n-- end query 98 in stream 0 using template query98.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "XbpOw4E2RvY+lFtD1HissA==", "id": "test-project-364309:europe-west1.query98_1665778900", "jobReference": { "jobId": "query98_1665778900", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query98_1665778900?location=europe-west1", "statistics": { "creationTime": "1665778900700", "endTime": "1665778901591", "finalExecutionDurationMs": "661", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "93126955", "performanceInsights": { "avgPreviousExecutionMs": "561" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03389830508474576, "computeRatioMax": 0.03389830508474576, "endMs": "1665778900903", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01977401129943503, "readRatioMax": 0.01977401129943503, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778900863", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.031073446327683617, "writeRatioMax": 0.031073446327683617 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.1271186440677966, "computeRatioMax": 0.1271186440677966, "endMs": "1665778900917", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.025423728813559324, "readRatioMax": 0.025423728813559324, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778900882", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Books', 'Sports', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.022598870056497175, "writeRatioMax": 0.022598870056497175 }, { "completedParallelInputs": "6", "computeMsAvg": "219", "computeMsMax": "354", "computeRatioAvg": 0.6186440677966102, "computeRatioMax": 1, "endMs": "1665778901146", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.03672316384180791, "readRatioMax": 0.0480225988700565, "recordsRead": "2912528", "recordsWritten": "6166", "shuffleOutputBytes": "1121332", "shuffleOutputBytesSpilled": "0", "slotMs": "1285", "startMs": "1665778900928", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.014124293785310734, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.05084745762711865, "computeRatioMax": 0.05084745762711865, "endMs": "1665778901178", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6166", "recordsWritten": "2516", "shuffleOutputBytes": "459678", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778901158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.014124293785310734, "writeRatioMax": 0.014124293785310734 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01977401129943503, "computeRatioMax": 0.01977401129943503, "endMs": "1665778901246", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778901210", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.05367231638418079, "writeRatioMax": 0.05367231638418079 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.01977401129943503, "computeRatioMax": 0.03672316384180791, "endMs": "1665778901314", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3495", "startMs": "1665778901263", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.05649717514124294, "writeRatioMax": 0.08757062146892655 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "36", "computeRatioAvg": 0.02824858757062147, "computeRatioMax": 0.1016949152542373, "endMs": "1665778901333", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "3785", "startMs": "1665778901281", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.014124293785310734, "writeMsAvg": "24", "writeMsMax": "30", "writeRatioAvg": 0.06779661016949153, "writeRatioMax": 0.0847457627118644 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.06497175141242938, "computeRatioMax": 0.06497175141242938, "endMs": "1665778901479", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778901426", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.06779661016949153, "writeRatioMax": 0.06779661016949153 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "211", "elapsedMs": "610", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8586" }, { "activeUnits": "0", "completedUnits": "212", "elapsedMs": "763", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8643" } ], "totalBytesBilled": "93323264", "totalBytesProcessed": "93126955", "totalPartitionsProcessed": "0", "totalSlotMs": "8643", "transferredBytes": "0" }, "startTime": "1665778900753", "totalBytesProcessed": "93126955", "totalSlotMs": "8643" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone3e338e3_796a_4598_b7d7_2e3ea0f1950a" }, "priority": "INTERACTIVE", "query": "-- start query 98 in stream 0 using template query98.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ss_ext_sales_price) as itemrevenue \n ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n \t,item \n \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n \tand i_category in ('Books', 'Sports', 'Home')\n \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio;\n\n-- end query 98 in stream 0 using template query98.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "CFe1JvRjwvg5CBdEgvCC7g==", "id": "test-project-364309:europe-west1.query98_1665778902", "jobReference": { "jobId": "query98_1665778902", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query98_1665778902?location=europe-west1", "statistics": { "creationTime": "1665778903206", "endTime": "1665778903974", "finalExecutionDurationMs": "573", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "93126955", "performanceInsights": { "avgPreviousExecutionMs": "574" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.040983606557377046, "computeRatioMax": 0.040983606557377046, "endMs": "1665778903371", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.020491803278688523, "readRatioMax": 0.020491803278688523, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778903344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05737704918032787, "writeRatioMax": 0.05737704918032787 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.13524590163934427, "computeRatioMax": 0.13524590163934427, "endMs": "1665778903394", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03278688524590164, "readRatioMax": 0.03278688524590164, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778903359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Books', 'Sports', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.028688524590163935, "writeRatioMax": 0.028688524590163935 }, { "completedParallelInputs": "6", "computeMsAvg": "176", "computeMsMax": "244", "computeRatioAvg": 0.7213114754098361, "computeRatioMax": 1, "endMs": "1665778903604", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.05737704918032787, "readRatioMax": 0.07377049180327869, "recordsRead": "2912528", "recordsWritten": "6166", "shuffleOutputBytes": "1121332", "shuffleOutputBytesSpilled": "0", "slotMs": "1085", "startMs": "1665778903412", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.020491803278688523, "writeRatioMax": 0.02459016393442623 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.07377049180327869, "computeRatioMax": 0.07377049180327869, "endMs": "1665778903634", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6166", "recordsWritten": "2516", "shuffleOutputBytes": "459678", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778903614", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.020491803278688523, "writeRatioMax": 0.020491803278688523 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.020491803278688523, "computeRatioMax": 0.020491803278688523, "endMs": "1665778903705", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778903666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.08196721311475409, "writeRatioMax": 0.08196721311475409 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.03278688524590164, "computeRatioMax": 0.06557377049180328, "endMs": "1665778903775", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4708", "startMs": "1665778903720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.01639344262295082, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.08196721311475409, "writeRatioMax": 0.12704918032786885 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "31", "computeRatioAvg": 0.040983606557377046, "computeRatioMax": 0.12704918032786885, "endMs": "1665778903794", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "4421", "startMs": "1665778903739", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.01639344262295082, "writeMsAvg": "16", "writeMsMax": "32", "writeRatioAvg": 0.06557377049180328, "writeRatioMax": 0.13114754098360656 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.11065573770491803, "computeRatioMax": 0.11065573770491803, "endMs": "1665778903869", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665778903804", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.10655737704918032, "writeRatioMax": 0.10655737704918032 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "596", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "10200" }, { "activeUnits": "1", "completedUnits": "212", "elapsedMs": "674", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10282" } ], "totalBytesBilled": "93323264", "totalBytesProcessed": "93126955", "totalPartitionsProcessed": "0", "totalSlotMs": "10282", "transferredBytes": "0" }, "startTime": "1665778903248", "totalBytesProcessed": "93126955", "totalSlotMs": "10282" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona5faeb72_41f4_4923_af68_69ca1f1d8a22" }, "priority": "INTERACTIVE", "query": "-- start query 98 in stream 0 using template query98.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ss_ext_sales_price) as itemrevenue \n ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n \t,item \n \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n \tand i_category in ('Books', 'Sports', 'Home')\n \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio;\n\n-- end query 98 in stream 0 using template query98.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "+sYF6nXSvijfWMx/z1V7eA==", "id": "test-project-364309:europe-west1.query98_1665778905", "jobReference": { "jobId": "query98_1665778905", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query98_1665778905?location=europe-west1", "statistics": { "creationTime": "1665778905621", "endTime": "1665778906430", "finalExecutionDurationMs": "622", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "93126955", "performanceInsights": { "avgPreviousExecutionMs": "574" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.05782312925170068, "computeRatioMax": 0.05782312925170068, "endMs": "1665778905786", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03741496598639456, "readRatioMax": 0.03741496598639456, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778905753", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.034013605442176874, "writeRatioMax": 0.034013605442176874 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.1054421768707483, "computeRatioMax": 0.1054421768707483, "endMs": "1665778905803", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.027210884353741496, "readRatioMax": 0.027210884353741496, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778905765", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Books', 'Sports', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.030612244897959183, "writeRatioMax": 0.030612244897959183 }, { "completedParallelInputs": "6", "computeMsAvg": "194", "computeMsMax": "294", "computeRatioAvg": 0.6598639455782312, "computeRatioMax": 1, "endMs": "1665778905978", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.04421768707482993, "readRatioMax": 0.05442176870748299, "recordsRead": "2912528", "recordsWritten": "6166", "shuffleOutputBytes": "1121332", "shuffleOutputBytesSpilled": "0", "slotMs": "1093", "startMs": "1665778905814", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.017006802721088437, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.05782312925170068, "computeRatioMax": 0.05782312925170068, "endMs": "1665778906010", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6166", "recordsWritten": "2516", "shuffleOutputBytes": "459678", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778905990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02040816326530612, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03741496598639456, "computeRatioMax": 0.03741496598639456, "endMs": "1665778906074", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778906036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.061224489795918366, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.027210884353741496, "computeRatioMax": 0.05442176870748299, "endMs": "1665778906137", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3619", "startMs": "1665778906084", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "21", "writeMsMax": "38", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.1292517006802721 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.030612244897959183, "computeRatioMax": 0.05782312925170068, "endMs": "1665778906144", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "3360", "startMs": "1665778906098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.006802721088435374, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.047619047619047616, "writeRatioMax": 0.05782312925170068 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.08163265306122448, "computeRatioMax": 0.08163265306122448, "endMs": "1665778906322", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778906275", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.0782312925170068, "writeRatioMax": 0.0782312925170068 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "211", "elapsedMs": "581", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8140" }, { "activeUnits": "0", "completedUnits": "212", "elapsedMs": "703", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8193" } ], "totalBytesBilled": "93323264", "totalBytesProcessed": "93126955", "totalPartitionsProcessed": "0", "totalSlotMs": "8193", "transferredBytes": "0" }, "startTime": "1665778905673", "totalBytesProcessed": "93126955", "totalSlotMs": "8193" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0d1238cc_2624_4fa0_91d7_7cae748a446d" }, "priority": "INTERACTIVE", "query": "-- start query 98 in stream 0 using template query98.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ss_ext_sales_price) as itemrevenue \n ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n \t,item \n \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n \tand i_category in ('Books', 'Sports', 'Home')\n \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio;\n\n-- end query 98 in stream 0 using template query98.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "DBlMNfkhFn8+85URNRRtRQ==", "id": "test-project-364309:europe-west1.query98_1665778907", "jobReference": { "jobId": "query98_1665778907", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query98_1665778907?location=europe-west1", "statistics": { "creationTime": "1665778908125", "endTime": "1665778908788", "finalExecutionDurationMs": "481", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "93126955", "performanceInsights": { "avgPreviousExecutionMs": "578" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.043795620437956206, "computeRatioMax": 0.043795620437956206, "endMs": "1665778908307", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.021897810218978103, "readRatioMax": 0.021897810218978103, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665778908261", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.06934306569343066, "writeRatioMax": 0.06934306569343066 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.13503649635036497, "computeRatioMax": 0.13503649635036497, "endMs": "1665778908319", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.043795620437956206, "readRatioMax": 0.043795620437956206, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778908274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Books', 'Sports', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.040145985401459854, "writeRatioMax": 0.040145985401459854 }, { "completedParallelInputs": "6", "computeMsAvg": "199", "computeMsMax": "274", "computeRatioAvg": 0.7262773722627737, "computeRatioMax": 1, "endMs": "1665778908492", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "20", "readRatioAvg": 0.05474452554744526, "readRatioMax": 0.072992700729927, "recordsRead": "2912528", "recordsWritten": "6166", "shuffleOutputBytes": "1121332", "shuffleOutputBytesSpilled": "0", "slotMs": "1108", "startMs": "1665778908330", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.01824817518248175, "writeRatioMax": 0.021897810218978103 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.058394160583941604, "computeRatioMax": 0.058394160583941604, "endMs": "1665778908521", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6166", "recordsWritten": "2516", "shuffleOutputBytes": "459678", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665778908504", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.014598540145985401, "writeRatioMax": 0.014598540145985401 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.040145985401459854, "computeRatioMax": 0.040145985401459854, "endMs": "1665778908580", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778908550", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.07664233576642336, "writeRatioMax": 0.07664233576642336 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.025547445255474453, "computeRatioMax": 0.04744525547445255, "endMs": "1665778908633", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3370", "startMs": "1665778908583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.051094890510948905, "writeRatioMax": 0.06934306569343066 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "30", "computeRatioAvg": 0.0364963503649635, "computeRatioMax": 0.10948905109489052, "endMs": "1665778908642", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "3379", "startMs": "1665778908598", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "5", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.01824817518248175, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.051094890510948905, "writeRatioMax": 0.08394160583941605 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.07664233576642336, "computeRatioMax": 0.07664233576642336, "endMs": "1665778908687", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778908646", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.08394160583941605, "writeRatioMax": 0.08394160583941605 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "212", "elapsedMs": "565", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8076" } ], "totalBytesBilled": "93323264", "totalBytesProcessed": "93126955", "totalPartitionsProcessed": "0", "totalSlotMs": "8076", "transferredBytes": "0" }, "startTime": "1665778908173", "totalBytesProcessed": "93126955", "totalSlotMs": "8076" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon329e41d0_5cde_4128_9246_da3ad216a845" }, "priority": "INTERACTIVE", "query": "-- start query 98 in stream 0 using template query98.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ss_ext_sales_price) as itemrevenue \n ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n \t,item \n \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n \tand i_category in ('Books', 'Sports', 'Home')\n \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio;\n\n-- end query 98 in stream 0 using template query98.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/HuL4l0MJ8ijvKAdvCmMFw==", "id": "test-project-364309:europe-west1.query98_1665778909", "jobReference": { "jobId": "query98_1665778909", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query98_1665778909?location=europe-west1", "statistics": { "creationTime": "1665778910450", "endTime": "1665778911271", "finalExecutionDurationMs": "611", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "93126955", "performanceInsights": { "avgPreviousExecutionMs": "570" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03508771929824561, "computeRatioMax": 0.03508771929824561, "endMs": "1665778910636", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.017543859649122806, "readRatioMax": 0.017543859649122806, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778910597", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.0035087719298245615, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04912280701754386, "writeRatioMax": 0.04912280701754386 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.12631578947368421, "computeRatioMax": 0.12631578947368421, "endMs": "1665778910656", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.031578947368421054, "readRatioMax": 0.031578947368421054, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778910612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Books', 'Sports', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.017543859649122806, "waitRatioMax": 0.017543859649122806, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03859649122807018, "writeRatioMax": 0.03859649122807018 }, { "completedParallelInputs": "6", "computeMsAvg": "216", "computeMsMax": "285", "computeRatioAvg": 0.7578947368421053, "computeRatioMax": 1, "endMs": "1665778910853", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.0456140350877193, "readRatioMax": 0.056140350877192984, "recordsRead": "2912528", "recordsWritten": "6166", "shuffleOutputBytes": "1121332", "shuffleOutputBytesSpilled": "0", "slotMs": "1431", "startMs": "1665778910673", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.0035087719298245615, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.014035087719298246, "writeRatioMax": 0.017543859649122806 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.07017543859649122, "computeRatioMax": 0.07017543859649122, "endMs": "1665778910882", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6166", "recordsWritten": "2516", "shuffleOutputBytes": "459678", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778910859", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.0035087719298245615, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.021052631578947368, "writeRatioMax": 0.021052631578947368 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03508771929824561, "computeRatioMax": 0.03508771929824561, "endMs": "1665778910944", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778910906", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.0035087719298245615, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.06315789473684211, "writeRatioMax": 0.06315789473684211 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.02456140350877193, "computeRatioMax": 0.05263157894736842, "endMs": "1665778910999", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3182", "startMs": "1665778910955", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.007017543859649123, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.04912280701754386, "writeRatioMax": 0.06315789473684211 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.031578947368421054, "computeRatioMax": 0.056140350877192984, "endMs": "1665778911011", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "3466", "startMs": "1665778910968", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.010526315789473684, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.04912280701754386, "writeRatioMax": 0.05964912280701754 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.06315789473684211, "computeRatioMax": 0.06315789473684211, "endMs": "1665778911168", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2516", "recordsWritten": "2516", "shuffleOutputBytes": "502338", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778911131", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30, $50, $51, $52, $53, $54, $56", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035087719298245615, "waitRatioMax": 0.0035087719298245615, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.07368421052631578, "writeRatioMax": 0.07368421052631578 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "211", "elapsedMs": "590", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8269" }, { "activeUnits": "0", "completedUnits": "212", "elapsedMs": "698", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8305" } ], "totalBytesBilled": "93323264", "totalBytesProcessed": "93126955", "totalPartitionsProcessed": "0", "totalSlotMs": "8305", "transferredBytes": "0" }, "startTime": "1665778910508", "totalBytesProcessed": "93126955", "totalSlotMs": "8305" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
