{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0d4076a8_3719_4587_b38b_190fea734939" }, "priority": "INTERACTIVE", "query": "-- start query 71 in stream 0 using template query71.tpl\n\n/*\nSelect the top revenue generating products, sold during breakfast or dinner time \nfor one month managed by a given manager across all three sales channels.\n*/\n\nselect i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n ws_sold_date_sk as sold_date_sk,\n ws_item_sk as sold_item_sk,\n ws_sold_time_sk as time_sk \n from web_sales,date_dim\n where d_date_sk = ws_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select cs_ext_sales_price as ext_price,\n cs_sold_date_sk as sold_date_sk,\n cs_item_sk as sold_item_sk,\n cs_sold_time_sk as time_sk\n from catalog_sales,date_dim\n where d_date_sk = cs_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select ss_ext_sales_price as ext_price,\n ss_sold_date_sk as sold_date_sk,\n ss_item_sk as sold_item_sk,\n ss_sold_time_sk as time_sk\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n and d_moy=11\n and d_year=1999\n ) tmp,time_dim\n where\n sold_item_sk = i_item_sk\n and i_manager_id=1\n and time_sk = t_time_sk\n and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;\n\n-- end query 71 in stream 0 using template query71.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "y4gjIB0I+vWr5i4tLcIDjA==", "id": "test-project-364309:europe-west1.query71_1665768444", "jobReference": { "jobId": "query71_1665768444", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query71_1665768444?location=europe-west1", "statistics": { "creationTime": "1665768444787", "endTime": "1665768445465", "finalExecutionDurationMs": "458", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "202160581", "performanceInsights": { "avgPreviousExecutionMs": "421" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.10830324909747292, "computeRatioMax": 0.10830324909747292, "endMs": "1665768445015", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.036101083032490974, "readRatioMax": 0.036101083032490974, "recordsRead": "86400", "recordsWritten": "25200", "shuffleOutputBytes": "680400", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768444970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time", "FROM time_dim", "WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036101083032490976, "waitRatioMax": 0.0036101083032490976, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04332129963898917, "writeRatioMax": 0.04332129963898917 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.039711191335740074, "computeRatioMax": 0.039711191335740074, "endMs": "1665768445024", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02888086642599278, "readRatioMax": 0.02888086642599278, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "12628", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768444987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id", "FROM item", "WHERE equal($13, 1)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036101083032490976, "waitRatioMax": 0.0036101083032490976, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02888086642599278, "writeRatioMax": 0.02888086642599278 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04332129963898917, "computeRatioMax": 0.04332129963898917, "endMs": "1665768445038", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02527075812274368, "readRatioMax": 0.02527075812274368, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768445004", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE and(equal($72, 11), equal($71, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036101083032490976, "waitRatioMax": 0.0036101083032490976, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.061371841155234655, "writeRatioMax": 0.061371841155234655 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04693140794223827, "computeRatioMax": 0.04693140794223827, "endMs": "1665768445086", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.036101083032490974, "readRatioMax": 0.036101083032490974, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768445037", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($62, 11), equal($61, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036101083032490976, "waitRatioMax": 0.0036101083032490976, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05776173285198556, "writeRatioMax": 0.05776173285198556 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.08303249097472924, "computeRatioMax": 0.08303249097472924, "endMs": "1665768445128", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.039711191335740074, "readRatioMax": 0.039711191335740074, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768445076", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010830324909747292, "waitRatioMax": 0.010830324909747292, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05054151624548736, "writeRatioMax": 0.05054151624548736 }, { "completedParallelInputs": "12", "computeMsAvg": "170", "computeMsMax": "277", "computeRatioAvg": 0.6137184115523465, "computeRatioMax": 1, "endMs": "1665768445313", "id": "8", "inputStages": [ "1", "0", "6", "4", "2" ], "name": "S08: Join+", "parallelInputs": "12", "readMsAvg": "21", "readMsMax": "38", "readRatioAvg": 0.07581227436823104, "readRatioMax": 0.1371841155234657, "recordsRead": "5347948", "recordsWritten": "1049", "shuffleOutputBytes": "68550", "shuffleOutputBytesSpilled": "0", "slotMs": "2049", "startMs": "1665768445134", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184", "$90 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $172, $183 := $2, $184 := $3", "INNER HASH JOIN EACH WITH ALL ON $173 = $1" ] }, { "kind": "JOIN", "substeps": [ "$172 := $100, $173 := $102, $170 := $11, $171 := $12", "INNER HASH JOIN EACH WITH ALL ON $101 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "JOIN", "substeps": [ "$140 := $31, $141 := $32, $142 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$192, $193, $191, $190, $90", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0036101083032490976, "waitRatioMax": 0.007220216606498195, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.018050541516245487, "writeRatioMax": 0.02888086642599278 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.039711191335740074, "computeRatioMax": 0.039711191335740074, "endMs": "1665768445341", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1049", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665768445321", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$192, $193, $191, $190, $90", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)" ] }, { "kind": "WRITE", "substeps": [ "$202, $203, $201, $200, $80", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007220216606498195, "waitRatioMax": 0.007220216606498195, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.021660649819494584, "writeRatioMax": 0.021660649819494584 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04332129963898917, "computeRatioMax": 0.04332129963898917, "endMs": "1665768445391", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1018", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665768445353", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$202, $203, $201, $200, $80", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$80 DESC, $201 ASC" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036101083032490976, "waitRatioMax": 0.0036101083032490976, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05415162454873646, "writeRatioMax": 0.05415162454873646 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "19", "elapsedMs": "580", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2346" } ], "totalBytesBilled": "202375168", "totalBytesProcessed": "202160581", "totalPartitionsProcessed": "0", "totalSlotMs": "2346", "transferredBytes": "0" }, "startTime": "1665768444838", "totalBytesProcessed": "202160581", "totalSlotMs": "2346" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4cf19156_ca48_45ce_b29a_991231470158" }, "priority": "INTERACTIVE", "query": "-- start query 71 in stream 0 using template query71.tpl\n\n/*\nSelect the top revenue generating products, sold during breakfast or dinner time \nfor one month managed by a given manager across all three sales channels.\n*/\n\nselect i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n ws_sold_date_sk as sold_date_sk,\n ws_item_sk as sold_item_sk,\n ws_sold_time_sk as time_sk \n from web_sales,date_dim\n where d_date_sk = ws_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select cs_ext_sales_price as ext_price,\n cs_sold_date_sk as sold_date_sk,\n cs_item_sk as sold_item_sk,\n cs_sold_time_sk as time_sk\n from catalog_sales,date_dim\n where d_date_sk = cs_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select ss_ext_sales_price as ext_price,\n ss_sold_date_sk as sold_date_sk,\n ss_item_sk as sold_item_sk,\n ss_sold_time_sk as time_sk\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n and d_moy=11\n and d_year=1999\n ) tmp,time_dim\n where\n sold_item_sk = i_item_sk\n and i_manager_id=1\n and time_sk = t_time_sk\n and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;\n\n-- end query 71 in stream 0 using template query71.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Ca6JnR3IpEIu2mux3miFCA==", "id": "test-project-364309:europe-west1.query71_1665778447", "jobReference": { "jobId": "query71_1665778447", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query71_1665778447?location=europe-west1", "statistics": { "creationTime": "1665778447933", "endTime": "1665778448623", "finalExecutionDurationMs": "401", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "202160581", "performanceInsights": { "avgPreviousExecutionMs": "431" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.10648148148148148, "computeRatioMax": 0.10648148148148148, "endMs": "1665778448195", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.046296296296296294, "readRatioMax": 0.046296296296296294, "recordsRead": "86400", "recordsWritten": "25200", "shuffleOutputBytes": "680400", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778448160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time", "FROM time_dim", "WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.037037037037037035, "writeRatioMax": 0.037037037037037035 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.06018518518518518, "computeRatioMax": 0.06018518518518518, "endMs": "1665778448209", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.05555555555555555, "readRatioMax": 0.05555555555555555, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "12628", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778448176", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id", "FROM item", "WHERE equal($13, 1)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05092592592592592, "writeRatioMax": 0.05092592592592592 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05092592592592592, "computeRatioMax": 0.05092592592592592, "endMs": "1665778448225", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.032407407407407406, "readRatioMax": 0.032407407407407406, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778448190", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE and(equal($72, 11), equal($71, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.032407407407407406, "writeRatioMax": 0.032407407407407406 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.046296296296296294, "computeRatioMax": 0.046296296296296294, "endMs": "1665778448257", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.027777777777777776, "readRatioMax": 0.027777777777777776, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778448219", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($62, 11), equal($61, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009259259259259259, "waitRatioMax": 0.009259259259259259, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06944444444444445, "writeRatioMax": 0.06944444444444445 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.046296296296296294, "computeRatioMax": 0.046296296296296294, "endMs": "1665778448288", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.027777777777777776, "readRatioMax": 0.027777777777777776, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778448249", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06481481481481481, "writeRatioMax": 0.06481481481481481 }, { "completedParallelInputs": "12", "computeMsAvg": "160", "computeMsMax": "216", "computeRatioAvg": 0.7407407407407407, "computeRatioMax": 1, "endMs": "1665778448454", "id": "8", "inputStages": [ "2", "4", "6", "1", "0" ], "name": "S08: Join+", "parallelInputs": "12", "readMsAvg": "17", "readMsMax": "28", "readRatioAvg": 0.0787037037037037, "readRatioMax": 0.12962962962962962, "recordsRead": "5347948", "recordsWritten": "1049", "shuffleOutputBytes": "68550", "shuffleOutputBytesSpilled": "0", "slotMs": "1915", "startMs": "1665778448307", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184", "$90 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $172, $183 := $2, $184 := $3", "INNER HASH JOIN EACH WITH ALL ON $173 = $1" ] }, { "kind": "JOIN", "substeps": [ "$172 := $100, $173 := $102, $170 := $11, $171 := $12", "INNER HASH JOIN EACH WITH ALL ON $101 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "JOIN", "substeps": [ "$140 := $31, $141 := $32, $142 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$192, $193, $191, $190, $90", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.009259259259259259, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.023148148148148147, "writeRatioMax": 0.027777777777777776 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05092592592592592, "computeRatioMax": 0.05092592592592592, "endMs": "1665778448478", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1049", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665778448464", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$192, $193, $191, $190, $90", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)" ] }, { "kind": "WRITE", "substeps": [ "$202, $203, $201, $200, $80", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009259259259259259, "waitRatioMax": 0.009259259259259259, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.023148148148148147, "writeRatioMax": 0.023148148148148147 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.05555555555555555, "endMs": "1665778448524", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1018", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778448485", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$202, $203, $201, $200, $80", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$80 DESC, $201 ASC" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009259259259259259, "waitRatioMax": 0.009259259259259259, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06481481481481481, "writeRatioMax": 0.06481481481481481 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "19", "elapsedMs": "570", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2161" } ], "totalBytesBilled": "202375168", "totalBytesProcessed": "202160581", "totalPartitionsProcessed": "0", "totalSlotMs": "2161", "transferredBytes": "0" }, "startTime": "1665778447998", "totalBytesProcessed": "202160581", "totalSlotMs": "2161" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1d630af1_907d_420d_855c_97c64a6cc1f1" }, "priority": "INTERACTIVE", "query": "-- start query 71 in stream 0 using template query71.tpl\n\n/*\nSelect the top revenue generating products, sold during breakfast or dinner time \nfor one month managed by a given manager across all three sales channels.\n*/\n\nselect i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n ws_sold_date_sk as sold_date_sk,\n ws_item_sk as sold_item_sk,\n ws_sold_time_sk as time_sk \n from web_sales,date_dim\n where d_date_sk = ws_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select cs_ext_sales_price as ext_price,\n cs_sold_date_sk as sold_date_sk,\n cs_item_sk as sold_item_sk,\n cs_sold_time_sk as time_sk\n from catalog_sales,date_dim\n where d_date_sk = cs_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select ss_ext_sales_price as ext_price,\n ss_sold_date_sk as sold_date_sk,\n ss_item_sk as sold_item_sk,\n ss_sold_time_sk as time_sk\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n and d_moy=11\n and d_year=1999\n ) tmp,time_dim\n where\n sold_item_sk = i_item_sk\n and i_manager_id=1\n and time_sk = t_time_sk\n and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;\n\n-- end query 71 in stream 0 using template query71.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "HNGPrq9sdTZKQDukzURMGA==", "id": "test-project-364309:europe-west1.query71_1665778449", "jobReference": { "jobId": "query71_1665778449", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query71_1665778449?location=europe-west1", "statistics": { "creationTime": "1665778450278", "endTime": "1665778451004", "finalExecutionDurationMs": "474", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "202160581", "performanceInsights": { "avgPreviousExecutionMs": "425" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.12121212121212122, "computeRatioMax": 0.12121212121212122, "endMs": "1665778450511", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.021645021645021644, "readRatioMax": 0.021645021645021644, "recordsRead": "86400", "recordsWritten": "25200", "shuffleOutputBytes": "680400", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778450464", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time", "FROM time_dim", "WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05627705627705628, "writeRatioMax": 0.05627705627705628 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.047619047619047616, "endMs": "1665778450536", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.021645021645021644, "readRatioMax": 0.021645021645021644, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "12628", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778450492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id", "FROM item", "WHERE equal($13, 1)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0735930735930736, "writeRatioMax": 0.0735930735930736 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04329004329004329, "computeRatioMax": 0.04329004329004329, "endMs": "1665778450547", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.025974025974025976, "readRatioMax": 0.025974025974025976, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778450505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE and(equal($72, 11), equal($71, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.06060606060606061 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.06493506493506493, "computeRatioMax": 0.06493506493506493, "endMs": "1665778450575", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030303030303030304, "readRatioMax": 0.030303030303030304, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778450539", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($62, 11), equal($61, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04329004329004329, "computeRatioMax": 0.04329004329004329, "endMs": "1665778450606", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03463203463203463, "readRatioMax": 0.03463203463203463, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778450567", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03463203463203463, "writeRatioMax": 0.03463203463203463 }, { "completedParallelInputs": "12", "computeMsAvg": "141", "computeMsMax": "231", "computeRatioAvg": 0.6103896103896104, "computeRatioMax": 1, "endMs": "1665778450814", "id": "8", "inputStages": [ "6", "4", "1", "0", "2" ], "name": "S08: Join+", "parallelInputs": "12", "readMsAvg": "18", "readMsMax": "29", "readRatioAvg": 0.07792207792207792, "readRatioMax": 0.12554112554112554, "recordsRead": "5347948", "recordsWritten": "1049", "shuffleOutputBytes": "68550", "shuffleOutputBytesSpilled": "0", "slotMs": "2176", "startMs": "1665778450619", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184", "$90 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $172, $183 := $2, $184 := $3", "INNER HASH JOIN EACH WITH ALL ON $173 = $1" ] }, { "kind": "JOIN", "substeps": [ "$172 := $100, $173 := $102, $170 := $11, $171 := $12", "INNER HASH JOIN EACH WITH ALL ON $101 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "JOIN", "substeps": [ "$140 := $31, $141 := $32, $142 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$192, $193, $191, $190, $90", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.017316017316017316, "writeRatioMax": 0.025974025974025976 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.047619047619047616, "endMs": "1665778450863", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1049", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665778450845", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$192, $193, $191, $190, $90", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)" ] }, { "kind": "WRITE", "substeps": [ "$202, $203, $201, $200, $80", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.025974025974025976, "writeRatioMax": 0.025974025974025976 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.030303030303030304, "computeRatioMax": 0.030303030303030304, "endMs": "1665778450905", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1018", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778450870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$202, $203, $201, $200, $80", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$80 DESC, $201 ASC" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.06060606060606061 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "19", "elapsedMs": "609", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2577" } ], "totalBytesBilled": "202375168", "totalBytesProcessed": "202160581", "totalPartitionsProcessed": "0", "totalSlotMs": "2577", "transferredBytes": "0" }, "startTime": "1665778450327", "totalBytesProcessed": "202160581", "totalSlotMs": "2577" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon553d6402_b45b_484d_925c_c28c923b7a4b" }, "priority": "INTERACTIVE", "query": "-- start query 71 in stream 0 using template query71.tpl\n\n/*\nSelect the top revenue generating products, sold during breakfast or dinner time \nfor one month managed by a given manager across all three sales channels.\n*/\n\nselect i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n ws_sold_date_sk as sold_date_sk,\n ws_item_sk as sold_item_sk,\n ws_sold_time_sk as time_sk \n from web_sales,date_dim\n where d_date_sk = ws_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select cs_ext_sales_price as ext_price,\n cs_sold_date_sk as sold_date_sk,\n cs_item_sk as sold_item_sk,\n cs_sold_time_sk as time_sk\n from catalog_sales,date_dim\n where d_date_sk = cs_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select ss_ext_sales_price as ext_price,\n ss_sold_date_sk as sold_date_sk,\n ss_item_sk as sold_item_sk,\n ss_sold_time_sk as time_sk\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n and d_moy=11\n and d_year=1999\n ) tmp,time_dim\n where\n sold_item_sk = i_item_sk\n and i_manager_id=1\n and time_sk = t_time_sk\n and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;\n\n-- end query 71 in stream 0 using template query71.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "iWhFbwBPPdl+wnsc+3HUVg==", "id": "test-project-364309:europe-west1.query71_1665778452", "jobReference": { "jobId": "query71_1665778452", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query71_1665778452?location=europe-west1", "statistics": { "creationTime": "1665778452684", "endTime": "1665778453331", "finalExecutionDurationMs": "404", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "202160581", "performanceInsights": { "avgPreviousExecutionMs": "433" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.09178743961352658, "computeRatioMax": 0.09178743961352658, "endMs": "1665778452932", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.028985507246376812, "readRatioMax": 0.028985507246376812, "recordsRead": "86400", "recordsWritten": "25200", "shuffleOutputBytes": "680400", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778452886", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time", "FROM time_dim", "WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07246376811594203, "writeRatioMax": 0.07246376811594203 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06763285024154589, "computeRatioMax": 0.06763285024154589, "endMs": "1665778452939", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.033816425120772944, "readRatioMax": 0.033816425120772944, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "12628", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778452903", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id", "FROM item", "WHERE equal($13, 1)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06763285024154589, "computeRatioMax": 0.06763285024154589, "endMs": "1665778452967", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04830917874396135, "readRatioMax": 0.04830917874396135, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778452920", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE and(equal($72, 11), equal($71, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06763285024154589, "writeRatioMax": 0.06763285024154589 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06763285024154589, "computeRatioMax": 0.06763285024154589, "endMs": "1665778453007", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03864734299516908, "readRatioMax": 0.03864734299516908, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778452963", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($62, 11), equal($61, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.03864734299516908, "waitRatioMax": 0.03864734299516908, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07246376811594203, "writeRatioMax": 0.07246376811594203 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03864734299516908, "computeRatioMax": 0.03864734299516908, "endMs": "1665778453019", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03864734299516908, "readRatioMax": 0.03864734299516908, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778452986", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.033816425120772944, "writeRatioMax": 0.033816425120772944 }, { "completedParallelInputs": "12", "computeMsAvg": "145", "computeMsMax": "207", "computeRatioAvg": 0.7004830917874396, "computeRatioMax": 1, "endMs": "1665778453187", "id": "8", "inputStages": [ "0", "6", "2", "4", "1" ], "name": "S08: Join+", "parallelInputs": "12", "readMsAvg": "19", "readMsMax": "33", "readRatioAvg": 0.09178743961352658, "readRatioMax": 0.15942028985507245, "recordsRead": "5347948", "recordsWritten": "1049", "shuffleOutputBytes": "68550", "shuffleOutputBytesSpilled": "0", "slotMs": "1819", "startMs": "1665778453036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184", "$90 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $172, $183 := $2, $184 := $3", "INNER HASH JOIN EACH WITH ALL ON $173 = $1" ] }, { "kind": "JOIN", "substeps": [ "$172 := $100, $173 := $102, $170 := $11, $171 := $12", "INNER HASH JOIN EACH WITH ALL ON $101 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "JOIN", "substeps": [ "$140 := $31, $141 := $32, $142 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$192, $193, $191, $190, $90", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "5", "writeMsMax": "10", "writeRatioAvg": 0.024154589371980676, "writeRatioMax": 0.04830917874396135 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04830917874396135, "computeRatioMax": 0.04830917874396135, "endMs": "1665778453217", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1049", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665778453203", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$192, $193, $191, $190, $90", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)" ] }, { "kind": "WRITE", "substeps": [ "$202, $203, $201, $200, $80", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01932367149758454, "writeRatioMax": 0.01932367149758454 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03864734299516908, "computeRatioMax": 0.03864734299516908, "endMs": "1665778453257", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1018", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778453221", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$202, $203, $201, $200, $80", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$80 DESC, $201 ASC" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07729468599033816, "writeRatioMax": 0.07729468599033816 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "19", "elapsedMs": "519", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2171" } ], "totalBytesBilled": "202375168", "totalBytesProcessed": "202160581", "totalPartitionsProcessed": "0", "totalSlotMs": "2171", "transferredBytes": "0" }, "startTime": "1665778452765", "totalBytesProcessed": "202160581", "totalSlotMs": "2171" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon574bad30_5fc0_4ecf_9716_642c847d5a65" }, "priority": "INTERACTIVE", "query": "-- start query 71 in stream 0 using template query71.tpl\n\n/*\nSelect the top revenue generating products, sold during breakfast or dinner time \nfor one month managed by a given manager across all three sales channels.\n*/\n\nselect i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n ws_sold_date_sk as sold_date_sk,\n ws_item_sk as sold_item_sk,\n ws_sold_time_sk as time_sk \n from web_sales,date_dim\n where d_date_sk = ws_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select cs_ext_sales_price as ext_price,\n cs_sold_date_sk as sold_date_sk,\n cs_item_sk as sold_item_sk,\n cs_sold_time_sk as time_sk\n from catalog_sales,date_dim\n where d_date_sk = cs_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select ss_ext_sales_price as ext_price,\n ss_sold_date_sk as sold_date_sk,\n ss_item_sk as sold_item_sk,\n ss_sold_time_sk as time_sk\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n and d_moy=11\n and d_year=1999\n ) tmp,time_dim\n where\n sold_item_sk = i_item_sk\n and i_manager_id=1\n and time_sk = t_time_sk\n and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;\n\n-- end query 71 in stream 0 using template query71.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "JZW3lvmMf8K079Z+6j6DyQ==", "id": "test-project-364309:europe-west1.query71_1665778454", "jobReference": { "jobId": "query71_1665778454", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query71_1665778454?location=europe-west1", "statistics": { "creationTime": "1665778454924", "endTime": "1665778455535", "finalExecutionDurationMs": "369", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "202160581", "performanceInsights": { "avgPreviousExecutionMs": "429" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.07659574468085106, "computeRatioMax": 0.07659574468085106, "endMs": "1665778455127", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02553191489361702, "readRatioMax": 0.02553191489361702, "recordsRead": "86400", "recordsWritten": "25200", "shuffleOutputBytes": "680400", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778455100", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time", "FROM time_dim", "WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00425531914893617, "waitRatioMax": 0.00425531914893617, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03829787234042553, "writeRatioMax": 0.03829787234042553 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05531914893617021, "computeRatioMax": 0.05531914893617021, "endMs": "1665778455148", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02553191489361702, "readRatioMax": 0.02553191489361702, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "12628", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778455113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id", "FROM item", "WHERE equal($13, 1)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00425531914893617, "waitRatioMax": 0.00425531914893617, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.029787234042553193, "writeRatioMax": 0.029787234042553193 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0425531914893617, "computeRatioMax": 0.0425531914893617, "endMs": "1665778455165", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02553191489361702, "readRatioMax": 0.02553191489361702, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778455124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE and(equal($72, 11), equal($71, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00425531914893617, "waitRatioMax": 0.00425531914893617, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06808510638297872, "writeRatioMax": 0.06808510638297872 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03829787234042553, "computeRatioMax": 0.03829787234042553, "endMs": "1665778455177", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02127659574468085, "readRatioMax": 0.02127659574468085, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778455150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($62, 11), equal($61, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00425531914893617, "waitRatioMax": 0.00425531914893617, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.059574468085106386, "writeRatioMax": 0.059574468085106386 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03404255319148936, "computeRatioMax": 0.03404255319148936, "endMs": "1665778455207", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.029787234042553193, "readRatioMax": 0.029787234042553193, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778455175", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00425531914893617, "waitRatioMax": 0.00425531914893617, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02553191489361702, "writeRatioMax": 0.02553191489361702 }, { "completedParallelInputs": "12", "computeMsAvg": "167", "computeMsMax": "235", "computeRatioAvg": 0.7106382978723405, "computeRatioMax": 1, "endMs": "1665778455380", "id": "8", "inputStages": [ "1", "2", "6", "4", "0" ], "name": "S08: Join+", "parallelInputs": "12", "readMsAvg": "20", "readMsMax": "26", "readRatioAvg": 0.0851063829787234, "readRatioMax": 0.11063829787234042, "recordsRead": "5347948", "recordsWritten": "1049", "shuffleOutputBytes": "68550", "shuffleOutputBytesSpilled": "0", "slotMs": "2013", "startMs": "1665778455222", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184", "$90 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $172, $183 := $2, $184 := $3", "INNER HASH JOIN EACH WITH ALL ON $173 = $1" ] }, { "kind": "JOIN", "substeps": [ "$172 := $100, $173 := $102, $170 := $11, $171 := $12", "INNER HASH JOIN EACH WITH ALL ON $101 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "JOIN", "substeps": [ "$140 := $31, $141 := $32, $142 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$192, $193, $191, $190, $90", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00425531914893617, "waitRatioMax": 0.00425531914893617, "writeMsAvg": "5", "writeMsMax": "9", "writeRatioAvg": 0.02127659574468085, "writeRatioMax": 0.03829787234042553 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.02127659574468085, "computeRatioMax": 0.02127659574468085, "endMs": "1665778455402", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1049", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665778455390", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$192, $193, $191, $190, $90", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)" ] }, { "kind": "WRITE", "substeps": [ "$202, $203, $201, $200, $80", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00425531914893617, "waitRatioMax": 0.00425531914893617, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01702127659574468, "writeRatioMax": 0.01702127659574468 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.029787234042553193, "computeRatioMax": 0.029787234042553193, "endMs": "1665778455442", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1018", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778455407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$202, $203, $201, $200, $80", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$80 DESC, $201 ASC" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00425531914893617, "waitRatioMax": 0.00425531914893617, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.059574468085106386, "writeRatioMax": 0.059574468085106386 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "19", "elapsedMs": "488", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2228" } ], "totalBytesBilled": "202375168", "totalBytesProcessed": "202160581", "totalPartitionsProcessed": "0", "totalSlotMs": "2228", "transferredBytes": "0" }, "startTime": "1665778454989", "totalBytesProcessed": "202160581", "totalSlotMs": "2228" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon75613697_bf9a_428c_a20d_86ddaac8e7c8" }, "priority": "INTERACTIVE", "query": "-- start query 71 in stream 0 using template query71.tpl\n\n/*\nSelect the top revenue generating products, sold during breakfast or dinner time \nfor one month managed by a given manager across all three sales channels.\n*/\n\nselect i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n ws_sold_date_sk as sold_date_sk,\n ws_item_sk as sold_item_sk,\n ws_sold_time_sk as time_sk \n from web_sales,date_dim\n where d_date_sk = ws_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select cs_ext_sales_price as ext_price,\n cs_sold_date_sk as sold_date_sk,\n cs_item_sk as sold_item_sk,\n cs_sold_time_sk as time_sk\n from catalog_sales,date_dim\n where d_date_sk = cs_sold_date_sk\n and d_moy=11\n and d_year=1999\n union all\n select ss_ext_sales_price as ext_price,\n ss_sold_date_sk as sold_date_sk,\n ss_item_sk as sold_item_sk,\n ss_sold_time_sk as time_sk\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n and d_moy=11\n and d_year=1999\n ) tmp,time_dim\n where\n sold_item_sk = i_item_sk\n and i_manager_id=1\n and time_sk = t_time_sk\n and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;\n\n-- end query 71 in stream 0 using template query71.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "tWNMfFMr/lX0lRatH7wg9w==", "id": "test-project-364309:europe-west1.query71_1665778456", "jobReference": { "jobId": "query71_1665778456", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query71_1665778456?location=europe-west1", "statistics": { "creationTime": "1665778457218", "endTime": "1665778457855", "finalExecutionDurationMs": "385", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "202160581", "performanceInsights": { "avgPreviousExecutionMs": "421" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.08294930875576037, "computeRatioMax": 0.08294930875576037, "endMs": "1665778457454", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.018433179723502304, "readRatioMax": 0.018433179723502304, "recordsRead": "86400", "recordsWritten": "25200", "shuffleOutputBytes": "680400", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778457416", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time", "FROM time_dim", "WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004608294930875576, "waitRatioMax": 0.004608294930875576, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04608294930875576, "writeRatioMax": 0.04608294930875576 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.041474654377880185, "computeRatioMax": 0.041474654377880185, "endMs": "1665778457457", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02304147465437788, "readRatioMax": 0.02304147465437788, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "12628", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778457429", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id", "FROM item", "WHERE equal($13, 1)" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004608294930875576, "waitRatioMax": 0.004608294930875576, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07373271889400922, "writeRatioMax": 0.07373271889400922 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.055299539170506916, "computeRatioMax": 0.055299539170506916, "endMs": "1665778457481", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02304147465437788, "readRatioMax": 0.02304147465437788, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778457445", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE and(equal($72, 11), equal($71, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004608294930875576, "waitRatioMax": 0.004608294930875576, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.059907834101382486, "writeRatioMax": 0.059907834101382486 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03686635944700461, "computeRatioMax": 0.03686635944700461, "endMs": "1665778457513", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04608294930875576, "readRatioMax": 0.04608294930875576, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778457473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($62, 11), equal($61, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004608294930875576, "waitRatioMax": 0.004608294930875576, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.055299539170506916, "writeRatioMax": 0.055299539170506916 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03225806451612903, "computeRatioMax": 0.03225806451612903, "endMs": "1665778457531", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.027649769585253458, "readRatioMax": 0.027649769585253458, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778457501", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004608294930875576, "waitRatioMax": 0.004608294930875576, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07373271889400922, "writeRatioMax": 0.07373271889400922 }, { "completedParallelInputs": "12", "computeMsAvg": "151", "computeMsMax": "217", "computeRatioAvg": 0.695852534562212, "computeRatioMax": 1, "endMs": "1665778457691", "id": "8", "inputStages": [ "4", "6", "2", "0", "1" ], "name": "S08: Join+", "parallelInputs": "12", "readMsAvg": "17", "readMsMax": "22", "readRatioAvg": 0.07834101382488479, "readRatioMax": 0.10138248847926268, "recordsRead": "5347948", "recordsWritten": "1049", "shuffleOutputBytes": "68550", "shuffleOutputBytesSpilled": "0", "slotMs": "1715", "startMs": "1665778457536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184", "$90 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $172, $183 := $2, $184 := $3", "INNER HASH JOIN EACH WITH ALL ON $173 = $1" ] }, { "kind": "JOIN", "substeps": [ "$172 := $100, $173 := $102, $170 := $11, $171 := $12", "INNER HASH JOIN EACH WITH ALL ON $101 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "JOIN", "substeps": [ "$140 := $31, $141 := $32, $142 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$192, $193, $191, $190, $90", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004608294930875576, "waitRatioMax": 0.004608294930875576, "writeMsAvg": "5", "writeMsMax": "12", "writeRatioAvg": 0.02304147465437788, "writeRatioMax": 0.055299539170506916 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.041474654377880185, "computeRatioMax": 0.041474654377880185, "endMs": "1665778457723", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1049", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778457700", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$192, $193, $191, $190, $90", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)" ] }, { "kind": "WRITE", "substeps": [ "$202, $203, $201, $200, $80", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004608294930875576, "waitRatioMax": 0.004608294930875576, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.06451612903225806 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03225806451612903, "computeRatioMax": 0.03225806451612903, "endMs": "1665778457767", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1018", "recordsWritten": "1018", "shuffleOutputBytes": "66532", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778457734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$202, $203, $201, $200, $80", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$80 DESC, $201 ASC" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004608294930875576, "waitRatioMax": 0.004608294930875576, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.06451612903225806 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "time_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "19", "elapsedMs": "497", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1980" } ], "totalBytesBilled": "202375168", "totalBytesProcessed": "202160581", "totalPartitionsProcessed": "0", "totalSlotMs": "1980", "transferredBytes": "0" }, "startTime": "1665778457299", "totalBytesProcessed": "202160581", "totalSlotMs": "1980" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
