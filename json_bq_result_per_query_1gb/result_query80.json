{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2b32fd24_f3f0_487f_bd60_a8c2e53b30c8" }, "priority": "INTERACTIVE", "query": "with ssr as\n (select s_store_id as store_id,\n sum(ss_ext_sales_price) as sales,\n sum(coalesce(sr_return_amt, 0)) as returns,\n sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n from store_sales left outer join store_returns on\n (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n date_dim,\n store,\n item,\n promotion\n where ss_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date) \n and (cast('2000-08-23' + 30 as date))\n and ss_store_sk = s_store_sk\n and ss_item_sk = i_item_sk\n and i_current_price > 50\n and ss_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id as catalog_page_id,\n sum(cs_ext_sales_price) as sales,\n sum(coalesce(cr_return_amount, 0)) as returns,\n sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n from catalog_sales left outer join catalog_returns on\n (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n date_dim,\n catalog_page,\n item,\n promotion\n where cs_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and cs_catalog_page_sk = cp_catalog_page_sk\n and cs_item_sk = i_item_sk\n and i_current_price > 50\n and cs_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n sum(ws_ext_sales_price) as sales,\n sum(coalesce(wr_return_amt, 0)) as returns,\n sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n from web_sales left outer join web_returns on\n (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n date_dim,\n web_site,\n item,\n promotion\n where ws_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and ws_web_site_sk = web_site_sk\n and ws_item_sk = i_item_sk\n and i_current_price > 50\n and ws_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by web_site_id)\n select channel\n , id\n , sum(sales) as sales\n , sum(returns) as returns\n , sum(profit) as profit\n from \n (select 'store channel' as channel\n , 'store' || store_id as id\n , sales\n , returns\n , profit\n from ssr\n union all\n select 'catalog channel' as channel\n , 'catalog_page' || catalog_page_id as id\n , sales\n , returns\n , profit\n from csr\n union all\n select 'web channel' as channel\n , 'web_site' || web_site_id as id\n , sales\n , returns\n , profit\n from wsr\n ) x\n group by rollup (channel, id)\n order by channel\n ,id\n limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "dOVtuA5YBVpsNgx6QrRvhg==", "id": "test-project-364309:europe-west1.query80_1665768481", "jobReference": { "jobId": "query80_1665768481", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query80_1665768481?location=europe-west1", "statistics": { "creationTime": "1665768482284", "endTime": "1665768484051", "finalExecutionDurationMs": "1386", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "380948994", "performanceInsights": { "avgPreviousExecutionMs": "1387" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.011475409836065573, "computeRatioMax": 0.011475409836065573, "endMs": "1665768482639", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.009016393442622951, "readRatioMax": 0.009016393442622951, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768482597", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:p_promo_sk, $21:p_channel_tv", "FROM promotion", "WHERE equal($21, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.007377049180327869, "writeRatioMax": 0.007377049180327869 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.013114754098360656, "computeRatioMax": 0.013114754098360656, "endMs": "1665768482646", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006557377049180328, "readRatioMax": 0.006557377049180328, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768482616", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:i_item_sk, $81:i_current_price", "FROM item", "WHERE greater($81, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.007377049180327869, "writeRatioMax": 0.007377049180327869 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007377049180327869, "computeRatioMax": 0.007377049180327869, "endMs": "1665768482663", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004098360655737705, "readRatioMax": 0.004098360655737705, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "900", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768482630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:web_site_sk, $71:web_site_id", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.01557377049180328, "writeRatioMax": 0.01557377049180328 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.013934426229508197, "computeRatioMax": 0.013934426229508197, "endMs": "1665768482677", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.007377049180327869, "readRatioMax": 0.007377049180327869, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768482648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_date", "FROM date_dim", "WHERE between($171, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.005737704918032787, "writeRatioMax": 0.005737704918032787 }, { "completedParallelInputs": "1", "computeMsAvg": "130", "computeMsMax": "130", "computeRatioAvg": 0.10655737704918032, "computeRatioMax": 0.10655737704918032, "endMs": "1665768482774", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.009836065573770493, "readRatioMax": 0.009836065573770493, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3629084", "shuffleOutputBytesSpilled": "0", "slotMs": "145", "startMs": "1665768482663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:wr_item_sk, $161:wr_order_number, $162:wr_return_amt, $163:wr_net_loss", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.00819672131147541, "writeRatioMax": 0.00819672131147541 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009016393442622951, "computeRatioMax": 0.009016393442622951, "endMs": "1665768482722", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004098360655737705, "readRatioMax": 0.004098360655737705, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768482682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk, $11:p_channel_tv", "FROM promotion", "WHERE equal($11, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.013114754098360656, "writeRatioMax": 0.013114754098360656 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00819672131147541, "computeRatioMax": 0.00819672131147541, "endMs": "1665768482744", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004918032786885246, "readRatioMax": 0.004918032786885246, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768482705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_current_price", "FROM item", "WHERE greater($61, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.011475409836065573, "writeRatioMax": 0.011475409836065573 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.01639344262295082, "computeRatioMax": 0.01639344262295082, "endMs": "1665768482751", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004918032786885246, "readRatioMax": 0.004918032786885246, "recordsRead": "11718", "recordsWritten": "11718", "shuffleOutputBytes": "351540", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768482718", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cp_catalog_page_sk, $51:cp_catalog_page_id", "FROM catalog_page" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010655737704918032, "writeRatioMax": 0.010655737704918032 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009016393442622951, "computeRatioMax": 0.009016393442622951, "endMs": "1665768482772", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004098360655737705, "readRatioMax": 0.004098360655737705, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768482733", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.009836065573770493, "writeRatioMax": 0.009836065573770493 }, { "completedParallelInputs": "1", "computeMsAvg": "183", "computeMsMax": "183", "computeRatioAvg": 0.15, "computeRatioMax": 0.15, "endMs": "1665768482903", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.011475409836065573, "readRatioMax": 0.011475409836065573, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "7399036", "shuffleOutputBytesSpilled": "0", "slotMs": "190", "startMs": "1665768482746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cr_item_sk, $131:cr_order_number, $132:cr_return_amount, $133:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.009836065573770493, "writeRatioMax": 0.009836065573770493 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.010655737704918032, "computeRatioMax": 0.010655737704918032, "endMs": "1665768482824", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004098360655737705, "readRatioMax": 0.004098360655737705, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665768482762", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:p_promo_sk, $2:p_channel_tv", "FROM promotion", "WHERE equal($2, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.013934426229508197, "writeRatioMax": 0.013934426229508197 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.013114754098360656, "computeRatioMax": 0.013114754098360656, "endMs": "1665768482827", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005737704918032787, "readRatioMax": 0.005737704918032787, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768482780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_current_price", "FROM item", "WHERE greater($41, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.022131147540983605, "writeRatioMax": 0.022131147540983605 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.005737704918032787, "computeRatioMax": 0.005737704918032787, "endMs": "1665768482847", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.003278688524590164, "readRatioMax": 0.003278688524590164, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768482807", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.023770491803278688, "writeRatioMax": 0.023770491803278688 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.011475409836065573, "computeRatioMax": 0.011475409836065573, "endMs": "1665768482869", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005737704918032787, "readRatioMax": 0.005737704918032787, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768482825", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_date", "FROM date_dim", "WHERE between($111, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.009836065573770493, "writeRatioMax": 0.009836065573770493 }, { "completedParallelInputs": "1", "computeMsAvg": "495", "computeMsMax": "495", "computeRatioAvg": 0.4057377049180328, "computeRatioMax": 0.4057377049180328, "endMs": "1665768483141", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.012295081967213115, "readRatioMax": 0.012295081967213115, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "14630712", "shuffleOutputBytesSpilled": "0", "slotMs": "438", "startMs": "1665768482838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:sr_item_sk, $101:sr_ticket_number, $102:sr_return_amt, $103:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.014754098360655738, "writeRatioMax": 0.014754098360655738 }, { "completedParallelInputs": "1", "computeMsAvg": "717", "computeMsMax": "717", "computeRatioAvg": 0.5877049180327869, "computeRatioMax": 0.5877049180327869, "endMs": "1665768483358", "id": "15", "inputStages": [ "1", "4", "3", "2", "0" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.029508196721311476, "readRatioMax": 0.029508196721311476, "recordsRead": "792557", "recordsWritten": "15", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "1377", "startMs": "1665768482857", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ws_sold_date_sk, $151:ws_item_sk, $152:ws_web_site_sk, $153:ws_promo_sk, $154:ws_order_number, $155:ws_ext_sales_price, $156:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162, $163", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $550", "$330 := SUM($551)", "$331 := SUM($360)", "$332 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := coalesce($553, NUMERIC<...>)", "$361 := subtract($552, coalesce($554, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$550 := $540, $551 := $542, $552 := $543, $553 := $544, $554 := $545", "INNER HASH JOIN EACH WITH ALL ON $541 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $536, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535", "INNER HASH JOIN EACH WITH ALL ON $530 = $80" ] }, { "kind": "JOIN", "substeps": [ "$530 := $520, $531 := $522, $532 := $523, $533 := $524, $534 := $525, $535 := $526, $536 := $71", "INNER HASH JOIN EACH WITH ALL ON $521 = $70" ] }, { "kind": "JOIN", "substeps": [ "$520 := $511, $521 := $512, $522 := $513, $523 := $514, $524 := $515, $525 := $516, $526 := $517", "INNER HASH JOIN EACH WITH ALL ON $510 = $170" ] }, { "kind": "JOIN", "substeps": [ "$510 := $150, $511 := $151, $512 := $152, $513 := $153, $514 := $155, $515 := $156, $516 := $162, $517 := $163", "LEFT OUTER HASH JOIN EACH WITH ALL ON $151 = $160, $154 = $161" ] }, { "kind": "WRITE", "substeps": [ "$560, $330, $331, $332", "TO __stage0F_output", "BY HASH($560)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.004918032786885246, "writeRatioMax": 0.004918032786885246 }, { "completedParallelInputs": "5", "computeMsAvg": "422", "computeMsMax": "610", "computeRatioAvg": 0.34590163934426227, "computeRatioMax": 0.5, "endMs": "1665768483295", "id": "16", "inputStages": [ "7", "9", "5", "6", "8" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "24", "readMsMax": "30", "readRatioAvg": 0.019672131147540985, "readRatioMax": 0.02459016393442623, "recordsRead": "2227373", "recordsWritten": "1091", "shuffleOutputBytes": "78552", "shuffleOutputBytesSpilled": "0", "slotMs": "1917", "startMs": "1665768482934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_catalog_page_sk, $122:cs_item_sk, $123:cs_promo_sk, $124:cs_order_number, $125:cs_ext_sales_price, $126:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$320 := SUM($481)", "$321 := SUM($350)", "$322 := SUM($351)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($483, NUMERIC<...>)", "$351 := subtract($482, coalesce($484, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$480 := $470, $481 := $472, $482 := $473, $483 := $474, $484 := $475", "INNER HASH JOIN EACH WITH ALL ON $471 = $10" ] }, { "kind": "JOIN", "substeps": [ "$470 := $466, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465", "INNER HASH JOIN EACH WITH ALL ON $460 = $60" ] }, { "kind": "JOIN", "substeps": [ "$460 := $451, $461 := $452, $462 := $453, $463 := $454, $464 := $455, $465 := $456, $466 := $51", "INNER HASH JOIN EACH WITH ALL ON $450 = $50" ] }, { "kind": "JOIN", "substeps": [ "$450 := $441, $451 := $442, $452 := $443, $453 := $444, $454 := $445, $455 := $446, $456 := $447", "INNER HASH JOIN EACH WITH ALL ON $440 = $140" ] }, { "kind": "JOIN", "substeps": [ "$440 := $120, $441 := $121, $442 := $122, $443 := $123, $444 := $125, $445 := $126, $446 := $132, $447 := $133", "LEFT OUTER HASH JOIN EACH WITH ALL ON $122 = $130, $124 = $131" ] }, { "kind": "WRITE", "substeps": [ "$490, $320, $321, $322", "TO __stage10_output", "BY HASH($490)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.003278688524590164, "writeRatioMax": 0.004918032786885246 }, { "completedParallelInputs": "6", "computeMsAvg": "958", "computeMsMax": "1220", "computeRatioAvg": 0.7852459016393443, "computeRatioMax": 1, "endMs": "1665768483810", "id": "17", "inputStages": [ "13", "14", "12", "10", "11" ], "name": "S11: Join+", "parallelInputs": "6", "readMsAvg": "31", "readMsMax": "39", "readRatioAvg": 0.02540983606557377, "readRatioMax": 0.031967213114754096, "recordsRead": "4613840", "recordsWritten": "36", "shuffleOutputBytes": "2592", "shuffleOutputBytesSpilled": "0", "slotMs": "4297", "startMs": "1665768483148", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_store_sk, $93:ss_promo_sk, $94:ss_ticket_number, $95:ss_ext_sales_price, $96:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$310 := SUM($411)", "$311 := SUM($340)", "$312 := SUM($341)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($413, NUMERIC<...>)", "$341 := subtract($412, coalesce($414, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$410 := $400, $411 := $402, $412 := $403, $413 := $404, $414 := $405", "INNER HASH JOIN EACH WITH ALL ON $401 = $1" ] }, { "kind": "JOIN", "substeps": [ "$400 := $396, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395", "INNER HASH JOIN EACH WITH ALL ON $390 = $40" ] }, { "kind": "JOIN", "substeps": [ "$390 := $380, $391 := $382, $392 := $383, $393 := $384, $394 := $385, $395 := $386, $396 := $31", "INNER HASH JOIN EACH WITH ALL ON $381 = $30" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $374, $384 := $375, $385 := $376, $386 := $377", "INNER HASH JOIN EACH WITH ALL ON $370 = $110" ] }, { "kind": "JOIN", "substeps": [ "$370 := $90, $371 := $91, $372 := $92, $373 := $93, $374 := $95, $375 := $96, $376 := $102, $377 := $103", "LEFT OUTER HASH JOIN EACH WITH ALL ON $91 = $100, $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$420, $310, $311, $312", "TO __stage11_output", "BY HASH($420)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.004098360655737705, "writeRatioMax": 0.004918032786885246 }, { "completedParallelInputs": "3", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.009836065573770493, "computeRatioMax": 0.009836065573770493, "endMs": "1665768483874", "id": "18", "inputStages": [ "15", "16", "17" ], "name": "S12: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1142", "recordsWritten": "431", "shuffleOutputBytes": "48274", "shuffleOutputBytesSpilled": "0", "slotMs": "97", "startMs": "1665768483835", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $310, $311, $312", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$490, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$560, $330, $331, $332", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $580 := $200, $581 := $201, $582 := $220", "$190 := SUM($232)", "$191 := SUM($233)", "$192 := SUM($234)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal(bitwise_and($240, 1), 0), NULL, $230)", "$201 := if(equal(bitwise_and($240, 2), 0), NULL, $231)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'store channel'", "$251 := concat('store', $430)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $430 := $420", "$280 := SUM($310)", "$281 := SUM($311)", "$282 := SUM($312)" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := 'catalog channel'", "$261 := concat('catalog_page', $500)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $490", "$290 := SUM($320)", "$291 := SUM($321)", "$292 := SUM($322)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 'web channel'", "$271 := concat('web_site', $570)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($330)", "$301 := SUM($331)", "$302 := SUM($332)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($241, 1)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $580, $581, $582", "TO __stage12_output", "BY HASH($580, $581, $582)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "13", "writeMsMax": "14", "writeRatioAvg": 0.010655737704918032, "writeRatioMax": 0.011475409836065573 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.005737704918032787, "computeRatioMax": 0.005737704918032787, "endMs": "1665768483921", "id": "19", "inputStages": [ "18" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "431", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665768483885", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $580, $581, $582", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $590 := $580, $591 := $581, $592 := $582", "$180 := SUM($190)", "$181 := SUM($191)", "$182 := SUM($192)" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010655737704918032, "writeRatioMax": 0.010655737704918032 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.012295081967213115, "computeRatioMax": 0.012295081967213115, "endMs": "1665768483947", "id": "20", "inputStages": [ "19" ], "name": "S14: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768483900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$603 ASC, $604 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$610, $611, $612, $613, $614", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.013934426229508197, "writeRatioMax": 0.013934426229508197 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "14", "elapsedMs": "716", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "1093" }, { "activeUnits": "5", "completedUnits": "32", "elapsedMs": "1605", "estimatedRunnableUnits": "3", "pendingUnits": "0", "totalSlotMs": "8984" } ], "totalBytesBilled": "381681664", "totalBytesProcessed": "380948994", "totalPartitionsProcessed": "0", "totalSlotMs": "8984", "transferredBytes": "0" }, "startTime": "1665768482383", "totalBytesProcessed": "380948994", "totalSlotMs": "8984" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anondd04b134_2f25_4553_9ba8_53dc40e53c9c" }, "priority": "INTERACTIVE", "query": "with ssr as\n (select s_store_id as store_id,\n sum(ss_ext_sales_price) as sales,\n sum(coalesce(sr_return_amt, 0)) as returns,\n sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n from store_sales left outer join store_returns on\n (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n date_dim,\n store,\n item,\n promotion\n where ss_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date) \n and (cast('2000-08-23' + 30 as date))\n and ss_store_sk = s_store_sk\n and ss_item_sk = i_item_sk\n and i_current_price > 50\n and ss_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id as catalog_page_id,\n sum(cs_ext_sales_price) as sales,\n sum(coalesce(cr_return_amount, 0)) as returns,\n sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n from catalog_sales left outer join catalog_returns on\n (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n date_dim,\n catalog_page,\n item,\n promotion\n where cs_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and cs_catalog_page_sk = cp_catalog_page_sk\n and cs_item_sk = i_item_sk\n and i_current_price > 50\n and cs_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n sum(ws_ext_sales_price) as sales,\n sum(coalesce(wr_return_amt, 0)) as returns,\n sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n from web_sales left outer join web_returns on\n (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n date_dim,\n web_site,\n item,\n promotion\n where ws_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and ws_web_site_sk = web_site_sk\n and ws_item_sk = i_item_sk\n and i_current_price > 50\n and ws_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by web_site_id)\n select channel\n , id\n , sum(sales) as sales\n , sum(returns) as returns\n , sum(profit) as profit\n from \n (select 'store channel' as channel\n , 'store' || store_id as id\n , sales\n , returns\n , profit\n from ssr\n union all\n select 'catalog channel' as channel\n , 'catalog_page' || catalog_page_id as id\n , sales\n , returns\n , profit\n from csr\n union all\n select 'web channel' as channel\n , 'web_site' || web_site_id as id\n , sales\n , returns\n , profit\n from wsr\n ) x\n group by rollup (channel, id)\n order by channel\n ,id\n limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "b0ywWM3Tyw7vNCnVZSnF4w==", "id": "test-project-364309:europe-west1.query80_1665778631", "jobReference": { "jobId": "query80_1665778631", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query80_1665778631?location=europe-west1", "statistics": { "creationTime": "1665778631674", "endTime": "1665778633405", "finalExecutionDurationMs": "1393", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "380948994", "performanceInsights": { "avgPreviousExecutionMs": "1387" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009322033898305085, "computeRatioMax": 0.009322033898305085, "endMs": "1665778631986", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006779661016949152, "readRatioMax": 0.006779661016949152, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778631948", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:p_promo_sk, $21:p_channel_tv", "FROM promotion", "WHERE equal($21, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.000847457627118644, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.006779661016949152, "writeRatioMax": 0.006779661016949152 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.010169491525423728, "computeRatioMax": 0.010169491525423728, "endMs": "1665778632008", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005084745762711864, "readRatioMax": 0.005084745762711864, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778631964", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:i_item_sk, $81:i_current_price", "FROM item", "WHERE greater($81, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.012711864406779662, "writeRatioMax": 0.012711864406779662 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006779661016949152, "computeRatioMax": 0.006779661016949152, "endMs": "1665778632025", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.003389830508474576, "readRatioMax": 0.003389830508474576, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "900", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778631985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:web_site_sk, $71:web_site_id", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.01440677966101695, "writeRatioMax": 0.01440677966101695 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00847457627118644, "computeRatioMax": 0.00847457627118644, "endMs": "1665778632041", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005084745762711864, "readRatioMax": 0.005084745762711864, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778632008", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_date", "FROM date_dim", "WHERE between($171, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.005932203389830509, "writeRatioMax": 0.005932203389830509 }, { "completedParallelInputs": "1", "computeMsAvg": "125", "computeMsMax": "125", "computeRatioAvg": 0.1059322033898305, "computeRatioMax": 0.1059322033898305, "endMs": "1665778632140", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.011864406779661017, "readRatioMax": 0.011864406779661017, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3629084", "shuffleOutputBytesSpilled": "0", "slotMs": "179", "startMs": "1665778632022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:wr_item_sk, $161:wr_order_number, $162:wr_return_amt, $163:wr_net_loss", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.011016949152542373, "writeRatioMax": 0.011016949152542373 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.010169491525423728, "computeRatioMax": 0.010169491525423728, "endMs": "1665778632077", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.007627118644067797, "readRatioMax": 0.007627118644067797, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778632040", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk, $11:p_channel_tv", "FROM promotion", "WHERE equal($11, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.005932203389830509, "writeRatioMax": 0.005932203389830509 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009322033898305085, "computeRatioMax": 0.009322033898305085, "endMs": "1665778632094", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005084745762711864, "readRatioMax": 0.005084745762711864, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778632055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_current_price", "FROM item", "WHERE greater($61, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.005932203389830509, "writeRatioMax": 0.005932203389830509 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.011016949152542373, "computeRatioMax": 0.011016949152542373, "endMs": "1665778632104", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006779661016949152, "readRatioMax": 0.006779661016949152, "recordsRead": "11718", "recordsWritten": "11718", "shuffleOutputBytes": "351540", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778632068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cp_catalog_page_sk, $51:cp_catalog_page_id", "FROM catalog_page" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.000847457627118644, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.005084745762711864, "writeRatioMax": 0.005084745762711864 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.010169491525423728, "computeRatioMax": 0.010169491525423728, "endMs": "1665778632120", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005084745762711864, "readRatioMax": 0.005084745762711864, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778632083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.009322033898305085, "writeRatioMax": 0.009322033898305085 }, { "completedParallelInputs": "1", "computeMsAvg": "129", "computeMsMax": "129", "computeRatioAvg": 0.10932203389830508, "computeRatioMax": 0.10932203389830508, "endMs": "1665778632237", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.010169491525423728, "readRatioMax": 0.010169491525423728, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "7399036", "shuffleOutputBytesSpilled": "0", "slotMs": "167", "startMs": "1665778632098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cr_item_sk, $131:cr_order_number, $132:cr_return_amount, $133:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.009322033898305085, "writeRatioMax": 0.009322033898305085 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007627118644067797, "computeRatioMax": 0.007627118644067797, "endMs": "1665778632155", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00423728813559322, "readRatioMax": 0.00423728813559322, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778632115", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:p_promo_sk, $2:p_channel_tv", "FROM promotion", "WHERE equal($2, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.013559322033898305, "writeRatioMax": 0.013559322033898305 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00847457627118644, "computeRatioMax": 0.00847457627118644, "endMs": "1665778632156", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00423728813559322, "readRatioMax": 0.00423728813559322, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778632126", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_current_price", "FROM item", "WHERE greater($41, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.000847457627118644, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.01440677966101695, "writeRatioMax": 0.01440677966101695 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007627118644067797, "computeRatioMax": 0.007627118644067797, "endMs": "1665778632170", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00423728813559322, "readRatioMax": 0.00423728813559322, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778632140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.01440677966101695, "writeRatioMax": 0.01440677966101695 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.011864406779661017, "computeRatioMax": 0.011864406779661017, "endMs": "1665778632197", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.00847457627118644, "readRatioMax": 0.00847457627118644, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778632154", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_date", "FROM date_dim", "WHERE between($111, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.007627118644067797, "writeRatioMax": 0.007627118644067797 }, { "completedParallelInputs": "1", "computeMsAvg": "454", "computeMsMax": "454", "computeRatioAvg": 0.3847457627118644, "computeRatioMax": 0.3847457627118644, "endMs": "1665778632472", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.015254237288135594, "readRatioMax": 0.015254237288135594, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "14630712", "shuffleOutputBytesSpilled": "0", "slotMs": "476", "startMs": "1665778632166", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:sr_item_sk, $101:sr_ticket_number, $102:sr_return_amt, $103:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.000847457627118644, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.013559322033898305, "writeRatioMax": 0.013559322033898305 }, { "completedParallelInputs": "1", "computeMsAvg": "628", "computeMsMax": "628", "computeRatioAvg": 0.5322033898305085, "computeRatioMax": 0.5322033898305085, "endMs": "1665778632580", "id": "15", "inputStages": [ "4", "2", "0", "3", "1" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "40", "readMsMax": "40", "readRatioAvg": 0.03389830508474576, "readRatioMax": 0.03389830508474576, "recordsRead": "792557", "recordsWritten": "15", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "612", "startMs": "1665778632183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ws_sold_date_sk, $151:ws_item_sk, $152:ws_web_site_sk, $153:ws_promo_sk, $154:ws_order_number, $155:ws_ext_sales_price, $156:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162, $163", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $550", "$330 := SUM($551)", "$331 := SUM($360)", "$332 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := coalesce($553, NUMERIC<...>)", "$361 := subtract($552, coalesce($554, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$550 := $540, $551 := $542, $552 := $543, $553 := $544, $554 := $545", "INNER HASH JOIN EACH WITH ALL ON $541 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $536, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535", "INNER HASH JOIN EACH WITH ALL ON $530 = $80" ] }, { "kind": "JOIN", "substeps": [ "$530 := $520, $531 := $522, $532 := $523, $533 := $524, $534 := $525, $535 := $526, $536 := $71", "INNER HASH JOIN EACH WITH ALL ON $521 = $70" ] }, { "kind": "JOIN", "substeps": [ "$520 := $511, $521 := $512, $522 := $513, $523 := $514, $524 := $515, $525 := $516, $526 := $517", "INNER HASH JOIN EACH WITH ALL ON $510 = $170" ] }, { "kind": "JOIN", "substeps": [ "$510 := $150, $511 := $151, $512 := $152, $513 := $153, $514 := $155, $515 := $156, $516 := $162, $517 := $163", "LEFT OUTER HASH JOIN EACH WITH ALL ON $151 = $160, $154 = $161" ] }, { "kind": "WRITE", "substeps": [ "$560, $330, $331, $332", "TO __stage0F_output", "BY HASH($560)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.006779661016949152, "writeRatioMax": 0.006779661016949152 }, { "completedParallelInputs": "5", "computeMsAvg": "478", "computeMsMax": "600", "computeRatioAvg": 0.40508474576271186, "computeRatioMax": 0.5084745762711864, "endMs": "1665778632635", "id": "16", "inputStages": [ "6", "7", "8", "5", "9" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "27", "readMsMax": "34", "readRatioAvg": 0.02288135593220339, "readRatioMax": 0.0288135593220339, "recordsRead": "2227373", "recordsWritten": "1091", "shuffleOutputBytes": "78552", "shuffleOutputBytesSpilled": "0", "slotMs": "2481", "startMs": "1665778632249", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_catalog_page_sk, $122:cs_item_sk, $123:cs_promo_sk, $124:cs_order_number, $125:cs_ext_sales_price, $126:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$320 := SUM($481)", "$321 := SUM($350)", "$322 := SUM($351)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($483, NUMERIC<...>)", "$351 := subtract($482, coalesce($484, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$480 := $470, $481 := $472, $482 := $473, $483 := $474, $484 := $475", "INNER HASH JOIN EACH WITH ALL ON $471 = $10" ] }, { "kind": "JOIN", "substeps": [ "$470 := $466, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465", "INNER HASH JOIN EACH WITH ALL ON $460 = $60" ] }, { "kind": "JOIN", "substeps": [ "$460 := $451, $461 := $452, $462 := $453, $463 := $454, $464 := $455, $465 := $456, $466 := $51", "INNER HASH JOIN EACH WITH ALL ON $450 = $50" ] }, { "kind": "JOIN", "substeps": [ "$450 := $441, $451 := $442, $452 := $443, $453 := $444, $454 := $445, $455 := $446, $456 := $447", "INNER HASH JOIN EACH WITH ALL ON $440 = $140" ] }, { "kind": "JOIN", "substeps": [ "$440 := $120, $441 := $121, $442 := $122, $443 := $123, $444 := $125, $445 := $126, $446 := $132, $447 := $133", "LEFT OUTER HASH JOIN EACH WITH ALL ON $122 = $130, $124 = $131" ] }, { "kind": "WRITE", "substeps": [ "$490, $320, $321, $322", "TO __stage10_output", "BY HASH($490)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.00423728813559322, "writeRatioMax": 0.005084745762711864 }, { "completedParallelInputs": "6", "computeMsAvg": "759", "computeMsMax": "1180", "computeRatioAvg": 0.6432203389830509, "computeRatioMax": 1, "endMs": "1665778633156", "id": "17", "inputStages": [ "14", "11", "13", "12", "10" ], "name": "S11: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "38", "readRatioAvg": 0.02457627118644068, "readRatioMax": 0.03220338983050847, "recordsRead": "4613840", "recordsWritten": "36", "shuffleOutputBytes": "2592", "shuffleOutputBytesSpilled": "0", "slotMs": "4266", "startMs": "1665778632493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_store_sk, $93:ss_promo_sk, $94:ss_ticket_number, $95:ss_ext_sales_price, $96:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$310 := SUM($411)", "$311 := SUM($340)", "$312 := SUM($341)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($413, NUMERIC<...>)", "$341 := subtract($412, coalesce($414, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$410 := $400, $411 := $402, $412 := $403, $413 := $404, $414 := $405", "INNER HASH JOIN EACH WITH ALL ON $401 = $1" ] }, { "kind": "JOIN", "substeps": [ "$400 := $396, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395", "INNER HASH JOIN EACH WITH ALL ON $390 = $40" ] }, { "kind": "JOIN", "substeps": [ "$390 := $380, $391 := $382, $392 := $383, $393 := $384, $394 := $385, $395 := $386, $396 := $31", "INNER HASH JOIN EACH WITH ALL ON $381 = $30" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $374, $384 := $375, $385 := $376, $386 := $377", "INNER HASH JOIN EACH WITH ALL ON $370 = $110" ] }, { "kind": "JOIN", "substeps": [ "$370 := $90, $371 := $91, $372 := $92, $373 := $93, $374 := $95, $375 := $96, $376 := $102, $377 := $103", "LEFT OUTER HASH JOIN EACH WITH ALL ON $91 = $100, $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$420, $310, $311, $312", "TO __stage11_output", "BY HASH($420)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.000847457627118644, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.00423728813559322, "writeRatioMax": 0.005932203389830509 }, { "completedParallelInputs": "3", "computeMsAvg": "7", "computeMsMax": "9", "computeRatioAvg": 0.005932203389830509, "computeRatioMax": 0.007627118644067797, "endMs": "1665778633240", "id": "18", "inputStages": [ "15", "16", "17" ], "name": "S12: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1142", "recordsWritten": "431", "shuffleOutputBytes": "48274", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665778633204", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $310, $311, $312", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$490, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$560, $330, $331, $332", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $580 := $200, $581 := $201, $582 := $220", "$190 := SUM($232)", "$191 := SUM($233)", "$192 := SUM($234)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal(bitwise_and($240, 1), 0), NULL, $230)", "$201 := if(equal(bitwise_and($240, 2), 0), NULL, $231)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'store channel'", "$251 := concat('store', $430)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $430 := $420", "$280 := SUM($310)", "$281 := SUM($311)", "$282 := SUM($312)" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := 'catalog channel'", "$261 := concat('catalog_page', $500)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $490", "$290 := SUM($320)", "$291 := SUM($321)", "$292 := SUM($322)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 'web channel'", "$271 := concat('web_site', $570)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($330)", "$301 := SUM($331)", "$302 := SUM($332)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($241, 1)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $580, $581, $582", "TO __stage12_output", "BY HASH($580, $581, $582)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.000847457627118644, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.012711864406779662, "writeRatioMax": 0.012711864406779662 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.011016949152542373, "computeRatioMax": 0.011016949152542373, "endMs": "1665778633290", "id": "19", "inputStages": [ "18" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "431", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778633253", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $580, $581, $582", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $590 := $580, $591 := $581, $592 := $582", "$180 := SUM($190)", "$181 := SUM($191)", "$182 := SUM($192)" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.000847457627118644, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.012711864406779662, "writeRatioMax": 0.012711864406779662 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.005932203389830509, "computeRatioMax": 0.005932203389830509, "endMs": "1665778633310", "id": "20", "inputStages": [ "19" ], "name": "S14: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778633268", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$603 ASC, $604 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$610, $611, $612, $613, $614", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000847457627118644, "waitRatioMax": 0.000847457627118644, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.005084745762711864, "writeRatioMax": 0.005084745762711864 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "14", "elapsedMs": "699", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "1294" }, { "activeUnits": "6", "completedUnits": "32", "elapsedMs": "1604", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8875" } ], "totalBytesBilled": "381681664", "totalBytesProcessed": "380948994", "totalPartitionsProcessed": "0", "totalSlotMs": "8875", "transferredBytes": "0" }, "startTime": "1665778631750", "totalBytesProcessed": "380948994", "totalSlotMs": "8875" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon98a36d22_1b1a_4a0f_ac43_32a3967a761e" }, "priority": "INTERACTIVE", "query": "with ssr as\n (select s_store_id as store_id,\n sum(ss_ext_sales_price) as sales,\n sum(coalesce(sr_return_amt, 0)) as returns,\n sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n from store_sales left outer join store_returns on\n (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n date_dim,\n store,\n item,\n promotion\n where ss_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date) \n and (cast('2000-08-23' + 30 as date))\n and ss_store_sk = s_store_sk\n and ss_item_sk = i_item_sk\n and i_current_price > 50\n and ss_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id as catalog_page_id,\n sum(cs_ext_sales_price) as sales,\n sum(coalesce(cr_return_amount, 0)) as returns,\n sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n from catalog_sales left outer join catalog_returns on\n (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n date_dim,\n catalog_page,\n item,\n promotion\n where cs_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and cs_catalog_page_sk = cp_catalog_page_sk\n and cs_item_sk = i_item_sk\n and i_current_price > 50\n and cs_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n sum(ws_ext_sales_price) as sales,\n sum(coalesce(wr_return_amt, 0)) as returns,\n sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n from web_sales left outer join web_returns on\n (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n date_dim,\n web_site,\n item,\n promotion\n where ws_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and ws_web_site_sk = web_site_sk\n and ws_item_sk = i_item_sk\n and i_current_price > 50\n and ws_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by web_site_id)\n select channel\n , id\n , sum(sales) as sales\n , sum(returns) as returns\n , sum(profit) as profit\n from \n (select 'store channel' as channel\n , 'store' || store_id as id\n , sales\n , returns\n , profit\n from ssr\n union all\n select 'catalog channel' as channel\n , 'catalog_page' || catalog_page_id as id\n , sales\n , returns\n , profit\n from csr\n union all\n select 'web channel' as channel\n , 'web_site' || web_site_id as id\n , sales\n , returns\n , profit\n from wsr\n ) x\n group by rollup (channel, id)\n order by channel\n ,id\n limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "fZnt8LsIpjkKQFNeuqpRuQ==", "id": "test-project-364309:europe-west1.query80_1665778635", "jobReference": { "jobId": "query80_1665778635", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query80_1665778635?location=europe-west1", "statistics": { "creationTime": "1665778635771", "endTime": "1665778637411", "finalExecutionDurationMs": "1272", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "380948994", "performanceInsights": { "avgPreviousExecutionMs": "1388" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.015300546448087432, "computeRatioMax": 0.015300546448087432, "endMs": "1665778636125", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007650273224043716, "readRatioMax": 0.007650273224043716, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778636087", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:p_promo_sk, $21:p_channel_tv", "FROM promotion", "WHERE equal($21, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003278688524590164, "waitRatioMax": 0.003278688524590164, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.024043715846994537, "writeRatioMax": 0.024043715846994537 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01092896174863388, "computeRatioMax": 0.01092896174863388, "endMs": "1665778636145", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00546448087431694, "readRatioMax": 0.00546448087431694, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778636106", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:i_item_sk, $81:i_current_price", "FROM item", "WHERE greater($81, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.017486338797814208, "writeRatioMax": 0.017486338797814208 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.006557377049180328, "computeRatioMax": 0.006557377049180328, "endMs": "1665778636163", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00546448087431694, "readRatioMax": 0.00546448087431694, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "900", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778636122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:web_site_sk, $71:web_site_id", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.018579234972677595, "writeRatioMax": 0.018579234972677595 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013114754098360656, "computeRatioMax": 0.013114754098360656, "endMs": "1665778636176", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006557377049180328, "readRatioMax": 0.006557377049180328, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778636137", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_date", "FROM date_dim", "WHERE between($171, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01639344262295082, "writeRatioMax": 0.01639344262295082 }, { "completedParallelInputs": "1", "computeMsAvg": "89", "computeMsMax": "89", "computeRatioAvg": 0.09726775956284153, "computeRatioMax": 0.09726775956284153, "endMs": "1665778636254", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.013114754098360656, "readRatioMax": 0.013114754098360656, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3629084", "shuffleOutputBytesSpilled": "0", "slotMs": "133", "startMs": "1665778636154", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:wr_item_sk, $161:wr_order_number, $162:wr_return_amt, $163:wr_net_loss", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.015300546448087432, "writeRatioMax": 0.015300546448087432 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.006557377049180328, "computeRatioMax": 0.006557377049180328, "endMs": "1665778636211", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004371584699453552, "readRatioMax": 0.004371584699453552, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778636169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk, $11:p_channel_tv", "FROM promotion", "WHERE equal($11, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.001092896174863388, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.020765027322404372, "writeRatioMax": 0.020765027322404372 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.015300546448087432, "computeRatioMax": 0.015300546448087432, "endMs": "1665778636223", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01092896174863388, "readRatioMax": 0.01092896174863388, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778636188", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_current_price", "FROM item", "WHERE greater($61, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.014207650273224045, "writeRatioMax": 0.014207650273224045 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.014207650273224045, "computeRatioMax": 0.014207650273224045, "endMs": "1665778636243", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007650273224043716, "readRatioMax": 0.007650273224043716, "recordsRead": "11718", "recordsWritten": "11718", "shuffleOutputBytes": "351540", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778636205", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cp_catalog_page_sk, $51:cp_catalog_page_id", "FROM catalog_page" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008743169398907104, "writeRatioMax": 0.008743169398907104 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013114754098360656, "computeRatioMax": 0.013114754098360656, "endMs": "1665778636263", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007650273224043716, "readRatioMax": 0.007650273224043716, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778636222", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.001092896174863388, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01092896174863388, "writeRatioMax": 0.01092896174863388 }, { "completedParallelInputs": "1", "computeMsAvg": "133", "computeMsMax": "133", "computeRatioAvg": 0.1453551912568306, "computeRatioMax": 0.1453551912568306, "endMs": "1665778636365", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.015300546448087432, "readRatioMax": 0.015300546448087432, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "7399036", "shuffleOutputBytesSpilled": "0", "slotMs": "169", "startMs": "1665778636243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cr_item_sk, $131:cr_order_number, $132:cr_return_amount, $133:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.013114754098360656, "writeRatioMax": 0.013114754098360656 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012021857923497269, "computeRatioMax": 0.012021857923497269, "endMs": "1665778636302", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00546448087431694, "readRatioMax": 0.00546448087431694, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778636259", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:p_promo_sk, $2:p_channel_tv", "FROM promotion", "WHERE equal($2, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.001092896174863388, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.018579234972677595, "writeRatioMax": 0.018579234972677595 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012021857923497269, "computeRatioMax": 0.012021857923497269, "endMs": "1665778636309", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006557377049180328, "readRatioMax": 0.006557377049180328, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778636274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_current_price", "FROM item", "WHERE greater($41, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.001092896174863388, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008743169398907104, "writeRatioMax": 0.008743169398907104 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.007650273224043716, "computeRatioMax": 0.007650273224043716, "endMs": "1665778636333", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004371584699453552, "readRatioMax": 0.004371584699453552, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778636289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.001092896174863388, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.020765027322404372, "writeRatioMax": 0.020765027322404372 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.020765027322404372, "computeRatioMax": 0.020765027322404372, "endMs": "1665778636349", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.01639344262295082, "readRatioMax": 0.01639344262295082, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778636306", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_date", "FROM date_dim", "WHERE between($111, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.009836065573770493, "writeRatioMax": 0.009836065573770493 }, { "completedParallelInputs": "1", "computeMsAvg": "430", "computeMsMax": "430", "computeRatioAvg": 0.46994535519125685, "computeRatioMax": 0.46994535519125685, "endMs": "1665778636633", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.019672131147540985, "readRatioMax": 0.019672131147540985, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "14630712", "shuffleOutputBytesSpilled": "0", "slotMs": "424", "startMs": "1665778636324", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:sr_item_sk, $101:sr_ticket_number, $102:sr_return_amt, $103:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.022950819672131147, "writeRatioMax": 0.022950819672131147 }, { "completedParallelInputs": "1", "computeMsAvg": "758", "computeMsMax": "758", "computeRatioAvg": 0.8284153005464481, "computeRatioMax": 0.8284153005464481, "endMs": "1665778636822", "id": "15", "inputStages": [ "3", "1", "0", "2", "4" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.033879781420765025, "readRatioMax": 0.033879781420765025, "recordsRead": "792557", "recordsWritten": "15", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "707", "startMs": "1665778636342", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ws_sold_date_sk, $151:ws_item_sk, $152:ws_web_site_sk, $153:ws_promo_sk, $154:ws_order_number, $155:ws_ext_sales_price, $156:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162, $163", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $550", "$330 := SUM($551)", "$331 := SUM($360)", "$332 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := coalesce($553, NUMERIC<...>)", "$361 := subtract($552, coalesce($554, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$550 := $540, $551 := $542, $552 := $543, $553 := $544, $554 := $545", "INNER HASH JOIN EACH WITH ALL ON $541 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $536, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535", "INNER HASH JOIN EACH WITH ALL ON $530 = $80" ] }, { "kind": "JOIN", "substeps": [ "$530 := $520, $531 := $522, $532 := $523, $533 := $524, $534 := $525, $535 := $526, $536 := $71", "INNER HASH JOIN EACH WITH ALL ON $521 = $70" ] }, { "kind": "JOIN", "substeps": [ "$520 := $511, $521 := $512, $522 := $513, $523 := $514, $524 := $515, $525 := $516, $526 := $517", "INNER HASH JOIN EACH WITH ALL ON $510 = $170" ] }, { "kind": "JOIN", "substeps": [ "$510 := $150, $511 := $151, $512 := $152, $513 := $153, $514 := $155, $515 := $156, $516 := $162, $517 := $163", "LEFT OUTER HASH JOIN EACH WITH ALL ON $151 = $160, $154 = $161" ] }, { "kind": "WRITE", "substeps": [ "$560, $330, $331, $332", "TO __stage0F_output", "BY HASH($560)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.020765027322404372, "writeRatioMax": 0.020765027322404372 }, { "completedParallelInputs": "5", "computeMsAvg": "367", "computeMsMax": "446", "computeRatioAvg": 0.4010928961748634, "computeRatioMax": 0.48743169398907105, "endMs": "1665778636731", "id": "16", "inputStages": [ "5", "8", "9", "7", "6" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "36", "readRatioAvg": 0.02841530054644809, "readRatioMax": 0.03934426229508197, "recordsRead": "2227373", "recordsWritten": "1091", "shuffleOutputBytes": "78552", "shuffleOutputBytesSpilled": "0", "slotMs": "1745", "startMs": "1665778636391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_catalog_page_sk, $122:cs_item_sk, $123:cs_promo_sk, $124:cs_order_number, $125:cs_ext_sales_price, $126:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$320 := SUM($481)", "$321 := SUM($350)", "$322 := SUM($351)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($483, NUMERIC<...>)", "$351 := subtract($482, coalesce($484, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$480 := $470, $481 := $472, $482 := $473, $483 := $474, $484 := $475", "INNER HASH JOIN EACH WITH ALL ON $471 = $10" ] }, { "kind": "JOIN", "substeps": [ "$470 := $466, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465", "INNER HASH JOIN EACH WITH ALL ON $460 = $60" ] }, { "kind": "JOIN", "substeps": [ "$460 := $451, $461 := $452, $462 := $453, $463 := $454, $464 := $455, $465 := $456, $466 := $51", "INNER HASH JOIN EACH WITH ALL ON $450 = $50" ] }, { "kind": "JOIN", "substeps": [ "$450 := $441, $451 := $442, $452 := $443, $453 := $444, $454 := $445, $455 := $446, $456 := $447", "INNER HASH JOIN EACH WITH ALL ON $440 = $140" ] }, { "kind": "JOIN", "substeps": [ "$440 := $120, $441 := $121, $442 := $122, $443 := $123, $444 := $125, $445 := $126, $446 := $132, $447 := $133", "LEFT OUTER HASH JOIN EACH WITH ALL ON $122 = $130, $124 = $131" ] }, { "kind": "WRITE", "substeps": [ "$490, $320, $321, $322", "TO __stage10_output", "BY HASH($490)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.001092896174863388, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.00546448087431694, "writeRatioMax": 0.006557377049180328 }, { "completedParallelInputs": "6", "computeMsAvg": "764", "computeMsMax": "915", "computeRatioAvg": 0.8349726775956284, "computeRatioMax": 1, "endMs": "1665778637193", "id": "17", "inputStages": [ "13", "14", "11", "10", "12" ], "name": "S11: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "33", "readRatioAvg": 0.030601092896174863, "readRatioMax": 0.036065573770491806, "recordsRead": "4613840", "recordsWritten": "36", "shuffleOutputBytes": "2592", "shuffleOutputBytesSpilled": "0", "slotMs": "4285", "startMs": "1665778636654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_store_sk, $93:ss_promo_sk, $94:ss_ticket_number, $95:ss_ext_sales_price, $96:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$310 := SUM($411)", "$311 := SUM($340)", "$312 := SUM($341)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($413, NUMERIC<...>)", "$341 := subtract($412, coalesce($414, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$410 := $400, $411 := $402, $412 := $403, $413 := $404, $414 := $405", "INNER HASH JOIN EACH WITH ALL ON $401 = $1" ] }, { "kind": "JOIN", "substeps": [ "$400 := $396, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395", "INNER HASH JOIN EACH WITH ALL ON $390 = $40" ] }, { "kind": "JOIN", "substeps": [ "$390 := $380, $391 := $382, $392 := $383, $393 := $384, $394 := $385, $395 := $386, $396 := $31", "INNER HASH JOIN EACH WITH ALL ON $381 = $30" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $374, $384 := $375, $385 := $376, $386 := $377", "INNER HASH JOIN EACH WITH ALL ON $370 = $110" ] }, { "kind": "JOIN", "substeps": [ "$370 := $90, $371 := $91, $372 := $92, $373 := $93, $374 := $95, $375 := $96, $376 := $102, $377 := $103", "LEFT OUTER HASH JOIN EACH WITH ALL ON $91 = $100, $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$420, $310, $311, $312", "TO __stage11_output", "BY HASH($420)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002185792349726776, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.004371584699453552, "writeRatioMax": 0.00546448087431694 }, { "completedParallelInputs": "3", "computeMsAvg": "9", "computeMsMax": "10", "computeRatioAvg": 0.009836065573770493, "computeRatioMax": 0.01092896174863388, "endMs": "1665778637253", "id": "18", "inputStages": [ "15", "17", "16" ], "name": "S12: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1142", "recordsWritten": "431", "shuffleOutputBytes": "48274", "shuffleOutputBytesSpilled": "0", "slotMs": "107", "startMs": "1665778637215", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $310, $311, $312", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$490, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$560, $330, $331, $332", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $580 := $200, $581 := $201, $582 := $220", "$190 := SUM($232)", "$191 := SUM($233)", "$192 := SUM($234)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal(bitwise_and($240, 1), 0), NULL, $230)", "$201 := if(equal(bitwise_and($240, 2), 0), NULL, $231)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'store channel'", "$251 := concat('store', $430)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $430 := $420", "$280 := SUM($310)", "$281 := SUM($311)", "$282 := SUM($312)" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := 'catalog channel'", "$261 := concat('catalog_page', $500)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $490", "$290 := SUM($320)", "$291 := SUM($321)", "$292 := SUM($322)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 'web channel'", "$271 := concat('web_site', $570)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($330)", "$301 := SUM($331)", "$302 := SUM($332)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($241, 1)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $580, $581, $582", "TO __stage12_output", "BY HASH($580, $581, $582)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.002185792349726776, "writeMsAvg": "15", "writeMsMax": "17", "writeRatioAvg": 0.01639344262295082, "writeRatioMax": 0.018579234972677595 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.015300546448087432, "computeRatioMax": 0.015300546448087432, "endMs": "1665778637295", "id": "19", "inputStages": [ "18" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "431", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778637266", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $580, $581, $582", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $590 := $580, $591 := $581, $592 := $582", "$180 := SUM($190)", "$181 := SUM($191)", "$182 := SUM($192)" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.001092896174863388, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.013114754098360656, "writeRatioMax": 0.013114754098360656 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.006557377049180328, "computeRatioMax": 0.006557377049180328, "endMs": "1665778637320", "id": "20", "inputStages": [ "19" ], "name": "S14: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778637279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$603 ASC, $604 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$610, $611, $612, $613, $614", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001092896174863388, "waitRatioMax": 0.001092896174863388, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.006557377049180328, "writeRatioMax": 0.006557377049180328 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "14", "elapsedMs": "739", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "1552" }, { "activeUnits": "5", "completedUnits": "32", "elapsedMs": "1510", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8157" } ], "totalBytesBilled": "381681664", "totalBytesProcessed": "380948994", "totalPartitionsProcessed": "0", "totalSlotMs": "8157", "transferredBytes": "0" }, "startTime": "1665778635849", "totalBytesProcessed": "380948994", "totalSlotMs": "8157" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon937045ec_9461_4f8a_b34f_70dbfd6f2864" }, "priority": "INTERACTIVE", "query": "with ssr as\n (select s_store_id as store_id,\n sum(ss_ext_sales_price) as sales,\n sum(coalesce(sr_return_amt, 0)) as returns,\n sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n from store_sales left outer join store_returns on\n (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n date_dim,\n store,\n item,\n promotion\n where ss_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date) \n and (cast('2000-08-23' + 30 as date))\n and ss_store_sk = s_store_sk\n and ss_item_sk = i_item_sk\n and i_current_price > 50\n and ss_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id as catalog_page_id,\n sum(cs_ext_sales_price) as sales,\n sum(coalesce(cr_return_amount, 0)) as returns,\n sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n from catalog_sales left outer join catalog_returns on\n (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n date_dim,\n catalog_page,\n item,\n promotion\n where cs_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and cs_catalog_page_sk = cp_catalog_page_sk\n and cs_item_sk = i_item_sk\n and i_current_price > 50\n and cs_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n sum(ws_ext_sales_price) as sales,\n sum(coalesce(wr_return_amt, 0)) as returns,\n sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n from web_sales left outer join web_returns on\n (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n date_dim,\n web_site,\n item,\n promotion\n where ws_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and ws_web_site_sk = web_site_sk\n and ws_item_sk = i_item_sk\n and i_current_price > 50\n and ws_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by web_site_id)\n select channel\n , id\n , sum(sales) as sales\n , sum(returns) as returns\n , sum(profit) as profit\n from \n (select 'store channel' as channel\n , 'store' || store_id as id\n , sales\n , returns\n , profit\n from ssr\n union all\n select 'catalog channel' as channel\n , 'catalog_page' || catalog_page_id as id\n , sales\n , returns\n , profit\n from csr\n union all\n select 'web channel' as channel\n , 'web_site' || web_site_id as id\n , sales\n , returns\n , profit\n from wsr\n ) x\n group by rollup (channel, id)\n order by channel\n ,id\n limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "U7QkUDtWtvwcitnF1+SgwQ==", "id": "test-project-364309:europe-west1.query80_1665778639", "jobReference": { "jobId": "query80_1665778639", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query80_1665778639?location=europe-west1", "statistics": { "creationTime": "1665778639985", "endTime": "1665778641502", "finalExecutionDurationMs": "1175", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "380948994", "performanceInsights": { "avgPreviousExecutionMs": "1374" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.012671594508975714, "computeRatioMax": 0.012671594508975714, "endMs": "1665778640291", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.009503695881731784, "readRatioMax": 0.009503695881731784, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778640253", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:p_promo_sk, $21:p_channel_tv", "FROM promotion", "WHERE equal($21, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008447729672650475, "writeRatioMax": 0.008447729672650475 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.012671594508975714, "computeRatioMax": 0.012671594508975714, "endMs": "1665778640299", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006335797254487857, "readRatioMax": 0.006335797254487857, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778640268", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:i_item_sk, $81:i_current_price", "FROM item", "WHERE greater($81, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01689545934530095, "writeRatioMax": 0.01689545934530095 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.010559662090813094, "computeRatioMax": 0.010559662090813094, "endMs": "1665778640315", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005279831045406547, "readRatioMax": 0.005279831045406547, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "900", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778640283", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:web_site_sk, $71:web_site_id", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.021119324181626188, "writeRatioMax": 0.021119324181626188 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.02006335797254488, "computeRatioMax": 0.02006335797254488, "endMs": "1665778640336", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008447729672650475, "readRatioMax": 0.008447729672650475, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778640300", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_date", "FROM date_dim", "WHERE between($171, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.006335797254487857, "writeRatioMax": 0.006335797254487857 }, { "completedParallelInputs": "1", "computeMsAvg": "149", "computeMsMax": "149", "computeRatioAvg": 0.1573389651531151, "computeRatioMax": 0.1573389651531151, "endMs": "1665778640434", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.009503695881731784, "readRatioMax": 0.009503695881731784, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3629084", "shuffleOutputBytesSpilled": "0", "slotMs": "123", "startMs": "1665778640316", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:wr_item_sk, $161:wr_order_number, $162:wr_return_amt, $163:wr_net_loss", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.012671594508975714, "writeRatioMax": 0.012671594508975714 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.008447729672650475, "computeRatioMax": 0.008447729672650475, "endMs": "1665778640365", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005279831045406547, "readRatioMax": 0.005279831045406547, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778640336", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk, $11:p_channel_tv", "FROM promotion", "WHERE equal($11, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage05_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.004223864836325237, "waitRatioMax": 0.004223864836325237, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.01900739176346357, "writeRatioMax": 0.01900739176346357 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.01583949313621964, "computeRatioMax": 0.01583949313621964, "endMs": "1665778640385", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007391763463569166, "readRatioMax": 0.007391763463569166, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778640348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_current_price", "FROM item", "WHERE greater($61, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.007391763463569166, "writeRatioMax": 0.007391763463569166 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.01900739176346357, "computeRatioMax": 0.01900739176346357, "endMs": "1665778640401", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006335797254487857, "readRatioMax": 0.006335797254487857, "recordsRead": "11718", "recordsWritten": "11718", "shuffleOutputBytes": "351540", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778640367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cp_catalog_page_sk, $51:cp_catalog_page_id", "FROM catalog_page" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021119324181626186, "waitRatioMax": 0.0021119324181626186, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01689545934530095, "writeRatioMax": 0.01689545934530095 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.012671594508975714, "computeRatioMax": 0.012671594508975714, "endMs": "1665778640421", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007391763463569166, "readRatioMax": 0.007391763463569166, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778640385", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021119324181626186, "waitRatioMax": 0.0021119324181626186, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.007391763463569166, "writeRatioMax": 0.007391763463569166 }, { "completedParallelInputs": "1", "computeMsAvg": "235", "computeMsMax": "235", "computeRatioAvg": 0.2481520591341077, "computeRatioMax": 0.2481520591341077, "endMs": "1665778640562", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.011615628299894404, "readRatioMax": 0.011615628299894404, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "7399036", "shuffleOutputBytesSpilled": "0", "slotMs": "245", "startMs": "1665778640401", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cr_item_sk, $131:cr_order_number, $132:cr_return_amount, $133:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.014783526927138331, "writeRatioMax": 0.014783526927138331 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.011615628299894404, "computeRatioMax": 0.011615628299894404, "endMs": "1665778640459", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005279831045406547, "readRatioMax": 0.005279831045406547, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778640419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:p_promo_sk, $2:p_channel_tv", "FROM promotion", "WHERE equal($2, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021119324181626186, "waitRatioMax": 0.0021119324181626186, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02006335797254488, "writeRatioMax": 0.02006335797254488 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.009503695881731784, "computeRatioMax": 0.009503695881731784, "endMs": "1665778640475", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005279831045406547, "readRatioMax": 0.005279831045406547, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778640434", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_current_price", "FROM item", "WHERE greater($41, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01689545934530095, "writeRatioMax": 0.01689545934530095 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.009503695881731784, "computeRatioMax": 0.009503695881731784, "endMs": "1665778640517", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0031678986272439284, "readRatioMax": 0.0031678986272439284, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778640448", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "61", "writeMsMax": "61", "writeRatioAvg": 0.06441393875395987, "writeRatioMax": 0.06441393875395987 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.024287222808870117, "computeRatioMax": 0.024287222808870117, "endMs": "1665778640516", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.012671594508975714, "readRatioMax": 0.012671594508975714, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665778640466", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_date", "FROM date_dim", "WHERE between($111, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021119324181626186, "waitRatioMax": 0.0021119324181626186, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.011615628299894404, "writeRatioMax": 0.011615628299894404 }, { "completedParallelInputs": "1", "computeMsAvg": "217", "computeMsMax": "217", "computeRatioAvg": 0.22914466737064415, "computeRatioMax": 0.22914466737064415, "endMs": "1665778640684", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.012671594508975714, "readRatioMax": 0.012671594508975714, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "14630712", "shuffleOutputBytesSpilled": "0", "slotMs": "242", "startMs": "1665778640482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:sr_item_sk, $101:sr_ticket_number, $102:sr_return_amt, $103:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02006335797254488, "writeRatioMax": 0.02006335797254488 }, { "completedParallelInputs": "1", "computeMsAvg": "549", "computeMsMax": "549", "computeRatioAvg": 0.5797254487856388, "computeRatioMax": 0.5797254487856388, "endMs": "1665778640879", "id": "15", "inputStages": [ "2", "0", "4", "3", "1" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "27", "readMsMax": "27", "readRatioAvg": 0.028511087645195353, "readRatioMax": 0.028511087645195353, "recordsRead": "792557", "recordsWritten": "15", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "519", "startMs": "1665778640499", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ws_sold_date_sk, $151:ws_item_sk, $152:ws_web_site_sk, $153:ws_promo_sk, $154:ws_order_number, $155:ws_ext_sales_price, $156:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162, $163", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $550", "$330 := SUM($551)", "$331 := SUM($360)", "$332 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := coalesce($553, NUMERIC<...>)", "$361 := subtract($552, coalesce($554, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$550 := $540, $551 := $542, $552 := $543, $553 := $544, $554 := $545", "INNER HASH JOIN EACH WITH ALL ON $541 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $536, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535", "INNER HASH JOIN EACH WITH ALL ON $530 = $80" ] }, { "kind": "JOIN", "substeps": [ "$530 := $520, $531 := $522, $532 := $523, $533 := $524, $534 := $525, $535 := $526, $536 := $71", "INNER HASH JOIN EACH WITH ALL ON $521 = $70" ] }, { "kind": "JOIN", "substeps": [ "$520 := $511, $521 := $512, $522 := $513, $523 := $514, $524 := $515, $525 := $516, $526 := $517", "INNER HASH JOIN EACH WITH ALL ON $510 = $170" ] }, { "kind": "JOIN", "substeps": [ "$510 := $150, $511 := $151, $512 := $152, $513 := $153, $514 := $155, $515 := $156, $516 := $162, $517 := $163", "LEFT OUTER HASH JOIN EACH WITH ALL ON $151 = $160, $154 = $161" ] }, { "kind": "WRITE", "substeps": [ "$560, $330, $331, $332", "TO __stage0F_output", "BY HASH($560)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021119324181626186, "waitRatioMax": 0.0021119324181626186, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.006335797254487857, "writeRatioMax": 0.006335797254487857 }, { "completedParallelInputs": "5", "computeMsAvg": "355", "computeMsMax": "445", "computeRatioAvg": 0.37486800422386485, "computeRatioMax": 0.4699049630411827, "endMs": "1665778640914", "id": "16", "inputStages": [ "8", "9", "7", "5", "6" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "25", "readMsMax": "48", "readRatioAvg": 0.026399155227032733, "readRatioMax": 0.050686378035902854, "recordsRead": "2227373", "recordsWritten": "1091", "shuffleOutputBytes": "78552", "shuffleOutputBytesSpilled": "0", "slotMs": "1853", "startMs": "1665778640605", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_catalog_page_sk, $122:cs_item_sk, $123:cs_promo_sk, $124:cs_order_number, $125:cs_ext_sales_price, $126:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$320 := SUM($481)", "$321 := SUM($350)", "$322 := SUM($351)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($483, NUMERIC<...>)", "$351 := subtract($482, coalesce($484, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$480 := $470, $481 := $472, $482 := $473, $483 := $474, $484 := $475", "INNER HASH JOIN EACH WITH ALL ON $471 = $10" ] }, { "kind": "JOIN", "substeps": [ "$470 := $466, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465", "INNER HASH JOIN EACH WITH ALL ON $460 = $60" ] }, { "kind": "JOIN", "substeps": [ "$460 := $451, $461 := $452, $462 := $453, $463 := $454, $464 := $455, $465 := $456, $466 := $51", "INNER HASH JOIN EACH WITH ALL ON $450 = $50" ] }, { "kind": "JOIN", "substeps": [ "$450 := $441, $451 := $442, $452 := $443, $453 := $444, $454 := $445, $455 := $446, $456 := $447", "INNER HASH JOIN EACH WITH ALL ON $440 = $140" ] }, { "kind": "JOIN", "substeps": [ "$440 := $120, $441 := $121, $442 := $122, $443 := $123, $444 := $125, $445 := $126, $446 := $132, $447 := $133", "LEFT OUTER HASH JOIN EACH WITH ALL ON $122 = $130, $124 = $131" ] }, { "kind": "WRITE", "substeps": [ "$490, $320, $321, $322", "TO __stage10_output", "BY HASH($490)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.005279831045406547, "writeRatioMax": 0.006335797254487857 }, { "completedParallelInputs": "6", "computeMsAvg": "789", "computeMsMax": "947", "computeRatioAvg": 0.8331573389651531, "computeRatioMax": 1, "endMs": "1665778641271", "id": "17", "inputStages": [ "10", "12", "13", "14", "11" ], "name": "S11: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "31", "readRatioAvg": 0.029567053854276663, "readRatioMax": 0.03273495248152059, "recordsRead": "4613840", "recordsWritten": "36", "shuffleOutputBytes": "2592", "shuffleOutputBytesSpilled": "0", "slotMs": "4101", "startMs": "1665778640730", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_store_sk, $93:ss_promo_sk, $94:ss_ticket_number, $95:ss_ext_sales_price, $96:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$310 := SUM($411)", "$311 := SUM($340)", "$312 := SUM($341)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($413, NUMERIC<...>)", "$341 := subtract($412, coalesce($414, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$410 := $400, $411 := $402, $412 := $403, $413 := $404, $414 := $405", "INNER HASH JOIN EACH WITH ALL ON $401 = $1" ] }, { "kind": "JOIN", "substeps": [ "$400 := $396, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395", "INNER HASH JOIN EACH WITH ALL ON $390 = $40" ] }, { "kind": "JOIN", "substeps": [ "$390 := $380, $391 := $382, $392 := $383, $393 := $384, $394 := $385, $395 := $386, $396 := $31", "INNER HASH JOIN EACH WITH ALL ON $381 = $30" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $374, $384 := $375, $385 := $376, $386 := $377", "INNER HASH JOIN EACH WITH ALL ON $370 = $110" ] }, { "kind": "JOIN", "substeps": [ "$370 := $90, $371 := $91, $372 := $92, $373 := $93, $374 := $95, $375 := $96, $376 := $102, $377 := $103", "LEFT OUTER HASH JOIN EACH WITH ALL ON $91 = $100, $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$420, $310, $311, $312", "TO __stage11_output", "BY HASH($420)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021119324181626186, "waitRatioMax": 0.0021119324181626186, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.005279831045406547, "writeRatioMax": 0.006335797254487857 }, { "completedParallelInputs": "3", "computeMsAvg": "14", "computeMsMax": "16", "computeRatioAvg": 0.014783526927138331, "computeRatioMax": 0.01689545934530095, "endMs": "1665778641336", "id": "18", "inputStages": [ "15", "16", "17" ], "name": "S12: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1142", "recordsWritten": "431", "shuffleOutputBytes": "48274", "shuffleOutputBytesSpilled": "0", "slotMs": "133", "startMs": "1665778641295", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $310, $311, $312", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$490, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$560, $330, $331, $332", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $580 := $200, $581 := $201, $582 := $220", "$190 := SUM($232)", "$191 := SUM($233)", "$192 := SUM($234)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal(bitwise_and($240, 1), 0), NULL, $230)", "$201 := if(equal(bitwise_and($240, 2), 0), NULL, $231)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'store channel'", "$251 := concat('store', $430)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $430 := $420", "$280 := SUM($310)", "$281 := SUM($311)", "$282 := SUM($312)" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := 'catalog channel'", "$261 := concat('catalog_page', $500)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $490", "$290 := SUM($320)", "$291 := SUM($321)", "$292 := SUM($322)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 'web channel'", "$271 := concat('web_site', $570)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($330)", "$301 := SUM($331)", "$302 := SUM($332)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($241, 1)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $580, $581, $582", "TO __stage12_output", "BY HASH($580, $581, $582)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021119324181626186, "waitRatioMax": 0.0021119324181626186, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01583949313621964, "writeRatioMax": 0.01583949313621964 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.005279831045406547, "computeRatioMax": 0.005279831045406547, "endMs": "1665778641383", "id": "19", "inputStages": [ "18" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "431", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778641348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $580, $581, $582", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $590 := $580, $591 := $581, $592 := $582", "$180 := SUM($190)", "$181 := SUM($191)", "$182 := SUM($192)" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.028511087645195353, "writeRatioMax": 0.028511087645195353 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.011615628299894404, "computeRatioMax": 0.011615628299894404, "endMs": "1665778641393", "id": "20", "inputStages": [ "19" ], "name": "S14: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778641362", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$603 ASC, $604 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$610, $611, $612, $613, $614", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010559662090813093, "waitRatioMax": 0.0010559662090813093, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008447729672650475, "writeRatioMax": 0.008447729672650475 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "12", "completedUnits": "15", "elapsedMs": "683", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "1615" }, { "activeUnits": "0", "completedUnits": "32", "elapsedMs": "1373", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7788" } ], "totalBytesBilled": "381681664", "totalBytesProcessed": "380948994", "totalPartitionsProcessed": "0", "totalSlotMs": "7788", "transferredBytes": "0" }, "startTime": "1665778640072", "totalBytesProcessed": "380948994", "totalSlotMs": "7788" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonfeed956f_1216_40ae_893e_8bb86a6da6cc" }, "priority": "INTERACTIVE", "query": "with ssr as\n (select s_store_id as store_id,\n sum(ss_ext_sales_price) as sales,\n sum(coalesce(sr_return_amt, 0)) as returns,\n sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n from store_sales left outer join store_returns on\n (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n date_dim,\n store,\n item,\n promotion\n where ss_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date) \n and (cast('2000-08-23' + 30 as date))\n and ss_store_sk = s_store_sk\n and ss_item_sk = i_item_sk\n and i_current_price > 50\n and ss_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id as catalog_page_id,\n sum(cs_ext_sales_price) as sales,\n sum(coalesce(cr_return_amount, 0)) as returns,\n sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n from catalog_sales left outer join catalog_returns on\n (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n date_dim,\n catalog_page,\n item,\n promotion\n where cs_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and cs_catalog_page_sk = cp_catalog_page_sk\n and cs_item_sk = i_item_sk\n and i_current_price > 50\n and cs_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n sum(ws_ext_sales_price) as sales,\n sum(coalesce(wr_return_amt, 0)) as returns,\n sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n from web_sales left outer join web_returns on\n (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n date_dim,\n web_site,\n item,\n promotion\n where ws_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and ws_web_site_sk = web_site_sk\n and ws_item_sk = i_item_sk\n and i_current_price > 50\n and ws_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by web_site_id)\n select channel\n , id\n , sum(sales) as sales\n , sum(returns) as returns\n , sum(profit) as profit\n from \n (select 'store channel' as channel\n , 'store' || store_id as id\n , sales\n , returns\n , profit\n from ssr\n union all\n select 'catalog channel' as channel\n , 'catalog_page' || catalog_page_id as id\n , sales\n , returns\n , profit\n from csr\n union all\n select 'web channel' as channel\n , 'web_site' || web_site_id as id\n , sales\n , returns\n , profit\n from wsr\n ) x\n group by rollup (channel, id)\n order by channel\n ,id\n limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "eTUfrKAYbe221K1eamCUdw==", "id": "test-project-364309:europe-west1.query80_1665778643", "jobReference": { "jobId": "query80_1665778643", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query80_1665778643?location=europe-west1", "statistics": { "creationTime": "1665778644106", "endTime": "1665778645646", "finalExecutionDurationMs": "1253", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "380948994", "performanceInsights": { "avgPreviousExecutionMs": "1352" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0063006300630063005, "computeRatioMax": 0.0063006300630063005, "endMs": "1665778644365", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0054005400540054005, "readRatioMax": 0.0054005400540054005, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778644334", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:p_promo_sk, $21:p_channel_tv", "FROM promotion", "WHERE equal($21, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.016201620162016202, "writeRatioMax": 0.016201620162016202 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0153015301530153, "computeRatioMax": 0.0153015301530153, "endMs": "1665778644390", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0072007200720072, "readRatioMax": 0.0072007200720072, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778644349", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:i_item_sk, $81:i_current_price", "FROM item", "WHERE greater($81, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.008100810081008101, "writeRatioMax": 0.008100810081008101 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0144014401440144, "computeRatioMax": 0.0144014401440144, "endMs": "1665778644409", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.010801080108010801, "readRatioMax": 0.010801080108010801, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "900", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778644364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:web_site_sk, $71:web_site_id", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.008100810081008101, "writeRatioMax": 0.008100810081008101 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.011701170117011701, "computeRatioMax": 0.011701170117011701, "endMs": "1665778644404", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0072007200720072, "readRatioMax": 0.0072007200720072, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778644376", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_date", "FROM date_dim", "WHERE between($171, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.008100810081008101, "writeRatioMax": 0.008100810081008101 }, { "completedParallelInputs": "1", "computeMsAvg": "60", "computeMsMax": "60", "computeRatioAvg": 0.054005400540054004, "computeRatioMax": 0.054005400540054004, "endMs": "1665778644460", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0072007200720072, "readRatioMax": 0.0072007200720072, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3629084", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665778644389", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:wr_item_sk, $161:wr_order_number, $162:wr_return_amt, $163:wr_net_loss", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.009900990099009901, "writeRatioMax": 0.009900990099009901 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0072007200720072, "computeRatioMax": 0.0072007200720072, "endMs": "1665778644431", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004500450045004501, "readRatioMax": 0.004500450045004501, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778644402", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk, $11:p_channel_tv", "FROM promotion", "WHERE equal($11, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0153015301530153, "writeRatioMax": 0.0153015301530153 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009900990099009901, "computeRatioMax": 0.009900990099009901, "endMs": "1665778644441", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004500450045004501, "readRatioMax": 0.004500450045004501, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778644414", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_current_price", "FROM item", "WHERE greater($61, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.013501350135013501, "writeRatioMax": 0.013501350135013501 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0144014401440144, "computeRatioMax": 0.0144014401440144, "endMs": "1665778644455", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0054005400540054005, "readRatioMax": 0.0054005400540054005, "recordsRead": "11718", "recordsWritten": "11718", "shuffleOutputBytes": "351540", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778644428", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cp_catalog_page_sk, $51:cp_catalog_page_id", "FROM catalog_page" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.009000900090009001, "writeRatioMax": 0.009000900090009001 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.010801080108010801, "computeRatioMax": 0.010801080108010801, "endMs": "1665778644468", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0063006300630063005, "readRatioMax": 0.0063006300630063005, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778644440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.010801080108010801, "writeRatioMax": 0.010801080108010801 }, { "completedParallelInputs": "1", "computeMsAvg": "196", "computeMsMax": "196", "computeRatioAvg": 0.17641764176417643, "computeRatioMax": 0.17641764176417643, "endMs": "1665778644673", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.020702070207020702, "readRatioMax": 0.020702070207020702, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "7399036", "shuffleOutputBytesSpilled": "0", "slotMs": "294", "startMs": "1665778644455", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cr_item_sk, $131:cr_order_number, $132:cr_return_amount, $133:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.0297029702970297, "writeRatioMax": 0.0297029702970297 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.004500450045004501, "computeRatioMax": 0.004500450045004501, "endMs": "1665778644497", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0027002700270027003, "readRatioMax": 0.0027002700270027003, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778644470", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:p_promo_sk, $2:p_channel_tv", "FROM promotion", "WHERE equal($2, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0153015301530153, "writeRatioMax": 0.0153015301530153 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.008100810081008101, "computeRatioMax": 0.008100810081008101, "endMs": "1665778644526", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004500450045004501, "readRatioMax": 0.004500450045004501, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778644485", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_current_price", "FROM item", "WHERE greater($41, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0144014401440144, "writeRatioMax": 0.0144014401440144 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0072007200720072, "computeRatioMax": 0.0072007200720072, "endMs": "1665778644574", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0027002700270027003, "readRatioMax": 0.0027002700270027003, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665778644497", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage0C_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "68", "writeMsMax": "68", "writeRatioAvg": 0.0612061206120612, "writeRatioMax": 0.0612061206120612 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.010801080108010801, "computeRatioMax": 0.010801080108010801, "endMs": "1665778644538", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0054005400540054005, "readRatioMax": 0.0054005400540054005, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778644512", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_date", "FROM date_dim", "WHERE between($111, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.009900990099009901, "writeRatioMax": 0.009900990099009901 }, { "completedParallelInputs": "1", "computeMsAvg": "428", "computeMsMax": "428", "computeRatioAvg": 0.3852385238523852, "computeRatioMax": 0.3852385238523852, "endMs": "1665778644846", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.018901890189018902, "readRatioMax": 0.018901890189018902, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "14630712", "shuffleOutputBytesSpilled": "0", "slotMs": "419", "startMs": "1665778644526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:sr_item_sk, $101:sr_ticket_number, $102:sr_return_amt, $103:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage0E_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.019801980198019802, "writeRatioMax": 0.019801980198019802 }, { "completedParallelInputs": "1", "computeMsAvg": "605", "computeMsMax": "605", "computeRatioAvg": 0.5445544554455446, "computeRatioMax": 0.5445544554455446, "endMs": "1665778644922", "id": "15", "inputStages": [ "3", "4", "2", "0", "1" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "30", "readMsMax": "30", "readRatioAvg": 0.027002700270027002, "readRatioMax": 0.027002700270027002, "recordsRead": "792557", "recordsWritten": "15", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "537", "startMs": "1665778644541", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ws_sold_date_sk, $151:ws_item_sk, $152:ws_web_site_sk, $153:ws_promo_sk, $154:ws_order_number, $155:ws_ext_sales_price, $156:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162, $163", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $550", "$330 := SUM($551)", "$331 := SUM($360)", "$332 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := coalesce($553, NUMERIC<...>)", "$361 := subtract($552, coalesce($554, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$550 := $540, $551 := $542, $552 := $543, $553 := $544, $554 := $545", "INNER HASH JOIN EACH WITH ALL ON $541 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $536, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535", "INNER HASH JOIN EACH WITH ALL ON $530 = $80" ] }, { "kind": "JOIN", "substeps": [ "$530 := $520, $531 := $522, $532 := $523, $533 := $524, $534 := $525, $535 := $526, $536 := $71", "INNER HASH JOIN EACH WITH ALL ON $521 = $70" ] }, { "kind": "JOIN", "substeps": [ "$520 := $511, $521 := $512, $522 := $513, $523 := $514, $524 := $515, $525 := $516, $526 := $517", "INNER HASH JOIN EACH WITH ALL ON $510 = $170" ] }, { "kind": "JOIN", "substeps": [ "$510 := $150, $511 := $151, $512 := $152, $513 := $153, $514 := $155, $515 := $156, $516 := $162, $517 := $163", "LEFT OUTER HASH JOIN EACH WITH ALL ON $151 = $160, $154 = $161" ] }, { "kind": "WRITE", "substeps": [ "$560, $330, $331, $332", "TO __stage0F_output", "BY HASH($560)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0072007200720072, "writeRatioMax": 0.0072007200720072 }, { "completedParallelInputs": "5", "computeMsAvg": "403", "computeMsMax": "468", "computeRatioAvg": 0.3627362736273627, "computeRatioMax": 0.42124212421242124, "endMs": "1665778645056", "id": "16", "inputStages": [ "8", "7", "6", "5", "9" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "24", "readMsMax": "29", "readRatioAvg": 0.021602160216021602, "readRatioMax": 0.026102610261026102, "recordsRead": "2227373", "recordsWritten": "1091", "shuffleOutputBytes": "78552", "shuffleOutputBytesSpilled": "0", "slotMs": "2058", "startMs": "1665778644716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_catalog_page_sk, $122:cs_item_sk, $123:cs_promo_sk, $124:cs_order_number, $125:cs_ext_sales_price, $126:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$320 := SUM($481)", "$321 := SUM($350)", "$322 := SUM($351)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($483, NUMERIC<...>)", "$351 := subtract($482, coalesce($484, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$480 := $470, $481 := $472, $482 := $473, $483 := $474, $484 := $475", "INNER HASH JOIN EACH WITH ALL ON $471 = $10" ] }, { "kind": "JOIN", "substeps": [ "$470 := $466, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465", "INNER HASH JOIN EACH WITH ALL ON $460 = $60" ] }, { "kind": "JOIN", "substeps": [ "$460 := $451, $461 := $452, $462 := $453, $463 := $454, $464 := $455, $465 := $456, $466 := $51", "INNER HASH JOIN EACH WITH ALL ON $450 = $50" ] }, { "kind": "JOIN", "substeps": [ "$450 := $441, $451 := $442, $452 := $443, $453 := $444, $454 := $445, $455 := $446, $456 := $447", "INNER HASH JOIN EACH WITH ALL ON $440 = $140" ] }, { "kind": "JOIN", "substeps": [ "$440 := $120, $441 := $121, $442 := $122, $443 := $123, $444 := $125, $445 := $126, $446 := $132, $447 := $133", "LEFT OUTER HASH JOIN EACH WITH ALL ON $122 = $130, $124 = $131" ] }, { "kind": "WRITE", "substeps": [ "$490, $320, $321, $322", "TO __stage10_output", "BY HASH($490)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0018001800180018, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.0054005400540054005, "writeRatioMax": 0.0072007200720072 }, { "completedParallelInputs": "6", "computeMsAvg": "941", "computeMsMax": "1111", "computeRatioAvg": 0.846984698469847, "computeRatioMax": 1, "endMs": "1665778645440", "id": "17", "inputStages": [ "12", "11", "14", "13", "10" ], "name": "S11: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "33", "readRatioAvg": 0.026102610261026102, "readRatioMax": 0.0297029702970297, "recordsRead": "4613840", "recordsWritten": "36", "shuffleOutputBytes": "2592", "shuffleOutputBytesSpilled": "0", "slotMs": "4646", "startMs": "1665778644858", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_store_sk, $93:ss_promo_sk, $94:ss_ticket_number, $95:ss_ext_sales_price, $96:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$310 := SUM($411)", "$311 := SUM($340)", "$312 := SUM($341)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($413, NUMERIC<...>)", "$341 := subtract($412, coalesce($414, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$410 := $400, $411 := $402, $412 := $403, $413 := $404, $414 := $405", "INNER HASH JOIN EACH WITH ALL ON $401 = $1" ] }, { "kind": "JOIN", "substeps": [ "$400 := $396, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395", "INNER HASH JOIN EACH WITH ALL ON $390 = $40" ] }, { "kind": "JOIN", "substeps": [ "$390 := $380, $391 := $382, $392 := $383, $393 := $384, $394 := $385, $395 := $386, $396 := $31", "INNER HASH JOIN EACH WITH ALL ON $381 = $30" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $374, $384 := $375, $385 := $376, $386 := $377", "INNER HASH JOIN EACH WITH ALL ON $370 = $110" ] }, { "kind": "JOIN", "substeps": [ "$370 := $90, $371 := $91, $372 := $92, $373 := $93, $374 := $95, $375 := $96, $376 := $102, $377 := $103", "LEFT OUTER HASH JOIN EACH WITH ALL ON $91 = $100, $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$420, $310, $311, $312", "TO __stage11_output", "BY HASH($420)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0036003600360036, "writeRatioMax": 0.004500450045004501 }, { "completedParallelInputs": "3", "computeMsAvg": "14", "computeMsMax": "17", "computeRatioAvg": 0.012601260126012601, "computeRatioMax": 0.0153015301530153, "endMs": "1665778645511", "id": "18", "inputStages": [ "17", "15", "16" ], "name": "S12: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1142", "recordsWritten": "431", "shuffleOutputBytes": "48274", "shuffleOutputBytesSpilled": "0", "slotMs": "136", "startMs": "1665778645464", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $310, $311, $312", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$490, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$560, $330, $331, $332", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $580 := $200, $581 := $201, $582 := $220", "$190 := SUM($232)", "$191 := SUM($233)", "$192 := SUM($234)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal(bitwise_and($240, 1), 0), NULL, $230)", "$201 := if(equal(bitwise_and($240, 2), 0), NULL, $231)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'store channel'", "$251 := concat('store', $430)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $430 := $420", "$280 := SUM($310)", "$281 := SUM($311)", "$282 := SUM($312)" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := 'catalog channel'", "$261 := concat('catalog_page', $500)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $490", "$290 := SUM($320)", "$291 := SUM($321)", "$292 := SUM($322)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 'web channel'", "$271 := concat('web_site', $570)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($330)", "$301 := SUM($331)", "$302 := SUM($332)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($241, 1)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $580, $581, $582", "TO __stage12_output", "BY HASH($580, $581, $582)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0018001800180018, "waitRatioMax": 0.0018001800180018, "writeMsAvg": "24", "writeMsMax": "29", "writeRatioAvg": 0.021602160216021602, "writeRatioMax": 0.026102610261026102 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0054005400540054005, "computeRatioMax": 0.0054005400540054005, "endMs": "1665778645550", "id": "19", "inputStages": [ "18" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "431", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778645515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $580, $581, $582", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $590 := $580, $591 := $581, $592 := $582", "$180 := SUM($190)", "$181 := SUM($191)", "$182 := SUM($192)" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.012601260126012601, "writeRatioMax": 0.012601260126012601 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0063006300630063005, "computeRatioMax": 0.0063006300630063005, "endMs": "1665778645557", "id": "20", "inputStages": [ "19" ], "name": "S14: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778645529", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$603 ASC, $604 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$610, $611, $612, $613, $614", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009000900090009, "waitRatioMax": 0.0009000900090009, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0063006300630063005, "writeRatioMax": 0.0063006300630063005 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "14", "elapsedMs": "666", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "1469" }, { "activeUnits": "3", "completedUnits": "32", "elapsedMs": "1425", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8681" } ], "totalBytesBilled": "381681664", "totalBytesProcessed": "380948994", "totalPartitionsProcessed": "0", "totalSlotMs": "8681", "transferredBytes": "0" }, "startTime": "1665778644169", "totalBytesProcessed": "380948994", "totalSlotMs": "8681" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5f4008b2_9b53_4cdf_b720_b53cac687a96" }, "priority": "INTERACTIVE", "query": "with ssr as\n (select s_store_id as store_id,\n sum(ss_ext_sales_price) as sales,\n sum(coalesce(sr_return_amt, 0)) as returns,\n sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n from store_sales left outer join store_returns on\n (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n date_dim,\n store,\n item,\n promotion\n where ss_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date) \n and (cast('2000-08-23' + 30 as date))\n and ss_store_sk = s_store_sk\n and ss_item_sk = i_item_sk\n and i_current_price > 50\n and ss_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id as catalog_page_id,\n sum(cs_ext_sales_price) as sales,\n sum(coalesce(cr_return_amount, 0)) as returns,\n sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n from catalog_sales left outer join catalog_returns on\n (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n date_dim,\n catalog_page,\n item,\n promotion\n where cs_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and cs_catalog_page_sk = cp_catalog_page_sk\n and cs_item_sk = i_item_sk\n and i_current_price > 50\n and cs_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n sum(ws_ext_sales_price) as sales,\n sum(coalesce(wr_return_amt, 0)) as returns,\n sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n from web_sales left outer join web_returns on\n (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n date_dim,\n web_site,\n item,\n promotion\n where ws_sold_date_sk = d_date_sk\n and d_date between cast('2000-08-23' as date)\n and (cast('2000-08-23' + 30 as date))\n and ws_web_site_sk = web_site_sk\n and ws_item_sk = i_item_sk\n and i_current_price > 50\n and ws_promo_sk = p_promo_sk\n and p_channel_tv = 'N'\ngroup by web_site_id)\n select channel\n , id\n , sum(sales) as sales\n , sum(returns) as returns\n , sum(profit) as profit\n from \n (select 'store channel' as channel\n , 'store' || store_id as id\n , sales\n , returns\n , profit\n from ssr\n union all\n select 'catalog channel' as channel\n , 'catalog_page' || catalog_page_id as id\n , sales\n , returns\n , profit\n from csr\n union all\n select 'web channel' as channel\n , 'web_site' || web_site_id as id\n , sales\n , returns\n , profit\n from wsr\n ) x\n group by rollup (channel, id)\n order by channel\n ,id\n limit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "LVrEbiOF5OFG0S6p+459ag==", "id": "test-project-364309:europe-west1.query80_1665778647", "jobReference": { "jobId": "query80_1665778647", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query80_1665778647?location=europe-west1", "statistics": { "creationTime": "1665778648221", "endTime": "1665778649728", "finalExecutionDurationMs": "1147", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "380948994", "performanceInsights": { "avgPreviousExecutionMs": "1342" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011123470522803115, "computeRatioMax": 0.011123470522803115, "endMs": "1665778648538", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0055617352614015575, "readRatioMax": 0.0055617352614015575, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778648501", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:p_promo_sk, $21:p_channel_tv", "FROM promotion", "WHERE equal($21, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01668520578420467, "writeRatioMax": 0.01668520578420467 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012235817575083427, "computeRatioMax": 0.012235817575083427, "endMs": "1665778648548", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0055617352614015575, "readRatioMax": 0.0055617352614015575, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778648517", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:i_item_sk, $81:i_current_price", "FROM item", "WHERE greater($81, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.00778642936596218, "writeRatioMax": 0.00778642936596218 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012235817575083427, "computeRatioMax": 0.012235817575083427, "endMs": "1665778648568", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004449388209121246, "readRatioMax": 0.004449388209121246, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "900", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778648531", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:web_site_sk, $71:web_site_id", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01557285873192436, "writeRatioMax": 0.01557285873192436 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012235817575083427, "computeRatioMax": 0.012235817575083427, "endMs": "1665778648574", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0055617352614015575, "readRatioMax": 0.0055617352614015575, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778648546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_date", "FROM date_dim", "WHERE between($171, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01557285873192436, "writeRatioMax": 0.01557285873192436 }, { "completedParallelInputs": "1", "computeMsAvg": "72", "computeMsMax": "72", "computeRatioAvg": 0.08008898776418243, "computeRatioMax": 0.08008898776418243, "endMs": "1665778648654", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.010011123470522803, "readRatioMax": 0.010011123470522803, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3629084", "shuffleOutputBytesSpilled": "0", "slotMs": "95", "startMs": "1665778648562", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:wr_item_sk, $161:wr_order_number, $162:wr_return_amt, $163:wr_net_loss", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002224694104560623, "waitRatioMax": 0.002224694104560623, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.013348164627363738, "writeRatioMax": 0.013348164627363738 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.008898776418242492, "computeRatioMax": 0.008898776418242492, "endMs": "1665778648611", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004449388209121246, "readRatioMax": 0.004449388209121246, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778648578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk, $11:p_channel_tv", "FROM promotion", "WHERE equal($11, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.02335928809788654, "writeRatioMax": 0.02335928809788654 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.00778642936596218, "computeRatioMax": 0.00778642936596218, "endMs": "1665778648627", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004449388209121246, "readRatioMax": 0.004449388209121246, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778648592", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_current_price", "FROM item", "WHERE greater($61, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002224694104560623, "waitRatioMax": 0.002224694104560623, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01557285873192436, "writeRatioMax": 0.01557285873192436 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.014460511679644048, "computeRatioMax": 0.014460511679644048, "endMs": "1665778648649", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0055617352614015575, "readRatioMax": 0.0055617352614015575, "recordsRead": "11718", "recordsWritten": "11718", "shuffleOutputBytes": "351540", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778648607", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cp_catalog_page_sk, $51:cp_catalog_page_id", "FROM catalog_page" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01668520578420467, "writeRatioMax": 0.01668520578420467 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013348164627363738, "computeRatioMax": 0.013348164627363738, "endMs": "1665778648661", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006674082313681869, "readRatioMax": 0.006674082313681869, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778648620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01557285873192436, "writeRatioMax": 0.01557285873192436 }, { "completedParallelInputs": "1", "computeMsAvg": "220", "computeMsMax": "220", "computeRatioAvg": 0.2447163515016685, "computeRatioMax": 0.2447163515016685, "endMs": "1665778648809", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.014460511679644048, "readRatioMax": 0.014460511679644048, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "7399036", "shuffleOutputBytesSpilled": "0", "slotMs": "236", "startMs": "1665778648634", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cr_item_sk, $131:cr_order_number, $132:cr_return_amount, $133:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01668520578420467, "writeRatioMax": 0.01668520578420467 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012235817575083427, "computeRatioMax": 0.012235817575083427, "endMs": "1665778648687", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0055617352614015575, "readRatioMax": 0.0055617352614015575, "recordsRead": "300", "recordsWritten": "294", "shuffleOutputBytes": "2646", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778648653", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:p_promo_sk, $2:p_channel_tv", "FROM promotion", "WHERE equal($2, 'N')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008898776418242492, "writeRatioMax": 0.008898776418242492 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.014460511679644048, "computeRatioMax": 0.014460511679644048, "endMs": "1665778648698", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006674082313681869, "readRatioMax": 0.006674082313681869, "recordsRead": "18000", "recordsWritten": "1055", "shuffleOutputBytes": "9495", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778648666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_current_price", "FROM item", "WHERE greater($41, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.017797552836484983, "writeRatioMax": 0.017797552836484983 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010011123470522803, "computeRatioMax": 0.010011123470522803, "endMs": "1665778648722", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004449388209121246, "readRatioMax": 0.004449388209121246, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778648682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002224694104560623, "waitRatioMax": 0.002224694104560623, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.020022246941045607, "writeRatioMax": 0.020022246941045607 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.01557285873192436, "computeRatioMax": 0.01557285873192436, "endMs": "1665778648737", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00778642936596218, "readRatioMax": 0.00778642936596218, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778648698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_date", "FROM date_dim", "WHERE between($111, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.010011123470522803, "writeRatioMax": 0.010011123470522803 }, { "completedParallelInputs": "1", "computeMsAvg": "269", "computeMsMax": "269", "computeRatioAvg": 0.2992213570634038, "computeRatioMax": 0.2992213570634038, "endMs": "1665778648929", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.01668520578420467, "readRatioMax": 0.01668520578420467, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "14630712", "shuffleOutputBytesSpilled": "0", "slotMs": "260", "startMs": "1665778648712", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:sr_item_sk, $101:sr_ticket_number, $102:sr_return_amt, $103:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01668520578420467, "writeRatioMax": 0.01668520578420467 }, { "completedParallelInputs": "1", "computeMsAvg": "899", "computeMsMax": "899", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778649239", "id": "15", "inputStages": [ "3", "4", "1", "2", "0" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.034482758620689655, "readRatioMax": 0.034482758620689655, "recordsRead": "792557", "recordsWritten": "15", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "742", "startMs": "1665778648728", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ws_sold_date_sk, $151:ws_item_sk, $152:ws_web_site_sk, $153:ws_promo_sk, $154:ws_order_number, $155:ws_ext_sales_price, $156:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162, $163", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$170", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $550", "$330 := SUM($551)", "$331 := SUM($360)", "$332 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := coalesce($553, NUMERIC<...>)", "$361 := subtract($552, coalesce($554, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$550 := $540, $551 := $542, $552 := $543, $553 := $544, $554 := $545", "INNER HASH JOIN EACH WITH ALL ON $541 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $536, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535", "INNER HASH JOIN EACH WITH ALL ON $530 = $80" ] }, { "kind": "JOIN", "substeps": [ "$530 := $520, $531 := $522, $532 := $523, $533 := $524, $534 := $525, $535 := $526, $536 := $71", "INNER HASH JOIN EACH WITH ALL ON $521 = $70" ] }, { "kind": "JOIN", "substeps": [ "$520 := $511, $521 := $512, $522 := $513, $523 := $514, $524 := $515, $525 := $516, $526 := $517", "INNER HASH JOIN EACH WITH ALL ON $510 = $170" ] }, { "kind": "JOIN", "substeps": [ "$510 := $150, $511 := $151, $512 := $152, $513 := $153, $514 := $155, $515 := $156, $516 := $162, $517 := $163", "LEFT OUTER HASH JOIN EACH WITH ALL ON $151 = $160, $154 = $161" ] }, { "kind": "WRITE", "substeps": [ "$560, $330, $331, $332", "TO __stage0F_output", "BY HASH($560)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.010011123470522803, "writeRatioMax": 0.010011123470522803 }, { "completedParallelInputs": "5", "computeMsAvg": "455", "computeMsMax": "583", "computeRatioAvg": 0.5061179087875417, "computeRatioMax": 0.6484983314794216, "endMs": "1665778649241", "id": "16", "inputStages": [ "9", "7", "8", "5", "6" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "29", "readMsMax": "36", "readRatioAvg": 0.03225806451612903, "readRatioMax": 0.04004449388209121, "recordsRead": "2227373", "recordsWritten": "1091", "shuffleOutputBytes": "78552", "shuffleOutputBytesSpilled": "0", "slotMs": "2281", "startMs": "1665778648822", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_catalog_page_sk, $122:cs_item_sk, $123:cs_promo_sk, $124:cs_order_number, $125:cs_ext_sales_price, $126:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$320 := SUM($481)", "$321 := SUM($350)", "$322 := SUM($351)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($483, NUMERIC<...>)", "$351 := subtract($482, coalesce($484, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$480 := $470, $481 := $472, $482 := $473, $483 := $474, $484 := $475", "INNER HASH JOIN EACH WITH ALL ON $471 = $10" ] }, { "kind": "JOIN", "substeps": [ "$470 := $466, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465", "INNER HASH JOIN EACH WITH ALL ON $460 = $60" ] }, { "kind": "JOIN", "substeps": [ "$460 := $451, $461 := $452, $462 := $453, $463 := $454, $464 := $455, $465 := $456, $466 := $51", "INNER HASH JOIN EACH WITH ALL ON $450 = $50" ] }, { "kind": "JOIN", "substeps": [ "$450 := $441, $451 := $442, $452 := $443, $453 := $444, $454 := $445, $455 := $446, $456 := $447", "INNER HASH JOIN EACH WITH ALL ON $440 = $140" ] }, { "kind": "JOIN", "substeps": [ "$440 := $120, $441 := $121, $442 := $122, $443 := $123, $444 := $125, $445 := $126, $446 := $132, $447 := $133", "LEFT OUTER HASH JOIN EACH WITH ALL ON $122 = $130, $124 = $131" ] }, { "kind": "WRITE", "substeps": [ "$490, $320, $321, $322", "TO __stage10_output", "BY HASH($490)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.002224694104560623, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.006674082313681869, "writeRatioMax": 0.00778642936596218 }, { "completedParallelInputs": "6", "computeMsAvg": "676", "computeMsMax": "818", "computeRatioAvg": 0.7519466073414905, "computeRatioMax": 0.9098998887652948, "endMs": "1665778649502", "id": "17", "inputStages": [ "13", "12", "11", "10", "14" ], "name": "S11: Join+", "parallelInputs": "6", "readMsAvg": "27", "readMsMax": "31", "readRatioAvg": 0.030033370411568408, "readRatioMax": 0.034482758620689655, "recordsRead": "4613840", "recordsWritten": "36", "shuffleOutputBytes": "2592", "shuffleOutputBytesSpilled": "0", "slotMs": "3632", "startMs": "1665778648948", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_store_sk, $93:ss_promo_sk, $94:ss_ticket_number, $95:ss_ext_sales_price, $96:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $420 := $410", "$310 := SUM($411)", "$311 := SUM($340)", "$312 := SUM($341)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($413, NUMERIC<...>)", "$341 := subtract($412, coalesce($414, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$410 := $400, $411 := $402, $412 := $403, $413 := $404, $414 := $405", "INNER HASH JOIN EACH WITH ALL ON $401 = $1" ] }, { "kind": "JOIN", "substeps": [ "$400 := $396, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395", "INNER HASH JOIN EACH WITH ALL ON $390 = $40" ] }, { "kind": "JOIN", "substeps": [ "$390 := $380, $391 := $382, $392 := $383, $393 := $384, $394 := $385, $395 := $386, $396 := $31", "INNER HASH JOIN EACH WITH ALL ON $381 = $30" ] }, { "kind": "JOIN", "substeps": [ "$380 := $371, $381 := $372, $382 := $373, $383 := $374, $384 := $375, $385 := $376, $386 := $377", "INNER HASH JOIN EACH WITH ALL ON $370 = $110" ] }, { "kind": "JOIN", "substeps": [ "$370 := $90, $371 := $91, $372 := $92, $373 := $93, $374 := $95, $375 := $96, $376 := $102, $377 := $103", "LEFT OUTER HASH JOIN EACH WITH ALL ON $91 = $100, $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$420, $310, $311, $312", "TO __stage11_output", "BY HASH($420)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.002224694104560623, "writeMsAvg": "6", "writeMsMax": "13", "writeRatioAvg": 0.006674082313681869, "writeRatioMax": 0.014460511679644048 }, { "completedParallelInputs": "3", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013348164627363738, "computeRatioMax": 0.013348164627363738, "endMs": "1665778649561", "id": "18", "inputStages": [ "16", "17", "15" ], "name": "S12: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1142", "recordsWritten": "431", "shuffleOutputBytes": "48274", "shuffleOutputBytesSpilled": "0", "slotMs": "111", "startMs": "1665778649524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $310, $311, $312", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$490, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$560, $330, $331, $332", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $580 := $200, $581 := $201, $582 := $220", "$190 := SUM($232)", "$191 := SUM($233)", "$192 := SUM($234)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal(bitwise_and($240, 1), 0), NULL, $230)", "$201 := if(equal(bitwise_and($240, 2), 0), NULL, $231)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'store channel'", "$251 := concat('store', $430)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $430 := $420", "$280 := SUM($310)", "$281 := SUM($311)", "$282 := SUM($312)" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := 'catalog channel'", "$261 := concat('catalog_page', $500)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $490", "$290 := SUM($320)", "$291 := SUM($321)", "$292 := SUM($322)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := 'web channel'", "$271 := concat('web_site', $570)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($330)", "$301 := SUM($331)", "$302 := SUM($332)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($241, 1)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $580, $581, $582", "TO __stage12_output", "BY HASH($580, $581, $582)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "15", "writeMsMax": "16", "writeRatioAvg": 0.01668520578420467, "writeRatioMax": 0.017797552836484983 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012235817575083427, "computeRatioMax": 0.012235817575083427, "endMs": "1665778649607", "id": "19", "inputStages": [ "18" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "431", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778649571", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $580, $581, $582", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$590 ASC, $591 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $590 := $580, $591 := $581, $592 := $582", "$180 := SUM($190)", "$181 := SUM($191)", "$182 := SUM($192)" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011123470522803114, "waitRatioMax": 0.0011123470522803114, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01557285873192436, "writeRatioMax": 0.01557285873192436 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.008898776418242492, "computeRatioMax": 0.008898776418242492, "endMs": "1665778649615", "id": "20", "inputStages": [ "19" ], "name": "S14: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "10317", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778649586", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$603 ASC, $604 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$610, $611, $612, $613, $614", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002224694104560623, "waitRatioMax": 0.002224694104560623, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.006674082313681869, "writeRatioMax": 0.006674082313681869 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "12", "completedUnits": "15", "elapsedMs": "695", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "1123" }, { "activeUnits": "0", "completedUnits": "32", "elapsedMs": "1354", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7867" } ], "totalBytesBilled": "381681664", "totalBytesProcessed": "380948994", "totalPartitionsProcessed": "0", "totalSlotMs": "7867", "transferredBytes": "0" }, "startTime": "1665778648308", "totalBytesProcessed": "380948994", "totalSlotMs": "7867" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
