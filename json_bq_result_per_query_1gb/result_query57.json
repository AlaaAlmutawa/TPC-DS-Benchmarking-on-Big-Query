{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon305608cc_2900_4b27_8ef7_bc62addb28f4" }, "priority": "INTERACTIVE", "query": "with v1 as(\n select i_category, i_brand,\n cc_name,\n d_year, d_moy,\n sum(cs_sales_price) sum_sales,\n avg(sum(cs_sales_price)) over\n (partition by i_category, i_brand,\n cc_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n cc_name\n order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n cs_sold_date_sk = d_date_sk and\n cc_call_center_sk= cs_call_center_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n cc_name , d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.cc_name\n ,v1.d_year\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1. cc_name = v1_lag. cc_name and\n v1. cc_name = v1_lead. cc_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and\n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by cc_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "q6XQx+B+fhX+aK6FLlNB0w==", "id": "test-project-364309:europe-west1.query57_1665768394", "jobReference": { "jobId": "query57_1665768394", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query57_1665768394?location=europe-west1", "statistics": { "creationTime": "1665768394848", "endTime": "1665768396544", "finalExecutionDurationMs": "1408", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "59801163", "performanceInsights": { "avgPreviousExecutionMs": "1162" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.024128686327077747, "computeRatioMax": 0.024128686327077747, "endMs": "1665768395072", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013404825737265416, "readRatioMax": 0.013404825737265416, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768395029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:cc_call_center_sk, $81:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04825737265415549, "writeRatioMax": 0.04825737265415549 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.06166219839142091, "computeRatioMax": 0.06166219839142091, "endMs": "1665768395092", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01876675603217158, "readRatioMax": 0.01876675603217158, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768395045", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03485254691689008, "writeRatioMax": 0.03485254691689008 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.06702412868632708, "computeRatioMax": 0.06702412868632708, "endMs": "1665768395146", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013404825737265416, "readRatioMax": 0.013404825737265416, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768395089", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.064343163538874, "writeRatioMax": 0.064343163538874 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.021447721179624665, "computeRatioMax": 0.021447721179624665, "endMs": "1665768395149", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00804289544235925, "readRatioMax": 0.00804289544235925, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768395112", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cc_call_center_sk, $11:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.040214477211796246, "writeRatioMax": 0.040214477211796246 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.08042895442359249, "computeRatioMax": 0.08042895442359249, "endMs": "1665768395187", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.05630026809651475, "readRatioMax": 0.05630026809651475, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665768395130", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.040214477211796246, "writeRatioMax": 0.040214477211796246 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.05093833780160858, "computeRatioMax": 0.05093833780160858, "endMs": "1665768395239", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013404825737265416, "readRatioMax": 0.013404825737265416, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768395183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07238605898123325, "writeRatioMax": 0.07238605898123325 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.013404825737265416, "computeRatioMax": 0.013404825737265416, "endMs": "1665768395245", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00804289544235925, "readRatioMax": 0.00804289544235925, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768395210", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cc_call_center_sk, $2:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03753351206434316, "writeRatioMax": 0.03753351206434316 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04825737265415549, "computeRatioMax": 0.04825737265415549, "endMs": "1665768395269", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01876675603217158, "readRatioMax": 0.01876675603217158, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768395227", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.029490616621983913, "writeRatioMax": 0.029490616621983913 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.045576407506702415, "computeRatioMax": 0.045576407506702415, "endMs": "1665768395312", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01876675603217158, "readRatioMax": 0.01876675603217158, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768395256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.09651474530831099, "writeRatioMax": 0.09651474530831099 }, { "completedParallelInputs": "5", "computeMsAvg": "317", "computeMsMax": "373", "computeRatioAvg": 0.8498659517426274, "computeRatioMax": 1, "endMs": "1665768395516", "id": "12", "inputStages": [ "0", "1", "3" ], "name": "S0C: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.03753351206434316, "readRatioMax": 0.04289544235924933, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1249", "startMs": "1665768395262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $741, $751 := $740, $752 := $745, $753 := $743, $754 := $744", "$620 := SUM($742)" ] }, { "kind": "JOIN", "substeps": [ "$740 := $730, $741 := $731, $742 := $733, $743 := $734, $744 := $735, $745 := $81", "INNER HASH JOIN EACH WITH ALL ON $732 = $80" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $713, $733 := $714, $734 := $111, $735 := $112", "INNER HASH JOIN EACH WITH ALL ON $712 = $110" ] }, { "kind": "JOIN", "substeps": [ "$712 := $100, $713 := $101, $714 := $103, $710 := $91, $711 := $92", "INNER HASH JOIN EACH WITH ALL ON $102 = $90" ] }, { "kind": "WRITE", "substeps": [ "$752, $751, $750, $753, $754, $620", "TO __stage0C_output", "BY HASH($750, $751, $752, $753, $754)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005361930294906166, "waitRatioMax": 0.005361930294906166, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.0160857908847185, "writeRatioMax": 0.021447721179624665 }, { "completedParallelInputs": "5", "computeMsAvg": "296", "computeMsMax": "371", "computeRatioAvg": 0.7935656836461126, "computeRatioMax": 0.9946380697050938, "endMs": "1665768395546", "id": "13", "inputStages": [ "7", "5", "4" ], "name": "S0D: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "23", "readRatioAvg": 0.04289544235924933, "readRatioMax": 0.06166219839142091, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1506", "startMs": "1665768395290", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $951, $961 := $950, $962 := $955, $963 := $953, $964 := $954", "$460 := SUM($952)" ] }, { "kind": "JOIN", "substeps": [ "$950 := $940, $951 := $941, $952 := $943, $953 := $944, $954 := $945, $955 := $11", "INNER HASH JOIN EACH WITH ALL ON $942 = $10" ] }, { "kind": "JOIN", "substeps": [ "$940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $71, $945 := $72", "INNER HASH JOIN EACH WITH ALL ON $922 = $70" ] }, { "kind": "JOIN", "substeps": [ "$922 := $60, $923 := $61, $924 := $63, $920 := $51, $921 := $52", "INNER HASH JOIN EACH WITH ALL ON $62 = $50" ] }, { "kind": "WRITE", "substeps": [ "$962, $961, $960, $963, $964, $460", "TO __stage0D_output", "BY HASH($960, $961, $962, $963, $964)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.005361930294906166, "writeMsAvg": "22", "writeMsMax": "25", "writeRatioAvg": 0.058981233243967826, "writeRatioMax": 0.06702412868632708 }, { "completedParallelInputs": "5", "computeMsAvg": "258", "computeMsMax": "313", "computeRatioAvg": 0.6916890080428955, "computeRatioMax": 0.839142091152815, "endMs": "1665768395535", "id": "14", "inputStages": [ "9", "8", "11" ], "name": "S0E: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.03753351206434316, "readRatioMax": 0.05093833780160858, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1141", "startMs": "1665768395337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1111, $1121 := $1110, $1122 := $1115, $1123 := $1113, $1124 := $1114", "$360 := SUM($1112)" ] }, { "kind": "JOIN", "substeps": [ "$1110 := $1100, $1111 := $1101, $1112 := $1103, $1113 := $1104, $1114 := $1105, $1115 := $2", "INNER HASH JOIN EACH WITH ALL ON $1102 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1080, $1101 := $1081, $1102 := $1083, $1103 := $1084, $1104 := $41, $1105 := $42", "INNER HASH JOIN EACH WITH ALL ON $1082 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1082 := $30, $1083 := $31, $1084 := $33, $1080 := $21, $1081 := $22", "INNER HASH JOIN EACH WITH ALL ON $32 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "TO __stage0E_output", "BY HASH($1120, $1121, $1122, $1123, $1124)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "20", "writeMsMax": "22", "writeRatioAvg": 0.05361930294906166, "writeRatioMax": 0.058981233243967826 }, { "completedParallelInputs": "1", "computeMsAvg": "143", "computeMsMax": "143", "computeRatioAvg": 0.38337801608579086, "computeRatioMax": 0.38337801608579086, "endMs": "1665768395642", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "138", "startMs": "1665768395535", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$752, $751, $750, $753, $754, $620", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $760 := $750, $761 := $751, $762 := $752, $763 := $753, $764 := $754", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$762, $761, $760, $763, $764, $510", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04825737265415549, "writeRatioMax": 0.04825737265415549 }, { "completedParallelInputs": "1", "computeMsAvg": "176", "computeMsMax": "176", "computeRatioAvg": 0.4718498659517426, "computeRatioMax": 0.4718498659517426, "endMs": "1665768395676", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "164", "startMs": "1665768395551", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124", "$230 := SUM($360)" ] }, { "kind": "WRITE", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.06702412868632708, "writeRatioMax": 0.06702412868632708 }, { "completedParallelInputs": "1", "computeMsAvg": "149", "computeMsMax": "149", "computeRatioAvg": 0.39946380697050937, "computeRatioMax": 0.39946380697050937, "endMs": "1665768395686", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "156", "startMs": "1665768395570", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$962, $961, $960, $963, $964, $460", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960, $971 := $961, $972 := $962, $973 := $963, $974 := $964", "$260 := SUM($460)" ] }, { "kind": "WRITE", "substeps": [ "$972, $971, $970, $973, $974, $260", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.05630026809651475, "writeRatioMax": 0.05630026809651475 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02680965147453083, "computeRatioMax": 0.02680965147453083, "endMs": "1665768395748", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665768395671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $800, $801, $802, $803", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($810, '')", "$561 := coalesce($810, '0')", "$562 := coalesce($811, 0)", "$563 := coalesce($811, 1)", "$564 := coalesce($812, '')", "$565 := coalesce($812, '0')", "$566 := coalesce($813, '')", "$567 := coalesce($813, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800, $811 := $801, $812 := $802, $813 := $803", "$660 := ROOT_AVG($690)" ] }, { "kind": "WRITE", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "70", "writeMsMax": "70", "writeRatioAvg": 0.1876675603217158, "writeRatioMax": 0.1876675603217158 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.021447721179624665, "computeRatioMax": 0.03753351206434316, "endMs": "1665768395816", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3530", "startMs": "1665768395758", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005361930294906166, "waitRatioMax": 0.00804289544235925, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.04289544235924933, "writeRatioMax": 0.07506702412868632 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "29", "computeRatioAvg": 0.032171581769437, "computeRatioMax": 0.0777479892761394, "endMs": "1665768395840", "id": "21", "inputStages": [ "20", "15" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32775", "shuffleOutputBytes": "3310098", "shuffleOutputBytesSpilled": "0", "slotMs": "4638", "startMs": "1665768395773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$762, $761, $760, $763, $764, $510", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$640, $641, $642, $643, $644, $645", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$410 := AVG($775) OVER (PARTITION BY $774, $773, $770, $771 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$634 ASC, $633 ASC, $630 ASC, $631 ASC" ] }, { "kind": "JOIN", "substeps": [ "$820 := $650, $821 := $651, $822 := $652, $823 := $653, $824 := $654, $825 := $655, $826 := $660", "INNER HASH JOIN EACH WITH ALL ON $550 = $560, $551 = $561, $552 = $562, $553 = $563, $554 = $564, $555 = $565, $556 = $566, $557 = $567" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := coalesce($650, '')", "$551 := coalesce($650, '0')", "$552 := coalesce($651, 0)", "$553 := coalesce($651, 1)", "$554 := coalesce($653, '')", "$555 := coalesce($653, '0')", "$556 := coalesce($654, '')", "$557 := coalesce($654, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.005361930294906166, "waitRatioMax": 0.013404825737265416, "writeMsAvg": "27", "writeMsMax": "44", "writeRatioAvg": 0.07238605898123325, "writeRatioMax": 0.11796246648793565 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.013404825737265416, "computeRatioMax": 0.013404825737265416, "endMs": "1665768396008", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768395973", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $1170, $1171, $1172, $1173, $1174, $1175", "FROM __SHUFFLE16" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := coalesce($394, '')", "$281 := coalesce($394, '0')", "$282 := coalesce($393, '')", "$283 := coalesce($393, '0')", "$284 := coalesce($390, '')", "$285 := coalesce($390, '0')", "$286 := coalesce($391, 0)", "$287 := coalesce($391, 1)", "$288 := coalesce($392, 0)", "$289 := coalesce($392, 1)" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287, $288, $289, $390, $393, $394, $395", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.05093833780160858, "writeRatioMax": 0.05093833780160858 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03485254691689008, "computeRatioMax": 0.03485254691689008, "endMs": "1665768396041", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768395989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1042, $1043, $1044, $1041, $1040", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($1050, '')", "$351 := coalesce($1050, '0')", "$352 := coalesce($1051, '')", "$353 := coalesce($1051, '0')", "$354 := coalesce($1052, '')", "$355 := coalesce($1052, '0')", "$356 := coalesce($1053, 0)", "$357 := coalesce($1053, 1)", "$358 := coalesce($1054, 0)", "$359 := coalesce($1054, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044", "$500 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.002680965147453083, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.08847184986595175, "writeRatioMax": 0.08847184986595175 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.021447721179624665, "computeRatioMax": 0.021447721179624665, "endMs": "1665768396095", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768396031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $892, $893, $894, $891, $890", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := coalesce($900, '')", "$331 := coalesce($900, '0')", "$332 := coalesce($901, '')", "$333 := coalesce($901, '0')", "$334 := coalesce($902, '')", "$335 := coalesce($902, '0')", "$336 := coalesce($903, 0)", "$337 := coalesce($903, 1)", "$338 := coalesce($904, 0)", "$339 := coalesce($904, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891, $902 := $892, $903 := $893, $904 := $894", "$450 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005361930294906166, "waitRatioMax": 0.005361930294906166, "writeMsAvg": "59", "writeMsMax": "59", "writeRatioAvg": 0.1581769436997319, "writeRatioMax": 0.1581769436997319 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.024128686327077747, "computeRatioMax": 0.04825737265415549, "endMs": "1665768396152", "id": "28", "inputStages": [ "23" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "6281", "startMs": "1665768396050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage17_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.00804289544235925, "waitRatioMax": 0.013404825737265416, "writeMsAvg": "59", "writeMsMax": "74", "writeRatioAvg": 0.1581769436997319, "writeRatioMax": 0.19839142091152814 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "22", "computeRatioAvg": 0.032171581769437, "computeRatioMax": 0.058981233243967826, "endMs": "1665768396157", "id": "29", "inputStages": [ "28", "16" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "5449", "startMs": "1665768396076", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$540, $1202, $1203, $1204, $1201, $1200", "FROM __SHUFFLE17" ] }, { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287, $288, $289, $390, $393, $394, $395", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($153, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$200 := RANK() OVER (PARTITION BY $1144, $1143, $1140 ORDER BY $1141 ASC, $1142 ASC)" ] }, { "kind": "SORT", "substeps": [ "$374 ASC, $373 ASC, $370 ASC, $371 ASC, $372 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1224 := $400, $1220 := $390, $1221 := $393, $1222 := $394, $1223 := $395", "INNER HASH JOIN EACH WITH ALL ON $290 = $280, $291 = $281, $292 = $282, $293 = $283, $294 = $284, $295 = $285, $296 = $286, $297 = $287, $298 = $288, $299 = $289" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($1210, '')", "$291 := coalesce($1210, '0')", "$292 := coalesce($1211, '')", "$293 := coalesce($1211, '0')", "$294 := coalesce($1212, '')", "$295 := coalesce($1212, '0')", "$296 := coalesce($1213, 0)", "$297 := coalesce($1213, 1)", "$298 := coalesce($1214, 0)", "$299 := coalesce($1214, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204", "$400 := MIN($540)" ] }, { "kind": "WRITE", "substeps": [ "$120, $150, $151, $152, $154", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "7", "waitRatioAvg": 0.002680965147453083, "waitRatioMax": 0.01876675603217158, "writeMsAvg": "40", "writeMsMax": "56", "writeRatioAvg": 0.10723860589812333, "writeRatioMax": 0.15013404825737264 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "21", "computeRatioAvg": 0.02680965147453083, "computeRatioMax": 0.05630026809651475, "endMs": "1665768396168", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4981", "startMs": "1665768396077", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.0160857908847185, "waitRatioMax": 0.021447721179624665, "writeMsAvg": "28", "writeMsMax": "54", "writeRatioAvg": 0.07506702412868632, "writeRatioMax": 0.1447721179624665 }, { "completedParallelInputs": "101", "computeMsAvg": "13", "computeMsMax": "22", "computeRatioAvg": 0.03485254691689008, "computeRatioMax": 0.058981233243967826, "endMs": "1665768396172", "id": "31", "inputStages": [ "30", "17" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3599", "startMs": "1665768396108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$972, $971, $970, $973, $974, $260", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$480, $1010, $1011, $1012, $1013, $1014, $1015", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := add($193, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $984, $983, $980 ORDER BY $981 ASC, $982 ASC)" ] }, { "kind": "SORT", "substeps": [ "$474 ASC, $473 ASC, $470 ASC, $471 ASC, $472 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $490, $1061 := $493, $1062 := $494, $1063 := $495, $1064 := $500", "INNER HASH JOIN EACH WITH ALL ON $340 = $350, $341 = $351, $342 = $352, $343 = $353, $344 = $354, $345 = $355, $346 = $356, $347 = $357, $348 = $358, $349 = $359" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($494, '')", "$341 := coalesce($494, '0')", "$342 := coalesce($493, '')", "$343 := coalesce($493, '0')", "$344 := coalesce($490, '')", "$345 := coalesce($490, '0')", "$346 := coalesce($491, 0)", "$347 := coalesce($491, 1)", "$348 := coalesce($492, 0)", "$349 := coalesce($492, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $190, $191, $192, $194", "TO __stage1F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.00804289544235925, "waitRatioMax": 0.013404825737265416, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.03753351206434316, "writeRatioMax": 0.0777479892761394 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.01876675603217158, "computeRatioMax": 0.03753351206434316, "endMs": "1665768396175", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3789", "startMs": "1665768396114", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005361930294906166, "waitRatioMax": 0.010723860589812333, "writeMsAvg": "28", "writeMsMax": "46", "writeRatioAvg": 0.07506702412868632, "writeRatioMax": 0.12332439678284182 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "16", "computeRatioAvg": 0.02680965147453083, "computeRatioMax": 0.04289544235924933, "endMs": "1665768396244", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4115", "startMs": "1665768396177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "11", "waitRatioAvg": 0.005361930294906166, "waitRatioMax": 0.029490616621983913, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.040214477211796246, "writeRatioMax": 0.07506702412868632 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.021447721179624665, "computeRatioMax": 0.04289544235924933, "endMs": "1665768396241", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "2954", "startMs": "1665768396178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "12", "waitMsMax": "13", "waitRatioAvg": 0.032171581769437, "waitRatioMax": 0.03485254691689008, "writeMsAvg": "5", "writeMsMax": "19", "writeRatioAvg": 0.013404825737265416, "writeRatioMax": 0.05093833780160858 }, { "completedParallelInputs": "101", "computeMsAvg": "75", "computeMsMax": "137", "computeRatioAvg": 0.20107238605898123, "computeRatioMax": 0.3672922252010724, "endMs": "1665768396341", "id": "36", "inputStages": [ "35", "21", "32", "34" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6469575", "recordsWritten": "10000", "shuffleOutputBytes": "1267356", "shuffleOutputBytesSpilled": "0", "slotMs": "11542", "startMs": "1665768396192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$430, $860, $861, $862, $863, $864, $865, $866", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$130, $190, $191, $192, $194", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$120, $150, $151, $152, $154", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$1230 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1070, $1231 := $1071, $1232 := $1072, $1233 := $1073, $1234 := $1075, $1235 := $1076, $1236 := $1077, $1237 := $154", "INNER HASH JOIN EACH WITH ALL ON $1073 = $152, $1072 = $151, $1070 = $150, $1074 = $120" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $170, $1071 := $171, $1072 := $172, $1073 := $173, $1074 := $174, $1075 := $175, $1076 := $176, $1077 := $194", "INNER HASH JOIN EACH WITH ALL ON $173 = $192, $172 = $191, $170 = $190, $174 = $130" ] }, { "kind": "FILTER", "substeps": [ "and(equal($171, 1999), greater($175, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $834, $833, $830 ORDER BY $831 ASC, $832 ASC)" ] }, { "kind": "SORT", "substeps": [ "$424 ASC, $423 ASC, $420 ASC, $421 ASC, $422 ASC" ] }, { "kind": "JOIN", "substeps": [ "$910 := $440, $911 := $441, $912 := $443, $913 := $444, $914 := $445, $915 := $446, $916 := $450", "INNER HASH JOIN EACH WITH ALL ON $320 = $330, $321 = $331, $322 = $332, $323 = $333, $324 = $334, $325 = $335, $326 = $336, $327 = $337, $328 = $338, $329 = $339" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := coalesce($444, '')", "$321 := coalesce($444, '0')", "$322 := coalesce($443, '')", "$323 := coalesce($443, '0')", "$324 := coalesce($440, '')", "$325 := coalesce($440, '0')", "$326 := coalesce($441, 0)", "$327 := coalesce($441, 1)", "$328 := coalesce($442, 0)", "$329 := coalesce($442, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "TO __stage24_output" ] } ], "waitMsAvg": "13", "waitMsMax": "14", "waitRatioAvg": 0.03485254691689008, "waitRatioMax": 0.03753351206434316, "writeMsAvg": "4", "writeMsMax": "54", "writeRatioAvg": 0.010723860589812333, "writeRatioMax": 0.1447721179624665 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03485254691689008, "computeRatioMax": 0.03485254691689008, "endMs": "1665768396359", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "12748", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665768396202", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1241 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1250, $1251, $1252, $1253, $1254, $1255, $1256, $1257", "TO __stage25_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.0160857908847185, "waitRatioMax": 0.0160857908847185, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.013404825737265416, "writeRatioMax": 0.013404825737265416 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "8", "completedUnits": "20", "elapsedMs": "632", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "4195" }, { "activeUnits": "3", "completedUnits": "1036", "elapsedMs": "1588", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "59634" } ], "totalBytesBilled": "60817408", "totalBytesProcessed": "59801163", "totalPartitionsProcessed": "0", "totalSlotMs": "59634", "transferredBytes": "0" }, "startTime": "1665768394899", "totalBytesProcessed": "59801163", "totalSlotMs": "59634" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc111065c_c695_4d02_9f88_e8676f9f2dfd" }, "priority": "INTERACTIVE", "query": "with v1 as(\n select i_category, i_brand,\n cc_name,\n d_year, d_moy,\n sum(cs_sales_price) sum_sales,\n avg(sum(cs_sales_price)) over\n (partition by i_category, i_brand,\n cc_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n cc_name\n order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n cs_sold_date_sk = d_date_sk and\n cc_call_center_sk= cs_call_center_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n cc_name , d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.cc_name\n ,v1.d_year\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1. cc_name = v1_lag. cc_name and\n v1. cc_name = v1_lead. cc_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and\n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by cc_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "5MLrQFAgihKx6dC5IUSDMA==", "id": "test-project-364309:europe-west1.query57_1665777819", "jobReference": { "jobId": "query57_1665777819", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query57_1665777819?location=europe-west1", "statistics": { "creationTime": "1665777819992", "endTime": "1665777821442", "finalExecutionDurationMs": "1156", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "59801163", "performanceInsights": { "avgPreviousExecutionMs": "1244" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.016293279022403257, "endMs": "1665777820230", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008146639511201629, "readRatioMax": 0.008146639511201629, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777820192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:cc_call_center_sk, $81:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.03054989816700611 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.03665987780040733, "computeRatioMax": 0.03665987780040733, "endMs": "1665777820244", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.020366598778004074, "readRatioMax": 0.020366598778004074, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777820212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.016293279022403257, "writeRatioMax": 0.016293279022403257 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.038696537678207736, "computeRatioMax": 0.038696537678207736, "endMs": "1665777820292", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.016293279022403257, "readRatioMax": 0.016293279022403257, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777820244", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.010183299389002037, "waitRatioMax": 0.010183299389002037, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.054989816700611, "writeRatioMax": 0.054989816700611 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02240325865580448, "computeRatioMax": 0.02240325865580448, "endMs": "1665777820329", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014256619144602852, "readRatioMax": 0.014256619144602852, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777820292", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cc_call_center_sk, $11:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage04_output" ] } ], "waitMsAvg": "38", "waitMsMax": "38", "waitRatioAvg": 0.07739307535641547, "waitRatioMax": 0.07739307535641547, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.016293279022403257, "writeRatioMax": 0.016293279022403257 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.04073319755600815, "computeRatioMax": 0.04073319755600815, "endMs": "1665777820353", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012219959266802444, "readRatioMax": 0.012219959266802444, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777820304", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "34", "waitMsMax": "34", "waitRatioAvg": 0.06924643584521385, "waitRatioMax": 0.06924643584521385, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.03054989816700611 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.034623217922606926, "computeRatioMax": 0.034623217922606926, "endMs": "1665777820358", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012219959266802444, "readRatioMax": 0.012219959266802444, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777820303", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.016293279022403257, "waitRatioMax": 0.016293279022403257, "writeMsAvg": "38", "writeMsMax": "38", "writeRatioAvg": 0.07739307535641547, "writeRatioMax": 0.07739307535641547 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.020366598778004074, "computeRatioMax": 0.020366598778004074, "endMs": "1665777820372", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012219959266802444, "readRatioMax": 0.012219959266802444, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777820330", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cc_call_center_sk, $2:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.018329938900203666, "waitRatioMax": 0.018329938900203666, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.034623217922606926, "writeRatioMax": 0.034623217922606926 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.034623217922606926, "computeRatioMax": 0.034623217922606926, "endMs": "1665777820379", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014256619144602852, "readRatioMax": 0.014256619144602852, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777820339", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006109979633401222, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.016293279022403257, "writeRatioMax": 0.016293279022403257 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.04684317718940937, "computeRatioMax": 0.04684317718940937, "endMs": "1665777820427", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008146639511201629, "readRatioMax": 0.008146639511201629, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777820371", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.05091649694501019, "writeRatioMax": 0.05091649694501019 }, { "completedParallelInputs": "5", "computeMsAvg": "235", "computeMsMax": "316", "computeRatioAvg": 0.4786150712830957, "computeRatioMax": 0.6435845213849287, "endMs": "1665777820583", "id": "12", "inputStages": [ "1", "0", "3" ], "name": "S0C: Join+", "parallelInputs": "5", "readMsAvg": "17", "readMsMax": "21", "readRatioAvg": 0.034623217922606926, "readRatioMax": 0.04276985743380855, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1146", "startMs": "1665777820379", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $741, $751 := $740, $752 := $745, $753 := $743, $754 := $744", "$620 := SUM($742)" ] }, { "kind": "JOIN", "substeps": [ "$740 := $730, $741 := $731, $742 := $733, $743 := $734, $744 := $735, $745 := $81", "INNER HASH JOIN EACH WITH ALL ON $732 = $80" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $713, $733 := $714, $734 := $111, $735 := $112", "INNER HASH JOIN EACH WITH ALL ON $712 = $110" ] }, { "kind": "JOIN", "substeps": [ "$712 := $100, $713 := $101, $714 := $103, $710 := $91, $711 := $92", "INNER HASH JOIN EACH WITH ALL ON $102 = $90" ] }, { "kind": "WRITE", "substeps": [ "$752, $751, $750, $753, $754, $620", "TO __stage0C_output", "BY HASH($750, $751, $752, $753, $754)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.012219959266802444, "writeRatioMax": 0.014256619144602852 }, { "completedParallelInputs": "5", "computeMsAvg": "305", "computeMsMax": "491", "computeRatioAvg": 0.6211812627291242, "computeRatioMax": 1, "endMs": "1665777820735", "id": "13", "inputStages": [ "7", "5", "4" ], "name": "S0D: Join+", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "14", "readRatioAvg": 0.026476578411405296, "readRatioMax": 0.028513238289205704, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1560", "startMs": "1665777820398", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $951, $961 := $950, $962 := $955, $963 := $953, $964 := $954", "$460 := SUM($952)" ] }, { "kind": "JOIN", "substeps": [ "$950 := $940, $951 := $941, $952 := $943, $953 := $944, $954 := $945, $955 := $11", "INNER HASH JOIN EACH WITH ALL ON $942 = $10" ] }, { "kind": "JOIN", "substeps": [ "$940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $71, $945 := $72", "INNER HASH JOIN EACH WITH ALL ON $922 = $70" ] }, { "kind": "JOIN", "substeps": [ "$922 := $60, $923 := $61, $924 := $63, $920 := $51, $921 := $52", "INNER HASH JOIN EACH WITH ALL ON $62 = $50" ] }, { "kind": "WRITE", "substeps": [ "$962, $961, $960, $963, $964, $460", "TO __stage0D_output", "BY HASH($960, $961, $962, $963, $964)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "20", "writeMsMax": "21", "writeRatioAvg": 0.04073319755600815, "writeRatioMax": 0.04276985743380855 }, { "completedParallelInputs": "5", "computeMsAvg": "239", "computeMsMax": "280", "computeRatioAvg": 0.48676171079429736, "computeRatioMax": 0.570264765784114, "endMs": "1665777820665", "id": "14", "inputStages": [ "11", "8", "9" ], "name": "S0E: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "21", "readRatioAvg": 0.032586558044806514, "readRatioMax": 0.04276985743380855, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1333", "startMs": "1665777820452", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1111, $1121 := $1110, $1122 := $1115, $1123 := $1113, $1124 := $1114", "$360 := SUM($1112)" ] }, { "kind": "JOIN", "substeps": [ "$1110 := $1100, $1111 := $1101, $1112 := $1103, $1113 := $1104, $1114 := $1105, $1115 := $2", "INNER HASH JOIN EACH WITH ALL ON $1102 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1080, $1101 := $1081, $1102 := $1083, $1103 := $1084, $1104 := $41, $1105 := $42", "INNER HASH JOIN EACH WITH ALL ON $1082 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1082 := $30, $1083 := $31, $1084 := $33, $1080 := $21, $1081 := $22", "INNER HASH JOIN EACH WITH ALL ON $32 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "TO __stage0E_output", "BY HASH($1120, $1121, $1122, $1123, $1124)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "21", "writeMsMax": "22", "writeRatioAvg": 0.04276985743380855, "writeRatioMax": 0.04480651731160896 }, { "completedParallelInputs": "1", "computeMsAvg": "236", "computeMsMax": "236", "computeRatioAvg": 0.48065173116089616, "computeRatioMax": 0.48065173116089616, "endMs": "1665777820747", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "241", "startMs": "1665777820607", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$752, $751, $750, $753, $754, $620", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $760 := $750, $761 := $751, $762 := $752, $763 := $753, $764 := $754", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$762, $761, $760, $763, $764, $510", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.04480651731160896, "writeRatioMax": 0.04480651731160896 }, { "completedParallelInputs": "1", "computeMsAvg": "161", "computeMsMax": "161", "computeRatioAvg": 0.32790224032586557, "computeRatioMax": 0.32790224032586557, "endMs": "1665777820794", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "158", "startMs": "1665777820685", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124", "$230 := SUM($360)" ] }, { "kind": "WRITE", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.038696537678207736, "writeRatioMax": 0.038696537678207736 }, { "completedParallelInputs": "1", "computeMsAvg": "120", "computeMsMax": "120", "computeRatioAvg": 0.24439918533604887, "computeRatioMax": 0.24439918533604887, "endMs": "1665777820861", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665777820777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$962, $961, $960, $963, $964, $460", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960, $971 := $961, $972 := $962, $973 := $963, $974 := $964", "$260 := SUM($460)" ] }, { "kind": "WRITE", "substeps": [ "$972, $971, $970, $973, $974, $260", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.03054989816700611 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.016293279022403257, "endMs": "1665777820839", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777820794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $800, $801, $802, $803", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($810, '')", "$561 := coalesce($810, '0')", "$562 := coalesce($811, 0)", "$563 := coalesce($811, 1)", "$564 := coalesce($812, '')", "$565 := coalesce($812, '0')", "$566 := coalesce($813, '')", "$567 := coalesce($813, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800, $811 := $801, $812 := $802, $813 := $803", "$660 := ROOT_AVG($690)" ] }, { "kind": "WRITE", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.05091649694501019, "writeRatioMax": 0.05091649694501019 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.032586558044806514, "endMs": "1665777820895", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3560", "startMs": "1665777820846", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.006109979633401222, "waitRatioMax": 0.010183299389002037, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.05091649694501019 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "31", "computeRatioAvg": 0.024439918533604887, "computeRatioMax": 0.06313645621181263, "endMs": "1665777820920", "id": "21", "inputStages": [ "20", "15" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32775", "shuffleOutputBytes": "3310098", "shuffleOutputBytesSpilled": "0", "slotMs": "4397", "startMs": "1665777820864", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$762, $761, $760, $763, $764, $510", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$640, $641, $642, $643, $644, $645", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$410 := AVG($775) OVER (PARTITION BY $774, $773, $770, $771 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$634 ASC, $633 ASC, $630 ASC, $631 ASC" ] }, { "kind": "JOIN", "substeps": [ "$820 := $650, $821 := $651, $822 := $652, $823 := $653, $824 := $654, $825 := $655, $826 := $660", "INNER HASH JOIN EACH WITH ALL ON $550 = $560, $551 = $561, $552 = $562, $553 = $563, $554 = $564, $555 = $565, $556 = $566, $557 = $567" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := coalesce($650, '')", "$551 := coalesce($650, '0')", "$552 := coalesce($651, 0)", "$553 := coalesce($651, 1)", "$554 := coalesce($653, '')", "$555 := coalesce($653, '0')", "$556 := coalesce($654, '')", "$557 := coalesce($654, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "TO __stage15_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.006109979633401222, "waitRatioMax": 0.008146639511201629, "writeMsAvg": "25", "writeMsMax": "34", "writeRatioAvg": 0.05091649694501019, "writeRatioMax": 0.06924643584521385 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.020366598778004074, "computeRatioMax": 0.020366598778004074, "endMs": "1665777821009", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777820974", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $1170, $1171, $1172, $1173, $1174, $1175", "FROM __SHUFFLE16" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := coalesce($394, '')", "$281 := coalesce($394, '0')", "$282 := coalesce($393, '')", "$283 := coalesce($393, '0')", "$284 := coalesce($390, '')", "$285 := coalesce($390, '0')", "$286 := coalesce($391, 0)", "$287 := coalesce($391, 1)", "$288 := coalesce($392, 0)", "$289 := coalesce($392, 1)" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287, $288, $289, $390, $393, $394, $395", "TO __stage17_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.014256619144602852, "waitRatioMax": 0.014256619144602852, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.034623217922606926, "writeRatioMax": 0.034623217922606926 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.010183299389002037, "computeRatioMax": 0.010183299389002037, "endMs": "1665777821017", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777820984", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1042, $1043, $1044, $1041, $1040", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($1050, '')", "$351 := coalesce($1050, '0')", "$352 := coalesce($1051, '')", "$353 := coalesce($1051, '0')", "$354 := coalesce($1052, '')", "$355 := coalesce($1052, '0')", "$356 := coalesce($1053, 0)", "$357 := coalesce($1053, 1)", "$358 := coalesce($1054, 0)", "$359 := coalesce($1054, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044", "$500 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.032586558044806514, "writeRatioMax": 0.032586558044806514 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.016293279022403257, "endMs": "1665777821076", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777821030", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $892, $893, $894, $891, $890", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := coalesce($900, '')", "$331 := coalesce($900, '0')", "$332 := coalesce($901, '')", "$333 := coalesce($901, '0')", "$334 := coalesce($902, '')", "$335 := coalesce($902, '0')", "$336 := coalesce($903, 0)", "$337 := coalesce($903, 1)", "$338 := coalesce($904, 0)", "$339 := coalesce($904, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891, $902 := $892, $903 := $893, $904 := $894", "$450 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "TO __stage1A_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.012219959266802444, "waitRatioMax": 0.012219959266802444, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.06720977596741344, "writeRatioMax": 0.06720977596741344 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.014256619144602852, "computeRatioMax": 0.026476578411405296, "endMs": "1665777821133", "id": "28", "inputStages": [ "23" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3497", "startMs": "1665777821048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage17_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.008146639511201629, "waitRatioMax": 0.012219959266802444, "writeMsAvg": "15", "writeMsMax": "24", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.048879837067209775 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "23", "computeRatioAvg": 0.024439918533604887, "computeRatioMax": 0.04684317718940937, "endMs": "1665777821152", "id": "29", "inputStages": [ "16", "28" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4437", "startMs": "1665777821062", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$540, $1202, $1203, $1204, $1201, $1200", "FROM __SHUFFLE17" ] }, { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287, $288, $289, $390, $393, $394, $395", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($153, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$200 := RANK() OVER (PARTITION BY $1144, $1143, $1140 ORDER BY $1141 ASC, $1142 ASC)" ] }, { "kind": "SORT", "substeps": [ "$374 ASC, $373 ASC, $370 ASC, $371 ASC, $372 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1224 := $400, $1220 := $390, $1221 := $393, $1222 := $394, $1223 := $395", "INNER HASH JOIN EACH WITH ALL ON $290 = $280, $291 = $281, $292 = $282, $293 = $283, $294 = $284, $295 = $285, $296 = $286, $297 = $287, $298 = $288, $299 = $289" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($1210, '')", "$291 := coalesce($1210, '0')", "$292 := coalesce($1211, '')", "$293 := coalesce($1211, '0')", "$294 := coalesce($1212, '')", "$295 := coalesce($1212, '0')", "$296 := coalesce($1213, 0)", "$297 := coalesce($1213, 1)", "$298 := coalesce($1214, 0)", "$299 := coalesce($1214, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204", "$400 := MIN($540)" ] }, { "kind": "WRITE", "substeps": [ "$120, $150, $151, $152, $154", "TO __stage1D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.006109979633401222, "waitRatioMax": 0.012219959266802444, "writeMsAvg": "18", "writeMsMax": "31", "writeRatioAvg": 0.03665987780040733, "writeRatioMax": 0.06313645621181263 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.034623217922606926, "endMs": "1665777821153", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3864", "startMs": "1665777821065", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.012219959266802444, "waitRatioMax": 0.014256619144602852, "writeMsAvg": "15", "writeMsMax": "33", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.06720977596741344 }, { "completedParallelInputs": "101", "computeMsAvg": "11", "computeMsMax": "23", "computeRatioAvg": 0.02240325865580448, "computeRatioMax": 0.04684317718940937, "endMs": "1665777821153", "id": "31", "inputStages": [ "30", "17" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3510", "startMs": "1665777821080", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$972, $971, $970, $973, $974, $260", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$480, $1010, $1011, $1012, $1013, $1014, $1015", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := add($193, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $984, $983, $980 ORDER BY $981 ASC, $982 ASC)" ] }, { "kind": "SORT", "substeps": [ "$474 ASC, $473 ASC, $470 ASC, $471 ASC, $472 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $490, $1061 := $493, $1062 := $494, $1063 := $495, $1064 := $500", "INNER HASH JOIN EACH WITH ALL ON $340 = $350, $341 = $351, $342 = $352, $343 = $353, $344 = $354, $345 = $355, $346 = $356, $347 = $357, $348 = $358, $349 = $359" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($494, '')", "$341 := coalesce($494, '0')", "$342 := coalesce($493, '')", "$343 := coalesce($493, '0')", "$344 := coalesce($490, '')", "$345 := coalesce($490, '0')", "$346 := coalesce($491, 0)", "$347 := coalesce($491, 1)", "$348 := coalesce($492, 0)", "$349 := coalesce($492, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $190, $191, $192, $194", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.008146639511201629, "writeMsAvg": "12", "writeMsMax": "19", "writeRatioAvg": 0.024439918533604887, "writeRatioMax": 0.038696537678207736 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.03054989816700611, "endMs": "1665777821166", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4167", "startMs": "1665777821090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.012219959266802444, "waitRatioMax": 0.016293279022403257, "writeMsAvg": "9", "writeMsMax": "20", "writeRatioAvg": 0.018329938900203666, "writeRatioMax": 0.04073319755600815 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.034623217922606926, "endMs": "1665777821220", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3692", "startMs": "1665777821169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.008146639511201629, "waitRatioMax": 0.012219959266802444, "writeMsAvg": "13", "writeMsMax": "26", "writeRatioAvg": 0.026476578411405296, "writeRatioMax": 0.05295315682281059 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.03054989816700611, "endMs": "1665777821233", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3640", "startMs": "1665777821171", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.018329938900203666, "waitRatioMax": 0.02240325865580448, "writeMsAvg": "13", "writeMsMax": "26", "writeRatioAvg": 0.026476578411405296, "writeRatioMax": 0.05295315682281059 }, { "completedParallelInputs": "101", "computeMsAvg": "68", "computeMsMax": "118", "computeRatioAvg": 0.1384928716904277, "computeRatioMax": 0.24032586558044808, "endMs": "1665777821297", "id": "36", "inputStages": [ "32", "35", "34", "21" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6469575", "recordsWritten": "10000", "shuffleOutputBytes": "1267356", "shuffleOutputBytesSpilled": "0", "slotMs": "9441", "startMs": "1665777821185", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$430, $860, $861, $862, $863, $864, $865, $866", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$130, $190, $191, $192, $194", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$120, $150, $151, $152, $154", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$1230 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1070, $1231 := $1071, $1232 := $1072, $1233 := $1073, $1234 := $1075, $1235 := $1076, $1236 := $1077, $1237 := $154", "INNER HASH JOIN EACH WITH ALL ON $1073 = $152, $1072 = $151, $1070 = $150, $1074 = $120" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $170, $1071 := $171, $1072 := $172, $1073 := $173, $1074 := $174, $1075 := $175, $1076 := $176, $1077 := $194", "INNER HASH JOIN EACH WITH ALL ON $173 = $192, $172 = $191, $170 = $190, $174 = $130" ] }, { "kind": "FILTER", "substeps": [ "and(equal($171, 1999), greater($175, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $834, $833, $830 ORDER BY $831 ASC, $832 ASC)" ] }, { "kind": "SORT", "substeps": [ "$424 ASC, $423 ASC, $420 ASC, $421 ASC, $422 ASC" ] }, { "kind": "JOIN", "substeps": [ "$910 := $440, $911 := $441, $912 := $443, $913 := $444, $914 := $445, $915 := $446, $916 := $450", "INNER HASH JOIN EACH WITH ALL ON $320 = $330, $321 = $331, $322 = $332, $323 = $333, $324 = $334, $325 = $335, $326 = $336, $327 = $337, $328 = $338, $329 = $339" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := coalesce($444, '')", "$321 := coalesce($444, '0')", "$322 := coalesce($443, '')", "$323 := coalesce($443, '0')", "$324 := coalesce($440, '')", "$325 := coalesce($440, '0')", "$326 := coalesce($441, 0)", "$327 := coalesce($441, 1)", "$328 := coalesce($442, 0)", "$329 := coalesce($442, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "TO __stage24_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.020366598778004074, "waitRatioMax": 0.024439918533604887, "writeMsAvg": "3", "writeMsMax": "19", "writeRatioAvg": 0.006109979633401222, "writeRatioMax": 0.038696537678207736 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.038696537678207736, "computeRatioMax": 0.038696537678207736, "endMs": "1665777821301", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "12609", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665777821192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1241 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1250, $1251, $1252, $1253, $1254, $1255, $1256, $1257", "TO __stage25_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.014256619144602852, "waitRatioMax": 0.014256619144602852, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008146639511201629, "writeRatioMax": 0.008146639511201629 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "23", "elapsedMs": "635", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "4232" }, { "activeUnits": "101", "completedUnits": "1036", "elapsedMs": "1311", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "51101" } ], "totalBytesBilled": "60817408", "totalBytesProcessed": "59801163", "totalPartitionsProcessed": "0", "totalSlotMs": "51101", "transferredBytes": "0" }, "startTime": "1665777820063", "totalBytesProcessed": "59801163", "totalSlotMs": "51101" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond8e73249_63f9_456b_8669_4e2369a9a153" }, "priority": "INTERACTIVE", "query": "with v1 as(\n select i_category, i_brand,\n cc_name,\n d_year, d_moy,\n sum(cs_sales_price) sum_sales,\n avg(sum(cs_sales_price)) over\n (partition by i_category, i_brand,\n cc_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n cc_name\n order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n cs_sold_date_sk = d_date_sk and\n cc_call_center_sk= cs_call_center_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n cc_name , d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.cc_name\n ,v1.d_year\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1. cc_name = v1_lag. cc_name and\n v1. cc_name = v1_lead. cc_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and\n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by cc_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "UcL4l6RwU1g2MYWQlIVy0A==", "id": "test-project-364309:europe-west1.query57_1665777823", "jobReference": { "jobId": "query57_1665777823", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query57_1665777823?location=europe-west1", "statistics": { "creationTime": "1665777824104", "endTime": "1665777825454", "finalExecutionDurationMs": "1081", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "59801163", "performanceInsights": { "avgPreviousExecutionMs": "1222" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.027149321266968326, "computeRatioMax": 0.027149321266968326, "endMs": "1665777824336", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.020361990950226245, "readRatioMax": 0.020361990950226245, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777824286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:cc_call_center_sk, $81:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03619909502262444, "writeRatioMax": 0.03619909502262444 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.07013574660633484, "computeRatioMax": 0.07013574660633484, "endMs": "1665777824344", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.027149321266968326, "readRatioMax": 0.027149321266968326, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777824300", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.027149321266968326, "writeRatioMax": 0.027149321266968326 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.029411764705882353, "endMs": "1665777824380", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.00904977375565611, "readRatioMax": 0.00904977375565611, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777824329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.05656108597285068, "writeRatioMax": 0.05656108597285068 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.00904977375565611, "computeRatioMax": 0.00904977375565611, "endMs": "1665777824419", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.00904977375565611, "readRatioMax": 0.00904977375565611, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777824380", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cc_call_center_sk, $11:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage04_output" ] } ], "waitMsAvg": "36", "waitMsMax": "36", "waitRatioAvg": 0.08144796380090498, "waitRatioMax": 0.08144796380090498, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04072398190045249, "writeRatioMax": 0.04072398190045249 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.024886877828054297, "computeRatioMax": 0.024886877828054297, "endMs": "1665777824455", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011312217194570135, "readRatioMax": 0.011312217194570135, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777824420", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "60", "waitMsMax": "60", "waitRatioAvg": 0.13574660633484162, "waitRatioMax": 0.13574660633484162, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.04751131221719457, "writeRatioMax": 0.04751131221719457 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.042986425339366516, "computeRatioMax": 0.042986425339366516, "endMs": "1665777824480", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01583710407239819, "readRatioMax": 0.01583710407239819, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777824421", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "31", "waitMsMax": "31", "waitRatioAvg": 0.07013574660633484, "waitRatioMax": 0.07013574660633484, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.020361990950226245, "computeRatioMax": 0.020361990950226245, "endMs": "1665777824462", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011312217194570135, "readRatioMax": 0.011312217194570135, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777824421", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cc_call_center_sk, $2:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "16", "waitMsMax": "16", "waitRatioAvg": 0.03619909502262444, "waitRatioMax": 0.03619909502262444, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04072398190045249, "writeRatioMax": 0.04072398190045249 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.03619909502262444, "computeRatioMax": 0.03619909502262444, "endMs": "1665777824476", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01583710407239819, "readRatioMax": 0.01583710407239819, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777824437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "15", "waitMsMax": "15", "waitRatioAvg": 0.033936651583710405, "waitRatioMax": 0.033936651583710405, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.01809954751131222, "writeRatioMax": 0.01809954751131222 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.033936651583710405, "computeRatioMax": 0.033936651583710405, "endMs": "1665777824515", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013574660633484163, "readRatioMax": 0.013574660633484163, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777824455", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.06787330316742081, "writeRatioMax": 0.06787330316742081 }, { "completedParallelInputs": "5", "computeMsAvg": "307", "computeMsMax": "368", "computeRatioAvg": 0.6945701357466063, "computeRatioMax": 0.832579185520362, "endMs": "1665777824682", "id": "12", "inputStages": [ "3", "1", "0" ], "name": "S0C: Join+", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.029411764705882353, "readRatioMax": 0.04072398190045249, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1349", "startMs": "1665777824462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $741, $751 := $740, $752 := $745, $753 := $743, $754 := $744", "$620 := SUM($742)" ] }, { "kind": "JOIN", "substeps": [ "$740 := $730, $741 := $731, $742 := $733, $743 := $734, $744 := $735, $745 := $81", "INNER HASH JOIN EACH WITH ALL ON $732 = $80" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $713, $733 := $714, $734 := $111, $735 := $112", "INNER HASH JOIN EACH WITH ALL ON $712 = $110" ] }, { "kind": "JOIN", "substeps": [ "$712 := $100, $713 := $101, $714 := $103, $710 := $91, $711 := $92", "INNER HASH JOIN EACH WITH ALL ON $102 = $90" ] }, { "kind": "WRITE", "substeps": [ "$752, $751, $750, $753, $754, $620", "TO __stage0C_output", "BY HASH($750, $751, $752, $753, $754)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.011312217194570135, "writeRatioMax": 0.01809954751131222 }, { "completedParallelInputs": "5", "computeMsAvg": "294", "computeMsMax": "387", "computeRatioAvg": 0.665158371040724, "computeRatioMax": 0.8755656108597285, "endMs": "1665777824784", "id": "13", "inputStages": [ "7", "4", "5" ], "name": "S0D: Join+", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "21", "readRatioAvg": 0.033936651583710405, "readRatioMax": 0.04751131221719457, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1456", "startMs": "1665777824503", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $951, $961 := $950, $962 := $955, $963 := $953, $964 := $954", "$460 := SUM($952)" ] }, { "kind": "JOIN", "substeps": [ "$950 := $940, $951 := $941, $952 := $943, $953 := $944, $954 := $945, $955 := $11", "INNER HASH JOIN EACH WITH ALL ON $942 = $10" ] }, { "kind": "JOIN", "substeps": [ "$940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $71, $945 := $72", "INNER HASH JOIN EACH WITH ALL ON $922 = $70" ] }, { "kind": "JOIN", "substeps": [ "$922 := $60, $923 := $61, $924 := $63, $920 := $51, $921 := $52", "INNER HASH JOIN EACH WITH ALL ON $62 = $50" ] }, { "kind": "WRITE", "substeps": [ "$962, $961, $960, $963, $964, $460", "TO __stage0D_output", "BY HASH($960, $961, $962, $963, $964)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "22", "writeMsMax": "23", "writeRatioAvg": 0.049773755656108594, "writeRatioMax": 0.05203619909502263 }, { "completedParallelInputs": "5", "computeMsAvg": "307", "computeMsMax": "442", "computeRatioAvg": 0.6945701357466063, "computeRatioMax": 1, "endMs": "1665777824817", "id": "14", "inputStages": [ "9", "8", "11" ], "name": "S0E: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "14", "readRatioAvg": 0.027149321266968326, "readRatioMax": 0.03167420814479638, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1431", "startMs": "1665777824545", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1111, $1121 := $1110, $1122 := $1115, $1123 := $1113, $1124 := $1114", "$360 := SUM($1112)" ] }, { "kind": "JOIN", "substeps": [ "$1110 := $1100, $1111 := $1101, $1112 := $1103, $1113 := $1104, $1114 := $1105, $1115 := $2", "INNER HASH JOIN EACH WITH ALL ON $1102 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1080, $1101 := $1081, $1102 := $1083, $1103 := $1084, $1104 := $41, $1105 := $42", "INNER HASH JOIN EACH WITH ALL ON $1082 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1082 := $30, $1083 := $31, $1084 := $33, $1080 := $21, $1081 := $22", "INNER HASH JOIN EACH WITH ALL ON $32 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "TO __stage0E_output", "BY HASH($1120, $1121, $1122, $1123, $1124)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "20", "writeMsMax": "21", "writeRatioAvg": 0.04524886877828054, "writeRatioMax": 0.04751131221719457 }, { "completedParallelInputs": "1", "computeMsAvg": "175", "computeMsMax": "175", "computeRatioAvg": 0.39592760180995473, "computeRatioMax": 0.39592760180995473, "endMs": "1665777824821", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "166", "startMs": "1665777824700", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$752, $751, $750, $753, $754, $620", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $760 := $750, $761 := $751, $762 := $752, $763 := $753, $764 := $754", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$762, $761, $760, $763, $764, $510", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.04524886877828054, "writeRatioMax": 0.04524886877828054 }, { "completedParallelInputs": "1", "computeMsAvg": "164", "computeMsMax": "164", "computeRatioAvg": 0.37104072398190047, "computeRatioMax": 0.37104072398190047, "endMs": "1665777824940", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "178", "startMs": "1665777824825", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$962, $961, $960, $963, $964, $460", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960, $971 := $961, $972 := $962, $973 := $963, $974 := $964", "$260 := SUM($460)" ] }, { "kind": "WRITE", "substeps": [ "$972, $971, $970, $973, $974, $260", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004524886877828055, "waitRatioMax": 0.004524886877828055, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.049773755656108594, "writeRatioMax": 0.049773755656108594 }, { "completedParallelInputs": "1", "computeMsAvg": "167", "computeMsMax": "167", "computeRatioAvg": 0.3778280542986425, "computeRatioMax": 0.3778280542986425, "endMs": "1665777824962", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "162", "startMs": "1665777824852", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124", "$230 := SUM($360)" ] }, { "kind": "WRITE", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.04524886877828054, "writeRatioMax": 0.04524886877828054 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.013574660633484163, "computeRatioMax": 0.013574660633484163, "endMs": "1665777824904", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777824870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $800, $801, $802, $803", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($810, '')", "$561 := coalesce($810, '0')", "$562 := coalesce($811, 0)", "$563 := coalesce($811, 1)", "$564 := coalesce($812, '')", "$565 := coalesce($812, '0')", "$566 := coalesce($813, '')", "$567 := coalesce($813, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800, $811 := $801, $812 := $802, $813 := $803", "$660 := ROOT_AVG($690)" ] }, { "kind": "WRITE", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.038461538461538464 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.01809954751131222, "computeRatioMax": 0.03167420814479638, "endMs": "1665777824966", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3542", "startMs": "1665777824915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.006787330316742082, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.033936651583710405, "writeRatioMax": 0.06561085972850679 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "25", "computeRatioAvg": 0.027149321266968326, "computeRatioMax": 0.05656108597285068, "endMs": "1665777824988", "id": "21", "inputStages": [ "20", "15" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32775", "shuffleOutputBytes": "3310098", "shuffleOutputBytesSpilled": "0", "slotMs": "4967", "startMs": "1665777824930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$762, $761, $760, $763, $764, $510", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$640, $641, $642, $643, $644, $645", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$410 := AVG($775) OVER (PARTITION BY $774, $773, $770, $771 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$634 ASC, $633 ASC, $630 ASC, $631 ASC" ] }, { "kind": "JOIN", "substeps": [ "$820 := $650, $821 := $651, $822 := $652, $823 := $653, $824 := $654, $825 := $655, $826 := $660", "INNER HASH JOIN EACH WITH ALL ON $550 = $560, $551 = $561, $552 = $562, $553 = $563, $554 = $564, $555 = $565, $556 = $566, $557 = $567" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := coalesce($650, '')", "$551 := coalesce($650, '0')", "$552 := coalesce($651, 0)", "$553 := coalesce($651, 1)", "$554 := coalesce($653, '')", "$555 := coalesce($653, '0')", "$556 := coalesce($654, '')", "$557 := coalesce($654, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.004524886877828055, "waitRatioMax": 0.011312217194570135, "writeMsAvg": "25", "writeMsMax": "32", "writeRatioAvg": 0.05656108597285068, "writeRatioMax": 0.07239819004524888 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01809954751131222, "computeRatioMax": 0.01809954751131222, "endMs": "1665777825047", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777825010", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$540, $1202, $1203, $1204, $1201, $1200", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($1210, '')", "$291 := coalesce($1210, '0')", "$292 := coalesce($1211, '')", "$293 := coalesce($1211, '0')", "$294 := coalesce($1212, '')", "$295 := coalesce($1212, '0')", "$296 := coalesce($1213, 0)", "$297 := coalesce($1213, 1)", "$298 := coalesce($1214, 0)", "$299 := coalesce($1214, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204", "$400 := MIN($540)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $400", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.04524886877828054, "writeRatioMax": 0.04524886877828054 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01809954751131222, "computeRatioMax": 0.01809954751131222, "endMs": "1665777825079", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777825042", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1042, $1043, $1044, $1041, $1040", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($1050, '')", "$351 := coalesce($1050, '0')", "$352 := coalesce($1051, '')", "$353 := coalesce($1051, '0')", "$354 := coalesce($1052, '')", "$355 := coalesce($1052, '0')", "$356 := coalesce($1053, 0)", "$357 := coalesce($1053, 1)", "$358 := coalesce($1054, 0)", "$359 := coalesce($1054, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044", "$500 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.042986425339366516, "writeRatioMax": 0.042986425339366516 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.011312217194570135, "computeRatioMax": 0.011312217194570135, "endMs": "1665777825114", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777825071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $892, $893, $894, $891, $890", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := coalesce($900, '')", "$331 := coalesce($900, '0')", "$332 := coalesce($901, '')", "$333 := coalesce($901, '0')", "$334 := coalesce($902, '')", "$335 := coalesce($902, '0')", "$336 := coalesce($903, 0)", "$337 := coalesce($903, 1)", "$338 := coalesce($904, 0)", "$339 := coalesce($904, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891, $902 := $892, $903 := $893, $904 := $894", "$450 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.0022624434389140274, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.0746606334841629, "writeRatioMax": 0.0746606334841629 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.01809954751131222, "computeRatioMax": 0.03619909502262444, "endMs": "1665777825164", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3825", "startMs": "1665777825090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.006787330316742082, "waitRatioMax": 0.00904977375565611, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.033936651583710405, "writeRatioMax": 0.06334841628959276 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "19", "computeRatioAvg": 0.027149321266968326, "computeRatioMax": 0.042986425339366516, "endMs": "1665777825167", "id": "29", "inputStages": [ "28", "17" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4026", "startMs": "1665777825103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$380, $1170, $1171, $1172, $1173, $1174, $1175", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $400", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($153, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$200 := RANK() OVER (PARTITION BY $1144, $1143, $1140 ORDER BY $1141 ASC, $1142 ASC)" ] }, { "kind": "SORT", "substeps": [ "$374 ASC, $373 ASC, $370 ASC, $371 ASC, $372 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $390, $1221 := $393, $1222 := $394, $1223 := $395, $1224 := $400", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291, $282 = $292, $283 = $293, $284 = $294, $285 = $295, $286 = $296, $287 = $297, $288 = $298, $289 = $299" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := coalesce($394, '')", "$281 := coalesce($394, '0')", "$282 := coalesce($393, '')", "$283 := coalesce($393, '0')", "$284 := coalesce($390, '')", "$285 := coalesce($390, '0')", "$286 := coalesce($391, 0)", "$287 := coalesce($391, 1)", "$288 := coalesce($392, 0)", "$289 := coalesce($392, 1)" ] }, { "kind": "WRITE", "substeps": [ "$120, $150, $151, $152, $154", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.0022624434389140274, "waitRatioMax": 0.00904977375565611, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.033936651583710405, "writeRatioMax": 0.06334841628959276 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "22", "computeRatioAvg": 0.01809954751131222, "computeRatioMax": 0.049773755656108594, "endMs": "1665777825179", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3760", "startMs": "1665777825104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.006787330316742082, "waitRatioMax": 0.00904977375565611, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.033936651583710405, "writeRatioMax": 0.06561085972850679 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "20", "computeRatioAvg": 0.027149321266968326, "computeRatioMax": 0.04524886877828054, "endMs": "1665777825179", "id": "31", "inputStages": [ "30", "16" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4049", "startMs": "1665777825119", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$972, $971, $970, $973, $974, $260", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$480, $1010, $1011, $1012, $1013, $1014, $1015", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := add($193, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $984, $983, $980 ORDER BY $981 ASC, $982 ASC)" ] }, { "kind": "SORT", "substeps": [ "$474 ASC, $473 ASC, $470 ASC, $471 ASC, $472 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $490, $1061 := $493, $1062 := $494, $1063 := $495, $1064 := $500", "INNER HASH JOIN EACH WITH ALL ON $340 = $350, $341 = $351, $342 = $352, $343 = $353, $344 = $354, $345 = $355, $346 = $356, $347 = $357, $348 = $358, $349 = $359" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($494, '')", "$341 := coalesce($494, '0')", "$342 := coalesce($493, '')", "$343 := coalesce($493, '0')", "$344 := coalesce($490, '')", "$345 := coalesce($490, '0')", "$346 := coalesce($491, 0)", "$347 := coalesce($491, 1)", "$348 := coalesce($492, 0)", "$349 := coalesce($492, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $190, $191, $192, $194", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.004524886877828055, "waitRatioMax": 0.011312217194570135, "writeMsAvg": "12", "writeMsMax": "19", "writeRatioAvg": 0.027149321266968326, "writeRatioMax": 0.042986425339366516 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.01809954751131222, "computeRatioMax": 0.03167420814479638, "endMs": "1665777825183", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3278", "startMs": "1665777825121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.006787330316742082, "waitRatioMax": 0.011312217194570135, "writeMsAvg": "13", "writeMsMax": "24", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.05429864253393665 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.020361990950226245, "computeRatioMax": 0.049773755656108594, "endMs": "1665777825247", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3823", "startMs": "1665777825188", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004524886877828055, "waitRatioMax": 0.00904977375565611, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.03167420814479638, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.01809954751131222, "computeRatioMax": 0.033936651583710405, "endMs": "1665777825241", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3403", "startMs": "1665777825189", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.00904977375565611, "waitRatioMax": 0.011312217194570135, "writeMsAvg": "12", "writeMsMax": "20", "writeRatioAvg": 0.027149321266968326, "writeRatioMax": 0.04524886877828054 }, { "completedParallelInputs": "101", "computeMsAvg": "70", "computeMsMax": "117", "computeRatioAvg": 0.1583710407239819, "computeRatioMax": 0.2647058823529412, "endMs": "1665777825320", "id": "36", "inputStages": [ "35", "34", "21", "32" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6469575", "recordsWritten": "10000", "shuffleOutputBytes": "1267356", "shuffleOutputBytesSpilled": "0", "slotMs": "10047", "startMs": "1665777825199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$430, $860, $861, $862, $863, $864, $865, $866", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$130, $190, $191, $192, $194", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$120, $150, $151, $152, $154", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$1230 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1070, $1231 := $1071, $1232 := $1072, $1233 := $1073, $1234 := $1075, $1235 := $1076, $1236 := $1077, $1237 := $154", "INNER HASH JOIN EACH WITH ALL ON $1073 = $152, $1072 = $151, $1070 = $150, $1074 = $120" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $170, $1071 := $171, $1072 := $172, $1073 := $173, $1074 := $174, $1075 := $175, $1076 := $176, $1077 := $194", "INNER HASH JOIN EACH WITH ALL ON $173 = $192, $172 = $191, $170 = $190, $174 = $130" ] }, { "kind": "FILTER", "substeps": [ "and(equal($171, 1999), greater($175, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $834, $833, $830 ORDER BY $831 ASC, $832 ASC)" ] }, { "kind": "SORT", "substeps": [ "$424 ASC, $423 ASC, $420 ASC, $421 ASC, $422 ASC" ] }, { "kind": "JOIN", "substeps": [ "$910 := $440, $911 := $441, $912 := $443, $913 := $444, $914 := $445, $915 := $446, $916 := $450", "INNER HASH JOIN EACH WITH ALL ON $320 = $330, $321 = $331, $322 = $332, $323 = $333, $324 = $334, $325 = $335, $326 = $336, $327 = $337, $328 = $338, $329 = $339" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := coalesce($444, '')", "$321 := coalesce($444, '0')", "$322 := coalesce($443, '')", "$323 := coalesce($443, '0')", "$324 := coalesce($440, '')", "$325 := coalesce($440, '0')", "$326 := coalesce($441, 0)", "$327 := coalesce($441, 1)", "$328 := coalesce($442, 0)", "$329 := coalesce($442, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "TO __stage24_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.011312217194570135, "waitRatioMax": 0.013574660633484163, "writeMsAvg": "3", "writeMsMax": "20", "writeRatioAvg": 0.006787330316742082, "writeRatioMax": 0.04524886877828054 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.024886877828054297, "computeRatioMax": 0.024886877828054297, "endMs": "1665777825323", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "12853", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777825209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1241 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1250, $1251, $1252, $1253, $1254, $1255, $1256, $1257", "TO __stage25_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.011312217194570135, "waitRatioMax": 0.011312217194570135, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.020361990950226245, "writeRatioMax": 0.020361990950226245 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "22", "elapsedMs": "629", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "4745" }, { "activeUnits": "3", "completedUnits": "1036", "elapsedMs": "1238", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "52641" } ], "totalBytesBilled": "60817408", "totalBytesProcessed": "59801163", "totalPartitionsProcessed": "0", "totalSlotMs": "52641", "transferredBytes": "0" }, "startTime": "1665777824159", "totalBytesProcessed": "59801163", "totalSlotMs": "52641" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc7d57f16_2e14_4612_bf62_e83749b0dd03" }, "priority": "INTERACTIVE", "query": "with v1 as(\n select i_category, i_brand,\n cc_name,\n d_year, d_moy,\n sum(cs_sales_price) sum_sales,\n avg(sum(cs_sales_price)) over\n (partition by i_category, i_brand,\n cc_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n cc_name\n order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n cs_sold_date_sk = d_date_sk and\n cc_call_center_sk= cs_call_center_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n cc_name , d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.cc_name\n ,v1.d_year\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1. cc_name = v1_lag. cc_name and\n v1. cc_name = v1_lead. cc_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and\n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by cc_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "yybmdjTAfmaRkVlyLXVkEw==", "id": "test-project-364309:europe-west1.query57_1665777826", "jobReference": { "jobId": "query57_1665777826", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query57_1665777826?location=europe-west1", "statistics": { "creationTime": "1665777827102", "endTime": "1665777828944", "finalExecutionDurationMs": "1569", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "59801163", "performanceInsights": { "avgPreviousExecutionMs": "1194" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.022172949002217297, "computeRatioMax": 0.022172949002217297, "endMs": "1665777827324", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017738359201773836, "readRatioMax": 0.017738359201773836, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777827284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:cc_call_center_sk, $81:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004434589800443459, "waitRatioMax": 0.004434589800443459, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.022172949002217297, "writeRatioMax": 0.022172949002217297 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.04434589800443459, "computeRatioMax": 0.04434589800443459, "endMs": "1665777827454", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.019955654101995565, "readRatioMax": 0.019955654101995565, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "139", "startMs": "1665777827310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004434589800443459, "waitRatioMax": 0.004434589800443459, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.013303769401330377, "writeRatioMax": 0.013303769401330377 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.050997782705099776, "computeRatioMax": 0.050997782705099776, "endMs": "1665777827501", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015521064301552107, "readRatioMax": 0.015521064301552107, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777827456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "116", "waitMsMax": "116", "waitRatioAvg": 0.2572062084257206, "waitRatioMax": 0.2572062084257206, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.050997782705099776, "writeRatioMax": 0.050997782705099776 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.019955654101995565, "computeRatioMax": 0.019955654101995565, "endMs": "1665777827697", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013303769401330377, "readRatioMax": 0.013303769401330377, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "197", "startMs": "1665777827501", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cc_call_center_sk, $11:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage04_output" ] } ], "waitMsAvg": "92", "waitMsMax": "92", "waitRatioAvg": 0.2039911308203991, "waitRatioMax": 0.2039911308203991, "writeMsAvg": "180", "writeMsMax": "180", "writeRatioAvg": 0.3991130820399113, "writeRatioMax": 0.3991130820399113 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.05321507760532151, "computeRatioMax": 0.05321507760532151, "endMs": "1665777827703", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015521064301552107, "readRatioMax": 0.015521064301552107, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "140", "startMs": "1665777827504", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "69", "waitMsMax": "69", "waitRatioAvg": 0.15299334811529933, "waitRatioMax": 0.15299334811529933, "writeMsAvg": "175", "writeMsMax": "175", "writeRatioAvg": 0.38802660753880264, "writeRatioMax": 0.38802660753880264 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.037694013303769404, "computeRatioMax": 0.037694013303769404, "endMs": "1665777827729", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013303769401330377, "readRatioMax": 0.013303769401330377, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "222", "startMs": "1665777827504", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "30", "waitMsMax": "30", "waitRatioAvg": 0.06651884700665188, "waitRatioMax": 0.06651884700665188, "writeMsAvg": "207", "writeMsMax": "207", "writeRatioAvg": 0.458980044345898, "writeRatioMax": 0.458980044345898 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.013303769401330377, "computeRatioMax": 0.013303769401330377, "endMs": "1665777827694", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008869179600886918, "readRatioMax": 0.008869179600886918, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "197", "startMs": "1665777827505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cc_call_center_sk, $2:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.017738359201773836, "waitRatioMax": 0.017738359201773836, "writeMsAvg": "180", "writeMsMax": "180", "writeRatioAvg": 0.3991130820399113, "writeRatioMax": 0.3991130820399113 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.04656319290465632, "computeRatioMax": 0.04656319290465632, "endMs": "1665777827701", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.024390243902439025, "readRatioMax": 0.024390243902439025, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "141", "startMs": "1665777827522", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004434589800443459, "waitRatioMax": 0.004434589800443459, "writeMsAvg": "150", "writeMsMax": "150", "writeRatioAvg": 0.3325942350332594, "writeRatioMax": 0.3325942350332594 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.04656319290465632, "computeRatioMax": 0.04656319290465632, "endMs": "1665777827683", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013303769401330377, "readRatioMax": 0.013303769401330377, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777827627", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004434589800443459, "waitRatioMax": 0.004434589800443459, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.050997782705099776, "writeRatioMax": 0.050997782705099776 }, { "completedParallelInputs": "5", "computeMsAvg": "277", "computeMsMax": "356", "computeRatioAvg": 0.614190687361419, "computeRatioMax": 0.7893569844789357, "endMs": "1665777828020", "id": "12", "inputStages": [ "1", "0", "3" ], "name": "S0C: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.031042128603104215, "readRatioMax": 0.04212860310421286, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1653", "startMs": "1665777827631", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $741, $751 := $740, $752 := $745, $753 := $743, $754 := $744", "$620 := SUM($742)" ] }, { "kind": "JOIN", "substeps": [ "$740 := $730, $741 := $731, $742 := $733, $743 := $734, $744 := $735, $745 := $81", "INNER HASH JOIN EACH WITH ALL ON $732 = $80" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $713, $733 := $714, $734 := $111, $735 := $112", "INNER HASH JOIN EACH WITH ALL ON $712 = $110" ] }, { "kind": "JOIN", "substeps": [ "$712 := $100, $713 := $101, $714 := $103, $710 := $91, $711 := $92", "INNER HASH JOIN EACH WITH ALL ON $102 = $90" ] }, { "kind": "WRITE", "substeps": [ "$752, $751, $750, $753, $754, $620", "TO __stage0C_output", "BY HASH($750, $751, $752, $753, $754)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022172949002217295, "waitRatioMax": 0.0022172949002217295, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.015521064301552107, "writeRatioMax": 0.017738359201773836 }, { "completedParallelInputs": "5", "computeMsAvg": "295", "computeMsMax": "451", "computeRatioAvg": 0.6541019955654102, "computeRatioMax": 1, "endMs": "1665777828017", "id": "14", "inputStages": [ "8", "9", "11" ], "name": "S0E: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.031042128603104215, "readRatioMax": 0.03547671840354767, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1620", "startMs": "1665777827732", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1111, $1121 := $1110, $1122 := $1115, $1123 := $1113, $1124 := $1114", "$360 := SUM($1112)" ] }, { "kind": "JOIN", "substeps": [ "$1110 := $1100, $1111 := $1101, $1112 := $1103, $1113 := $1104, $1114 := $1105, $1115 := $2", "INNER HASH JOIN EACH WITH ALL ON $1102 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1080, $1101 := $1081, $1102 := $1083, $1103 := $1084, $1104 := $41, $1105 := $42", "INNER HASH JOIN EACH WITH ALL ON $1082 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1082 := $30, $1083 := $31, $1084 := $33, $1080 := $21, $1081 := $22", "INNER HASH JOIN EACH WITH ALL ON $32 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "TO __stage0E_output", "BY HASH($1120, $1121, $1122, $1123, $1124)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022172949002217295, "waitRatioMax": 0.0022172949002217295, "writeMsAvg": "20", "writeMsMax": "22", "writeRatioAvg": 0.04434589800443459, "writeRatioMax": 0.04878048780487805 }, { "completedParallelInputs": "5", "computeMsAvg": "357", "computeMsMax": "442", "computeRatioAvg": 0.7915742793791575, "computeRatioMax": 0.9800443458980045, "endMs": "1665777828019", "id": "15", "inputStages": [ "4", "7", "5" ], "name": "S0F: Join+", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "21", "readRatioAvg": 0.03325942350332594, "readRatioMax": 0.04656319290465632, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1719", "startMs": "1665777827751", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $951, $961 := $950, $962 := $955, $963 := $953, $964 := $954", "$460 := SUM($952)" ] }, { "kind": "JOIN", "substeps": [ "$950 := $940, $951 := $941, $952 := $943, $953 := $944, $954 := $945, $955 := $11", "INNER HASH JOIN EACH WITH ALL ON $942 = $10" ] }, { "kind": "JOIN", "substeps": [ "$940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $71, $945 := $72", "INNER HASH JOIN EACH WITH ALL ON $922 = $70" ] }, { "kind": "JOIN", "substeps": [ "$922 := $60, $923 := $61, $924 := $63, $920 := $51, $921 := $52", "INNER HASH JOIN EACH WITH ALL ON $62 = $50" ] }, { "kind": "WRITE", "substeps": [ "$962, $961, $960, $963, $964, $460", "TO __stage0F_output", "BY HASH($960, $961, $962, $963, $964)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022172949002217295, "waitRatioMax": 0.0022172949002217295, "writeMsAvg": "21", "writeMsMax": "23", "writeRatioAvg": 0.04656319290465632, "writeRatioMax": 0.050997782705099776 }, { "completedParallelInputs": "1", "computeMsAvg": "172", "computeMsMax": "172", "computeRatioAvg": 0.38137472283813745, "computeRatioMax": 0.38137472283813745, "endMs": "1665777828156", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "190", "startMs": "1665777828047", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124", "$230 := SUM($360)" ] }, { "kind": "WRITE", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022172949002217295, "waitRatioMax": 0.0022172949002217295, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03991130820399113, "writeRatioMax": 0.03991130820399113 }, { "completedParallelInputs": "1", "computeMsAvg": "163", "computeMsMax": "163", "computeRatioAvg": 0.3614190687361419, "computeRatioMax": 0.3614190687361419, "endMs": "1665777828188", "id": "17", "inputStages": [ "15" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "164", "startMs": "1665777828067", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$962, $961, $960, $963, $964, $460", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960, $971 := $961, $972 := $962, $973 := $963, $974 := $964", "$260 := SUM($460)" ] }, { "kind": "WRITE", "substeps": [ "$972, $971, $970, $973, $974, $260", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022172949002217295, "waitRatioMax": 0.0022172949002217295, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.04434589800443459, "writeRatioMax": 0.04434589800443459 }, { "completedParallelInputs": "1", "computeMsAvg": "180", "computeMsMax": "180", "computeRatioAvg": 0.3991130820399113, "computeRatioMax": 0.3991130820399113, "endMs": "1665777828224", "id": "18", "inputStages": [ "12" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "183", "startMs": "1665777828087", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$752, $751, $750, $753, $754, $620", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $760 := $750, $761 := $751, $762 := $752, $763 := $753, $764 := $754", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$762, $761, $760, $763, $764, $510", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004434589800443459, "waitRatioMax": 0.004434589800443459, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.04212860310421286, "writeRatioMax": 0.04212860310421286 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.011086474501108648, "computeRatioMax": 0.011086474501108648, "endMs": "1665777828297", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777828263", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $800, $801, $802, $803", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($810, '')", "$561 := coalesce($810, '0')", "$562 := coalesce($811, 0)", "$563 := coalesce($811, 1)", "$564 := coalesce($812, '')", "$565 := coalesce($812, '0')", "$566 := coalesce($813, '')", "$567 := coalesce($813, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800, $811 := $801, $812 := $802, $813 := $803", "$660 := ROOT_AVG($690)" ] }, { "kind": "WRITE", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022172949002217295, "waitRatioMax": 0.0022172949002217295, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03547671840354767, "writeRatioMax": 0.03547671840354767 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.017738359201773836, "computeRatioMax": 0.031042128603104215, "endMs": "1665777828398", "id": "21", "inputStages": [ "19" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "6048", "startMs": "1665777828313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.0066518847006651885, "waitRatioMax": 0.011086474501108648, "writeMsAvg": "48", "writeMsMax": "59", "writeRatioAvg": 0.10643015521064302, "writeRatioMax": 0.13082039911308205 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "22", "computeRatioAvg": 0.026607538802660754, "computeRatioMax": 0.04878048780487805, "endMs": "1665777828393", "id": "22", "inputStages": [ "18", "21" ], "name": "S16: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32775", "shuffleOutputBytes": "3310098", "shuffleOutputBytesSpilled": "0", "slotMs": "4801", "startMs": "1665777828328", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$762, $761, $760, $763, $764, $510", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$640, $641, $642, $643, $644, $645", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "FROM __stage15_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$410 := AVG($775) OVER (PARTITION BY $774, $773, $770, $771 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$634 ASC, $633 ASC, $630 ASC, $631 ASC" ] }, { "kind": "JOIN", "substeps": [ "$820 := $650, $821 := $651, $822 := $652, $823 := $653, $824 := $654, $825 := $655, $826 := $660", "INNER HASH JOIN EACH WITH ALL ON $550 = $560, $551 = $561, $552 = $562, $553 = $563, $554 = $564, $555 = $565, $556 = $566, $557 = $567" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := coalesce($650, '')", "$551 := coalesce($650, '0')", "$552 := coalesce($651, 0)", "$553 := coalesce($651, 1)", "$554 := coalesce($653, '')", "$555 := coalesce($653, '0')", "$556 := coalesce($654, '')", "$557 := coalesce($654, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004434589800443459, "waitRatioMax": 0.008869179600886918, "writeMsAvg": "26", "writeMsMax": "37", "writeRatioAvg": 0.057649667405764965, "writeRatioMax": 0.082039911308204 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.015521064301552107, "computeRatioMax": 0.015521064301552107, "endMs": "1665777828457", "id": "23", "name": "S17: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777828419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$540, $1202, $1203, $1204, $1201, $1200", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($1210, '')", "$291 := coalesce($1210, '0')", "$292 := coalesce($1211, '')", "$293 := coalesce($1211, '0')", "$294 := coalesce($1212, '')", "$295 := coalesce($1212, '0')", "$296 := coalesce($1213, 0)", "$297 := coalesce($1213, 1)", "$298 := coalesce($1214, 0)", "$299 := coalesce($1214, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204", "$400 := MIN($540)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $400", "TO __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004434589800443459, "waitRatioMax": 0.004434589800443459, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.07095343680709534, "writeRatioMax": 0.07095343680709534 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.013303769401330377, "computeRatioMax": 0.013303769401330377, "endMs": "1665777828514", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777828474", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $1010, $1011, $1012, $1013, $1014, $1015", "FROM __SHUFFLE11" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($494, '')", "$341 := coalesce($494, '0')", "$342 := coalesce($493, '')", "$343 := coalesce($493, '0')", "$344 := coalesce($490, '')", "$345 := coalesce($490, '0')", "$346 := coalesce($491, 0)", "$347 := coalesce($491, 1)", "$348 := coalesce($492, 0)", "$349 := coalesce($492, 1)" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347, $348, $349, $490, $493, $494, $495", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022172949002217295, "waitRatioMax": 0.0022172949002217295, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.04656319290465632, "writeRatioMax": 0.04656319290465632 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.011086474501108648, "computeRatioMax": 0.011086474501108648, "endMs": "1665777828531", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777828492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $892, $893, $894, $891, $890", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := coalesce($900, '')", "$331 := coalesce($900, '0')", "$332 := coalesce($901, '')", "$333 := coalesce($901, '0')", "$334 := coalesce($902, '')", "$335 := coalesce($902, '0')", "$336 := coalesce($903, 0)", "$337 := coalesce($903, 1)", "$338 := coalesce($904, 0)", "$339 := coalesce($904, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891, $902 := $892, $903 := $893, $904 := $894", "$450 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004434589800443459, "waitRatioMax": 0.004434589800443459, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.07317073170731707, "writeRatioMax": 0.07317073170731707 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.019955654101995565, "computeRatioMax": 0.03991130820399113, "endMs": "1665777828589", "id": "29", "inputStages": [ "23" ], "name": "S1D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4407", "startMs": "1665777828515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage17_output" ] } ], "waitMsAvg": "8", "waitMsMax": "12", "waitRatioAvg": 0.017738359201773836, "waitRatioMax": 0.026607538802660754, "writeMsAvg": "19", "writeMsMax": "31", "writeRatioAvg": 0.04212860310421286, "writeRatioMax": 0.06873614190687362 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "25", "computeRatioAvg": 0.026607538802660754, "computeRatioMax": 0.05543237250554324, "endMs": "1665777828607", "id": "30", "inputStages": [ "29", "16" ], "name": "S1E: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4047", "startMs": "1665777828532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$380, $1170, $1171, $1172, $1173, $1174, $1175", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $400", "FROM __stage1D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($153, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$200 := RANK() OVER (PARTITION BY $1144, $1143, $1140 ORDER BY $1141 ASC, $1142 ASC)" ] }, { "kind": "SORT", "substeps": [ "$374 ASC, $373 ASC, $370 ASC, $371 ASC, $372 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $390, $1221 := $393, $1222 := $394, $1223 := $395, $1224 := $400", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291, $282 = $292, $283 = $293, $284 = $294, $285 = $295, $286 = $296, $287 = $297, $288 = $298, $289 = $299" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := coalesce($394, '')", "$281 := coalesce($394, '0')", "$282 := coalesce($393, '')", "$283 := coalesce($393, '0')", "$284 := coalesce($390, '')", "$285 := coalesce($390, '0')", "$286 := coalesce($391, 0)", "$287 := coalesce($391, 1)", "$288 := coalesce($392, 0)", "$289 := coalesce($392, 1)" ] }, { "kind": "WRITE", "substeps": [ "$120, $150, $151, $152, $154", "TO __stage1E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.0066518847006651885, "waitRatioMax": 0.015521064301552107, "writeMsAvg": "11", "writeMsMax": "30", "writeRatioAvg": 0.024390243902439025, "writeRatioMax": 0.06651884700665188 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.019955654101995565, "computeRatioMax": 0.04212860310421286, "endMs": "1665777828620", "id": "31", "inputStages": [ "26" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4234", "startMs": "1665777828535", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.008869179600886918, "waitRatioMax": 0.013303769401330377, "writeMsAvg": "20", "writeMsMax": "40", "writeRatioAvg": 0.04434589800443459, "writeRatioMax": 0.08869179600886919 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "27", "computeRatioAvg": 0.026607538802660754, "computeRatioMax": 0.0598669623059867, "endMs": "1665777828620", "id": "32", "inputStages": [ "17", "31" ], "name": "S20: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3275", "startMs": "1665777828555", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$972, $971, $970, $973, $974, $260", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$600, $1042, $1043, $1044, $1041, $1040", "FROM __SHUFFLE12" ] }, { "kind": "READ", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347, $348, $349, $490, $493, $494, $495", "FROM __stage1F_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := add($193, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $984, $983, $980 ORDER BY $981 ASC, $982 ASC)" ] }, { "kind": "SORT", "substeps": [ "$474 ASC, $473 ASC, $470 ASC, $471 ASC, $472 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1064 := $500, $1060 := $490, $1061 := $493, $1062 := $494, $1063 := $495", "INNER HASH JOIN EACH WITH ALL ON $350 = $340, $351 = $341, $352 = $342, $353 = $343, $354 = $344, $355 = $345, $356 = $346, $357 = $347, $358 = $348, $359 = $349" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($1050, '')", "$351 := coalesce($1050, '0')", "$352 := coalesce($1051, '')", "$353 := coalesce($1051, '0')", "$354 := coalesce($1052, '')", "$355 := coalesce($1052, '0')", "$356 := coalesce($1053, 0)", "$357 := coalesce($1053, 1)", "$358 := coalesce($1054, 0)", "$359 := coalesce($1054, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044", "$500 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$130, $190, $191, $192, $194", "TO __stage20_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.0066518847006651885, "waitRatioMax": 0.015521064301552107, "writeMsAvg": "12", "writeMsMax": "21", "writeRatioAvg": 0.026607538802660754, "writeRatioMax": 0.04656319290465632 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.017738359201773836, "computeRatioMax": 0.031042128603104215, "endMs": "1665777828638", "id": "33", "inputStages": [ "27" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3456", "startMs": "1665777828557", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.013303769401330377, "waitRatioMax": 0.015521064301552107, "writeMsAvg": "11", "writeMsMax": "24", "writeRatioAvg": 0.024390243902439025, "writeRatioMax": 0.05321507760532151 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.022172949002217297, "computeRatioMax": 0.03991130820399113, "endMs": "1665777828720", "id": "35", "inputStages": [ "32" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4139", "startMs": "1665777828648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage20_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.011086474501108648, "waitRatioMax": 0.013303769401330377, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.03325942350332594, "writeRatioMax": 0.06430155210643015 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "22", "computeRatioAvg": 0.022172949002217297, "computeRatioMax": 0.04878048780487805, "endMs": "1665777828723", "id": "36", "inputStages": [ "30" ], "name": "S24: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3694", "startMs": "1665777828650", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1E_output" ] } ], "waitMsAvg": "9", "waitMsMax": "12", "waitRatioAvg": 0.019955654101995565, "waitRatioMax": 0.026607538802660754, "writeMsAvg": "5", "writeMsMax": "16", "writeRatioAvg": 0.011086474501108648, "writeRatioMax": 0.03547671840354767 }, { "completedParallelInputs": "101", "computeMsAvg": "77", "computeMsMax": "118", "computeRatioAvg": 0.17073170731707318, "computeRatioMax": 0.2616407982261641, "endMs": "1665777828779", "id": "37", "inputStages": [ "33", "35", "22", "36" ], "name": "S25: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6469575", "recordsWritten": "10000", "shuffleOutputBytes": "1267356", "shuffleOutputBytesSpilled": "0", "slotMs": "10857", "startMs": "1665777828667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$430, $860, $861, $862, $863, $864, $865, $866", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$130, $190, $191, $192, $194", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$120, $150, $151, $152, $154", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1230 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1070, $1231 := $1071, $1232 := $1072, $1233 := $1073, $1234 := $1075, $1235 := $1076, $1236 := $1077, $1237 := $154", "INNER HASH JOIN EACH WITH ALL ON $1073 = $152, $1072 = $151, $1070 = $150, $1074 = $120" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $170, $1071 := $171, $1072 := $172, $1073 := $173, $1074 := $174, $1075 := $175, $1076 := $176, $1077 := $194", "INNER HASH JOIN EACH WITH ALL ON $173 = $192, $172 = $191, $170 = $190, $174 = $130" ] }, { "kind": "FILTER", "substeps": [ "and(equal($171, 1999), greater($175, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $834, $833, $830 ORDER BY $831 ASC, $832 ASC)" ] }, { "kind": "SORT", "substeps": [ "$424 ASC, $423 ASC, $420 ASC, $421 ASC, $422 ASC" ] }, { "kind": "JOIN", "substeps": [ "$910 := $440, $911 := $441, $912 := $443, $913 := $444, $914 := $445, $915 := $446, $916 := $450", "INNER HASH JOIN EACH WITH ALL ON $320 = $330, $321 = $331, $322 = $332, $323 = $333, $324 = $334, $325 = $335, $326 = $336, $327 = $337, $328 = $338, $329 = $339" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := coalesce($444, '')", "$321 := coalesce($444, '0')", "$322 := coalesce($443, '')", "$323 := coalesce($443, '0')", "$324 := coalesce($440, '')", "$325 := coalesce($440, '0')", "$326 := coalesce($441, 0)", "$327 := coalesce($441, 1)", "$328 := coalesce($442, 0)", "$329 := coalesce($442, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "TO __stage25_output" ] } ], "waitMsAvg": "12", "waitMsMax": "13", "waitRatioAvg": 0.026607538802660754, "waitRatioMax": 0.028824833702882482, "writeMsAvg": "3", "writeMsMax": "34", "writeRatioAvg": 0.0066518847006651885, "writeRatioMax": 0.07538802660753881 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03325942350332594, "computeRatioMax": 0.03325942350332594, "endMs": "1665777828791", "id": "38", "inputStages": [ "37" ], "name": "S26: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "12840", "shuffleOutputBytesSpilled": "0", "slotMs": "291", "startMs": "1665777828684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "FROM __stage25_output" ] }, { "kind": "SORT", "substeps": [ "$1241 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1250, $1251, $1252, $1253, $1254, $1255, $1256, $1257", "TO __stage26_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.011086474501108648, "waitRatioMax": 0.011086474501108648, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0066518847006651885, "writeRatioMax": 0.0066518847006651885 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "10", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "4042" }, { "activeUnits": "1", "completedUnits": "1036", "elapsedMs": "1742", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "62415" } ], "totalBytesBilled": "60817408", "totalBytesProcessed": "59801163", "totalPartitionsProcessed": "0", "totalSlotMs": "62415", "transferredBytes": "0" }, "startTime": "1665777827153", "totalBytesProcessed": "59801163", "totalSlotMs": "62415" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5aaa17e2_1ea2_4538_9494_5d623eb7b320" }, "priority": "INTERACTIVE", "query": "with v1 as(\n select i_category, i_brand,\n cc_name,\n d_year, d_moy,\n sum(cs_sales_price) sum_sales,\n avg(sum(cs_sales_price)) over\n (partition by i_category, i_brand,\n cc_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n cc_name\n order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n cs_sold_date_sk = d_date_sk and\n cc_call_center_sk= cs_call_center_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n cc_name , d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.cc_name\n ,v1.d_year\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1. cc_name = v1_lag. cc_name and\n v1. cc_name = v1_lead. cc_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and\n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by cc_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "cTeukpOdiEokyMxPbx4IWg==", "id": "test-project-364309:europe-west1.query57_1665777830", "jobReference": { "jobId": "query57_1665777830", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query57_1665777830?location=europe-west1", "statistics": { "creationTime": "1665777831148", "endTime": "1665777832624", "finalExecutionDurationMs": "1214", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "59801163", "performanceInsights": { "avgPreviousExecutionMs": "1256" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.021739130434782608, "endMs": "1665777831354", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014492753623188406, "readRatioMax": 0.014492753623188406, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777831321", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:cc_call_center_sk, $81:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.04830917874396135, "computeRatioMax": 0.04830917874396135, "endMs": "1665777831377", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.021739130434782608, "readRatioMax": 0.021739130434782608, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777831335", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.03864734299516908, "computeRatioMax": 0.03864734299516908, "endMs": "1665777831420", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014492753623188406, "readRatioMax": 0.014492753623188406, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777831378", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "20", "waitMsMax": "20", "waitRatioAvg": 0.04830917874396135, "waitRatioMax": 0.04830917874396135, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.06038647342995169, "writeRatioMax": 0.06038647342995169 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.028985507246376812, "computeRatioMax": 0.028985507246376812, "endMs": "1665777831456", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.01932367149758454, "readRatioMax": 0.01932367149758454, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777831421", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cc_call_center_sk, $11:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage04_output" ] } ], "waitMsAvg": "45", "waitMsMax": "45", "waitRatioAvg": 0.10869565217391304, "waitRatioMax": 0.10869565217391304, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.016908212560386472, "writeRatioMax": 0.016908212560386472 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.03864734299516908, "computeRatioMax": 0.03864734299516908, "endMs": "1665777831486", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016908212560386472, "readRatioMax": 0.016908212560386472, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777831457", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "64", "waitMsMax": "64", "waitRatioAvg": 0.15458937198067632, "waitRatioMax": 0.15458937198067632, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.028985507246376812, "writeRatioMax": 0.028985507246376812 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.03864734299516908, "computeRatioMax": 0.03864734299516908, "endMs": "1665777831530", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.012077294685990338, "readRatioMax": 0.012077294685990338, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777831487", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "62", "waitMsMax": "62", "waitRatioAvg": 0.1497584541062802, "waitRatioMax": 0.1497584541062802, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.06521739130434782, "writeRatioMax": 0.06521739130434782 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.028985507246376812, "computeRatioMax": 0.028985507246376812, "endMs": "1665777831517", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014492753623188406, "readRatioMax": 0.014492753623188406, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777831487", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cc_call_center_sk, $2:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "50", "waitMsMax": "50", "waitRatioAvg": 0.12077294685990338, "waitRatioMax": 0.12077294685990338, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03864734299516908, "writeRatioMax": 0.03864734299516908 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.04830917874396135, "computeRatioMax": 0.04830917874396135, "endMs": "1665777831534", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.021739130434782608, "readRatioMax": 0.021739130434782608, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777831488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "35", "waitMsMax": "35", "waitRatioAvg": 0.08454106280193237, "waitRatioMax": 0.08454106280193237, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.024154589371980676, "writeRatioMax": 0.024154589371980676 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.05314009661835749, "computeRatioMax": 0.05314009661835749, "endMs": "1665777831544", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014492753623188406, "readRatioMax": 0.014492753623188406, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777831487", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05314009661835749, "writeRatioMax": 0.05314009661835749 }, { "completedParallelInputs": "5", "computeMsAvg": "303", "computeMsMax": "414", "computeRatioAvg": 0.7318840579710145, "computeRatioMax": 1, "endMs": "1665777831747", "id": "12", "inputStages": [ "1", "0", "3" ], "name": "S0C: Join+", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "20", "readRatioAvg": 0.036231884057971016, "readRatioMax": 0.04830917874396135, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1589", "startMs": "1665777831488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $741, $751 := $740, $752 := $745, $753 := $743, $754 := $744", "$620 := SUM($742)" ] }, { "kind": "JOIN", "substeps": [ "$740 := $730, $741 := $731, $742 := $733, $743 := $734, $744 := $735, $745 := $81", "INNER HASH JOIN EACH WITH ALL ON $732 = $80" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $713, $733 := $714, $734 := $111, $735 := $112", "INNER HASH JOIN EACH WITH ALL ON $712 = $110" ] }, { "kind": "JOIN", "substeps": [ "$712 := $100, $713 := $101, $714 := $103, $710 := $91, $711 := $92", "INNER HASH JOIN EACH WITH ALL ON $102 = $90" ] }, { "kind": "WRITE", "substeps": [ "$752, $751, $750, $753, $754, $620", "TO __stage0C_output", "BY HASH($750, $751, $752, $753, $754)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.014492753623188406, "writeRatioMax": 0.016908212560386472 }, { "completedParallelInputs": "5", "computeMsAvg": "284", "computeMsMax": "360", "computeRatioAvg": 0.6859903381642513, "computeRatioMax": 0.8695652173913043, "endMs": "1665777831762", "id": "13", "inputStages": [ "7", "5", "4" ], "name": "S0D: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "21", "readRatioAvg": 0.033816425120772944, "readRatioMax": 0.050724637681159424, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1362", "startMs": "1665777831548", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $951, $961 := $950, $962 := $955, $963 := $953, $964 := $954", "$460 := SUM($952)" ] }, { "kind": "JOIN", "substeps": [ "$950 := $940, $951 := $941, $952 := $943, $953 := $944, $954 := $945, $955 := $11", "INNER HASH JOIN EACH WITH ALL ON $942 = $10" ] }, { "kind": "JOIN", "substeps": [ "$940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $71, $945 := $72", "INNER HASH JOIN EACH WITH ALL ON $922 = $70" ] }, { "kind": "JOIN", "substeps": [ "$922 := $60, $923 := $61, $924 := $63, $920 := $51, $921 := $52", "INNER HASH JOIN EACH WITH ALL ON $62 = $50" ] }, { "kind": "WRITE", "substeps": [ "$962, $961, $960, $963, $964, $460", "TO __stage0D_output", "BY HASH($960, $961, $962, $963, $964)" ] } ], "waitMsAvg": "1", "waitMsMax": "5", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.012077294685990338, "writeMsAvg": "17", "writeMsMax": "22", "writeRatioAvg": 0.04106280193236715, "writeRatioMax": 0.05314009661835749 }, { "completedParallelInputs": "5", "computeMsAvg": "285", "computeMsMax": "381", "computeRatioAvg": 0.6884057971014492, "computeRatioMax": 0.9202898550724637, "endMs": "1665777831800", "id": "14", "inputStages": [ "9", "8", "11" ], "name": "S0E: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.033816425120772944, "readRatioMax": 0.04589371980676329, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1266", "startMs": "1665777831568", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1111, $1121 := $1110, $1122 := $1115, $1123 := $1113, $1124 := $1114", "$360 := SUM($1112)" ] }, { "kind": "JOIN", "substeps": [ "$1110 := $1100, $1111 := $1101, $1112 := $1103, $1113 := $1104, $1114 := $1105, $1115 := $2", "INNER HASH JOIN EACH WITH ALL ON $1102 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1080, $1101 := $1081, $1102 := $1083, $1103 := $1084, $1104 := $41, $1105 := $42", "INNER HASH JOIN EACH WITH ALL ON $1082 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1082 := $30, $1083 := $31, $1084 := $33, $1080 := $21, $1081 := $22", "INNER HASH JOIN EACH WITH ALL ON $32 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "TO __stage0E_output", "BY HASH($1120, $1121, $1122, $1123, $1124)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "20", "writeMsMax": "22", "writeRatioAvg": 0.04830917874396135, "writeRatioMax": 0.05314009661835749 }, { "completedParallelInputs": "1", "computeMsAvg": "201", "computeMsMax": "201", "computeRatioAvg": 0.4855072463768116, "computeRatioMax": 0.4855072463768116, "endMs": "1665777831880", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "178", "startMs": "1665777831762", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$752, $751, $750, $753, $754, $620", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $760 := $750, $761 := $751, $762 := $752, $763 := $753, $764 := $754", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$762, $761, $760, $763, $764, $510", "TO __stage0F_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.04106280193236715, "writeRatioMax": 0.04106280193236715 }, { "completedParallelInputs": "1", "computeMsAvg": "186", "computeMsMax": "186", "computeRatioAvg": 0.4492753623188406, "computeRatioMax": 0.4492753623188406, "endMs": "1665777831911", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "212", "startMs": "1665777831785", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$962, $961, $960, $963, $964, $460", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960, $971 := $961, $972 := $962, $973 := $963, $974 := $964", "$260 := SUM($460)" ] }, { "kind": "WRITE", "substeps": [ "$972, $971, $970, $973, $974, $260", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.050724637681159424, "writeRatioMax": 0.050724637681159424 }, { "completedParallelInputs": "1", "computeMsAvg": "157", "computeMsMax": "157", "computeRatioAvg": 0.37922705314009664, "computeRatioMax": 0.37922705314009664, "endMs": "1665777831921", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "150", "startMs": "1665777831820", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124", "$230 := SUM($360)" ] }, { "kind": "WRITE", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01932367149758454, "computeRatioMax": 0.01932367149758454, "endMs": "1665777831943", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777831914", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $800, $801, $802, $803", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($810, '')", "$561 := coalesce($810, '0')", "$562 := coalesce($811, 0)", "$563 := coalesce($811, 1)", "$564 := coalesce($812, '')", "$565 := coalesce($812, '0')", "$566 := coalesce($813, '')", "$567 := coalesce($813, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800, $811 := $801, $812 := $802, $813 := $803", "$660 := ROOT_AVG($690)" ] }, { "kind": "WRITE", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.050724637681159424, "writeRatioMax": 0.050724637681159424 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.01932367149758454, "computeRatioMax": 0.03864734299516908, "endMs": "1665777832007", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4183", "startMs": "1665777831946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "33", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.07971014492753623, "writeMsAvg": "15", "writeMsMax": "22", "writeRatioAvg": 0.036231884057971016, "writeRatioMax": 0.05314009661835749 }, { "completedParallelInputs": "101", "computeMsAvg": "11", "computeMsMax": "20", "computeRatioAvg": 0.026570048309178744, "computeRatioMax": 0.04830917874396135, "endMs": "1665777832037", "id": "21", "inputStages": [ "20", "15" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32775", "shuffleOutputBytes": "3310098", "shuffleOutputBytesSpilled": "0", "slotMs": "4056", "startMs": "1665777831979", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$762, $761, $760, $763, $764, $510", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$640, $641, $642, $643, $644, $645", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$410 := AVG($775) OVER (PARTITION BY $774, $773, $770, $771 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$634 ASC, $633 ASC, $630 ASC, $631 ASC" ] }, { "kind": "JOIN", "substeps": [ "$820 := $650, $821 := $651, $822 := $652, $823 := $653, $824 := $654, $825 := $655, $826 := $660", "INNER HASH JOIN EACH WITH ALL ON $550 = $560, $551 = $561, $552 = $562, $553 = $563, $554 = $564, $555 = $565, $556 = $566, $557 = $567" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := coalesce($650, '')", "$551 := coalesce($650, '0')", "$552 := coalesce($651, 0)", "$553 := coalesce($651, 1)", "$554 := coalesce($653, '')", "$555 := coalesce($653, '0')", "$556 := coalesce($654, '')", "$557 := coalesce($654, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "TO __stage15_output" ] } ], "waitMsAvg": "22", "waitMsMax": "25", "waitRatioAvg": 0.05314009661835749, "waitRatioMax": 0.06038647342995169, "writeMsAvg": "24", "writeMsMax": "31", "writeRatioAvg": 0.057971014492753624, "writeRatioMax": 0.0748792270531401 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.014492753623188406, "computeRatioMax": 0.014492753623188406, "endMs": "1665777832193", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777832159", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$540, $1202, $1203, $1204, $1201, $1200", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($1210, '')", "$291 := coalesce($1210, '0')", "$292 := coalesce($1211, '')", "$293 := coalesce($1211, '0')", "$294 := coalesce($1212, '')", "$295 := coalesce($1212, '0')", "$296 := coalesce($1213, 0)", "$297 := coalesce($1213, 1)", "$298 := coalesce($1214, 0)", "$299 := coalesce($1214, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204", "$400 := MIN($540)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $400", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.021739130434782608, "endMs": "1665777832224", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777832188", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1042, $1043, $1044, $1041, $1040", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($1050, '')", "$351 := coalesce($1050, '0')", "$352 := coalesce($1051, '')", "$353 := coalesce($1051, '0')", "$354 := coalesce($1052, '')", "$355 := coalesce($1052, '0')", "$356 := coalesce($1053, 0)", "$357 := coalesce($1053, 1)", "$358 := coalesce($1054, 0)", "$359 := coalesce($1054, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044", "$500 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016908212560386472, "computeRatioMax": 0.016908212560386472, "endMs": "1665777832255", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777832218", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $892, $893, $894, $891, $890", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := coalesce($900, '')", "$331 := coalesce($900, '0')", "$332 := coalesce($901, '')", "$333 := coalesce($901, '0')", "$334 := coalesce($902, '')", "$335 := coalesce($902, '0')", "$336 := coalesce($903, 0)", "$337 := coalesce($903, 1)", "$338 := coalesce($904, 0)", "$339 := coalesce($904, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891, $902 := $892, $903 := $893, $904 := $894", "$450 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0024154589371980675, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.04106280193236715, "writeRatioMax": 0.04106280193236715 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.01932367149758454, "computeRatioMax": 0.036231884057971016, "endMs": "1665777832299", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3707", "startMs": "1665777832234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.007246376811594203, "waitRatioMax": 0.00966183574879227, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.033816425120772944, "writeRatioMax": 0.04589371980676329 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "26", "computeRatioAvg": 0.028985507246376812, "computeRatioMax": 0.06280193236714976, "endMs": "1665777832296", "id": "29", "inputStages": [ "17", "28" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4042", "startMs": "1665777832245", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$380, $1170, $1171, $1172, $1173, $1174, $1175", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $400", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($153, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$200 := RANK() OVER (PARTITION BY $1144, $1143, $1140 ORDER BY $1141 ASC, $1142 ASC)" ] }, { "kind": "SORT", "substeps": [ "$374 ASC, $373 ASC, $370 ASC, $371 ASC, $372 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $390, $1221 := $393, $1222 := $394, $1223 := $395, $1224 := $400", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291, $282 = $292, $283 = $293, $284 = $294, $285 = $295, $286 = $296, $287 = $297, $288 = $298, $289 = $299" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := coalesce($394, '')", "$281 := coalesce($394, '0')", "$282 := coalesce($393, '')", "$283 := coalesce($393, '0')", "$284 := coalesce($390, '')", "$285 := coalesce($390, '0')", "$286 := coalesce($391, 0)", "$287 := coalesce($391, 1)", "$288 := coalesce($392, 0)", "$289 := coalesce($392, 1)" ] }, { "kind": "WRITE", "substeps": [ "$120, $150, $151, $152, $154", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.00966183574879227, "writeMsAvg": "13", "writeMsMax": "24", "writeRatioAvg": 0.03140096618357488, "writeRatioMax": 0.057971014492753624 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.01932367149758454, "computeRatioMax": 0.03864734299516908, "endMs": "1665777832299", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3245", "startMs": "1665777832245", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "8", "waitRatioAvg": 0.007246376811594203, "waitRatioMax": 0.01932367149758454, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.03140096618357488, "writeRatioMax": 0.04589371980676329 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "21", "computeRatioAvg": 0.028985507246376812, "computeRatioMax": 0.050724637681159424, "endMs": "1665777832328", "id": "31", "inputStages": [ "30", "16" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "5282", "startMs": "1665777832261", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$972, $971, $970, $973, $974, $260", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$480, $1010, $1011, $1012, $1013, $1014, $1015", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := add($193, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $984, $983, $980 ORDER BY $981 ASC, $982 ASC)" ] }, { "kind": "SORT", "substeps": [ "$474 ASC, $473 ASC, $470 ASC, $471 ASC, $472 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $490, $1061 := $493, $1062 := $494, $1063 := $495, $1064 := $500", "INNER HASH JOIN EACH WITH ALL ON $340 = $350, $341 = $351, $342 = $352, $343 = $353, $344 = $354, $345 = $355, $346 = $356, $347 = $357, $348 = $358, $349 = $359" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($494, '')", "$341 := coalesce($494, '0')", "$342 := coalesce($493, '')", "$343 := coalesce($493, '0')", "$344 := coalesce($490, '')", "$345 := coalesce($490, '0')", "$346 := coalesce($491, 0)", "$347 := coalesce($491, 1)", "$348 := coalesce($492, 0)", "$349 := coalesce($492, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $190, $191, $192, $194", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.007246376811594203, "writeMsAvg": "33", "writeMsMax": "55", "writeRatioAvg": 0.07971014492753623, "writeRatioMax": 0.13285024154589373 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.043478260869565216, "endMs": "1665777832327", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3733", "startMs": "1665777832267", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "18", "writeMsMax": "31", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.0748792270531401 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.04106280193236715, "endMs": "1665777832397", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4179", "startMs": "1665777832340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "9", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.021739130434782608, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.03864734299516908, "writeRatioMax": 0.07246376811594203 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.01932367149758454, "computeRatioMax": 0.043478260869565216, "endMs": "1665777832396", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3588", "startMs": "1665777832340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.01932367149758454, "waitRatioMax": 0.024154589371980676, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.033816425120772944, "writeRatioMax": 0.07004830917874397 }, { "completedParallelInputs": "101", "computeMsAvg": "71", "computeMsMax": "120", "computeRatioAvg": 0.17149758454106281, "computeRatioMax": 0.2898550724637681, "endMs": "1665777832467", "id": "36", "inputStages": [ "34", "21", "35", "32" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6469575", "recordsWritten": "10000", "shuffleOutputBytes": "1267356", "shuffleOutputBytesSpilled": "0", "slotMs": "10630", "startMs": "1665777832354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$430, $860, $861, $862, $863, $864, $865, $866", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$130, $190, $191, $192, $194", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$120, $150, $151, $152, $154", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$1230 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1070, $1231 := $1071, $1232 := $1072, $1233 := $1073, $1234 := $1075, $1235 := $1076, $1236 := $1077, $1237 := $154", "INNER HASH JOIN EACH WITH ALL ON $1073 = $152, $1072 = $151, $1070 = $150, $1074 = $120" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $170, $1071 := $171, $1072 := $172, $1073 := $173, $1074 := $174, $1075 := $175, $1076 := $176, $1077 := $194", "INNER HASH JOIN EACH WITH ALL ON $173 = $192, $172 = $191, $170 = $190, $174 = $130" ] }, { "kind": "FILTER", "substeps": [ "and(equal($171, 1999), greater($175, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $834, $833, $830 ORDER BY $831 ASC, $832 ASC)" ] }, { "kind": "SORT", "substeps": [ "$424 ASC, $423 ASC, $420 ASC, $421 ASC, $422 ASC" ] }, { "kind": "JOIN", "substeps": [ "$910 := $440, $911 := $441, $912 := $443, $913 := $444, $914 := $445, $915 := $446, $916 := $450", "INNER HASH JOIN EACH WITH ALL ON $320 = $330, $321 = $331, $322 = $332, $323 = $333, $324 = $334, $325 = $335, $326 = $336, $327 = $337, $328 = $338, $329 = $339" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := coalesce($444, '')", "$321 := coalesce($444, '0')", "$322 := coalesce($443, '')", "$323 := coalesce($443, '0')", "$324 := coalesce($440, '')", "$325 := coalesce($440, '0')", "$326 := coalesce($441, 0)", "$327 := coalesce($441, 1)", "$328 := coalesce($442, 0)", "$329 := coalesce($442, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "TO __stage24_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.021739130434782608, "waitRatioMax": 0.024154589371980676, "writeMsAvg": "2", "writeMsMax": "20", "writeRatioAvg": 0.004830917874396135, "writeRatioMax": 0.04830917874396135 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.033816425120772944, "computeRatioMax": 0.033816425120772944, "endMs": "1665777832478", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "12601", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665777832359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1241 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1250, $1251, $1252, $1253, $1254, $1255, $1256, $1257", "TO __stage25_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.01932367149758454, "waitRatioMax": 0.01932367149758454, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.00966183574879227, "writeRatioMax": 0.00966183574879227 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "24", "elapsedMs": "629", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "4642" }, { "activeUnits": "233", "completedUnits": "1036", "elapsedMs": "1375", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "55983" } ], "totalBytesBilled": "60817408", "totalBytesProcessed": "59801163", "totalPartitionsProcessed": "0", "totalSlotMs": "55983", "transferredBytes": "0" }, "startTime": "1665777831194", "totalBytesProcessed": "59801163", "totalSlotMs": "55983" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncffda69f_e53f_4255_886a_e1001c55593d" }, "priority": "INTERACTIVE", "query": "with v1 as(\n select i_category, i_brand,\n cc_name,\n d_year, d_moy,\n sum(cs_sales_price) sum_sales,\n avg(sum(cs_sales_price)) over\n (partition by i_category, i_brand,\n cc_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n cc_name\n order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n cs_sold_date_sk = d_date_sk and\n cc_call_center_sk= cs_call_center_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n cc_name , d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.cc_name\n ,v1.d_year\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1. cc_name = v1_lag. cc_name and\n v1. cc_name = v1_lead. cc_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and\n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by cc_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "jIb1vuAeomNhhitkxEfsPw==", "id": "test-project-364309:europe-west1.query57_1665777834", "jobReference": { "jobId": "query57_1665777834", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query57_1665777834?location=europe-west1", "statistics": { "creationTime": "1665777835288", "endTime": "1665777836732", "finalExecutionDurationMs": "1190", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "59801163", "performanceInsights": { "avgPreviousExecutionMs": "1250" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.018779342723004695, "computeRatioMax": 0.018779342723004695, "endMs": "1665777835495", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014084507042253521, "readRatioMax": 0.014084507042253521, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777835465", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:cc_call_center_sk, $81:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.03990610328638498, "writeRatioMax": 0.03990610328638498 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.04929577464788732, "computeRatioMax": 0.04929577464788732, "endMs": "1665777835521", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.035211267605633804, "readRatioMax": 0.035211267605633804, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777835481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02112676056338028, "writeRatioMax": 0.02112676056338028 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.05868544600938967, "computeRatioMax": 0.05868544600938967, "endMs": "1665777835574", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014084507042253521, "readRatioMax": 0.014084507042253521, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777835522", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.03286384976525822, "waitRatioMax": 0.03286384976525822, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.06572769953051644, "writeRatioMax": 0.06572769953051644 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03051643192488263, "computeRatioMax": 0.03051643192488263, "endMs": "1665777835629", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.018779342723004695, "readRatioMax": 0.018779342723004695, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777835574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cc_call_center_sk, $11:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage04_output" ] } ], "waitMsAvg": "52", "waitMsMax": "52", "waitRatioAvg": 0.12206572769953052, "waitRatioMax": 0.12206572769953052, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.051643192488262914, "writeRatioMax": 0.051643192488262914 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.0539906103286385, "computeRatioMax": 0.0539906103286385, "endMs": "1665777835678", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01643192488262911, "readRatioMax": 0.01643192488262911, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777835630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "93", "waitMsMax": "93", "waitRatioAvg": 0.21830985915492956, "waitRatioMax": 0.21830985915492956, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.025821596244131457, "writeRatioMax": 0.025821596244131457 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04460093896713615, "computeRatioMax": 0.04460093896713615, "endMs": "1665777835683", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01643192488262911, "readRatioMax": 0.01643192488262911, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777835633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "66", "waitMsMax": "66", "waitRatioAvg": 0.15492957746478872, "waitRatioMax": 0.15492957746478872, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.06807511737089202, "writeRatioMax": 0.06807511737089202 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.028169014084507043, "endMs": "1665777835674", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011737089201877934, "readRatioMax": 0.011737089201877934, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "155", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777835633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cc_call_center_sk, $2:cc_name", "FROM call_center" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "49", "waitMsMax": "49", "waitRatioAvg": 0.11502347417840375, "waitRatioMax": 0.11502347417840375, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.035211267605633804, "writeRatioMax": 0.035211267605633804 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.046948356807511735, "computeRatioMax": 0.046948356807511735, "endMs": "1665777835678", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.018779342723004695, "readRatioMax": 0.018779342723004695, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777835634", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "33", "waitMsMax": "33", "waitRatioAvg": 0.07746478873239436, "waitRatioMax": 0.07746478873239436, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02112676056338028, "writeRatioMax": 0.02112676056338028 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04460093896713615, "computeRatioMax": 0.04460093896713615, "endMs": "1665777835681", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.028169014084507043, "readRatioMax": 0.028169014084507043, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777835633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.051643192488262914, "writeRatioMax": 0.051643192488262914 }, { "completedParallelInputs": "5", "computeMsAvg": "293", "computeMsMax": "359", "computeRatioAvg": 0.687793427230047, "computeRatioMax": 0.8427230046948356, "endMs": "1665777835834", "id": "12", "inputStages": [ "3", "1", "0" ], "name": "S0C: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "14", "readRatioAvg": 0.028169014084507043, "readRatioMax": 0.03286384976525822, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1317", "startMs": "1665777835636", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $741, $751 := $740, $752 := $745, $753 := $743, $754 := $744", "$620 := SUM($742)" ] }, { "kind": "JOIN", "substeps": [ "$740 := $730, $741 := $731, $742 := $733, $743 := $734, $744 := $735, $745 := $81", "INNER HASH JOIN EACH WITH ALL ON $732 = $80" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $713, $733 := $714, $734 := $111, $735 := $112", "INNER HASH JOIN EACH WITH ALL ON $712 = $110" ] }, { "kind": "JOIN", "substeps": [ "$712 := $100, $713 := $101, $714 := $103, $710 := $91, $711 := $92", "INNER HASH JOIN EACH WITH ALL ON $102 = $90" ] }, { "kind": "WRITE", "substeps": [ "$752, $751, $750, $753, $754, $620", "TO __stage0C_output", "BY HASH($750, $751, $752, $753, $754)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.014084507042253521, "writeRatioMax": 0.01643192488262911 }, { "completedParallelInputs": "5", "computeMsAvg": "288", "computeMsMax": "373", "computeRatioAvg": 0.676056338028169, "computeRatioMax": 0.8755868544600939, "endMs": "1665777835921", "id": "13", "inputStages": [ "11", "9", "8" ], "name": "S0D: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "13", "readRatioAvg": 0.028169014084507043, "readRatioMax": 0.03051643192488263, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1384", "startMs": "1665777835702", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1111, $1121 := $1110, $1122 := $1115, $1123 := $1113, $1124 := $1114", "$360 := SUM($1112)" ] }, { "kind": "JOIN", "substeps": [ "$1110 := $1100, $1111 := $1101, $1112 := $1103, $1113 := $1104, $1114 := $1105, $1115 := $2", "INNER HASH JOIN EACH WITH ALL ON $1102 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1080, $1101 := $1081, $1102 := $1083, $1103 := $1084, $1104 := $41, $1105 := $42", "INNER HASH JOIN EACH WITH ALL ON $1082 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1082 := $30, $1083 := $31, $1084 := $33, $1080 := $21, $1081 := $22", "INNER HASH JOIN EACH WITH ALL ON $32 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "TO __stage0D_output", "BY HASH($1120, $1121, $1122, $1123, $1124)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "21", "writeMsMax": "22", "writeRatioAvg": 0.04929577464788732, "writeRatioMax": 0.051643192488262914 }, { "completedParallelInputs": "5", "computeMsAvg": "309", "computeMsMax": "426", "computeRatioAvg": 0.7253521126760564, "computeRatioMax": 1, "endMs": "1665777835926", "id": "14", "inputStages": [ "4", "7", "5" ], "name": "S0E: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "14", "readRatioAvg": 0.028169014084507043, "readRatioMax": 0.03286384976525822, "recordsRead": "1533713", "recordsWritten": "99492", "shuffleOutputBytes": "8317873", "shuffleOutputBytesSpilled": "0", "slotMs": "1477", "startMs": "1665777835717", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $951, $961 := $950, $962 := $955, $963 := $953, $964 := $954", "$460 := SUM($952)" ] }, { "kind": "JOIN", "substeps": [ "$950 := $940, $951 := $941, $952 := $943, $953 := $944, $954 := $945, $955 := $11", "INNER HASH JOIN EACH WITH ALL ON $942 = $10" ] }, { "kind": "JOIN", "substeps": [ "$940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $71, $945 := $72", "INNER HASH JOIN EACH WITH ALL ON $922 = $70" ] }, { "kind": "JOIN", "substeps": [ "$922 := $60, $923 := $61, $924 := $63, $920 := $51, $921 := $52", "INNER HASH JOIN EACH WITH ALL ON $62 = $50" ] }, { "kind": "WRITE", "substeps": [ "$962, $961, $960, $963, $964, $460", "TO __stage0E_output", "BY HASH($960, $961, $962, $963, $964)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "20", "writeMsMax": "22", "writeRatioAvg": 0.046948356807511735, "writeRatioMax": 0.051643192488262914 }, { "completedParallelInputs": "1", "computeMsAvg": "177", "computeMsMax": "177", "computeRatioAvg": 0.4154929577464789, "computeRatioMax": 0.4154929577464789, "endMs": "1665777835979", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "186", "startMs": "1665777835859", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$752, $751, $750, $753, $754, $620", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $760 := $750, $761 := $751, $762 := $752, $763 := $753, $764 := $754", "$510 := SUM($620)" ] }, { "kind": "WRITE", "substeps": [ "$762, $761, $760, $763, $764, $510", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.046948356807511735, "writeRatioMax": 0.046948356807511735 }, { "completedParallelInputs": "1", "computeMsAvg": "142", "computeMsMax": "142", "computeRatioAvg": 0.3333333333333333, "computeRatioMax": 0.3333333333333333, "endMs": "1665777836037", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "140", "startMs": "1665777835943", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1122, $1121, $1120, $1123, $1124, $360", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124", "$230 := SUM($360)" ] }, { "kind": "WRITE", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.04460093896713615, "writeRatioMax": 0.04460093896713615 }, { "completedParallelInputs": "1", "computeMsAvg": "209", "computeMsMax": "209", "computeRatioAvg": 0.49061032863849763, "computeRatioMax": 0.49061032863849763, "endMs": "1665777836091", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "99492", "recordsWritten": "32775", "shuffleOutputBytes": "2752923", "shuffleOutputBytesSpilled": "0", "slotMs": "210", "startMs": "1665777835960", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$962, $961, $960, $963, $964, $460", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960, $971 := $961, $972 := $962, $973 := $963, $974 := $964", "$260 := SUM($460)" ] }, { "kind": "WRITE", "substeps": [ "$972, $971, $970, $973, $974, $260", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.046948356807511735, "writeRatioMax": 0.046948356807511735 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01643192488262911, "computeRatioMax": 0.01643192488262911, "endMs": "1665777836035", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777835998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $800, $801, $802, $803", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$560 := coalesce($810, '')", "$561 := coalesce($810, '0')", "$562 := coalesce($811, 0)", "$563 := coalesce($811, 1)", "$564 := coalesce($812, '')", "$565 := coalesce($812, '0')", "$566 := coalesce($813, '')", "$567 := coalesce($813, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800, $811 := $801, $812 := $802, $813 := $803", "$660 := ROOT_AVG($690)" ] }, { "kind": "WRITE", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.07276995305164319, "writeRatioMax": 0.07276995305164319 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.018779342723004695, "computeRatioMax": 0.03990610328638498, "endMs": "1665777836101", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3617", "startMs": "1665777836047", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.03286384976525822, "writeRatioMax": 0.04460093896713615 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "21", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.04929577464788732, "endMs": "1665777836127", "id": "21", "inputStages": [ "15", "20" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32775", "shuffleOutputBytes": "3310098", "shuffleOutputBytesSpilled": "0", "slotMs": "4841", "startMs": "1665777836068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$762, $761, $760, $763, $764, $510", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$640, $641, $642, $643, $644, $645", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$560, $561, $562, $563, $564, $565, $566, $567, $660", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$410 := AVG($775) OVER (PARTITION BY $774, $773, $770, $771 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$634 ASC, $633 ASC, $630 ASC, $631 ASC" ] }, { "kind": "JOIN", "substeps": [ "$820 := $650, $821 := $651, $822 := $652, $823 := $653, $824 := $654, $825 := $655, $826 := $660", "INNER HASH JOIN EACH WITH ALL ON $550 = $560, $551 = $561, $552 = $562, $553 = $563, $554 = $564, $555 = $565, $556 = $566, $557 = $567" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := coalesce($650, '')", "$551 := coalesce($650, '0')", "$552 := coalesce($651, 0)", "$553 := coalesce($651, 1)", "$554 := coalesce($653, '')", "$555 := coalesce($653, '0')", "$556 := coalesce($654, '')", "$557 := coalesce($654, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "5", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.011737089201877934, "writeMsAvg": "26", "writeMsMax": "31", "writeRatioAvg": 0.06103286384976526, "writeRatioMax": 0.07276995305164319 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02112676056338028, "computeRatioMax": 0.02112676056338028, "endMs": "1665777836288", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777836251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$540, $1202, $1203, $1204, $1201, $1200", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($1210, '')", "$291 := coalesce($1210, '0')", "$292 := coalesce($1211, '')", "$293 := coalesce($1211, '0')", "$294 := coalesce($1212, '')", "$295 := coalesce($1212, '0')", "$296 := coalesce($1213, 0)", "$297 := coalesce($1213, 1)", "$298 := coalesce($1214, 0)", "$299 := coalesce($1214, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204", "$400 := MIN($540)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $400", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.04460093896713615, "writeRatioMax": 0.04460093896713615 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.018779342723004695, "computeRatioMax": 0.018779342723004695, "endMs": "1665777836320", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777836283", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1042, $1043, $1044, $1041, $1040", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($1050, '')", "$351 := coalesce($1050, '0')", "$352 := coalesce($1051, '')", "$353 := coalesce($1051, '0')", "$354 := coalesce($1052, '')", "$355 := coalesce($1052, '0')", "$356 := coalesce($1053, 0)", "$357 := coalesce($1053, 1)", "$358 := coalesce($1054, 0)", "$359 := coalesce($1054, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044", "$500 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04225352112676056, "writeRatioMax": 0.04225352112676056 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01643192488262911, "computeRatioMax": 0.01643192488262911, "endMs": "1665777836356", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777836313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $892, $893, $894, $891, $890", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := coalesce($900, '')", "$331 := coalesce($900, '0')", "$332 := coalesce($901, '')", "$333 := coalesce($901, '0')", "$334 := coalesce($902, '')", "$335 := coalesce($902, '0')", "$336 := coalesce($903, 0)", "$337 := coalesce($903, 1)", "$338 := coalesce($904, 0)", "$339 := coalesce($904, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891, $902 := $892, $903 := $893, $904 := $894", "$450 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.04460093896713615, "writeRatioMax": 0.04460093896713615 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.02112676056338028, "computeRatioMax": 0.04460093896713615, "endMs": "1665777836405", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3809", "startMs": "1665777836332", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.011737089201877934, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.035211267605633804, "writeRatioMax": 0.07276995305164319 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "22", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.051643192488262914, "endMs": "1665777836405", "id": "29", "inputStages": [ "28", "16" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3921", "startMs": "1665777836345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1132, $1131, $1130, $1133, $1134, $230", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$380, $1170, $1171, $1172, $1173, $1174, $1175", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $400", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($153, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$200 := RANK() OVER (PARTITION BY $1144, $1143, $1140 ORDER BY $1141 ASC, $1142 ASC)" ] }, { "kind": "SORT", "substeps": [ "$374 ASC, $373 ASC, $370 ASC, $371 ASC, $372 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $390, $1221 := $393, $1222 := $394, $1223 := $395, $1224 := $400", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291, $282 = $292, $283 = $293, $284 = $294, $285 = $295, $286 = $296, $287 = $297, $288 = $298, $289 = $299" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := coalesce($394, '')", "$281 := coalesce($394, '0')", "$282 := coalesce($393, '')", "$283 := coalesce($393, '0')", "$284 := coalesce($390, '')", "$285 := coalesce($390, '0')", "$286 := coalesce($391, 0)", "$287 := coalesce($391, 1)", "$288 := coalesce($392, 0)", "$289 := coalesce($392, 1)" ] }, { "kind": "WRITE", "substeps": [ "$120, $150, $151, $152, $154", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.011737089201877934, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.03286384976525822, "writeRatioMax": 0.046948356807511735 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.018779342723004695, "computeRatioMax": 0.03755868544600939, "endMs": "1665777836415", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3432", "startMs": "1665777836347", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "5", "waitMsMax": "10", "waitRatioAvg": 0.011737089201877934, "waitRatioMax": 0.023474178403755867, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.035211267605633804, "writeRatioMax": 0.05868544600938967 }, { "completedParallelInputs": "101", "computeMsAvg": "12", "computeMsMax": "21", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.04929577464788732, "endMs": "1665777836427", "id": "31", "inputStages": [ "30", "17" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32775", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4166", "startMs": "1665777836364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$972, $971, $970, $973, $974, $260", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$480, $1010, $1011, $1012, $1013, $1014, $1015", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$350, $351, $352, $353, $354, $355, $356, $357, $358, $359, $500", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := add($193, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $984, $983, $980 ORDER BY $981 ASC, $982 ASC)" ] }, { "kind": "SORT", "substeps": [ "$474 ASC, $473 ASC, $470 ASC, $471 ASC, $472 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $490, $1061 := $493, $1062 := $494, $1063 := $495, $1064 := $500", "INNER HASH JOIN EACH WITH ALL ON $340 = $350, $341 = $351, $342 = $352, $343 = $353, $344 = $354, $345 = $355, $346 = $356, $347 = $357, $348 = $358, $349 = $359" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := coalesce($494, '')", "$341 := coalesce($494, '0')", "$342 := coalesce($493, '')", "$343 := coalesce($493, '0')", "$344 := coalesce($490, '')", "$345 := coalesce($490, '0')", "$346 := coalesce($491, 0)", "$347 := coalesce($491, 1)", "$348 := coalesce($492, 0)", "$349 := coalesce($492, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $190, $191, $192, $194", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004694835680751174, "waitRatioMax": 0.009389671361502348, "writeMsAvg": "22", "writeMsMax": "39", "writeRatioAvg": 0.051643192488262914, "writeRatioMax": 0.09154929577464789 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.018779342723004695, "computeRatioMax": 0.03990610328638498, "endMs": "1665777836422", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3393", "startMs": "1665777836365", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.014084507042253521, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.03051643192488263, "writeRatioMax": 0.046948356807511735 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.018779342723004695, "computeRatioMax": 0.03286384976525822, "endMs": "1665777836502", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "3822", "startMs": "1665777836433", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.014084507042253521, "writeMsAvg": "18", "writeMsMax": "42", "writeRatioAvg": 0.04225352112676056, "writeRatioMax": 0.09859154929577464 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.018779342723004695, "computeRatioMax": 0.03755868544600939, "endMs": "1665777836506", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32184", "recordsWritten": "32184", "shuffleOutputBytes": "2422648", "shuffleOutputBytesSpilled": "0", "slotMs": "4815", "startMs": "1665777836433", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.011737089201877934, "waitRatioMax": 0.014084507042253521, "writeMsAvg": "31", "writeMsMax": "58", "writeRatioAvg": 0.07276995305164319, "writeRatioMax": 0.13615023474178403 }, { "completedParallelInputs": "101", "computeMsAvg": "72", "computeMsMax": "153", "computeRatioAvg": 0.16901408450704225, "computeRatioMax": 0.3591549295774648, "endMs": "1665777836598", "id": "36", "inputStages": [ "34", "35", "32", "21" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6469575", "recordsWritten": "10000", "shuffleOutputBytes": "1267356", "shuffleOutputBytesSpilled": "0", "slotMs": "12349", "startMs": "1665777836447", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$430, $860, $861, $862, $863, $864, $865, $866", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $450", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$130, $190, $191, $192, $194", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$120, $150, $151, $152, $154", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$1230 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$1230 := $1070, $1231 := $1071, $1232 := $1072, $1233 := $1073, $1234 := $1075, $1235 := $1076, $1236 := $1077, $1237 := $154", "INNER HASH JOIN EACH WITH ALL ON $1073 = $152, $1072 = $151, $1070 = $150, $1074 = $120" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $170, $1071 := $171, $1072 := $172, $1073 := $173, $1074 := $174, $1075 := $175, $1076 := $176, $1077 := $194", "INNER HASH JOIN EACH WITH ALL ON $173 = $192, $172 = $191, $170 = $190, $174 = $130" ] }, { "kind": "FILTER", "substeps": [ "and(equal($171, 1999), greater($175, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $834, $833, $830 ORDER BY $831 ASC, $832 ASC)" ] }, { "kind": "SORT", "substeps": [ "$424 ASC, $423 ASC, $420 ASC, $421 ASC, $422 ASC" ] }, { "kind": "JOIN", "substeps": [ "$910 := $440, $911 := $441, $912 := $443, $913 := $444, $914 := $445, $915 := $446, $916 := $450", "INNER HASH JOIN EACH WITH ALL ON $320 = $330, $321 = $331, $322 = $332, $323 = $333, $324 = $334, $325 = $335, $326 = $336, $327 = $337, $328 = $338, $329 = $339" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := coalesce($444, '')", "$321 := coalesce($444, '0')", "$322 := coalesce($443, '')", "$323 := coalesce($443, '0')", "$324 := coalesce($440, '')", "$325 := coalesce($440, '0')", "$326 := coalesce($441, 0)", "$327 := coalesce($441, 1)", "$328 := coalesce($442, 0)", "$329 := coalesce($442, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "TO __stage24_output" ] } ], "waitMsAvg": "7", "waitMsMax": "12", "waitRatioAvg": 0.01643192488262911, "waitRatioMax": 0.028169014084507043, "writeMsAvg": "3", "writeMsMax": "20", "writeRatioAvg": 0.007042253521126761, "writeRatioMax": 0.046948356807511735 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.023474178403755867, "computeRatioMax": 0.023474178403755867, "endMs": "1665777836610", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "12955", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777836460", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1240, $1241, $1242, $1243, $1244, $1245, $1246, $1247", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1241 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1250, $1251, $1252, $1253, $1254, $1255, $1256, $1257", "TO __stage25_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.02112676056338028, "waitRatioMax": 0.02112676056338028, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.009389671361502348, "writeRatioMax": 0.009389671361502348 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "24", "elapsedMs": "637", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "4734" }, { "activeUnits": "236", "completedUnits": "1036", "elapsedMs": "1340", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "57308" } ], "totalBytesBilled": "60817408", "totalBytesProcessed": "59801163", "totalPartitionsProcessed": "0", "totalSlotMs": "57308", "transferredBytes": "0" }, "startTime": "1665777835339", "totalBytesProcessed": "59801163", "totalSlotMs": "57308" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
