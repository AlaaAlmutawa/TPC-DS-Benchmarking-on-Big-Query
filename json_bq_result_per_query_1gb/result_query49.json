{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond9d9092d_f858_4985_9266_bad8d471d4e5" }, "priority": "INTERACTIVE", "query": "select channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(sum(coalesce(wr.wr_return_quantity,0)))/\n \t\tsum(coalesce(ws.ws_quantity,0)) as return_ratio\n \t\t,(sum(coalesce(wr.wr_return_amt,0)))/\n \t\tsum(coalesce(ws.ws_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n and ws.ws_net_paid > 0\n and ws.ws_quantity > 0\n and ws_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union all\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,sum(coalesce(cr.cr_return_quantity,0))/\n \t\tsum(coalesce(cs.cs_quantity,0)) as return_ratio\n \t\t,sum(coalesce(cr.cr_return_amount,0))/\n \t\tsum(coalesce(cs.cs_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n and cs.cs_net_paid > 0\n and cs.cs_quantity > 0\n and cs_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union all\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,sum(coalesce(sr.sr_return_quantity,0))/sum(coalesce(sts.ss_quantity,0)) as return_ratio\n \t\t,sum(coalesce(sr.sr_return_amt,0))/sum(coalesce(sts.ss_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n and sts.ss_net_paid > 0 \n and sts.ss_quantity > 0\n and ss_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n order by 1,4,5,2\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "I1JiMV8L1n6WaXT7H3ofqQ==", "id": "test-project-364309:europe-west1.query49_1665768371", "jobReference": { "jobId": "query49_1665768371", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query49_1665768371?location=europe-west1", "statistics": { "creationTime": "1665768371958", "endTime": "1665768373807", "finalExecutionDurationMs": "1508", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "337676184", "performanceInsights": { "avgPreviousExecutionMs": "1437" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.043859649122807015, "computeRatioMax": 0.043859649122807015, "endMs": "1665768372233", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03216374269005848, "readRatioMax": 0.03216374269005848, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768372198", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(equal($21, 2001), equal($22, 12))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03508771929824561, "writeRatioMax": 0.03508771929824561 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.14035087719298245, "computeRatioMax": 0.14035087719298245, "endMs": "1665768372267", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.043859649122807015, "readRatioMax": 0.043859649122807015, "recordsRead": "287514", "recordsWritten": "507", "shuffleOutputBytes": "22236", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665768372213", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:sr_item_sk, $81:sr_ticket_number, $82:sr_return_quantity, $83:sr_return_amt", "FROM store_returns", "WHERE greater($83, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.029239766081871343, "writeRatioMax": 0.029239766081871343 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.049707602339181284, "computeRatioMax": 0.049707602339181284, "endMs": "1665768372281", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03216374269005848, "readRatioMax": 0.03216374269005848, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768372244", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 12))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.029239766081871343, "writeRatioMax": 0.029239766081871343 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.1023391812865497, "computeRatioMax": 0.1023391812865497, "endMs": "1665768372301", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.029239766081871343, "readRatioMax": 0.029239766081871343, "recordsRead": "144067", "recordsWritten": "1217", "shuffleOutputBytes": "53452", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768372260", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cr_item_sk, $61:cr_order_number, $62:cr_return_quantity, $63:cr_return_amount", "FROM catalog_returns", "WHERE greater($63, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02046783625730994, "writeRatioMax": 0.02046783625730994 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03216374269005848, "computeRatioMax": 0.03216374269005848, "endMs": "1665768372324", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02046783625730994, "readRatioMax": 0.02046783625730994, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768372288", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_moy", "FROM date_dim", "WHERE and(equal($2, 2001), equal($3, 12))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02046783625730994, "writeRatioMax": 0.02046783625730994 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.06140350877192982, "computeRatioMax": 0.06140350877192982, "endMs": "1665768372340", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.05263157894736842, "readRatioMax": 0.05263157894736842, "recordsRead": "71763", "recordsWritten": "632", "shuffleOutputBytes": "27680", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768372302", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_item_sk, $41:wr_order_number, $42:wr_return_quantity, $43:wr_return_amt", "FROM web_returns", "WHERE greater($43, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage07_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.014619883040935672, "writeRatioMax": 0.014619883040935672 }, { "completedParallelInputs": "6", "computeMsAvg": "232", "computeMsMax": "272", "computeRatioAvg": 0.6783625730994152, "computeRatioMax": 0.7953216374269005, "endMs": "1665768372515", "id": "9", "inputStages": [ "1", "0" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "23", "readRatioAvg": 0.06140350877192982, "readRatioMax": 0.06725146198830409, "recordsRead": "2883632", "recordsWritten": "11", "shuffleOutputBytes": "671", "shuffleOutputBytesSpilled": "0", "slotMs": "1290", "startMs": "1665768372336", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_ticket_number, $73:ss_quantity, $74:ss_net_paid, $75:ss_net_profit", "FROM store_sales", "WHERE and(greater($75, NUMERIC<...>), greater($74, NUMERIC<...>), greater($73, 0))" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1190 := $1180", "$690 := SUM($720)", "$691 := SUM($721)", "$692 := SUM($722)", "$693 := SUM($723)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($1183, 0)", "$721 := coalesce($1181, 0)", "$722 := coalesce($1184, NUMERIC<...>)", "$723 := coalesce($1182, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1161, $1181 := $1162, $1182 := $1163, $1183 := $1164, $1184 := $1165", "INNER HASH JOIN EACH WITH ALL ON $1160 = $20" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $70, $1161 := $71, $1162 := $73, $1163 := $74, $1164 := $82, $1165 := $83", "INNER HASH JOIN EACH WITH ALL ON $72 = $81, $71 = $80" ] }, { "kind": "WRITE", "substeps": [ "$1190, $690, $691, $692, $693", "TO __stage09_output", "BY HASH($1190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.017543859649122806, "writeRatioMax": 0.023391812865497075 }, { "completedParallelInputs": "5", "computeMsAvg": "235", "computeMsMax": "304", "computeRatioAvg": 0.6871345029239766, "computeRatioMax": 0.8888888888888888, "endMs": "1665768372553", "id": "10", "inputStages": [ "4", "3" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "29", "readMsMax": "42", "readRatioAvg": 0.0847953216374269, "readRatioMax": 0.12280701754385964, "recordsRead": "1447788", "recordsWritten": "42", "shuffleOutputBytes": "2562", "shuffleOutputBytesSpilled": "0", "slotMs": "1320", "startMs": "1665768372350", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_item_sk, $52:cs_order_number, $53:cs_quantity, $54:cs_net_paid, $55:cs_net_profit", "FROM catalog_sales", "WHERE and(greater($55, NUMERIC<...>), greater($54, NUMERIC<...>), greater($53, 0))" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$680 := SUM($710)", "$681 := SUM($711)", "$682 := SUM($712)", "$683 := SUM($713)" ] }, { "kind": "COMPUTE", "substeps": [ "$710 := coalesce($973, 0)", "$711 := coalesce($971, 0)", "$712 := coalesce($974, NUMERIC<...>)", "$713 := coalesce($972, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$970 := $951, $971 := $952, $972 := $953, $973 := $954, $974 := $955", "INNER HASH JOIN EACH WITH ALL ON $950 = $10" ] }, { "kind": "JOIN", "substeps": [ "$950 := $50, $951 := $51, $952 := $53, $953 := $54, $954 := $62, $955 := $63", "INNER HASH JOIN EACH WITH ALL ON $52 = $61, $51 = $60" ] }, { "kind": "WRITE", "substeps": [ "$980, $680, $681, $682, $683", "TO __stage0A_output", "BY HASH($980)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.023391812865497075, "writeRatioMax": 0.02631578947368421 }, { "completedParallelInputs": "1", "computeMsAvg": "342", "computeMsMax": "342", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768372592", "id": "11", "inputStages": [ "7", "6" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "45", "readMsMax": "45", "readRatioAvg": 0.13157894736842105, "readRatioMax": 0.13157894736842105, "recordsRead": "720047", "recordsWritten": "16", "shuffleOutputBytes": "976", "shuffleOutputBytesSpilled": "0", "slotMs": "348", "startMs": "1665768372353", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_order_number, $33:ws_quantity, $34:ws_net_paid, $35:ws_net_profit", "FROM web_sales", "WHERE and(greater($35, NUMERIC<...>), greater($34, NUMERIC<...>), greater($33, 0))" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $770 := $760", "$670 := SUM($700)", "$671 := SUM($701)", "$672 := SUM($702)", "$673 := SUM($703)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := coalesce($763, 0)", "$701 := coalesce($761, 0)", "$702 := coalesce($764, NUMERIC<...>)", "$703 := coalesce($762, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $741, $761 := $742, $762 := $743, $763 := $744, $764 := $745", "INNER HASH JOIN EACH WITH ALL ON $740 = $1" ] }, { "kind": "JOIN", "substeps": [ "$740 := $30, $741 := $31, $742 := $33, $743 := $34, $744 := $42, $745 := $43", "INNER HASH JOIN EACH WITH ALL ON $32 = $41, $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$770, $670, $671, $672, $673", "TO __stage0B_output", "BY HASH($770)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02046783625730994, "writeRatioMax": 0.02046783625730994 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03216374269005848, "computeRatioMax": 0.03216374269005848, "endMs": "1665768372569", "id": "12", "inputStages": [ "9" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "385", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768372532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1190, $690, $691, $692, $693", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := divide(CAST($650 AS DOUBLE), CAST($651 AS DOUBLE))", "$591 := divide($652, $653)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$650 := SUM($690)", "$651 := SUM($691)", "$652 := SUM($692)", "$653 := SUM($693)" ] }, { "kind": "WRITE", "substeps": [ "$1200, $590, $591", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07602339181286549, "writeRatioMax": 0.07602339181286549 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03216374269005848, "computeRatioMax": 0.03216374269005848, "endMs": "1665768372609", "id": "13", "inputStages": [ "10" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768372573", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$980, $680, $681, $682, $683", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := divide(CAST($630 AS DOUBLE), CAST($631 AS DOUBLE))", "$571 := divide($632, $633)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $990 := $980", "$630 := SUM($680)", "$631 := SUM($681)", "$632 := SUM($682)", "$633 := SUM($683)" ] }, { "kind": "WRITE", "substeps": [ "$990, $570, $571", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.043859649122807015 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.029239766081871343, "endMs": "1665768372623", "id": "14", "inputStages": [ "12" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768372585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1202 := shard_sink_stats($1201)" ] }, { "kind": "COMPUTE", "substeps": [ "$1201 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1202", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.043859649122807015 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.023391812865497075, "computeRatioMax": 0.023391812865497075, "endMs": "1665768372640", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768372588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1203 := root_sink_stats($1202)" ] }, { "kind": "WRITE", "substeps": [ "$1203", "TO __stage0F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008771929824561403, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.008771929824561403, "writeRatioMax": 0.008771929824561403 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.017543859649122806, "computeRatioMax": 0.017543859649122806, "endMs": "1665768372710", "id": "16", "inputStages": [ "11" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "560", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768372675", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $670, $671, $672, $673", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := divide(CAST($610 AS DOUBLE), CAST($611 AS DOUBLE))", "$551 := divide($612, $613)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $770", "$610 := SUM($670)", "$611 := SUM($671)", "$612 := SUM($672)", "$613 := SUM($673)" ] }, { "kind": "WRITE", "substeps": [ "$780, $550, $551", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07894736842105263, "writeRatioMax": 0.07894736842105263 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.038011695906432746, "computeRatioMax": 0.038011695906432746, "endMs": "1665768372718", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768372677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$992 := shard_sink_stats($991)" ] }, { "kind": "COMPUTE", "substeps": [ "$991 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$992", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.04678362573099415, "writeRatioMax": 0.04678362573099415 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.023391812865497075, "computeRatioMax": 0.023391812865497075, "endMs": "1665768372732", "id": "18", "inputStages": [ "17" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768372677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$992", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$993 := root_sink_stats($992)" ] }, { "kind": "WRITE", "substeps": [ "$993", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.005847953216374269, "writeRatioMax": 0.005847953216374269 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04678362573099415, "computeRatioMax": 0.04678362573099415, "endMs": "1665768372745", "id": "19", "inputStages": [ "15", "12" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665768372694", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1203", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0C_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$520 := ROW_NUMBER($1203) OVER (ORDER BY $1211 ASC)" ] }, { "kind": "SORT", "substeps": [ "$590 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1220, $520, $1221, $1222", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.06725146198830409, "writeRatioMax": 0.06725146198830409 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.014619883040935672, "computeRatioMax": 0.014619883040935672, "endMs": "1665768372725", "id": "20", "inputStages": [ "16" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665768372713", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$782 := shard_sink_stats($781)" ] }, { "kind": "COMPUTE", "substeps": [ "$781 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$782", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0029239766081871343, "writeRatioMax": 0.0029239766081871343 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.02631578947368421, "endMs": "1665768372758", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768372716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$782", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$783 := root_sink_stats($782)" ] }, { "kind": "WRITE", "substeps": [ "$783", "TO __stage15_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008771929824561403, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.017543859649122806, "writeRatioMax": 0.017543859649122806 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.04093567251461988, "computeRatioMax": 0.04093567251461988, "endMs": "1665768372801", "id": "22", "inputStages": [ "13", "18" ], "name": "S16: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665768372752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$993", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0D_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$490 := ROW_NUMBER($993) OVER (ORDER BY $1001 ASC)" ] }, { "kind": "SORT", "substeps": [ "$570 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1010, $490, $1011, $1012", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.06725146198830409, "writeRatioMax": 0.06725146198830409 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.049707602339181284, "endMs": "1665768372825", "id": "23", "inputStages": [ "19" ], "name": "S17: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "198", "shuffleOutputBytesSpilled": "0", "slotMs": "3662", "startMs": "1665768372779", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1250 := $660", "$600 := MIN($661)" ] }, { "kind": "WRITE", "substeps": [ "$600, $1250", "TO __stage17_output", "BY HASH($1250)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "15", "writeMsMax": "24", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.07017543859649122 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.029239766081871343, "endMs": "1665768372843", "id": "24", "inputStages": [ "16", "21" ], "name": "S18: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768372795", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$783", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage10_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$460 := ROW_NUMBER($783) OVER (ORDER BY $791 ASC)" ] }, { "kind": "SORT", "substeps": [ "$550 ASC" ] }, { "kind": "WRITE", "substeps": [ "$800, $460, $801, $802", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.10526315789473684, "writeRatioMax": 0.10526315789473684 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.04093567251461988, "endMs": "1665768372880", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "756", "shuffleOutputBytesSpilled": "0", "slotMs": "3882", "startMs": "1665768372818", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $640", "$580 := MIN($641)" ] }, { "kind": "WRITE", "substeps": [ "$580, $1040", "TO __stage19_output", "BY HASH($1040)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "17", "writeMsMax": "22", "writeRatioAvg": 0.049707602339181284, "writeRatioMax": 0.06432748538011696 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "19", "computeRatioAvg": 0.03216374269005848, "computeRatioMax": 0.05555555555555555, "endMs": "1665768372907", "id": "26", "inputStages": [ "23" ], "name": "S1A: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "549", "startMs": "1665768372841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1250", "FROM __stage17_output" ] }, { "kind": "COMPUTE", "substeps": [ "$450 := coalesce($1260, 0)", "$451 := coalesce($1260, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1250", "$540 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$450, $451, $540", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "34", "writeMsMax": "52", "writeRatioAvg": 0.09941520467836257, "writeRatioMax": 0.15204678362573099 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.049707602339181284, "endMs": "1665768372938", "id": "28", "inputStages": [ "24" ], "name": "S1C: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "288", "shuffleOutputBytesSpilled": "0", "slotMs": "3968", "startMs": "1665768372884", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $620", "$560 := MIN($621)" ] }, { "kind": "WRITE", "substeps": [ "$560, $830", "TO __stage1C_output", "BY HASH($830)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "25", "writeMsMax": "34", "writeRatioAvg": 0.07309941520467836, "writeRatioMax": 0.09941520467836257 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "12", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.03508771929824561, "endMs": "1665768372941", "id": "29", "inputStages": [ "25" ], "name": "S1D: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "378", "startMs": "1665768372901", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $1040", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$430 := coalesce($1050, 0)", "$431 := coalesce($1050, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040", "$510 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $510", "TO __stage1D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.05555555555555555 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.023391812865497075, "computeRatioMax": 0.04678362573099415, "endMs": "1665768372969", "id": "31", "inputStages": [ "26" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "3413", "startMs": "1665768372918", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.011695906432748537, "waitRatioMax": 0.017543859649122806, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.038011695906432746, "writeRatioMax": 0.05847953216374269 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.05263157894736842, "endMs": "1665768372994", "id": "32", "inputStages": [ "19", "31" ], "name": "S20: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "121", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "4567", "startMs": "1665768372934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$450, $451, $540", "FROM __stage1F_output" ] }, { "kind": "JOIN", "substeps": [ "$1270 := $530, $1271 := $531, $1272 := $532, $1273 := $540", "INNER HASH JOIN EACH WITH ALL ON $440 = $450, $441 = $451" ] }, { "kind": "COMPUTE", "substeps": [ "$440 := coalesce($531, 0)", "$441 := coalesce($531, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $1271, $1272, $1273", "TO __stage20_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.04093567251461988, "writeRatioMax": 0.07602339181286549 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "17", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.049707602339181284, "endMs": "1665768372996", "id": "33", "inputStages": [ "28" ], "name": "S21: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "492", "startMs": "1665768372955", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $830", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($840, 0)", "$411 := coalesce($840, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830", "$480 := MIN($560)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $480", "TO __stage21_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "24", "writeMsMax": "30", "writeRatioAvg": 0.07017543859649122, "writeRatioMax": 0.08771929824561403 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.023391812865497075, "computeRatioMax": 0.04093567251461988, "endMs": "1665768373041", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "4322", "startMs": "1665768372987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.08187134502923976 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.05847953216374269, "endMs": "1665768373062", "id": "36", "inputStages": [ "35", "22" ], "name": "S24: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1300", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "4630", "startMs": "1665768372998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$430, $431, $510", "FROM __stage23_output" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $500, $1061 := $501, $1062 := $502, $1063 := $510", "INNER HASH JOIN EACH WITH ALL ON $420 = $430, $421 = $431" ] }, { "kind": "COMPUTE", "substeps": [ "$420 := coalesce($501, 0)", "$421 := coalesce($501, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1060, $1061, $1062, $1063", "TO __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "9", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.02631578947368421, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.04093567251461988, "writeRatioMax": 0.0847953216374269 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.02631578947368421, "endMs": "1665768373144", "id": "37", "inputStages": [ "32" ], "name": "S25: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768373105", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage20_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1275 := shard_sink_stats($1274)" ] }, { "kind": "COMPUTE", "substeps": [ "$1274 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1275", "TO __stage25_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.043859649122807015 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.011695906432748537, "computeRatioMax": 0.011695906432748537, "endMs": "1665768373157", "id": "38", "inputStages": [ "37" ], "name": "S26: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768373107", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1275", "FROM __stage25_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1276 := root_sink_stats($1275)" ] }, { "kind": "WRITE", "substeps": [ "$1276", "TO __stage26_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008771929824561403, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.005847953216374269, "writeRatioMax": 0.005847953216374269 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "24", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.07017543859649122, "endMs": "1665768373177", "id": "39", "inputStages": [ "33" ], "name": "S27: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "15", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "4493", "startMs": "1665768373108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.008771929824561403, "waitRatioMax": 0.014619883040935672, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.04093567251461988, "writeRatioMax": 0.06140350877192982 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.05263157894736842, "endMs": "1665768373193", "id": "40", "inputStages": [ "39", "24" ], "name": "S28: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "226", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "3917", "startMs": "1665768373121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $480", "FROM __stage27_output" ] }, { "kind": "JOIN", "substeps": [ "$850 := $470, $851 := $471, $852 := $472, $853 := $480", "INNER HASH JOIN EACH WITH ALL ON $400 = $410, $401 = $411" ] }, { "kind": "COMPUTE", "substeps": [ "$400 := coalesce($471, 0)", "$401 := coalesce($471, 1)" ] }, { "kind": "WRITE", "substeps": [ "$850, $851, $852, $853", "TO __stage28_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "13", "writeMsMax": "17", "writeRatioAvg": 0.038011695906432746, "writeRatioMax": 0.049707602339181284 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.014619883040935672, "computeRatioMax": 0.014619883040935672, "endMs": "1665768373177", "id": "41", "inputStages": [ "36" ], "name": "S29: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768373143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage24_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1065 := shard_sink_stats($1064)" ] }, { "kind": "COMPUTE", "substeps": [ "$1064 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1065", "TO __stage29_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07602339181286549, "writeRatioMax": 0.07602339181286549 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.014619883040935672, "computeRatioMax": 0.014619883040935672, "endMs": "1665768373193", "id": "42", "inputStages": [ "41" ], "name": "S2A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768373144", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1065", "FROM __stage29_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1066 := root_sink_stats($1065)" ] }, { "kind": "WRITE", "substeps": [ "$1066", "TO __stage2A_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.008771929824561403, "writeRatioMax": 0.008771929824561403 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03508771929824561, "computeRatioMax": 0.03508771929824561, "endMs": "1665768373236", "id": "43", "inputStages": [ "32", "38" ], "name": "S2B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "583", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768373183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1276", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage20_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$280 := ROW_NUMBER($1276) OVER (ORDER BY $1282 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1272 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $1290, $1291, $1292, $1293", "TO __stage2B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.07309941520467836, "writeRatioMax": 0.07309941520467836 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.017543859649122806, "computeRatioMax": 0.017543859649122806, "endMs": "1665768373241", "id": "44", "inputStages": [ "40" ], "name": "S2C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768373206", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage28_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$855 := shard_sink_stats($854)" ] }, { "kind": "COMPUTE", "substeps": [ "$854 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$855", "TO __stage2C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07894736842105263, "writeRatioMax": 0.07894736842105263 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.017543859649122806, "computeRatioMax": 0.017543859649122806, "endMs": "1665768373262", "id": "45", "inputStages": [ "44" ], "name": "S2D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768373209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$855", "FROM __stage2C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$856 := root_sink_stats($855)" ] }, { "kind": "WRITE", "substeps": [ "$856", "TO __stage2D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008771929824561403, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.005847953216374269, "writeRatioMax": 0.005847953216374269 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.02631578947368421, "endMs": "1665768373273", "id": "46", "inputStages": [ "42", "36" ], "name": "S2E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "2226", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768373224", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1066", "FROM __stage2A_output" ] }, { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage24_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$250 := ROW_NUMBER($1066) OVER (ORDER BY $1072 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1062 ASC" ] }, { "kind": "WRITE", "substeps": [ "$250, $1080, $1081, $1082, $1083", "TO __stage2E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07894736842105263, "writeRatioMax": 0.07894736842105263 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "17", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.049707602339181284, "endMs": "1665768373316", "id": "47", "inputStages": [ "43" ], "name": "S2F: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "286", "shuffleOutputBytesSpilled": "0", "slotMs": "4071", "startMs": "1665768373269", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1320 := $390", "$330 := MIN($391)" ] }, { "kind": "WRITE", "substeps": [ "$330, $1320", "TO __stage2F_output", "BY HASH($1320)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.04093567251461988, "writeRatioMax": 0.049707602339181284 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.029239766081871343, "endMs": "1665768373344", "id": "48", "inputStages": [ "40", "45" ], "name": "S30: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "848", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768373294", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$856", "FROM __stage2D_output" ] }, { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage28_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := ROW_NUMBER($856) OVER (ORDER BY $862 ASC)" ] }, { "kind": "SORT", "substeps": [ "$852 ASC" ] }, { "kind": "WRITE", "substeps": [ "$220, $870, $871, $872, $873", "TO __stage30_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07894736842105263, "writeRatioMax": 0.07894736842105263 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.05847953216374269, "endMs": "1665768373361", "id": "49", "inputStages": [ "46" ], "name": "S31: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1092", "shuffleOutputBytesSpilled": "0", "slotMs": "3342", "startMs": "1665768373311", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage2E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $370", "$320 := MIN($371)" ] }, { "kind": "WRITE", "substeps": [ "$320, $1110", "TO __stage31_output", "BY HASH($1110)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "15", "writeMsMax": "35", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.1023391812865497 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.05263157894736842, "endMs": "1665768373413", "id": "50", "inputStages": [ "48" ], "name": "S32: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "416", "shuffleOutputBytesSpilled": "0", "slotMs": "3890", "startMs": "1665768373367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage30_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $350", "$310 := MIN($351)" ] }, { "kind": "WRITE", "substeps": [ "$310, $900", "TO __stage32_output", "BY HASH($900)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.08187134502923976 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "12", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.03508771929824561, "endMs": "1665768373473", "id": "51", "inputStages": [ "47" ], "name": "S33: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "368", "startMs": "1665768373432", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $1320", "FROM __stage2F_output" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := coalesce($1330, NUMERIC<...>)", "$211 := coalesce($1330, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1330 := $1320", "$300 := MIN($330)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $300", "TO __stage33_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.0029239766081871343, "writeMsAvg": "15", "writeMsMax": "16", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.04678362573099415 }, { "completedParallelInputs": "10", "computeMsAvg": "12", "computeMsMax": "19", "computeRatioAvg": 0.03508771929824561, "computeRatioMax": 0.05555555555555555, "endMs": "1665768373503", "id": "53", "inputStages": [ "49" ], "name": "S35: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "388", "startMs": "1665768373462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $1110", "FROM __stage31_output" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($1120, NUMERIC<...>)", "$191 := coalesce($1120, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1110", "$270 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $270", "TO __stage35_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "14", "writeMsMax": "15", "writeRatioAvg": 0.04093567251461988, "writeRatioMax": 0.043859649122807015 }, { "completedParallelInputs": "10", "computeMsAvg": "12", "computeMsMax": "20", "computeRatioAvg": 0.03508771929824561, "computeRatioMax": 0.05847953216374269, "endMs": "1665768373540", "id": "55", "inputStages": [ "50" ], "name": "S37: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "408", "startMs": "1665768373492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $900", "FROM __stage32_output" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($910, NUMERIC<...>)", "$171 := coalesce($910, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$240 := MIN($310)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $240", "TO __stage37_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "20", "writeMsMax": "28", "writeRatioAvg": 0.05847953216374269, "writeRatioMax": 0.08187134502923976 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.02046783625730994, "computeRatioMax": 0.043859649122807015, "endMs": "1665768373578", "id": "57", "inputStages": [ "51" ], "name": "S39: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "3318", "startMs": "1665768373515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage33_output" ] } ], "waitMsAvg": "6", "waitMsMax": "9", "waitRatioAvg": 0.017543859649122806, "waitRatioMax": 0.02631578947368421, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.043859649122807015, "writeRatioMax": 0.05847953216374269 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.023391812865497075, "computeRatioMax": 0.043859649122807015, "endMs": "1665768373585", "id": "58", "inputStages": [ "53" ], "name": "S3A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "4251", "startMs": "1665768373525", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage35_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0029239766081871343, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "23", "writeMsMax": "31", "writeRatioAvg": 0.06725146198830409, "writeRatioMax": 0.09064327485380116 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.023391812865497075, "computeRatioMax": 0.043859649122807015, "endMs": "1665768373613", "id": "59", "inputStages": [ "55" ], "name": "S3B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "4101", "startMs": "1665768373549", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage37_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.008771929824561403, "waitRatioMax": 0.011695906432748537, "writeMsAvg": "22", "writeMsMax": "53", "writeRatioAvg": 0.06432748538011696, "writeRatioMax": 0.15497076023391812 }, { "completedParallelInputs": "300", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.05847953216374269, "endMs": "1665768373647", "id": "60", "inputStages": [ "59", "58", "48", "57", "43", "46" ], "name": "S3C: Join+", "parallelInputs": "300", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1695", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "18282", "startMs": "1665768373556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage30_output" ] }, { "kind": "READ", "substeps": [ "$170, $171, $240", "FROM __stage3B_output" ] }, { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage2E_output" ] }, { "kind": "READ", "substeps": [ "$190, $191, $270", "FROM __stage3A_output" ] }, { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$210, $211, $300", "FROM __stage39_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $921 ASC, $923 ASC, $920 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := 'web'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($921, 10), less_or_equal($923, 10))" ] }, { "kind": "JOIN", "substeps": [ "$920 := $230, $921 := $231, $922 := $232, $923 := $240", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($233, NUMERIC<...>)", "$161 := coalesce($233, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$110 ASC, $1131 ASC, $1133 ASC, $1130 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := 'catalog'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1131, 10), less_or_equal($1133, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1130 := $260, $1131 := $261, $1132 := $262, $1133 := $270", "INNER HASH JOIN EACH WITH ALL ON $180 = $190, $181 = $191" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := coalesce($263, NUMERIC<...>)", "$181 := coalesce($263, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1341 ASC, $1343 ASC, $1340 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1341, 10), less_or_equal($1343, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1340 := $290, $1341 := $291, $1342 := $292, $1343 := $300", "INNER HASH JOIN EACH WITH ALL ON $200 = $210, $201 = $211" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($293, NUMERIC<...>)", "$201 := coalesce($293, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage3C_output" ] } ], "waitMsAvg": "7", "waitMsMax": "10", "waitRatioAvg": 0.02046783625730994, "waitRatioMax": 0.029239766081871343, "writeMsAvg": "45", "writeMsMax": "61", "writeRatioAvg": 0.13157894736842105, "writeRatioMax": 0.1783625730994152 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03216374269005848, "computeRatioMax": 0.03216374269005848, "endMs": "1665768373662", "id": "61", "inputStages": [ "60" ], "name": "S3D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665768373574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage3C_output" ] }, { "kind": "SORT", "substeps": [ "$90 ASC, $93 ASC, $94 ASC, $91 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1360, $1361, $1362, $1363, $1364", "TO __stage3D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008771929824561403, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.014619883040935672, "writeRatioMax": 0.014619883040935672 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "22", "elapsedMs": "671", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "3530" }, { "activeUnits": "3", "completedUnits": "1900", "elapsedMs": "1714", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "96571" } ], "totalBytesBilled": "338690048", "totalBytesProcessed": "337676184", "totalPartitionsProcessed": "0", "totalSlotMs": "96571", "transferredBytes": "0" }, "startTime": "1665768372029", "totalBytesProcessed": "337676184", "totalSlotMs": "96571" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon616e158f_378f_4583_8f75_325cf8b3ffaa" }, "priority": "INTERACTIVE", "query": "select channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(sum(coalesce(wr.wr_return_quantity,0)))/\n \t\tsum(coalesce(ws.ws_quantity,0)) as return_ratio\n \t\t,(sum(coalesce(wr.wr_return_amt,0)))/\n \t\tsum(coalesce(ws.ws_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n and ws.ws_net_paid > 0\n and ws.ws_quantity > 0\n and ws_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union all\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,sum(coalesce(cr.cr_return_quantity,0))/\n \t\tsum(coalesce(cs.cs_quantity,0)) as return_ratio\n \t\t,sum(coalesce(cr.cr_return_amount,0))/\n \t\tsum(coalesce(cs.cs_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n and cs.cs_net_paid > 0\n and cs.cs_quantity > 0\n and cs_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union all\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,sum(coalesce(sr.sr_return_quantity,0))/sum(coalesce(sts.ss_quantity,0)) as return_ratio\n \t\t,sum(coalesce(sr.sr_return_amt,0))/sum(coalesce(sts.ss_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n and sts.ss_net_paid > 0 \n and sts.ss_quantity > 0\n and ss_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n order by 1,4,5,2\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "wutJK7qKwW1agL2mUTB9uQ==", "id": "test-project-364309:europe-west1.query49_1665777705", "jobReference": { "jobId": "query49_1665777705", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query49_1665777705?location=europe-west1", "statistics": { "creationTime": "1665777705752", "endTime": "1665777707851", "finalExecutionDurationMs": "1685", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "337676184", "performanceInsights": { "avgPreviousExecutionMs": "1455" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.027777777777777776, "computeRatioMax": 0.027777777777777776, "endMs": "1665777706086", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016203703703703703, "readRatioMax": 0.016203703703703703, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777706044", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(equal($21, 2001), equal($22, 12))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.032407407407407406, "writeRatioMax": 0.032407407407407406 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.13194444444444445, "computeRatioMax": 0.13194444444444445, "endMs": "1665777706123", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.041666666666666664, "readRatioMax": 0.041666666666666664, "recordsRead": "287514", "recordsWritten": "507", "shuffleOutputBytes": "22236", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665777706061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:sr_item_sk, $81:sr_ticket_number, $82:sr_return_quantity, $83:sr_return_amt", "FROM store_returns", "WHERE greater($83, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.023148148148148147, "writeRatioMax": 0.023148148148148147 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02546296296296296, "computeRatioMax": 0.02546296296296296, "endMs": "1665777706135", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016203703703703703, "readRatioMax": 0.016203703703703703, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777706099", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 12))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.016203703703703703, "writeRatioMax": 0.016203703703703703 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.08101851851851852, "computeRatioMax": 0.08101851851851852, "endMs": "1665777706163", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.03935185185185185, "readRatioMax": 0.03935185185185185, "recordsRead": "144067", "recordsWritten": "1217", "shuffleOutputBytes": "53452", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777706116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cr_item_sk, $61:cr_order_number, $62:cr_return_quantity, $63:cr_return_amount", "FROM catalog_returns", "WHERE greater($63, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023148148148148147, "waitRatioMax": 0.0023148148148148147, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.013888888888888888 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016203703703703703, "computeRatioMax": 0.016203703703703703, "endMs": "1665777706178", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013888888888888888, "readRatioMax": 0.013888888888888888, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777706148", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_moy", "FROM date_dim", "WHERE and(equal($2, 2001), equal($3, 12))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023148148148148147, "waitRatioMax": 0.0023148148148148147, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.034722222222222224 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.0763888888888889, "computeRatioMax": 0.0763888888888889, "endMs": "1665777706201", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.027777777777777776, "readRatioMax": 0.027777777777777776, "recordsRead": "71763", "recordsWritten": "632", "shuffleOutputBytes": "27680", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777706164", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_item_sk, $41:wr_order_number, $42:wr_return_quantity, $43:wr_return_amt", "FROM web_returns", "WHERE greater($43, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.016203703703703703, "writeRatioMax": 0.016203703703703703 }, { "completedParallelInputs": "6", "computeMsAvg": "231", "computeMsMax": "277", "computeRatioAvg": 0.5347222222222222, "computeRatioMax": 0.6412037037037037, "endMs": "1665777706400", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "25", "readMsMax": "29", "readRatioAvg": 0.05787037037037037, "readRatioMax": 0.06712962962962964, "recordsRead": "2883632", "recordsWritten": "11", "shuffleOutputBytes": "671", "shuffleOutputBytesSpilled": "0", "slotMs": "1233", "startMs": "1665777706209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_ticket_number, $73:ss_quantity, $74:ss_net_paid, $75:ss_net_profit", "FROM store_sales", "WHERE and(greater($75, NUMERIC<...>), greater($74, NUMERIC<...>), greater($73, 0))" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1190 := $1180", "$690 := SUM($720)", "$691 := SUM($721)", "$692 := SUM($722)", "$693 := SUM($723)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($1183, 0)", "$721 := coalesce($1181, 0)", "$722 := coalesce($1184, NUMERIC<...>)", "$723 := coalesce($1182, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1161, $1181 := $1162, $1182 := $1163, $1183 := $1164, $1184 := $1165", "INNER HASH JOIN EACH WITH ALL ON $1160 = $20" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $70, $1161 := $71, $1162 := $73, $1163 := $74, $1164 := $82, $1165 := $83", "INNER HASH JOIN EACH WITH ALL ON $72 = $81, $71 = $80" ] }, { "kind": "WRITE", "substeps": [ "$1190, $690, $691, $692, $693", "TO __stage09_output", "BY HASH($1190)" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.016203703703703703 }, { "completedParallelInputs": "5", "computeMsAvg": "177", "computeMsMax": "237", "computeRatioAvg": 0.4097222222222222, "computeRatioMax": 0.5486111111111112, "endMs": "1665777706391", "id": "10", "inputStages": [ "3", "4" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "23", "readMsMax": "32", "readRatioAvg": 0.05324074074074074, "readRatioMax": 0.07407407407407407, "recordsRead": "1447788", "recordsWritten": "42", "shuffleOutputBytes": "2562", "shuffleOutputBytesSpilled": "0", "slotMs": "840", "startMs": "1665777706229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_item_sk, $52:cs_order_number, $53:cs_quantity, $54:cs_net_paid, $55:cs_net_profit", "FROM catalog_sales", "WHERE and(greater($55, NUMERIC<...>), greater($54, NUMERIC<...>), greater($53, 0))" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$680 := SUM($710)", "$681 := SUM($711)", "$682 := SUM($712)", "$683 := SUM($713)" ] }, { "kind": "COMPUTE", "substeps": [ "$710 := coalesce($973, 0)", "$711 := coalesce($971, 0)", "$712 := coalesce($974, NUMERIC<...>)", "$713 := coalesce($972, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$970 := $951, $971 := $952, $972 := $953, $973 := $954, $974 := $955", "INNER HASH JOIN EACH WITH ALL ON $950 = $10" ] }, { "kind": "JOIN", "substeps": [ "$950 := $50, $951 := $51, $952 := $53, $953 := $54, $954 := $62, $955 := $63", "INNER HASH JOIN EACH WITH ALL ON $52 = $61, $51 = $60" ] }, { "kind": "WRITE", "substeps": [ "$980, $680, $681, $682, $683", "TO __stage0A_output", "BY HASH($980)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.016203703703703703, "writeRatioMax": 0.020833333333333332 }, { "completedParallelInputs": "1", "computeMsAvg": "432", "computeMsMax": "432", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777706487", "id": "11", "inputStages": [ "6", "7" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "24", "readMsMax": "24", "readRatioAvg": 0.05555555555555555, "readRatioMax": 0.05555555555555555, "recordsRead": "720047", "recordsWritten": "16", "shuffleOutputBytes": "976", "shuffleOutputBytesSpilled": "0", "slotMs": "339", "startMs": "1665777706235", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_order_number, $33:ws_quantity, $34:ws_net_paid, $35:ws_net_profit", "FROM web_sales", "WHERE and(greater($35, NUMERIC<...>), greater($34, NUMERIC<...>), greater($33, 0))" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $770 := $760", "$670 := SUM($700)", "$671 := SUM($701)", "$672 := SUM($702)", "$673 := SUM($703)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := coalesce($763, 0)", "$701 := coalesce($761, 0)", "$702 := coalesce($764, NUMERIC<...>)", "$703 := coalesce($762, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $741, $761 := $742, $762 := $743, $763 := $744, $764 := $745", "INNER HASH JOIN EACH WITH ALL ON $740 = $1" ] }, { "kind": "JOIN", "substeps": [ "$740 := $30, $741 := $31, $742 := $33, $743 := $34, $744 := $42, $745 := $43", "INNER HASH JOIN EACH WITH ALL ON $32 = $41, $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$770, $670, $671, $672, $673", "TO __stage0B_output", "BY HASH($770)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.009259259259259259, "writeRatioMax": 0.009259259259259259 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.018518518518518517, "endMs": "1665777706455", "id": "12", "inputStages": [ "10" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777706419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$980, $680, $681, $682, $683", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := divide(CAST($630 AS DOUBLE), CAST($631 AS DOUBLE))", "$571 := divide($632, $633)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $990 := $980", "$630 := SUM($680)", "$631 := SUM($681)", "$632 := SUM($682)", "$633 := SUM($683)" ] }, { "kind": "WRITE", "substeps": [ "$990, $570, $571", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016203703703703703, "computeRatioMax": 0.016203703703703703, "endMs": "1665777706476", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "385", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777706442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1190, $690, $691, $692, $693", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := divide(CAST($650 AS DOUBLE), CAST($651 AS DOUBLE))", "$591 := divide($652, $653)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$650 := SUM($690)", "$651 := SUM($691)", "$652 := SUM($692)", "$653 := SUM($693)" ] }, { "kind": "WRITE", "substeps": [ "$1200, $590, $591", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06018518518518518, "writeRatioMax": 0.06018518518518518 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.020833333333333332, "endMs": "1665777706507", "id": "14", "inputStages": [ "12" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777706473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$992 := shard_sink_stats($991)" ] }, { "kind": "COMPUTE", "substeps": [ "$991 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$992", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.034722222222222224 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016203703703703703, "computeRatioMax": 0.016203703703703703, "endMs": "1665777706516", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777706475", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$992", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$993 := root_sink_stats($992)" ] }, { "kind": "WRITE", "substeps": [ "$993", "TO __stage0F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.006944444444444444, "writeRatioMax": 0.006944444444444444 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.020833333333333332, "endMs": "1665777706519", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777706482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1202 := shard_sink_stats($1201)" ] }, { "kind": "COMPUTE", "substeps": [ "$1201 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1202", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.032407407407407406, "writeRatioMax": 0.032407407407407406 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.013888888888888888, "computeRatioMax": 0.013888888888888888, "endMs": "1665777706533", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777706482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1203 := root_sink_stats($1202)" ] }, { "kind": "WRITE", "substeps": [ "$1203", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.004629629629629629, "writeRatioMax": 0.004629629629629629 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.023148148148148147, "computeRatioMax": 0.023148148148148147, "endMs": "1665777706595", "id": "18", "inputStages": [ "11" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "560", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777706551", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $670, $671, $672, $673", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := divide(CAST($610 AS DOUBLE), CAST($611 AS DOUBLE))", "$551 := divide($612, $613)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $770", "$610 := SUM($670)", "$611 := SUM($671)", "$612 := SUM($672)", "$613 := SUM($673)" ] }, { "kind": "WRITE", "substeps": [ "$780, $550, $551", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.05787037037037037, "writeRatioMax": 0.05787037037037037 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02546296296296296, "computeRatioMax": 0.02546296296296296, "endMs": "1665777706625", "id": "19", "inputStages": [ "12", "15" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777706571", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$993", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$490 := ROW_NUMBER($993) OVER (ORDER BY $1001 ASC)" ] }, { "kind": "SORT", "substeps": [ "$570 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1010, $490, $1011, $1012", "TO __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06018518518518518, "writeRatioMax": 0.06018518518518518 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.023148148148148147, "computeRatioMax": 0.023148148148148147, "endMs": "1665777706641", "id": "20", "inputStages": [ "13", "17" ], "name": "S14: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777706589", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1203", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$520 := ROW_NUMBER($1203) OVER (ORDER BY $1211 ASC)" ] }, { "kind": "SORT", "substeps": [ "$590 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1220, $520, $1221, $1222", "TO __stage14_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.009259259259259259, "computeRatioMax": 0.009259259259259259, "endMs": "1665777706610", "id": "21", "inputStages": [ "18" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665777706600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$782 := shard_sink_stats($781)" ] }, { "kind": "COMPUTE", "substeps": [ "$781 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$782", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.018518518518518517, "endMs": "1665777706639", "id": "22", "inputStages": [ "21" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777706602", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$782", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$783 := root_sink_stats($782)" ] }, { "kind": "WRITE", "substeps": [ "$783", "TO __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.006944444444444444, "writeRatioMax": 0.006944444444444444 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.05324074074074074, "endMs": "1665777706731", "id": "23", "inputStages": [ "19" ], "name": "S17: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "756", "shuffleOutputBytesSpilled": "0", "slotMs": "3476", "startMs": "1665777706667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $640", "$580 := MIN($641)" ] }, { "kind": "WRITE", "substeps": [ "$580, $1040", "TO __stage17_output", "BY HASH($1040)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.009259259259259259, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.06481481481481481 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.027777777777777776, "computeRatioMax": 0.027777777777777776, "endMs": "1665777706737", "id": "24", "inputStages": [ "18", "22" ], "name": "S18: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777706687", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$783", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage12_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$460 := ROW_NUMBER($783) OVER (ORDER BY $791 ASC)" ] }, { "kind": "SORT", "substeps": [ "$550 ASC" ] }, { "kind": "WRITE", "substeps": [ "$800, $460, $801, $802", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.07407407407407407, "writeRatioMax": 0.07407407407407407 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "22", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.05092592592592592, "endMs": "1665777706767", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "198", "shuffleOutputBytesSpilled": "0", "slotMs": "3474", "startMs": "1665777706705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1250 := $660", "$600 := MIN($661)" ] }, { "kind": "WRITE", "substeps": [ "$600, $1250", "TO __stage19_output", "BY HASH($1250)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.009259259259259259, "writeMsAvg": "19", "writeMsMax": "29", "writeRatioAvg": 0.04398148148148148, "writeRatioMax": 0.06712962962962964 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "15", "computeRatioAvg": 0.02546296296296296, "computeRatioMax": 0.034722222222222224, "endMs": "1665777706817", "id": "26", "inputStages": [ "23" ], "name": "S1A: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "490", "startMs": "1665777706759", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $1040", "FROM __stage17_output" ] }, { "kind": "COMPUTE", "substeps": [ "$430 := coalesce($1050, 0)", "$431 := coalesce($1050, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040", "$510 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "26", "writeMsMax": "28", "writeRatioAvg": 0.06018518518518518, "writeRatioMax": 0.06481481481481481 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.037037037037037035, "endMs": "1665777706877", "id": "28", "inputStages": [ "24" ], "name": "S1C: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "288", "shuffleOutputBytesSpilled": "0", "slotMs": "3129", "startMs": "1665777706805", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $620", "$560 := MIN($621)" ] }, { "kind": "WRITE", "substeps": [ "$560, $830", "TO __stage1C_output", "BY HASH($830)" ] } ], "waitMsAvg": "4", "waitMsMax": "8", "waitRatioAvg": 0.009259259259259259, "waitRatioMax": 0.018518518518518517, "writeMsAvg": "13", "writeMsMax": "25", "writeRatioAvg": 0.03009259259259259, "writeRatioMax": 0.05787037037037037 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "13", "computeRatioAvg": 0.023148148148148147, "computeRatioMax": 0.03009259259259259, "endMs": "1665777706880", "id": "29", "inputStages": [ "25" ], "name": "S1D: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "387", "startMs": "1665777706822", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1250", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$450 := coalesce($1260, 0)", "$451 := coalesce($1260, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1250", "$540 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$450, $451, $540", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "14", "writeMsMax": "16", "writeRatioAvg": 0.032407407407407406, "writeRatioMax": 0.037037037037037035 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.04861111111111111, "endMs": "1665777706919", "id": "31", "inputStages": [ "26" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "3297", "startMs": "1665777706852", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.016203703703703703, "waitRatioMax": 0.020833333333333332, "writeMsAvg": "13", "writeMsMax": "25", "writeRatioAvg": 0.03009259259259259, "writeRatioMax": 0.05787037037037037 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "21", "computeRatioAvg": 0.023148148148148147, "computeRatioMax": 0.04861111111111111, "endMs": "1665777706956", "id": "32", "inputStages": [ "19", "31" ], "name": "S20: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1300", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "4494", "startMs": "1665777706869", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$430, $431, $510", "FROM __stage1F_output" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $500, $1061 := $501, $1062 := $502, $1063 := $510", "INNER HASH JOIN EACH WITH ALL ON $420 = $430, $421 = $431" ] }, { "kind": "COMPUTE", "substeps": [ "$420 := coalesce($501, 0)", "$421 := coalesce($501, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1060, $1061, $1062, $1063", "TO __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "12", "writeMsMax": "29", "writeRatioAvg": 0.027777777777777776, "writeRatioMax": 0.06712962962962964 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "13", "computeRatioAvg": 0.023148148148148147, "computeRatioMax": 0.03009259259259259, "endMs": "1665777706959", "id": "33", "inputStages": [ "28" ], "name": "S21: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "501", "startMs": "1665777706909", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $830", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($840, 0)", "$411 := coalesce($840, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830", "$480 := MIN($560)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $480", "TO __stage21_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0023148148148148147, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "18", "writeMsMax": "27", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "23", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.05324074074074074, "endMs": "1665777707033", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "3253", "startMs": "1665777706930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "13", "waitMsMax": "20", "waitRatioAvg": 0.03009259259259259, "waitRatioMax": 0.046296296296296294, "writeMsAvg": "9", "writeMsMax": "55", "writeRatioAvg": 0.020833333333333332, "writeRatioMax": 0.12731481481481483 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.046296296296296294, "endMs": "1665777707046", "id": "36", "inputStages": [ "35", "20" ], "name": "S24: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "121", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "3142", "startMs": "1665777706959", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$450, $451, $540", "FROM __stage23_output" ] }, { "kind": "JOIN", "substeps": [ "$1270 := $530, $1271 := $531, $1272 := $532, $1273 := $540", "INNER HASH JOIN EACH WITH ALL ON $440 = $450, $441 = $451" ] }, { "kind": "COMPUTE", "substeps": [ "$440 := coalesce($531, 0)", "$441 := coalesce($531, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $1271, $1272, $1273", "TO __stage24_output" ] } ], "waitMsAvg": "5", "waitMsMax": "13", "waitRatioAvg": 0.011574074074074073, "waitRatioMax": 0.03009259259259259, "writeMsAvg": "10", "writeMsMax": "26", "writeRatioAvg": 0.023148148148148147, "writeRatioMax": 0.06018518518518518 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.020833333333333332, "endMs": "1665777707044", "id": "37", "inputStages": [ "32" ], "name": "S25: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777706982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage20_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1065 := shard_sink_stats($1064)" ] }, { "kind": "COMPUTE", "substeps": [ "$1064 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1065", "TO __stage25_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.009259259259259259, "waitRatioMax": 0.009259259259259259, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.032407407407407406, "writeRatioMax": 0.032407407407407406 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.018518518518518517, "endMs": "1665777707044", "id": "38", "inputStages": [ "37" ], "name": "S26: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777706983", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1065", "FROM __stage25_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1066 := root_sink_stats($1065)" ] }, { "kind": "WRITE", "substeps": [ "$1066", "TO __stage26_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.009259259259259259, "waitRatioMax": 0.009259259259259259, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.004629629629629629, "writeRatioMax": 0.004629629629629629 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.034722222222222224, "endMs": "1665777707090", "id": "39", "inputStages": [ "33" ], "name": "S27: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "15", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "3499", "startMs": "1665777707011", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "8", "waitMsMax": "11", "waitRatioAvg": 0.018518518518518517, "waitRatioMax": 0.02546296296296296, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.032407407407407406, "writeRatioMax": 0.05787037037037037 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.041666666666666664, "endMs": "1665777707096", "id": "40", "inputStages": [ "39", "24" ], "name": "S28: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "226", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "4156", "startMs": "1665777707033", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $480", "FROM __stage27_output" ] }, { "kind": "JOIN", "substeps": [ "$850 := $470, $851 := $471, $852 := $472, $853 := $480", "INNER HASH JOIN EACH WITH ALL ON $400 = $410, $401 = $411" ] }, { "kind": "COMPUTE", "substeps": [ "$400 := coalesce($471, 0)", "$401 := coalesce($471, 1)" ] }, { "kind": "WRITE", "substeps": [ "$850, $851, $852, $853", "TO __stage28_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.06712962962962964 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.034722222222222224, "computeRatioMax": 0.034722222222222224, "endMs": "1665777707119", "id": "41", "inputStages": [ "38", "32" ], "name": "S29: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "2226", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777707069", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1066", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage20_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$250 := ROW_NUMBER($1066) OVER (ORDER BY $1072 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1062 ASC" ] }, { "kind": "WRITE", "substeps": [ "$250, $1080, $1081, $1082, $1083", "TO __stage29_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05092592592592592, "writeRatioMax": 0.05092592592592592 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.023148148148148147, "computeRatioMax": 0.023148148148148147, "endMs": "1665777707109", "id": "42", "inputStages": [ "36" ], "name": "S2A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777707077", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage24_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1275 := shard_sink_stats($1274)" ] }, { "kind": "COMPUTE", "substeps": [ "$1274 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1275", "TO __stage2A_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02546296296296296, "writeRatioMax": 0.02546296296296296 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.011574074074074073, "computeRatioMax": 0.011574074074074073, "endMs": "1665777707123", "id": "43", "inputStages": [ "42" ], "name": "S2B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777707076", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1275", "FROM __stage2A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1276 := root_sink_stats($1275)" ] }, { "kind": "WRITE", "substeps": [ "$1276", "TO __stage2B_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.006944444444444444, "writeRatioMax": 0.006944444444444444 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016203703703703703, "computeRatioMax": 0.016203703703703703, "endMs": "1665777707139", "id": "44", "inputStages": [ "40" ], "name": "S2C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777707104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage28_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$855 := shard_sink_stats($854)" ] }, { "kind": "COMPUTE", "substeps": [ "$854 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$855", "TO __stage2C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.032407407407407406, "writeRatioMax": 0.032407407407407406 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.020833333333333332, "endMs": "1665777707158", "id": "45", "inputStages": [ "44" ], "name": "S2D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777707107", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$855", "FROM __stage2C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$856 := root_sink_stats($855)" ] }, { "kind": "WRITE", "substeps": [ "$856", "TO __stage2D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.011574074074074073, "writeRatioMax": 0.011574074074074073 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.037037037037037035, "endMs": "1665777707213", "id": "46", "inputStages": [ "41" ], "name": "S2E: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1092", "shuffleOutputBytesSpilled": "0", "slotMs": "3348", "startMs": "1665777707163", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage29_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $370", "$320 := MIN($371)" ] }, { "kind": "WRITE", "substeps": [ "$320, $1110", "TO __stage2E_output", "BY HASH($1110)" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.009259259259259259, "waitRatioMax": 0.011574074074074073, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.06712962962962964 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03009259259259259, "computeRatioMax": 0.03009259259259259, "endMs": "1665777707231", "id": "47", "inputStages": [ "43", "36" ], "name": "S2F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "583", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777707183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1276", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage24_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$280 := ROW_NUMBER($1276) OVER (ORDER BY $1282 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1272 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $1290, $1291, $1292, $1293", "TO __stage2F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05092592592592592, "writeRatioMax": 0.05092592592592592 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.023148148148148147, "computeRatioMax": 0.023148148148148147, "endMs": "1665777707259", "id": "48", "inputStages": [ "45", "40" ], "name": "S30: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "848", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777707197", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$856", "FROM __stage2D_output" ] }, { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage28_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := ROW_NUMBER($856) OVER (ORDER BY $862 ASC)" ] }, { "kind": "SORT", "substeps": [ "$852 ASC" ] }, { "kind": "WRITE", "substeps": [ "$220, $870, $871, $872, $873", "TO __stage30_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023148148148148147, "waitRatioMax": 0.0023148148148148147, "writeMsAvg": "40", "writeMsMax": "40", "writeRatioAvg": 0.09259259259259259, "writeRatioMax": 0.09259259259259259 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "24", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.05555555555555555, "endMs": "1665777707331", "id": "49", "inputStages": [ "47" ], "name": "S31: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "286", "shuffleOutputBytesSpilled": "0", "slotMs": "2927", "startMs": "1665777707267", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1320 := $390", "$330 := MIN($391)" ] }, { "kind": "WRITE", "substeps": [ "$330, $1320", "TO __stage31_output", "BY HASH($1320)" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.011574074074074073, "waitRatioMax": 0.016203703703703703, "writeMsAvg": "10", "writeMsMax": "21", "writeRatioAvg": 0.023148148148148147, "writeRatioMax": 0.04861111111111111 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.03935185185185185, "endMs": "1665777707344", "id": "50", "inputStages": [ "48" ], "name": "S32: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "416", "shuffleOutputBytesSpilled": "0", "slotMs": "3157", "startMs": "1665777707295", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage30_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $350", "$310 := MIN($351)" ] }, { "kind": "WRITE", "substeps": [ "$310, $900", "TO __stage32_output", "BY HASH($900)" ] } ], "waitMsAvg": "5", "waitMsMax": "8", "waitRatioAvg": 0.011574074074074073, "waitRatioMax": 0.018518518518518517, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.06018518518518518 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.034722222222222224, "endMs": "1665777707411", "id": "51", "inputStages": [ "49" ], "name": "S33: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "343", "startMs": "1665777707366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $1320", "FROM __stage31_output" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := coalesce($1330, NUMERIC<...>)", "$211 := coalesce($1330, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1330 := $1320", "$300 := MIN($330)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $300", "TO __stage33_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "15", "writeMsMax": "23", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.05324074074074074 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.037037037037037035, "endMs": "1665777707456", "id": "53", "inputStages": [ "46" ], "name": "S35: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "442", "startMs": "1665777707399", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $1110", "FROM __stage2E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($1120, NUMERIC<...>)", "$191 := coalesce($1120, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1110", "$270 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $270", "TO __stage35_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "24", "writeMsMax": "29", "writeRatioAvg": 0.05555555555555555, "writeRatioMax": 0.06712962962962964 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "12", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.027777777777777776, "endMs": "1665777707505", "id": "55", "inputStages": [ "50" ], "name": "S37: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "377", "startMs": "1665777707450", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $900", "FROM __stage32_output" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($910, NUMERIC<...>)", "$171 := coalesce($910, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$240 := MIN($310)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $240", "TO __stage37_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "21", "writeMsMax": "28", "writeRatioAvg": 0.04861111111111111, "writeRatioMax": 0.06481481481481481 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.04398148148148148, "endMs": "1665777707578", "id": "57", "inputStages": [ "51" ], "name": "S39: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "4038", "startMs": "1665777707479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage33_output" ] } ], "waitMsAvg": "11", "waitMsMax": "16", "waitRatioAvg": 0.02546296296296296, "waitRatioMax": 0.037037037037037035, "writeMsAvg": "10", "writeMsMax": "21", "writeRatioAvg": 0.023148148148148147, "writeRatioMax": 0.04861111111111111 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "29", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.06712962962962964, "endMs": "1665777707637", "id": "58", "inputStages": [ "53" ], "name": "S3A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "3863", "startMs": "1665777707500", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage35_output" ] } ], "waitMsAvg": "5", "waitMsMax": "9", "waitRatioAvg": 0.011574074074074073, "waitRatioMax": 0.020833333333333332, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.06018518518518518 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "24", "computeRatioAvg": 0.018518518518518517, "computeRatioMax": 0.05555555555555555, "endMs": "1665777707652", "id": "59", "inputStages": [ "55" ], "name": "S3B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "4384", "startMs": "1665777707522", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage37_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "20", "writeMsMax": "36", "writeRatioAvg": 0.046296296296296294, "writeRatioMax": 0.08333333333333333 }, { "completedParallelInputs": "300", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.04861111111111111, "endMs": "1665777707658", "id": "60", "inputStages": [ "58", "57", "47", "41", "48", "59" ], "name": "S3C: Join+", "parallelInputs": "300", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1695", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "9201", "startMs": "1665777707536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage30_output" ] }, { "kind": "READ", "substeps": [ "$170, $171, $240", "FROM __stage3B_output" ] }, { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage29_output" ] }, { "kind": "READ", "substeps": [ "$190, $191, $270", "FROM __stage3A_output" ] }, { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$210, $211, $300", "FROM __stage39_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $921 ASC, $923 ASC, $920 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := 'web'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($921, 10), less_or_equal($923, 10))" ] }, { "kind": "JOIN", "substeps": [ "$920 := $230, $921 := $231, $922 := $232, $923 := $240", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($233, NUMERIC<...>)", "$161 := coalesce($233, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$110 ASC, $1131 ASC, $1133 ASC, $1130 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := 'catalog'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1131, 10), less_or_equal($1133, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1130 := $260, $1131 := $261, $1132 := $262, $1133 := $270", "INNER HASH JOIN EACH WITH ALL ON $180 = $190, $181 = $191" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := coalesce($263, NUMERIC<...>)", "$181 := coalesce($263, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1341 ASC, $1343 ASC, $1340 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1341, 10), less_or_equal($1343, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1340 := $290, $1341 := $291, $1342 := $292, $1343 := $300", "INNER HASH JOIN EACH WITH ALL ON $200 = $210, $201 = $211" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($293, NUMERIC<...>)", "$201 := coalesce($293, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage3C_output" ] } ], "waitMsAvg": "14", "waitMsMax": "20", "waitRatioAvg": 0.032407407407407406, "waitRatioMax": 0.046296296296296294, "writeMsAvg": "12", "writeMsMax": "45", "writeRatioAvg": 0.027777777777777776, "writeRatioMax": 0.10416666666666667 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.020833333333333332, "computeRatioMax": 0.020833333333333332, "endMs": "1665777707654", "id": "61", "inputStages": [ "60" ], "name": "S3D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777707576", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage3C_output" ] }, { "kind": "SORT", "substeps": [ "$90 ASC, $93 ASC, $94 ASC, $91 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1360, $1361, $1362, $1363, $1364", "TO __stage3D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.013888888888888888 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "24", "elapsedMs": "721", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2983" }, { "activeUnits": "409", "completedUnits": "1900", "elapsedMs": "1954", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "89295" } ], "totalBytesBilled": "338690048", "totalBytesProcessed": "337676184", "totalPartitionsProcessed": "0", "totalSlotMs": "89295", "transferredBytes": "0" }, "startTime": "1665777705837", "totalBytesProcessed": "337676184", "totalSlotMs": "89295" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf175dbae_a988_48f4_943c_f1bfaadb2b99" }, "priority": "INTERACTIVE", "query": "select channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(sum(coalesce(wr.wr_return_quantity,0)))/\n \t\tsum(coalesce(ws.ws_quantity,0)) as return_ratio\n \t\t,(sum(coalesce(wr.wr_return_amt,0)))/\n \t\tsum(coalesce(ws.ws_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n and ws.ws_net_paid > 0\n and ws.ws_quantity > 0\n and ws_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union all\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,sum(coalesce(cr.cr_return_quantity,0))/\n \t\tsum(coalesce(cs.cs_quantity,0)) as return_ratio\n \t\t,sum(coalesce(cr.cr_return_amount,0))/\n \t\tsum(coalesce(cs.cs_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n and cs.cs_net_paid > 0\n and cs.cs_quantity > 0\n and cs_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union all\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,sum(coalesce(sr.sr_return_quantity,0))/sum(coalesce(sts.ss_quantity,0)) as return_ratio\n \t\t,sum(coalesce(sr.sr_return_amt,0))/sum(coalesce(sts.ss_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n and sts.ss_net_paid > 0 \n and sts.ss_quantity > 0\n and ss_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n order by 1,4,5,2\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "UqUXcJHraG4LgLWfugZNGQ==", "id": "test-project-364309:europe-west1.query49_1665777709", "jobReference": { "jobId": "query49_1665777709", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query49_1665777709?location=europe-west1", "statistics": { "creationTime": "1665777710152", "endTime": "1665777711876", "finalExecutionDurationMs": "1430", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "337676184", "performanceInsights": { "avgPreviousExecutionMs": "1501" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.018617021276595744, "computeRatioMax": 0.018617021276595744, "endMs": "1665777710378", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015957446808510637, "readRatioMax": 0.015957446808510637, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777710351", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(equal($21, 2001), equal($22, 12))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0398936170212766, "writeRatioMax": 0.0398936170212766 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.15159574468085107, "computeRatioMax": 0.15159574468085107, "endMs": "1665777710412", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.031914893617021274, "readRatioMax": 0.031914893617021274, "recordsRead": "287514", "recordsWritten": "507", "shuffleOutputBytes": "22236", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665777710364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:sr_item_sk, $81:sr_ticket_number, $82:sr_return_quantity, $83:sr_return_amt", "FROM store_returns", "WHERE greater($83, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.015957446808510637, "writeRatioMax": 0.015957446808510637 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.023936170212765957, "endMs": "1665777710441", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.018617021276595744, "readRatioMax": 0.018617021276595744, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777710391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 12))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05851063829787234, "writeRatioMax": 0.05851063829787234 }, { "completedParallelInputs": "1", "computeMsAvg": "62", "computeMsMax": "62", "computeRatioAvg": 0.16489361702127658, "computeRatioMax": 0.16489361702127658, "endMs": "1665777710456", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.031914893617021274, "readRatioMax": 0.031914893617021274, "recordsRead": "144067", "recordsWritten": "1217", "shuffleOutputBytes": "53452", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665777710403", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cr_item_sk, $61:cr_order_number, $62:cr_return_quantity, $63:cr_return_amount", "FROM catalog_returns", "WHERE greater($63, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.026595744680851064, "writeRatioMax": 0.026595744680851064 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026595744680851064, "computeRatioMax": 0.026595744680851064, "endMs": "1665777710466", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015957446808510637, "readRatioMax": 0.015957446808510637, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777710433", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_moy", "FROM date_dim", "WHERE and(equal($2, 2001), equal($3, 12))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.015957446808510637, "writeRatioMax": 0.015957446808510637 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.0851063829787234, "computeRatioMax": 0.0851063829787234, "endMs": "1665777710510", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.047872340425531915, "readRatioMax": 0.047872340425531915, "recordsRead": "71763", "recordsWritten": "632", "shuffleOutputBytes": "27680", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665777710445", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_item_sk, $41:wr_order_number, $42:wr_return_quantity, $43:wr_return_amt", "FROM web_returns", "WHERE greater($43, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.06648936170212766, "writeRatioMax": 0.06648936170212766 }, { "completedParallelInputs": "6", "computeMsAvg": "238", "computeMsMax": "272", "computeRatioAvg": 0.6329787234042553, "computeRatioMax": 0.723404255319149, "endMs": "1665777710657", "id": "9", "inputStages": [ "1", "0" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "28", "readRatioAvg": 0.05851063829787234, "readRatioMax": 0.07446808510638298, "recordsRead": "2883632", "recordsWritten": "11", "shuffleOutputBytes": "671", "shuffleOutputBytesSpilled": "0", "slotMs": "1295", "startMs": "1665777710477", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_ticket_number, $73:ss_quantity, $74:ss_net_paid, $75:ss_net_profit", "FROM store_sales", "WHERE and(greater($75, NUMERIC<...>), greater($74, NUMERIC<...>), greater($73, 0))" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1190 := $1180", "$690 := SUM($720)", "$691 := SUM($721)", "$692 := SUM($722)", "$693 := SUM($723)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($1183, 0)", "$721 := coalesce($1181, 0)", "$722 := coalesce($1184, NUMERIC<...>)", "$723 := coalesce($1182, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1161, $1181 := $1162, $1182 := $1163, $1183 := $1164, $1184 := $1165", "INNER HASH JOIN EACH WITH ALL ON $1160 = $20" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $70, $1161 := $71, $1162 := $73, $1163 := $74, $1164 := $82, $1165 := $83", "INNER HASH JOIN EACH WITH ALL ON $72 = $81, $71 = $80" ] }, { "kind": "WRITE", "substeps": [ "$1190, $690, $691, $692, $693", "TO __stage09_output", "BY HASH($1190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.015957446808510637, "writeRatioMax": 0.018617021276595744 }, { "completedParallelInputs": "5", "computeMsAvg": "174", "computeMsMax": "199", "computeRatioAvg": 0.4627659574468085, "computeRatioMax": 0.5292553191489362, "endMs": "1665777710657", "id": "10", "inputStages": [ "4", "3" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "42", "readRatioAvg": 0.06914893617021277, "readRatioMax": 0.11170212765957446, "recordsRead": "1447788", "recordsWritten": "42", "shuffleOutputBytes": "2562", "shuffleOutputBytesSpilled": "0", "slotMs": "874", "startMs": "1665777710492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_item_sk, $52:cs_order_number, $53:cs_quantity, $54:cs_net_paid, $55:cs_net_profit", "FROM catalog_sales", "WHERE and(greater($55, NUMERIC<...>), greater($54, NUMERIC<...>), greater($53, 0))" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$680 := SUM($710)", "$681 := SUM($711)", "$682 := SUM($712)", "$683 := SUM($713)" ] }, { "kind": "COMPUTE", "substeps": [ "$710 := coalesce($973, 0)", "$711 := coalesce($971, 0)", "$712 := coalesce($974, NUMERIC<...>)", "$713 := coalesce($972, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$970 := $951, $971 := $952, $972 := $953, $973 := $954, $974 := $955", "INNER HASH JOIN EACH WITH ALL ON $950 = $10" ] }, { "kind": "JOIN", "substeps": [ "$950 := $50, $951 := $51, $952 := $53, $953 := $54, $954 := $62, $955 := $63", "INNER HASH JOIN EACH WITH ALL ON $52 = $61, $51 = $60" ] }, { "kind": "WRITE", "substeps": [ "$980, $680, $681, $682, $683", "TO __stage0A_output", "BY HASH($980)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.018617021276595744, "writeRatioMax": 0.02127659574468085 }, { "completedParallelInputs": "1", "computeMsAvg": "376", "computeMsMax": "376", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777710688", "id": "11", "inputStages": [ "6", "7" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.05053191489361702, "readRatioMax": 0.05053191489361702, "recordsRead": "720047", "recordsWritten": "16", "shuffleOutputBytes": "976", "shuffleOutputBytesSpilled": "0", "slotMs": "289", "startMs": "1665777710518", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_order_number, $33:ws_quantity, $34:ws_net_paid, $35:ws_net_profit", "FROM web_sales", "WHERE and(greater($35, NUMERIC<...>), greater($34, NUMERIC<...>), greater($33, 0))" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $770 := $760", "$670 := SUM($700)", "$671 := SUM($701)", "$672 := SUM($702)", "$673 := SUM($703)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := coalesce($763, 0)", "$701 := coalesce($761, 0)", "$702 := coalesce($764, NUMERIC<...>)", "$703 := coalesce($762, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $741, $761 := $742, $762 := $743, $763 := $744, $764 := $745", "INNER HASH JOIN EACH WITH ALL ON $740 = $1" ] }, { "kind": "JOIN", "substeps": [ "$740 := $30, $741 := $31, $742 := $33, $743 := $34, $744 := $42, $745 := $43", "INNER HASH JOIN EACH WITH ALL ON $32 = $41, $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$770, $670, $671, $672, $673", "TO __stage0B_output", "BY HASH($770)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010638297872340425, "writeRatioMax": 0.010638297872340425 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.023936170212765957, "endMs": "1665777710766", "id": "12", "inputStages": [ "10" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777710691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$980, $680, $681, $682, $683", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := divide(CAST($630 AS DOUBLE), CAST($631 AS DOUBLE))", "$571 := divide($632, $633)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $990 := $980", "$630 := SUM($680)", "$631 := SUM($681)", "$632 := SUM($682)", "$633 := SUM($683)" ] }, { "kind": "WRITE", "substeps": [ "$990, $570, $571", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.09574468085106383, "writeRatioMax": 0.09574468085106383 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.031914893617021274, "computeRatioMax": 0.031914893617021274, "endMs": "1665777710760", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "385", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777710721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1190, $690, $691, $692, $693", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := divide(CAST($650 AS DOUBLE), CAST($651 AS DOUBLE))", "$591 := divide($652, $653)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$650 := SUM($690)", "$651 := SUM($691)", "$652 := SUM($692)", "$653 := SUM($693)" ] }, { "kind": "WRITE", "substeps": [ "$1200, $590, $591", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.05053191489361702, "writeRatioMax": 0.05053191489361702 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026595744680851064, "computeRatioMax": 0.026595744680851064, "endMs": "1665777710783", "id": "14", "inputStages": [ "11" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "560", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777710746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $670, $671, $672, $673", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := divide(CAST($610 AS DOUBLE), CAST($611 AS DOUBLE))", "$551 := divide($612, $613)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $770", "$610 := SUM($670)", "$611 := SUM($671)", "$612 := SUM($672)", "$613 := SUM($673)" ] }, { "kind": "WRITE", "substeps": [ "$780, $550, $551", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0398936170212766, "writeRatioMax": 0.0398936170212766 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015957446808510637, "computeRatioMax": 0.015957446808510637, "endMs": "1665777710802", "id": "15", "inputStages": [ "13" ], "name": "S0F: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777710769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1202 := shard_sink_stats($1201)" ] }, { "kind": "COMPUTE", "substeps": [ "$1201 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1202", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02925531914893617, "writeRatioMax": 0.02925531914893617 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015957446808510637, "computeRatioMax": 0.015957446808510637, "endMs": "1665777710820", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777710771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1203 := root_sink_stats($1202)" ] }, { "kind": "WRITE", "substeps": [ "$1203", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.005319148936170213, "writeRatioMax": 0.005319148936170213 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.023936170212765957, "endMs": "1665777710803", "id": "17", "inputStages": [ "12" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777710770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$992 := shard_sink_stats($991)" ] }, { "kind": "COMPUTE", "substeps": [ "$991 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$992", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.034574468085106384, "writeRatioMax": 0.034574468085106384 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.018617021276595744, "computeRatioMax": 0.018617021276595744, "endMs": "1665777710820", "id": "18", "inputStages": [ "17" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777710771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$992", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$993 := root_sink_stats($992)" ] }, { "kind": "WRITE", "substeps": [ "$993", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.005319148936170213, "writeRatioMax": 0.005319148936170213 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015957446808510637, "computeRatioMax": 0.015957446808510637, "endMs": "1665777710803", "id": "19", "inputStages": [ "14" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665777710791", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$782 := shard_sink_stats($781)" ] }, { "kind": "COMPUTE", "substeps": [ "$781 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$782", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007978723404255319, "writeRatioMax": 0.007978723404255319 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.018617021276595744, "computeRatioMax": 0.018617021276595744, "endMs": "1665777710852", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777710793", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$782", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$783 := root_sink_stats($782)" ] }, { "kind": "WRITE", "substeps": [ "$783", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "40", "writeMsMax": "40", "writeRatioAvg": 0.10638297872340426, "writeRatioMax": 0.10638297872340426 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.04521276595744681, "computeRatioMax": 0.04521276595744681, "endMs": "1665777710906", "id": "21", "inputStages": [ "16", "13" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777710854", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1203", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$520 := ROW_NUMBER($1203) OVER (ORDER BY $1211 ASC)" ] }, { "kind": "SORT", "substeps": [ "$590 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1220, $520, $1221, $1222", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06914893617021277, "writeRatioMax": 0.06914893617021277 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03723404255319149, "computeRatioMax": 0.03723404255319149, "endMs": "1665777710915", "id": "22", "inputStages": [ "12", "18" ], "name": "S16: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777710872", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$993", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$490 := ROW_NUMBER($993) OVER (ORDER BY $1001 ASC)" ] }, { "kind": "SORT", "substeps": [ "$570 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1010, $490, $1011, $1012", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06914893617021277, "writeRatioMax": 0.06914893617021277 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.023936170212765957, "endMs": "1665777710931", "id": "23", "inputStages": [ "14", "20" ], "name": "S17: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777710883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$783", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage0E_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$460 := ROW_NUMBER($783) OVER (ORDER BY $791 ASC)" ] }, { "kind": "SORT", "substeps": [ "$550 ASC" ] }, { "kind": "WRITE", "substeps": [ "$800, $460, $801, $802", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.05585106382978723, "writeRatioMax": 0.05585106382978723 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.05053191489361702, "endMs": "1665777710974", "id": "24", "inputStages": [ "21" ], "name": "S18: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "198", "shuffleOutputBytesSpilled": "0", "slotMs": "2992", "startMs": "1665777710927", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1250 := $660", "$600 := MIN($661)" ] }, { "kind": "WRITE", "substeps": [ "$600, $1250", "TO __stage18_output", "BY HASH($1250)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.007978723404255319, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.05851063829787234 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.04521276595744681, "endMs": "1665777710979", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "756", "shuffleOutputBytesSpilled": "0", "slotMs": "2577", "startMs": "1665777710941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $640", "$580 := MIN($641)" ] }, { "kind": "WRITE", "substeps": [ "$580, $1040", "TO __stage19_output", "BY HASH($1040)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "13", "writeMsMax": "21", "writeRatioAvg": 0.034574468085106384, "writeRatioMax": 0.05585106382978723 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "22", "computeRatioAvg": 0.026595744680851064, "computeRatioMax": 0.05851063829787234, "endMs": "1665777711012", "id": "26", "inputStages": [ "23" ], "name": "S1A: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "288", "shuffleOutputBytesSpilled": "0", "slotMs": "3555", "startMs": "1665777710958", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $620", "$560 := MIN($621)" ] }, { "kind": "WRITE", "substeps": [ "$560, $830", "TO __stage1A_output", "BY HASH($830)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "19", "writeMsMax": "29", "writeRatioAvg": 0.05053191489361702, "writeRatioMax": 0.07712765957446809 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "12", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.031914893617021274, "endMs": "1665777711030", "id": "27", "inputStages": [ "24" ], "name": "S1B: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "396", "startMs": "1665777710993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1250", "FROM __stage18_output" ] }, { "kind": "COMPUTE", "substeps": [ "$450 := coalesce($1260, 0)", "$451 := coalesce($1260, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1250", "$540 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$450, $451, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "14", "writeMsMax": "16", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.0425531914893617 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "11", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.02925531914893617, "endMs": "1665777711065", "id": "29", "inputStages": [ "25" ], "name": "S1D: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "267", "startMs": "1665777711018", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $1040", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$430 := coalesce($1050, 0)", "$431 := coalesce($1050, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040", "$510 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $510", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "14", "writeMsMax": "16", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.0425531914893617 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "14", "computeRatioAvg": 0.026595744680851064, "computeRatioMax": 0.03723404255319149, "endMs": "1665777711083", "id": "31", "inputStages": [ "26" ], "name": "S1F: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "359", "startMs": "1665777711042", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $830", "FROM __stage1A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($840, 0)", "$411 := coalesce($840, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830", "$480 := MIN($560)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $480", "TO __stage1F_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "22", "writeMsMax": "31", "writeRatioAvg": 0.05851063829787234, "writeRatioMax": 0.08244680851063829 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.018617021276595744, "computeRatioMax": 0.0425531914893617, "endMs": "1665777711122", "id": "33", "inputStages": [ "27" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "3038", "startMs": "1665777711057", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.007978723404255319, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.034574468085106384, "writeRatioMax": 0.05319148936170213 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.047872340425531915, "endMs": "1665777711128", "id": "34", "inputStages": [ "33", "21" ], "name": "S22: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "121", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "3360", "startMs": "1665777711068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$450, $451, $540", "FROM __stage21_output" ] }, { "kind": "JOIN", "substeps": [ "$1270 := $530, $1271 := $531, $1272 := $532, $1273 := $540", "INNER HASH JOIN EACH WITH ALL ON $440 = $450, $441 = $451" ] }, { "kind": "COMPUTE", "substeps": [ "$440 := coalesce($531, 0)", "$441 := coalesce($531, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $1271, $1272, $1273", "TO __stage22_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.034574468085106384, "writeRatioMax": 0.05319148936170213 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "18", "computeRatioAvg": 0.018617021276595744, "computeRatioMax": 0.047872340425531915, "endMs": "1665777711132", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "2797", "startMs": "1665777711075", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.007978723404255319, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.05585106382978723 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "31", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.08244680851063829, "endMs": "1665777711158", "id": "36", "inputStages": [ "35", "22" ], "name": "S24: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1300", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "3628", "startMs": "1665777711088", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$430, $431, $510", "FROM __stage23_output" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $500, $1061 := $501, $1062 := $502, $1063 := $510", "INNER HASH JOIN EACH WITH ALL ON $420 = $430, $421 = $431" ] }, { "kind": "COMPUTE", "substeps": [ "$420 := coalesce($501, 0)", "$421 := coalesce($501, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1060, $1061, $1062, $1063", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.007978723404255319, "writeMsAvg": "12", "writeMsMax": "38", "writeRatioAvg": 0.031914893617021274, "writeRatioMax": 0.10106382978723404 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.02127659574468085, "computeRatioMax": 0.047872340425531915, "endMs": "1665777711145", "id": "37", "inputStages": [ "31" ], "name": "S25: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "15", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "3174", "startMs": "1665777711098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.05053191489361702 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.02127659574468085, "computeRatioMax": 0.05319148936170213, "endMs": "1665777711164", "id": "38", "inputStages": [ "37", "23" ], "name": "S26: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "226", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "2697", "startMs": "1665777711111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $480", "FROM __stage25_output" ] }, { "kind": "JOIN", "substeps": [ "$850 := $470, $851 := $471, $852 := $472, $853 := $480", "INNER HASH JOIN EACH WITH ALL ON $400 = $410, $401 = $411" ] }, { "kind": "COMPUTE", "substeps": [ "$400 := coalesce($471, 0)", "$401 := coalesce($471, 1)" ] }, { "kind": "WRITE", "substeps": [ "$850, $851, $852, $853", "TO __stage26_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "11", "writeMsMax": "17", "writeRatioAvg": 0.02925531914893617, "writeRatioMax": 0.04521276595744681 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.018617021276595744, "computeRatioMax": 0.018617021276595744, "endMs": "1665777711163", "id": "39", "inputStages": [ "34" ], "name": "S27: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777711130", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage22_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1275 := shard_sink_stats($1274)" ] }, { "kind": "COMPUTE", "substeps": [ "$1274 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1275", "TO __stage27_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0398936170212766, "writeRatioMax": 0.0398936170212766 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015957446808510637, "computeRatioMax": 0.015957446808510637, "endMs": "1665777711168", "id": "40", "inputStages": [ "39" ], "name": "S28: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777711131", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1275", "FROM __stage27_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1276 := root_sink_stats($1275)" ] }, { "kind": "WRITE", "substeps": [ "$1276", "TO __stage28_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0026595744680851063, "writeRatioMax": 0.0026595744680851063 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015957446808510637, "computeRatioMax": 0.015957446808510637, "endMs": "1665777711293", "id": "41", "inputStages": [ "36" ], "name": "S29: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777711257", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage24_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1065 := shard_sink_stats($1064)" ] }, { "kind": "COMPUTE", "substeps": [ "$1064 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1065", "TO __stage29_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07180851063829788, "writeRatioMax": 0.07180851063829788 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015957446808510637, "computeRatioMax": 0.015957446808510637, "endMs": "1665777711313", "id": "42", "inputStages": [ "41" ], "name": "S2A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777711259", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1065", "FROM __stage29_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1066 := root_sink_stats($1065)" ] }, { "kind": "WRITE", "substeps": [ "$1066", "TO __stage2A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007978723404255319, "waitRatioMax": 0.007978723404255319, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007978723404255319, "writeRatioMax": 0.007978723404255319 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015957446808510637, "computeRatioMax": 0.015957446808510637, "endMs": "1665777711283", "id": "43", "inputStages": [ "38" ], "name": "S2B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777711259", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage26_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$855 := shard_sink_stats($854)" ] }, { "kind": "COMPUTE", "substeps": [ "$854 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$855", "TO __stage2B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0425531914893617, "writeRatioMax": 0.0425531914893617 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026595744680851064, "computeRatioMax": 0.026595744680851064, "endMs": "1665777711300", "id": "44", "inputStages": [ "43" ], "name": "S2C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777711262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$855", "FROM __stage2B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$856 := root_sink_stats($855)" ] }, { "kind": "WRITE", "substeps": [ "$856", "TO __stage2C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007978723404255319, "waitRatioMax": 0.007978723404255319, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.005319148936170213, "writeRatioMax": 0.005319148936170213 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.023936170212765957, "endMs": "1665777711323", "id": "45", "inputStages": [ "34", "40" ], "name": "S2D: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "583", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777711274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1276", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage22_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$280 := ROW_NUMBER($1276) OVER (ORDER BY $1282 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1272 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $1290, $1291, $1292, $1293", "TO __stage2D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06914893617021277, "writeRatioMax": 0.06914893617021277 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.031914893617021274, "computeRatioMax": 0.031914893617021274, "endMs": "1665777711368", "id": "46", "inputStages": [ "38", "44" ], "name": "S2E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "848", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777711320", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$856", "FROM __stage2C_output" ] }, { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage26_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := ROW_NUMBER($856) OVER (ORDER BY $862 ASC)" ] }, { "kind": "SORT", "substeps": [ "$852 ASC" ] }, { "kind": "WRITE", "substeps": [ "$220, $870, $871, $872, $873", "TO __stage2E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.06382978723404255, "writeRatioMax": 0.06382978723404255 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03723404255319149, "computeRatioMax": 0.03723404255319149, "endMs": "1665777711387", "id": "47", "inputStages": [ "42", "36" ], "name": "S2F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "2226", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777711336", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1066", "FROM __stage2A_output" ] }, { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage24_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$250 := ROW_NUMBER($1066) OVER (ORDER BY $1072 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1062 ASC" ] }, { "kind": "WRITE", "substeps": [ "$250, $1080, $1081, $1082, $1083", "TO __stage2F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06914893617021277, "writeRatioMax": 0.06914893617021277 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.026595744680851064, "computeRatioMax": 0.05319148936170213, "endMs": "1665777711404", "id": "48", "inputStages": [ "45" ], "name": "S30: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "286", "shuffleOutputBytesSpilled": "0", "slotMs": "3459", "startMs": "1665777711355", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1320 := $390", "$330 := MIN($391)" ] }, { "kind": "WRITE", "substeps": [ "$330, $1320", "TO __stage30_output", "BY HASH($1320)" ] } ], "waitMsAvg": "2", "waitMsMax": "12", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.031914893617021274, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.05319148936170213 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.0398936170212766, "endMs": "1665777711436", "id": "49", "inputStages": [ "46" ], "name": "S31: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "416", "shuffleOutputBytesSpilled": "0", "slotMs": "3048", "startMs": "1665777711394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage2E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $350", "$310 := MIN($351)" ] }, { "kind": "WRITE", "substeps": [ "$310, $900", "TO __stage31_output", "BY HASH($900)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.007978723404255319, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.0398936170212766, "writeRatioMax": 0.07446808510638298 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.02127659574468085, "computeRatioMax": 0.0398936170212766, "endMs": "1665777711453", "id": "50", "inputStages": [ "47" ], "name": "S32: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1092", "shuffleOutputBytesSpilled": "0", "slotMs": "2810", "startMs": "1665777711414", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage2F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $370", "$320 := MIN($371)" ] }, { "kind": "WRITE", "substeps": [ "$320, $1110", "TO __stage32_output", "BY HASH($1110)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.034574468085106384, "writeRatioMax": 0.047872340425531915 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "15", "computeRatioAvg": 0.026595744680851064, "computeRatioMax": 0.0398936170212766, "endMs": "1665777711517", "id": "51", "inputStages": [ "48" ], "name": "S33: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "345", "startMs": "1665777711473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $1320", "FROM __stage30_output" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := coalesce($1330, NUMERIC<...>)", "$211 := coalesce($1330, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1330 := $1320", "$300 := MIN($330)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $300", "TO __stage33_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "14", "writeMsMax": "16", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.0425531914893617 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "15", "computeRatioAvg": 0.026595744680851064, "computeRatioMax": 0.0398936170212766, "endMs": "1665777711546", "id": "53", "inputStages": [ "50" ], "name": "S35: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "356", "startMs": "1665777711498", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $1110", "FROM __stage32_output" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($1120, NUMERIC<...>)", "$191 := coalesce($1120, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1110", "$270 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $270", "TO __stage35_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "14", "writeMsMax": "16", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.0425531914893617 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.0398936170212766, "endMs": "1665777711564", "id": "55", "inputStages": [ "49" ], "name": "S37: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "348", "startMs": "1665777711524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $900", "FROM __stage31_output" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($910, NUMERIC<...>)", "$171 := coalesce($910, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$240 := MIN($310)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $240", "TO __stage37_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0026595744680851063, "writeMsAvg": "19", "writeMsMax": "29", "writeRatioAvg": 0.05053191489361702, "writeRatioMax": 0.07712765957446809 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "11", "computeRatioAvg": 0.018617021276595744, "computeRatioMax": 0.02925531914893617, "endMs": "1665777711597", "id": "57", "inputStages": [ "51" ], "name": "S39: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "2519", "startMs": "1665777711537", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage33_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.007978723404255319, "waitRatioMax": 0.013297872340425532, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.034574468085106384, "writeRatioMax": 0.05053191489361702 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.02127659574468085, "computeRatioMax": 0.03723404255319149, "endMs": "1665777711612", "id": "58", "inputStages": [ "53" ], "name": "S3A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "3433", "startMs": "1665777711551", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage35_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0026595744680851063, "waitRatioMax": 0.007978723404255319, "writeMsAvg": "18", "writeMsMax": "31", "writeRatioAvg": 0.047872340425531915, "writeRatioMax": 0.08244680851063829 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.02127659574468085, "computeRatioMax": 0.05053191489361702, "endMs": "1665777711629", "id": "59", "inputStages": [ "55" ], "name": "S3B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "2970", "startMs": "1665777711574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage37_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.007978723404255319, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.03723404255319149, "writeRatioMax": 0.05319148936170213 }, { "completedParallelInputs": "300", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.023936170212765957, "computeRatioMax": 0.05053191489361702, "endMs": "1665777711642", "id": "60", "inputStages": [ "46", "57", "45", "58", "59", "47" ], "name": "S3C: Join+", "parallelInputs": "300", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1695", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "8570", "startMs": "1665777711581", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage2E_output" ] }, { "kind": "READ", "substeps": [ "$170, $171, $240", "FROM __stage3B_output" ] }, { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$190, $191, $270", "FROM __stage3A_output" ] }, { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2D_output" ] }, { "kind": "READ", "substeps": [ "$210, $211, $300", "FROM __stage39_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $921 ASC, $923 ASC, $920 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := 'web'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($921, 10), less_or_equal($923, 10))" ] }, { "kind": "JOIN", "substeps": [ "$920 := $230, $921 := $231, $922 := $232, $923 := $240", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($233, NUMERIC<...>)", "$161 := coalesce($233, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$110 ASC, $1131 ASC, $1133 ASC, $1130 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := 'catalog'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1131, 10), less_or_equal($1133, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1130 := $260, $1131 := $261, $1132 := $262, $1133 := $270", "INNER HASH JOIN EACH WITH ALL ON $180 = $190, $181 = $191" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := coalesce($263, NUMERIC<...>)", "$181 := coalesce($263, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1341 ASC, $1343 ASC, $1340 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1341, 10), less_or_equal($1343, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1340 := $290, $1341 := $291, $1342 := $292, $1343 := $300", "INNER HASH JOIN EACH WITH ALL ON $200 = $210, $201 = $211" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($293, NUMERIC<...>)", "$201 := coalesce($293, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage3C_output" ] } ], "waitMsAvg": "6", "waitMsMax": "10", "waitRatioAvg": 0.015957446808510637, "waitRatioMax": 0.026595744680851064, "writeMsAvg": "15", "writeMsMax": "50", "writeRatioAvg": 0.0398936170212766, "writeRatioMax": 0.13297872340425532 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.010638297872340425, "computeRatioMax": 0.010638297872340425, "endMs": "1665777711736", "id": "61", "inputStages": [ "60" ], "name": "S3D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665777711597", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage3C_output" ] }, { "kind": "SORT", "substeps": [ "$90 ASC, $93 ASC, $94 ASC, $91 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1360, $1361, $1362, $1363, $1364", "TO __stage3D_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.02925531914893617, "waitRatioMax": 0.02925531914893617, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007978723404255319, "writeRatioMax": 0.007978723404255319 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "26", "elapsedMs": "642", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3178" }, { "activeUnits": "2", "completedUnits": "1900", "elapsedMs": "1607", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "74251" } ], "totalBytesBilled": "338690048", "totalBytesProcessed": "337676184", "totalPartitionsProcessed": "0", "totalSlotMs": "74251", "transferredBytes": "0" }, "startTime": "1665777710211", "totalBytesProcessed": "337676184", "totalSlotMs": "74251" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonac026c75_4832_4f59_b876_e3788887fa92" }, "priority": "INTERACTIVE", "query": "select channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(sum(coalesce(wr.wr_return_quantity,0)))/\n \t\tsum(coalesce(ws.ws_quantity,0)) as return_ratio\n \t\t,(sum(coalesce(wr.wr_return_amt,0)))/\n \t\tsum(coalesce(ws.ws_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n and ws.ws_net_paid > 0\n and ws.ws_quantity > 0\n and ws_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union all\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,sum(coalesce(cr.cr_return_quantity,0))/\n \t\tsum(coalesce(cs.cs_quantity,0)) as return_ratio\n \t\t,sum(coalesce(cr.cr_return_amount,0))/\n \t\tsum(coalesce(cs.cs_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n and cs.cs_net_paid > 0\n and cs.cs_quantity > 0\n and cs_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union all\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,sum(coalesce(sr.sr_return_quantity,0))/sum(coalesce(sts.ss_quantity,0)) as return_ratio\n \t\t,sum(coalesce(sr.sr_return_amt,0))/sum(coalesce(sts.ss_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n and sts.ss_net_paid > 0 \n and sts.ss_quantity > 0\n and ss_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n order by 1,4,5,2\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "s34tGs2z4K5WKHT3D2ickQ==", "id": "test-project-364309:europe-west1.query49_1665777713", "jobReference": { "jobId": "query49_1665777713", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query49_1665777713?location=europe-west1", "statistics": { "creationTime": "1665777714228", "endTime": "1665777716152", "finalExecutionDurationMs": "1606", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "337676184", "performanceInsights": { "avgPreviousExecutionMs": "1489" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.017857142857142856, "endMs": "1665777714486", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.015873015873015872, "readRatioMax": 0.015873015873015872, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777714444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(equal($21, 2001), equal($22, 12))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.02976190476190476, "writeRatioMax": 0.02976190476190476 }, { "completedParallelInputs": "1", "computeMsAvg": "68", "computeMsMax": "68", "computeRatioAvg": 0.1349206349206349, "computeRatioMax": 0.1349206349206349, "endMs": "1665777714530", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.037698412698412696, "readRatioMax": 0.037698412698412696, "recordsRead": "287514", "recordsWritten": "507", "shuffleOutputBytes": "22236", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665777714465", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:sr_item_sk, $81:sr_ticket_number, $82:sr_return_quantity, $83:sr_return_amt", "FROM store_returns", "WHERE greater($83, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.015873015873015872, "writeRatioMax": 0.015873015873015872 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.01984126984126984, "endMs": "1665777714553", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.017857142857142856, "readRatioMax": 0.017857142857142856, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777714507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 12))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.031746031746031744, "writeRatioMax": 0.031746031746031744 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.08531746031746032, "computeRatioMax": 0.08531746031746032, "endMs": "1665777714578", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.03373015873015873, "readRatioMax": 0.03373015873015873, "recordsRead": "144067", "recordsWritten": "1217", "shuffleOutputBytes": "53452", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665777714524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cr_item_sk, $61:cr_order_number, $62:cr_return_quantity, $63:cr_return_amount", "FROM catalog_returns", "WHERE greater($63, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.017857142857142856, "writeRatioMax": 0.017857142857142856 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.01984126984126984, "endMs": "1665777714599", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011904761904761904, "readRatioMax": 0.011904761904761904, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777714559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_moy", "FROM date_dim", "WHERE and(equal($2, 2001), equal($3, 12))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.025793650793650792, "writeRatioMax": 0.025793650793650792 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.06349206349206349, "computeRatioMax": 0.06349206349206349, "endMs": "1665777714612", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.021825396825396824, "readRatioMax": 0.021825396825396824, "recordsRead": "71763", "recordsWritten": "632", "shuffleOutputBytes": "27680", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777714575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_item_sk, $41:wr_order_number, $42:wr_return_quantity, $43:wr_return_amt", "FROM web_returns", "WHERE greater($43, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.015873015873015872, "writeRatioMax": 0.015873015873015872 }, { "completedParallelInputs": "6", "computeMsAvg": "243", "computeMsMax": "307", "computeRatioAvg": 0.48214285714285715, "computeRatioMax": 0.6091269841269841, "endMs": "1665777714805", "id": "9", "inputStages": [ "1", "0" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "28", "readRatioAvg": 0.04563492063492063, "readRatioMax": 0.05555555555555555, "recordsRead": "2883632", "recordsWritten": "11", "shuffleOutputBytes": "671", "shuffleOutputBytesSpilled": "0", "slotMs": "1363", "startMs": "1665777714606", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_ticket_number, $73:ss_quantity, $74:ss_net_paid, $75:ss_net_profit", "FROM store_sales", "WHERE and(greater($75, NUMERIC<...>), greater($74, NUMERIC<...>), greater($73, 0))" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1190 := $1180", "$690 := SUM($720)", "$691 := SUM($721)", "$692 := SUM($722)", "$693 := SUM($723)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($1183, 0)", "$721 := coalesce($1181, 0)", "$722 := coalesce($1184, NUMERIC<...>)", "$723 := coalesce($1182, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1161, $1181 := $1162, $1182 := $1163, $1183 := $1164, $1184 := $1165", "INNER HASH JOIN EACH WITH ALL ON $1160 = $20" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $70, $1161 := $71, $1162 := $73, $1163 := $74, $1164 := $82, $1165 := $83", "INNER HASH JOIN EACH WITH ALL ON $72 = $81, $71 = $80" ] }, { "kind": "WRITE", "substeps": [ "$1190, $690, $691, $692, $693", "TO __stage09_output", "BY HASH($1190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.015873015873015872 }, { "completedParallelInputs": "5", "computeMsAvg": "183", "computeMsMax": "244", "computeRatioAvg": 0.3630952380952381, "computeRatioMax": 0.48412698412698413, "endMs": "1665777714794", "id": "10", "inputStages": [ "4", "3" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "25", "readMsMax": "29", "readRatioAvg": 0.0496031746031746, "readRatioMax": 0.057539682539682536, "recordsRead": "1447788", "recordsWritten": "42", "shuffleOutputBytes": "2562", "shuffleOutputBytesSpilled": "0", "slotMs": "914", "startMs": "1665777714624", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_item_sk, $52:cs_order_number, $53:cs_quantity, $54:cs_net_paid, $55:cs_net_profit", "FROM catalog_sales", "WHERE and(greater($55, NUMERIC<...>), greater($54, NUMERIC<...>), greater($53, 0))" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$680 := SUM($710)", "$681 := SUM($711)", "$682 := SUM($712)", "$683 := SUM($713)" ] }, { "kind": "COMPUTE", "substeps": [ "$710 := coalesce($973, 0)", "$711 := coalesce($971, 0)", "$712 := coalesce($974, NUMERIC<...>)", "$713 := coalesce($972, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$970 := $951, $971 := $952, $972 := $953, $973 := $954, $974 := $955", "INNER HASH JOIN EACH WITH ALL ON $950 = $10" ] }, { "kind": "JOIN", "substeps": [ "$950 := $50, $951 := $51, $952 := $53, $953 := $54, $954 := $62, $955 := $63", "INNER HASH JOIN EACH WITH ALL ON $52 = $61, $51 = $60" ] }, { "kind": "WRITE", "substeps": [ "$980, $680, $681, $682, $683", "TO __stage0A_output", "BY HASH($980)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.017857142857142856 }, { "completedParallelInputs": "1", "computeMsAvg": "504", "computeMsMax": "504", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777714912", "id": "11", "inputStages": [ "6", "7" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.061507936507936505, "readRatioMax": 0.061507936507936505, "recordsRead": "720047", "recordsWritten": "16", "shuffleOutputBytes": "976", "shuffleOutputBytesSpilled": "0", "slotMs": "450", "startMs": "1665777714628", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_order_number, $33:ws_quantity, $34:ws_net_paid, $35:ws_net_profit", "FROM web_sales", "WHERE and(greater($35, NUMERIC<...>), greater($34, NUMERIC<...>), greater($33, 0))" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $770 := $760", "$670 := SUM($700)", "$671 := SUM($701)", "$672 := SUM($702)", "$673 := SUM($703)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := coalesce($763, 0)", "$701 := coalesce($761, 0)", "$702 := coalesce($764, NUMERIC<...>)", "$703 := coalesce($762, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $741, $761 := $742, $762 := $743, $763 := $744, $764 := $745", "INNER HASH JOIN EACH WITH ALL ON $740 = $1" ] }, { "kind": "JOIN", "substeps": [ "$740 := $30, $741 := $31, $742 := $33, $743 := $34, $744 := $42, $745 := $43", "INNER HASH JOIN EACH WITH ALL ON $32 = $41, $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$770, $670, $671, $672, $673", "TO __stage0B_output", "BY HASH($770)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.00992063492063492, "writeRatioMax": 0.00992063492063492 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.01984126984126984, "endMs": "1665777714858", "id": "12", "inputStages": [ "10" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777714820", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$980, $680, $681, $682, $683", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := divide(CAST($630 AS DOUBLE), CAST($631 AS DOUBLE))", "$571 := divide($632, $633)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $990 := $980", "$630 := SUM($680)", "$631 := SUM($681)", "$632 := SUM($682)", "$633 := SUM($683)" ] }, { "kind": "WRITE", "substeps": [ "$990, $570, $571", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.05555555555555555, "writeRatioMax": 0.05555555555555555 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.017857142857142856, "endMs": "1665777714880", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "385", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777714840", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1190, $690, $691, $692, $693", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := divide(CAST($650 AS DOUBLE), CAST($651 AS DOUBLE))", "$591 := divide($652, $653)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$650 := SUM($690)", "$651 := SUM($691)", "$652 := SUM($692)", "$653 := SUM($693)" ] }, { "kind": "WRITE", "substeps": [ "$1200, $590, $591", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.05952380952380952, "writeRatioMax": 0.05952380952380952 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015873015873015872, "computeRatioMax": 0.015873015873015872, "endMs": "1665777714902", "id": "14", "inputStages": [ "12" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777714864", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$992 := shard_sink_stats($991)" ] }, { "kind": "COMPUTE", "substeps": [ "$991 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$992", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.05555555555555555, "writeRatioMax": 0.05555555555555555 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.011904761904761904, "computeRatioMax": 0.011904761904761904, "endMs": "1665777714918", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777714866", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$992", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$993 := root_sink_stats($992)" ] }, { "kind": "WRITE", "substeps": [ "$993", "TO __stage0F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007936507936507936, "writeRatioMax": 0.007936507936507936 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.025793650793650792, "computeRatioMax": 0.025793650793650792, "endMs": "1665777714934", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777714885", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1202 := shard_sink_stats($1201)" ] }, { "kind": "COMPUTE", "substeps": [ "$1201 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1202", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.047619047619047616, "writeRatioMax": 0.047619047619047616 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015873015873015872, "computeRatioMax": 0.015873015873015872, "endMs": "1665777714940", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777714887", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1203 := root_sink_stats($1202)" ] }, { "kind": "WRITE", "substeps": [ "$1203", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.005952380952380952, "writeRatioMax": 0.005952380952380952 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.021825396825396824, "computeRatioMax": 0.021825396825396824, "endMs": "1665777714989", "id": "18", "inputStages": [ "11" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "560", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777714941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $670, $671, $672, $673", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := divide(CAST($610 AS DOUBLE), CAST($611 AS DOUBLE))", "$551 := divide($612, $613)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $770", "$610 := SUM($670)", "$611 := SUM($671)", "$612 := SUM($672)", "$613 := SUM($673)" ] }, { "kind": "WRITE", "substeps": [ "$780, $550, $551", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.05357142857142857, "writeRatioMax": 0.05357142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.007936507936507936, "computeRatioMax": 0.007936507936507936, "endMs": "1665777715016", "id": "19", "inputStages": [ "15", "12" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777714969", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$993", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$490 := ROW_NUMBER($993) OVER (ORDER BY $1001 ASC)" ] }, { "kind": "SORT", "substeps": [ "$570 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1010, $490, $1011, $1012", "TO __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "38", "writeMsMax": "38", "writeRatioAvg": 0.07539682539682539, "writeRatioMax": 0.07539682539682539 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.02976190476190476, "computeRatioMax": 0.02976190476190476, "endMs": "1665777715050", "id": "20", "inputStages": [ "13", "17" ], "name": "S14: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777714990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1203", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$520 := ROW_NUMBER($1203) OVER (ORDER BY $1211 ASC)" ] }, { "kind": "SORT", "substeps": [ "$590 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1220, $520, $1221, $1222", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "38", "writeMsMax": "38", "writeRatioAvg": 0.07539682539682539, "writeRatioMax": 0.07539682539682539 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.007936507936507936, "computeRatioMax": 0.007936507936507936, "endMs": "1665777715007", "id": "21", "inputStages": [ "18" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665777714997", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$782 := shard_sink_stats($781)" ] }, { "kind": "COMPUTE", "substeps": [ "$781 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$782", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001984126984126984, "writeRatioMax": 0.001984126984126984 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.011904761904761904, "computeRatioMax": 0.011904761904761904, "endMs": "1665777715034", "id": "22", "inputStages": [ "21" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777714999", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$782", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$783 := root_sink_stats($782)" ] }, { "kind": "WRITE", "substeps": [ "$783", "TO __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.02976190476190476, "writeRatioMax": 0.02976190476190476 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.03968253968253968, "endMs": "1665777715100", "id": "23", "inputStages": [ "19" ], "name": "S17: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "756", "shuffleOutputBytesSpilled": "0", "slotMs": "3654", "startMs": "1665777715043", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $640", "$580 := MIN($641)" ] }, { "kind": "WRITE", "substeps": [ "$580, $1040", "TO __stage17_output", "BY HASH($1040)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.007936507936507936, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.057539682539682536 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.021825396825396824, "computeRatioMax": 0.021825396825396824, "endMs": "1665777715124", "id": "24", "inputStages": [ "22", "18" ], "name": "S18: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777715072", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$783", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage12_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$460 := ROW_NUMBER($783) OVER (ORDER BY $791 ASC)" ] }, { "kind": "SORT", "substeps": [ "$550 ASC" ] }, { "kind": "WRITE", "substeps": [ "$800, $460, $801, $802", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.051587301587301584, "writeRatioMax": 0.051587301587301584 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.03571428571428571, "endMs": "1665777715143", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "198", "shuffleOutputBytesSpilled": "0", "slotMs": "3558", "startMs": "1665777715090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1250 := $660", "$600 := MIN($661)" ] }, { "kind": "WRITE", "substeps": [ "$600, $1250", "TO __stage19_output", "BY HASH($1250)" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "18", "writeMsMax": "30", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.05952380952380952 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "13", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.025793650793650792, "endMs": "1665777715161", "id": "26", "inputStages": [ "23" ], "name": "S1A: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "383", "startMs": "1665777715121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $1040", "FROM __stage17_output" ] }, { "kind": "COMPUTE", "substeps": [ "$430 := coalesce($1050, 0)", "$431 := coalesce($1050, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040", "$510 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "26", "writeMsMax": "29", "writeRatioAvg": 0.051587301587301584, "writeRatioMax": 0.057539682539682536 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "19", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.037698412698412696, "endMs": "1665777715220", "id": "28", "inputStages": [ "24" ], "name": "S1C: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "288", "shuffleOutputBytesSpilled": "0", "slotMs": "3585", "startMs": "1665777715161", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $620", "$560 := MIN($621)" ] }, { "kind": "WRITE", "substeps": [ "$560, $830", "TO __stage1C_output", "BY HASH($830)" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.007936507936507936, "waitRatioMax": 0.00992063492063492, "writeMsAvg": "18", "writeMsMax": "43", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.08531746031746032 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "15", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.02976190476190476, "endMs": "1665777715222", "id": "29", "inputStages": [ "25" ], "name": "S1D: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "512", "startMs": "1665777715180", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1250", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$450 := coalesce($1260, 0)", "$451 := coalesce($1260, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1250", "$540 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$450, $451, $540", "TO __stage1D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "24", "writeMsMax": "30", "writeRatioAvg": 0.047619047619047616, "writeRatioMax": 0.05952380952380952 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.015873015873015872, "computeRatioMax": 0.02976190476190476, "endMs": "1665777715293", "id": "31", "inputStages": [ "26" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "4007", "startMs": "1665777715209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.00992063492063492, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.02976190476190476, "writeRatioMax": 0.05555555555555555 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "23", "computeRatioAvg": 0.021825396825396824, "computeRatioMax": 0.04563492063492063, "endMs": "1665777715304", "id": "32", "inputStages": [ "19", "31" ], "name": "S20: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1300", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "4604", "startMs": "1665777715229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$430, $431, $510", "FROM __stage1F_output" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $500, $1061 := $501, $1062 := $502, $1063 := $510", "INNER HASH JOIN EACH WITH ALL ON $420 = $430, $421 = $431" ] }, { "kind": "COMPUTE", "substeps": [ "$420 := coalesce($501, 0)", "$421 := coalesce($501, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1060, $1061, $1062, $1063", "TO __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "14", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.027777777777777776, "writeMsAvg": "19", "writeMsMax": "31", "writeRatioAvg": 0.037698412698412696, "writeRatioMax": 0.061507936507936505 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.027777777777777776, "endMs": "1665777715299", "id": "33", "inputStages": [ "28" ], "name": "S21: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "446", "startMs": "1665777715246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $830", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($840, 0)", "$411 := coalesce($840, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830", "$480 := MIN($560)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $480", "TO __stage21_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "28", "writeMsMax": "29", "writeRatioAvg": 0.05555555555555555, "writeRatioMax": 0.057539682539682536 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "25", "computeRatioAvg": 0.015873015873015872, "computeRatioMax": 0.0496031746031746, "endMs": "1665777715351", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "3681", "startMs": "1665777715279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "8", "waitMsMax": "9", "waitRatioAvg": 0.015873015873015872, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.02976190476190476, "writeRatioMax": 0.05952380952380952 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "23", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.04563492063492063, "endMs": "1665777715372", "id": "36", "inputStages": [ "35", "20" ], "name": "S24: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "121", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "3848", "startMs": "1665777715290", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$450, $451, $540", "FROM __stage23_output" ] }, { "kind": "JOIN", "substeps": [ "$1270 := $530, $1271 := $531, $1272 := $532, $1273 := $540", "INNER HASH JOIN EACH WITH ALL ON $440 = $450, $441 = $451" ] }, { "kind": "COMPUTE", "substeps": [ "$440 := coalesce($531, 0)", "$441 := coalesce($531, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $1271, $1272, $1273", "TO __stage24_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.00992063492063492, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.027777777777777776, "writeRatioMax": 0.05357142857142857 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.04563492063492063, "endMs": "1665777715380", "id": "37", "inputStages": [ "33" ], "name": "S25: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "15", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "4463", "startMs": "1665777715308", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "27", "writeMsMax": "33", "writeRatioAvg": 0.05357142857142857, "writeRatioMax": 0.06547619047619048 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.03373015873015873, "endMs": "1665777715398", "id": "38", "inputStages": [ "37", "24" ], "name": "S26: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "226", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "3586", "startMs": "1665777715325", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $480", "FROM __stage25_output" ] }, { "kind": "JOIN", "substeps": [ "$850 := $470, $851 := $471, $852 := $472, $853 := $480", "INNER HASH JOIN EACH WITH ALL ON $400 = $410, $401 = $411" ] }, { "kind": "COMPUTE", "substeps": [ "$400 := coalesce($471, 0)", "$401 := coalesce($471, 1)" ] }, { "kind": "WRITE", "substeps": [ "$850, $851, $852, $853", "TO __stage26_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "18", "writeMsMax": "38", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.07539682539682539 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015873015873015872, "computeRatioMax": 0.015873015873015872, "endMs": "1665777715374", "id": "39", "inputStages": [ "32" ], "name": "S27: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777715330", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage20_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1065 := shard_sink_stats($1064)" ] }, { "kind": "COMPUTE", "substeps": [ "$1064 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1065", "TO __stage27_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.05357142857142857, "writeRatioMax": 0.05357142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.01984126984126984, "endMs": "1665777715383", "id": "40", "inputStages": [ "39" ], "name": "S28: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777715331", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1065", "FROM __stage27_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1066 := root_sink_stats($1065)" ] }, { "kind": "WRITE", "substeps": [ "$1066", "TO __stage28_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.003968253968253968, "writeRatioMax": 0.003968253968253968 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.03373015873015873, "computeRatioMax": 0.03373015873015873, "endMs": "1665777715423", "id": "41", "inputStages": [ "36" ], "name": "S29: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777715377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage24_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1275 := shard_sink_stats($1274)" ] }, { "kind": "COMPUTE", "substeps": [ "$1274 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1275", "TO __stage29_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.057539682539682536, "writeRatioMax": 0.057539682539682536 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.02976190476190476, "computeRatioMax": 0.02976190476190476, "endMs": "1665777715439", "id": "42", "inputStages": [ "41" ], "name": "S2A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665777715377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1275", "FROM __stage29_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1276 := root_sink_stats($1275)" ] }, { "kind": "WRITE", "substeps": [ "$1276", "TO __stage2A_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.015873015873015872, "writeRatioMax": 0.015873015873015872 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.01984126984126984, "endMs": "1665777715485", "id": "43", "inputStages": [ "40", "32" ], "name": "S2B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "2226", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777715416", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1066", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage20_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$250 := ROW_NUMBER($1066) OVER (ORDER BY $1072 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1062 ASC" ] }, { "kind": "WRITE", "substeps": [ "$250, $1080, $1081, $1082, $1083", "TO __stage2B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "57", "writeMsMax": "57", "writeRatioAvg": 0.1130952380952381, "writeRatioMax": 0.1130952380952381 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.011904761904761904, "computeRatioMax": 0.011904761904761904, "endMs": "1665777715464", "id": "44", "inputStages": [ "38" ], "name": "S2C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777715418", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage26_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$855 := shard_sink_stats($854)" ] }, { "kind": "COMPUTE", "substeps": [ "$854 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$855", "TO __stage2C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.05357142857142857, "writeRatioMax": 0.05357142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015873015873015872, "computeRatioMax": 0.015873015873015872, "endMs": "1665777715473", "id": "45", "inputStages": [ "44" ], "name": "S2D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777715418", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$855", "FROM __stage2C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$856 := root_sink_stats($855)" ] }, { "kind": "WRITE", "substeps": [ "$856", "TO __stage2D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007936507936507936, "writeRatioMax": 0.007936507936507936 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.025793650793650792, "computeRatioMax": 0.025793650793650792, "endMs": "1665777715515", "id": "46", "inputStages": [ "36", "42" ], "name": "S2E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "583", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777715464", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1276", "FROM __stage2A_output" ] }, { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage24_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$280 := ROW_NUMBER($1276) OVER (ORDER BY $1282 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1272 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $1290, $1291, $1292, $1293", "TO __stage2E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.07738095238095238, "writeRatioMax": 0.07738095238095238 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.021825396825396824, "computeRatioMax": 0.021825396825396824, "endMs": "1665777715572", "id": "47", "inputStages": [ "38", "45" ], "name": "S2F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "848", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777715511", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$856", "FROM __stage2D_output" ] }, { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage26_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := ROW_NUMBER($856) OVER (ORDER BY $862 ASC)" ] }, { "kind": "SORT", "substeps": [ "$852 ASC" ] }, { "kind": "WRITE", "substeps": [ "$220, $870, $871, $872, $873", "TO __stage2F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.031746031746031744, "endMs": "1665777715610", "id": "48", "inputStages": [ "43" ], "name": "S30: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1092", "shuffleOutputBytesSpilled": "0", "slotMs": "5383", "startMs": "1665777715533", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage2B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $370", "$320 := MIN($371)" ] }, { "kind": "WRITE", "substeps": [ "$320, $1110", "TO __stage30_output", "BY HASH($1110)" ] } ], "waitMsAvg": "2", "waitMsMax": "9", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "47", "writeMsMax": "55", "writeRatioAvg": 0.09325396825396826, "writeRatioMax": 0.10912698412698413 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.02976190476190476, "endMs": "1665777715611", "id": "49", "inputStages": [ "46" ], "name": "S31: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "286", "shuffleOutputBytesSpilled": "0", "slotMs": "3515", "startMs": "1665777715562", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1320 := $390", "$330 := MIN($391)" ] }, { "kind": "WRITE", "substeps": [ "$330, $1320", "TO __stage31_output", "BY HASH($1320)" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "21", "writeMsMax": "30", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.05952380952380952 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "21", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.041666666666666664, "endMs": "1665777715655", "id": "50", "inputStages": [ "47" ], "name": "S32: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "416", "shuffleOutputBytesSpilled": "0", "slotMs": "3461", "startMs": "1665777715601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage2F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $350", "$310 := MIN($351)" ] }, { "kind": "WRITE", "substeps": [ "$310, $900", "TO __stage32_output", "BY HASH($900)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.02976190476190476, "writeRatioMax": 0.051587301587301584 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "12", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.023809523809523808, "endMs": "1665777715728", "id": "51", "inputStages": [ "49" ], "name": "S33: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "345", "startMs": "1665777715680", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $1320", "FROM __stage31_output" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := coalesce($1330, NUMERIC<...>)", "$211 := coalesce($1330, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1330 := $1320", "$300 := MIN($330)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $300", "TO __stage33_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "27", "writeMsMax": "29", "writeRatioAvg": 0.05357142857142857, "writeRatioMax": 0.057539682539682536 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "16", "computeRatioAvg": 0.021825396825396824, "computeRatioMax": 0.031746031746031744, "endMs": "1665777715766", "id": "53", "inputStages": [ "48" ], "name": "S35: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "347", "startMs": "1665777715720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $1110", "FROM __stage30_output" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($1120, NUMERIC<...>)", "$191 := coalesce($1120, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1110", "$270 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $270", "TO __stage35_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "22", "writeMsMax": "28", "writeRatioAvg": 0.04365079365079365, "writeRatioMax": 0.05555555555555555 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "12", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.023809523809523808, "endMs": "1665777715814", "id": "55", "inputStages": [ "50" ], "name": "S37: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "449", "startMs": "1665777715760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $900", "FROM __stage32_output" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($910, NUMERIC<...>)", "$171 := coalesce($910, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$240 := MIN($310)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $240", "TO __stage37_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "27", "writeMsMax": "30", "writeRatioAvg": 0.05357142857142857, "writeRatioMax": 0.05952380952380952 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.015873015873015872, "computeRatioMax": 0.03968253968253968, "endMs": "1665777715852", "id": "57", "inputStages": [ "51" ], "name": "S39: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "3589", "startMs": "1665777715783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage33_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.00992063492063492, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "17", "writeMsMax": "33", "writeRatioAvg": 0.03373015873015873, "writeRatioMax": 0.06547619047619048 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.027777777777777776, "endMs": "1665777715866", "id": "58", "inputStages": [ "53" ], "name": "S3A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "3959", "startMs": "1665777715790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage35_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "16", "writeMsMax": "27", "writeRatioAvg": 0.031746031746031744, "writeRatioMax": 0.05357142857142857 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.015873015873015872, "computeRatioMax": 0.041666666666666664, "endMs": "1665777715894", "id": "59", "inputStages": [ "55" ], "name": "S3B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "3843", "startMs": "1665777715821", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage37_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.02976190476190476, "writeRatioMax": 0.037698412698412696 }, { "completedParallelInputs": "300", "computeMsAvg": "10", "computeMsMax": "23", "computeRatioAvg": 0.01984126984126984, "computeRatioMax": 0.04563492063492063, "endMs": "1665777715912", "id": "60", "inputStages": [ "58", "57", "59", "46", "43", "47" ], "name": "S3C: Join+", "parallelInputs": "300", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1695", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "13696", "startMs": "1665777715828", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$170, $171, $240", "FROM __stage3B_output" ] }, { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$190, $191, $270", "FROM __stage3A_output" ] }, { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2E_output" ] }, { "kind": "READ", "substeps": [ "$210, $211, $300", "FROM __stage39_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $921 ASC, $923 ASC, $920 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := 'web'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($921, 10), less_or_equal($923, 10))" ] }, { "kind": "JOIN", "substeps": [ "$920 := $230, $921 := $231, $922 := $232, $923 := $240", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($233, NUMERIC<...>)", "$161 := coalesce($233, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$110 ASC, $1131 ASC, $1133 ASC, $1130 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := 'catalog'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1131, 10), less_or_equal($1133, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1130 := $260, $1131 := $261, $1132 := $262, $1133 := $270", "INNER HASH JOIN EACH WITH ALL ON $180 = $190, $181 = $191" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := coalesce($263, NUMERIC<...>)", "$181 := coalesce($263, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1341 ASC, $1343 ASC, $1340 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1341, 10), less_or_equal($1343, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1340 := $290, $1341 := $291, $1342 := $292, $1343 := $300", "INNER HASH JOIN EACH WITH ALL ON $200 = $210, $201 = $211" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($293, NUMERIC<...>)", "$201 := coalesce($293, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage3C_output" ] } ], "waitMsAvg": "5", "waitMsMax": "9", "waitRatioAvg": 0.00992063492063492, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "11", "writeMsMax": "28", "writeRatioAvg": 0.021825396825396824, "writeRatioMax": 0.05555555555555555 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.017857142857142856, "endMs": "1665777716009", "id": "61", "inputStages": [ "60" ], "name": "S3D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "131", "startMs": "1665777715846", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage3C_output" ] }, { "kind": "SORT", "substeps": [ "$90 ASC, $93 ASC, $94 ASC, $91 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1360, $1361, $1362, $1363, $1364", "TO __stage3D_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.015873015873015872, "waitRatioMax": 0.015873015873015872, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.015873015873015872, "writeRatioMax": 0.015873015873015872 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "24", "elapsedMs": "659", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3286" }, { "activeUnits": "3", "completedUnits": "1900", "elapsedMs": "1807", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "92148" } ], "totalBytesBilled": "338690048", "totalBytesProcessed": "337676184", "totalPartitionsProcessed": "0", "totalSlotMs": "92148", "transferredBytes": "0" }, "startTime": "1665777714287", "totalBytesProcessed": "337676184", "totalSlotMs": "92148" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4471e8c6_4d37_457c_b12d_781498ad1a23" }, "priority": "INTERACTIVE", "query": "select channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(sum(coalesce(wr.wr_return_quantity,0)))/\n \t\tsum(coalesce(ws.ws_quantity,0)) as return_ratio\n \t\t,(sum(coalesce(wr.wr_return_amt,0)))/\n \t\tsum(coalesce(ws.ws_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n and ws.ws_net_paid > 0\n and ws.ws_quantity > 0\n and ws_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union all\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,sum(coalesce(cr.cr_return_quantity,0))/\n \t\tsum(coalesce(cs.cs_quantity,0)) as return_ratio\n \t\t,sum(coalesce(cr.cr_return_amount,0))/\n \t\tsum(coalesce(cs.cs_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n and cs.cs_net_paid > 0\n and cs.cs_quantity > 0\n and cs_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union all\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,sum(coalesce(sr.sr_return_quantity,0))/sum(coalesce(sts.ss_quantity,0)) as return_ratio\n \t\t,sum(coalesce(sr.sr_return_amt,0))/sum(coalesce(sts.ss_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n and sts.ss_net_paid > 0 \n and sts.ss_quantity > 0\n and ss_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n order by 1,4,5,2\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "UujhRvt5Hg0Lhsyrzhtcow==", "id": "test-project-364309:europe-west1.query49_1665777717", "jobReference": { "jobId": "query49_1665777717", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query49_1665777717?location=europe-west1", "statistics": { "creationTime": "1665777718247", "endTime": "1665777720215", "finalExecutionDurationMs": "1667", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "337676184", "performanceInsights": { "avgPreviousExecutionMs": "1506" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03363914373088685, "computeRatioMax": 0.03363914373088685, "endMs": "1665777718512", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.027522935779816515, "readRatioMax": 0.027522935779816515, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777718464", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(equal($21, 2001), equal($22, 12))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.045871559633027525 }, { "completedParallelInputs": "1", "computeMsAvg": "70", "computeMsMax": "70", "computeRatioAvg": 0.21406727828746178, "computeRatioMax": 0.21406727828746178, "endMs": "1665777718556", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.0672782874617737, "readRatioMax": 0.0672782874617737, "recordsRead": "287514", "recordsWritten": "507", "shuffleOutputBytes": "22236", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665777718486", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:sr_item_sk, $81:sr_ticket_number, $82:sr_return_quantity, $83:sr_return_amt", "FROM store_returns", "WHERE greater($83, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.024464831804281346, "writeRatioMax": 0.024464831804281346 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03669724770642202, "computeRatioMax": 0.03669724770642202, "endMs": "1665777718563", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.024464831804281346, "readRatioMax": 0.024464831804281346, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777718524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 12))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.0061162079510703364, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.027522935779816515, "writeRatioMax": 0.027522935779816515 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.13761467889908258, "computeRatioMax": 0.13761467889908258, "endMs": "1665777718615", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.045871559633027525, "readRatioMax": 0.045871559633027525, "recordsRead": "144067", "recordsWritten": "1217", "shuffleOutputBytes": "53452", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665777718544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cr_item_sk, $61:cr_order_number, $62:cr_return_quantity, $63:cr_return_amount", "FROM catalog_returns", "WHERE greater($63, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.08868501529051988, "writeRatioMax": 0.08868501529051988 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.027522935779816515, "endMs": "1665777718617", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01529051987767584, "readRatioMax": 0.01529051987767584, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777718580", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_moy", "FROM date_dim", "WHERE and(equal($2, 2001), equal($3, 12))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.045871559633027525 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.09480122324159021, "computeRatioMax": 0.09480122324159021, "endMs": "1665777718641", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.039755351681957186, "readRatioMax": 0.039755351681957186, "recordsRead": "71763", "recordsWritten": "632", "shuffleOutputBytes": "27680", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777718601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_item_sk, $41:wr_order_number, $42:wr_return_quantity, $43:wr_return_amt", "FROM web_returns", "WHERE greater($43, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.021406727828746176, "writeRatioMax": 0.021406727828746176 }, { "completedParallelInputs": "6", "computeMsAvg": "244", "computeMsMax": "294", "computeRatioAvg": 0.746177370030581, "computeRatioMax": 0.8990825688073395, "endMs": "1665777718830", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "25", "readMsMax": "32", "readRatioAvg": 0.0764525993883792, "readRatioMax": 0.09785932721712538, "recordsRead": "2883632", "recordsWritten": "11", "shuffleOutputBytes": "671", "shuffleOutputBytesSpilled": "0", "slotMs": "1416", "startMs": "1665777718640", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_ticket_number, $73:ss_quantity, $74:ss_net_paid, $75:ss_net_profit", "FROM store_sales", "WHERE and(greater($75, NUMERIC<...>), greater($74, NUMERIC<...>), greater($73, 0))" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1190 := $1180", "$690 := SUM($720)", "$691 := SUM($721)", "$692 := SUM($722)", "$693 := SUM($723)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($1183, 0)", "$721 := coalesce($1181, 0)", "$722 := coalesce($1184, NUMERIC<...>)", "$723 := coalesce($1182, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1161, $1181 := $1162, $1182 := $1163, $1183 := $1164, $1184 := $1165", "INNER HASH JOIN EACH WITH ALL ON $1160 = $20" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $70, $1161 := $71, $1162 := $73, $1163 := $74, $1164 := $82, $1165 := $83", "INNER HASH JOIN EACH WITH ALL ON $72 = $81, $71 = $80" ] }, { "kind": "WRITE", "substeps": [ "$1190, $690, $691, $692, $693", "TO __stage09_output", "BY HASH($1190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.021406727828746176, "writeRatioMax": 0.03058103975535168 }, { "completedParallelInputs": "5", "computeMsAvg": "194", "computeMsMax": "211", "computeRatioAvg": 0.5932721712538226, "computeRatioMax": 0.6452599388379205, "endMs": "1665777718816", "id": "10", "inputStages": [ "4", "3" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "24", "readMsMax": "28", "readRatioAvg": 0.07339449541284404, "readRatioMax": 0.0856269113149847, "recordsRead": "1447788", "recordsWritten": "42", "shuffleOutputBytes": "2562", "shuffleOutputBytesSpilled": "0", "slotMs": "945", "startMs": "1665777718662", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_item_sk, $52:cs_order_number, $53:cs_quantity, $54:cs_net_paid, $55:cs_net_profit", "FROM catalog_sales", "WHERE and(greater($55, NUMERIC<...>), greater($54, NUMERIC<...>), greater($53, 0))" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$680 := SUM($710)", "$681 := SUM($711)", "$682 := SUM($712)", "$683 := SUM($713)" ] }, { "kind": "COMPUTE", "substeps": [ "$710 := coalesce($973, 0)", "$711 := coalesce($971, 0)", "$712 := coalesce($974, NUMERIC<...>)", "$713 := coalesce($972, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$970 := $951, $971 := $952, $972 := $953, $973 := $954, $974 := $955", "INNER HASH JOIN EACH WITH ALL ON $950 = $10" ] }, { "kind": "JOIN", "substeps": [ "$950 := $50, $951 := $51, $952 := $53, $953 := $54, $954 := $62, $955 := $63", "INNER HASH JOIN EACH WITH ALL ON $52 = $61, $51 = $60" ] }, { "kind": "WRITE", "substeps": [ "$980, $680, $681, $682, $683", "TO __stage0A_output", "BY HASH($980)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.024464831804281346, "writeRatioMax": 0.024464831804281346 }, { "completedParallelInputs": "1", "computeMsAvg": "327", "computeMsMax": "327", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777718933", "id": "11", "inputStages": [ "6", "7" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "64", "readMsMax": "64", "readRatioAvg": 0.19571865443425077, "readRatioMax": 0.19571865443425077, "recordsRead": "720047", "recordsWritten": "16", "shuffleOutputBytes": "976", "shuffleOutputBytesSpilled": "0", "slotMs": "322", "startMs": "1665777718666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_order_number, $33:ws_quantity, $34:ws_net_paid, $35:ws_net_profit", "FROM web_sales", "WHERE and(greater($35, NUMERIC<...>), greater($34, NUMERIC<...>), greater($33, 0))" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $770 := $760", "$670 := SUM($700)", "$671 := SUM($701)", "$672 := SUM($702)", "$673 := SUM($703)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := coalesce($763, 0)", "$701 := coalesce($761, 0)", "$702 := coalesce($764, NUMERIC<...>)", "$703 := coalesce($762, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $741, $761 := $742, $762 := $743, $763 := $744, $764 := $745", "INNER HASH JOIN EACH WITH ALL ON $740 = $1" ] }, { "kind": "JOIN", "substeps": [ "$740 := $30, $741 := $31, $742 := $33, $743 := $34, $744 := $42, $745 := $43", "INNER HASH JOIN EACH WITH ALL ON $32 = $41, $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$770, $670, $671, $672, $673", "TO __stage0B_output", "BY HASH($770)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.0061162079510703364, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012232415902140673, "writeRatioMax": 0.012232415902140673 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.024464831804281346, "computeRatioMax": 0.024464831804281346, "endMs": "1665777718887", "id": "12", "inputStages": [ "10" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777718852", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$980, $680, $681, $682, $683", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := divide(CAST($630 AS DOUBLE), CAST($631 AS DOUBLE))", "$571 := divide($632, $633)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $990 := $980", "$630 := SUM($680)", "$631 := SUM($681)", "$632 := SUM($682)", "$633 := SUM($683)" ] }, { "kind": "WRITE", "substeps": [ "$990, $570, $571", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.05198776758409786, "writeRatioMax": 0.05198776758409786 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.021406727828746176, "computeRatioMax": 0.021406727828746176, "endMs": "1665777718922", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "385", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777718875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1190, $690, $691, $692, $693", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := divide(CAST($650 AS DOUBLE), CAST($651 AS DOUBLE))", "$591 := divide($652, $653)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$650 := SUM($690)", "$651 := SUM($691)", "$652 := SUM($692)", "$653 := SUM($693)" ] }, { "kind": "WRITE", "substeps": [ "$1200, $590, $591", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07951070336391437, "writeRatioMax": 0.07951070336391437 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.027522935779816515, "endMs": "1665777718948", "id": "14", "inputStages": [ "12" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777718900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$992 := shard_sink_stats($991)" ] }, { "kind": "COMPUTE", "substeps": [ "$991 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$992", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.08256880733944955, "writeRatioMax": 0.08256880733944955 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03363914373088685, "computeRatioMax": 0.03363914373088685, "endMs": "1665777718963", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777718903", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$992", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$993 := root_sink_stats($992)" ] }, { "kind": "WRITE", "substeps": [ "$993", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.0061162079510703364, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012232415902140673, "writeRatioMax": 0.012232415902140673 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.027522935779816515, "endMs": "1665777718975", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777718930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1202 := shard_sink_stats($1201)" ] }, { "kind": "COMPUTE", "substeps": [ "$1201 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1202", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07951070336391437, "writeRatioMax": 0.07951070336391437 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.027522935779816515, "endMs": "1665777718994", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777718933", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1203 := root_sink_stats($1202)" ] }, { "kind": "WRITE", "substeps": [ "$1203", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012232415902140673, "writeRatioMax": 0.012232415902140673 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.021406727828746176, "computeRatioMax": 0.021406727828746176, "endMs": "1665777719051", "id": "18", "inputStages": [ "11" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "560", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777719016", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $670, $671, $672, $673", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := divide(CAST($610 AS DOUBLE), CAST($611 AS DOUBLE))", "$551 := divide($612, $613)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $770", "$610 := SUM($670)", "$611 := SUM($671)", "$612 := SUM($672)", "$613 := SUM($673)" ] }, { "kind": "WRITE", "substeps": [ "$780, $550, $551", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.0061162079510703364, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.08256880733944955, "writeRatioMax": 0.08256880733944955 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.027522935779816515, "endMs": "1665777719087", "id": "19", "inputStages": [ "12", "15" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777719036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$993", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$490 := ROW_NUMBER($993) OVER (ORDER BY $1001 ASC)" ] }, { "kind": "SORT", "substeps": [ "$570 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1010, $490, $1011, $1012", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.0764525993883792, "writeRatioMax": 0.0764525993883792 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03363914373088685, "computeRatioMax": 0.03363914373088685, "endMs": "1665777719124", "id": "20", "inputStages": [ "17", "13" ], "name": "S14: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665777719055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1203", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$520 := ROW_NUMBER($1203) OVER (ORDER BY $1211 ASC)" ] }, { "kind": "SORT", "substeps": [ "$590 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1220, $520, $1221, $1222", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "58", "writeMsMax": "58", "writeRatioAvg": 0.17737003058103976, "writeRatioMax": 0.17737003058103976 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.01529051987767584, "computeRatioMax": 0.01529051987767584, "endMs": "1665777719071", "id": "21", "inputStages": [ "18" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665777719060", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$782 := shard_sink_stats($781)" ] }, { "kind": "COMPUTE", "substeps": [ "$781 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$782", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0030581039755351682, "writeRatioMax": 0.0030581039755351682 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.04281345565749235, "computeRatioMax": 0.04281345565749235, "endMs": "1665777719121", "id": "22", "inputStages": [ "21" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777719063", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$782", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$783 := root_sink_stats($782)" ] }, { "kind": "WRITE", "substeps": [ "$783", "TO __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.09785932721712538, "writeRatioMax": 0.09785932721712538 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "27", "computeRatioAvg": 0.03058103975535168, "computeRatioMax": 0.08256880733944955, "endMs": "1665777719186", "id": "23", "inputStages": [ "19" ], "name": "S17: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "756", "shuffleOutputBytesSpilled": "0", "slotMs": "3670", "startMs": "1665777719124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $640", "$580 := MIN($641)" ] }, { "kind": "WRITE", "substeps": [ "$580, $1040", "TO __stage17_output", "BY HASH($1040)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "18", "writeMsMax": "30", "writeRatioAvg": 0.05504587155963303, "writeRatioMax": 0.09174311926605505 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.039755351681957186, "computeRatioMax": 0.039755351681957186, "endMs": "1665777719203", "id": "24", "inputStages": [ "22", "18" ], "name": "S18: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777719154", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$783", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage12_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$460 := ROW_NUMBER($783) OVER (ORDER BY $791 ASC)" ] }, { "kind": "SORT", "substeps": [ "$550 ASC" ] }, { "kind": "WRITE", "substeps": [ "$800, $460, $801, $802", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.0672782874617737, "writeRatioMax": 0.0672782874617737 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "28", "computeRatioAvg": 0.03058103975535168, "computeRatioMax": 0.0856269113149847, "endMs": "1665777719235", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "198", "shuffleOutputBytesSpilled": "0", "slotMs": "3679", "startMs": "1665777719173", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1250 := $660", "$600 := MIN($661)" ] }, { "kind": "WRITE", "substeps": [ "$600, $1250", "TO __stage19_output", "BY HASH($1250)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "17", "writeMsMax": "29", "writeRatioAvg": 0.05198776758409786, "writeRatioMax": 0.08868501529051988 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "13", "computeRatioAvg": 0.03363914373088685, "computeRatioMax": 0.039755351681957186, "endMs": "1665777719276", "id": "26", "inputStages": [ "23" ], "name": "S1A: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "471", "startMs": "1665777719207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $1040", "FROM __stage17_output" ] }, { "kind": "COMPUTE", "substeps": [ "$430 := coalesce($1050, 0)", "$431 := coalesce($1050, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040", "$510 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "35", "writeMsMax": "55", "writeRatioAvg": 0.10703363914373089, "writeRatioMax": 0.16819571865443425 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "22", "computeRatioAvg": 0.03363914373088685, "computeRatioMax": 0.0672782874617737, "endMs": "1665777719348", "id": "28", "inputStages": [ "24" ], "name": "S1C: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "288", "shuffleOutputBytesSpilled": "0", "slotMs": "4328", "startMs": "1665777719251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $620", "$560 := MIN($621)" ] }, { "kind": "WRITE", "substeps": [ "$560, $830", "TO __stage1C_output", "BY HASH($830)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "17", "writeMsMax": "32", "writeRatioAvg": 0.05198776758409786, "writeRatioMax": 0.09785932721712538 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "16", "computeRatioAvg": 0.03058103975535168, "computeRatioMax": 0.04892966360856269, "endMs": "1665777719334", "id": "29", "inputStages": [ "25" ], "name": "S1D: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "519", "startMs": "1665777719269", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1250", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$450 := coalesce($1260, 0)", "$451 := coalesce($1260, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1250", "$540 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$450, $451, $540", "TO __stage1D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "37", "writeMsMax": "55", "writeRatioAvg": 0.11314984709480122, "writeRatioMax": 0.16819571865443425 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.024464831804281346, "computeRatioMax": 0.04892966360856269, "endMs": "1665777719369", "id": "31", "inputStages": [ "26" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "3751", "startMs": "1665777719292", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "11", "waitMsMax": "14", "waitRatioAvg": 0.03363914373088685, "waitRatioMax": 0.04281345565749235, "writeMsAvg": "12", "writeMsMax": "23", "writeRatioAvg": 0.03669724770642202, "writeRatioMax": 0.07033639143730887 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "17", "computeRatioAvg": 0.03363914373088685, "computeRatioMax": 0.05198776758409786, "endMs": "1665777719402", "id": "32", "inputStages": [ "31", "19" ], "name": "S20: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1300", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "4945", "startMs": "1665777719319", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$430, $431, $510", "FROM __stage1F_output" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $500, $1061 := $501, $1062 := $502, $1063 := $510", "INNER HASH JOIN EACH WITH ALL ON $420 = $430, $421 = $431" ] }, { "kind": "COMPUTE", "substeps": [ "$420 := coalesce($501, 0)", "$421 := coalesce($501, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1060, $1061, $1062, $1063", "TO __stage20_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.021406727828746176, "writeMsAvg": "22", "writeMsMax": "54", "writeRatioAvg": 0.0672782874617737, "writeRatioMax": 0.1651376146788991 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.024464831804281346, "computeRatioMax": 0.045871559633027525, "endMs": "1665777719417", "id": "33", "inputStages": [ "29" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "3720", "startMs": "1665777719349", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.012232415902140673, "waitRatioMax": 0.01834862385321101, "writeMsAvg": "19", "writeMsMax": "30", "writeRatioAvg": 0.0581039755351682, "writeRatioMax": 0.09174311926605505 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.04892966360856269, "endMs": "1665777719443", "id": "34", "inputStages": [ "20", "33" ], "name": "S22: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "121", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "3410", "startMs": "1665777719371", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$450, $451, $540", "FROM __stage21_output" ] }, { "kind": "JOIN", "substeps": [ "$1270 := $530, $1271 := $531, $1272 := $532, $1273 := $540", "INNER HASH JOIN EACH WITH ALL ON $440 = $450, $441 = $451" ] }, { "kind": "COMPUTE", "substeps": [ "$440 := coalesce($531, 0)", "$441 := coalesce($531, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $1271, $1272, $1273", "TO __stage22_output" ] } ], "waitMsAvg": "9", "waitMsMax": "13", "waitRatioAvg": 0.027522935779816515, "waitRatioMax": 0.039755351681957186, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.08868501529051988 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.03058103975535168, "computeRatioMax": 0.06116207951070336, "endMs": "1665777719440", "id": "35", "inputStages": [ "28" ], "name": "S23: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "350", "startMs": "1665777719397", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $830", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($840, 0)", "$411 := coalesce($840, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830", "$480 := MIN($560)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $480", "TO __stage23_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0061162079510703364, "writeMsAvg": "22", "writeMsMax": "30", "writeRatioAvg": 0.0672782874617737, "writeRatioMax": 0.09174311926605505 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.027522935779816515, "endMs": "1665777719535", "id": "37", "inputStages": [ "32" ], "name": "S25: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777719488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage20_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1065 := shard_sink_stats($1064)" ] }, { "kind": "COMPUTE", "substeps": [ "$1064 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1065", "TO __stage25_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.08256880733944955, "writeRatioMax": 0.08256880733944955 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.01529051987767584, "computeRatioMax": 0.01529051987767584, "endMs": "1665777719550", "id": "38", "inputStages": [ "37" ], "name": "S26: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777719491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1065", "FROM __stage25_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1066 := root_sink_stats($1065)" ] }, { "kind": "WRITE", "substeps": [ "$1066", "TO __stage26_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01834862385321101, "writeRatioMax": 0.01834862385321101 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.06116207951070336, "endMs": "1665777719561", "id": "39", "inputStages": [ "35" ], "name": "S27: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "15", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "4225", "startMs": "1665777719491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage23_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.012232415902140673, "writeMsAvg": "25", "writeMsMax": "32", "writeRatioAvg": 0.0764525993883792, "writeRatioMax": 0.09785932721712538 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.03058103975535168, "computeRatioMax": 0.06116207951070336, "endMs": "1665777719569", "id": "40", "inputStages": [ "39", "24" ], "name": "S28: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "226", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "3665", "startMs": "1665777719509", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $480", "FROM __stage27_output" ] }, { "kind": "JOIN", "substeps": [ "$850 := $470, $851 := $471, $852 := $472, $853 := $480", "INNER HASH JOIN EACH WITH ALL ON $400 = $410, $401 = $411" ] }, { "kind": "COMPUTE", "substeps": [ "$400 := coalesce($471, 0)", "$401 := coalesce($471, 1)" ] }, { "kind": "WRITE", "substeps": [ "$850, $851, $852, $853", "TO __stage28_output" ] } ], "waitMsAvg": "4", "waitMsMax": "9", "waitRatioAvg": 0.012232415902140673, "waitRatioMax": 0.027522935779816515, "writeMsAvg": "13", "writeMsMax": "31", "writeRatioAvg": 0.039755351681957186, "writeRatioMax": 0.09480122324159021 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.04281345565749235, "computeRatioMax": 0.04281345565749235, "endMs": "1665777719563", "id": "41", "inputStages": [ "34" ], "name": "S29: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777719520", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage22_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1275 := shard_sink_stats($1274)" ] }, { "kind": "COMPUTE", "substeps": [ "$1274 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1275", "TO __stage29_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.04892966360856269, "writeRatioMax": 0.04892966360856269 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.027522935779816515, "endMs": "1665777719574", "id": "42", "inputStages": [ "41" ], "name": "S2A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777719523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1275", "FROM __stage29_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1276 := root_sink_stats($1275)" ] }, { "kind": "WRITE", "substeps": [ "$1276", "TO __stage2A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.009174311926605505, "writeRatioMax": 0.009174311926605505 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03363914373088685, "computeRatioMax": 0.03363914373088685, "endMs": "1665777719631", "id": "43", "inputStages": [ "38", "32" ], "name": "S2B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "2226", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777719582", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1066", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage20_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$250 := ROW_NUMBER($1066) OVER (ORDER BY $1072 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1062 ASC" ] }, { "kind": "WRITE", "substeps": [ "$250, $1080, $1081, $1082, $1083", "TO __stage2B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.0061162079510703364, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.08256880733944955, "writeRatioMax": 0.08256880733944955 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03669724770642202, "computeRatioMax": 0.03669724770642202, "endMs": "1665777719625", "id": "44", "inputStages": [ "40" ], "name": "S2C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777719584", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage28_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$855 := shard_sink_stats($854)" ] }, { "kind": "COMPUTE", "substeps": [ "$854 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$855", "TO __stage2C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.0061162079510703364, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.045871559633027525 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.021406727828746176, "computeRatioMax": 0.021406727828746176, "endMs": "1665777719631", "id": "45", "inputStages": [ "44" ], "name": "S2D: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "76", "startMs": "1665777719586", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$855", "FROM __stage2C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$856 := root_sink_stats($855)" ] }, { "kind": "WRITE", "substeps": [ "$856", "TO __stage2D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012232415902140673, "writeRatioMax": 0.012232415902140673 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.0764525993883792, "computeRatioMax": 0.0764525993883792, "endMs": "1665777719666", "id": "46", "inputStages": [ "42", "34" ], "name": "S2E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "583", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665777719603", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1276", "FROM __stage2A_output" ] }, { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage22_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$280 := ROW_NUMBER($1276) OVER (ORDER BY $1282 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1272 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $1290, $1291, $1292, $1293", "TO __stage2E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.07033639143730887, "writeRatioMax": 0.07033639143730887 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.021406727828746176, "computeRatioMax": 0.021406727828746176, "endMs": "1665777719730", "id": "47", "inputStages": [ "40", "45" ], "name": "S2F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "848", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665777719657", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$856", "FROM __stage2D_output" ] }, { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage28_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := ROW_NUMBER($856) OVER (ORDER BY $862 ASC)" ] }, { "kind": "SORT", "substeps": [ "$852 ASC" ] }, { "kind": "WRITE", "substeps": [ "$220, $870, $871, $872, $873", "TO __stage2F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "57", "writeMsMax": "57", "writeRatioAvg": 0.1743119266055046, "writeRatioMax": 0.1743119266055046 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "24", "computeRatioAvg": 0.03058103975535168, "computeRatioMax": 0.07339449541284404, "endMs": "1665777719740", "id": "48", "inputStages": [ "43" ], "name": "S30: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1092", "shuffleOutputBytesSpilled": "0", "slotMs": "3862", "startMs": "1665777719679", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage2B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $370", "$320 := MIN($371)" ] }, { "kind": "WRITE", "substeps": [ "$320, $1110", "TO __stage30_output", "BY HASH($1110)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.012232415902140673, "writeMsAvg": "24", "writeMsMax": "34", "writeRatioAvg": 0.07339449541284404, "writeRatioMax": 0.10397553516819572 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.04892966360856269, "endMs": "1665777719754", "id": "49", "inputStages": [ "46" ], "name": "S31: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "286", "shuffleOutputBytesSpilled": "0", "slotMs": "3509", "startMs": "1665777719698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1320 := $390", "$330 := MIN($391)" ] }, { "kind": "WRITE", "substeps": [ "$330, $1320", "TO __stage31_output", "BY HASH($1320)" ] } ], "waitMsAvg": "3", "waitMsMax": "10", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.03058103975535168, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.04892966360856269, "writeRatioMax": 0.0856269113149847 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "25", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.0764525993883792, "endMs": "1665777719812", "id": "50", "inputStages": [ "47" ], "name": "S32: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "416", "shuffleOutputBytesSpilled": "0", "slotMs": "4225", "startMs": "1665777719754", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage2F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $350", "$310 := MIN($351)" ] }, { "kind": "WRITE", "substeps": [ "$310, $900", "TO __stage32_output", "BY HASH($900)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.012232415902140673, "writeMsAvg": "27", "writeMsMax": "43", "writeRatioAvg": 0.08256880733944955, "writeRatioMax": 0.13149847094801223 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "17", "computeRatioAvg": 0.03363914373088685, "computeRatioMax": 0.05198776758409786, "endMs": "1665777719873", "id": "51", "inputStages": [ "49" ], "name": "S33: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "380", "startMs": "1665777719833", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $1320", "FROM __stage31_output" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := coalesce($1330, NUMERIC<...>)", "$211 := coalesce($1330, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1330 := $1320", "$300 := MIN($330)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $300", "TO __stage33_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0061162079510703364, "writeMsAvg": "21", "writeMsMax": "29", "writeRatioAvg": 0.06422018348623854, "writeRatioMax": 0.08868501529051988 }, { "completedParallelInputs": "10", "computeMsAvg": "10", "computeMsMax": "14", "computeRatioAvg": 0.03058103975535168, "computeRatioMax": 0.04281345565749235, "endMs": "1665777719909", "id": "53", "inputStages": [ "48" ], "name": "S35: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "296", "startMs": "1665777719864", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $1110", "FROM __stage30_output" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($1120, NUMERIC<...>)", "$191 := coalesce($1120, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1110", "$270 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $270", "TO __stage35_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030581039755351682, "waitRatioMax": 0.0030581039755351682, "writeMsAvg": "16", "writeMsMax": "25", "writeRatioAvg": 0.04892966360856269, "writeRatioMax": 0.0764525993883792 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "11", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.03363914373088685, "endMs": "1665777719953", "id": "55", "inputStages": [ "50" ], "name": "S37: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "462", "startMs": "1665777719897", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $900", "FROM __stage32_output" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($910, NUMERIC<...>)", "$171 := coalesce($910, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$240 := MIN($310)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $240", "TO __stage37_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0061162079510703364, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "29", "writeMsMax": "31", "writeRatioAvg": 0.08868501529051988, "writeRatioMax": 0.09480122324159021 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "18", "computeRatioAvg": 0.021406727828746176, "computeRatioMax": 0.05504587155963303, "endMs": "1665777720002", "id": "57", "inputStages": [ "51" ], "name": "S39: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "2956", "startMs": "1665777719920", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage33_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.03058103975535168, "waitRatioMax": 0.03669724770642202, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.09174311926605505 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.024464831804281346, "computeRatioMax": 0.05504587155963303, "endMs": "1665777720006", "id": "58", "inputStages": [ "53" ], "name": "S3A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "3883", "startMs": "1665777719940", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage35_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.012232415902140673, "waitRatioMax": 0.01529051987767584, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.08868501529051988 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.024464831804281346, "computeRatioMax": 0.05198776758409786, "endMs": "1665777720053", "id": "59", "inputStages": [ "55" ], "name": "S3B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "3527", "startMs": "1665777719967", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage37_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.01529051987767584, "waitRatioMax": 0.021406727828746176, "writeMsAvg": "17", "writeMsMax": "35", "writeRatioAvg": 0.05198776758409786, "writeRatioMax": 0.10703363914373089 }, { "completedParallelInputs": "300", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.06422018348623854, "endMs": "1665777720064", "id": "60", "inputStages": [ "43", "58", "47", "59", "57", "46" ], "name": "S3C: Join+", "parallelInputs": "300", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1695", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "9929", "startMs": "1665777719978", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$170, $171, $240", "FROM __stage3B_output" ] }, { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$190, $191, $270", "FROM __stage3A_output" ] }, { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2E_output" ] }, { "kind": "READ", "substeps": [ "$210, $211, $300", "FROM __stage39_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $921 ASC, $923 ASC, $920 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := 'web'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($921, 10), less_or_equal($923, 10))" ] }, { "kind": "JOIN", "substeps": [ "$920 := $230, $921 := $231, $922 := $232, $923 := $240", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($233, NUMERIC<...>)", "$161 := coalesce($233, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$110 ASC, $1131 ASC, $1133 ASC, $1130 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := 'catalog'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1131, 10), less_or_equal($1133, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1130 := $260, $1131 := $261, $1132 := $262, $1133 := $270", "INNER HASH JOIN EACH WITH ALL ON $180 = $190, $181 = $191" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := coalesce($263, NUMERIC<...>)", "$181 := coalesce($263, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1341 ASC, $1343 ASC, $1340 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1341, 10), less_or_equal($1343, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1340 := $290, $1341 := $291, $1342 := $292, $1343 := $300", "INNER HASH JOIN EACH WITH ALL ON $200 = $210, $201 = $211" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($293, NUMERIC<...>)", "$201 := coalesce($293, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage3C_output" ] } ], "waitMsAvg": "9", "waitMsMax": "13", "waitRatioAvg": 0.027522935779816515, "waitRatioMax": 0.039755351681957186, "writeMsAvg": "15", "writeMsMax": "47", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.1437308868501529 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.01834862385321101, "computeRatioMax": 0.01834862385321101, "endMs": "1665777720070", "id": "61", "inputStages": [ "60" ], "name": "S3D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665777720001", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage3C_output" ] }, { "kind": "SORT", "substeps": [ "$90 ASC, $93 ASC, $94 ASC, $91 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1360, $1361, $1362, $1363, $1364", "TO __stage3D_output" ] } ], "waitMsAvg": "12", "waitMsMax": "12", "waitRatioAvg": 0.03669724770642202, "waitRatioMax": 0.03669724770642202, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01529051987767584, "writeRatioMax": 0.01529051987767584 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "21", "elapsedMs": "670", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "3154" }, { "activeUnits": "2", "completedUnits": "859", "elapsedMs": "1184", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "40684" }, { "activeUnits": "531", "completedUnits": "1900", "elapsedMs": "1871", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "86915" } ], "totalBytesBilled": "338690048", "totalBytesProcessed": "337676184", "totalPartitionsProcessed": "0", "totalSlotMs": "86915", "transferredBytes": "0" }, "startTime": "1665777718295", "totalBytesProcessed": "337676184", "totalSlotMs": "86915" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5d493c29_d49c_40a2_ac7f_d28fd322a415" }, "priority": "INTERACTIVE", "query": "select channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(sum(coalesce(wr.wr_return_quantity,0)))/\n \t\tsum(coalesce(ws.ws_quantity,0)) as return_ratio\n \t\t,(sum(coalesce(wr.wr_return_amt,0)))/\n \t\tsum(coalesce(ws.ws_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n and ws.ws_net_paid > 0\n and ws.ws_quantity > 0\n and ws_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union all\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,sum(coalesce(cr.cr_return_quantity,0))/\n \t\tsum(coalesce(cs.cs_quantity,0)) as return_ratio\n \t\t,sum(coalesce(cr.cr_return_amount,0))/\n \t\tsum(coalesce(cs.cs_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n and cs.cs_net_paid > 0\n and cs.cs_quantity > 0\n and cs_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union all\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,sum(coalesce(sr.sr_return_quantity,0))/sum(coalesce(sts.ss_quantity,0)) as return_ratio\n \t\t,sum(coalesce(sr.sr_return_amt,0))/sum(coalesce(sts.ss_net_paid,0)) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n and sts.ss_net_paid > 0 \n and sts.ss_quantity > 0\n and ss_sold_date_sk = d_date_sk\n and d_year = 2001\n and d_moy = 12\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n order by 1,4,5,2\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "eF/xUyAb0G2TNcAXyFm+mA==", "id": "test-project-364309:europe-west1.query49_1665777721", "jobReference": { "jobId": "query49_1665777721", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query49_1665777721?location=europe-west1", "statistics": { "creationTime": "1665777722222", "endTime": "1665777724338", "finalExecutionDurationMs": "1825", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "337676184", "performanceInsights": { "avgPreviousExecutionMs": "1526" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.026476578411405296, "computeRatioMax": 0.026476578411405296, "endMs": "1665777722465", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.024439918533604887, "readRatioMax": 0.024439918533604887, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777722423", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(equal($21, 2001), equal($22, 12))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.018329938900203666, "writeRatioMax": 0.018329938900203666 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.11608961303462322, "computeRatioMax": 0.11608961303462322, "endMs": "1665777722493", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.026476578411405296, "readRatioMax": 0.026476578411405296, "recordsRead": "287514", "recordsWritten": "507", "shuffleOutputBytes": "22236", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665777722436", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:sr_item_sk, $81:sr_ticket_number, $82:sr_return_quantity, $83:sr_return_amt", "FROM store_returns", "WHERE greater($83, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.014256619144602852, "writeRatioMax": 0.014256619144602852 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.024439918533604887, "computeRatioMax": 0.024439918533604887, "endMs": "1665777722505", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.018329938900203666, "readRatioMax": 0.018329938900203666, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777722466", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 12))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.018329938900203666, "writeRatioMax": 0.018329938900203666 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.06517311608961303, "computeRatioMax": 0.06517311608961303, "endMs": "1665777722519", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.020366598778004074, "readRatioMax": 0.020366598778004074, "recordsRead": "144067", "recordsWritten": "1217", "shuffleOutputBytes": "53452", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777722482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cr_item_sk, $61:cr_order_number, $62:cr_return_quantity, $63:cr_return_amount", "FROM catalog_returns", "WHERE greater($63, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.012219959266802444, "writeRatioMax": 0.012219959266802444 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.032586558044806514, "computeRatioMax": 0.032586558044806514, "endMs": "1665777722564", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.016293279022403257, "readRatioMax": 0.016293279022403257, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777722514", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_moy", "FROM date_dim", "WHERE and(equal($2, 2001), equal($3, 12))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.04276985743380855, "writeRatioMax": 0.04276985743380855 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.05295315682281059, "computeRatioMax": 0.05295315682281059, "endMs": "1665777722569", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.020366598778004074, "readRatioMax": 0.020366598778004074, "recordsRead": "71763", "recordsWritten": "632", "shuffleOutputBytes": "27680", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777722536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_item_sk, $41:wr_order_number, $42:wr_return_quantity, $43:wr_return_amt", "FROM web_returns", "WHERE greater($43, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.016293279022403257, "writeRatioMax": 0.016293279022403257 }, { "completedParallelInputs": "6", "computeMsAvg": "246", "computeMsMax": "313", "computeRatioAvg": 0.5010183299389002, "computeRatioMax": 0.6374745417515275, "endMs": "1665777722769", "id": "9", "inputStages": [ "1", "0" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "27", "readRatioAvg": 0.04684317718940937, "readRatioMax": 0.054989816700611, "recordsRead": "2883632", "recordsWritten": "11", "shuffleOutputBytes": "671", "shuffleOutputBytesSpilled": "0", "slotMs": "1363", "startMs": "1665777722567", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_ticket_number, $73:ss_quantity, $74:ss_net_paid, $75:ss_net_profit", "FROM store_sales", "WHERE and(greater($75, NUMERIC<...>), greater($74, NUMERIC<...>), greater($73, 0))" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1190 := $1180", "$690 := SUM($720)", "$691 := SUM($721)", "$692 := SUM($722)", "$693 := SUM($723)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := coalesce($1183, 0)", "$721 := coalesce($1181, 0)", "$722 := coalesce($1184, NUMERIC<...>)", "$723 := coalesce($1182, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1161, $1181 := $1162, $1182 := $1163, $1183 := $1164, $1184 := $1165", "INNER HASH JOIN EACH WITH ALL ON $1160 = $20" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $70, $1161 := $71, $1162 := $73, $1163 := $74, $1164 := $82, $1165 := $83", "INNER HASH JOIN EACH WITH ALL ON $72 = $81, $71 = $80" ] }, { "kind": "WRITE", "substeps": [ "$1190, $690, $691, $692, $693", "TO __stage09_output", "BY HASH($1190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.014256619144602852, "writeRatioMax": 0.018329938900203666 }, { "completedParallelInputs": "5", "computeMsAvg": "186", "computeMsMax": "220", "computeRatioAvg": 0.3788187372708758, "computeRatioMax": 0.4480651731160896, "endMs": "1665777722755", "id": "10", "inputStages": [ "4", "3" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "28", "readMsMax": "33", "readRatioAvg": 0.05702647657841141, "readRatioMax": 0.06720977596741344, "recordsRead": "1447788", "recordsWritten": "42", "shuffleOutputBytes": "2562", "shuffleOutputBytesSpilled": "0", "slotMs": "916", "startMs": "1665777722586", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_item_sk, $52:cs_order_number, $53:cs_quantity, $54:cs_net_paid, $55:cs_net_profit", "FROM catalog_sales", "WHERE and(greater($55, NUMERIC<...>), greater($54, NUMERIC<...>), greater($53, 0))" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$680 := SUM($710)", "$681 := SUM($711)", "$682 := SUM($712)", "$683 := SUM($713)" ] }, { "kind": "COMPUTE", "substeps": [ "$710 := coalesce($973, 0)", "$711 := coalesce($971, 0)", "$712 := coalesce($974, NUMERIC<...>)", "$713 := coalesce($972, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$970 := $951, $971 := $952, $972 := $953, $973 := $954, $974 := $955", "INNER HASH JOIN EACH WITH ALL ON $950 = $10" ] }, { "kind": "JOIN", "substeps": [ "$950 := $50, $951 := $51, $952 := $53, $953 := $54, $954 := $62, $955 := $63", "INNER HASH JOIN EACH WITH ALL ON $52 = $61, $51 = $60" ] }, { "kind": "WRITE", "substeps": [ "$980, $680, $681, $682, $683", "TO __stage0A_output", "BY HASH($980)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "9", "writeMsMax": "13", "writeRatioAvg": 0.018329938900203666, "writeRatioMax": 0.026476578411405296 }, { "completedParallelInputs": "1", "computeMsAvg": "491", "computeMsMax": "491", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777723013", "id": "11", "inputStages": [ "7", "6" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "53", "readMsMax": "53", "readRatioAvg": 0.1079429735234216, "readRatioMax": 0.1079429735234216, "recordsRead": "720047", "recordsWritten": "16", "shuffleOutputBytes": "976", "shuffleOutputBytesSpilled": "0", "slotMs": "574", "startMs": "1665777722588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_order_number, $33:ws_quantity, $34:ws_net_paid, $35:ws_net_profit", "FROM web_sales", "WHERE and(greater($35, NUMERIC<...>), greater($34, NUMERIC<...>), greater($33, 0))" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $770 := $760", "$670 := SUM($700)", "$671 := SUM($701)", "$672 := SUM($702)", "$673 := SUM($703)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := coalesce($763, 0)", "$701 := coalesce($761, 0)", "$702 := coalesce($764, NUMERIC<...>)", "$703 := coalesce($762, NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $741, $761 := $742, $762 := $743, $763 := $744, $764 := $745", "INNER HASH JOIN EACH WITH ALL ON $740 = $1" ] }, { "kind": "JOIN", "substeps": [ "$740 := $30, $741 := $31, $742 := $33, $743 := $34, $744 := $42, $745 := $43", "INNER HASH JOIN EACH WITH ALL ON $32 = $41, $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$770, $670, $671, $672, $673", "TO __stage0B_output", "BY HASH($770)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "45", "writeMsMax": "45", "writeRatioAvg": 0.09164969450101833, "writeRatioMax": 0.09164969450101833 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.018329938900203666, "endMs": "1665777722818", "id": "12", "inputStages": [ "10" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777722780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$980, $680, $681, $682, $683", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := divide(CAST($630 AS DOUBLE), CAST($631 AS DOUBLE))", "$571 := divide($632, $633)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $990 := $980", "$630 := SUM($680)", "$631 := SUM($681)", "$632 := SUM($682)", "$633 := SUM($683)" ] }, { "kind": "WRITE", "substeps": [ "$990, $570, $571", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.059063136456211814, "writeRatioMax": 0.059063136456211814 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.018329938900203666, "endMs": "1665777722836", "id": "13", "inputStages": [ "9" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "385", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777722798", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1190, $690, $691, $692, $693", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$590 := divide(CAST($650 AS DOUBLE), CAST($651 AS DOUBLE))", "$591 := divide($652, $653)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1190", "$650 := SUM($690)", "$651 := SUM($691)", "$652 := SUM($692)", "$653 := SUM($693)" ] }, { "kind": "WRITE", "substeps": [ "$1200, $590, $591", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.032586558044806514, "writeRatioMax": 0.032586558044806514 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012219959266802444, "computeRatioMax": 0.012219959266802444, "endMs": "1665777722872", "id": "14", "inputStages": [ "12" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777722820", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$992 := shard_sink_stats($991)" ] }, { "kind": "COMPUTE", "substeps": [ "$991 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$992", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "44", "writeMsMax": "44", "writeRatioAvg": 0.08961303462321792, "writeRatioMax": 0.08961303462321792 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.010183299389002037, "computeRatioMax": 0.010183299389002037, "endMs": "1665777722891", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777722822", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$992", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$993 := root_sink_stats($992)" ] }, { "kind": "WRITE", "substeps": [ "$993", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008146639511201629, "writeRatioMax": 0.008146639511201629 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.008146639511201629, "computeRatioMax": 0.008146639511201629, "endMs": "1665777722901", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777722844", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1202 := shard_sink_stats($1201)" ] }, { "kind": "COMPUTE", "substeps": [ "$1201 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1202", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "50", "writeMsMax": "50", "writeRatioAvg": 0.10183299389002037, "writeRatioMax": 0.10183299389002037 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.016293279022403257, "endMs": "1665777722911", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777722846", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1203 := root_sink_stats($1202)" ] }, { "kind": "WRITE", "substeps": [ "$1203", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006109979633401222, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008146639511201629, "writeRatioMax": 0.008146639511201629 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.016293279022403257, "endMs": "1665777722993", "id": "18", "inputStages": [ "12", "15" ], "name": "S12: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777722917", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$993", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$990, $570, $571", "FROM __stage0C_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$490 := ROW_NUMBER($993) OVER (ORDER BY $1001 ASC)" ] }, { "kind": "SORT", "substeps": [ "$570 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1010, $490, $1011, $1012", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "64", "writeMsMax": "64", "writeRatioAvg": 0.13034623217922606, "writeRatioMax": 0.13034623217922606 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.03665987780040733, "computeRatioMax": 0.03665987780040733, "endMs": "1665777723011", "id": "19", "inputStages": [ "13", "17" ], "name": "S13: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777722956", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1203", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$1200, $590, $591", "FROM __stage0D_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$520 := ROW_NUMBER($1203) OVER (ORDER BY $1211 ASC)" ] }, { "kind": "SORT", "substeps": [ "$590 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1220, $520, $1221, $1222", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "38", "writeMsMax": "38", "writeRatioAvg": 0.07739307535641547, "writeRatioMax": 0.07739307535641547 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "22", "computeRatioAvg": 0.020366598778004074, "computeRatioMax": 0.04480651731160896, "endMs": "1665777723096", "id": "20", "inputStages": [ "18" ], "name": "S14: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "756", "shuffleOutputBytesSpilled": "0", "slotMs": "4077", "startMs": "1665777723033", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $640", "$580 := MIN($641)" ] }, { "kind": "WRITE", "substeps": [ "$580, $1040", "TO __stage14_output", "BY HASH($1040)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.06109979633401222 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "25", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.05091649694501019, "endMs": "1665777723111", "id": "21", "inputStages": [ "19" ], "name": "S15: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "198", "shuffleOutputBytesSpilled": "0", "slotMs": "4511", "startMs": "1665777723048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1250 := $660", "$600 := MIN($661)" ] }, { "kind": "WRITE", "substeps": [ "$600, $1250", "TO __stage15_output", "BY HASH($1250)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "35", "writeMsMax": "53", "writeRatioAvg": 0.07128309572301425, "writeRatioMax": 0.1079429735234216 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.020366598778004074, "computeRatioMax": 0.020366598778004074, "endMs": "1665777723168", "id": "22", "inputStages": [ "11" ], "name": "S16: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "560", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777723136", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $670, $671, $672, $673", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$550 := divide(CAST($610 AS DOUBLE), CAST($611 AS DOUBLE))", "$551 := divide($612, $613)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $770", "$610 := SUM($670)", "$611 := SUM($671)", "$612 := SUM($672)", "$613 := SUM($673)" ] }, { "kind": "WRITE", "substeps": [ "$780, $550, $551", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.05091649694501019, "writeRatioMax": 0.05091649694501019 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "16", "computeRatioAvg": 0.02240325865580448, "computeRatioMax": 0.032586558044806514, "endMs": "1665777723200", "id": "23", "inputStages": [ "20" ], "name": "S17: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "391", "startMs": "1665777723159", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $1040", "FROM __stage14_output" ] }, { "kind": "COMPUTE", "substeps": [ "$430 := coalesce($1050, 0)", "$431 := coalesce($1050, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040", "$510 := MIN($580)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $510", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "25", "writeMsMax": "29", "writeRatioAvg": 0.05091649694501019, "writeRatioMax": 0.059063136456211814 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "13", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.026476578411405296, "endMs": "1665777723233", "id": "25", "inputStages": [ "21" ], "name": "S19: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "370", "startMs": "1665777723193", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $1250", "FROM __stage15_output" ] }, { "kind": "COMPUTE", "substeps": [ "$450 := coalesce($1260, 0)", "$451 := coalesce($1260, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1260 := $1250", "$540 := MIN($600)" ] }, { "kind": "WRITE", "substeps": [ "$450, $451, $540", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "26", "writeMsMax": "31", "writeRatioAvg": 0.05295315682281059, "writeRatioMax": 0.06313645621181263 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012219959266802444, "computeRatioMax": 0.012219959266802444, "endMs": "1665777723222", "id": "27", "inputStages": [ "22" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665777723211", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$782 := shard_sink_stats($781)" ] }, { "kind": "COMPUTE", "substeps": [ "$781 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$782", "TO __stage1B_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002036659877800407, "writeRatioMax": 0.002036659877800407 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.020366598778004074, "computeRatioMax": 0.020366598778004074, "endMs": "1665777723253", "id": "28", "inputStages": [ "27" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777723212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$782", "FROM __stage1B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$783 := root_sink_stats($782)" ] }, { "kind": "WRITE", "substeps": [ "$783", "TO __stage1C_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.006109979633401222, "writeRatioMax": 0.006109979633401222 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.034623217922606926, "endMs": "1665777723276", "id": "29", "inputStages": [ "23" ], "name": "S1D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37", "recordsWritten": "37", "shuffleOutputBytes": "999", "shuffleOutputBytesSpilled": "0", "slotMs": "3759", "startMs": "1665777723218", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.05702647657841141 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "22", "computeRatioAvg": 0.020366598778004074, "computeRatioMax": 0.04480651731160896, "endMs": "1665777723299", "id": "30", "inputStages": [ "18", "29" ], "name": "S1E: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1300", "recordsWritten": "42", "shuffleOutputBytes": "1848", "shuffleOutputBytesSpilled": "0", "slotMs": "3994", "startMs": "1665777723233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1010, $490, $1011, $1012", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$430, $431, $510", "FROM __stage1D_output" ] }, { "kind": "JOIN", "substeps": [ "$1060 := $500, $1061 := $501, $1062 := $502, $1063 := $510", "INNER HASH JOIN EACH WITH ALL ON $420 = $430, $421 = $431" ] }, { "kind": "COMPUTE", "substeps": [ "$420 := coalesce($501, 0)", "$421 := coalesce($501, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1060, $1061, $1062, $1063", "TO __stage1E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.006109979633401222, "waitRatioMax": 0.010183299389002037, "writeMsAvg": "15", "writeMsMax": "39", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.07942973523421588 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.034623217922606926, "endMs": "1665777723301", "id": "31", "inputStages": [ "25" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "3147", "startMs": "1665777723250", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.028513238289205704, "writeRatioMax": 0.03665987780040733 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "17", "computeRatioAvg": 0.020366598778004074, "computeRatioMax": 0.034623217922606926, "endMs": "1665777723398", "id": "32", "inputStages": [ "31", "19" ], "name": "S20: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "121", "recordsWritten": "11", "shuffleOutputBytes": "484", "shuffleOutputBytesSpilled": "0", "slotMs": "3660", "startMs": "1665777723267", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1220, $520, $1221, $1222", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$450, $451, $540", "FROM __stage1F_output" ] }, { "kind": "JOIN", "substeps": [ "$1270 := $530, $1271 := $531, $1272 := $532, $1273 := $540", "INNER HASH JOIN EACH WITH ALL ON $440 = $450, $441 = $451" ] }, { "kind": "COMPUTE", "substeps": [ "$440 := coalesce($531, 0)", "$441 := coalesce($531, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1270, $1271, $1272, $1273", "TO __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.010183299389002037, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.06313645621181263 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03054989816700611, "computeRatioMax": 0.03054989816700611, "endMs": "1665777723333", "id": "33", "inputStages": [ "22", "28" ], "name": "S21: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777723282", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$783", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$780, $550, $551", "FROM __stage16_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$460 := ROW_NUMBER($783) OVER (ORDER BY $791 ASC)" ] }, { "kind": "SORT", "substeps": [ "$550 ASC" ] }, { "kind": "WRITE", "substeps": [ "$800, $460, $801, $802", "TO __stage21_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "38", "writeMsMax": "38", "writeRatioAvg": 0.07739307535641547, "writeRatioMax": 0.07739307535641547 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.024439918533604887, "computeRatioMax": 0.024439918533604887, "endMs": "1665777723351", "id": "34", "inputStages": [ "30" ], "name": "S22: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777723309", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage1E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1065 := shard_sink_stats($1064)" ] }, { "kind": "COMPUTE", "substeps": [ "$1064 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1065", "TO __stage22_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03665987780040733, "writeRatioMax": 0.03665987780040733 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.016293279022403257, "endMs": "1665777723365", "id": "35", "inputStages": [ "34" ], "name": "S23: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777723313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1065", "FROM __stage22_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1066 := root_sink_stats($1065)" ] }, { "kind": "WRITE", "substeps": [ "$1066", "TO __stage23_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006109979633401222, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.004073319755600814, "writeRatioMax": 0.004073319755600814 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "13", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.026476578411405296, "endMs": "1665777723416", "id": "36", "inputStages": [ "33" ], "name": "S24: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "288", "shuffleOutputBytesSpilled": "0", "slotMs": "3412", "startMs": "1665777723365", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage21_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $620", "$560 := MIN($621)" ] }, { "kind": "WRITE", "substeps": [ "$560, $830", "TO __stage24_output", "BY HASH($830)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "19", "writeMsMax": "32", "writeRatioAvg": 0.038696537678207736, "writeRatioMax": 0.06517311608961303 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.024439918533604887, "computeRatioMax": 0.024439918533604887, "endMs": "1665777723448", "id": "37", "inputStages": [ "35", "30" ], "name": "S25: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "43", "recordsWritten": "42", "shuffleOutputBytes": "2226", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777723397", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1066", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$1060, $1061, $1062, $1063", "FROM __stage1E_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$250 := ROW_NUMBER($1066) OVER (ORDER BY $1072 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1062 ASC" ] }, { "kind": "WRITE", "substeps": [ "$250, $1080, $1081, $1082, $1083", "TO __stage25_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.07942973523421588, "writeRatioMax": 0.07942973523421588 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012219959266802444, "computeRatioMax": 0.012219959266802444, "endMs": "1665777723477", "id": "38", "inputStages": [ "32" ], "name": "S26: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777723442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage20_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1275 := shard_sink_stats($1274)" ] }, { "kind": "COMPUTE", "substeps": [ "$1274 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$1275", "TO __stage26_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.05295315682281059, "writeRatioMax": 0.05295315682281059 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012219959266802444, "computeRatioMax": 0.012219959266802444, "endMs": "1665777723483", "id": "39", "inputStages": [ "38" ], "name": "S27: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777723444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1275", "FROM __stage26_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$1276 := root_sink_stats($1275)" ] }, { "kind": "WRITE", "substeps": [ "$1276", "TO __stage27_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.006109979633401222, "writeRatioMax": 0.006109979633401222 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "20", "computeRatioAvg": 0.02240325865580448, "computeRatioMax": 0.04073319755600815, "endMs": "1665777723505", "id": "40", "inputStages": [ "36" ], "name": "S28: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "397", "startMs": "1665777723459", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $830", "FROM __stage24_output" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($840, 0)", "$411 := coalesce($840, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830", "$480 := MIN($560)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $480", "TO __stage28_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "24", "writeMsMax": "30", "writeRatioAvg": 0.048879837067209775, "writeRatioMax": 0.06109979633401222 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.04073319755600815, "endMs": "1665777723555", "id": "42", "inputStages": [ "37" ], "name": "S2A: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "42", "shuffleOutputBytes": "1092", "shuffleOutputBytesSpilled": "0", "slotMs": "3453", "startMs": "1665777723501", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage25_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $370", "$320 := MIN($371)" ] }, { "kind": "WRITE", "substeps": [ "$320, $1110", "TO __stage2A_output", "BY HASH($1110)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "27", "writeMsMax": "33", "writeRatioAvg": 0.054989816700611, "writeRatioMax": 0.06720977596741344 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02240325865580448, "computeRatioMax": 0.02240325865580448, "endMs": "1665777723566", "id": "43", "inputStages": [ "32", "39" ], "name": "S2B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12", "recordsWritten": "11", "shuffleOutputBytes": "583", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777723515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1276", "FROM __stage27_output" ] }, { "kind": "READ", "substeps": [ "$1270, $1271, $1272, $1273", "FROM __stage20_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$280 := ROW_NUMBER($1276) OVER (ORDER BY $1282 ASC)" ] }, { "kind": "SORT", "substeps": [ "$1272 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $1290, $1291, $1292, $1293", "TO __stage2B_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "38", "writeMsMax": "38", "writeRatioAvg": 0.07739307535641547, "writeRatioMax": 0.07739307535641547 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.03665987780040733, "endMs": "1665777723587", "id": "44", "inputStages": [ "40" ], "name": "S2C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "15", "recordsWritten": "15", "shuffleOutputBytes": "405", "shuffleOutputBytesSpilled": "0", "slotMs": "4246", "startMs": "1665777723518", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage28_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.028513238289205704, "writeRatioMax": 0.038696537678207736 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.03665987780040733, "endMs": "1665777723663", "id": "45", "inputStages": [ "44", "33" ], "name": "S2D: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "226", "recordsWritten": "16", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "3782", "startMs": "1665777723537", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$800, $460, $801, $802", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $480", "FROM __stage2C_output" ] }, { "kind": "JOIN", "substeps": [ "$850 := $470, $851 := $471, $852 := $472, $853 := $480", "INNER HASH JOIN EACH WITH ALL ON $400 = $410, $401 = $411" ] }, { "kind": "COMPUTE", "substeps": [ "$400 := coalesce($471, 0)", "$401 := coalesce($471, 1)" ] }, { "kind": "WRITE", "substeps": [ "$850, $851, $852, $853", "TO __stage2D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004073319755600814, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "21", "writeMsMax": "30", "writeRatioAvg": 0.04276985743380855, "writeRatioMax": 0.06109979633401222 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "28", "computeRatioAvg": 0.020366598778004074, "computeRatioMax": 0.05702647657841141, "endMs": "1665777723652", "id": "46", "inputStages": [ "43" ], "name": "S2E: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "286", "shuffleOutputBytesSpilled": "0", "slotMs": "4094", "startMs": "1665777723583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1320 := $390", "$330 := MIN($391)" ] }, { "kind": "WRITE", "substeps": [ "$330, $1320", "TO __stage2E_output", "BY HASH($1320)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "35", "writeMsMax": "56", "writeRatioAvg": 0.07128309572301425, "writeRatioMax": 0.11405295315682282 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02240325865580448, "computeRatioMax": 0.02240325865580448, "endMs": "1665777723710", "id": "47", "inputStages": [ "45" ], "name": "S2F: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "1", "shuffleOutputBytes": "37", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777723673", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage2D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$855 := shard_sink_stats($854)" ] }, { "kind": "COMPUTE", "substeps": [ "$854 := STRUCT<...>" ] }, { "kind": "WRITE", "substeps": [ "$855", "TO __stage2F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.028513238289205704, "writeRatioMax": 0.028513238289205704 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012219959266802444, "computeRatioMax": 0.012219959266802444, "endMs": "1665777723727", "id": "48", "inputStages": [ "47" ], "name": "S30: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777723675", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$855", "FROM __stage2F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$856 := root_sink_stats($855)" ] }, { "kind": "WRITE", "substeps": [ "$856", "TO __stage30_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006109979633401222, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008146639511201629, "writeRatioMax": 0.008146639511201629 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.014256619144602852, "computeRatioMax": 0.014256619144602852, "endMs": "1665777723812", "id": "49", "inputStages": [ "45", "48" ], "name": "S31: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17", "recordsWritten": "16", "shuffleOutputBytes": "848", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777723752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$856", "FROM __stage30_output" ] }, { "kind": "READ", "substeps": [ "$850, $851, $852, $853", "FROM __stage2D_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := ROW_NUMBER($856) OVER (ORDER BY $862 ASC)" ] }, { "kind": "SORT", "substeps": [ "$852 ASC" ] }, { "kind": "WRITE", "substeps": [ "$220, $870, $871, $872, $873", "TO __stage31_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.07942973523421588, "writeRatioMax": 0.07942973523421588 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.04684317718940937, "endMs": "1665777723888", "id": "50", "inputStages": [ "49" ], "name": "S32: Aggregate", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "416", "shuffleOutputBytesSpilled": "0", "slotMs": "3500", "startMs": "1665777723838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage31_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $350", "$310 := MIN($351)" ] }, { "kind": "WRITE", "substeps": [ "$310, $900", "TO __stage32_output", "BY HASH($900)" ] } ], "waitMsAvg": "1", "waitMsMax": "10", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.020366598778004074, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.054989816700611 }, { "completedParallelInputs": "10", "computeMsAvg": "11", "computeMsMax": "17", "computeRatioAvg": 0.02240325865580448, "computeRatioMax": 0.034623217922606926, "endMs": "1665777723953", "id": "51", "inputStages": [ "46" ], "name": "S33: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "405", "startMs": "1665777723914", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $1320", "FROM __stage2E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := coalesce($1330, NUMERIC<...>)", "$211 := coalesce($1330, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1330 := $1320", "$300 := MIN($330)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $300", "TO __stage33_output" ] } ], "waitMsAvg": "1", "waitMsMax": "10", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.020366598778004074, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.05295315682281059 }, { "completedParallelInputs": "10", "computeMsAvg": "12", "computeMsMax": "23", "computeRatioAvg": 0.024439918533604887, "computeRatioMax": 0.04684317718940937, "endMs": "1665777723993", "id": "53", "inputStages": [ "42" ], "name": "S35: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "42", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "427", "startMs": "1665777723944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $1110", "FROM __stage2A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := coalesce($1120, NUMERIC<...>)", "$191 := coalesce($1120, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1120 := $1110", "$270 := MIN($320)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $270", "TO __stage35_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "20", "writeMsMax": "27", "writeRatioAvg": 0.04073319755600815, "writeRatioMax": 0.054989816700611 }, { "completedParallelInputs": "10", "computeMsAvg": "9", "computeMsMax": "11", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.02240325865580448, "endMs": "1665777724020", "id": "55", "inputStages": [ "50" ], "name": "S37: Aggregate+", "parallelInputs": "10", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "328", "startMs": "1665777723980", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $900", "FROM __stage32_output" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($910, NUMERIC<...>)", "$171 := coalesce($910, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$240 := MIN($310)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $240", "TO __stage37_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.002036659877800407, "writeMsAvg": "26", "writeMsMax": "29", "writeRatioAvg": 0.05295315682281059, "writeRatioMax": 0.059063136456211814 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "26", "computeRatioAvg": 0.018329938900203666, "computeRatioMax": 0.05295315682281059, "endMs": "1665777724071", "id": "57", "inputStages": [ "51" ], "name": "S39: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "3565", "startMs": "1665777724003", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage33_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.008146639511201629, "waitRatioMax": 0.010183299389002037, "writeMsAvg": "15", "writeMsMax": "23", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.04684317718940937 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.03665987780040733, "endMs": "1665777724076", "id": "58", "inputStages": [ "53" ], "name": "S3A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38", "recordsWritten": "38", "shuffleOutputBytes": "1634", "shuffleOutputBytesSpilled": "0", "slotMs": "3690", "startMs": "1665777724009", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage35_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.004073319755600814, "writeMsAvg": "17", "writeMsMax": "35", "writeRatioAvg": 0.034623217922606926, "writeRatioMax": 0.07128309572301425 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.034623217922606926, "endMs": "1665777724098", "id": "59", "inputStages": [ "55" ], "name": "S3B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16", "recordsWritten": "16", "shuffleOutputBytes": "688", "shuffleOutputBytesSpilled": "0", "slotMs": "3606", "startMs": "1665777724035", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage37_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002036659877800407, "waitRatioMax": 0.006109979633401222, "writeMsAvg": "15", "writeMsMax": "32", "writeRatioAvg": 0.03054989816700611, "writeRatioMax": 0.06517311608961303 }, { "completedParallelInputs": "300", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.016293279022403257, "computeRatioMax": 0.038696537678207736, "endMs": "1665777724111", "id": "60", "inputStages": [ "57", "43", "37", "59", "49", "58" ], "name": "S3C: Join+", "parallelInputs": "300", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1695", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "8522", "startMs": "1665777724042", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $870, $871, $872, $873", "FROM __stage31_output" ] }, { "kind": "READ", "substeps": [ "$170, $171, $240", "FROM __stage3B_output" ] }, { "kind": "READ", "substeps": [ "$250, $1080, $1081, $1082, $1083", "FROM __stage25_output" ] }, { "kind": "READ", "substeps": [ "$190, $191, $270", "FROM __stage3A_output" ] }, { "kind": "READ", "substeps": [ "$280, $1290, $1291, $1292, $1293", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$210, $211, $300", "FROM __stage39_output" ] }, { "kind": "SORT", "substeps": [ "$100 ASC, $921 ASC, $923 ASC, $920 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := 'web'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($921, 10), less_or_equal($923, 10))" ] }, { "kind": "JOIN", "substeps": [ "$920 := $230, $921 := $231, $922 := $232, $923 := $240", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($233, NUMERIC<...>)", "$161 := coalesce($233, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$110 ASC, $1131 ASC, $1133 ASC, $1130 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := 'catalog'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1131, 10), less_or_equal($1133, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1130 := $260, $1131 := $261, $1132 := $262, $1133 := $270", "INNER HASH JOIN EACH WITH ALL ON $180 = $190, $181 = $191" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := coalesce($263, NUMERIC<...>)", "$181 := coalesce($263, NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1341 ASC, $1343 ASC, $1340 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'" ] }, { "kind": "FILTER", "substeps": [ "or(less_or_equal($1341, 10), less_or_equal($1343, 10))" ] }, { "kind": "JOIN", "substeps": [ "$1340 := $290, $1341 := $291, $1342 := $292, $1343 := $300", "INNER HASH JOIN EACH WITH ALL ON $200 = $210, $201 = $211" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := coalesce($293, NUMERIC<...>)", "$201 := coalesce($293, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage3C_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.010183299389002037, "waitRatioMax": 0.014256619144602852, "writeMsAvg": "10", "writeMsMax": "28", "writeRatioAvg": 0.020366598778004074, "writeRatioMax": 0.05702647657841141 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.024439918533604887, "computeRatioMax": 0.024439918533604887, "endMs": "1665777724193", "id": "61", "inputStages": [ "60" ], "name": "S3D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "32", "recordsWritten": "32", "shuffleOutputBytes": "1470", "shuffleOutputBytesSpilled": "0", "slotMs": "137", "startMs": "1665777724058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage3C_output" ] }, { "kind": "SORT", "substeps": [ "$90 ASC, $93 ASC, $94 ASC, $91 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1360, $1361, $1362, $1363, $1364", "TO __stage3D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.008146639511201629, "waitRatioMax": 0.008146639511201629, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.006109979633401222, "writeRatioMax": 0.006109979633401222 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "23", "elapsedMs": "649", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "3226" }, { "activeUnits": "110", "completedUnits": "1900", "elapsedMs": "2001", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "77440" } ], "totalBytesBilled": "338690048", "totalBytesProcessed": "337676184", "totalPartitionsProcessed": "0", "totalSlotMs": "77440", "transferredBytes": "0" }, "startTime": "1665777722276", "totalBytesProcessed": "337676184", "totalSlotMs": "77440" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
