{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6389941d_8573_4b0d_9df4_522341d3c879" }, "priority": "INTERACTIVE", "query": "select \n sum(ws_ext_discount_amt) as Excess_Discount_Amount \nfrom \n web_sales \n ,item \n ,date_dim\nwhere\ni_manufact_id = 350\nand i_item_sk = ws_item_sk \nand d_date between '2000-01-27' and \n (cast('2000-01-27' + 90 as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt \n > ( \n SELECT \n 1.3 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp avg(ws_ext_discount_amt) \n FROM \n web_sales \n ,date_dim\n WHERE \n ws_item_sk = i_item_sk \n and d_date between '2000-01-27' and\n (cast('2000-01-27' + 90 as date))\n and d_date_sk = ws_sold_date_sk \n ) \norder by sum(ws_ext_discount_amt)\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "0A8Cc9BQ80w91UHAxaVRDQ==", "id": "test-project-364309:europe-west1.query92_1665768515", "jobReference": { "jobId": "query92_1665768515", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query92_1665768515?location=europe-west1", "statistics": { "creationTime": "1665768515601", "endTime": "1665768516356", "finalExecutionDurationMs": "578", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24472392", "performanceInsights": { "avgPreviousExecutionMs": "580" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06593406593406594, "computeRatioMax": 0.06593406593406594, "endMs": "1665768515781", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.027472527472527472, "readRatioMax": 0.027472527472527472, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768515745", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005494505494505495, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.06593406593406594, "writeRatioMax": 0.06593406593406594 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.11538461538461539, "computeRatioMax": 0.11538461538461539, "endMs": "1665768515827", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.06043956043956044, "readRatioMax": 0.06043956043956044, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768515775", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_date", "FROM date_dim", "WHERE between($31, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005494505494505495, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.15934065934065933, "writeRatioMax": 0.15934065934065933 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04945054945054945, "computeRatioMax": 0.04945054945054945, "endMs": "1665768515841", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03296703296703297, "readRatioMax": 0.03296703296703297, "recordsRead": "18000", "recordsWritten": "25", "shuffleOutputBytes": "225", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768515803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_manufact_id", "FROM item", "WHERE equal($41, 350)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005494505494505495, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.12087912087912088, "writeRatioMax": 0.12087912087912088 }, { "completedParallelInputs": "1", "computeMsAvg": "182", "computeMsMax": "182", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768515980", "id": "5", "inputStages": [ "0" ], "name": "S05: Join", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.08241758241758242, "readRatioMax": 0.08241758241758242, "recordsRead": "719475", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "178", "startMs": "1665768515833", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$120 := $2, $121 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005494505494505495, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.11538461538461539, "writeRatioMax": 0.11538461538461539 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.04395604395604396, "computeRatioMax": 0.08791208791208792, "endMs": "1665768516044", "id": "6", "inputStages": [ "5" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20708", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "3210", "startMs": "1665768515989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.01098901098901099, "waitRatioMax": 0.016483516483516484, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.08241758241758242, "writeRatioMax": 0.10989010989010989 }, { "completedParallelInputs": "1", "computeMsAvg": "182", "computeMsMax": "182", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768516169", "id": "7", "inputStages": [ "6", "3", "2" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.08791208791208792, "readRatioMax": 0.08791208791208792, "recordsRead": "740208", "recordsWritten": "29", "shuffleOutputBytes": "1846", "shuffleOutputBytesSpilled": "0", "slotMs": "170", "startMs": "1665768515994", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $131", "$80 := SHARD_AVG($132)", "$81 := ANY_VALUE($130)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $90, $132 := $121", "LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$110 := $101, $111 := $102", "INNER HASH JOIN EACH WITH ALL ON $100 = $30" ] }, { "kind": "JOIN", "substeps": [ "$100 := $20, $101 := $22, $102 := $40", "INNER HASH JOIN EACH WITH ALL ON $21 = $40" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $140", "TO __stage07_output", "BY HASH($140)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01098901098901099, "waitRatioMax": 0.01098901098901099, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03296703296703297, "writeRatioMax": 0.03296703296703297 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03296703296703297, "computeRatioMax": 0.03296703296703297, "endMs": "1665768516236", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "29", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665768516226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $140", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := SUM($71)" ] }, { "kind": "FILTER", "substeps": [ "greater($71, multiply(NUMERIC<...>, $70))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $140", "$70 := ROOT_AVG($80)", "$71 := ANY_VALUE($81)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005494505494505495, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.005494505494505495, "writeRatioMax": 0.005494505494505495 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06593406593406594, "computeRatioMax": 0.06593406593406594, "endMs": "1665768516283", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768516246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($60)" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.016483516483516484, "waitRatioMax": 0.016483516483516484, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07692307692307693, "writeRatioMax": 0.07692307692307693 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "106", "elapsedMs": "599", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3645" }, { "activeUnits": "0", "completedUnits": "107", "elapsedMs": "668", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3675" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24472392", "totalPartitionsProcessed": "0", "totalSlotMs": "3675", "transferredBytes": "0" }, "startTime": "1665768515647", "totalBytesProcessed": "24472392", "totalSlotMs": "3675" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonad29435c_37b7_49f1_8acd_aed4864b4b93" }, "priority": "INTERACTIVE", "query": "select \n sum(ws_ext_discount_amt) as Excess_Discount_Amount \nfrom \n web_sales \n ,item \n ,date_dim\nwhere\ni_manufact_id = 350\nand i_item_sk = ws_item_sk \nand d_date between '2000-01-27' and \n (cast('2000-01-27' + 90 as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt \n > ( \n SELECT \n 1.3 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp avg(ws_ext_discount_amt) \n FROM \n web_sales \n ,date_dim\n WHERE \n ws_item_sk = i_item_sk \n and d_date between '2000-01-27' and\n (cast('2000-01-27' + 90 as date))\n and d_date_sk = ws_sold_date_sk \n ) \norder by sum(ws_ext_discount_amt)\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "p2gep9B90A4oCNLB2J56Hg==", "id": "test-project-364309:europe-west1.query92_1665778806", "jobReference": { "jobId": "query92_1665778806", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query92_1665778806?location=europe-west1", "statistics": { "creationTime": "1665778807273", "endTime": "1665778808048", "finalExecutionDurationMs": "577", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24472392", "performanceInsights": { "avgPreviousExecutionMs": "580" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05263157894736842, "computeRatioMax": 0.05263157894736842, "endMs": "1665778807448", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.031578947368421054, "readRatioMax": 0.031578947368421054, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778807410", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06842105263157895, "writeRatioMax": 0.06842105263157895 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.07894736842105263, "computeRatioMax": 0.07894736842105263, "endMs": "1665778807465", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03684210526315789, "readRatioMax": 0.03684210526315789, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778807437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_date", "FROM date_dim", "WHERE between($31, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06842105263157895, "writeRatioMax": 0.06842105263157895 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06315789473684211, "computeRatioMax": 0.06315789473684211, "endMs": "1665778807487", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.042105263157894736, "readRatioMax": 0.042105263157894736, "recordsRead": "18000", "recordsWritten": "25", "shuffleOutputBytes": "225", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778807450", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_manufact_id", "FROM item", "WHERE equal($41, 350)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.042105263157894736, "writeRatioMax": 0.042105263157894736 }, { "completedParallelInputs": "1", "computeMsAvg": "190", "computeMsMax": "190", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778807637", "id": "5", "inputStages": [ "0" ], "name": "S05: Join", "parallelInputs": "1", "readMsAvg": "25", "readMsMax": "25", "readRatioAvg": 0.13157894736842105, "readRatioMax": 0.13157894736842105, "recordsRead": "719475", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "186", "startMs": "1665778807480", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$120 := $2, $121 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.12631578947368421, "writeRatioMax": 0.12631578947368421 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.042105263157894736, "computeRatioMax": 0.08421052631578947, "endMs": "1665778807720", "id": "6", "inputStages": [ "5" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20708", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "3147", "startMs": "1665778807666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.010526315789473684, "waitRatioMax": 0.015789473684210527, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.07368421052631578, "writeRatioMax": 0.10526315789473684 }, { "completedParallelInputs": "1", "computeMsAvg": "176", "computeMsMax": "176", "computeRatioAvg": 0.9263157894736842, "computeRatioMax": 0.9263157894736842, "endMs": "1665778807864", "id": "7", "inputStages": [ "6", "2", "3" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.11052631578947368, "readRatioMax": 0.11052631578947368, "recordsRead": "740208", "recordsWritten": "29", "shuffleOutputBytes": "1846", "shuffleOutputBytesSpilled": "0", "slotMs": "181", "startMs": "1665778807673", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $131", "$80 := SHARD_AVG($132)", "$81 := ANY_VALUE($130)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $90, $132 := $121", "LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$110 := $101, $111 := $102", "INNER HASH JOIN EACH WITH ALL ON $100 = $30" ] }, { "kind": "JOIN", "substeps": [ "$100 := $20, $101 := $22, $102 := $40", "INNER HASH JOIN EACH WITH ALL ON $21 = $40" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $140", "TO __stage07_output", "BY HASH($140)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.042105263157894736, "writeRatioMax": 0.042105263157894736 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.08947368421052632, "computeRatioMax": 0.08947368421052632, "endMs": "1665778807924", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "29", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778807901", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $140", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := SUM($71)" ] }, { "kind": "FILTER", "substeps": [ "greater($71, multiply(NUMERIC<...>, $70))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $140", "$70 := ROOT_AVG($80)", "$71 := ANY_VALUE($81)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.021052631578947368, "writeRatioMax": 0.021052631578947368 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04736842105263158, "computeRatioMax": 0.04736842105263158, "endMs": "1665778807950", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778807915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($60)" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07894736842105263, "writeRatioMax": 0.07894736842105263 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "105", "elapsedMs": "591", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3615" }, { "activeUnits": "1", "completedUnits": "107", "elapsedMs": "664", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3668" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24472392", "totalPartitionsProcessed": "0", "totalSlotMs": "3668", "transferredBytes": "0" }, "startTime": "1665778807320", "totalBytesProcessed": "24472392", "totalSlotMs": "3668" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb0e3f478_d59d_4cec_8cba_e88dad6c0ffd" }, "priority": "INTERACTIVE", "query": "select \n sum(ws_ext_discount_amt) as Excess_Discount_Amount \nfrom \n web_sales \n ,item \n ,date_dim\nwhere\ni_manufact_id = 350\nand i_item_sk = ws_item_sk \nand d_date between '2000-01-27' and \n (cast('2000-01-27' + 90 as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt \n > ( \n SELECT \n 1.3 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp avg(ws_ext_discount_amt) \n FROM \n web_sales \n ,date_dim\n WHERE \n ws_item_sk = i_item_sk \n and d_date between '2000-01-27' and\n (cast('2000-01-27' + 90 as date))\n and d_date_sk = ws_sold_date_sk \n ) \norder by sum(ws_ext_discount_amt)\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "oEWPwc/Td0yAuguIi1sq1A==", "id": "test-project-364309:europe-west1.query92_1665778809", "jobReference": { "jobId": "query92_1665778809", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query92_1665778809?location=europe-west1", "statistics": { "creationTime": "1665778809618", "endTime": "1665778810339", "finalExecutionDurationMs": "548", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24472392", "performanceInsights": { "avgPreviousExecutionMs": "579" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.07009345794392523, "computeRatioMax": 0.07009345794392523, "endMs": "1665778809786", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03271028037383177, "readRatioMax": 0.03271028037383177, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778809753", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07476635514018691, "writeRatioMax": 0.07476635514018691 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04672897196261682, "computeRatioMax": 0.04672897196261682, "endMs": "1665778809832", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03271028037383177, "readRatioMax": 0.03271028037383177, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778809790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_date", "FROM date_dim", "WHERE between($31, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009345794392523364, "waitRatioMax": 0.009345794392523364, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06074766355140187, "writeRatioMax": 0.06074766355140187 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04205607476635514, "computeRatioMax": 0.04205607476635514, "endMs": "1665778809849", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02336448598130841, "readRatioMax": 0.02336448598130841, "recordsRead": "18000", "recordsWritten": "25", "shuffleOutputBytes": "225", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778809808", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_manufact_id", "FROM item", "WHERE equal($41, 350)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0794392523364486, "writeRatioMax": 0.0794392523364486 }, { "completedParallelInputs": "1", "computeMsAvg": "146", "computeMsMax": "146", "computeRatioAvg": 0.6822429906542056, "computeRatioMax": 0.6822429906542056, "endMs": "1665778809967", "id": "5", "inputStages": [ "0" ], "name": "S05: Join", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0514018691588785, "readRatioMax": 0.0514018691588785, "recordsRead": "719475", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "198", "startMs": "1665778809844", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$120 := $2, $121 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.09813084112149532, "writeRatioMax": 0.09813084112149532 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.04205607476635514, "computeRatioMax": 0.10747663551401869, "endMs": "1665778810061", "id": "6", "inputStages": [ "5" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20708", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "3900", "startMs": "1665778810000", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.009345794392523364, "waitRatioMax": 0.014018691588785047, "writeMsAvg": "21", "writeMsMax": "34", "writeRatioAvg": 0.09813084112149532, "writeRatioMax": 0.1588785046728972 }, { "completedParallelInputs": "1", "computeMsAvg": "214", "computeMsMax": "214", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778810190", "id": "7", "inputStages": [ "2", "6", "3" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.06542056074766354, "readRatioMax": 0.06542056074766354, "recordsRead": "740208", "recordsWritten": "29", "shuffleOutputBytes": "1846", "shuffleOutputBytesSpilled": "0", "slotMs": "223", "startMs": "1665778810006", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $131", "$80 := SHARD_AVG($132)", "$81 := ANY_VALUE($130)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $90, $132 := $121", "LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$110 := $101, $111 := $102", "INNER HASH JOIN EACH WITH ALL ON $100 = $30" ] }, { "kind": "JOIN", "substeps": [ "$100 := $20, $101 := $22, $102 := $40", "INNER HASH JOIN EACH WITH ALL ON $21 = $40" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $140", "TO __stage07_output", "BY HASH($140)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009345794392523364, "waitRatioMax": 0.009345794392523364, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.018691588785046728, "writeRatioMax": 0.018691588785046728 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.018691588785046728, "computeRatioMax": 0.018691588785046728, "endMs": "1665778810218", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "29", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665778810209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $140", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := SUM($71)" ] }, { "kind": "FILTER", "substeps": [ "greater($71, multiply(NUMERIC<...>, $70))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $140", "$70 := ROOT_AVG($80)", "$71 := ANY_VALUE($81)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.018691588785046728, "waitRatioMax": 0.018691588785046728, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.028037383177570093, "computeRatioMax": 0.028037383177570093, "endMs": "1665778810256", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778810222", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($60)" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.12149532710280374, "writeRatioMax": 0.12149532710280374 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "106", "elapsedMs": "597", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4356" }, { "activeUnits": "1", "completedUnits": "107", "elapsedMs": "638", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4386" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24472392", "totalPartitionsProcessed": "0", "totalSlotMs": "4386", "transferredBytes": "0" }, "startTime": "1665778809658", "totalBytesProcessed": "24472392", "totalSlotMs": "4386" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond16bc537_6a68_403a_ab80_de64b815de46" }, "priority": "INTERACTIVE", "query": "select \n sum(ws_ext_discount_amt) as Excess_Discount_Amount \nfrom \n web_sales \n ,item \n ,date_dim\nwhere\ni_manufact_id = 350\nand i_item_sk = ws_item_sk \nand d_date between '2000-01-27' and \n (cast('2000-01-27' + 90 as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt \n > ( \n SELECT \n 1.3 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp avg(ws_ext_discount_amt) \n FROM \n web_sales \n ,date_dim\n WHERE \n ws_item_sk = i_item_sk \n and d_date between '2000-01-27' and\n (cast('2000-01-27' + 90 as date))\n and d_date_sk = ws_sold_date_sk \n ) \norder by sum(ws_ext_discount_amt)\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "9dG4WEIR90BpWOEoCTWL4A==", "id": "test-project-364309:europe-west1.query92_1665778811", "jobReference": { "jobId": "query92_1665778811", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query92_1665778811?location=europe-west1", "statistics": { "creationTime": "1665778812187", "endTime": "1665778812905", "finalExecutionDurationMs": "540", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24472392", "performanceInsights": { "avgPreviousExecutionMs": "576" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.059880239520958084, "computeRatioMax": 0.059880239520958084, "endMs": "1665778812346", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03592814371257485, "readRatioMax": 0.03592814371257485, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665778812317", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.07784431137724551, "writeRatioMax": 0.07784431137724551 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.07784431137724551, "computeRatioMax": 0.07784431137724551, "endMs": "1665778812377", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.05389221556886228, "readRatioMax": 0.05389221556886228, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778812348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_date", "FROM date_dim", "WHERE between($31, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05389221556886228, "writeRatioMax": 0.05389221556886228 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.07784431137724551, "computeRatioMax": 0.07784431137724551, "endMs": "1665778812402", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03592814371257485, "readRatioMax": 0.03592814371257485, "recordsRead": "18000", "recordsWritten": "25", "shuffleOutputBytes": "225", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778812367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_manufact_id", "FROM item", "WHERE equal($41, 350)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011976047904191617, "waitRatioMax": 0.011976047904191617, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.04790419161676647, "writeRatioMax": 0.04790419161676647 }, { "completedParallelInputs": "1", "computeMsAvg": "150", "computeMsMax": "150", "computeRatioAvg": 0.8982035928143712, "computeRatioMax": 0.8982035928143712, "endMs": "1665778812524", "id": "5", "inputStages": [ "0" ], "name": "S05: Join", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.08982035928143713, "readRatioMax": 0.08982035928143713, "recordsRead": "719475", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "161", "startMs": "1665778812394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$120 := $2, $121 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011976047904191617, "waitRatioMax": 0.011976047904191617, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.11377245508982035, "writeRatioMax": 0.11377245508982035 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.05389221556886228, "computeRatioMax": 0.10778443113772455, "endMs": "1665778812579", "id": "6", "inputStages": [ "5" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20708", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "3349", "startMs": "1665778812531", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.011976047904191617, "waitRatioMax": 0.017964071856287425, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.08982035928143713, "writeRatioMax": 0.11976047904191617 }, { "completedParallelInputs": "1", "computeMsAvg": "167", "computeMsMax": "167", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778812709", "id": "7", "inputStages": [ "2", "6", "3" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.11377245508982035, "readRatioMax": 0.11377245508982035, "recordsRead": "740208", "recordsWritten": "29", "shuffleOutputBytes": "1846", "shuffleOutputBytesSpilled": "0", "slotMs": "184", "startMs": "1665778812536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $131", "$80 := SHARD_AVG($132)", "$81 := ANY_VALUE($130)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $90, $132 := $121", "LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$110 := $101, $111 := $102", "INNER HASH JOIN EACH WITH ALL ON $100 = $30" ] }, { "kind": "JOIN", "substeps": [ "$100 := $20, $101 := $22, $102 := $40", "INNER HASH JOIN EACH WITH ALL ON $21 = $40" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $140", "TO __stage07_output", "BY HASH($140)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011976047904191617, "waitRatioMax": 0.011976047904191617, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.029940119760479042, "writeRatioMax": 0.029940119760479042 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.023952095808383235, "computeRatioMax": 0.023952095808383235, "endMs": "1665778812776", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "29", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "5", "startMs": "1665778812769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $140", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := SUM($71)" ] }, { "kind": "FILTER", "substeps": [ "greater($71, multiply(NUMERIC<...>, $70))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $140", "$70 := ROOT_AVG($80)", "$71 := ANY_VALUE($81)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05389221556886228, "computeRatioMax": 0.05389221556886228, "endMs": "1665778812821", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778812783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($60)" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.07784431137724551, "writeRatioMax": 0.07784431137724551 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "106", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3708" }, { "activeUnits": "1", "completedUnits": "107", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3756" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24472392", "totalPartitionsProcessed": "0", "totalSlotMs": "3756", "transferredBytes": "0" }, "startTime": "1665778812229", "totalBytesProcessed": "24472392", "totalSlotMs": "3756" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc366fd3f_0bcf_43f8_8b95_eca3f88ec37c" }, "priority": "INTERACTIVE", "query": "select \n sum(ws_ext_discount_amt) as Excess_Discount_Amount \nfrom \n web_sales \n ,item \n ,date_dim\nwhere\ni_manufact_id = 350\nand i_item_sk = ws_item_sk \nand d_date between '2000-01-27' and \n (cast('2000-01-27' + 90 as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt \n > ( \n SELECT \n 1.3 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp avg(ws_ext_discount_amt) \n FROM \n web_sales \n ,date_dim\n WHERE \n ws_item_sk = i_item_sk \n and d_date between '2000-01-27' and\n (cast('2000-01-27' + 90 as date))\n and d_date_sk = ws_sold_date_sk \n ) \norder by sum(ws_ext_discount_amt)\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Ti9xyFR/WmQuhGE37g1GtQ==", "id": "test-project-364309:europe-west1.query92_1665778813", "jobReference": { "jobId": "query92_1665778813", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query92_1665778813?location=europe-west1", "statistics": { "creationTime": "1665778814546", "endTime": "1665778815310", "finalExecutionDurationMs": "593", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24472392", "performanceInsights": { "avgPreviousExecutionMs": "572" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.1024390243902439, "computeRatioMax": 0.1024390243902439, "endMs": "1665778814712", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.06829268292682927, "readRatioMax": 0.06829268292682927, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778814675", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00975609756097561, "waitRatioMax": 0.00975609756097561, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05365853658536585, "writeRatioMax": 0.05365853658536585 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05853658536585366, "computeRatioMax": 0.05853658536585366, "endMs": "1665778814747", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01951219512195122, "readRatioMax": 0.01951219512195122, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778814705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_date", "FROM date_dim", "WHERE between($31, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004878048780487805, "waitRatioMax": 0.004878048780487805, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.08292682926829269, "writeRatioMax": 0.08292682926829269 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03902439024390244, "computeRatioMax": 0.03902439024390244, "endMs": "1665778814751", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03414634146341464, "readRatioMax": 0.03414634146341464, "recordsRead": "18000", "recordsWritten": "25", "shuffleOutputBytes": "225", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778814721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_manufact_id", "FROM item", "WHERE equal($41, 350)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004878048780487805, "waitRatioMax": 0.004878048780487805, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07804878048780488, "writeRatioMax": 0.07804878048780488 }, { "completedParallelInputs": "1", "computeMsAvg": "205", "computeMsMax": "205", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778814887", "id": "5", "inputStages": [ "0" ], "name": "S05: Join", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.06829268292682927, "readRatioMax": 0.06829268292682927, "recordsRead": "719475", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "239", "startMs": "1665778814747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$120 := $2, $121 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004878048780487805, "waitRatioMax": 0.004878048780487805, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.1024390243902439, "writeRatioMax": 0.1024390243902439 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.03902439024390244, "computeRatioMax": 0.06341463414634146, "endMs": "1665778814981", "id": "6", "inputStages": [ "5" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20708", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "3655", "startMs": "1665778814930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.014634146341463415, "waitRatioMax": 0.01951219512195122, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.07317073170731707, "writeRatioMax": 0.09268292682926829 }, { "completedParallelInputs": "1", "computeMsAvg": "204", "computeMsMax": "204", "computeRatioAvg": 0.9951219512195122, "computeRatioMax": 0.9951219512195122, "endMs": "1665778815124", "id": "7", "inputStages": [ "3", "2", "6" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.1073170731707317, "readRatioMax": 0.1073170731707317, "recordsRead": "740208", "recordsWritten": "29", "shuffleOutputBytes": "1846", "shuffleOutputBytesSpilled": "0", "slotMs": "210", "startMs": "1665778814936", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $131", "$80 := SHARD_AVG($132)", "$81 := ANY_VALUE($130)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $90, $132 := $121", "LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$110 := $101, $111 := $102", "INNER HASH JOIN EACH WITH ALL ON $100 = $30" ] }, { "kind": "JOIN", "substeps": [ "$100 := $20, $101 := $22, $102 := $40", "INNER HASH JOIN EACH WITH ALL ON $21 = $40" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $140", "TO __stage07_output", "BY HASH($140)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00975609756097561, "waitRatioMax": 0.00975609756097561, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02926829268292683, "writeRatioMax": 0.02926829268292683 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.024390243902439025, "computeRatioMax": 0.024390243902439025, "endMs": "1665778815190", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "29", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "6", "startMs": "1665778815181", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $140", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := SUM($71)" ] }, { "kind": "FILTER", "substeps": [ "greater($71, multiply(NUMERIC<...>, $70))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $140", "$70 := ROOT_AVG($80)", "$71 := ANY_VALUE($81)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004878048780487805, "waitRatioMax": 0.004878048780487805, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.004878048780487805, "writeRatioMax": 0.004878048780487805 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04390243902439024, "computeRatioMax": 0.04390243902439024, "endMs": "1665778815232", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778815194", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($60)" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004878048780487805, "waitRatioMax": 0.004878048780487805, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07317073170731707, "writeRatioMax": 0.07317073170731707 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "105", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4235" }, { "activeUnits": "0", "completedUnits": "107", "elapsedMs": "681", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4282" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24472392", "totalPartitionsProcessed": "0", "totalSlotMs": "4282", "transferredBytes": "0" }, "startTime": "1665778814587", "totalBytesProcessed": "24472392", "totalSlotMs": "4282" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9225bf98_ddd4_42d7_bb51_91c58266d8d1" }, "priority": "INTERACTIVE", "query": "select \n sum(ws_ext_discount_amt) as Excess_Discount_Amount \nfrom \n web_sales \n ,item \n ,date_dim\nwhere\ni_manufact_id = 350\nand i_item_sk = ws_item_sk \nand d_date between '2000-01-27' and \n (cast('2000-01-27' + 90 as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt \n > ( \n SELECT \n 1.3 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp avg(ws_ext_discount_amt) \n FROM \n web_sales \n ,date_dim\n WHERE \n ws_item_sk = i_item_sk \n and d_date between '2000-01-27' and\n (cast('2000-01-27' + 90 as date))\n and d_date_sk = ws_sold_date_sk \n ) \norder by sum(ws_ext_discount_amt)\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "k+5V18Gl3RGnUGotkLrs9g==", "id": "test-project-364309:europe-west1.query92_1665778816", "jobReference": { "jobId": "query92_1665778816", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query92_1665778816?location=europe-west1", "statistics": { "creationTime": "1665778816985", "endTime": "1665778817687", "finalExecutionDurationMs": "480", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24472392", "performanceInsights": { "avgPreviousExecutionMs": "574" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05472636815920398, "computeRatioMax": 0.05472636815920398, "endMs": "1665778817165", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01990049751243781, "readRatioMax": 0.01990049751243781, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778817140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06467661691542288, "writeRatioMax": 0.06467661691542288 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04477611940298507, "computeRatioMax": 0.04477611940298507, "endMs": "1665778817204", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01990049751243781, "readRatioMax": 0.01990049751243781, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778817168", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_date", "FROM date_dim", "WHERE between($31, 10983, 11073)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05472636815920398, "writeRatioMax": 0.05472636815920398 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.06467661691542288, "computeRatioMax": 0.06467661691542288, "endMs": "1665778817220", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03482587064676617, "readRatioMax": 0.03482587064676617, "recordsRead": "18000", "recordsWritten": "25", "shuffleOutputBytes": "225", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778817182", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_manufact_id", "FROM item", "WHERE equal($41, 350)" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04477611940298507, "writeRatioMax": 0.04477611940298507 }, { "completedParallelInputs": "1", "computeMsAvg": "150", "computeMsMax": "150", "computeRatioAvg": 0.746268656716418, "computeRatioMax": 0.746268656716418, "endMs": "1665778817339", "id": "5", "inputStages": [ "0" ], "name": "S05: Join", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.07462686567164178, "readRatioMax": 0.07462686567164178, "recordsRead": "719475", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "201", "startMs": "1665778817207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$120 := $2, $121 := $3", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.1044776119402985, "writeRatioMax": 0.1044776119402985 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.04477611940298507, "computeRatioMax": 0.08955223880597014, "endMs": "1665778817419", "id": "6", "inputStages": [ "5" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20708", "recordsWritten": "20708", "shuffleOutputBytes": "538392", "shuffleOutputBytesSpilled": "0", "slotMs": "3768", "startMs": "1665778817367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.014925373134328358, "waitRatioMax": 0.01990049751243781, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.07462686567164178, "writeRatioMax": 0.09950248756218906 }, { "completedParallelInputs": "1", "computeMsAvg": "201", "computeMsMax": "201", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778817500", "id": "7", "inputStages": [ "6", "3", "2" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.0845771144278607, "readRatioMax": 0.0845771144278607, "recordsRead": "740208", "recordsWritten": "29", "shuffleOutputBytes": "1846", "shuffleOutputBytesSpilled": "0", "slotMs": "189", "startMs": "1665778817371", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_ext_discount_amt", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $131", "$80 := SHARD_AVG($132)", "$81 := ANY_VALUE($130)" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $90, $132 := $121", "LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$110 := $101, $111 := $102", "INNER HASH JOIN EACH WITH ALL ON $100 = $30" ] }, { "kind": "JOIN", "substeps": [ "$100 := $20, $101 := $22, $102 := $40", "INNER HASH JOIN EACH WITH ALL ON $21 = $40" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $140", "TO __stage07_output", "BY HASH($140)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.029850746268656716, "writeRatioMax": 0.029850746268656716 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.07960199004975124, "computeRatioMax": 0.07960199004975124, "endMs": "1665778817558", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "29", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778817534", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $140", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := SUM($71)" ] }, { "kind": "FILTER", "substeps": [ "greater($71, multiply(NUMERIC<...>, $70))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $140", "$70 := ROOT_AVG($80)", "$71 := ANY_VALUE($81)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009950248756218905, "waitRatioMax": 0.009950248756218905, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.014925373134328358, "writeRatioMax": 0.014925373134328358 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03482587064676617, "computeRatioMax": 0.03482587064676617, "endMs": "1665778817584", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778817547", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "$50 := SUM($60)" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07462686567164178, "writeRatioMax": 0.07462686567164178 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "107", "elapsedMs": "580", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4346" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24472392", "totalPartitionsProcessed": "0", "totalSlotMs": "4346", "transferredBytes": "0" }, "startTime": "1665778817043", "totalBytesProcessed": "24472392", "totalSlotMs": "4346" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
