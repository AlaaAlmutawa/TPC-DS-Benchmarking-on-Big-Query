{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9c056e62_591a_4ede_a216_06294b73ff3b" }, "priority": "INTERACTIVE", "query": "select substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n and ws_item_sk = wr_item_sk\n and ws_order_number = wr_order_number\n and ws_sold_date_sk = d_date_sk and d_year = 2000\n and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n and cd2.cd_demo_sk = wr_returning_cdemo_sk\n and ca_address_sk = wr_refunded_addr_sk\n and r_reason_sk = wr_reason_sk\n and\n (\n (\n cd1.cd_marital_status = 'M'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'Advanced Degree'\n and \n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 100.00 and 150.00\n )\n or\n (\n cd1.cd_marital_status = 'S'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'College' \n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 50.00 and 100.00\n )\n or\n (\n cd1.cd_marital_status = 'W'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = '2 yr Degree'\n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 150.00 and 200.00\n )\n )\n and\n (\n (\n ca_country = 'United States'\n and\n ca_state in ('IN', 'OH', 'NJ')\n and ws_net_profit between 100 and 200 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('WI', 'CT', 'KY')\n and ws_net_profit between 150 and 300 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('LA', 'IA', 'AR')\n and ws_net_profit between 50 and 250 \n )\n )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "GKcwjL0IslbLfOV958NuTw==", "id": "test-project-364309:europe-west1.query85_1665768496", "jobReference": { "jobId": "query85_1665768496", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query85_1665768496?location=europe-west1", "statistics": { "creationTime": "1665768496824", "endTime": "1665768498226", "finalExecutionDurationMs": "1137", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "103171757", "performanceInsights": { "avgPreviousExecutionMs": "1137" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009280742459396751, "computeRatioMax": 0.009280742459396751, "endMs": "1665768497079", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00580046403712297, "readRatioMax": 0.00580046403712297, "recordsRead": "35", "recordsWritten": "35", "shuffleOutputBytes": "1068", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768497041", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:r_reason_sk, $2:r_reason_desc", "FROM reason" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.018561484918793503, "writeRatioMax": 0.018561484918793503 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013921113689095127, "computeRatioMax": 0.013921113689095127, "endMs": "1665768497100", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009280742459396751, "readRatioMax": 0.009280742459396751, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768497055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim", "WHERE equal($11, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01740139211136891, "writeRatioMax": 0.01740139211136891 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.02668213457076566, "computeRatioMax": 0.02668213457076566, "endMs": "1665768497114", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.01740139211136891, "readRatioMax": 0.01740139211136891, "recordsRead": "50000", "recordsWritten": "9548", "shuffleOutputBytes": "152768", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768497067", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state, $22:ca_country", "FROM customer_address", "WHERE and(equal($22, 'United States'), or(in($21, 'IN', 'OH', 'NJ'), in($21, 'WI', 'CT', 'KY'), in($21, 'LA', 'IA', 'AR')))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.015081206496519721, "writeRatioMax": 0.015081206496519721 }, { "completedParallelInputs": "1", "computeMsAvg": "325", "computeMsMax": "325", "computeRatioAvg": 0.37703016241299303, "computeRatioMax": 0.37703016241299303, "endMs": "1665768497342", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01160092807424594, "readRatioMax": 0.01160092807424594, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "323", "startMs": "1665768497082", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($32, 'Advanced Degree'), equal($32, 'College'), equal($32, '2 yr Degree')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01740139211136891, "writeRatioMax": 0.01740139211136891 }, { "completedParallelInputs": "1", "computeMsAvg": "320", "computeMsMax": "320", "computeRatioAvg": 0.37122969837587005, "computeRatioMax": 0.37122969837587005, "endMs": "1665768497337", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.013921113689095127, "readRatioMax": 0.013921113689095127, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "309", "startMs": "1665768497095", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cd_demo_sk, $51:cd_marital_status, $52:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($51, 'M'), equal($51, 'S'), equal($51, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.016241299303944315, "writeRatioMax": 0.016241299303944315 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.008120649651972157, "computeRatioMax": 0.008120649651972157, "endMs": "1665768497149", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004640371229698376, "readRatioMax": 0.004640371229698376, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768497108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02088167053364269, "writeRatioMax": 0.02088167053364269 }, { "completedParallelInputs": "1", "computeMsAvg": "134", "computeMsMax": "134", "computeRatioAvg": 0.1554524361948956, "computeRatioMax": 0.1554524361948956, "endMs": "1665768497279", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "43", "readMsMax": "43", "readRatioAvg": 0.04988399071925754, "readRatioMax": 0.04988399071925754, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "6111040", "shuffleOutputBytesSpilled": "0", "slotMs": "168", "startMs": "1665768497121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_item_sk, $61:wr_refunded_cdemo_sk, $62:wr_refunded_addr_sk, $63:wr_returning_cdemo_sk, $64:wr_reason_sk, $65:wr_order_number, $66:wr_fee, $67:wr_refunded_cash", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.016241299303944315, "writeRatioMax": 0.016241299303944315 }, { "completedParallelInputs": "1", "computeMsAvg": "862", "computeMsMax": "862", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768497965", "id": "10", "inputStages": [ "3", "2", "1", "0", "5", "6", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.01740139211136891, "readRatioMax": 0.01740139211136891, "recordsRead": "1788996", "recordsWritten": "6", "shuffleOutputBytes": "380", "shuffleOutputBytesSpilled": "0", "slotMs": "718", "startMs": "1665768497405", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_web_page_sk, $73:ws_order_number, $74:ws_quantity, $75:ws_sales_price, $76:ws_net_profit", "FROM web_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $223", "$100 := SHARD_AVG($222)", "$101 := SHARD_AVG($221)", "$102 := SHARD_AVG($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213, $223 := $2", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $194", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($196, 'IN', 'OH', 'NJ'), between($195, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $171, $191 := $172, $192 := $173, $193 := $174, $194 := $175, $195 := $176, $196 := $21", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $152, $172 := $153, $173 := $154, $174 := $155, $175 := $156, $176 := $158", "INNER HASH JOIN EACH WITH ALL ON $151 = $30, $159 = $31, $160 = $32" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($159, 'M'), equal($160, 'Advanced Degree'), between($157, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $51, $160 := $52", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $115, $131 := $116, $132 := $117, $133 := $118, $134 := $119, $135 := $120, $136 := $110, $137 := $112, $138 := $113, $139 := $114", "INNER HASH JOIN EACH WITH ALL ON $111 = $40" ] }, { "kind": "JOIN", "substeps": [ "$110 := $70, $111 := $72, $112 := $74, $113 := $75, $114 := $76, $115 := $61, $116 := $62, $117 := $63, $118 := $64, $119 := $66, $120 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60, $73 = $65" ] }, { "kind": "WRITE", "substeps": [ "$230, $100, $101, $102", "TO __stage0A_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.004640371229698376, "writeRatioMax": 0.004640371229698376 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010440835266821345, "computeRatioMax": 0.010440835266821345, "endMs": "1665768498099", "id": "11", "inputStages": [ "10" ], "name": "S0B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665768498087", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $100, $101, $102", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$80 ASC, $90 ASC, $91 ASC, $92 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($240, 1, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$90 := ROOT_AVG($100)", "$91 := ROOT_AVG($101)", "$92 := ROOT_AVG($102)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001160092807424594, "writeRatioMax": 0.001160092807424594 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.008120649651972157, "computeRatioMax": 0.008120649651972157, "endMs": "1665768498139", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768498103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC, $251 ASC, $252 ASC, $253 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001160092807424594, "waitRatioMax": 0.001160092807424594, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.016241299303944315, "writeRatioMax": 0.016241299303944315 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "667", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "989" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "1302", "estimatedRunnableUnits": "1", "pendingUnits": "0", "totalSlotMs": "1751" } ], "totalBytesBilled": "103809024", "totalBytesProcessed": "103171757", "totalPartitionsProcessed": "0", "totalSlotMs": "1751", "transferredBytes": "0" }, "startTime": "1665768496875", "totalBytesProcessed": "103171757", "totalSlotMs": "1751" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona5c7b996_a08a_4595_ae69_9d69d7a88a66" }, "priority": "INTERACTIVE", "query": "select substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n and ws_item_sk = wr_item_sk\n and ws_order_number = wr_order_number\n and ws_sold_date_sk = d_date_sk and d_year = 2000\n and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n and cd2.cd_demo_sk = wr_returning_cdemo_sk\n and ca_address_sk = wr_refunded_addr_sk\n and r_reason_sk = wr_reason_sk\n and\n (\n (\n cd1.cd_marital_status = 'M'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'Advanced Degree'\n and \n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 100.00 and 150.00\n )\n or\n (\n cd1.cd_marital_status = 'S'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'College' \n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 50.00 and 100.00\n )\n or\n (\n cd1.cd_marital_status = 'W'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = '2 yr Degree'\n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 150.00 and 200.00\n )\n )\n and\n (\n (\n ca_country = 'United States'\n and\n ca_state in ('IN', 'OH', 'NJ')\n and ws_net_profit between 100 and 200 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('WI', 'CT', 'KY')\n and ws_net_profit between 150 and 300 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('LA', 'IA', 'AR')\n and ws_net_profit between 50 and 250 \n )\n )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "A7xk7dmGaUZg1CK7Sii0YA==", "id": "test-project-364309:europe-west1.query85_1665778708", "jobReference": { "jobId": "query85_1665778708", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query85_1665778708?location=europe-west1", "statistics": { "creationTime": "1665778708700", "endTime": "1665778710254", "finalExecutionDurationMs": "1301", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "103171757", "performanceInsights": { "avgPreviousExecutionMs": "1137" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0048134777376654635, "computeRatioMax": 0.0048134777376654635, "endMs": "1665778708939", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0036101083032490976, "readRatioMax": 0.0036101083032490976, "recordsRead": "35", "recordsWritten": "35", "shuffleOutputBytes": "1068", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778708898", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:r_reason_sk, $2:r_reason_desc", "FROM reason" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006016847172081829, "waitRatioMax": 0.0006016847172081829, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.01022864019253911, "writeRatioMax": 0.01022864019253911 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.006618531889290012, "computeRatioMax": 0.006618531889290012, "endMs": "1665778708948", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0048134777376654635, "readRatioMax": 0.0048134777376654635, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778708912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim", "WHERE equal($11, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006016847172081829, "waitRatioMax": 0.0006016847172081829, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.007220216606498195, "writeRatioMax": 0.007220216606498195 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.00842358604091456, "computeRatioMax": 0.00842358604091456, "endMs": "1665778708972", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00421179302045728, "readRatioMax": 0.00421179302045728, "recordsRead": "50000", "recordsWritten": "9548", "shuffleOutputBytes": "152768", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778708928", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state, $22:ca_country", "FROM customer_address", "WHERE and(equal($22, 'United States'), or(in($21, 'IN', 'OH', 'NJ'), in($21, 'WI', 'CT', 'KY'), in($21, 'LA', 'IA', 'AR')))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006016847172081829, "waitRatioMax": 0.0006016847172081829, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.009626955475330927, "writeRatioMax": 0.009626955475330927 }, { "completedParallelInputs": "1", "computeMsAvg": "382", "computeMsMax": "382", "computeRatioAvg": 0.22984356197352587, "computeRatioMax": 0.22984356197352587, "endMs": "1665778709131", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0048134777376654635, "readRatioMax": 0.0048134777376654635, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "271", "startMs": "1665778708949", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($32, 'Advanced Degree'), equal($32, 'College'), equal($32, '2 yr Degree')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage03_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.0030084235860409147, "waitRatioMax": 0.0030084235860409147, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.006016847172081829, "writeRatioMax": 0.006016847172081829 }, { "completedParallelInputs": "1", "computeMsAvg": "312", "computeMsMax": "312", "computeRatioAvg": 0.18772563176895307, "computeRatioMax": 0.18772563176895307, "endMs": "1665778709192", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.011432009626955475, "readRatioMax": 0.011432009626955475, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "339", "startMs": "1665778708961", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cd_demo_sk, $51:cd_marital_status, $52:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($51, 'M'), equal($51, 'S'), equal($51, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012033694344163659, "waitRatioMax": 0.0012033694344163659, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01263537906137184, "writeRatioMax": 0.01263537906137184 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.005415162454873646, "computeRatioMax": 0.005415162454873646, "endMs": "1665778709016", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0036101083032490976, "readRatioMax": 0.0036101083032490976, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778708974", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006016847172081829, "waitRatioMax": 0.0006016847172081829, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.010830324909747292, "writeRatioMax": 0.010830324909747292 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.05896510228640193, "computeRatioMax": 0.05896510228640193, "endMs": "1665778709131", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "47", "readMsMax": "47", "readRatioAvg": 0.028279181708784597, "readRatioMax": 0.028279181708784597, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "6111040", "shuffleOutputBytesSpilled": "0", "slotMs": "167", "startMs": "1665778708988", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_item_sk, $61:wr_refunded_cdemo_sk, $62:wr_refunded_addr_sk, $63:wr_returning_cdemo_sk, $64:wr_reason_sk, $65:wr_order_number, $66:wr_fee, $67:wr_refunded_cash", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006016847172081829, "waitRatioMax": 0.0006016847172081829, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.007821901323706379, "writeRatioMax": 0.007821901323706379 }, { "completedParallelInputs": "1", "computeMsAvg": "1662", "computeMsMax": "1662", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778710102", "id": "9", "inputStages": [ "2", "1", "0", "5", "6", "3", "4" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "29", "readMsMax": "29", "readRatioAvg": 0.017448856799037304, "readRatioMax": 0.017448856799037304, "recordsRead": "1788996", "recordsWritten": "6", "shuffleOutputBytes": "380", "shuffleOutputBytesSpilled": "0", "slotMs": "1535", "startMs": "1665778709223", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_web_page_sk, $73:ws_order_number, $74:ws_quantity, $75:ws_sales_price, $76:ws_net_profit", "FROM web_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $223", "$100 := SHARD_AVG($222)", "$101 := SHARD_AVG($221)", "$102 := SHARD_AVG($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213, $223 := $2", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $194", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($196, 'IN', 'OH', 'NJ'), between($195, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $171, $191 := $172, $192 := $173, $193 := $174, $194 := $175, $195 := $176, $196 := $21", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $152, $172 := $153, $173 := $154, $174 := $155, $175 := $156, $176 := $158", "INNER HASH JOIN EACH WITH ALL ON $151 = $30, $159 = $31, $160 = $32" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($159, 'M'), equal($160, 'Advanced Degree'), between($157, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $51, $160 := $52", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $115, $131 := $116, $132 := $117, $133 := $118, $134 := $119, $135 := $120, $136 := $110, $137 := $112, $138 := $113, $139 := $114", "INNER HASH JOIN EACH WITH ALL ON $111 = $40" ] }, { "kind": "JOIN", "substeps": [ "$110 := $70, $111 := $72, $112 := $74, $113 := $75, $114 := $76, $115 := $61, $116 := $62, $117 := $63, $118 := $64, $119 := $66, $120 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60, $73 = $65" ] }, { "kind": "WRITE", "substeps": [ "$230, $100, $101, $102", "TO __stage09_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006016847172081829, "waitRatioMax": 0.0006016847172081829, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0036101083032490976, "writeRatioMax": 0.0036101083032490976 }, { "completedParallelInputs": "1", "computeMsAvg": "3", "computeMsMax": "3", "computeRatioAvg": 0.0018050541516245488, "computeRatioMax": 0.0018050541516245488, "endMs": "1665778710126", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665778710118", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $100, $101, $102", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$80 ASC, $90 ASC, $91 ASC, $92 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($240, 1, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$90 := ROOT_AVG($100)", "$91 := ROOT_AVG($101)", "$92 := ROOT_AVG($102)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006016847172081829, "waitRatioMax": 0.0006016847172081829, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0036101083032490976, "computeRatioMax": 0.0036101083032490976, "endMs": "1665778710168", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778710134", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC, $251 ASC, $252 ASC, $253 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006016847172081829, "waitRatioMax": 0.0006016847172081829, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.009025270758122744, "writeRatioMax": 0.009025270758122744 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "638", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "949" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "1438", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2526" } ], "totalBytesBilled": "103809024", "totalBytesProcessed": "103171757", "totalPartitionsProcessed": "0", "totalSlotMs": "2526", "transferredBytes": "0" }, "startTime": "1665778708762", "totalBytesProcessed": "103171757", "totalSlotMs": "2526" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond6ec98ce_cb4b_4b0f_af0d_a6328aa16b14" }, "priority": "INTERACTIVE", "query": "select substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n and ws_item_sk = wr_item_sk\n and ws_order_number = wr_order_number\n and ws_sold_date_sk = d_date_sk and d_year = 2000\n and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n and cd2.cd_demo_sk = wr_returning_cdemo_sk\n and ca_address_sk = wr_refunded_addr_sk\n and r_reason_sk = wr_reason_sk\n and\n (\n (\n cd1.cd_marital_status = 'M'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'Advanced Degree'\n and \n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 100.00 and 150.00\n )\n or\n (\n cd1.cd_marital_status = 'S'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'College' \n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 50.00 and 100.00\n )\n or\n (\n cd1.cd_marital_status = 'W'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = '2 yr Degree'\n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 150.00 and 200.00\n )\n )\n and\n (\n (\n ca_country = 'United States'\n and\n ca_state in ('IN', 'OH', 'NJ')\n and ws_net_profit between 100 and 200 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('WI', 'CT', 'KY')\n and ws_net_profit between 150 and 300 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('LA', 'IA', 'AR')\n and ws_net_profit between 50 and 250 \n )\n )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "9UyTQ+/hVm+um1uL9TDupg==", "id": "test-project-364309:europe-west1.query85_1665778712", "jobReference": { "jobId": "query85_1665778712", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query85_1665778712?location=europe-west1", "statistics": { "creationTime": "1665778712695", "endTime": "1665778714202", "finalExecutionDurationMs": "1200", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "103171757", "performanceInsights": { "avgPreviousExecutionMs": "1164" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.008658008658008658, "computeRatioMax": 0.008658008658008658, "endMs": "1665778712948", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004329004329004329, "readRatioMax": 0.004329004329004329, "recordsRead": "35", "recordsWritten": "35", "shuffleOutputBytes": "1068", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778712909", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:r_reason_sk, $2:r_reason_desc", "FROM reason" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010822510822510823, "waitRatioMax": 0.0010822510822510823, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.01948051948051948, "writeRatioMax": 0.01948051948051948 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01406926406926407, "computeRatioMax": 0.01406926406926407, "endMs": "1665778712963", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008658008658008658, "readRatioMax": 0.008658008658008658, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778712926", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim", "WHERE equal($11, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010822510822510823, "waitRatioMax": 0.0010822510822510823, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008658008658008658, "writeRatioMax": 0.008658008658008658 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.011904761904761904, "computeRatioMax": 0.011904761904761904, "endMs": "1665778712983", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006493506493506494, "readRatioMax": 0.006493506493506494, "recordsRead": "50000", "recordsWritten": "9548", "shuffleOutputBytes": "152768", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778712942", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state, $22:ca_country", "FROM customer_address", "WHERE and(equal($22, 'United States'), or(in($21, 'IN', 'OH', 'NJ'), in($21, 'WI', 'CT', 'KY'), in($21, 'LA', 'IA', 'AR')))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010822510822510823, "waitRatioMax": 0.0010822510822510823, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.016233766233766232, "writeRatioMax": 0.016233766233766232 }, { "completedParallelInputs": "1", "computeMsAvg": "476", "computeMsMax": "476", "computeRatioAvg": 0.5151515151515151, "computeRatioMax": 0.5151515151515151, "endMs": "1665778713256", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.0183982683982684, "readRatioMax": 0.0183982683982684, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "456", "startMs": "1665778712964", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($32, 'Advanced Degree'), equal($32, 'College'), equal($32, '2 yr Degree')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010822510822510823, "waitRatioMax": 0.0010822510822510823, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.012987012987012988, "writeRatioMax": 0.012987012987012988 }, { "completedParallelInputs": "1", "computeMsAvg": "383", "computeMsMax": "383", "computeRatioAvg": 0.4145021645021645, "computeRatioMax": 0.4145021645021645, "endMs": "1665778713222", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.011904761904761904, "readRatioMax": 0.011904761904761904, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "348", "startMs": "1665778712979", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cd_demo_sk, $51:cd_marital_status, $52:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($51, 'M'), equal($51, 'S'), equal($51, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010822510822510823, "waitRatioMax": 0.0010822510822510823, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.011904761904761904, "writeRatioMax": 0.011904761904761904 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.00974025974025974, "computeRatioMax": 0.00974025974025974, "endMs": "1665778713037", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006493506493506494, "readRatioMax": 0.006493506493506494, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778712994", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010822510822510823, "waitRatioMax": 0.0010822510822510823, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0183982683982684, "writeRatioMax": 0.0183982683982684 }, { "completedParallelInputs": "1", "computeMsAvg": "135", "computeMsMax": "135", "computeRatioAvg": 0.1461038961038961, "computeRatioMax": 0.1461038961038961, "endMs": "1665778713131", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.0183982683982684, "readRatioMax": 0.0183982683982684, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "6111040", "shuffleOutputBytesSpilled": "0", "slotMs": "176", "startMs": "1665778713009", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_item_sk, $61:wr_refunded_cdemo_sk, $62:wr_refunded_addr_sk, $63:wr_returning_cdemo_sk, $64:wr_reason_sk, $65:wr_order_number, $66:wr_fee, $67:wr_refunded_cash", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010822510822510823, "waitRatioMax": 0.0010822510822510823, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.012987012987012988, "writeRatioMax": 0.012987012987012988 }, { "completedParallelInputs": "1", "computeMsAvg": "924", "computeMsMax": "924", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778713930", "id": "10", "inputStages": [ "5", "1", "3", "4", "0", "6", "2" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.01948051948051948, "readRatioMax": 0.01948051948051948, "recordsRead": "1788996", "recordsWritten": "6", "shuffleOutputBytes": "380", "shuffleOutputBytesSpilled": "0", "slotMs": "853", "startMs": "1665778713309", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_web_page_sk, $73:ws_order_number, $74:ws_quantity, $75:ws_sales_price, $76:ws_net_profit", "FROM web_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $223", "$100 := SHARD_AVG($222)", "$101 := SHARD_AVG($221)", "$102 := SHARD_AVG($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213, $223 := $2", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $194", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($196, 'IN', 'OH', 'NJ'), between($195, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $171, $191 := $172, $192 := $173, $193 := $174, $194 := $175, $195 := $176, $196 := $21", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $152, $172 := $153, $173 := $154, $174 := $155, $175 := $156, $176 := $158", "INNER HASH JOIN EACH WITH ALL ON $151 = $30, $159 = $31, $160 = $32" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($159, 'M'), equal($160, 'Advanced Degree'), between($157, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $51, $160 := $52", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $115, $131 := $116, $132 := $117, $133 := $118, $134 := $119, $135 := $120, $136 := $110, $137 := $112, $138 := $113, $139 := $114", "INNER HASH JOIN EACH WITH ALL ON $111 = $40" ] }, { "kind": "JOIN", "substeps": [ "$110 := $70, $111 := $72, $112 := $74, $113 := $75, $114 := $76, $115 := $61, $116 := $62, $117 := $63, $118 := $64, $119 := $66, $120 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60, $73 = $65" ] }, { "kind": "WRITE", "substeps": [ "$230, $100, $101, $102", "TO __stage0A_output", "BY HASH($230)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021645021645021645, "waitRatioMax": 0.0021645021645021645, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.003246753246753247, "writeRatioMax": 0.003246753246753247 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.012987012987012988, "computeRatioMax": 0.012987012987012988, "endMs": "1665778714040", "id": "11", "inputStages": [ "10" ], "name": "S0B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778714020", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $100, $101, $102", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$80 ASC, $90 ASC, $91 ASC, $92 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($240, 1, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$90 := ROOT_AVG($100)", "$91 := ROOT_AVG($101)", "$92 := ROOT_AVG($102)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021645021645021645, "waitRatioMax": 0.0021645021645021645, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005411255411255411, "writeRatioMax": 0.005411255411255411 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.006493506493506494, "computeRatioMax": 0.006493506493506494, "endMs": "1665778714068", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778714036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC, $251 ASC, $252 ASC, $253 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010822510822510823, "waitRatioMax": 0.0010822510822510823, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.015151515151515152, "writeRatioMax": 0.015151515151515152 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "653", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1136" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "1361", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2044" } ], "totalBytesBilled": "103809024", "totalBytesProcessed": "103171757", "totalPartitionsProcessed": "0", "totalSlotMs": "2044", "transferredBytes": "0" }, "startTime": "1665778712758", "totalBytesProcessed": "103171757", "totalSlotMs": "2044" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc0ce5868_39f1_4c2f_94e6_0b7ee262ea9c" }, "priority": "INTERACTIVE", "query": "select substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n and ws_item_sk = wr_item_sk\n and ws_order_number = wr_order_number\n and ws_sold_date_sk = d_date_sk and d_year = 2000\n and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n and cd2.cd_demo_sk = wr_returning_cdemo_sk\n and ca_address_sk = wr_refunded_addr_sk\n and r_reason_sk = wr_reason_sk\n and\n (\n (\n cd1.cd_marital_status = 'M'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'Advanced Degree'\n and \n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 100.00 and 150.00\n )\n or\n (\n cd1.cd_marital_status = 'S'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'College' \n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 50.00 and 100.00\n )\n or\n (\n cd1.cd_marital_status = 'W'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = '2 yr Degree'\n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 150.00 and 200.00\n )\n )\n and\n (\n (\n ca_country = 'United States'\n and\n ca_state in ('IN', 'OH', 'NJ')\n and ws_net_profit between 100 and 200 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('WI', 'CT', 'KY')\n and ws_net_profit between 150 and 300 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('LA', 'IA', 'AR')\n and ws_net_profit between 50 and 250 \n )\n )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "cxDq9oxjE2gD5MkaS+OHbA==", "id": "test-project-364309:europe-west1.query85_1665778716", "jobReference": { "jobId": "query85_1665778716", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query85_1665778716?location=europe-west1", "statistics": { "creationTime": "1665778716726", "endTime": "1665778718388", "finalExecutionDurationMs": "1402", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "103171757", "performanceInsights": { "avgPreviousExecutionMs": "1169" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.005517241379310344, "computeRatioMax": 0.005517241379310344, "endMs": "1665778716970", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.002758620689655172, "readRatioMax": 0.002758620689655172, "recordsRead": "35", "recordsWritten": "35", "shuffleOutputBytes": "1068", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778716929", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:r_reason_sk, $2:r_reason_desc", "FROM reason" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000689655172413793, "waitRatioMax": 0.000689655172413793, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.011724137931034483, "writeRatioMax": 0.011724137931034483 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.006206896551724138, "computeRatioMax": 0.006206896551724138, "endMs": "1665778716989", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004137931034482759, "readRatioMax": 0.004137931034482759, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778716948", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim", "WHERE equal($11, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000689655172413793, "waitRatioMax": 0.000689655172413793, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010344827586206896, "writeRatioMax": 0.010344827586206896 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.01793103448275862, "computeRatioMax": 0.01793103448275862, "endMs": "1665778717013", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.006896551724137931, "readRatioMax": 0.006896551724137931, "recordsRead": "50000", "recordsWritten": "9548", "shuffleOutputBytes": "152768", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778716968", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state, $22:ca_country", "FROM customer_address", "WHERE and(equal($22, 'United States'), or(in($21, 'IN', 'OH', 'NJ'), in($21, 'WI', 'CT', 'KY'), in($21, 'LA', 'IA', 'AR')))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000689655172413793, "waitRatioMax": 0.000689655172413793, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006206896551724138, "writeRatioMax": 0.006206896551724138 }, { "completedParallelInputs": "1", "computeMsAvg": "319", "computeMsMax": "319", "computeRatioAvg": 0.22, "computeRatioMax": 0.22, "endMs": "1665778717209", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.006896551724137931, "readRatioMax": 0.006896551724137931, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "337", "startMs": "1665778716990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($32, 'Advanced Degree'), equal($32, 'College'), equal($32, '2 yr Degree')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage03_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.00896551724137931, "writeRatioMax": 0.00896551724137931 }, { "completedParallelInputs": "1", "computeMsAvg": "206", "computeMsMax": "206", "computeRatioAvg": 0.14206896551724138, "computeRatioMax": 0.14206896551724138, "endMs": "1665778717188", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.006206896551724138, "readRatioMax": 0.006206896551724138, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "208", "startMs": "1665778717012", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cd_demo_sk, $51:cd_marital_status, $52:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($51, 'M'), equal($51, 'S'), equal($51, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000689655172413793, "waitRatioMax": 0.000689655172413793, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.007586206896551724, "writeRatioMax": 0.007586206896551724 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.006896551724137931, "computeRatioMax": 0.006896551724137931, "endMs": "1665778717073", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.002758620689655172, "readRatioMax": 0.002758620689655172, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778717032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000689655172413793, "waitRatioMax": 0.000689655172413793, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010344827586206896, "writeRatioMax": 0.010344827586206896 }, { "completedParallelInputs": "1", "computeMsAvg": "137", "computeMsMax": "137", "computeRatioAvg": 0.09448275862068965, "computeRatioMax": 0.09448275862068965, "endMs": "1665778717185", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.009655172413793104, "readRatioMax": 0.009655172413793104, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "6111040", "shuffleOutputBytesSpilled": "0", "slotMs": "162", "startMs": "1665778717049", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_item_sk, $61:wr_refunded_cdemo_sk, $62:wr_refunded_addr_sk, $63:wr_returning_cdemo_sk, $64:wr_reason_sk, $65:wr_order_number, $66:wr_fee, $67:wr_refunded_cash", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000689655172413793, "waitRatioMax": 0.000689655172413793, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.008275862068965517, "writeRatioMax": 0.008275862068965517 }, { "completedParallelInputs": "1", "computeMsAvg": "1450", "computeMsMax": "1450", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778718114", "id": "10", "inputStages": [ "2", "1", "5", "4", "6", "0", "3" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.02482758620689655, "readRatioMax": 0.02482758620689655, "recordsRead": "1788996", "recordsWritten": "6", "shuffleOutputBytes": "380", "shuffleOutputBytesSpilled": "0", "slotMs": "1370", "startMs": "1665778717250", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_web_page_sk, $73:ws_order_number, $74:ws_quantity, $75:ws_sales_price, $76:ws_net_profit", "FROM web_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $223", "$100 := SHARD_AVG($222)", "$101 := SHARD_AVG($221)", "$102 := SHARD_AVG($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213, $223 := $2", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $194", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($196, 'IN', 'OH', 'NJ'), between($195, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $171, $191 := $172, $192 := $173, $193 := $174, $194 := $175, $195 := $176, $196 := $21", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $152, $172 := $153, $173 := $154, $174 := $155, $175 := $156, $176 := $158", "INNER HASH JOIN EACH WITH ALL ON $151 = $30, $159 = $31, $160 = $32" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($159, 'M'), equal($160, 'Advanced Degree'), between($157, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $51, $160 := $52", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $115, $131 := $116, $132 := $117, $133 := $118, $134 := $119, $135 := $120, $136 := $110, $137 := $112, $138 := $113, $139 := $114", "INNER HASH JOIN EACH WITH ALL ON $111 = $40" ] }, { "kind": "JOIN", "substeps": [ "$110 := $70, $111 := $72, $112 := $74, $113 := $75, $114 := $76, $115 := $61, $116 := $62, $117 := $63, $118 := $64, $119 := $66, $120 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60, $73 = $65" ] }, { "kind": "WRITE", "substeps": [ "$230, $100, $101, $102", "TO __stage0A_output", "BY HASH($230)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001379310344827586, "waitRatioMax": 0.001379310344827586, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.004827586206896552, "writeRatioMax": 0.004827586206896552 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.002758620689655172, "computeRatioMax": 0.002758620689655172, "endMs": "1665778718261", "id": "11", "inputStages": [ "10" ], "name": "S0B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665778718252", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $100, $101, $102", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$80 ASC, $90 ASC, $91 ASC, $92 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($240, 1, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$90 := ROOT_AVG($100)", "$91 := ROOT_AVG($101)", "$92 := ROOT_AVG($102)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0020689655172413794, "waitRatioMax": 0.0020689655172413794, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.000689655172413793, "writeRatioMax": 0.000689655172413793 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.004137931034482759, "computeRatioMax": 0.004137931034482759, "endMs": "1665778718303", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778718265", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC, $251 ASC, $252 ASC, $253 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000689655172413793, "waitRatioMax": 0.000689655172413793, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.021379310344827585, "writeRatioMax": 0.021379310344827585 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "650", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "970" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "1549", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2285" } ], "totalBytesBilled": "103809024", "totalBytesProcessed": "103171757", "totalPartitionsProcessed": "0", "totalSlotMs": "2285", "transferredBytes": "0" }, "startTime": "1665778716782", "totalBytesProcessed": "103171757", "totalSlotMs": "2285" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonffe09d01_196a_491f_8b9d_fd95d5f90fa7" }, "priority": "INTERACTIVE", "query": "select substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n and ws_item_sk = wr_item_sk\n and ws_order_number = wr_order_number\n and ws_sold_date_sk = d_date_sk and d_year = 2000\n and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n and cd2.cd_demo_sk = wr_returning_cdemo_sk\n and ca_address_sk = wr_refunded_addr_sk\n and r_reason_sk = wr_reason_sk\n and\n (\n (\n cd1.cd_marital_status = 'M'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'Advanced Degree'\n and \n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 100.00 and 150.00\n )\n or\n (\n cd1.cd_marital_status = 'S'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'College' \n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 50.00 and 100.00\n )\n or\n (\n cd1.cd_marital_status = 'W'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = '2 yr Degree'\n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 150.00 and 200.00\n )\n )\n and\n (\n (\n ca_country = 'United States'\n and\n ca_state in ('IN', 'OH', 'NJ')\n and ws_net_profit between 100 and 200 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('WI', 'CT', 'KY')\n and ws_net_profit between 150 and 300 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('LA', 'IA', 'AR')\n and ws_net_profit between 50 and 250 \n )\n )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Nzp+zoVFrrenGkurCz10xQ==", "id": "test-project-364309:europe-west1.query85_1665778720", "jobReference": { "jobId": "query85_1665778720", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query85_1665778720?location=europe-west1", "statistics": { "creationTime": "1665778720722", "endTime": "1665778722564", "finalExecutionDurationMs": "1524", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "103171757", "performanceInsights": { "avgPreviousExecutionMs": "1199" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.004891684136967156, "computeRatioMax": 0.004891684136967156, "endMs": "1665778721005", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0020964360587002098, "readRatioMax": 0.0020964360587002098, "recordsRead": "35", "recordsWritten": "35", "shuffleOutputBytes": "1068", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778720969", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:r_reason_sk, $2:r_reason_desc", "FROM reason" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006988120195667365, "waitRatioMax": 0.0006988120195667365, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010482180293501049, "writeRatioMax": 0.010482180293501049 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.005590496156533892, "computeRatioMax": 0.005590496156533892, "endMs": "1665778721019", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004891684136967156, "readRatioMax": 0.004891684136967156, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778720985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim", "WHERE equal($11, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001397624039133473, "waitRatioMax": 0.001397624039133473, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.004891684136967156, "writeRatioMax": 0.004891684136967156 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.009783368273934312, "computeRatioMax": 0.009783368273934312, "endMs": "1665778721037", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004891684136967156, "readRatioMax": 0.004891684136967156, "recordsRead": "50000", "recordsWritten": "9548", "shuffleOutputBytes": "152768", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778721000", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state, $22:ca_country", "FROM customer_address", "WHERE and(equal($22, 'United States'), or(in($21, 'IN', 'OH', 'NJ'), in($21, 'WI', 'CT', 'KY'), in($21, 'LA', 'IA', 'AR')))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001397624039133473, "waitRatioMax": 0.001397624039133473, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.013277428371767994, "writeRatioMax": 0.013277428371767994 }, { "completedParallelInputs": "1", "computeMsAvg": "388", "computeMsMax": "388", "computeRatioAvg": 0.27113906359189377, "computeRatioMax": 0.27113906359189377, "endMs": "1665778721334", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0069881201956673656, "readRatioMax": 0.0069881201956673656, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "410", "startMs": "1665778721021", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($32, 'Advanced Degree'), equal($32, 'College'), equal($32, '2 yr Degree')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage03_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.004891684136967156, "waitRatioMax": 0.004891684136967156, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010482180293501049, "writeRatioMax": 0.010482180293501049 }, { "completedParallelInputs": "1", "computeMsAvg": "309", "computeMsMax": "309", "computeRatioAvg": 0.21593291404612158, "computeRatioMax": 0.21593291404612158, "endMs": "1665778721287", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.014675052410901468, "readRatioMax": 0.014675052410901468, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "321", "startMs": "1665778721039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cd_demo_sk, $51:cd_marital_status, $52:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($51, 'M'), equal($51, 'S'), equal($51, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage04_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.004891684136967156, "waitRatioMax": 0.004891684136967156, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010482180293501049, "writeRatioMax": 0.010482180293501049 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.009084556254367574, "computeRatioMax": 0.009084556254367574, "endMs": "1665778721085", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0041928721174004195, "readRatioMax": 0.0041928721174004195, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778721051", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006988120195667365, "waitRatioMax": 0.0006988120195667365, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.012578616352201259, "writeRatioMax": 0.012578616352201259 }, { "completedParallelInputs": "1", "computeMsAvg": "229", "computeMsMax": "229", "computeRatioAvg": 0.16002795248078266, "computeRatioMax": 0.16002795248078266, "endMs": "1665778721244", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.008385744234800839, "readRatioMax": 0.008385744234800839, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "6111040", "shuffleOutputBytesSpilled": "0", "slotMs": "178", "startMs": "1665778721069", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_item_sk, $61:wr_refunded_cdemo_sk, $62:wr_refunded_addr_sk, $63:wr_returning_cdemo_sk, $64:wr_reason_sk, $65:wr_order_number, $66:wr_fee, $67:wr_refunded_cash", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001397624039133473, "waitRatioMax": 0.001397624039133473, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.008385744234800839, "writeRatioMax": 0.008385744234800839 }, { "completedParallelInputs": "1", "computeMsAvg": "1431", "computeMsMax": "1431", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778722213", "id": "10", "inputStages": [ "3", "2", "1", "0", "6", "5", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "35", "readMsMax": "35", "readRatioAvg": 0.02445842068483578, "readRatioMax": 0.02445842068483578, "recordsRead": "1788996", "recordsWritten": "6", "shuffleOutputBytes": "380", "shuffleOutputBytesSpilled": "0", "slotMs": "1505", "startMs": "1665778721355", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_web_page_sk, $73:ws_order_number, $74:ws_quantity, $75:ws_sales_price, $76:ws_net_profit", "FROM web_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $223", "$100 := SHARD_AVG($222)", "$101 := SHARD_AVG($221)", "$102 := SHARD_AVG($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213, $223 := $2", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $194", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($196, 'IN', 'OH', 'NJ'), between($195, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $171, $191 := $172, $192 := $173, $193 := $174, $194 := $175, $195 := $176, $196 := $21", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $152, $172 := $153, $173 := $154, $174 := $155, $175 := $156, $176 := $158", "INNER HASH JOIN EACH WITH ALL ON $151 = $30, $159 = $31, $160 = $32" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($159, 'M'), equal($160, 'Advanced Degree'), between($157, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $51, $160 := $52", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $115, $131 := $116, $132 := $117, $133 := $118, $134 := $119, $135 := $120, $136 := $110, $137 := $112, $138 := $113, $139 := $114", "INNER HASH JOIN EACH WITH ALL ON $111 = $40" ] }, { "kind": "JOIN", "substeps": [ "$110 := $70, $111 := $72, $112 := $74, $113 := $75, $114 := $76, $115 := $61, $116 := $62, $117 := $63, $118 := $64, $119 := $66, $120 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60, $73 = $65" ] }, { "kind": "WRITE", "substeps": [ "$230, $100, $101, $102", "TO __stage0A_output", "BY HASH($230)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001397624039133473, "waitRatioMax": 0.001397624039133473, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.005590496156533892, "writeRatioMax": 0.005590496156533892 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.004891684136967156, "computeRatioMax": 0.004891684136967156, "endMs": "1665778722404", "id": "11", "inputStages": [ "10" ], "name": "S0B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665778722392", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $100, $101, $102", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$80 ASC, $90 ASC, $91 ASC, $92 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($240, 1, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$90 := ROOT_AVG($100)", "$91 := ROOT_AVG($101)", "$92 := ROOT_AVG($102)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001397624039133473, "waitRatioMax": 0.001397624039133473, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0006988120195667365, "writeRatioMax": 0.0006988120195667365 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.011180992313067784, "computeRatioMax": 0.011180992313067784, "endMs": "1665778722449", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778722408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC, $251 ASC, $252 ASC, $253 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001397624039133473, "waitRatioMax": 0.001397624039133473, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.009084556254367574, "writeRatioMax": 0.009084556254367574 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "664", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1242" }, { "activeUnits": "0", "completedUnits": "10", "elapsedMs": "1688", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2805" } ], "totalBytesBilled": "103809024", "totalBytesProcessed": "103171757", "totalPartitionsProcessed": "0", "totalSlotMs": "2805", "transferredBytes": "0" }, "startTime": "1665778720807", "totalBytesProcessed": "103171757", "totalSlotMs": "2805" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon58c7fe4e_a2e9_4ed3_965b_8170613206b6" }, "priority": "INTERACTIVE", "query": "select substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n and ws_item_sk = wr_item_sk\n and ws_order_number = wr_order_number\n and ws_sold_date_sk = d_date_sk and d_year = 2000\n and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n and cd2.cd_demo_sk = wr_returning_cdemo_sk\n and ca_address_sk = wr_refunded_addr_sk\n and r_reason_sk = wr_reason_sk\n and\n (\n (\n cd1.cd_marital_status = 'M'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'Advanced Degree'\n and \n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 100.00 and 150.00\n )\n or\n (\n cd1.cd_marital_status = 'S'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = 'College' \n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 50.00 and 100.00\n )\n or\n (\n cd1.cd_marital_status = 'W'\n and\n cd1.cd_marital_status = cd2.cd_marital_status\n and\n cd1.cd_education_status = '2 yr Degree'\n and\n cd1.cd_education_status = cd2.cd_education_status\n and\n ws_sales_price between 150.00 and 200.00\n )\n )\n and\n (\n (\n ca_country = 'United States'\n and\n ca_state in ('IN', 'OH', 'NJ')\n and ws_net_profit between 100 and 200 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('WI', 'CT', 'KY')\n and ws_net_profit between 150 and 300 \n )\n or\n (\n ca_country = 'United States'\n and\n ca_state in ('LA', 'IA', 'AR')\n and ws_net_profit between 50 and 250 \n )\n )\ngroup by r_reason_desc\norder by substr(r_reason_desc,1,20)\n ,avg(ws_quantity)\n ,avg(wr_refunded_cash)\n ,avg(wr_fee)\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "sYF02fT5n3+pHAJwVtk6xw==", "id": "test-project-364309:europe-west1.query85_1665778724", "jobReference": { "jobId": "query85_1665778724", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query85_1665778724?location=europe-west1", "statistics": { "creationTime": "1665778724891", "endTime": "1665778726398", "finalExecutionDurationMs": "1274", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "103171757", "performanceInsights": { "avgPreviousExecutionMs": "1235" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.010816125860373648, "computeRatioMax": 0.010816125860373648, "endMs": "1665778725116", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004916420845624385, "readRatioMax": 0.004916420845624385, "recordsRead": "35", "recordsWritten": "35", "shuffleOutputBytes": "1068", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778725085", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:r_reason_sk, $2:r_reason_desc", "FROM reason" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.017699115044247787, "writeRatioMax": 0.017699115044247787 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.00688298918387414, "computeRatioMax": 0.00688298918387414, "endMs": "1665778725136", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.00983284169124877, "readRatioMax": 0.00983284169124877, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778725099", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim", "WHERE equal($11, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.00688298918387414, "writeRatioMax": 0.00688298918387414 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.014749262536873156, "computeRatioMax": 0.014749262536873156, "endMs": "1665778725142", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00688298918387414, "readRatioMax": 0.00688298918387414, "recordsRead": "50000", "recordsWritten": "9548", "shuffleOutputBytes": "152768", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778725113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state, $22:ca_country", "FROM customer_address", "WHERE and(equal($22, 'United States'), or(in($21, 'IN', 'OH', 'NJ'), in($21, 'WI', 'CT', 'KY'), in($21, 'LA', 'IA', 'AR')))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.011799410029498525, "writeRatioMax": 0.011799410029498525 }, { "completedParallelInputs": "1", "computeMsAvg": "305", "computeMsMax": "305", "computeRatioAvg": 0.2999016715830875, "computeRatioMax": 0.2999016715830875, "endMs": "1665778725370", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.00983284169124877, "readRatioMax": 0.00983284169124877, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "588", "startMs": "1665778725128", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($32, 'Advanced Degree'), equal($32, 'College'), equal($32, '2 yr Degree')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.014749262536873156, "writeRatioMax": 0.014749262536873156 }, { "completedParallelInputs": "1", "computeMsAvg": "280", "computeMsMax": "280", "computeRatioAvg": 0.2753195673549656, "computeRatioMax": 0.2753195673549656, "endMs": "1665778725339", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.011799410029498525, "readRatioMax": 0.011799410029498525, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "279", "startMs": "1665778725142", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cd_demo_sk, $51:cd_marital_status, $52:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($51, 'M'), equal($51, 'S'), equal($51, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.014749262536873156, "writeRatioMax": 0.014749262536873156 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.004916420845624385, "computeRatioMax": 0.004916420845624385, "endMs": "1665778725185", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00688298918387414, "readRatioMax": 0.00688298918387414, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778725155", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.017699115044247787, "writeRatioMax": 0.017699115044247787 }, { "completedParallelInputs": "1", "computeMsAvg": "153", "computeMsMax": "153", "computeRatioAvg": 0.1504424778761062, "computeRatioMax": 0.1504424778761062, "endMs": "1665778725352", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.01671583087512291, "readRatioMax": 0.01671583087512291, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "6111040", "shuffleOutputBytesSpilled": "0", "slotMs": "208", "startMs": "1665778725170", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_item_sk, $61:wr_refunded_cdemo_sk, $62:wr_refunded_addr_sk, $63:wr_returning_cdemo_sk, $64:wr_reason_sk, $65:wr_order_number, $66:wr_fee, $67:wr_refunded_cash", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019665683382497543, "waitRatioMax": 0.0019665683382497543, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.01671583087512291, "writeRatioMax": 0.01671583087512291 }, { "completedParallelInputs": "1", "computeMsAvg": "1017", "computeMsMax": "1017", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778726060", "id": "9", "inputStages": [ "4", "5", "6", "1", "2", "3", "0" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.03048180924287119, "readRatioMax": 0.03048180924287119, "recordsRead": "1788996", "recordsWritten": "6", "shuffleOutputBytes": "380", "shuffleOutputBytesSpilled": "0", "slotMs": "861", "startMs": "1665778725439", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_web_page_sk, $73:ws_order_number, $74:ws_quantity, $75:ws_sales_price, $76:ws_net_profit", "FROM web_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $223", "$100 := SHARD_AVG($222)", "$101 := SHARD_AVG($221)", "$102 := SHARD_AVG($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213, $223 := $2", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $194", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($196, 'IN', 'OH', 'NJ'), between($195, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $171, $191 := $172, $192 := $173, $193 := $174, $194 := $175, $195 := $176, $196 := $21", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $152, $172 := $153, $173 := $154, $174 := $155, $175 := $156, $176 := $158", "INNER HASH JOIN EACH WITH ALL ON $151 = $30, $159 = $31, $160 = $32" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($159, 'M'), equal($160, 'Advanced Degree'), between($157, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $51, $160 := $52", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $115, $131 := $116, $132 := $117, $133 := $118, $134 := $119, $135 := $120, $136 := $110, $137 := $112, $138 := $113, $139 := $114", "INNER HASH JOIN EACH WITH ALL ON $111 = $40" ] }, { "kind": "JOIN", "substeps": [ "$110 := $70, $111 := $72, $112 := $74, $113 := $75, $114 := $76, $115 := $61, $116 := $62, $117 := $63, $118 := $64, $119 := $66, $120 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60, $73 = $65" ] }, { "kind": "WRITE", "substeps": [ "$230, $100, $101, $102", "TO __stage09_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0058997050147492625, "writeRatioMax": 0.0058997050147492625 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0058997050147492625, "computeRatioMax": 0.0058997050147492625, "endMs": "1665778726252", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665778726243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $100, $101, $102", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$80 ASC, $90 ASC, $91 ASC, $92 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($240, 1, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$90 := ROOT_AVG($100)", "$91 := ROOT_AVG($101)", "$92 := ROOT_AVG($102)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.010816125860373648, "computeRatioMax": 0.010816125860373648, "endMs": "1665778726329", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "361", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778726264", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC, $251 ASC, $252 ASC, $253 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009832841691248771, "waitRatioMax": 0.0009832841691248771, "writeMsAvg": "55", "writeMsMax": "55", "writeRatioAvg": 0.05408062930186824, "writeRatioMax": 0.05408062930186824 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "640", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1284" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "1413", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2131" } ], "totalBytesBilled": "103809024", "totalBytesProcessed": "103171757", "totalPartitionsProcessed": "0", "totalSlotMs": "2131", "transferredBytes": "0" }, "startTime": "1665778724947", "totalBytesProcessed": "103171757", "totalSlotMs": "2131" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
