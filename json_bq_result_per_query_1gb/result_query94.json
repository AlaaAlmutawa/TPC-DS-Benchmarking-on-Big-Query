{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1e0f521f_21fd_436d_a04f_0088fcadf5ea" }, "priority": "INTERACTIVE", "query": "-- start query 94 in stream 0 using template query94.tpl\nselect \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and \n (cast('1999-2-01' + 60 as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n from web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n from web_returns wr1\n where ws1.ws_order_number = wr1.wr_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 94 in stream 0 using template query94.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "4viNO8fDhbXbt13xYJEsRQ==", "id": "test-project-364309:europe-west1.query94_1665768521", "jobReference": { "jobId": "query94_1665768521", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query94_1665768521?location=europe-west1", "statistics": { "creationTime": "1665768521916", "endTime": "1665768522994", "finalExecutionDurationMs": "882", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "1038" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.04411764705882353, "computeRatioMax": 0.04411764705882353, "endMs": "1665768522131", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.016042780748663103, "readRatioMax": 0.016042780748663103, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665768522069", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.013368983957219251, "writeRatioMax": 0.013368983957219251 }, { "completedParallelInputs": "1", "computeMsAvg": "248", "computeMsMax": "248", "computeRatioAvg": 0.3315508021390374, "computeRatioMax": 0.3315508021390374, "endMs": "1665768522281", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.013368983957219251, "readRatioMax": 0.013368983957219251, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "245", "startMs": "1665768522098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_warehouse_sk, $11:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00267379679144385, "waitRatioMax": 0.00267379679144385, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.026737967914438502, "writeRatioMax": 0.026737967914438502 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0106951871657754, "computeRatioMax": 0.0106951871657754, "endMs": "1665768522175", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.012032085561497326, "readRatioMax": 0.012032085561497326, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768522128", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:web_site_sk, $21:web_company_name", "FROM web_site", "WHERE equal($21, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02540106951871658, "writeRatioMax": 0.02540106951871658 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.01871657754010695, "computeRatioMax": 0.01871657754010695, "endMs": "1665768522193", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.014705882352941176, "readRatioMax": 0.014705882352941176, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768522150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.012032085561497326, "writeRatioMax": 0.012032085561497326 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.017379679144385027, "computeRatioMax": 0.017379679144385027, "endMs": "1665768522222", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009358288770053475, "readRatioMax": 0.009358288770053475, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768522167", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.03609625668449198, "writeRatioMax": 0.03609625668449198 }, { "completedParallelInputs": "1", "computeMsAvg": "748", "computeMsMax": "748", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768522790", "id": "6", "inputStages": [ "1", "3", "4", "0", "2" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "68", "readMsMax": "68", "readRatioAvg": 0.09090909090909091, "readRatioMax": 0.09090909090909091, "recordsRead": "1512193", "recordsWritten": "34", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "724", "startMs": "1665768522297", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage06_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.012032085561497326, "writeRatioMax": 0.012032085561497326 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009358288770053475, "computeRatioMax": 0.009358288770053475, "endMs": "1665768522830", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "34", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665768522816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage07_output", "BY HASH($250)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00267379679144385, "waitRatioMax": 0.00267379679144385, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0066844919786096255, "writeRatioMax": 0.0066844919786096255 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013368983957219251, "computeRatioMax": 0.013368983957219251, "endMs": "1665768522875", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768522836", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.0374331550802139, "writeRatioMax": 0.0374331550802139 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.016042780748663103, "computeRatioMax": 0.016042780748663103, "endMs": "1665768522918", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768522861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00267379679144385, "waitRatioMax": 0.00267379679144385, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.026737967914438502, "writeRatioMax": 0.026737967914438502 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "450" }, { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "981", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1269" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "1269", "transferredBytes": "0" }, "startTime": "1665768521963", "totalBytesProcessed": "54123827", "totalSlotMs": "1269" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone7e90fe9_2f04_4eb1_98f1_8a592166c380" }, "priority": "INTERACTIVE", "query": "-- start query 94 in stream 0 using template query94.tpl\nselect \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and \n (cast('1999-2-01' + 60 as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n from web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n from web_returns wr1\n where ws1.ws_order_number = wr1.wr_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 94 in stream 0 using template query94.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "GQR51CTE26OLwf7CYVsXag==", "id": "test-project-364309:europe-west1.query94_1665778832", "jobReference": { "jobId": "query94_1665778832", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query94_1665778832?location=europe-west1", "statistics": { "creationTime": "1665778832841", "endTime": "1665778833899", "finalExecutionDurationMs": "827", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "1016" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.04788732394366197, "computeRatioMax": 0.04788732394366197, "endMs": "1665778833075", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.015492957746478873, "readRatioMax": 0.015492957746478873, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778833015", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.018309859154929577, "writeRatioMax": 0.018309859154929577 }, { "completedParallelInputs": "1", "computeMsAvg": "377", "computeMsMax": "377", "computeRatioAvg": 0.5309859154929577, "computeRatioMax": 0.5309859154929577, "endMs": "1665778833265", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.014084507042253521, "readRatioMax": 0.014084507042253521, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "349", "startMs": "1665778833031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_warehouse_sk, $11:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02535211267605634, "writeRatioMax": 0.02535211267605634 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009859154929577466, "computeRatioMax": 0.009859154929577466, "endMs": "1665778833082", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007042253521126761, "readRatioMax": 0.007042253521126761, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778833046", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:web_site_sk, $21:web_company_name", "FROM web_site", "WHERE equal($21, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01971830985915493, "writeRatioMax": 0.01971830985915493 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.008450704225352112, "computeRatioMax": 0.008450704225352112, "endMs": "1665778833083", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009859154929577466, "readRatioMax": 0.009859154929577466, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778833059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.015492957746478873, "writeRatioMax": 0.015492957746478873 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.016901408450704224, "computeRatioMax": 0.016901408450704224, "endMs": "1665778833110", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008450704225352112, "readRatioMax": 0.008450704225352112, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778833073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.016901408450704224, "writeRatioMax": 0.016901408450704224 }, { "completedParallelInputs": "1", "computeMsAvg": "710", "computeMsMax": "710", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778833716", "id": "6", "inputStages": [ "2", "1", "3", "0", "4" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "27", "readMsMax": "27", "readRatioAvg": 0.038028169014084505, "readRatioMax": 0.038028169014084505, "recordsRead": "1512193", "recordsWritten": "34", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "440", "startMs": "1665778833332", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage06_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.007042253521126761, "writeRatioMax": 0.007042253521126761 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009859154929577466, "computeRatioMax": 0.009859154929577466, "endMs": "1665778833770", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "34", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665778833755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage07_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.008450704225352112, "writeRatioMax": 0.008450704225352112 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.008450704225352112, "computeRatioMax": 0.008450704225352112, "endMs": "1665778833798", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665778833774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01971830985915493, "writeRatioMax": 0.01971830985915493 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.008450704225352112, "computeRatioMax": 0.008450704225352112, "endMs": "1665778833811", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778833787", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014084507042253522, "waitRatioMax": 0.0014084507042253522, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.007042253521126761, "writeRatioMax": 0.007042253521126761 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "614", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "550" }, { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "937", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1012" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "1012", "transferredBytes": "0" }, "startTime": "1665778832903", "totalBytesProcessed": "54123827", "totalSlotMs": "1012" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon31b98a13_1326_4435_ad13_6520d772ad7b" }, "priority": "INTERACTIVE", "query": "-- start query 94 in stream 0 using template query94.tpl\nselect \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and \n (cast('1999-2-01' + 60 as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n from web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n from web_returns wr1\n where ws1.ws_order_number = wr1.wr_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 94 in stream 0 using template query94.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "b50Io4eYQ9ODqhOgy046xg==", "id": "test-project-364309:europe-west1.query94_1665778834", "jobReference": { "jobId": "query94_1665778834", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query94_1665778834?location=europe-west1", "statistics": { "creationTime": "1665778835538", "endTime": "1665778836536", "finalExecutionDurationMs": "776", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "992" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.05384615384615385, "computeRatioMax": 0.05384615384615385, "endMs": "1665778835760", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.013461538461538462, "readRatioMax": 0.013461538461538462, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778835705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019230769230769232, "waitRatioMax": 0.0019230769230769232, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.051923076923076926, "writeRatioMax": 0.051923076923076926 }, { "completedParallelInputs": "1", "computeMsAvg": "278", "computeMsMax": "278", "computeRatioAvg": 0.5346153846153846, "computeRatioMax": 0.5346153846153846, "endMs": "1665778835964", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.013461538461538462, "readRatioMax": 0.013461538461538462, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "403", "startMs": "1665778835719", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_warehouse_sk, $11:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019230769230769232, "waitRatioMax": 0.0019230769230769232, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.046153846153846156, "writeRatioMax": 0.046153846153846156 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015384615384615385, "computeRatioMax": 0.015384615384615385, "endMs": "1665778835771", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007692307692307693, "readRatioMax": 0.007692307692307693, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778835731", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:web_site_sk, $21:web_company_name", "FROM web_site", "WHERE equal($21, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019230769230769232, "waitRatioMax": 0.0019230769230769232, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.028846153846153848, "writeRatioMax": 0.028846153846153848 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015384615384615385, "computeRatioMax": 0.015384615384615385, "endMs": "1665778835784", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007692307692307693, "readRatioMax": 0.007692307692307693, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778835746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019230769230769232, "waitRatioMax": 0.0019230769230769232, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.028846153846153848, "writeRatioMax": 0.028846153846153848 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.023076923076923078, "computeRatioMax": 0.023076923076923078, "endMs": "1665778835813", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009615384615384616, "readRatioMax": 0.009615384615384616, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778835772", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.019230769230769232, "waitRatioMax": 0.019230769230769232, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.05384615384615385, "writeRatioMax": 0.05384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "520", "computeMsMax": "520", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778836309", "id": "6", "inputStages": [ "4", "1", "0", "2", "3" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "26", "readMsMax": "26", "readRatioAvg": 0.05, "readRatioMax": 0.05, "recordsRead": "1512193", "recordsWritten": "34", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "424", "startMs": "1665778835970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage06_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019230769230769232, "waitRatioMax": 0.0019230769230769232, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.009615384615384616, "writeRatioMax": 0.009615384615384616 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.013461538461538462, "computeRatioMax": 0.013461538461538462, "endMs": "1665778836399", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "34", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665778836386", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage07_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019230769230769232, "waitRatioMax": 0.0019230769230769232, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007692307692307693, "writeRatioMax": 0.007692307692307693 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.028846153846153848, "computeRatioMax": 0.028846153846153848, "endMs": "1665778836444", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778836406", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019230769230769232, "waitRatioMax": 0.0019230769230769232, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.028846153846153848, "writeRatioMax": 0.028846153846153848 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.019230769230769232, "computeRatioMax": 0.019230769230769232, "endMs": "1665778836454", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778836424", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019230769230769232, "waitRatioMax": 0.0019230769230769232, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.015384615384615385, "writeRatioMax": 0.015384615384615385 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "569" }, { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "879", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1084" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "1084", "transferredBytes": "0" }, "startTime": "1665778835603", "totalBytesProcessed": "54123827", "totalSlotMs": "1084" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonffc8c41e_e495_406c_b98f_b77c8fc5f4b5" }, "priority": "INTERACTIVE", "query": "-- start query 94 in stream 0 using template query94.tpl\nselect \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and \n (cast('1999-2-01' + 60 as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n from web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n from web_returns wr1\n where ws1.ws_order_number = wr1.wr_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 94 in stream 0 using template query94.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "mOeNWcgU62nIHqKG010+uA==", "id": "test-project-364309:europe-west1.query94_1665778837", "jobReference": { "jobId": "query94_1665778837", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query94_1665778837?location=europe-west1", "statistics": { "creationTime": "1665778838230", "endTime": "1665778839391", "finalExecutionDurationMs": "909", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "968" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.02466367713004484, "computeRatioMax": 0.02466367713004484, "endMs": "1665778838465", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006726457399103139, "readRatioMax": 0.006726457399103139, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778838431", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.016816143497757848, "writeRatioMax": 0.016816143497757848 }, { "completedParallelInputs": "1", "computeMsAvg": "230", "computeMsMax": "230", "computeRatioAvg": 0.257847533632287, "computeRatioMax": 0.257847533632287, "endMs": "1665778838640", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.01233183856502242, "readRatioMax": 0.01233183856502242, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "294", "startMs": "1665778838443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_warehouse_sk, $11:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "37", "writeMsMax": "37", "writeRatioAvg": 0.04147982062780269, "writeRatioMax": 0.04147982062780269 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.008968609865470852, "computeRatioMax": 0.008968609865470852, "endMs": "1665778838492", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005605381165919282, "readRatioMax": 0.005605381165919282, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778838459", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:web_site_sk, $21:web_company_name", "FROM web_site", "WHERE equal($21, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.023542600896860985, "writeRatioMax": 0.023542600896860985 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.014573991031390135, "computeRatioMax": 0.014573991031390135, "endMs": "1665778838510", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.013452914798206279, "readRatioMax": 0.013452914798206279, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778838479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.011210762331838564, "writeRatioMax": 0.011210762331838564 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011210762331838564, "computeRatioMax": 0.011210762331838564, "endMs": "1665778838516", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005605381165919282, "readRatioMax": 0.005605381165919282, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665778838493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.013452914798206279, "writeRatioMax": 0.013452914798206279 }, { "completedParallelInputs": "1", "computeMsAvg": "892", "computeMsMax": "892", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778839156", "id": "6", "inputStages": [ "0", "3", "2", "1", "4" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "29", "readMsMax": "29", "readRatioAvg": 0.032511210762331835, "readRatioMax": 0.032511210762331835, "recordsRead": "1512193", "recordsWritten": "34", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "605", "startMs": "1665778838654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage06_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005605381165919282, "writeRatioMax": 0.005605381165919282 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.005605381165919282, "computeRatioMax": 0.005605381165919282, "endMs": "1665778839264", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "34", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665778839253", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage07_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.004484304932735426, "writeRatioMax": 0.004484304932735426 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01233183856502242, "computeRatioMax": 0.01233183856502242, "endMs": "1665778839306", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778839270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.014573991031390135, "writeRatioMax": 0.014573991031390135 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011210762331838564, "computeRatioMax": 0.011210762331838564, "endMs": "1665778839314", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778839285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011210762331838565, "waitRatioMax": 0.0011210762331838565, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005605381165919282, "writeRatioMax": 0.005605381165919282 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "612", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "425" }, { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "1015", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1112" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "1112", "transferredBytes": "0" }, "startTime": "1665778838320", "totalBytesProcessed": "54123827", "totalSlotMs": "1112" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9bebe108_810a_42a4_8c08_04ef632cfe02" }, "priority": "INTERACTIVE", "query": "-- start query 94 in stream 0 using template query94.tpl\nselect \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and \n (cast('1999-2-01' + 60 as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n from web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n from web_returns wr1\n where ws1.ws_order_number = wr1.wr_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 94 in stream 0 using template query94.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ZrP0xu8FpopSTGgfyoqYwA==", "id": "test-project-364309:europe-west1.query94_1665778840", "jobReference": { "jobId": "query94_1665778840", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query94_1665778840?location=europe-west1", "statistics": { "creationTime": "1665778842161", "endTime": "1665778843100", "finalExecutionDurationMs": "752", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "962" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.06930693069306931, "computeRatioMax": 0.06930693069306931, "endMs": "1665778842348", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.015841584158415842, "readRatioMax": 0.015841584158415842, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778842305", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02178217821782178, "writeRatioMax": 0.02178217821782178 }, { "completedParallelInputs": "1", "computeMsAvg": "220", "computeMsMax": "220", "computeRatioAvg": 0.43564356435643564, "computeRatioMax": 0.43564356435643564, "endMs": "1665778842513", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011881188118811881, "readRatioMax": 0.011881188118811881, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "247", "startMs": "1665778842321", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_warehouse_sk, $11:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.039603960396039604, "writeRatioMax": 0.039603960396039604 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.019801980198019802, "computeRatioMax": 0.019801980198019802, "endMs": "1665778842371", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009900990099009901, "readRatioMax": 0.009900990099009901, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778842336", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:web_site_sk, $21:web_company_name", "FROM web_site", "WHERE equal($21, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01782178217821782, "writeRatioMax": 0.01782178217821782 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015841584158415842, "computeRatioMax": 0.015841584158415842, "endMs": "1665778842377", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.013861386138613862, "readRatioMax": 0.013861386138613862, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778842348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0297029702970297, "writeRatioMax": 0.0297029702970297 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.027722772277227723, "computeRatioMax": 0.027722772277227723, "endMs": "1665778842404", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.019801980198019802, "readRatioMax": 0.019801980198019802, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778842361", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01782178217821782, "writeRatioMax": 0.01782178217821782 }, { "completedParallelInputs": "1", "computeMsAvg": "505", "computeMsMax": "505", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778842877", "id": "6", "inputStages": [ "0", "2", "4", "3", "1" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.04356435643564356, "readRatioMax": 0.04356435643564356, "recordsRead": "1512193", "recordsWritten": "34", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "361", "startMs": "1665778842560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage06_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.009900990099009901, "writeRatioMax": 0.009900990099009901 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01782178217821782, "computeRatioMax": 0.01782178217821782, "endMs": "1665778842980", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "34", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665778842963", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage07_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.011881188118811881, "writeRatioMax": 0.011881188118811881 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.011881188118811881, "computeRatioMax": 0.011881188118811881, "endMs": "1665778843020", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778842983", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.0594059405940594, "writeRatioMax": 0.0594059405940594 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015841584158415842, "computeRatioMax": 0.015841584158415842, "endMs": "1665778843029", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778842999", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0019801980198019802, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.011881188118811881, "writeRatioMax": 0.011881188118811881 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "600", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "408" }, { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "843", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "857" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "857", "transferredBytes": "0" }, "startTime": "1665778842207", "totalBytesProcessed": "54123827", "totalSlotMs": "857" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4d084f14_1855_4525_bf99_dce44fa50757" }, "priority": "INTERACTIVE", "query": "-- start query 94 in stream 0 using template query94.tpl\nselect \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and \n (cast('1999-2-01' + 60 as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n from web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n from web_returns wr1\n where ws1.ws_order_number = wr1.wr_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 94 in stream 0 using template query94.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2itNAZ7q3NW0BV7GmbEuBA==", "id": "test-project-364309:europe-west1.query94_1665778844", "jobReference": { "jobId": "query94_1665778844", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query94_1665778844?location=europe-west1", "statistics": { "creationTime": "1665778844777", "endTime": "1665778845801", "finalExecutionDurationMs": "803", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "943" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.04965753424657534, "computeRatioMax": 0.04965753424657534, "endMs": "1665778844971", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0136986301369863, "readRatioMax": 0.0136986301369863, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778844935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017123287671232876, "waitRatioMax": 0.0017123287671232876, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.018835616438356163, "writeRatioMax": 0.018835616438356163 }, { "completedParallelInputs": "1", "computeMsAvg": "235", "computeMsMax": "235", "computeRatioAvg": 0.4023972602739726, "computeRatioMax": 0.4023972602739726, "endMs": "1665778845133", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.015410958904109588, "readRatioMax": 0.015410958904109588, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "225", "startMs": "1665778844947", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_warehouse_sk, $11:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017123287671232876, "waitRatioMax": 0.0017123287671232876, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.032534246575342464, "writeRatioMax": 0.032534246575342464 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.011986301369863013, "computeRatioMax": 0.011986301369863013, "endMs": "1665778844991", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008561643835616438, "readRatioMax": 0.008561643835616438, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778844963", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:web_site_sk, $21:web_company_name", "FROM web_site", "WHERE equal($21, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017123287671232876, "waitRatioMax": 0.0017123287671232876, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.02910958904109589, "writeRatioMax": 0.02910958904109589 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.018835616438356163, "computeRatioMax": 0.018835616438356163, "endMs": "1665778845022", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.017123287671232876, "readRatioMax": 0.017123287671232876, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778844978", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017123287671232876, "waitRatioMax": 0.0017123287671232876, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02054794520547945, "writeRatioMax": 0.02054794520547945 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.018835616438356163, "computeRatioMax": 0.018835616438356163, "endMs": "1665778845029", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010273972602739725, "readRatioMax": 0.010273972602739725, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778844992", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.018835616438356163, "writeRatioMax": 0.018835616438356163 }, { "completedParallelInputs": "1", "computeMsAvg": "584", "computeMsMax": "584", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778845546", "id": "6", "inputStages": [ "3", "1", "0", "2", "4" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "24", "readMsMax": "24", "readRatioAvg": 0.0410958904109589, "readRatioMax": 0.0410958904109589, "recordsRead": "1512193", "recordsWritten": "34", "shuffleOutputBytes": "704", "shuffleOutputBytesSpilled": "0", "slotMs": "567", "startMs": "1665778845141", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage06_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017123287671232876, "waitRatioMax": 0.0017123287671232876, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.008561643835616438, "writeRatioMax": 0.008561643835616438 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.018835616438356163, "computeRatioMax": 0.018835616438356163, "endMs": "1665778845636", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "34", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778845616", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage07_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017123287671232876, "waitRatioMax": 0.0017123287671232876, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.010273972602739725, "writeRatioMax": 0.010273972602739725 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02226027397260274, "computeRatioMax": 0.02226027397260274, "endMs": "1665778845687", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778845650", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017123287671232876, "waitRatioMax": 0.0017123287671232876, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.025684931506849314, "writeRatioMax": 0.025684931506849314 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.017123287671232876, "computeRatioMax": 0.017123287671232876, "endMs": "1665778845707", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778845665", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017123287671232876, "waitRatioMax": 0.0017123287671232876, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.015410958904109588, "writeRatioMax": 0.015410958904109588 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "372" }, { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "898", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1043" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "1043", "transferredBytes": "0" }, "startTime": "1665778844838", "totalBytesProcessed": "54123827", "totalSlotMs": "1043" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
