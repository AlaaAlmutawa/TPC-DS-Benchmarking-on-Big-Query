{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone7a2a079_2d93_4497_b619_898e182a3857" }, "priority": "INTERACTIVE", "query": "-- start query 27 in stream 0 using template query27.tpl\n\n/*\nFor all items sold in stores located in six states during a given year, find the \n average quantity, \n average list price, \n average list sales price, \n average coupon amount for a given \n gender, \n marital status, \n education and \n customer demographic.\n*/\n\nselect i_item_id,\n s_state, --grouping(s_state) g_state,\n avg(ss_quantity) agg1,\n avg(ss_list_price) agg2,\n avg(ss_coupon_amt) agg3,\n avg(ss_sales_price) agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n ss_item_sk = i_item_sk and\n ss_store_sk = s_store_sk and\n ss_cdemo_sk = cd_demo_sk and\n cd_gender = 'M' and\n cd_marital_status = 'S' and\n cd_education_status = 'College' and\n d_year = 2002 and\n s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')\n group by rollup (i_item_id, s_state)\n order by i_item_id\n ,s_state\n limit 100\n;\n\n-- end query 27 in stream 0 using template query27.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "nnk+2oe0YoipMRmS08fJYA==", "id": "test-project-364309:europe-west1.query27_1665768302", "jobReference": { "jobId": "query27_1665768302", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query27_1665768302?location=europe-west1", "statistics": { "creationTime": "1665768302798", "endTime": "1665768303679", "finalExecutionDurationMs": "706", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "293839384", "performanceInsights": { "avgPreviousExecutionMs": "519" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.026041666666666668, "computeRatioMax": 0.026041666666666668, "endMs": "1665768302971", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0078125, "readRatioMax": 0.0078125, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768302931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013020833333333333, "waitRatioMax": 0.0013020833333333333, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.028645833333333332, "writeRatioMax": 0.028645833333333332 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009114583333333334, "computeRatioMax": 0.009114583333333334, "endMs": "1665768302971", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006510416666666667, "readRatioMax": 0.006510416666666667, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768302944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN', 'TN', 'TN', 'TN', 'TN', 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013020833333333333, "waitRatioMax": 0.0013020833333333333, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.022135416666666668, "writeRatioMax": 0.022135416666666668 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013020833333333334, "computeRatioMax": 0.013020833333333334, "endMs": "1665768303021", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009114583333333334, "readRatioMax": 0.009114583333333334, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665768302955", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013020833333333333, "waitRatioMax": 0.0013020833333333333, "writeMsAvg": "51", "writeMsMax": "51", "writeRatioAvg": 0.06640625, "writeRatioMax": 0.06640625 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.036458333333333336, "computeRatioMax": 0.036458333333333336, "endMs": "1665768303011", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.015625, "readRatioMax": 0.015625, "recordsRead": "1920800", "recordsWritten": "27440", "shuffleOutputBytes": "246960", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665768302966", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status", "FROM customer_demographics", "WHERE and(equal($41, 'M'), equal($42, 'S'), equal($43, 'College'))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013020833333333333, "waitRatioMax": 0.0013020833333333333, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.010416666666666666, "writeRatioMax": 0.010416666666666666 }, { "completedParallelInputs": "6", "computeMsAvg": "439", "computeMsMax": "768", "computeRatioAvg": 0.5716145833333334, "computeRatioMax": 1, "endMs": "1665768303532", "id": "6", "inputStages": [ "2", "1", "0", "3" ], "name": "S06: Join+", "parallelInputs": "6", "readMsAvg": "25", "readMsMax": "50", "readRatioAvg": 0.032552083333333336, "readRatioMax": 0.06510416666666667, "recordsRead": "3155306", "recordsWritten": "13922", "shuffleOutputBytes": "1232362", "shuffleOutputBytesSpilled": "0", "slotMs": "2908", "startMs": "1665768303039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_cdemo_sk, $23:ss_store_sk, $24:ss_quantity, $25:ss_list_price, $26:ss_sales_price, $27:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $70, $171 := $71, $172 := $90", "$60 := SHARD_AVG($161)", "$61 := SHARD_AVG($162)", "$62 := SHARD_AVG($164)", "$63 := SHARD_AVG($163)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(equal(bitwise_and($100, 1), 0), NULL, $165)", "$71 := if(equal(bitwise_and($100, 2), 0), NULL, $160)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$160 := $155, $161 := $151, $162 := $152, $163 := $153, $164 := $154, $165 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $142, $152 := $143, $153 := $144, $154 := $145, $155 := $11", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "JOIN", "substeps": [ "$140 := $121, $141 := $122, $142 := $123, $143 := $124, $144 := $125, $145 := $126", "INNER HASH JOIN EACH WITH ALL ON $120 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $20, $121 := $21, $122 := $23, $123 := $24, $124 := $25, $125 := $26, $126 := $27", "INNER HASH JOIN EACH WITH ALL ON $22 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($101, 1)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "TO __stage06_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0013020833333333333, "waitRatioMax": 0.0026041666666666665, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.006510416666666667, "writeRatioMax": 0.010416666666666666 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.053385416666666664, "computeRatioMax": 0.053385416666666664, "endMs": "1665768303586", "id": "7", "inputStages": [ "6" ], "name": "S07: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13922", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768303559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172", "$50 := ROOT_AVG($60)", "$51 := ROOT_AVG($61)", "$52 := ROOT_AVG($62)", "$53 := ROOT_AVG($63)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013020833333333333, "waitRatioMax": 0.0013020833333333333, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0013020833333333333, "writeRatioMax": 0.0013020833333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013020833333333334, "computeRatioMax": 0.013020833333333334, "endMs": "1665768303610", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768303573", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$194 ASC, $195 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013020833333333333, "waitRatioMax": 0.0013020833333333333, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0078125, "writeRatioMax": 0.0078125 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "9", "elapsedMs": "587", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2458" }, { "activeUnits": "2", "completedUnits": "12", "elapsedMs": "790", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3206" } ], "totalBytesBilled": "294649856", "totalBytesProcessed": "293839384", "totalPartitionsProcessed": "0", "totalSlotMs": "3206", "transferredBytes": "0" }, "startTime": "1665768302845", "totalBytesProcessed": "293839384", "totalSlotMs": "3206" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon32a5206b_990f_433c_b118_c202c98b6822" }, "priority": "INTERACTIVE", "query": "-- start query 27 in stream 0 using template query27.tpl\n\n/*\nFor all items sold in stores located in six states during a given year, find the \n average quantity, \n average list price, \n average list sales price, \n average coupon amount for a given \n gender, \n marital status, \n education and \n customer demographic.\n*/\n\nselect i_item_id,\n s_state, --grouping(s_state) g_state,\n avg(ss_quantity) agg1,\n avg(ss_list_price) agg2,\n avg(ss_coupon_amt) agg3,\n avg(ss_sales_price) agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n ss_item_sk = i_item_sk and\n ss_store_sk = s_store_sk and\n ss_cdemo_sk = cd_demo_sk and\n cd_gender = 'M' and\n cd_marital_status = 'S' and\n cd_education_status = 'College' and\n d_year = 2002 and\n s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')\n group by rollup (i_item_id, s_state)\n order by i_item_id\n ,s_state\n limit 100\n;\n\n-- end query 27 in stream 0 using template query27.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "wRswBK8vEbSjqG4XAfVwdg==", "id": "test-project-364309:europe-west1.query27_1665777201", "jobReference": { "jobId": "query27_1665777201", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query27_1665777201?location=europe-west1", "statistics": { "creationTime": "1665777201726", "endTime": "1665777202464", "finalExecutionDurationMs": "560", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "293839384", "performanceInsights": { "avgPreviousExecutionMs": "557" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.03008849557522124, "computeRatioMax": 0.03008849557522124, "endMs": "1665777201911", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010619469026548672, "readRatioMax": 0.010619469026548672, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777201867", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017699115044247787, "waitRatioMax": 0.0017699115044247787, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.04601769911504425, "writeRatioMax": 0.04601769911504425 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.019469026548672566, "computeRatioMax": 0.019469026548672566, "endMs": "1665777201919", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010619469026548672, "readRatioMax": 0.010619469026548672, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777201883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN', 'TN', 'TN', 'TN', 'TN', 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017699115044247787, "waitRatioMax": 0.0017699115044247787, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01592920353982301, "writeRatioMax": 0.01592920353982301 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.021238938053097345, "computeRatioMax": 0.021238938053097345, "endMs": "1665777201925", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.019469026548672566, "readRatioMax": 0.019469026548672566, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777201897", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017699115044247787, "waitRatioMax": 0.0017699115044247787, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.012389380530973451, "writeRatioMax": 0.012389380530973451 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.0584070796460177, "computeRatioMax": 0.0584070796460177, "endMs": "1665777201950", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.021238938053097345, "readRatioMax": 0.021238938053097345, "recordsRead": "1920800", "recordsWritten": "27440", "shuffleOutputBytes": "246960", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777201911", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status", "FROM customer_demographics", "WHERE and(equal($41, 'M'), equal($42, 'S'), equal($43, 'College'))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017699115044247787, "waitRatioMax": 0.0017699115044247787, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01592920353982301, "writeRatioMax": 0.01592920353982301 }, { "completedParallelInputs": "6", "computeMsAvg": "461", "computeMsMax": "565", "computeRatioAvg": 0.815929203539823, "computeRatioMax": 1, "endMs": "1665777202324", "id": "5", "inputStages": [ "3", "1", "0", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "28", "readRatioAvg": 0.04070796460176991, "readRatioMax": 0.049557522123893805, "recordsRead": "3155306", "recordsWritten": "13922", "shuffleOutputBytes": "1232362", "shuffleOutputBytesSpilled": "0", "slotMs": "2361", "startMs": "1665777201960", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_cdemo_sk, $23:ss_store_sk, $24:ss_quantity, $25:ss_list_price, $26:ss_sales_price, $27:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $70, $171 := $71, $172 := $90", "$60 := SHARD_AVG($161)", "$61 := SHARD_AVG($162)", "$62 := SHARD_AVG($164)", "$63 := SHARD_AVG($163)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(equal(bitwise_and($100, 1), 0), NULL, $165)", "$71 := if(equal(bitwise_and($100, 2), 0), NULL, $160)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$160 := $155, $161 := $151, $162 := $152, $163 := $153, $164 := $154, $165 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $142, $152 := $143, $153 := $144, $154 := $145, $155 := $11", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "JOIN", "substeps": [ "$140 := $121, $141 := $122, $142 := $123, $143 := $124, $144 := $125, $145 := $126", "INNER HASH JOIN EACH WITH ALL ON $120 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $20, $121 := $21, $122 := $23, $123 := $24, $124 := $25, $125 := $26, $126 := $27", "INNER HASH JOIN EACH WITH ALL ON $22 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($101, 1)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "TO __stage05_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017699115044247787, "waitRatioMax": 0.0017699115044247787, "writeMsAvg": "7", "writeMsMax": "14", "writeRatioAvg": 0.012389380530973451, "writeRatioMax": 0.024778761061946902 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.05132743362831858, "computeRatioMax": 0.05132743362831858, "endMs": "1665777202365", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13922", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777202338", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172", "$50 := ROOT_AVG($60)", "$51 := ROOT_AVG($61)", "$52 := ROOT_AVG($62)", "$53 := ROOT_AVG($63)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017699115044247787, "waitRatioMax": 0.0017699115044247787, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0017699115044247787, "writeRatioMax": 0.0017699115044247787 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.017699115044247787, "computeRatioMax": 0.017699115044247787, "endMs": "1665777202393", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777202351", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$194 ASC, $195 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017699115044247787, "waitRatioMax": 0.0017699115044247787, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.012389380530973451, "writeRatioMax": 0.012389380530973451 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "11", "elapsedMs": "590", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2543" }, { "activeUnits": "1", "completedUnits": "12", "elapsedMs": "645", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2581" } ], "totalBytesBilled": "294649856", "totalBytesProcessed": "293839384", "totalPartitionsProcessed": "0", "totalSlotMs": "2581", "transferredBytes": "0" }, "startTime": "1665777201779", "totalBytesProcessed": "293839384", "totalSlotMs": "2581" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonef042487_4167_4f27_bd26_059e8871c901" }, "priority": "INTERACTIVE", "query": "-- start query 27 in stream 0 using template query27.tpl\n\n/*\nFor all items sold in stores located in six states during a given year, find the \n average quantity, \n average list price, \n average list sales price, \n average coupon amount for a given \n gender, \n marital status, \n education and \n customer demographic.\n*/\n\nselect i_item_id,\n s_state, --grouping(s_state) g_state,\n avg(ss_quantity) agg1,\n avg(ss_list_price) agg2,\n avg(ss_coupon_amt) agg3,\n avg(ss_sales_price) agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n ss_item_sk = i_item_sk and\n ss_store_sk = s_store_sk and\n ss_cdemo_sk = cd_demo_sk and\n cd_gender = 'M' and\n cd_marital_status = 'S' and\n cd_education_status = 'College' and\n d_year = 2002 and\n s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')\n group by rollup (i_item_id, s_state)\n order by i_item_id\n ,s_state\n limit 100\n;\n\n-- end query 27 in stream 0 using template query27.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "RXPmiV9bomB5vdsF2RjU5A==", "id": "test-project-364309:europe-west1.query27_1665777203", "jobReference": { "jobId": "query27_1665777203", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query27_1665777203?location=europe-west1", "statistics": { "creationTime": "1665777204022", "endTime": "1665777204789", "finalExecutionDurationMs": "577", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "293839384", "performanceInsights": { "avgPreviousExecutionMs": "557" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.03442340791738382, "computeRatioMax": 0.03442340791738382, "endMs": "1665777204209", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012048192771084338, "readRatioMax": 0.012048192771084338, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777204166", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017211703958691911, "waitRatioMax": 0.0017211703958691911, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.04130808950086059, "writeRatioMax": 0.04130808950086059 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0189328743545611, "computeRatioMax": 0.0189328743545611, "endMs": "1665777204207", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0068846815834767644, "readRatioMax": 0.0068846815834767644, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777204179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN', 'TN', 'TN', 'TN', 'TN', 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017211703958691911, "waitRatioMax": 0.0017211703958691911, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.025817555938037865, "writeRatioMax": 0.025817555938037865 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.025817555938037865, "computeRatioMax": 0.025817555938037865, "endMs": "1665777204236", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.013769363166953529, "readRatioMax": 0.013769363166953529, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777204194", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017211703958691911, "waitRatioMax": 0.0017211703958691911, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.022375215146299483, "writeRatioMax": 0.022375215146299483 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.06884681583476764, "computeRatioMax": 0.06884681583476764, "endMs": "1665777204246", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0189328743545611, "readRatioMax": 0.0189328743545611, "recordsRead": "1920800", "recordsWritten": "27440", "shuffleOutputBytes": "246960", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777204207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status", "FROM customer_demographics", "WHERE and(equal($41, 'M'), equal($42, 'S'), equal($43, 'College'))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.012048192771084338, "writeRatioMax": 0.012048192771084338 }, { "completedParallelInputs": "6", "computeMsAvg": "459", "computeMsMax": "581", "computeRatioAvg": 0.7900172117039587, "computeRatioMax": 1, "endMs": "1665777204654", "id": "5", "inputStages": [ "3", "1", "2", "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "41", "readRatioAvg": 0.04991394148020654, "readRatioMax": 0.07056798623063683, "recordsRead": "3155306", "recordsWritten": "13922", "shuffleOutputBytes": "1232362", "shuffleOutputBytesSpilled": "0", "slotMs": "3841", "startMs": "1665777204260", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_cdemo_sk, $23:ss_store_sk, $24:ss_quantity, $25:ss_list_price, $26:ss_sales_price, $27:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $70, $171 := $71, $172 := $90", "$60 := SHARD_AVG($161)", "$61 := SHARD_AVG($162)", "$62 := SHARD_AVG($164)", "$63 := SHARD_AVG($163)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(equal(bitwise_and($100, 1), 0), NULL, $165)", "$71 := if(equal(bitwise_and($100, 2), 0), NULL, $160)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$160 := $155, $161 := $151, $162 := $152, $163 := $153, $164 := $154, $165 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $142, $152 := $143, $153 := $144, $154 := $145, $155 := $11", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "JOIN", "substeps": [ "$140 := $121, $141 := $122, $142 := $123, $143 := $124, $144 := $125, $145 := $126", "INNER HASH JOIN EACH WITH ALL ON $120 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $20, $121 := $21, $122 := $23, $123 := $24, $124 := $25, $125 := $26, $126 := $27", "INNER HASH JOIN EACH WITH ALL ON $22 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($101, 1)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "TO __stage05_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0017211703958691911, "waitRatioMax": 0.0034423407917383822, "writeMsAvg": "6", "writeMsMax": "10", "writeRatioAvg": 0.010327022375215147, "writeRatioMax": 0.01721170395869191 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.07056798623063683, "computeRatioMax": 0.07056798623063683, "endMs": "1665777204690", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13922", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777204662", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172", "$50 := ROOT_AVG($60)", "$51 := ROOT_AVG($61)", "$52 := ROOT_AVG($62)", "$53 := ROOT_AVG($63)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017211703958691911, "waitRatioMax": 0.0017211703958691911, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0017211703958691911, "writeRatioMax": 0.0017211703958691911 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.022375215146299483, "computeRatioMax": 0.022375215146299483, "endMs": "1665777204708", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777204677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$194 ASC, $195 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017211703958691911, "waitRatioMax": 0.0017211703958691911, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.012048192771084338, "writeRatioMax": 0.012048192771084338 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "593", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3979" }, { "activeUnits": "1", "completedUnits": "12", "elapsedMs": "664", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4046" } ], "totalBytesBilled": "294649856", "totalBytesProcessed": "293839384", "totalPartitionsProcessed": "0", "totalSlotMs": "4046", "transferredBytes": "0" }, "startTime": "1665777204075", "totalBytesProcessed": "293839384", "totalSlotMs": "4046" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9757df61_70a1_4a0a_848a_9b09f927b771" }, "priority": "INTERACTIVE", "query": "-- start query 27 in stream 0 using template query27.tpl\n\n/*\nFor all items sold in stores located in six states during a given year, find the \n average quantity, \n average list price, \n average list sales price, \n average coupon amount for a given \n gender, \n marital status, \n education and \n customer demographic.\n*/\n\nselect i_item_id,\n s_state, --grouping(s_state) g_state,\n avg(ss_quantity) agg1,\n avg(ss_list_price) agg2,\n avg(ss_coupon_amt) agg3,\n avg(ss_sales_price) agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n ss_item_sk = i_item_sk and\n ss_store_sk = s_store_sk and\n ss_cdemo_sk = cd_demo_sk and\n cd_gender = 'M' and\n cd_marital_status = 'S' and\n cd_education_status = 'College' and\n d_year = 2002 and\n s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')\n group by rollup (i_item_id, s_state)\n order by i_item_id\n ,s_state\n limit 100\n;\n\n-- end query 27 in stream 0 using template query27.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "SHPeCEu5EsO3lHfF6/UKuQ==", "id": "test-project-364309:europe-west1.query27_1665777205", "jobReference": { "jobId": "query27_1665777205", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query27_1665777205?location=europe-west1", "statistics": { "creationTime": "1665777206408", "endTime": "1665777207820", "finalExecutionDurationMs": "519", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "293839384", "performanceInsights": { "avgPreviousExecutionMs": "560" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.03345070422535211, "computeRatioMax": 0.03345070422535211, "endMs": "1665777206627", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007042253521126761, "readRatioMax": 0.007042253521126761, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777206577", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017605633802816902, "waitRatioMax": 0.0017605633802816902, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.040492957746478875, "writeRatioMax": 0.040492957746478875 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.014084507042253521, "computeRatioMax": 0.014084507042253521, "endMs": "1665777206625", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008802816901408451, "readRatioMax": 0.008802816901408451, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777206594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN', 'TN', 'TN', 'TN', 'TN', 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017605633802816902, "waitRatioMax": 0.0017605633802816902, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.02992957746478873, "writeRatioMax": 0.02992957746478873 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.028169014084507043, "endMs": "1665777206644", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.017605633802816902, "readRatioMax": 0.017605633802816902, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777206612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0035211267605633804, "waitRatioMax": 0.0035211267605633804, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.017605633802816902, "writeRatioMax": 0.017605633802816902 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.04753521126760563, "computeRatioMax": 0.04753521126760563, "endMs": "1665777206662", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.01936619718309859, "readRatioMax": 0.01936619718309859, "recordsRead": "1920800", "recordsWritten": "27440", "shuffleOutputBytes": "246960", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777206626", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status", "FROM customer_demographics", "WHERE and(equal($41, 'M'), equal($42, 'S'), equal($43, 'College'))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017605633802816902, "waitRatioMax": 0.0017605633802816902, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01056338028169014, "writeRatioMax": 0.01056338028169014 }, { "completedParallelInputs": "6", "computeMsAvg": "390", "computeMsMax": "568", "computeRatioAvg": 0.6866197183098591, "computeRatioMax": 1, "endMs": "1665777206994", "id": "5", "inputStages": [ "3", "2", "0", "1" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "24", "readRatioAvg": 0.03873239436619718, "readRatioMax": 0.04225352112676056, "recordsRead": "3155306", "recordsWritten": "13922", "shuffleOutputBytes": "1232362", "shuffleOutputBytesSpilled": "0", "slotMs": "2004", "startMs": "1665777206679", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_cdemo_sk, $23:ss_store_sk, $24:ss_quantity, $25:ss_list_price, $26:ss_sales_price, $27:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $70, $171 := $71, $172 := $90", "$60 := SHARD_AVG($161)", "$61 := SHARD_AVG($162)", "$62 := SHARD_AVG($164)", "$63 := SHARD_AVG($163)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(equal(bitwise_and($100, 1), 0), NULL, $165)", "$71 := if(equal(bitwise_and($100, 2), 0), NULL, $160)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$160 := $155, $161 := $151, $162 := $152, $163 := $153, $164 := $154, $165 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $142, $152 := $143, $153 := $144, $154 := $145, $155 := $11", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "JOIN", "substeps": [ "$140 := $121, $141 := $122, $142 := $123, $143 := $124, $144 := $125, $145 := $126", "INNER HASH JOIN EACH WITH ALL ON $120 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $20, $121 := $21, $122 := $23, $123 := $24, $124 := $25, $125 := $26, $126 := $27", "INNER HASH JOIN EACH WITH ALL ON $22 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($101, 1)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "TO __stage05_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0017605633802816902, "waitRatioMax": 0.0035211267605633804, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.008802816901408451, "writeRatioMax": 0.01056338028169014 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.04753521126760563, "computeRatioMax": 0.04753521126760563, "endMs": "1665777207026", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13922", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777207002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172", "$50 := ROOT_AVG($60)", "$51 := ROOT_AVG($61)", "$52 := ROOT_AVG($62)", "$53 := ROOT_AVG($63)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017605633802816902, "waitRatioMax": 0.0017605633802816902, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0017605633802816902, "writeRatioMax": 0.0017605633802816902 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01584507042253521, "computeRatioMax": 0.01584507042253521, "endMs": "1665777207055", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777207018", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$194 ASC, $195 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017605633802816902, "waitRatioMax": 0.0017605633802816902, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.028169014084507043, "writeRatioMax": 0.028169014084507043 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "12", "elapsedMs": "618", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2204" } ], "totalBytesBilled": "294649856", "totalBytesProcessed": "293839384", "totalPartitionsProcessed": "0", "totalSlotMs": "2204", "transferredBytes": "0" }, "startTime": "1665777206472", "totalBytesProcessed": "293839384", "totalSlotMs": "2204" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon54412329_38fc_42e6_93f1_0ffdb1ea32e8" }, "priority": "INTERACTIVE", "query": "-- start query 27 in stream 0 using template query27.tpl\n\n/*\nFor all items sold in stores located in six states during a given year, find the \n average quantity, \n average list price, \n average list sales price, \n average coupon amount for a given \n gender, \n marital status, \n education and \n customer demographic.\n*/\n\nselect i_item_id,\n s_state, --grouping(s_state) g_state,\n avg(ss_quantity) agg1,\n avg(ss_list_price) agg2,\n avg(ss_coupon_amt) agg3,\n avg(ss_sales_price) agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n ss_item_sk = i_item_sk and\n ss_store_sk = s_store_sk and\n ss_cdemo_sk = cd_demo_sk and\n cd_gender = 'M' and\n cd_marital_status = 'S' and\n cd_education_status = 'College' and\n d_year = 2002 and\n s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')\n group by rollup (i_item_id, s_state)\n order by i_item_id\n ,s_state\n limit 100\n;\n\n-- end query 27 in stream 0 using template query27.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "WQ7Jg/crLEczuFnwcCIX6Q==", "id": "test-project-364309:europe-west1.query27_1665777209", "jobReference": { "jobId": "query27_1665777209", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query27_1665777209?location=europe-west1", "statistics": { "creationTime": "1665777210784", "endTime": "1665777211555", "finalExecutionDurationMs": "557", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "293839384", "performanceInsights": { "avgPreviousExecutionMs": "555" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.04059040590405904, "computeRatioMax": 0.04059040590405904, "endMs": "1665777211002", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.014760147601476014, "readRatioMax": 0.014760147601476014, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777210943", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0036900369003690036, "waitRatioMax": 0.0036900369003690036, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.04428044280442804, "writeRatioMax": 0.04428044280442804 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02214022140221402, "computeRatioMax": 0.02214022140221402, "endMs": "1665777211009", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012915129151291513, "readRatioMax": 0.012915129151291513, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777210969", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN', 'TN', 'TN', 'TN', 'TN', 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005535055350553505, "waitRatioMax": 0.005535055350553505, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01845018450184502, "writeRatioMax": 0.01845018450184502 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.02952029520295203, "computeRatioMax": 0.02952029520295203, "endMs": "1665777211015", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.023985239852398525, "readRatioMax": 0.023985239852398525, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777210983", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0036900369003690036, "waitRatioMax": 0.0036900369003690036, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.016605166051660517, "writeRatioMax": 0.016605166051660517 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.0959409594095941, "computeRatioMax": 0.0959409594095941, "endMs": "1665777211100", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "44", "readMsMax": "44", "readRatioAvg": 0.08118081180811808, "readRatioMax": 0.08118081180811808, "recordsRead": "1920800", "recordsWritten": "27440", "shuffleOutputBytes": "246960", "shuffleOutputBytesSpilled": "0", "slotMs": "103", "startMs": "1665777211001", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status", "FROM customer_demographics", "WHERE and(equal($41, 'M'), equal($42, 'S'), equal($43, 'College'))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005535055350553505, "waitRatioMax": 0.005535055350553505, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.042435424354243544, "writeRatioMax": 0.042435424354243544 }, { "completedParallelInputs": "6", "computeMsAvg": "389", "computeMsMax": "542", "computeRatioAvg": 0.7177121771217713, "computeRatioMax": 1, "endMs": "1665777211383", "id": "5", "inputStages": [ "3", "0", "1", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "27", "readRatioAvg": 0.03690036900369004, "readRatioMax": 0.04981549815498155, "recordsRead": "3155306", "recordsWritten": "13922", "shuffleOutputBytes": "1232362", "shuffleOutputBytesSpilled": "0", "slotMs": "1871", "startMs": "1665777211113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_cdemo_sk, $23:ss_store_sk, $24:ss_quantity, $25:ss_list_price, $26:ss_sales_price, $27:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $70, $171 := $71, $172 := $90", "$60 := SHARD_AVG($161)", "$61 := SHARD_AVG($162)", "$62 := SHARD_AVG($164)", "$63 := SHARD_AVG($163)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(equal(bitwise_and($100, 1), 0), NULL, $165)", "$71 := if(equal(bitwise_and($100, 2), 0), NULL, $160)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$160 := $155, $161 := $151, $162 := $152, $163 := $153, $164 := $154, $165 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $142, $152 := $143, $153 := $144, $154 := $145, $155 := $11", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "JOIN", "substeps": [ "$140 := $121, $141 := $122, $142 := $123, $143 := $124, $144 := $125, $145 := $126", "INNER HASH JOIN EACH WITH ALL ON $120 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $20, $121 := $21, $122 := $23, $123 := $24, $124 := $25, $125 := $26, $126 := $27", "INNER HASH JOIN EACH WITH ALL ON $22 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($101, 1)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "TO __stage05_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.005535055350553505, "waitRatioMax": 0.007380073800738007, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.00922509225092251, "writeRatioMax": 0.012915129151291513 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.06826568265682657, "computeRatioMax": 0.06826568265682657, "endMs": "1665777211430", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13922", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777211396", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172", "$50 := ROOT_AVG($60)", "$51 := ROOT_AVG($61)", "$52 := ROOT_AVG($62)", "$53 := ROOT_AVG($63)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195", "TO __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005535055350553505, "waitRatioMax": 0.005535055350553505, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0018450184501845018, "writeRatioMax": 0.0018450184501845018 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02214022140221402, "computeRatioMax": 0.02214022140221402, "endMs": "1665777211457", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777211417", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$194 ASC, $195 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205", "TO __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005535055350553505, "waitRatioMax": 0.005535055350553505, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.023985239852398525, "writeRatioMax": 0.023985239852398525 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "11", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2222" }, { "activeUnits": "1", "completedUnits": "12", "elapsedMs": "664", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2260" } ], "totalBytesBilled": "294649856", "totalBytesProcessed": "293839384", "totalPartitionsProcessed": "0", "totalSlotMs": "2260", "transferredBytes": "0" }, "startTime": "1665777210837", "totalBytesProcessed": "293839384", "totalSlotMs": "2260" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond5c16771_cfc0_4557_8052_e97d7d10843c" }, "priority": "INTERACTIVE", "query": "-- start query 27 in stream 0 using template query27.tpl\n\n/*\nFor all items sold in stores located in six states during a given year, find the \n average quantity, \n average list price, \n average list sales price, \n average coupon amount for a given \n gender, \n marital status, \n education and \n customer demographic.\n*/\n\nselect i_item_id,\n s_state, --grouping(s_state) g_state,\n avg(ss_quantity) agg1,\n avg(ss_list_price) agg2,\n avg(ss_coupon_amt) agg3,\n avg(ss_sales_price) agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n ss_item_sk = i_item_sk and\n ss_store_sk = s_store_sk and\n ss_cdemo_sk = cd_demo_sk and\n cd_gender = 'M' and\n cd_marital_status = 'S' and\n cd_education_status = 'College' and\n d_year = 2002 and\n s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')\n group by rollup (i_item_id, s_state)\n order by i_item_id\n ,s_state\n limit 100\n;\n\n-- end query 27 in stream 0 using template query27.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "+AzYwzxIuFg2cCSye2o8cA==", "id": "test-project-364309:europe-west1.query27_1665777213", "jobReference": { "jobId": "query27_1665777213", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query27_1665777213?location=europe-west1", "statistics": { "creationTime": "1665777213878", "endTime": "1665777214790", "finalExecutionDurationMs": "711", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "293839384", "performanceInsights": { "avgPreviousExecutionMs": "555" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.030463576158940398, "computeRatioMax": 0.030463576158940398, "endMs": "1665777214097", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.013245033112582781, "readRatioMax": 0.013245033112582781, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777214038", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013245033112582781, "waitRatioMax": 0.0013245033112582781, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.031788079470198675, "writeRatioMax": 0.031788079470198675 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.007947019867549669, "computeRatioMax": 0.007947019867549669, "endMs": "1665777214092", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.003973509933774834, "readRatioMax": 0.003973509933774834, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "192", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777214058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE in($11, 'TN', 'TN', 'TN', 'TN', 'TN', 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013245033112582781, "waitRatioMax": 0.0013245033112582781, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.018543046357615896, "writeRatioMax": 0.018543046357615896 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.018543046357615896, "computeRatioMax": 0.018543046357615896, "endMs": "1665777214112", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009271523178807948, "readRatioMax": 0.009271523178807948, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777214073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013245033112582781, "waitRatioMax": 0.0013245033112582781, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01456953642384106, "writeRatioMax": 0.01456953642384106 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.04370860927152318, "computeRatioMax": 0.04370860927152318, "endMs": "1665777214147", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.015894039735099338, "readRatioMax": 0.015894039735099338, "recordsRead": "1920800", "recordsWritten": "27440", "shuffleOutputBytes": "246960", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665777214090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status", "FROM customer_demographics", "WHERE and(equal($41, 'M'), equal($42, 'S'), equal($43, 'College'))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013245033112582781, "waitRatioMax": 0.0013245033112582781, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.03576158940397351, "writeRatioMax": 0.03576158940397351 }, { "completedParallelInputs": "6", "computeMsAvg": "502", "computeMsMax": "755", "computeRatioAvg": 0.6649006622516557, "computeRatioMax": 1, "endMs": "1665777214638", "id": "5", "inputStages": [ "1", "0", "2", "3" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "27", "readRatioAvg": 0.02913907284768212, "readRatioMax": 0.03576158940397351, "recordsRead": "3155306", "recordsWritten": "13922", "shuffleOutputBytes": "1232362", "shuffleOutputBytesSpilled": "0", "slotMs": "2677", "startMs": "1665777214159", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_cdemo_sk, $23:ss_store_sk, $24:ss_quantity, $25:ss_list_price, $26:ss_sales_price, $27:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $70, $171 := $71, $172 := $90", "$60 := SHARD_AVG($161)", "$61 := SHARD_AVG($162)", "$62 := SHARD_AVG($164)", "$63 := SHARD_AVG($163)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(equal(bitwise_and($100, 1), 0), NULL, $165)", "$71 := if(equal(bitwise_and($100, 2), 0), NULL, $160)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$160 := $155, $161 := $151, $162 := $152, $163 := $153, $164 := $154, $165 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $142, $152 := $143, $153 := $144, $154 := $145, $155 := $11", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "JOIN", "substeps": [ "$140 := $121, $141 := $122, $142 := $123, $143 := $124, $144 := $125, $145 := $126", "INNER HASH JOIN EACH WITH ALL ON $120 = $30" ] }, { "kind": "JOIN", "substeps": [ "$120 := $20, $121 := $21, $122 := $23, $123 := $24, $124 := $25, $125 := $26, $126 := $27", "INNER HASH JOIN EACH WITH ALL ON $22 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($101, 1)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "TO __stage05_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013245033112582781, "waitRatioMax": 0.0013245033112582781, "writeMsAvg": "6", "writeMsMax": "13", "writeRatioAvg": 0.007947019867549669, "writeRatioMax": 0.017218543046357615 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.05827814569536424, "computeRatioMax": 0.05827814569536424, "endMs": "1665777214684", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13922", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777214654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $170, $171, $172", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172", "$50 := ROOT_AVG($60)", "$51 := ROOT_AVG($61)", "$52 := ROOT_AVG($62)", "$53 := ROOT_AVG($63)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013245033112582781, "waitRatioMax": 0.0013245033112582781, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0013245033112582781, "writeRatioMax": 0.0013245033112582781 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.017218543046357615, "computeRatioMax": 0.017218543046357615, "endMs": "1665777214710", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8474", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777214671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$194 ASC, $195 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013245033112582781, "waitRatioMax": 0.0013245033112582781, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.009271523178807948, "writeRatioMax": 0.009271523178807948 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "9", "elapsedMs": "603", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2309" }, { "activeUnits": "2", "completedUnits": "12", "elapsedMs": "808", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2945" } ], "totalBytesBilled": "294649856", "totalBytesProcessed": "293839384", "totalPartitionsProcessed": "0", "totalSlotMs": "2945", "transferredBytes": "0" }, "startTime": "1665777213937", "totalBytesProcessed": "293839384", "totalSlotMs": "2945" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
