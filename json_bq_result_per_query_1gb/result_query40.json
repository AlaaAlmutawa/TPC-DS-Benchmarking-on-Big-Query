{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon729017dd_abc5_43db_a84a_5136cb5ad971" }, "priority": "INTERACTIVE", "query": "select \n w_state\n ,i_item_id\n ,sum(case when (cast(d_date as date) < cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n ,sum(case when (cast(d_date as date) >= cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n catalog_sales left outer join catalog_returns on\n (cs_order_number = cr_order_number \n and cs_item_sk = cr_item_sk)\n ,warehouse \n ,item\n ,date_dim\n where\n i_current_price between 0.99 and 1.49\n and i_item_sk = cs_item_sk\n and cs_warehouse_sk = w_warehouse_sk \n and cs_sold_date_sk = d_date_sk\n and d_date between (cast ('2000-03-11' - 30 as date))\n and (cast ('2000-03-11' + 30 as date)) \n group by\n w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "v1l49eAcBBofqFKb+349WQ==", "id": "test-project-364309:europe-west1.query40_1665768348", "jobReference": { "jobId": "query40_1665768348", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query40_1665768348?location=europe-west1", "statistics": { "creationTime": "1665768348578", "endTime": "1665768349434", "finalExecutionDurationMs": "627", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "75456140", "performanceInsights": { "avgPreviousExecutionMs": "645" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.030181086519114688, "computeRatioMax": 0.030181086519114688, "endMs": "1665768348795", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014084507042253521, "readRatioMax": 0.014084507042253521, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "854", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665768348754", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim", "WHERE between($2, 10997, 11057)" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002012072434607646, "waitRatioMax": 0.002012072434607646, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02012072434607646, "writeRatioMax": 0.02012072434607646 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01609657947686117, "computeRatioMax": 0.01609657947686117, "endMs": "1665768348869", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "85", "readMsMax": "85", "readRatioAvg": 0.1710261569416499, "readRatioMax": 0.1710261569416499, "recordsRead": "18000", "recordsWritten": "1104", "shuffleOutputBytes": "33120", "shuffleOutputBytesSpilled": "0", "slotMs": "116", "startMs": "1665768348770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_current_price", "FROM item", "WHERE between($22, NUMERIC<...>, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004024144869215292, "waitRatioMax": 0.004024144869215292, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.012072434607645875, "writeRatioMax": 0.012072434607645875 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.026156941649899398, "computeRatioMax": 0.026156941649899398, "endMs": "1665768348828", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.018108651911468814, "readRatioMax": 0.018108651911468814, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "80", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665768348787", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:w_warehouse_sk, $11:w_state", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002012072434607646, "waitRatioMax": 0.002012072434607646, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02414486921529175, "writeRatioMax": 0.02414486921529175 }, { "completedParallelInputs": "1", "computeMsAvg": "136", "computeMsMax": "136", "computeRatioAvg": 0.27364185110663986, "computeRatioMax": 0.27364185110663986, "endMs": "1665768348945", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.030181086519114688, "readRatioMax": 0.030181086519114688, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "4996761", "shuffleOutputBytesSpilled": "0", "slotMs": "183", "startMs": "1665768348816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.022132796780684104, "waitRatioMax": 0.022132796780684104, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.026156941649899398, "writeRatioMax": 0.026156941649899398 }, { "completedParallelInputs": "5", "computeMsAvg": "405", "computeMsMax": "497", "computeRatioAvg": 0.8148893360160966, "computeRatioMax": 1, "endMs": "1665768349279", "id": "4", "inputStages": [ "1", "3", "2", "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "20", "readMsMax": "25", "readRatioAvg": 0.04024144869215292, "readRatioMax": 0.05030181086519115, "recordsRead": "2167733", "recordsWritten": "1289", "shuffleOutputBytes": "79918", "shuffleOutputBytesSpilled": "0", "slotMs": "2365", "startMs": "1665768348957", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111", "$60 := SUM($71)", "$61 := SUM($70)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := case_no_value(greater_or_equal($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)", "$71 := case_no_value(less($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $104, $112 := $102, $113 := $103, $114 := $2", "INNER HASH JOIN EACH WITH ALL ON $101 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $92, $103 := $93, $104 := $21", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82, $92 := $83, $93 := $84, $94 := $11", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $34, $84 := $42", "LEFT OUTER HASH JOIN EACH WITH ALL ON $33 = $41, $32 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $60, $61", "TO __stage04_output", "BY HASH($120, $121)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004024144869215292, "waitRatioMax": 0.004024144869215292, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.012072434607645875, "writeRatioMax": 0.018108651911468814 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.014084507042253521, "computeRatioMax": 0.014084507042253521, "endMs": "1665768349301", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1289", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665768349289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $60, $61", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$50 := SUM($60)", "$51 := SUM($61)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143", "TO __stage05_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.012072434607645875, "waitRatioMax": 0.012072434607645875, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002012072434607646, "writeRatioMax": 0.002012072434607646 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.022132796780684104, "computeRatioMax": 0.022132796780684104, "endMs": "1665768349343", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768349303", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$140 ASC, $141 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002012072434607646, "waitRatioMax": 0.002012072434607646, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.03822937625754527, "writeRatioMax": 0.03822937625754527 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "8", "elapsedMs": "618", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2214" }, { "activeUnits": "2", "completedUnits": "11", "elapsedMs": "739", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2850" } ], "totalBytesBilled": "75497472", "totalBytesProcessed": "75456140", "totalPartitionsProcessed": "0", "totalSlotMs": "2850", "transferredBytes": "0" }, "startTime": "1665768348637", "totalBytesProcessed": "75456140", "totalSlotMs": "2850" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6f0ae1a6_93d4_4ddb_a5d1_d199e76200d4" }, "priority": "INTERACTIVE", "query": "select \n w_state\n ,i_item_id\n ,sum(case when (cast(d_date as date) < cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n ,sum(case when (cast(d_date as date) >= cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n catalog_sales left outer join catalog_returns on\n (cs_order_number = cr_order_number \n and cs_item_sk = cr_item_sk)\n ,warehouse \n ,item\n ,date_dim\n where\n i_current_price between 0.99 and 1.49\n and i_item_sk = cs_item_sk\n and cs_warehouse_sk = w_warehouse_sk \n and cs_sold_date_sk = d_date_sk\n and d_date between (cast ('2000-03-11' - 30 as date))\n and (cast ('2000-03-11' + 30 as date)) \n group by\n w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ZcRGF0fvRIVUzKDJ70KeyA==", "id": "test-project-364309:europe-west1.query40_1665777425", "jobReference": { "jobId": "query40_1665777425", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query40_1665777425?location=europe-west1", "statistics": { "creationTime": "1665777426282", "endTime": "1665777427102", "finalExecutionDurationMs": "588", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "75456140", "performanceInsights": { "avgPreviousExecutionMs": "642" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04225352112676056, "computeRatioMax": 0.04225352112676056, "endMs": "1665777426507", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01643192488262911, "readRatioMax": 0.01643192488262911, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "854", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777426463", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim", "WHERE between($2, 10997, 11057)" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03051643192488263, "writeRatioMax": 0.03051643192488263 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02112676056338028, "computeRatioMax": 0.02112676056338028, "endMs": "1665777426518", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011737089201877934, "readRatioMax": 0.011737089201877934, "recordsRead": "18000", "recordsWritten": "1104", "shuffleOutputBytes": "33120", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777426480", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_current_price", "FROM item", "WHERE between($22, NUMERIC<...>, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06103286384976526, "writeRatioMax": 0.06103286384976526 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.023474178403755867, "computeRatioMax": 0.023474178403755867, "endMs": "1665777426534", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.007042253521126761, "readRatioMax": 0.007042253521126761, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "80", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777426498", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:w_warehouse_sk, $11:w_state", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03286384976525822, "writeRatioMax": 0.03286384976525822 }, { "completedParallelInputs": "1", "computeMsAvg": "168", "computeMsMax": "168", "computeRatioAvg": 0.39436619718309857, "computeRatioMax": 0.39436619718309857, "endMs": "1665777426655", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03286384976525822, "readRatioMax": 0.03286384976525822, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "4996761", "shuffleOutputBytesSpilled": "0", "slotMs": "169", "startMs": "1665777426518", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.014084507042253521, "waitRatioMax": 0.014084507042253521, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03051643192488263, "writeRatioMax": 0.03051643192488263 }, { "completedParallelInputs": "5", "computeMsAvg": "345", "computeMsMax": "426", "computeRatioAvg": 0.8098591549295775, "computeRatioMax": 1, "endMs": "1665777426943", "id": "4", "inputStages": [ "1", "2", "3", "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "19", "readMsMax": "25", "readRatioAvg": 0.04460093896713615, "readRatioMax": 0.05868544600938967, "recordsRead": "2167733", "recordsWritten": "1289", "shuffleOutputBytes": "79918", "shuffleOutputBytesSpilled": "0", "slotMs": "1619", "startMs": "1665777426666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111", "$60 := SUM($71)", "$61 := SUM($70)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := case_no_value(greater_or_equal($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)", "$71 := case_no_value(less($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $104, $112 := $102, $113 := $103, $114 := $2", "INNER HASH JOIN EACH WITH ALL ON $101 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $92, $103 := $93, $104 := $21", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82, $92 := $83, $93 := $84, $94 := $11", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $34, $84 := $42", "LEFT OUTER HASH JOIN EACH WITH ALL ON $33 = $41, $32 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $60, $61", "TO __stage04_output", "BY HASH($120, $121)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.011737089201877934, "writeRatioMax": 0.014084507042253521 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01643192488262911, "computeRatioMax": 0.01643192488262911, "endMs": "1665777426969", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1289", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665777426957", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $60, $61", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$50 := SUM($60)", "$51 := SUM($61)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002347417840375587, "writeRatioMax": 0.002347417840375587 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04225352112676056, "computeRatioMax": 0.04225352112676056, "endMs": "1665777427016", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777426974", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$140 ASC, $141 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002347417840375587, "waitRatioMax": 0.002347417840375587, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.04460093896713615, "writeRatioMax": 0.04460093896713615 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "606", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "1904" }, { "activeUnits": "1", "completedUnits": "11", "elapsedMs": "682", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1958" } ], "totalBytesBilled": "75497472", "totalBytesProcessed": "75456140", "totalPartitionsProcessed": "0", "totalSlotMs": "1958", "transferredBytes": "0" }, "startTime": "1665777426358", "totalBytesProcessed": "75456140", "totalSlotMs": "1958" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone42a459f_7f07_46df_a542_c1012a4dc0ec" }, "priority": "INTERACTIVE", "query": "select \n w_state\n ,i_item_id\n ,sum(case when (cast(d_date as date) < cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n ,sum(case when (cast(d_date as date) >= cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n catalog_sales left outer join catalog_returns on\n (cs_order_number = cr_order_number \n and cs_item_sk = cr_item_sk)\n ,warehouse \n ,item\n ,date_dim\n where\n i_current_price between 0.99 and 1.49\n and i_item_sk = cs_item_sk\n and cs_warehouse_sk = w_warehouse_sk \n and cs_sold_date_sk = d_date_sk\n and d_date between (cast ('2000-03-11' - 30 as date))\n and (cast ('2000-03-11' + 30 as date)) \n group by\n w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Rzl86VUH0RbhO4b4V8pRcw==", "id": "test-project-364309:europe-west1.query40_1665777428", "jobReference": { "jobId": "query40_1665777428", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query40_1665777428?location=europe-west1", "statistics": { "creationTime": "1665777428952", "endTime": "1665777429812", "finalExecutionDurationMs": "643", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "75456140", "performanceInsights": { "avgPreviousExecutionMs": "634" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.04793028322440087, "computeRatioMax": 0.04793028322440087, "endMs": "1665777429158", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017429193899782137, "readRatioMax": 0.017429193899782137, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "854", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777429116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim", "WHERE between($2, 10997, 11057)" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02178649237472767, "writeRatioMax": 0.02178649237472767 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02832244008714597, "computeRatioMax": 0.02832244008714597, "endMs": "1665777429169", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013071895424836602, "readRatioMax": 0.013071895424836602, "recordsRead": "18000", "recordsWritten": "1104", "shuffleOutputBytes": "33120", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665777429132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_current_price", "FROM item", "WHERE between($22, NUMERIC<...>, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.017429193899782137, "writeRatioMax": 0.017429193899782137 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.023965141612200435, "computeRatioMax": 0.023965141612200435, "endMs": "1665777429185", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008714596949891068, "readRatioMax": 0.008714596949891068, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "80", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777429145", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:w_warehouse_sk, $11:w_state", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.034858387799564274, "writeRatioMax": 0.034858387799564274 }, { "completedParallelInputs": "1", "computeMsAvg": "224", "computeMsMax": "224", "computeRatioAvg": 0.4880174291938998, "computeRatioMax": 0.4880174291938998, "endMs": "1665777429320", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.02832244008714597, "readRatioMax": 0.02832244008714597, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "4996761", "shuffleOutputBytesSpilled": "0", "slotMs": "187", "startMs": "1665777429161", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02832244008714597, "writeRatioMax": 0.02832244008714597 }, { "completedParallelInputs": "5", "computeMsAvg": "329", "computeMsMax": "459", "computeRatioAvg": 0.7167755991285403, "computeRatioMax": 1, "endMs": "1665777429651", "id": "4", "inputStages": [ "0", "3", "2", "1" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.030501089324618737, "readRatioMax": 0.0392156862745098, "recordsRead": "2167733", "recordsWritten": "1289", "shuffleOutputBytes": "79918", "shuffleOutputBytesSpilled": "0", "slotMs": "1468", "startMs": "1665777429362", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111", "$60 := SUM($71)", "$61 := SUM($70)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := case_no_value(greater_or_equal($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)", "$71 := case_no_value(less($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $104, $112 := $102, $113 := $103, $114 := $2", "INNER HASH JOIN EACH WITH ALL ON $101 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $92, $103 := $93, $104 := $21", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82, $92 := $83, $93 := $84, $94 := $11", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $34, $84 := $42", "LEFT OUTER HASH JOIN EACH WITH ALL ON $33 = $41, $32 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $60, $61", "TO __stage04_output", "BY HASH($120, $121)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.008714596949891068, "writeRatioMax": 0.010893246187363835 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02178649237472767, "computeRatioMax": 0.02178649237472767, "endMs": "1665777429674", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1289", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665777429663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $60, $61", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$50 := SUM($60)", "$51 := SUM($61)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002178649237472767, "writeRatioMax": 0.002178649237472767 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.026143790849673203, "computeRatioMax": 0.026143790849673203, "endMs": "1665777429720", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777429679", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$140 ASC, $141 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.06753812636165578, "writeRatioMax": 0.06753812636165578 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "7", "elapsedMs": "609", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "1345" }, { "activeUnits": "4", "completedUnits": "11", "elapsedMs": "742", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1870" } ], "totalBytesBilled": "75497472", "totalBytesProcessed": "75456140", "totalPartitionsProcessed": "0", "totalSlotMs": "1870", "transferredBytes": "0" }, "startTime": "1665777429008", "totalBytesProcessed": "75456140", "totalSlotMs": "1870" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5f188b25_edfb_4f6e_89d2_6bdc780e3fec" }, "priority": "INTERACTIVE", "query": "select \n w_state\n ,i_item_id\n ,sum(case when (cast(d_date as date) < cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n ,sum(case when (cast(d_date as date) >= cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n catalog_sales left outer join catalog_returns on\n (cs_order_number = cr_order_number \n and cs_item_sk = cr_item_sk)\n ,warehouse \n ,item\n ,date_dim\n where\n i_current_price between 0.99 and 1.49\n and i_item_sk = cs_item_sk\n and cs_warehouse_sk = w_warehouse_sk \n and cs_sold_date_sk = d_date_sk\n and d_date between (cast ('2000-03-11' - 30 as date))\n and (cast ('2000-03-11' + 30 as date)) \n group by\n w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "pIgPyJfuKZZmpftqP60ncA==", "id": "test-project-364309:europe-west1.query40_1665777430", "jobReference": { "jobId": "query40_1665777430", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query40_1665777430?location=europe-west1", "statistics": { "creationTime": "1665777431435", "endTime": "1665777432338", "finalExecutionDurationMs": "668", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "75456140", "performanceInsights": { "avgPreviousExecutionMs": "635" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.036297640653357534, "computeRatioMax": 0.036297640653357534, "endMs": "1665777431642", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.019963702359346643, "readRatioMax": 0.019963702359346643, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "854", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777431601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim", "WHERE between($2, 10997, 11057)" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018148820326678765, "waitRatioMax": 0.0018148820326678765, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.02722323049001815, "writeRatioMax": 0.02722323049001815 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.025408348457350273, "computeRatioMax": 0.025408348457350273, "endMs": "1665777431659", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010889292196007259, "readRatioMax": 0.010889292196007259, "recordsRead": "18000", "recordsWritten": "1104", "shuffleOutputBytes": "33120", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777431618", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_current_price", "FROM item", "WHERE between($22, NUMERIC<...>, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018148820326678765, "waitRatioMax": 0.0018148820326678765, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.025408348457350273, "writeRatioMax": 0.025408348457350273 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.016333938294010888, "computeRatioMax": 0.016333938294010888, "endMs": "1665777431679", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010889292196007259, "readRatioMax": 0.010889292196007259, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "80", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777431636", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:w_warehouse_sk, $11:w_state", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018148820326678765, "waitRatioMax": 0.0018148820326678765, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.032667876588021776, "writeRatioMax": 0.032667876588021776 }, { "completedParallelInputs": "1", "computeMsAvg": "174", "computeMsMax": "174", "computeRatioAvg": 0.3157894736842105, "computeRatioMax": 0.3157894736842105, "endMs": "1665777431825", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.018148820326678767, "readRatioMax": 0.018148820326678767, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "4996761", "shuffleOutputBytesSpilled": "0", "slotMs": "216", "startMs": "1665777431651", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018148820326678765, "waitRatioMax": 0.0018148820326678765, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.025408348457350273, "writeRatioMax": 0.025408348457350273 }, { "completedParallelInputs": "5", "computeMsAvg": "418", "computeMsMax": "551", "computeRatioAvg": 0.7586206896551724, "computeRatioMax": 1, "endMs": "1665777432162", "id": "4", "inputStages": [ "3", "0", "2", "1" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.029038112522686024, "readRatioMax": 0.034482758620689655, "recordsRead": "2167733", "recordsWritten": "1289", "shuffleOutputBytes": "79918", "shuffleOutputBytesSpilled": "0", "slotMs": "1739", "startMs": "1665777431850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111", "$60 := SUM($71)", "$61 := SUM($70)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := case_no_value(greater_or_equal($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)", "$71 := case_no_value(less($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $104, $112 := $102, $113 := $103, $114 := $2", "INNER HASH JOIN EACH WITH ALL ON $101 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $92, $103 := $93, $104 := $21", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82, $92 := $83, $93 := $84, $94 := $11", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $34, $84 := $42", "LEFT OUTER HASH JOIN EACH WITH ALL ON $33 = $41, $32 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $60, $61", "TO __stage04_output", "BY HASH($120, $121)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0018148820326678765, "waitRatioMax": 0.003629764065335753, "writeMsAvg": "11", "writeMsMax": "34", "writeRatioAvg": 0.019963702359346643, "writeRatioMax": 0.06170598911070781 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.014519056261343012, "computeRatioMax": 0.014519056261343012, "endMs": "1665777432183", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1289", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665777432170", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $60, $61", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$50 := SUM($60)", "$51 := SUM($61)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018148820326678765, "waitRatioMax": 0.0018148820326678765, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0018148820326678765, "writeRatioMax": 0.0018148820326678765 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.032667876588021776, "computeRatioMax": 0.032667876588021776, "endMs": "1665777432230", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777432190", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$140 ASC, $141 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018148820326678765, "waitRatioMax": 0.0018148820326678765, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.047186932849364795, "writeRatioMax": 0.047186932849364795 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "7", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "1528" }, { "activeUnits": "4", "completedUnits": "11", "elapsedMs": "771", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2142" } ], "totalBytesBilled": "75497472", "totalBytesProcessed": "75456140", "totalPartitionsProcessed": "0", "totalSlotMs": "2142", "transferredBytes": "0" }, "startTime": "1665777431495", "totalBytesProcessed": "75456140", "totalSlotMs": "2142" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5cfd5d48_afc7_4095_8c2c_fe36763afc54" }, "priority": "INTERACTIVE", "query": "select \n w_state\n ,i_item_id\n ,sum(case when (cast(d_date as date) < cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n ,sum(case when (cast(d_date as date) >= cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n catalog_sales left outer join catalog_returns on\n (cs_order_number = cr_order_number \n and cs_item_sk = cr_item_sk)\n ,warehouse \n ,item\n ,date_dim\n where\n i_current_price between 0.99 and 1.49\n and i_item_sk = cs_item_sk\n and cs_warehouse_sk = w_warehouse_sk \n and cs_sold_date_sk = d_date_sk\n and d_date between (cast ('2000-03-11' - 30 as date))\n and (cast ('2000-03-11' + 30 as date)) \n group by\n w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "D/Kpu1ax8ocMdBAFCGyivw==", "id": "test-project-364309:europe-west1.query40_1665777433", "jobReference": { "jobId": "query40_1665777433", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query40_1665777433?location=europe-west1", "statistics": { "creationTime": "1665777433986", "endTime": "1665777434691", "finalExecutionDurationMs": "495", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "75456140", "performanceInsights": { "avgPreviousExecutionMs": "639" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02493765586034913, "computeRatioMax": 0.02493765586034913, "endMs": "1665777434172", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.012468827930174564, "readRatioMax": 0.012468827930174564, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "854", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777434140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim", "WHERE between($2, 10997, 11057)" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.0024937655860349127, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.014962593516209476, "writeRatioMax": 0.014962593516209476 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02493765586034913, "computeRatioMax": 0.02493765586034913, "endMs": "1665777434183", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017456359102244388, "readRatioMax": 0.017456359102244388, "recordsRead": "18000", "recordsWritten": "1104", "shuffleOutputBytes": "33120", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777434152", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_current_price", "FROM item", "WHERE between($22, NUMERIC<...>, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.0024937655860349127, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03740648379052369, "writeRatioMax": 0.03740648379052369 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.022443890274314215, "computeRatioMax": 0.022443890274314215, "endMs": "1665777434192", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.00997506234413965, "readRatioMax": 0.00997506234413965, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "80", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777434166", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:w_warehouse_sk, $11:w_state", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.0024937655860349127, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0399002493765586, "writeRatioMax": 0.0399002493765586 }, { "completedParallelInputs": "1", "computeMsAvg": "102", "computeMsMax": "102", "computeRatioAvg": 0.2543640897755611, "computeRatioMax": 0.2543640897755611, "endMs": "1665777434276", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0199501246882793, "readRatioMax": 0.0199501246882793, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "4996761", "shuffleOutputBytesSpilled": "0", "slotMs": "115", "startMs": "1665777434177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.0024937655860349127, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.022443890274314215, "writeRatioMax": 0.022443890274314215 }, { "completedParallelInputs": "5", "computeMsAvg": "326", "computeMsMax": "401", "computeRatioAvg": 0.8129675810473815, "computeRatioMax": 1, "endMs": "1665777434539", "id": "4", "inputStages": [ "0", "1", "2", "3" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.034912718204488775, "readRatioMax": 0.04239401496259352, "recordsRead": "2167733", "recordsWritten": "1289", "shuffleOutputBytes": "79918", "shuffleOutputBytesSpilled": "0", "slotMs": "1491", "startMs": "1665777434294", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111", "$60 := SUM($71)", "$61 := SUM($70)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := case_no_value(greater_or_equal($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)", "$71 := case_no_value(less($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $104, $112 := $102, $113 := $103, $114 := $2", "INNER HASH JOIN EACH WITH ALL ON $101 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $92, $103 := $93, $104 := $21", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82, $92 := $83, $93 := $84, $94 := $11", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $34, $84 := $42", "LEFT OUTER HASH JOIN EACH WITH ALL ON $33 = $41, $32 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $60, $61", "TO __stage04_output", "BY HASH($120, $121)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.0024937655860349127, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.012468827930174564, "writeRatioMax": 0.014962593516209476 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.00997506234413965, "computeRatioMax": 0.00997506234413965, "endMs": "1665777434559", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1289", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665777434551", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $60, $61", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$50 := SUM($60)", "$51 := SUM($61)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.0024937655860349127, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.029925187032418952, "computeRatioMax": 0.029925187032418952, "endMs": "1665777434601", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777434565", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$140 ASC, $141 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024937655860349127, "waitRatioMax": 0.0024937655860349127, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.034912718204488775, "writeRatioMax": 0.034912718204488775 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "11", "elapsedMs": "582", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1749" } ], "totalBytesBilled": "75497472", "totalBytesProcessed": "75456140", "totalPartitionsProcessed": "0", "totalSlotMs": "1749", "transferredBytes": "0" }, "startTime": "1665777434047", "totalBytesProcessed": "75456140", "totalSlotMs": "1749" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonddb9a1e1_c387_4c4b_97e8_4ff1ffe14990" }, "priority": "INTERACTIVE", "query": "select \n w_state\n ,i_item_id\n ,sum(case when (cast(d_date as date) < cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n ,sum(case when (cast(d_date as date) >= cast ('2000-03-11' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n catalog_sales left outer join catalog_returns on\n (cs_order_number = cr_order_number \n and cs_item_sk = cr_item_sk)\n ,warehouse \n ,item\n ,date_dim\n where\n i_current_price between 0.99 and 1.49\n and i_item_sk = cs_item_sk\n and cs_warehouse_sk = w_warehouse_sk \n and cs_sold_date_sk = d_date_sk\n and d_date between (cast ('2000-03-11' - 30 as date))\n and (cast ('2000-03-11' + 30 as date)) \n group by\n w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "5YVcHX20kk1BeMv/OIjiOg==", "id": "test-project-364309:europe-west1.query40_1665777435", "jobReference": { "jobId": "query40_1665777435", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query40_1665777435?location=europe-west1", "statistics": { "creationTime": "1665777436366", "endTime": "1665777437135", "finalExecutionDurationMs": "569", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "75456140", "performanceInsights": { "avgPreviousExecutionMs": "624" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.029069767441860465, "computeRatioMax": 0.029069767441860465, "endMs": "1665777436555", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.013565891472868217, "readRatioMax": 0.013565891472868217, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "854", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777436520", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim", "WHERE between($2, 10997, 11057)" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001937984496124031, "waitRatioMax": 0.001937984496124031, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.013565891472868217, "writeRatioMax": 0.013565891472868217 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01937984496124031, "computeRatioMax": 0.01937984496124031, "endMs": "1665777436566", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011627906976744186, "readRatioMax": 0.011627906976744186, "recordsRead": "18000", "recordsWritten": "1104", "shuffleOutputBytes": "33120", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777436532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_current_price", "FROM item", "WHERE between($22, NUMERIC<...>, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001937984496124031, "waitRatioMax": 0.001937984496124031, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.013565891472868217, "writeRatioMax": 0.013565891472868217 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.009689922480620155, "computeRatioMax": 0.009689922480620155, "endMs": "1665777436571", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007751937984496124, "readRatioMax": 0.007751937984496124, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "80", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777436544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:w_warehouse_sk, $11:w_state", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001937984496124031, "waitRatioMax": 0.001937984496124031, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.03294573643410853, "writeRatioMax": 0.03294573643410853 }, { "completedParallelInputs": "1", "computeMsAvg": "90", "computeMsMax": "90", "computeRatioAvg": 0.1744186046511628, "computeRatioMax": 0.1744186046511628, "endMs": "1665777436656", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01937984496124031, "readRatioMax": 0.01937984496124031, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "4996761", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665777436556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001937984496124031, "waitRatioMax": 0.001937984496124031, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02131782945736434, "writeRatioMax": 0.02131782945736434 }, { "completedParallelInputs": "5", "computeMsAvg": "402", "computeMsMax": "516", "computeRatioAvg": 0.7790697674418605, "computeRatioMax": 1, "endMs": "1665777437000", "id": "4", "inputStages": [ "1", "0", "3", "2" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.031007751937984496, "readRatioMax": 0.03682170542635659, "recordsRead": "2167733", "recordsWritten": "1289", "shuffleOutputBytes": "79918", "shuffleOutputBytesSpilled": "0", "slotMs": "1777", "startMs": "1665777436667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111", "$60 := SUM($71)", "$61 := SUM($70)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := case_no_value(greater_or_equal($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)", "$71 := case_no_value(less($114, 11027), subtract($112, coalesce($113, NUMERIC<...>)), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $104, $112 := $102, $113 := $103, $114 := $2", "INNER HASH JOIN EACH WITH ALL ON $101 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $92, $103 := $93, $104 := $21", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82, $92 := $83, $93 := $84, $94 := $11", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $34, $84 := $42", "LEFT OUTER HASH JOIN EACH WITH ALL ON $33 = $41, $32 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $60, $61", "TO __stage04_output", "BY HASH($120, $121)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001937984496124031, "waitRatioMax": 0.001937984496124031, "writeMsAvg": "6", "writeMsMax": "10", "writeRatioAvg": 0.011627906976744186, "writeRatioMax": 0.01937984496124031 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.013565891472868217, "computeRatioMax": 0.013565891472868217, "endMs": "1665777437015", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1289", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665777437004", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $60, $61", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$50 := SUM($60)", "$51 := SUM($61)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001937984496124031, "waitRatioMax": 0.001937984496124031, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001937984496124031, "writeRatioMax": 0.001937984496124031 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015503875968992248, "computeRatioMax": 0.015503875968992248, "endMs": "1665777437054", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "6200", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777437015", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$140 ASC, $141 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153", "TO __stage06_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03488372093023256, "writeRatioMax": 0.03488372093023256 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "611", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1983" }, { "activeUnits": "1", "completedUnits": "11", "elapsedMs": "670", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2020" } ], "totalBytesBilled": "75497472", "totalBytesProcessed": "75456140", "totalPartitionsProcessed": "0", "totalSlotMs": "2020", "transferredBytes": "0" }, "startTime": "1665777436410", "totalBytesProcessed": "75456140", "totalSlotMs": "2020" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
