{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5cc31f31_cc05_41a8_ad3c_326633229154" }, "priority": "INTERACTIVE", "query": "-- start query 58 in stream 0 using template query58.tpl\nwith ss_items as\n (select i_item_id item_id\n ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n ,item\n ,date_dim\n where ss_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ss_sold_date_sk = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n ,sum(cs_ext_sales_price) cs_item_rev\n from catalog_sales\n ,item\n ,date_dim\n where cs_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n ,sum(ws_ext_sales_price) ws_item_rev\n from web_sales\n ,item\n ,date_dim\n where ws_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq =(select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ws_sold_date_sk = d_date_sk\n group by i_item_id)\n select ss_items.item_id\n ,ss_item_rev\n ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ss_dev\n ,cs_item_rev\n ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cs_dev\n ,ws_item_rev\n ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ws_dev\n ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n and ss_items.item_id=ws_items.item_id \n and ss_item_rev between 0.9 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n and ss_item_rev between 0.9 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n order by item_id\n ,ss_item_rev\n limit 100\n ;\n\n-- end query 58 in stream 0 using template query58.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "rTLhvMeh7uNZKKt7yPe7dA==", "id": "test-project-364309:europe-west1.query58_1665768398", "jobReference": { "jobId": "query58_1665768398", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query58_1665768398?location=europe-west1", "statistics": { "creationTime": "1665768398787", "endTime": "1665768399862", "finalExecutionDurationMs": "872", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "160240776", "performanceInsights": { "avgPreviousExecutionMs": "897" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03307888040712468, "computeRatioMax": 0.03307888040712468, "endMs": "1665768398960", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015267175572519083, "readRatioMax": 0.015267175572519083, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768398929", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$121:d_week_seq, $120:d_date", "FROM date_dim", "WHERE equal($120, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($121)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010178117048346057, "writeRatioMax": 0.010178117048346057 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03816793893129771, "computeRatioMax": 0.03816793893129771, "endMs": "1665768398965", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020356234096692113, "readRatioMax": 0.020356234096692113, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768398931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91:d_week_seq, $90:d_date", "FROM date_dim", "WHERE equal($90, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_AND_CHECK($91)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage01_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007633587786259542, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01272264631043257, "writeRatioMax": 0.01272264631043257 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04071246819338423, "computeRatioMax": 0.04071246819338423, "endMs": "1665768398962", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015267175572519083, "readRatioMax": 0.015267175572519083, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768398931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$21:d_week_seq, $20:d_date", "FROM date_dim", "WHERE equal($20, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($21)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage02_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007633587786259542, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.04071246819338423, "writeRatioMax": 0.04071246819338423 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04834605597964377, "computeRatioMax": 0.04834605597964377, "endMs": "1665768399024", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.022900763358778626, "readRatioMax": 0.022900763358778626, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768398992", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$80:d_date, $81:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($81, $240)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.020356234096692113, "writeRatioMax": 0.020356234096692113 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.08142493638676845, "computeRatioMax": 0.08142493638676845, "endMs": "1665768399040", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015267175572519083, "readRatioMax": 0.015267175572519083, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768399005", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02544529262086514, "writeRatioMax": 0.02544529262086514 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04071246819338423, "computeRatioMax": 0.04071246819338423, "endMs": "1665768399061", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015267175572519083, "readRatioMax": 0.015267175572519083, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768399019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:i_item_sk, $141:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.061068702290076333, "writeRatioMax": 0.061068702290076333 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.061068702290076333, "computeRatioMax": 0.061068702290076333, "endMs": "1665768399087", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02544529262086514, "readRatioMax": 0.02544529262086514, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768399050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($11, $220)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.020356234096692113, "writeRatioMax": 0.020356234096692113 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.08396946564885496, "computeRatioMax": 0.08396946564885496, "endMs": "1665768399144", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01272264631043257, "readRatioMax": 0.01272264631043257, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665768399063", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "56", "writeMsMax": "56", "writeRatioAvg": 0.14249363867684478, "writeRatioMax": 0.14249363867684478 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03307888040712468, "computeRatioMax": 0.03307888040712468, "endMs": "1665768399130", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.010178117048346057, "readRatioMax": 0.010178117048346057, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768399076", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06615776081424936, "writeRatioMax": 0.06615776081424936 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.061068702290076333, "computeRatioMax": 0.061068702290076333, "endMs": "1665768399137", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017811704834605598, "readRatioMax": 0.017811704834605598, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768399105", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60:d_date, $61:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($61, $230)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.020356234096692113, "writeRatioMax": 0.020356234096692113 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.12213740458015267, "computeRatioMax": 0.12213740458015267, "endMs": "1665768399167", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015267175572519083, "readRatioMax": 0.015267175572519083, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768399125", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.027989821882951654, "writeRatioMax": 0.027989821882951654 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.06361323155216285, "computeRatioMax": 0.06361323155216285, "endMs": "1665768399206", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015267175572519083, "readRatioMax": 0.015267175572519083, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665768399137", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:i_item_sk, $111:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05597964376590331, "writeRatioMax": 0.05597964376590331 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.020356234096692113, "computeRatioMax": 0.043256997455470736, "endMs": "1665768399212", "id": "15", "inputStages": [ "3" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3880", "startMs": "1665768399150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.007633587786259542, "waitRatioMax": 0.010178117048346057, "writeMsAvg": "26", "writeMsMax": "33", "writeRatioAvg": 0.06615776081424936, "writeRatioMax": 0.08396946564885496 }, { "completedParallelInputs": "5", "computeMsAvg": "217", "computeMsMax": "299", "computeRatioAvg": 0.5521628498727735, "computeRatioMax": 0.7608142493638677, "endMs": "1665768399381", "id": "16", "inputStages": [ "15", "5", "0", "4" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.035623409669211195, "readRatioMax": 0.04071246819338423, "recordsRead": "1896833", "recordsWritten": "7125", "shuffleOutputBytes": "270462", "shuffleOutputBytesSpilled": "0", "slotMs": "1007", "startMs": "1665768399156", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_item_sk, $132:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $321", "$210 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $310, $321 := $311", "SEMI HASH JOIN EACH WITH ALL ON $312 = $80" ] }, { "kind": "JOIN", "substeps": [ "$310 := $301, $311 := $302, $312 := $71", "INNER HASH JOIN EACH WITH ALL ON $300 = $70" ] }, { "kind": "JOIN", "substeps": [ "$300 := $130, $301 := $132, $302 := $141", "INNER HASH JOIN EACH WITH ALL ON $131 = $140" ] }, { "kind": "WRITE", "substeps": [ "$330, $210", "TO __stage10_output", "BY HASH($330)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.01272264631043257, "writeRatioMax": 0.015267175572519083 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.020356234096692113, "computeRatioMax": 0.04071246819338423, "endMs": "1665768399245", "id": "18", "inputStages": [ "7" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3406", "startMs": "1665768399182", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005089058524173028, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.035623409669211195, "writeRatioMax": 0.07124681933842239 }, { "completedParallelInputs": "1", "computeMsAvg": "383", "computeMsMax": "383", "computeRatioAvg": 0.9745547073791349, "computeRatioMax": 0.9745547073791349, "endMs": "1665768399478", "id": "19", "inputStages": [ "9", "18", "2", "8" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.05597964376590331, "readRatioMax": 0.05597964376590331, "recordsRead": "810441", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "345", "startMs": "1665768399199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $370, $381 := $371", "SEMI HASH JOIN EACH WITH ALL ON $372 = $10" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $2", "INNER HASH JOIN EACH WITH ALL ON $360 = $1" ] }, { "kind": "JOIN", "substeps": [ "$360 := $30, $361 := $32, $362 := $41", "INNER HASH JOIN EACH WITH ALL ON $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage13_output", "BY HASH($390)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007633587786259542, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010178117048346057, "writeRatioMax": 0.010178117048346057 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.020356234096692113, "computeRatioMax": 0.04071246819338423, "endMs": "1665768399285", "id": "20", "inputStages": [ "11" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3556", "startMs": "1665768399219", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005089058524173028, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.03816793893129771, "writeRatioMax": 0.07888040712468193 }, { "completedParallelInputs": "6", "computeMsAvg": "330", "computeMsMax": "393", "computeRatioAvg": 0.8396946564885496, "computeRatioMax": 1, "endMs": "1665768399544", "id": "21", "inputStages": [ "13", "12", "20", "1" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "20", "readRatioAvg": 0.03816793893129771, "readRatioMax": 0.05089058524173028, "recordsRead": "3426746", "recordsWritten": "16678", "shuffleOutputBytes": "629076", "shuffleOutputBytesSpilled": "0", "slotMs": "2090", "startMs": "1665768399226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$200 := SUM($270)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $260, $271 := $261", "SEMI HASH JOIN EACH WITH ALL ON $262 = $60" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $51", "INNER HASH JOIN EACH WITH ALL ON $250 = $50" ] }, { "kind": "JOIN", "substeps": [ "$250 := $100, $251 := $102, $252 := $111", "INNER HASH JOIN EACH WITH ALL ON $101 = $110" ] }, { "kind": "WRITE", "substeps": [ "$280, $200", "TO __stage15_output", "BY HASH($280)" ] } ], "waitMsAvg": "0", "waitMsMax": "3", "waitRatioAvg": 0, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.010178117048346057, "writeRatioMax": 0.015267175572519083 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.05343511450381679, "computeRatioMax": 0.05343511450381679, "endMs": "1665768399657", "id": "22", "inputStages": [ "19" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "77", "startMs": "1665768399578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "63", "writeMsMax": "63", "writeRatioAvg": 0.16030534351145037, "writeRatioMax": 0.16030534351145037 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03307888040712468, "computeRatioMax": 0.03307888040712468, "endMs": "1665768399657", "id": "23", "inputStages": [ "16" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7125", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768399595", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $210", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $340", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002544529262086514, "waitRatioMax": 0.002544529262086514, "writeMsAvg": "51", "writeMsMax": "51", "writeRatioAvg": 0.1297709923664122, "writeRatioMax": 0.1297709923664122 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.022900763358778626, "computeRatioMax": 0.04071246819338423, "endMs": "1665768399737", "id": "25", "inputStages": [ "23" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5169", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "4108", "startMs": "1665768399671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005089058524173028, "waitRatioMax": 0.010178117048346057, "writeMsAvg": "23", "writeMsMax": "52", "writeRatioAvg": 0.058524173027989825, "writeRatioMax": 0.13231552162849872 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.022900763358778626, "computeRatioMax": 0.04071246819338423, "endMs": "1665768399735", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "4122", "startMs": "1665768399672", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.010178117048346057, "waitRatioMax": 0.01272264631043257, "writeMsAvg": "28", "writeMsMax": "35", "writeRatioAvg": 0.07124681933842239, "writeRatioMax": 0.089058524173028 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.11450381679389313, "computeRatioMax": 0.11450381679389313, "endMs": "1665768399764", "id": "27", "inputStages": [ "26", "25", "21" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26164", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665768399678", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $200", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$180, $340", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage1A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide($422, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$151 := multiply(divide($423, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$152 := multiply(divide($421, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$153 := divide(add(add($422, $423), $421), NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "and(between($411, multiply(NUMERIC<...>, $413), multiply(NUMERIC<...>, $413)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$410 := $350, $411 := $351, $412 := $352, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $350 = $400" ] }, { "kind": "FILTER", "substeps": [ "and(between($351, multiply(NUMERIC<...>, $352), multiply(NUMERIC<...>, $352)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $290, $351 := $170, $352 := $180", "INNER HASH JOIN EACH WITH ALL ON $290 = $340" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.010178117048346057, "waitRatioMax": 0.010178117048346057, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010178117048346057, "writeRatioMax": 0.010178117048346057 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.035623409669211195, "computeRatioMax": 0.035623409669211195, "endMs": "1665768399781", "id": "28", "inputStages": [ "27" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768399698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1B_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007633587786259542, "waitRatioMax": 0.007633587786259542, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01272264631043257, "writeRatioMax": 0.01272264631043257 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "319", "elapsedMs": "602", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "13189" }, { "activeUnits": "5", "completedUnits": "528", "elapsedMs": "990", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "23453" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "160240776", "totalPartitionsProcessed": "0", "totalSlotMs": "23453", "transferredBytes": "0" }, "startTime": "1665768398828", "totalBytesProcessed": "160240776", "totalSlotMs": "23453" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond3f3bc87_f3ee_4879_b873_804ea9b48aaf" }, "priority": "INTERACTIVE", "query": "-- start query 58 in stream 0 using template query58.tpl\nwith ss_items as\n (select i_item_id item_id\n ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n ,item\n ,date_dim\n where ss_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ss_sold_date_sk = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n ,sum(cs_ext_sales_price) cs_item_rev\n from catalog_sales\n ,item\n ,date_dim\n where cs_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n ,sum(ws_ext_sales_price) ws_item_rev\n from web_sales\n ,item\n ,date_dim\n where ws_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq =(select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ws_sold_date_sk = d_date_sk\n group by i_item_id)\n select ss_items.item_id\n ,ss_item_rev\n ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ss_dev\n ,cs_item_rev\n ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cs_dev\n ,ws_item_rev\n ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ws_dev\n ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n and ss_items.item_id=ws_items.item_id \n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n order by item_id\n ,ss_item_rev\n limit 100\n ;\n\n-- end query 58 in stream 0 using template query58.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "zanF6XlMiEOzpY+tZ0p7cg==", "id": "test-project-364309:europe-west1.query58_1665777838", "jobReference": { "jobId": "query58_1665777838", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query58_1665777838?location=europe-west1", "statistics": { "creationTime": "1665777839294", "endTime": "1665777840740", "finalExecutionDurationMs": "1203", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "160240776", "performanceInsights": { "avgPreviousExecutionMs": "894" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011315417256011316, "computeRatioMax": 0.011315417256011316, "endMs": "1665777839490", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011315417256011316, "readRatioMax": 0.011315417256011316, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777839444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$121:d_week_seq, $120:d_date", "FROM date_dim", "WHERE equal($120, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($121)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014144271570014145, "waitRatioMax": 0.0014144271570014145, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.024045261669024046, "writeRatioMax": 0.024045261669024046 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.014144271570014143, "computeRatioMax": 0.014144271570014143, "endMs": "1665777839518", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007072135785007072, "readRatioMax": 0.007072135785007072, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777839448", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91:d_week_seq, $90:d_date", "FROM date_dim", "WHERE equal($90, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_AND_CHECK($91)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage01_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004243281471004243, "waitRatioMax": 0.004243281471004243, "writeMsAvg": "56", "writeMsMax": "56", "writeRatioAvg": 0.07920792079207921, "writeRatioMax": 0.07920792079207921 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.018387553041018388, "computeRatioMax": 0.018387553041018388, "endMs": "1665777839506", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009900990099009901, "readRatioMax": 0.009900990099009901, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777839449", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$21:d_week_seq, $20:d_date", "FROM date_dim", "WHERE equal($20, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($21)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage02_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004243281471004243, "waitRatioMax": 0.004243281471004243, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.03818953323903819, "writeRatioMax": 0.03818953323903819 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.031117397454031116, "computeRatioMax": 0.031117397454031116, "endMs": "1665777839580", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008486562942008486, "readRatioMax": 0.008486562942008486, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777839537", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$80:d_date, $81:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($81, $240)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014144271570014145, "waitRatioMax": 0.0014144271570014145, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.0297029702970297, "writeRatioMax": 0.0297029702970297 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.05091937765205092, "computeRatioMax": 0.05091937765205092, "endMs": "1665777839618", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.01272984441301273, "readRatioMax": 0.01272984441301273, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777839563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004243281471004243, "waitRatioMax": 0.004243281471004243, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.016973125884016973, "writeRatioMax": 0.016973125884016973 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.031117397454031116, "computeRatioMax": 0.031117397454031116, "endMs": "1665777839638", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.015558698727015558, "readRatioMax": 0.015558698727015558, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777839587", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:i_item_sk, $141:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014144271570014145, "waitRatioMax": 0.0014144271570014145, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.033946251768033946, "writeRatioMax": 0.033946251768033946 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0297029702970297, "computeRatioMax": 0.0297029702970297, "endMs": "1665777839714", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.015558698727015558, "readRatioMax": 0.015558698727015558, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "77", "startMs": "1665777839639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($11, $220)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002828854314002829, "waitRatioMax": 0.002828854314002829, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.026874115983026876, "writeRatioMax": 0.026874115983026876 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.05233380480905234, "computeRatioMax": 0.05233380480905234, "endMs": "1665777839729", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009900990099009901, "readRatioMax": 0.009900990099009901, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777839669", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014144271570014145, "waitRatioMax": 0.0014144271570014145, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.04101838755304102, "writeRatioMax": 0.04101838755304102 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0297029702970297, "computeRatioMax": 0.0297029702970297, "endMs": "1665777839766", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011315417256011316, "readRatioMax": 0.011315417256011316, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777839708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014144271570014145, "waitRatioMax": 0.0014144271570014145, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.033946251768033946, "writeRatioMax": 0.033946251768033946 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0297029702970297, "computeRatioMax": 0.0297029702970297, "endMs": "1665777839800", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.01272984441301273, "readRatioMax": 0.01272984441301273, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777839756", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60:d_date, $61:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($61, $230)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002828854314002829, "waitRatioMax": 0.002828854314002829, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.009900990099009901, "writeRatioMax": 0.009900990099009901 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.055162659123055166, "computeRatioMax": 0.055162659123055166, "endMs": "1665777839841", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.016973125884016973, "readRatioMax": 0.016973125884016973, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665777839777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002828854314002829, "waitRatioMax": 0.002828854314002829, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.021216407355021217, "writeRatioMax": 0.021216407355021217 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0297029702970297, "computeRatioMax": 0.0297029702970297, "endMs": "1665777839859", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011315417256011316, "readRatioMax": 0.011315417256011316, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777839797", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:i_item_sk, $111:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002828854314002829, "waitRatioMax": 0.002828854314002829, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.03818953323903819, "writeRatioMax": 0.03818953323903819 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "19", "computeRatioAvg": 0.014144271570014143, "computeRatioMax": 0.026874115983026876, "endMs": "1665777839942", "id": "15", "inputStages": [ "3" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "4891", "startMs": "1665777839829", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "6", "waitMsMax": "9", "waitRatioAvg": 0.008486562942008486, "waitRatioMax": 0.01272984441301273, "writeMsAvg": "37", "writeMsMax": "69", "writeRatioAvg": 0.05233380480905234, "writeRatioMax": 0.09759547383309759 }, { "completedParallelInputs": "5", "computeMsAvg": "198", "computeMsMax": "249", "computeRatioAvg": 0.28005657708628007, "computeRatioMax": 0.3521923620933522, "endMs": "1665777840022", "id": "16", "inputStages": [ "5", "15", "4", "0" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "17", "readRatioAvg": 0.021216407355021217, "readRatioMax": 0.024045261669024046, "recordsRead": "1896833", "recordsWritten": "7125", "shuffleOutputBytes": "270462", "shuffleOutputBytesSpilled": "0", "slotMs": "1061", "startMs": "1665777839840", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_item_sk, $132:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $321", "$210 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $310, $321 := $311", "SEMI HASH JOIN EACH WITH ALL ON $312 = $80" ] }, { "kind": "JOIN", "substeps": [ "$310 := $301, $311 := $302, $312 := $71", "INNER HASH JOIN EACH WITH ALL ON $300 = $70" ] }, { "kind": "JOIN", "substeps": [ "$300 := $130, $301 := $132, $302 := $141", "INNER HASH JOIN EACH WITH ALL ON $131 = $140" ] }, { "kind": "WRITE", "substeps": [ "$330, $210", "TO __stage10_output", "BY HASH($330)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0014144271570014145, "waitRatioMax": 0.002828854314002829, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.005657708628005658, "writeRatioMax": 0.007072135785007072 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.009900990099009901, "computeRatioMax": 0.021216407355021217, "endMs": "1665777839952", "id": "17", "inputStages": [ "7" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3862", "startMs": "1665777839864", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "22", "waitMsMax": "24", "waitRatioAvg": 0.031117397454031116, "waitRatioMax": 0.033946251768033946, "writeMsAvg": "15", "writeMsMax": "22", "writeRatioAvg": 0.021216407355021217, "writeRatioMax": 0.031117397454031116 }, { "completedParallelInputs": "1", "computeMsAvg": "331", "computeMsMax": "331", "computeRatioAvg": 0.4681753889674682, "computeRatioMax": 0.4681753889674682, "endMs": "1665777840120", "id": "18", "inputStages": [ "2", "8", "17", "9" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.019801980198019802, "readRatioMax": 0.019801980198019802, "recordsRead": "810441", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "327", "startMs": "1665777839889", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $370, $381 := $371", "SEMI HASH JOIN EACH WITH ALL ON $372 = $10" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $2", "INNER HASH JOIN EACH WITH ALL ON $360 = $1" ] }, { "kind": "JOIN", "substeps": [ "$360 := $30, $361 := $32, $362 := $41", "INNER HASH JOIN EACH WITH ALL ON $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage12_output", "BY HASH($390)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014144271570014145, "waitRatioMax": 0.0014144271570014145, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.008486562942008486, "writeRatioMax": 0.008486562942008486 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.011315417256011316, "computeRatioMax": 0.026874115983026876, "endMs": "1665777839987", "id": "19", "inputStages": [ "11" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "4509", "startMs": "1665777839904", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0B_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.007072135785007072, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "18", "writeMsMax": "30", "writeRatioAvg": 0.02545968882602546, "writeRatioMax": 0.042432814710042434 }, { "completedParallelInputs": "6", "computeMsAvg": "468", "computeMsMax": "707", "computeRatioAvg": 0.6619519094766619, "computeRatioMax": 1, "endMs": "1665777840363", "id": "20", "inputStages": [ "13", "1", "12", "19" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "19", "readRatioAvg": 0.024045261669024046, "readRatioMax": 0.026874115983026876, "recordsRead": "3426746", "recordsWritten": "16678", "shuffleOutputBytes": "629076", "shuffleOutputBytesSpilled": "0", "slotMs": "2539", "startMs": "1665777839928", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$200 := SUM($270)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $260, $271 := $261", "SEMI HASH JOIN EACH WITH ALL ON $262 = $60" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $51", "INNER HASH JOIN EACH WITH ALL ON $250 = $50" ] }, { "kind": "JOIN", "substeps": [ "$250 := $100, $251 := $102, $252 := $111", "INNER HASH JOIN EACH WITH ALL ON $101 = $110" ] }, { "kind": "WRITE", "substeps": [ "$280, $200", "TO __stage14_output", "BY HASH($280)" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.008486562942008486, "waitRatioMax": 0.011315417256011316, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.007072135785007072, "writeRatioMax": 0.009900990099009901 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.026874115983026876, "computeRatioMax": 0.026874115983026876, "endMs": "1665777840454", "id": "21", "inputStages": [ "18" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665777840398", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002828854314002829, "waitRatioMax": 0.002828854314002829, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.04101838755304102, "writeRatioMax": 0.04101838755304102 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.019801980198019802, "computeRatioMax": 0.019801980198019802, "endMs": "1665777840469", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7125", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777840422", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $210", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $340", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014144271570014145, "waitRatioMax": 0.0014144271570014145, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.036775106082036775, "writeRatioMax": 0.036775106082036775 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.01272984441301273, "computeRatioMax": 0.026874115983026876, "endMs": "1665777840567", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5169", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "4188", "startMs": "1665777840486", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "4", "waitMsMax": "9", "waitRatioAvg": 0.005657708628005658, "waitRatioMax": 0.01272984441301273, "writeMsAvg": "24", "writeMsMax": "55", "writeRatioAvg": 0.033946251768033946, "writeRatioMax": 0.07779349363507779 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.011315417256011316, "computeRatioMax": 0.021216407355021217, "endMs": "1665777840573", "id": "25", "inputStages": [ "21" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "3789", "startMs": "1665777840490", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "10", "waitMsMax": "13", "waitRatioAvg": 0.014144271570014143, "waitRatioMax": 0.018387553041018388, "writeMsAvg": "16", "writeMsMax": "54", "writeRatioAvg": 0.02263083451202263, "writeRatioMax": 0.07637906647807638 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.04950495049504951, "computeRatioMax": 0.04950495049504951, "endMs": "1665777840597", "id": "26", "inputStages": [ "24", "20", "25" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26164", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777840507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $200", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$180, $340", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide($422, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$151 := multiply(divide($423, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$152 := multiply(divide($421, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$153 := divide(add(add($422, $423), $421), NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "and(between($411, multiply(NUMERIC<...>, $413), multiply(NUMERIC<...>, $413)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$410 := $350, $411 := $351, $412 := $352, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $350 = $400" ] }, { "kind": "FILTER", "substeps": [ "and(between($351, multiply(NUMERIC<...>, $352), multiply(NUMERIC<...>, $352)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $290, $351 := $170, $352 := $180", "INNER HASH JOIN EACH WITH ALL ON $290 = $340" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1A_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.018387553041018388, "waitRatioMax": 0.018387553041018388, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0014144271570014145, "writeRatioMax": 0.0014144271570014145 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.019801980198019802, "computeRatioMax": 0.019801980198019802, "endMs": "1665777840621", "id": "27", "inputStages": [ "26" ], "name": "S1B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777840521", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1A_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1B_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.007072135785007072, "waitRatioMax": 0.007072135785007072, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.009900990099009901, "writeRatioMax": 0.009900990099009901 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "128", "completedUnits": "189", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "135", "totalSlotMs": "9219" }, { "activeUnits": "112", "completedUnits": "528", "elapsedMs": "1335", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "25993" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "160240776", "totalPartitionsProcessed": "0", "totalSlotMs": "25993", "transferredBytes": "0" }, "startTime": "1665777839347", "totalBytesProcessed": "160240776", "totalSlotMs": "25993" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond56e9894_fb53_4586_8b89_f8aaf20aa637" }, "priority": "INTERACTIVE", "query": "-- start query 58 in stream 0 using template query58.tpl\nwith ss_items as\n (select i_item_id item_id\n ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n ,item\n ,date_dim\n where ss_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ss_sold_date_sk = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n ,sum(cs_ext_sales_price) cs_item_rev\n from catalog_sales\n ,item\n ,date_dim\n where cs_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n ,sum(ws_ext_sales_price) ws_item_rev\n from web_sales\n ,item\n ,date_dim\n where ws_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq =(select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ws_sold_date_sk = d_date_sk\n group by i_item_id)\n select ss_items.item_id\n ,ss_item_rev\n ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ss_dev\n ,cs_item_rev\n ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cs_dev\n ,ws_item_rev\n ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ws_dev\n ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n and ss_items.item_id=ws_items.item_id \n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n order by item_id\n ,ss_item_rev\n limit 100\n ;\n\n-- end query 58 in stream 0 using template query58.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "JU+T9nsyi5AkutumrSuG3g==", "id": "test-project-364309:europe-west1.query58_1665777842", "jobReference": { "jobId": "query58_1665777842", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query58_1665777842?location=europe-west1", "statistics": { "creationTime": "1665777843316", "endTime": "1665777844584", "finalExecutionDurationMs": "1025", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "160240776", "performanceInsights": { "avgPreviousExecutionMs": "932" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.016467065868263474, "computeRatioMax": 0.016467065868263474, "endMs": "1665777843511", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0074850299401197605, "readRatioMax": 0.0074850299401197605, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777843472", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$121:d_week_seq, $120:d_date", "FROM date_dim", "WHERE equal($120, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($121)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.020958083832335328, "writeRatioMax": 0.020958083832335328 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.023952095808383235, "computeRatioMax": 0.023952095808383235, "endMs": "1665777843516", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.016467065868263474, "readRatioMax": 0.016467065868263474, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777843475", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91:d_week_seq, $90:d_date", "FROM date_dim", "WHERE equal($90, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_AND_CHECK($91)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0029940119760479044, "waitRatioMax": 0.0029940119760479044, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.029940119760479042, "writeRatioMax": 0.029940119760479042 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017964071856287425, "computeRatioMax": 0.017964071856287425, "endMs": "1665777843511", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.014970059880239521, "readRatioMax": 0.014970059880239521, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777843475", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$21:d_week_seq, $20:d_date", "FROM date_dim", "WHERE equal($20, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($21)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0029940119760479044, "waitRatioMax": 0.0029940119760479044, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.023952095808383235, "writeRatioMax": 0.023952095808383235 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.0344311377245509, "computeRatioMax": 0.0344311377245509, "endMs": "1665777843589", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010479041916167664, "readRatioMax": 0.010479041916167664, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777843544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($11, $220)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.011976047904191617, "writeRatioMax": 0.011976047904191617 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.04940119760479042, "computeRatioMax": 0.04940119760479042, "endMs": "1665777843612", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008982035928143712, "readRatioMax": 0.008982035928143712, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777843563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.014970059880239521, "writeRatioMax": 0.014970059880239521 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.023952095808383235, "computeRatioMax": 0.023952095808383235, "endMs": "1665777843640", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008982035928143712, "readRatioMax": 0.008982035928143712, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777843589", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03592814371257485, "writeRatioMax": 0.03592814371257485 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.0344311377245509, "computeRatioMax": 0.0344311377245509, "endMs": "1665777843666", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0074850299401197605, "readRatioMax": 0.0074850299401197605, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777843624", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$80:d_date, $81:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($81, $240)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.011976047904191617, "writeRatioMax": 0.011976047904191617 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.04940119760479042, "computeRatioMax": 0.04940119760479042, "endMs": "1665777843679", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011976047904191617, "readRatioMax": 0.011976047904191617, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777843638", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.017964071856287425, "writeRatioMax": 0.017964071856287425 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.05688622754491018, "computeRatioMax": 0.05688622754491018, "endMs": "1665777843707", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011976047904191617, "readRatioMax": 0.011976047904191617, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665777843653", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:i_item_sk, $141:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.0374251497005988, "writeRatioMax": 0.0374251497005988 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.025449101796407185, "computeRatioMax": 0.025449101796407185, "endMs": "1665777843730", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011976047904191617, "readRatioMax": 0.011976047904191617, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777843690", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60:d_date, $61:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($61, $230)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.010479041916167664, "writeRatioMax": 0.010479041916167664 }, { "completedParallelInputs": "1", "computeMsAvg": "82", "computeMsMax": "82", "computeRatioAvg": 0.12275449101796407, "computeRatioMax": 0.12275449101796407, "endMs": "1665777843802", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.020958083832335328, "readRatioMax": 0.020958083832335328, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "131", "startMs": "1665777843707", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.05389221556886228, "writeRatioMax": 0.05389221556886228 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.02694610778443114, "computeRatioMax": 0.02694610778443114, "endMs": "1665777843790", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0074850299401197605, "readRatioMax": 0.0074850299401197605, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777843723", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:i_item_sk, $111:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "38", "writeMsMax": "38", "writeRatioAvg": 0.05688622754491018, "writeRatioMax": 0.05688622754491018 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.014970059880239521, "computeRatioMax": 0.029940119760479042, "endMs": "1665777843839", "id": "15", "inputStages": [ "3" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "6832", "startMs": "1665777843742", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004491017964071856, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "48", "writeMsMax": "55", "writeRatioAvg": 0.0718562874251497, "writeRatioMax": 0.08233532934131736 }, { "completedParallelInputs": "1", "computeMsAvg": "668", "computeMsMax": "668", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777844186", "id": "16", "inputStages": [ "5", "2", "15", "4" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.02245508982035928, "readRatioMax": 0.02245508982035928, "recordsRead": "810441", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "670", "startMs": "1665777843779", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $370, $381 := $371", "SEMI HASH JOIN EACH WITH ALL ON $372 = $10" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $2", "INNER HASH JOIN EACH WITH ALL ON $360 = $1" ] }, { "kind": "JOIN", "substeps": [ "$360 := $30, $361 := $32, $362 := $41", "INNER HASH JOIN EACH WITH ALL ON $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage10_output", "BY HASH($390)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0029940119760479044, "waitRatioMax": 0.0029940119760479044, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.004491017964071856, "writeRatioMax": 0.004491017964071856 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.01347305389221557, "computeRatioMax": 0.03143712574850299, "endMs": "1665777843842", "id": "17", "inputStages": [ "7" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "4556", "startMs": "1665777843781", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004491017964071856, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "23", "writeMsMax": "49", "writeRatioAvg": 0.0344311377245509, "writeRatioMax": 0.07335329341317365 }, { "completedParallelInputs": "5", "computeMsAvg": "236", "computeMsMax": "346", "computeRatioAvg": 0.3532934131736527, "computeRatioMax": 0.5179640718562875, "endMs": "1665777844014", "id": "18", "inputStages": [ "0", "8", "17", "9" ], "name": "S12: Join+", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.019461077844311378, "readRatioMax": 0.023952095808383235, "recordsRead": "1896833", "recordsWritten": "7125", "shuffleOutputBytes": "270462", "shuffleOutputBytesSpilled": "0", "slotMs": "1052", "startMs": "1665777843788", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_item_sk, $132:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $321", "$210 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $310, $321 := $311", "SEMI HASH JOIN EACH WITH ALL ON $312 = $80" ] }, { "kind": "JOIN", "substeps": [ "$310 := $301, $311 := $302, $312 := $71", "INNER HASH JOIN EACH WITH ALL ON $300 = $70" ] }, { "kind": "JOIN", "substeps": [ "$300 := $130, $301 := $132, $302 := $141", "INNER HASH JOIN EACH WITH ALL ON $131 = $140" ] }, { "kind": "WRITE", "substeps": [ "$330, $210", "TO __stage12_output", "BY HASH($330)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.005988023952095809, "writeRatioMax": 0.005988023952095809 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.011976047904191617, "computeRatioMax": 0.023952095808383235, "endMs": "1665777843887", "id": "20", "inputStages": [ "11" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3608", "startMs": "1665777843824", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0029940119760479044, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "15", "writeMsMax": "41", "writeRatioAvg": 0.02245508982035928, "writeRatioMax": 0.061377245508982034 }, { "completedParallelInputs": "6", "computeMsAvg": "372", "computeMsMax": "657", "computeRatioAvg": 0.5568862275449101, "computeRatioMax": 0.9835329341317365, "endMs": "1665777844197", "id": "21", "inputStages": [ "20", "13", "1", "12" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "20", "readRatioAvg": 0.019461077844311378, "readRatioMax": 0.029940119760479042, "recordsRead": "3426746", "recordsWritten": "16678", "shuffleOutputBytes": "629076", "shuffleOutputBytesSpilled": "0", "slotMs": "2177", "startMs": "1665777843834", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$200 := SUM($270)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $260, $271 := $261", "SEMI HASH JOIN EACH WITH ALL ON $262 = $60" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $51", "INNER HASH JOIN EACH WITH ALL ON $250 = $50" ] }, { "kind": "JOIN", "substeps": [ "$250 := $100, $251 := $102, $252 := $111", "INNER HASH JOIN EACH WITH ALL ON $101 = $110" ] }, { "kind": "WRITE", "substeps": [ "$280, $200", "TO __stage15_output", "BY HASH($280)" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.0029940119760479044, "waitRatioMax": 0.0074850299401197605, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.0074850299401197605, "writeRatioMax": 0.010479041916167664 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017964071856287425, "computeRatioMax": 0.017964071856287425, "endMs": "1665777844331", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777844296", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.017964071856287425, "writeRatioMax": 0.017964071856287425 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017964071856287425, "computeRatioMax": 0.017964071856287425, "endMs": "1665777844357", "id": "23", "inputStages": [ "18" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7125", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777844322", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $210", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $340", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014970059880239522, "waitRatioMax": 0.0014970059880239522, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.0374251497005988, "writeRatioMax": 0.0374251497005988 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.01347305389221557, "computeRatioMax": 0.02844311377245509, "endMs": "1665777844433", "id": "25", "inputStages": [ "23" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5169", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "3773", "startMs": "1665777844373", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.0029940119760479044, "waitRatioMax": 0.0074850299401197605, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.02245508982035928, "writeRatioMax": 0.04341317365269461 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "24", "computeRatioAvg": 0.011976047904191617, "computeRatioMax": 0.03592814371257485, "endMs": "1665777844427", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "3211", "startMs": "1665777844375", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.0074850299401197605, "waitRatioMax": 0.010479041916167664, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.020958083832335328, "writeRatioMax": 0.029940119760479042 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.04790419161676647, "computeRatioMax": 0.04790419161676647, "endMs": "1665777844455", "id": "27", "inputStages": [ "25", "26", "21" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26164", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665777844386", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $200", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$180, $340", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage1A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide($422, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$151 := multiply(divide($423, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$152 := multiply(divide($421, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$153 := divide(add(add($422, $423), $421), NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "and(between($411, multiply(NUMERIC<...>, $413), multiply(NUMERIC<...>, $413)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$410 := $350, $411 := $351, $412 := $352, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $350 = $400" ] }, { "kind": "FILTER", "substeps": [ "and(between($351, multiply(NUMERIC<...>, $352), multiply(NUMERIC<...>, $352)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $290, $351 := $170, $352 := $180", "INNER HASH JOIN EACH WITH ALL ON $290 = $340" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1B_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.010479041916167664, "waitRatioMax": 0.010479041916167664, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.004491017964071856, "writeRatioMax": 0.004491017964071856 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011976047904191617, "computeRatioMax": 0.011976047904191617, "endMs": "1665777844470", "id": "28", "inputStages": [ "27" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777844391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1B_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0029940119760479044, "waitRatioMax": 0.0029940119760479044, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.008982035928143712, "writeRatioMax": 0.008982035928143712 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "10", "completedUnits": "315", "elapsedMs": "601", "estimatedRunnableUnits": "0", "pendingUnits": "9", "totalSlotMs": "16565" }, { "activeUnits": "0", "completedUnits": "528", "elapsedMs": "1152", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "26689" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "160240776", "totalPartitionsProcessed": "0", "totalSlotMs": "26689", "transferredBytes": "0" }, "startTime": "1665777843373", "totalBytesProcessed": "160240776", "totalSlotMs": "26689" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon04fa4bf6_c06c_4c1f_8ff2_cdf4c8ab334e" }, "priority": "INTERACTIVE", "query": "-- start query 58 in stream 0 using template query58.tpl\nwith ss_items as\n (select i_item_id item_id\n ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n ,item\n ,date_dim\n where ss_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ss_sold_date_sk = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n ,sum(cs_ext_sales_price) cs_item_rev\n from catalog_sales\n ,item\n ,date_dim\n where cs_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n ,sum(ws_ext_sales_price) ws_item_rev\n from web_sales\n ,item\n ,date_dim\n where ws_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq =(select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ws_sold_date_sk = d_date_sk\n group by i_item_id)\n select ss_items.item_id\n ,ss_item_rev\n ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ss_dev\n ,cs_item_rev\n ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cs_dev\n ,ws_item_rev\n ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ws_dev\n ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n and ss_items.item_id=ws_items.item_id \n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n order by item_id\n ,ss_item_rev\n limit 100\n ;\n\n-- end query 58 in stream 0 using template query58.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "srmjgMFKrhiHgxhwN+p7Rw==", "id": "test-project-364309:europe-west1.query58_1665777845", "jobReference": { "jobId": "query58_1665777845", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query58_1665777845?location=europe-west1", "statistics": { "creationTime": "1665777846249", "endTime": "1665777847535", "finalExecutionDurationMs": "1038", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "160240776", "performanceInsights": { "avgPreviousExecutionMs": "943" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01445466491458607, "computeRatioMax": 0.01445466491458607, "endMs": "1665777846446", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00788436268068331, "readRatioMax": 0.00788436268068331, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777846405", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$121:d_week_seq, $120:d_date", "FROM date_dim", "WHERE equal($120, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($121)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.017082785808147174, "writeRatioMax": 0.017082785808147174 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013140604467805518, "computeRatioMax": 0.013140604467805518, "endMs": "1665777846443", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005256241787122208, "readRatioMax": 0.005256241787122208, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777846407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91:d_week_seq, $90:d_date", "FROM date_dim", "WHERE equal($90, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_AND_CHECK($91)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage01_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003942181340341655, "waitRatioMax": 0.003942181340341655, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.017082785808147174, "writeRatioMax": 0.017082785808147174 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01445466491458607, "computeRatioMax": 0.01445466491458607, "endMs": "1665777846445", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006570302233902759, "readRatioMax": 0.006570302233902759, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777846407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$21:d_week_seq, $20:d_date", "FROM date_dim", "WHERE equal($20, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($21)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage02_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003942181340341655, "waitRatioMax": 0.003942181340341655, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.01576872536136662, "writeRatioMax": 0.01576872536136662 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.017082785808147174, "computeRatioMax": 0.017082785808147174, "endMs": "1665777846512", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005256241787122208, "readRatioMax": 0.005256241787122208, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777846473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60:d_date, $61:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($61, $230)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002628120893561104, "waitRatioMax": 0.002628120893561104, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.013140604467805518, "writeRatioMax": 0.013140604467805518 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.05781865965834428, "computeRatioMax": 0.05781865965834428, "endMs": "1665777846532", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.011826544021024968, "readRatioMax": 0.011826544021024968, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665777846486", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002628120893561104, "waitRatioMax": 0.002628120893561104, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.013140604467805518, "writeRatioMax": 0.013140604467805518 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.03153745072273324, "computeRatioMax": 0.03153745072273324, "endMs": "1665777846556", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00788436268068331, "readRatioMax": 0.00788436268068331, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777846502", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:i_item_sk, $111:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.024967148488830485, "writeRatioMax": 0.024967148488830485 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.030223390275952694, "computeRatioMax": 0.030223390275952694, "endMs": "1665777846587", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.011826544021024968, "readRatioMax": 0.011826544021024968, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777846538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($11, $220)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.011826544021024968, "writeRatioMax": 0.011826544021024968 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.05387647831800263, "computeRatioMax": 0.05387647831800263, "endMs": "1665777846592", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00788436268068331, "readRatioMax": 0.00788436268068331, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777846557", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.010512483574244415, "writeRatioMax": 0.010512483574244415 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.023653088042049936, "computeRatioMax": 0.023653088042049936, "endMs": "1665777846622", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006570302233902759, "readRatioMax": 0.006570302233902759, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777846578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.0328515111695138, "writeRatioMax": 0.0328515111695138 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.024967148488830485, "computeRatioMax": 0.024967148488830485, "endMs": "1665777846676", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00788436268068331, "readRatioMax": 0.00788436268068331, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777846627", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$80:d_date, $81:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($81, $240)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02102496714848883, "writeRatioMax": 0.02102496714848883 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.04862023653088042, "computeRatioMax": 0.04862023653088042, "endMs": "1665777846698", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00788436268068331, "readRatioMax": 0.00788436268068331, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777846658", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002628120893561104, "waitRatioMax": 0.002628120893561104, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01445466491458607, "writeRatioMax": 0.01445466491458607 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.026281208935611037, "computeRatioMax": 0.026281208935611037, "endMs": "1665777846748", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.013140604467805518, "readRatioMax": 0.013140604467805518, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777846676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:i_item_sk, $141:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.035479632063074903, "writeRatioMax": 0.035479632063074903 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.010512483574244415, "computeRatioMax": 0.022339027595269383, "endMs": "1665777846772", "id": "15", "inputStages": [ "3" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3547", "startMs": "1665777846698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.005256241787122208, "waitRatioMax": 0.006570302233902759, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.018396846254927726, "writeRatioMax": 0.03153745072273324 }, { "completedParallelInputs": "6", "computeMsAvg": "298", "computeMsMax": "380", "computeRatioAvg": 0.3915900131406045, "computeRatioMax": 0.49934296977660975, "endMs": "1665777847005", "id": "16", "inputStages": [ "4", "15", "5", "1" ], "name": "S10: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.017082785808147174, "readRatioMax": 0.022339027595269383, "recordsRead": "3426746", "recordsWritten": "16678", "shuffleOutputBytes": "629076", "shuffleOutputBytesSpilled": "0", "slotMs": "1689", "startMs": "1665777846704", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$200 := SUM($270)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $260, $271 := $261", "SEMI HASH JOIN EACH WITH ALL ON $262 = $60" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $51", "INNER HASH JOIN EACH WITH ALL ON $250 = $50" ] }, { "kind": "JOIN", "substeps": [ "$250 := $100, $251 := $102, $252 := $111", "INNER HASH JOIN EACH WITH ALL ON $101 = $110" ] }, { "kind": "WRITE", "substeps": [ "$280, $200", "TO __stage10_output", "BY HASH($280)" ] } ], "waitMsAvg": "3", "waitMsMax": "12", "waitRatioAvg": 0.003942181340341655, "waitRatioMax": 0.01576872536136662, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.006570302233902759, "writeRatioMax": 0.009198423127463863 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.010512483574244415, "computeRatioMax": 0.02102496714848883, "endMs": "1665777846783", "id": "17", "inputStages": [ "7" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3527", "startMs": "1665777846708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.003942181340341655, "waitRatioMax": 0.006570302233902759, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.018396846254927726, "writeRatioMax": 0.030223390275952694 }, { "completedParallelInputs": "1", "computeMsAvg": "761", "computeMsMax": "761", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777847184", "id": "18", "inputStages": [ "2", "9", "17", "8" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.01971090670170828, "readRatioMax": 0.01971090670170828, "recordsRead": "810441", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "697", "startMs": "1665777846722", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $370, $381 := $371", "SEMI HASH JOIN EACH WITH ALL ON $372 = $10" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $2", "INNER HASH JOIN EACH WITH ALL ON $360 = $1" ] }, { "kind": "JOIN", "substeps": [ "$360 := $30, $361 := $32, $362 := $41", "INNER HASH JOIN EACH WITH ALL ON $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage12_output", "BY HASH($390)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002628120893561104, "waitRatioMax": 0.002628120893561104, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.010512483574244415, "writeRatioMax": 0.010512483574244415 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.011826544021024968, "computeRatioMax": 0.01971090670170828, "endMs": "1665777846839", "id": "19", "inputStages": [ "11" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "4181", "startMs": "1665777846773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.002628120893561104, "waitRatioMax": 0.003942181340341655, "writeMsAvg": "16", "writeMsMax": "31", "writeRatioAvg": 0.02102496714848883, "writeRatioMax": 0.040735873850197106 }, { "completedParallelInputs": "5", "computeMsAvg": "212", "computeMsMax": "319", "computeRatioAvg": 0.278580814717477, "computeRatioMax": 0.4191852825229961, "endMs": "1665777847059", "id": "20", "inputStages": [ "13", "0", "19", "12" ], "name": "S14: Join+", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.017082785808147174, "readRatioMax": 0.02102496714848883, "recordsRead": "1896833", "recordsWritten": "7125", "shuffleOutputBytes": "270462", "shuffleOutputBytesSpilled": "0", "slotMs": "1053", "startMs": "1665777846783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_item_sk, $132:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $321", "$210 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $310, $321 := $311", "SEMI HASH JOIN EACH WITH ALL ON $312 = $80" ] }, { "kind": "JOIN", "substeps": [ "$310 := $301, $311 := $302, $312 := $71", "INNER HASH JOIN EACH WITH ALL ON $300 = $70" ] }, { "kind": "JOIN", "substeps": [ "$300 := $130, $301 := $132, $302 := $141", "INNER HASH JOIN EACH WITH ALL ON $131 = $140" ] }, { "kind": "WRITE", "substeps": [ "$330, $210", "TO __stage14_output", "BY HASH($330)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.002628120893561104, "waitRatioMax": 0.003942181340341655, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.006570302233902759, "writeRatioMax": 0.009198423127463863 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.026281208935611037, "computeRatioMax": 0.026281208935611037, "endMs": "1665777847273", "id": "21", "inputStages": [ "18" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777847236", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.01576872536136662, "writeRatioMax": 0.01576872536136662 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.01576872536136662, "computeRatioMax": 0.01576872536136662, "endMs": "1665777847293", "id": "22", "inputStages": [ "20" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7125", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777847254", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $210", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $340", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002628120893561104, "waitRatioMax": 0.002628120893561104, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.035479632063074903, "writeRatioMax": 0.035479632063074903 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.010512483574244415, "computeRatioMax": 0.01971090670170828, "endMs": "1665777847387", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5169", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "4634", "startMs": "1665777847310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "10", "waitRatioAvg": 0.003942181340341655, "waitRatioMax": 0.013140604467805518, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.01971090670170828, "writeRatioMax": 0.035479632063074903 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.010512483574244415, "computeRatioMax": 0.01971090670170828, "endMs": "1665777847388", "id": "25", "inputStages": [ "21" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "4314", "startMs": "1665777847311", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.013140604467805518, "waitRatioMax": 0.01576872536136662, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.01971090670170828, "writeRatioMax": 0.02759526938239159 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.051248357424441525, "computeRatioMax": 0.051248357424441525, "endMs": "1665777847407", "id": "26", "inputStages": [ "24", "25", "16" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26164", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "132", "startMs": "1665777847323", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $200", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$180, $340", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide($422, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$151 := multiply(divide($423, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$152 := multiply(divide($421, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$153 := divide(add(add($422, $423), $421), NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "and(between($411, multiply(NUMERIC<...>, $413), multiply(NUMERIC<...>, $413)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$410 := $350, $411 := $351, $412 := $352, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $350 = $400" ] }, { "kind": "FILTER", "substeps": [ "and(between($351, multiply(NUMERIC<...>, $352), multiply(NUMERIC<...>, $352)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $290, $351 := $170, $352 := $180", "INNER HASH JOIN EACH WITH ALL ON $290 = $340" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1A_output" ] } ], "waitMsAvg": "12", "waitMsMax": "12", "waitRatioAvg": 0.01576872536136662, "waitRatioMax": 0.01576872536136662, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.003942181340341655, "writeRatioMax": 0.003942181340341655 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.011826544021024968, "computeRatioMax": 0.011826544021024968, "endMs": "1665777847419", "id": "27", "inputStages": [ "26" ], "name": "S1B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777847327", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1A_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002628120893561104, "waitRatioMax": 0.002628120893561104, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.006570302233902759, "writeRatioMax": 0.006570302233902759 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "11", "completedUnits": "315", "elapsedMs": "607", "estimatedRunnableUnits": "0", "pendingUnits": "9", "totalSlotMs": "12538" }, { "activeUnits": "2", "completedUnits": "528", "elapsedMs": "1179", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "24439" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "160240776", "totalPartitionsProcessed": "0", "totalSlotMs": "24439", "transferredBytes": "0" }, "startTime": "1665777846299", "totalBytesProcessed": "160240776", "totalSlotMs": "24439" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonaee19105_5f80_4b61_b15f_31e18c059702" }, "priority": "INTERACTIVE", "query": "-- start query 58 in stream 0 using template query58.tpl\nwith ss_items as\n (select i_item_id item_id\n ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n ,item\n ,date_dim\n where ss_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ss_sold_date_sk = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n ,sum(cs_ext_sales_price) cs_item_rev\n from catalog_sales\n ,item\n ,date_dim\n where cs_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n ,sum(ws_ext_sales_price) ws_item_rev\n from web_sales\n ,item\n ,date_dim\n where ws_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq =(select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ws_sold_date_sk = d_date_sk\n group by i_item_id)\n select ss_items.item_id\n ,ss_item_rev\n ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ss_dev\n ,cs_item_rev\n ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cs_dev\n ,ws_item_rev\n ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ws_dev\n ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n and ss_items.item_id=ws_items.item_id \n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n order by item_id\n ,ss_item_rev\n limit 100\n ;\n\n-- end query 58 in stream 0 using template query58.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "puGRUgK0QGhF+M1wVTVarQ==", "id": "test-project-364309:europe-west1.query58_1665777848", "jobReference": { "jobId": "query58_1665777848", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query58_1665777848?location=europe-west1", "statistics": { "creationTime": "1665777849195", "endTime": "1665777850407", "finalExecutionDurationMs": "975", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "160240776", "performanceInsights": { "avgPreviousExecutionMs": "952" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02247191011235955, "computeRatioMax": 0.02247191011235955, "endMs": "1665777849394", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017977528089887642, "readRatioMax": 0.017977528089887642, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777849346", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$121:d_week_seq, $120:d_date", "FROM date_dim", "WHERE equal($120, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($121)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.0696629213483146, "writeRatioMax": 0.0696629213483146 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02696629213483146, "computeRatioMax": 0.02696629213483146, "endMs": "1665777849381", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.020224719101123594, "readRatioMax": 0.020224719101123594, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777849348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91:d_week_seq, $90:d_date", "FROM date_dim", "WHERE equal($90, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_AND_CHECK($91)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0044943820224719105, "waitRatioMax": 0.0044943820224719105, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008988764044943821, "writeRatioMax": 0.008988764044943821 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.029213483146067417, "computeRatioMax": 0.029213483146067417, "endMs": "1665777849389", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017977528089887642, "readRatioMax": 0.017977528089887642, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777849348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$21:d_week_seq, $20:d_date", "FROM date_dim", "WHERE equal($20, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($21)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0044943820224719105, "waitRatioMax": 0.0044943820224719105, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.024719101123595506, "writeRatioMax": 0.024719101123595506 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.04719101123595506, "computeRatioMax": 0.04719101123595506, "endMs": "1665777849452", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017977528089887642, "readRatioMax": 0.017977528089887642, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777849415", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60:d_date, $61:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($61, $230)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.020224719101123594, "writeRatioMax": 0.020224719101123594 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.0853932584269663, "computeRatioMax": 0.0853932584269663, "endMs": "1665777849471", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017977528089887642, "readRatioMax": 0.017977528089887642, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777849428", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02696629213483146, "writeRatioMax": 0.02696629213483146 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04044943820224719, "computeRatioMax": 0.04044943820224719, "endMs": "1665777849483", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011235955056179775, "readRatioMax": 0.011235955056179775, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777849440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:i_item_sk, $111:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.060674157303370786, "writeRatioMax": 0.060674157303370786 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04044943820224719, "computeRatioMax": 0.04044943820224719, "endMs": "1665777849516", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011235955056179775, "readRatioMax": 0.011235955056179775, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777849476", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($11, $220)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.020224719101123594, "writeRatioMax": 0.020224719101123594 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.0853932584269663, "computeRatioMax": 0.0853932584269663, "endMs": "1665777849529", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01348314606741573, "readRatioMax": 0.01348314606741573, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777849490", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.020224719101123594, "writeRatioMax": 0.020224719101123594 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.05393258426966292, "computeRatioMax": 0.05393258426966292, "endMs": "1665777849550", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01348314606741573, "readRatioMax": 0.01348314606741573, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777849507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.05393258426966292, "writeRatioMax": 0.05393258426966292 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.056179775280898875, "computeRatioMax": 0.056179775280898875, "endMs": "1665777849582", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03146067415730337, "readRatioMax": 0.03146067415730337, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777849541", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$80:d_date, $81:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($81, $240)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02247191011235955, "writeRatioMax": 0.02247191011235955 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.08314606741573034, "computeRatioMax": 0.08314606741573034, "endMs": "1665777849605", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02247191011235955, "readRatioMax": 0.02247191011235955, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777849555", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04044943820224719, "writeRatioMax": 0.04044943820224719 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04044943820224719, "computeRatioMax": 0.04044943820224719, "endMs": "1665777849625", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01348314606741573, "readRatioMax": 0.01348314606741573, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777849571", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:i_item_sk, $141:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0044943820224719105, "waitRatioMax": 0.0044943820224719105, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.05393258426966292, "writeRatioMax": 0.05393258426966292 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.017977528089887642, "computeRatioMax": 0.029213483146067417, "endMs": "1665777849645", "id": "15", "inputStages": [ "3" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3989", "startMs": "1665777849586", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.006741573033707865, "waitRatioMax": 0.008988764044943821, "writeMsAvg": "22", "writeMsMax": "31", "writeRatioAvg": 0.04943820224719101, "writeRatioMax": 0.0696629213483146 }, { "completedParallelInputs": "6", "computeMsAvg": "283", "computeMsMax": "357", "computeRatioAvg": 0.6359550561797753, "computeRatioMax": 0.802247191011236, "endMs": "1665777850009", "id": "16", "inputStages": [ "15", "4", "5", "1" ], "name": "S10: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.03146067415730337, "readRatioMax": 0.035955056179775284, "recordsRead": "3426746", "recordsWritten": "16678", "shuffleOutputBytes": "629076", "shuffleOutputBytesSpilled": "0", "slotMs": "1784", "startMs": "1665777849591", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$200 := SUM($270)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $260, $271 := $261", "SEMI HASH JOIN EACH WITH ALL ON $262 = $60" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $51", "INNER HASH JOIN EACH WITH ALL ON $250 = $50" ] }, { "kind": "JOIN", "substeps": [ "$250 := $100, $251 := $102, $252 := $111", "INNER HASH JOIN EACH WITH ALL ON $101 = $110" ] }, { "kind": "WRITE", "substeps": [ "$280, $200", "TO __stage10_output", "BY HASH($280)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.006741573033707865, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.008988764044943821, "writeRatioMax": 0.01348314606741573 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.017977528089887642, "computeRatioMax": 0.04044943820224719, "endMs": "1665777849650", "id": "17", "inputStages": [ "7" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3932", "startMs": "1665777849594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0044943820224719105, "writeMsAvg": "21", "writeMsMax": "31", "writeRatioAvg": 0.04719101123595506, "writeRatioMax": 0.0696629213483146 }, { "completedParallelInputs": "1", "computeMsAvg": "445", "computeMsMax": "445", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777849953", "id": "18", "inputStages": [ "9", "17", "2", "8" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.029213483146067417, "readRatioMax": 0.029213483146067417, "recordsRead": "810441", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "402", "startMs": "1665777849607", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $370, $381 := $371", "SEMI HASH JOIN EACH WITH ALL ON $372 = $10" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $2", "INNER HASH JOIN EACH WITH ALL ON $360 = $1" ] }, { "kind": "JOIN", "substeps": [ "$360 := $30, $361 := $32, $362 := $41", "INNER HASH JOIN EACH WITH ALL ON $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage12_output", "BY HASH($390)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0044943820224719105, "waitRatioMax": 0.0044943820224719105, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.011235955056179775, "writeRatioMax": 0.011235955056179775 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.017977528089887642, "computeRatioMax": 0.033707865168539325, "endMs": "1665777849706", "id": "19", "inputStages": [ "11" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3561", "startMs": "1665777849639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0044943820224719105, "waitRatioMax": 0.006741573033707865, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.03146067415730337, "writeRatioMax": 0.058426966292134834 }, { "completedParallelInputs": "5", "computeMsAvg": "245", "computeMsMax": "326", "computeRatioAvg": 0.550561797752809, "computeRatioMax": 0.7325842696629213, "endMs": "1665777849960", "id": "20", "inputStages": [ "13", "19", "0", "12" ], "name": "S14: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.03146067415730337, "readRatioMax": 0.035955056179775284, "recordsRead": "1896833", "recordsWritten": "7125", "shuffleOutputBytes": "270462", "shuffleOutputBytesSpilled": "0", "slotMs": "1184", "startMs": "1665777849646", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_item_sk, $132:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $321", "$210 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $310, $321 := $311", "SEMI HASH JOIN EACH WITH ALL ON $312 = $80" ] }, { "kind": "JOIN", "substeps": [ "$310 := $301, $311 := $302, $312 := $71", "INNER HASH JOIN EACH WITH ALL ON $300 = $70" ] }, { "kind": "JOIN", "substeps": [ "$300 := $130, $301 := $132, $302 := $141", "INNER HASH JOIN EACH WITH ALL ON $131 = $140" ] }, { "kind": "WRITE", "substeps": [ "$330, $210", "TO __stage14_output", "BY HASH($330)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.006741573033707865, "waitRatioMax": 0.008988764044943821, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.008988764044943821, "writeRatioMax": 0.01348314606741573 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04044943820224719, "computeRatioMax": 0.04044943820224719, "endMs": "1665777850079", "id": "21", "inputStages": [ "18" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777850038", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02696629213483146, "writeRatioMax": 0.02696629213483146 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.04943820224719101, "computeRatioMax": 0.04943820224719101, "endMs": "1665777850094", "id": "22", "inputStages": [ "20" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7125", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777850054", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $210", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $340", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.0022471910112359553, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03146067415730337, "writeRatioMax": 0.03146067415730337 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "23", "computeRatioAvg": 0.017977528089887642, "computeRatioMax": 0.051685393258426963, "endMs": "1665777850159", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5169", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "3478", "startMs": "1665777850106", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.0022471910112359553, "waitRatioMax": 0.008988764044943821, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.03146067415730337, "writeRatioMax": 0.04269662921348315 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.017977528089887642, "computeRatioMax": 0.033707865168539325, "endMs": "1665777850163", "id": "25", "inputStages": [ "21" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "3389", "startMs": "1665777850107", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.008988764044943821, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.03146067415730337, "writeRatioMax": 0.04943820224719101 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.0651685393258427, "computeRatioMax": 0.0651685393258427, "endMs": "1665777850274", "id": "26", "inputStages": [ "24", "25", "16" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26164", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "130", "startMs": "1665777850114", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $200", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$180, $340", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide($422, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$151 := multiply(divide($423, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$152 := multiply(divide($421, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$153 := divide(add(add($422, $423), $421), NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "and(between($411, multiply(NUMERIC<...>, $413), multiply(NUMERIC<...>, $413)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$410 := $350, $411 := $351, $412 := $352, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $350 = $400" ] }, { "kind": "FILTER", "substeps": [ "and(between($351, multiply(NUMERIC<...>, $352), multiply(NUMERIC<...>, $352)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $290, $351 := $170, $352 := $180", "INNER HASH JOIN EACH WITH ALL ON $290 = $340" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.008988764044943821, "waitRatioMax": 0.008988764044943821, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0022471910112359553, "writeRatioMax": 0.0022471910112359553 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.011235955056179775, "computeRatioMax": 0.011235955056179775, "endMs": "1665777850300", "id": "27", "inputStages": [ "26" ], "name": "S1B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665777850122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1A_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006741573033707865, "waitRatioMax": 0.006741573033707865, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.011235955056179775, "writeRatioMax": 0.011235955056179775 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "8", "completedUnits": "319", "elapsedMs": "597", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "14088" }, { "activeUnits": "8", "completedUnits": "528", "elapsedMs": "1091", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "22702" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "160240776", "totalPartitionsProcessed": "0", "totalSlotMs": "22702", "transferredBytes": "0" }, "startTime": "1665777849250", "totalBytesProcessed": "160240776", "totalSlotMs": "22702" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonceb7a66c_d956_4c64_8e37_494b2ca42483" }, "priority": "INTERACTIVE", "query": "-- start query 58 in stream 0 using template query58.tpl\nwith ss_items as\n (select i_item_id item_id\n ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n ,item\n ,date_dim\n where ss_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ss_sold_date_sk = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n ,sum(cs_ext_sales_price) cs_item_rev\n from catalog_sales\n ,item\n ,date_dim\n where cs_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq = (select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n ,sum(ws_ext_sales_price) ws_item_rev\n from web_sales\n ,item\n ,date_dim\n where ws_item_sk = i_item_sk\n and d_date in (select d_date\n from date_dim\n where d_week_seq =(select d_week_seq \n from date_dim\n where d_date = '2000-01-03'))\n and ws_sold_date_sk = d_date_sk\n group by i_item_id)\n select ss_items.item_id\n ,ss_item_rev\n ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ss_dev\n ,cs_item_rev\n ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cs_dev\n ,ws_item_rev\n ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 ws_dev\n ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n and ss_items.item_id=ws_items.item_id \n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n and ss_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and cs_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ws_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp ss_item_rev\n and ws_item_rev between 0.9 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev and 1.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp cs_item_rev\n order by item_id\n ,ss_item_rev\n limit 100\n ;\n\n-- end query 58 in stream 0 using template query58.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "oTJSVcwPrE2RWK73c3NDSg==", "id": "test-project-364309:europe-west1.query58_1665777851", "jobReference": { "jobId": "query58_1665777851", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query58_1665777851?location=europe-west1", "statistics": { "creationTime": "1665777852007", "endTime": "1665777853197", "finalExecutionDurationMs": "955", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "160240776", "performanceInsights": { "avgPreviousExecutionMs": "954" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01045751633986928, "computeRatioMax": 0.01045751633986928, "endMs": "1665777852193", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006535947712418301, "readRatioMax": 0.006535947712418301, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777852167", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$121:d_week_seq, $120:d_date", "FROM date_dim", "WHERE equal($120, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$240 := ANY_AND_CHECK($121)" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01699346405228758, "writeRatioMax": 0.01699346405228758 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01699346405228758, "computeRatioMax": 0.01699346405228758, "endMs": "1665777852221", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009150326797385621, "readRatioMax": 0.009150326797385621, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777852173", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$91:d_week_seq, $90:d_date", "FROM date_dim", "WHERE equal($90, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_AND_CHECK($91)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00261437908496732, "waitRatioMax": 0.00261437908496732, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02483660130718954, "writeRatioMax": 0.02483660130718954 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.011764705882352941, "computeRatioMax": 0.011764705882352941, "endMs": "1665777852198", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00784313725490196, "readRatioMax": 0.00784313725490196, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777852170", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$21:d_week_seq, $20:d_date", "FROM date_dim", "WHERE equal($20, 10959)" ] }, { "kind": "AGGREGATE", "substeps": [ "$220 := ANY_AND_CHECK($21)" ] }, { "kind": "WRITE", "substeps": [ "$220", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00261437908496732, "waitRatioMax": 0.00261437908496732, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0196078431372549, "writeRatioMax": 0.0196078431372549 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.023529411764705882, "computeRatioMax": 0.023529411764705882, "endMs": "1665777852246", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006535947712418301, "readRatioMax": 0.006535947712418301, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777852218", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$80:d_date, $81:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($81, $240)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01437908496732026, "writeRatioMax": 0.01437908496732026 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.04183006535947712, "computeRatioMax": 0.04183006535947712, "endMs": "1665777852268", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009150326797385621, "readRatioMax": 0.009150326797385621, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777852231", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01437908496732026, "writeRatioMax": 0.01437908496732026 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.02091503267973856, "computeRatioMax": 0.02091503267973856, "endMs": "1665777852297", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009150326797385621, "readRatioMax": 0.009150326797385621, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777852247", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:i_item_sk, $141:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02483660130718954, "writeRatioMax": 0.02483660130718954 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.022222222222222223, "endMs": "1665777852322", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006535947712418301, "readRatioMax": 0.006535947712418301, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777852284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($11, $220)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.009150326797385621, "writeRatioMax": 0.009150326797385621 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.06666666666666667, "computeRatioMax": 0.06666666666666667, "endMs": "1665777852346", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009150326797385621, "readRatioMax": 0.009150326797385621, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777852299", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.01568627450980392, "writeRatioMax": 0.01568627450980392 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.02091503267973856, "computeRatioMax": 0.02091503267973856, "endMs": "1665777852375", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006535947712418301, "readRatioMax": 0.006535947712418301, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665777852315", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.0392156862745098, "writeRatioMax": 0.0392156862745098 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0196078431372549, "computeRatioMax": 0.0196078431372549, "endMs": "1665777852388", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.00522875816993464, "readRatioMax": 0.00522875816993464, "recordsRead": "73050", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777852353", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60:d_date, $61:d_week_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($61, $230)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.01045751633986928, "writeRatioMax": 0.01045751633986928 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.040522875816993466, "computeRatioMax": 0.040522875816993466, "endMs": "1665777852405", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.01045751633986928, "readRatioMax": 0.01045751633986928, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777852368", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00261437908496732, "waitRatioMax": 0.00261437908496732, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.013071895424836602, "writeRatioMax": 0.013071895424836602 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.02091503267973856, "computeRatioMax": 0.02091503267973856, "endMs": "1665777852437", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00784313725490196, "readRatioMax": 0.00784313725490196, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665777852383", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:i_item_sk, $111:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.03398692810457516, "writeRatioMax": 0.03398692810457516 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.01045751633986928, "computeRatioMax": 0.023529411764705882, "endMs": "1665777852466", "id": "15", "inputStages": [ "3" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3530", "startMs": "1665777852400", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.00784313725490196, "waitRatioMax": 0.01045751633986928, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.0196078431372549, "writeRatioMax": 0.036601307189542485 }, { "completedParallelInputs": "5", "computeMsAvg": "187", "computeMsMax": "220", "computeRatioAvg": 0.24444444444444444, "computeRatioMax": 0.2875816993464052, "endMs": "1665777852614", "id": "16", "inputStages": [ "15", "5", "4", "0" ], "name": "S10: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.018300653594771243, "readRatioMax": 0.02483660130718954, "recordsRead": "1896833", "recordsWritten": "7125", "shuffleOutputBytes": "270462", "shuffleOutputBytesSpilled": "0", "slotMs": "887", "startMs": "1665777852411", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240", "FROM __stage00_output" ] }, { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_item_sk, $132:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $321", "$210 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $310, $321 := $311", "SEMI HASH JOIN EACH WITH ALL ON $312 = $80" ] }, { "kind": "JOIN", "substeps": [ "$310 := $301, $311 := $302, $312 := $71", "INNER HASH JOIN EACH WITH ALL ON $300 = $70" ] }, { "kind": "JOIN", "substeps": [ "$300 := $130, $301 := $132, $302 := $141", "INNER HASH JOIN EACH WITH ALL ON $131 = $140" ] }, { "kind": "WRITE", "substeps": [ "$330, $210", "TO __stage10_output", "BY HASH($330)" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.00522875816993464, "waitRatioMax": 0.006535947712418301, "writeMsAvg": "3", "writeMsMax": "5", "writeRatioAvg": 0.00392156862745098, "writeRatioMax": 0.006535947712418301 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.011764705882352941, "computeRatioMax": 0.02483660130718954, "endMs": "1665777852475", "id": "17", "inputStages": [ "7" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3877", "startMs": "1665777852413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.00522875816993464, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "18", "writeMsMax": "34", "writeRatioAvg": 0.023529411764705882, "writeRatioMax": 0.044444444444444446 }, { "completedParallelInputs": "1", "computeMsAvg": "765", "computeMsMax": "765", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777852916", "id": "18", "inputStages": [ "2", "9", "8", "17" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.022222222222222223, "readRatioMax": 0.022222222222222223, "recordsRead": "810441", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "775", "startMs": "1665777852425", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $370, $381 := $371", "SEMI HASH JOIN EACH WITH ALL ON $372 = $10" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $2", "INNER HASH JOIN EACH WITH ALL ON $360 = $1" ] }, { "kind": "JOIN", "substeps": [ "$360 := $30, $361 := $32, $362 := $41", "INNER HASH JOIN EACH WITH ALL ON $31 = $40" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage12_output", "BY HASH($390)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.011764705882352941, "writeRatioMax": 0.011764705882352941 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.009150326797385621, "computeRatioMax": 0.02091503267973856, "endMs": "1665777852505", "id": "19", "inputStages": [ "11" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "7", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3193", "startMs": "1665777852451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.00522875816993464, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "13", "writeMsMax": "32", "writeRatioAvg": 0.01699346405228758, "writeRatioMax": 0.04183006535947712 }, { "completedParallelInputs": "6", "computeMsAvg": "388", "computeMsMax": "524", "computeRatioAvg": 0.5071895424836601, "computeRatioMax": 0.6849673202614379, "endMs": "1665777852799", "id": "20", "inputStages": [ "19", "12", "1", "13" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "19", "readRatioAvg": 0.0196078431372549, "readRatioMax": 0.02483660130718954, "recordsRead": "3426746", "recordsWritten": "16678", "shuffleOutputBytes": "629076", "shuffleOutputBytesSpilled": "0", "slotMs": "2474", "startMs": "1665777852464", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$200 := SUM($270)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $260, $271 := $261", "SEMI HASH JOIN EACH WITH ALL ON $262 = $60" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $51", "INNER HASH JOIN EACH WITH ALL ON $250 = $50" ] }, { "kind": "JOIN", "substeps": [ "$250 := $100, $251 := $102, $252 := $111", "INNER HASH JOIN EACH WITH ALL ON $101 = $110" ] }, { "kind": "WRITE", "substeps": [ "$280, $200", "TO __stage14_output", "BY HASH($280)" ] } ], "waitMsAvg": "0", "waitMsMax": "2", "waitRatioAvg": 0, "waitRatioMax": 0.00261437908496732, "writeMsAvg": "5", "writeMsMax": "9", "writeRatioAvg": 0.006535947712418301, "writeRatioMax": 0.011764705882352941 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01699346405228758, "computeRatioMax": 0.01699346405228758, "endMs": "1665777852996", "id": "21", "inputStages": [ "18" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777852958", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02091503267973856, "writeRatioMax": 0.02091503267973856 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0196078431372549, "computeRatioMax": 0.0196078431372549, "endMs": "1665777853007", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7125", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777852970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $210", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $340", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01699346405228758, "writeRatioMax": 0.01699346405228758 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.01045751633986928, "computeRatioMax": 0.02091503267973856, "endMs": "1665777853069", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5169", "recordsWritten": "5169", "shuffleOutputBytes": "196262", "shuffleOutputBytesSpilled": "0", "slotMs": "3236", "startMs": "1665777853020", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.011764705882352941, "writeMsAvg": "12", "writeMsMax": "20", "writeRatioAvg": 0.01568627450980392, "writeRatioMax": 0.026143790849673203 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.009150326797385621, "computeRatioMax": 0.018300653594771243, "endMs": "1665777853069", "id": "25", "inputStages": [ "21" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4317", "recordsWritten": "4317", "shuffleOutputBytes": "164046", "shuffleOutputBytesSpilled": "0", "slotMs": "2420", "startMs": "1665777853021", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.011764705882352941, "waitRatioMax": 0.01437908496732026, "writeMsAvg": "4", "writeMsMax": "18", "writeRatioAvg": 0.00522875816993464, "writeRatioMax": 0.023529411764705882 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.032679738562091505, "computeRatioMax": 0.032679738562091505, "endMs": "1665777853089", "id": "26", "inputStages": [ "20", "25", "24" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26164", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777853035", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $200", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$180, $340", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide($422, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$151 := multiply(divide($423, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$152 := multiply(divide($421, divide(add(add($422, $423), $421), NUMERIC<...>)), NUMERIC<...>)", "$153 := divide(add(add($422, $423), $421), NUMERIC<...>)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "and(between($411, multiply(NUMERIC<...>, $413), multiply(NUMERIC<...>, $413)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$410 := $350, $411 := $351, $412 := $352, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $350 = $400" ] }, { "kind": "FILTER", "substeps": [ "and(between($351, multiply(NUMERIC<...>, $352), multiply(NUMERIC<...>, $352)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $290, $351 := $170, $352 := $180", "INNER HASH JOIN EACH WITH ALL ON $290 = $340" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1A_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.013071895424836602, "waitRatioMax": 0.013071895424836602, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009150326797385621, "computeRatioMax": 0.009150326797385621, "endMs": "1665777853095", "id": "27", "inputStages": [ "26" ], "name": "S1B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3", "recordsWritten": "3", "shuffleOutputBytes": "420", "shuffleOutputBytesSpilled": "0", "slotMs": "97", "startMs": "1665777853042", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1A_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.00522875816993464, "writeRatioMax": 0.00522875816993464 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "318", "elapsedMs": "612", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "12883" }, { "activeUnits": "6", "completedUnits": "528", "elapsedMs": "1093", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "21124" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "160240776", "totalPartitionsProcessed": "0", "totalSlotMs": "21124", "transferredBytes": "0" }, "startTime": "1665777852056", "totalBytesProcessed": "160240776", "totalSlotMs": "21124" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
