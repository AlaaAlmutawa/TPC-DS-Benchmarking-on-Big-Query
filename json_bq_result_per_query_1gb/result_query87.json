{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoneef76db6_8063_4de0_825d_da4eece22437" }, "priority": "INTERACTIVE", "query": "-- start query 87 in stream 0 using template query87.tpl\n\n/*\nCount how many customers have ordered on the same day items on the web and the catalog \nand on the same day have bought items in a store.\n*/\n\nselect count(*) \nfrom ((select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n) cool_cust\n;\n\n-- end query 87 in stream 0 using template query87.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "B/BDv6zL9T4k+CdLwjBTPA==", "id": "test-project-364309:europe-west1.query87_1665768501", "jobReference": { "jobId": "query87_1665768501", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query87_1665768501?location=europe-west1", "statistics": { "creationTime": "1665768502326", "endTime": "1665768503408", "finalExecutionDurationMs": "850", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "949" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "64", "computeMsMax": "64", "computeRatioAvg": 0.18604651162790697, "computeRatioMax": 0.18604651162790697, "endMs": "1665768502572", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.023255813953488372, "readRatioMax": 0.023255813953488372, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "76", "startMs": "1665768502499", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03488372093023256, "writeRatioMax": 0.03488372093023256 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0377906976744186, "computeRatioMax": 0.0377906976744186, "endMs": "1665768502547", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01744186046511628, "readRatioMax": 0.01744186046511628, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768502519", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0436046511627907, "writeRatioMax": 0.0436046511627907 }, { "completedParallelInputs": "1", "computeMsAvg": "114", "computeMsMax": "114", "computeRatioAvg": 0.3313953488372093, "computeRatioMax": 0.3313953488372093, "endMs": "1665768502651", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02616279069767442, "readRatioMax": 0.02616279069767442, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "111", "startMs": "1665768502545", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03488372093023256, "writeRatioMax": 0.03488372093023256 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.029069767441860465, "computeRatioMax": 0.029069767441860465, "endMs": "1665768502595", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01744186046511628, "readRatioMax": 0.01744186046511628, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768502560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.020348837209302327, "writeRatioMax": 0.020348837209302327 }, { "completedParallelInputs": "1", "computeMsAvg": "106", "computeMsMax": "106", "computeRatioAvg": 0.3081395348837209, "computeRatioMax": 0.3081395348837209, "endMs": "1665768502693", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.03488372093023256, "readRatioMax": 0.03488372093023256, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "136", "startMs": "1665768502588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.040697674418604654, "writeRatioMax": 0.040697674418604654 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0436046511627907, "computeRatioMax": 0.0436046511627907, "endMs": "1665768502633", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.023255813953488372, "readRatioMax": 0.023255813953488372, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768502604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.029069767441860465, "writeRatioMax": 0.029069767441860465 }, { "completedParallelInputs": "5", "computeMsAvg": "216", "computeMsMax": "251", "computeRatioAvg": 0.627906976744186, "computeRatioMax": 0.7296511627906976, "endMs": "1665768502798", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "13", "readRatioAvg": 0.03197674418604651, "readRatioMax": 0.0377906976744186, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "938", "startMs": "1665768502634", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.01744186046511628, "writeRatioMax": 0.020348837209302327 }, { "completedParallelInputs": "6", "computeMsAvg": "270", "computeMsMax": "344", "computeRatioAvg": 0.7848837209302325, "computeRatioMax": 1, "endMs": "1665768502897", "id": "13", "inputStages": [ "4", "3" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.03197674418604651, "readRatioMax": 0.0436046511627907, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1379", "startMs": "1665768502691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0D_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.01744186046511628, "writeRatioMax": 0.020348837209302327 }, { "completedParallelInputs": "1", "computeMsAvg": "183", "computeMsMax": "183", "computeRatioAvg": 0.5319767441860465, "computeRatioMax": 0.5319767441860465, "endMs": "1665768502877", "id": "14", "inputStages": [ "6", "7" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.020348837209302327, "readRatioMax": 0.020348837209302327, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "193", "startMs": "1665768502724", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.055232558139534885, "writeRatioMax": 0.055232558139534885 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.10174418604651163, "computeRatioMax": 0.10174418604651163, "endMs": "1665768502976", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768502935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.055232558139534885, "writeRatioMax": 0.055232558139534885 }, { "completedParallelInputs": "1", "computeMsAvg": "133", "computeMsMax": "133", "computeRatioAvg": 0.3866279069767442, "computeRatioMax": 0.3866279069767442, "endMs": "1665768503039", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "127", "startMs": "1665768502950", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.06686046511627906, "writeRatioMax": 0.06686046511627906 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.023255813953488372, "computeRatioMax": 0.040697674418604654, "endMs": "1665768503106", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3225", "startMs": "1665768503056", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.011627906976744186, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.0436046511627907, "writeRatioMax": 0.061046511627906974 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.02616279069767442, "computeRatioMax": 0.05232558139534884, "endMs": "1665768503149", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "5606", "startMs": "1665768503056", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "8", "waitRatioAvg": 0.011627906976744186, "waitRatioMax": 0.023255813953488372, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.040697674418604654, "writeRatioMax": 0.055232558139534885 }, { "completedParallelInputs": "1", "computeMsAvg": "169", "computeMsMax": "169", "computeRatioAvg": 0.49127906976744184, "computeRatioMax": 0.49127906976744184, "endMs": "1665768503258", "id": "19", "inputStages": [ "18", "13", "17" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "47298", "shuffleOutputBytes": "1257512", "shuffleOutputBytesSpilled": "0", "slotMs": "146", "startMs": "1665768503070", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "ANTI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "ANTI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.011627906976744186, "waitRatioMax": 0.011627906976744186, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01744186046511628, "writeRatioMax": 0.01744186046511628 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.0872093023255814, "computeRatioMax": 0.0872093023255814, "endMs": "1665768503301", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "47298", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768503261", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.00872093023255814, "writeRatioMax": 0.00872093023255814 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.014534883720930232, "computeRatioMax": 0.014534883720930232, "endMs": "1665768503316", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768503274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029069767441860465, "waitRatioMax": 0.0029069767441860465, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01744186046511628, "writeRatioMax": 0.01744186046511628 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "19", "elapsedMs": "615", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3151" }, { "activeUnits": "1", "completedUnits": "223", "elapsedMs": "964", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12333" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "12333", "transferredBytes": "0" }, "startTime": "1665768502386", "totalBytesProcessed": "82559911", "totalSlotMs": "12333" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona81a46ff_0dc2_4fd0_bcb9_5bae2d2ae742" }, "priority": "INTERACTIVE", "query": "-- start query 87 in stream 0 using template query87.tpl\n\n/*\nCount how many customers have ordered on the same day items on the web and the catalog \nand on the same day have bought items in a store.\n*/\n\nselect count(*) \nfrom ((select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n) cool_cust\n;\n\n-- end query 87 in stream 0 using template query87.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "WEBq9pugKXzEzgOlXt4ROg==", "id": "test-project-364309:europe-west1.query87_1665778741", "jobReference": { "jobId": "query87_1665778741", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query87_1665778741?location=europe-west1", "statistics": { "creationTime": "1665778742610", "endTime": "1665778743732", "finalExecutionDurationMs": "923", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "924" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.3707482993197279, "computeRatioMax": 0.3707482993197279, "endMs": "1665778742891", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.05782312925170068, "readRatioMax": 0.05782312925170068, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "163", "startMs": "1665778742761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.06802721088435375, "writeRatioMax": 0.06802721088435375 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03741496598639456, "computeRatioMax": 0.03741496598639456, "endMs": "1665778742812", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.023809523809523808, "readRatioMax": 0.023809523809523808, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778742777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.023809523809523808 }, { "completedParallelInputs": "1", "computeMsAvg": "107", "computeMsMax": "107", "computeRatioAvg": 0.36394557823129253, "computeRatioMax": 0.36394557823129253, "endMs": "1665778743010", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.034013605442176874, "readRatioMax": 0.034013605442176874, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "156", "startMs": "1665778742892", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "76", "waitMsMax": "76", "waitRatioAvg": 0.2585034013605442, "waitRatioMax": 0.2585034013605442, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.06462585034013606, "writeRatioMax": 0.06462585034013606 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.047619047619047616, "endMs": "1665778742937", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.027210884353741496, "readRatioMax": 0.027210884353741496, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778742895", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "62", "waitMsMax": "62", "waitRatioAvg": 0.2108843537414966, "waitRatioMax": 0.2108843537414966, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04081632653061224, "writeRatioMax": 0.04081632653061224 }, { "completedParallelInputs": "1", "computeMsAvg": "112", "computeMsMax": "112", "computeRatioAvg": 0.38095238095238093, "computeRatioMax": 0.38095238095238093, "endMs": "1665778742992", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030612244897959183, "readRatioMax": 0.030612244897959183, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "98", "startMs": "1665778742894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "26", "waitMsMax": "26", "waitRatioAvg": 0.08843537414965986, "waitRatioMax": 0.08843537414965986, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03741496598639456, "writeRatioMax": 0.03741496598639456 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.023809523809523808, "computeRatioMax": 0.023809523809523808, "endMs": "1665778742934", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.017006802721088437, "readRatioMax": 0.017006802721088437, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778742894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.03741496598639456, "waitRatioMax": 0.03741496598639456, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05102040816326531, "writeRatioMax": 0.05102040816326531 }, { "completedParallelInputs": "5", "computeMsAvg": "190", "computeMsMax": "247", "computeRatioAvg": 0.6462585034013606, "computeRatioMax": 0.8401360544217688, "endMs": "1665778743066", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "8", "readMsMax": "9", "readRatioAvg": 0.027210884353741496, "readRatioMax": 0.030612244897959183, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "807", "startMs": "1665778742924", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.017006802721088437, "writeRatioMax": 0.017006802721088437 }, { "completedParallelInputs": "1", "computeMsAvg": "260", "computeMsMax": "260", "computeRatioAvg": 0.8843537414965986, "computeRatioMax": 0.8843537414965986, "endMs": "1665778743156", "id": "13", "inputStages": [ "7", "6" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02040816326530612, "readRatioMax": 0.02040816326530612, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "269", "startMs": "1665778743024", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0D_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.061224489795918366, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "6", "computeMsAvg": "257", "computeMsMax": "294", "computeRatioAvg": 0.8741496598639455, "computeRatioMax": 1, "endMs": "1665778743198", "id": "14", "inputStages": [ "4", "3" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "13", "readRatioAvg": 0.030612244897959183, "readRatioMax": 0.04421768707482993, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1389", "startMs": "1665778743029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0E_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006802721088435374, "waitRatioMax": 0.006802721088435374, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02040816326530612, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.1292517006802721, "computeRatioMax": 0.1292517006802721, "endMs": "1665778743257", "id": "15", "inputStages": [ "13" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665778743220", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.06462585034013606, "writeRatioMax": 0.06462585034013606 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.3707482993197279, "computeRatioMax": 0.3707482993197279, "endMs": "1665778743342", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "140", "startMs": "1665778743233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.08503401360544217, "writeRatioMax": 0.08503401360544217 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.027210884353741496, "computeRatioMax": 0.06462585034013606, "endMs": "1665778743399", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3616", "startMs": "1665778743348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.006802721088435374, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.05102040816326531, "writeRatioMax": 0.08503401360544217 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.027210884353741496, "computeRatioMax": 0.05442176870748299, "endMs": "1665778743399", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "2888", "startMs": "1665778743348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.017006802721088437, "writeMsAvg": "12", "writeMsMax": "27", "writeRatioAvg": 0.04081632653061224, "writeRatioMax": 0.09183673469387756 }, { "completedParallelInputs": "1", "computeMsAvg": "223", "computeMsMax": "223", "computeRatioAvg": 0.7585034013605442, "computeRatioMax": 0.7585034013605442, "endMs": "1665778743547", "id": "19", "inputStages": [ "17", "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "47298", "shuffleOutputBytes": "1257512", "shuffleOutputBytesSpilled": "0", "slotMs": "260", "startMs": "1665778743362", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "ANTI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "ANTI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013605442176870748, "writeRatioMax": 0.013605442176870748 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.15306122448979592, "computeRatioMax": 0.15306122448979592, "endMs": "1665778743632", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "47298", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778743603", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.006802721088435374, "writeRatioMax": 0.006802721088435374 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.034013605442176874, "computeRatioMax": 0.034013605442176874, "endMs": "1665778743650", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778743617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003401360544217687, "waitRatioMax": 0.003401360544217687, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.027210884353741496, "writeRatioMax": 0.027210884353741496 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "19", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3218" }, { "activeUnits": "1", "completedUnits": "223", "elapsedMs": "1020", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10171" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "10171", "transferredBytes": "0" }, "startTime": "1665778742667", "totalBytesProcessed": "82559911", "totalSlotMs": "10171" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7c45cecd_e2da_4176_80b6_65e45fee69bd" }, "priority": "INTERACTIVE", "query": "-- start query 87 in stream 0 using template query87.tpl\n\n/*\nCount how many customers have ordered on the same day items on the web and the catalog \nand on the same day have bought items in a store.\n*/\n\nselect count(*) \nfrom ((select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n) cool_cust\n;\n\n-- end query 87 in stream 0 using template query87.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "X3MQRxmf/Ffr4sS86KKsgA==", "id": "test-project-364309:europe-west1.query87_1665778745", "jobReference": { "jobId": "query87_1665778745", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query87_1665778745?location=europe-west1", "statistics": { "creationTime": "1665778746029", "endTime": "1665778747167", "finalExecutionDurationMs": "930", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "924" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "80", "computeMsMax": "80", "computeRatioAvg": 0.23738872403560832, "computeRatioMax": 0.23738872403560832, "endMs": "1665778746292", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.04451038575667656, "readRatioMax": 0.04451038575667656, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665778746189", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03560830860534125, "writeRatioMax": 0.03560830860534125 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.032640949554896145, "computeRatioMax": 0.032640949554896145, "endMs": "1665778746252", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.020771513353115726, "readRatioMax": 0.020771513353115726, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778746214", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.026706231454005934, "waitRatioMax": 0.026706231454005934, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.026706231454005934, "writeRatioMax": 0.026706231454005934 }, { "completedParallelInputs": "1", "computeMsAvg": "70", "computeMsMax": "70", "computeRatioAvg": 0.20771513353115728, "computeRatioMax": 0.20771513353115728, "endMs": "1665778746332", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.04154302670623145, "readRatioMax": 0.04154302670623145, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "117", "startMs": "1665778746234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005934718100890208, "waitRatioMax": 0.005934718100890208, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04154302670623145, "writeRatioMax": 0.04154302670623145 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.04154302670623145, "computeRatioMax": 0.04154302670623145, "endMs": "1665778746294", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02373887240356083, "readRatioMax": 0.02373887240356083, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778746250", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03857566765578635, "writeRatioMax": 0.03857566765578635 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.29080118694362017, "computeRatioMax": 0.29080118694362017, "endMs": "1665778746424", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.026706231454005934, "readRatioMax": 0.026706231454005934, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665778746330", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "38", "waitMsMax": "38", "waitRatioAvg": 0.11275964391691394, "waitRatioMax": 0.11275964391691394, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.032640949554896145, "writeRatioMax": 0.032640949554896145 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03560830860534125, "computeRatioMax": 0.03560830860534125, "endMs": "1665778746371", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.020771513353115726, "readRatioMax": 0.020771513353115726, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778746331", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "23", "waitMsMax": "23", "waitRatioAvg": 0.06824925816023739, "waitRatioMax": 0.06824925816023739, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03857566765578635, "writeRatioMax": 0.03857566765578635 }, { "completedParallelInputs": "5", "computeMsAvg": "201", "computeMsMax": "236", "computeRatioAvg": 0.5964391691394659, "computeRatioMax": 0.7002967359050445, "endMs": "1665778746525", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "13", "readRatioAvg": 0.03560830860534125, "readRatioMax": 0.03857566765578635, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "1031", "startMs": "1665778746343", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.020771513353115726, "writeRatioMax": 0.02373887240356083 }, { "completedParallelInputs": "6", "computeMsAvg": "281", "computeMsMax": "337", "computeRatioAvg": 0.8338278931750742, "computeRatioMax": 1, "endMs": "1665778746621", "id": "12", "inputStages": [ "4", "3" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "29", "readRatioAvg": 0.04154302670623145, "readRatioMax": 0.08605341246290801, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1707", "startMs": "1665778746366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0C_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "12", "writeMsMax": "30", "writeRatioAvg": 0.03560830860534125, "writeRatioMax": 0.08902077151335312 }, { "completedParallelInputs": "1", "computeMsAvg": "167", "computeMsMax": "167", "computeRatioAvg": 0.49554896142433236, "computeRatioMax": 0.49554896142433236, "endMs": "1665778746580", "id": "14", "inputStages": [ "6", "7" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.017804154302670624, "readRatioMax": 0.017804154302670624, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "172", "startMs": "1665778746444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005934718100890208, "waitRatioMax": 0.005934718100890208, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.06824925816023739, "writeRatioMax": 0.06824925816023739 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.0771513353115727, "computeRatioMax": 0.0771513353115727, "endMs": "1665778746695", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665778746640", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.06824925816023739, "writeRatioMax": 0.06824925816023739 }, { "completedParallelInputs": "1", "computeMsAvg": "81", "computeMsMax": "81", "computeRatioAvg": 0.2403560830860534, "computeRatioMax": 0.2403560830860534, "endMs": "1665778746731", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665778746658", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.0712166172106825, "writeRatioMax": 0.0712166172106825 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.026706231454005934, "computeRatioMax": 0.04451038575667656, "endMs": "1665778746813", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3943", "startMs": "1665778746750", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.011869436201780416, "waitRatioMax": 0.017804154302670624, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.04451038575667656, "writeRatioMax": 0.08011869436201781 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.02373887240356083, "computeRatioMax": 0.050445103857566766, "endMs": "1665778746808", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "3334", "startMs": "1665778746750", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.020771513353115726, "waitRatioMax": 0.02373887240356083, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.04451038575667656, "writeRatioMax": 0.08011869436201781 }, { "completedParallelInputs": "1", "computeMsAvg": "312", "computeMsMax": "312", "computeRatioAvg": 0.9258160237388724, "computeRatioMax": 0.9258160237388724, "endMs": "1665778746973", "id": "19", "inputStages": [ "12", "17", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "47298", "shuffleOutputBytes": "1257512", "shuffleOutputBytesSpilled": "0", "slotMs": "251", "startMs": "1665778746764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "ANTI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "ANTI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.01483679525222552, "waitRatioMax": 0.01483679525222552, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.017804154302670624, "writeRatioMax": 0.017804154302670624 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.11572700296735905, "computeRatioMax": 0.11572700296735905, "endMs": "1665778747057", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "47298", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778747023", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.008902077151335312, "writeRatioMax": 0.008902077151335312 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.020771513353115726, "computeRatioMax": 0.020771513353115726, "endMs": "1665778747080", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778747039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.017804154302670624, "writeRatioMax": 0.017804154302670624 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "18", "elapsedMs": "601", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3517" }, { "activeUnits": "2", "completedUnits": "223", "elapsedMs": "1034", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11274" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "11274", "transferredBytes": "0" }, "startTime": "1665778746090", "totalBytesProcessed": "82559911", "totalSlotMs": "11274" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1dd55645_cc78_455d_aebd_05a1af580f5e" }, "priority": "INTERACTIVE", "query": "-- start query 87 in stream 0 using template query87.tpl\n\n/*\nCount how many customers have ordered on the same day items on the web and the catalog \nand on the same day have bought items in a store.\n*/\n\nselect count(*) \nfrom ((select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n) cool_cust\n;\n\n-- end query 87 in stream 0 using template query87.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ihq00KKkLQmjRH5W0fhLVA==", "id": "test-project-364309:europe-west1.query87_1665778748", "jobReference": { "jobId": "query87_1665778748", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query87_1665778748?location=europe-west1", "statistics": { "creationTime": "1665778748755", "endTime": "1665778749862", "finalExecutionDurationMs": "888", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "925" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "75", "computeMsMax": "75", "computeRatioAvg": 0.21367521367521367, "computeRatioMax": 0.21367521367521367, "endMs": "1665778749008", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.019943019943019943, "readRatioMax": 0.019943019943019943, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665778748921", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002849002849002849, "waitRatioMax": 0.002849002849002849, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02564102564102564, "writeRatioMax": 0.02564102564102564 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.045584045584045586, "computeRatioMax": 0.045584045584045586, "endMs": "1665778748982", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.019943019943019943, "readRatioMax": 0.019943019943019943, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778748937", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005698005698005698, "waitRatioMax": 0.005698005698005698, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.019943019943019943, "writeRatioMax": 0.019943019943019943 }, { "completedParallelInputs": "1", "computeMsAvg": "94", "computeMsMax": "94", "computeRatioAvg": 0.2678062678062678, "computeRatioMax": 0.2678062678062678, "endMs": "1665778749070", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03133903133903134, "readRatioMax": 0.03133903133903134, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "121", "startMs": "1665778748969", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005698005698005698, "waitRatioMax": 0.005698005698005698, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02564102564102564, "writeRatioMax": 0.02564102564102564 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03418803418803419, "computeRatioMax": 0.03418803418803419, "endMs": "1665778749022", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.014245014245014245, "readRatioMax": 0.014245014245014245, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778748982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.042735042735042736, "writeRatioMax": 0.042735042735042736 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.2792022792022792, "computeRatioMax": 0.2792022792022792, "endMs": "1665778749129", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.022792022792022793, "readRatioMax": 0.022792022792022793, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "101", "startMs": "1665778749050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "35", "waitMsMax": "35", "waitRatioAvg": 0.09971509971509972, "waitRatioMax": 0.09971509971509972, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02849002849002849, "writeRatioMax": 0.02849002849002849 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.039886039886039885, "computeRatioMax": 0.039886039886039885, "endMs": "1665778749096", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02564102564102564, "readRatioMax": 0.02564102564102564, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778749051", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "19", "waitMsMax": "19", "waitRatioAvg": 0.05413105413105413, "waitRatioMax": 0.05413105413105413, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.042735042735042736, "writeRatioMax": 0.042735042735042736 }, { "completedParallelInputs": "5", "computeMsAvg": "199", "computeMsMax": "289", "computeRatioAvg": 0.5669515669515669, "computeRatioMax": 0.8233618233618234, "endMs": "1665778749260", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "13", "readRatioAvg": 0.02564102564102564, "readRatioMax": 0.037037037037037035, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "884", "startMs": "1665778749066", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002849002849002849, "waitRatioMax": 0.002849002849002849, "writeMsAvg": "6", "writeMsMax": "11", "writeRatioAvg": 0.017094017094017096, "writeRatioMax": 0.03133903133903134 }, { "completedParallelInputs": "6", "computeMsAvg": "264", "computeMsMax": "351", "computeRatioAvg": 0.7521367521367521, "computeRatioMax": 1, "endMs": "1665778749351", "id": "12", "inputStages": [ "4", "3" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.02849002849002849, "readRatioMax": 0.037037037037037035, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1467", "startMs": "1665778749093", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0C_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002849002849002849, "waitRatioMax": 0.005698005698005698, "writeMsAvg": "8", "writeMsMax": "12", "writeRatioAvg": 0.022792022792022793, "writeRatioMax": 0.03418803418803419 }, { "completedParallelInputs": "1", "computeMsAvg": "200", "computeMsMax": "200", "computeRatioAvg": 0.5698005698005698, "computeRatioMax": 0.5698005698005698, "endMs": "1665778749259", "id": "14", "inputStages": [ "7", "6" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.014245014245014245, "readRatioMax": 0.014245014245014245, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "187", "startMs": "1665778749156", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002849002849002849, "waitRatioMax": 0.002849002849002849, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.04843304843304843, "writeRatioMax": 0.04843304843304843 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.10826210826210826, "computeRatioMax": 0.10826210826210826, "endMs": "1665778749415", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665778749366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002849002849002849, "waitRatioMax": 0.002849002849002849, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.05413105413105413, "writeRatioMax": 0.05413105413105413 }, { "completedParallelInputs": "1", "computeMsAvg": "143", "computeMsMax": "143", "computeRatioAvg": 0.4074074074074074, "computeRatioMax": 0.4074074074074074, "endMs": "1665778749484", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "164", "startMs": "1665778749384", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002849002849002849, "waitRatioMax": 0.002849002849002849, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.07122507122507123, "writeRatioMax": 0.07122507122507123 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.022792022792022793, "computeRatioMax": 0.045584045584045586, "endMs": "1665778749562", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3669", "startMs": "1665778749505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.008547008547008548, "waitRatioMax": 0.017094017094017096, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.045584045584045586, "writeRatioMax": 0.08547008547008547 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.022792022792022793, "computeRatioMax": 0.05128205128205128, "endMs": "1665778749559", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "3279", "startMs": "1665778749505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.014245014245014245, "waitRatioMax": 0.017094017094017096, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.039886039886039885, "writeRatioMax": 0.05413105413105413 }, { "completedParallelInputs": "1", "computeMsAvg": "191", "computeMsMax": "191", "computeRatioAvg": 0.5441595441595442, "computeRatioMax": 0.5441595441595442, "endMs": "1665778749685", "id": "19", "inputStages": [ "12", "18", "17" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "47298", "shuffleOutputBytes": "1257512", "shuffleOutputBytesSpilled": "0", "slotMs": "178", "startMs": "1665778749522", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "ANTI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "ANTI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008547008547008548, "waitRatioMax": 0.008547008547008548, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.017094017094017096, "writeRatioMax": 0.017094017094017096 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.09401709401709402, "computeRatioMax": 0.09401709401709402, "endMs": "1665778749762", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "47298", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778749723", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002849002849002849, "waitRatioMax": 0.002849002849002849, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.017094017094017096, "writeRatioMax": 0.017094017094017096 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.017094017094017096, "computeRatioMax": 0.017094017094017096, "endMs": "1665778749779", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778749737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002849002849002849, "waitRatioMax": 0.002849002849002849, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.017094017094017096, "writeRatioMax": 0.017094017094017096 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "19", "elapsedMs": "609", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3079" }, { "activeUnits": "1", "completedUnits": "223", "elapsedMs": "997", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10466" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "10466", "transferredBytes": "0" }, "startTime": "1665778748813", "totalBytesProcessed": "82559911", "totalSlotMs": "10466" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7d357be4_ea6f_4e42_8b34_6e88e9730286" }, "priority": "INTERACTIVE", "query": "-- start query 87 in stream 0 using template query87.tpl\n\n/*\nCount how many customers have ordered on the same day items on the web and the catalog \nand on the same day have bought items in a store.\n*/\n\nselect count(*) \nfrom ((select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n) cool_cust\n;\n\n-- end query 87 in stream 0 using template query87.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "bTA+dxY0qoMyl/APovJhlw==", "id": "test-project-364309:europe-west1.query87_1665778750", "jobReference": { "jobId": "query87_1665778750", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query87_1665778750?location=europe-west1", "statistics": { "creationTime": "1665778751537", "endTime": "1665778752655", "finalExecutionDurationMs": "896", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "920" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "65", "computeMsMax": "65", "computeRatioAvg": 0.17473118279569894, "computeRatioMax": 0.17473118279569894, "endMs": "1665778751782", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.024193548387096774, "readRatioMax": 0.024193548387096774, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "96", "startMs": "1665778751697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04032258064516129, "writeRatioMax": 0.04032258064516129 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026881720430107527, "computeRatioMax": 0.026881720430107527, "endMs": "1665778751742", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.016129032258064516, "readRatioMax": 0.016129032258064516, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778751713", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04032258064516129, "writeRatioMax": 0.04032258064516129 }, { "completedParallelInputs": "1", "computeMsAvg": "97", "computeMsMax": "97", "computeRatioAvg": 0.260752688172043, "computeRatioMax": 0.260752688172043, "endMs": "1665778751838", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.04838709677419355, "readRatioMax": 0.04838709677419355, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "133", "startMs": "1665778751740", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04032258064516129, "writeRatioMax": 0.04032258064516129 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026881720430107527, "computeRatioMax": 0.026881720430107527, "endMs": "1665778751813", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.016129032258064516, "readRatioMax": 0.016129032258064516, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778751783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "30", "waitMsMax": "30", "waitRatioAvg": 0.08064516129032258, "waitRatioMax": 0.08064516129032258, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03763440860215054, "writeRatioMax": 0.03763440860215054 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.26344086021505375, "computeRatioMax": 0.26344086021505375, "endMs": "1665778751899", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.024193548387096774, "readRatioMax": 0.024193548387096774, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "109", "startMs": "1665778751814", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "32", "waitMsMax": "32", "waitRatioAvg": 0.08602150537634409, "waitRatioMax": 0.08602150537634409, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.024193548387096774, "computeRatioMax": 0.024193548387096774, "endMs": "1665778751853", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013440860215053764, "readRatioMax": 0.013440860215053764, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778751815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "17", "waitMsMax": "17", "waitRatioAvg": 0.0456989247311828, "waitRatioMax": 0.0456989247311828, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "5", "computeMsAvg": "198", "computeMsMax": "227", "computeRatioAvg": 0.532258064516129, "computeRatioMax": 0.6102150537634409, "endMs": "1665778752009", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.03763440860215054, "readRatioMax": 0.04838709677419355, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "1831", "startMs": "1665778751833", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.005376344086021506, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.01881720430107527, "writeRatioMax": 0.021505376344086023 }, { "completedParallelInputs": "6", "computeMsAvg": "279", "computeMsMax": "372", "computeRatioAvg": 0.75, "computeRatioMax": 1, "endMs": "1665778752126", "id": "12", "inputStages": [ "3", "4" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "17", "readRatioAvg": 0.026881720430107527, "readRatioMax": 0.0456989247311828, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1547", "startMs": "1665778751855", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0C_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "8", "writeMsMax": "22", "writeRatioAvg": 0.021505376344086023, "writeRatioMax": 0.05913978494623656 }, { "completedParallelInputs": "1", "computeMsAvg": "151", "computeMsMax": "151", "computeRatioAvg": 0.40591397849462363, "computeRatioMax": 0.40591397849462363, "endMs": "1665778752068", "id": "14", "inputStages": [ "7", "6" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.021505376344086023, "readRatioMax": 0.021505376344086023, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "153", "startMs": "1665778751944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.056451612903225805, "writeRatioMax": 0.056451612903225805 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.06720430107526881, "computeRatioMax": 0.06720430107526881, "endMs": "1665778752208", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778752158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.08870967741935484, "writeRatioMax": 0.08870967741935484 }, { "completedParallelInputs": "1", "computeMsAvg": "136", "computeMsMax": "136", "computeRatioAvg": 0.3655913978494624, "computeRatioMax": 0.3655913978494624, "endMs": "1665778752280", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "150", "startMs": "1665778752175", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.07795698924731183, "writeRatioMax": 0.07795698924731183 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.021505376344086023, "computeRatioMax": 0.04032258064516129, "endMs": "1665778752341", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3597", "startMs": "1665778752284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.013440860215053764, "writeMsAvg": "15", "writeMsMax": "40", "writeRatioAvg": 0.04032258064516129, "writeRatioMax": 0.10752688172043011 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.01881720430107527, "computeRatioMax": 0.03494623655913978, "endMs": "1665778752337", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "3236", "startMs": "1665778752285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.013440860215053764, "waitRatioMax": 0.016129032258064516, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.03763440860215054, "writeRatioMax": 0.06720430107526881 }, { "completedParallelInputs": "1", "computeMsAvg": "273", "computeMsMax": "273", "computeRatioAvg": 0.7338709677419355, "computeRatioMax": 0.7338709677419355, "endMs": "1665778752499", "id": "19", "inputStages": [ "12", "17", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "47298", "shuffleOutputBytes": "1257512", "shuffleOutputBytesSpilled": "0", "slotMs": "247", "startMs": "1665778752300", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "ANTI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "ANTI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.005376344086021506, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.016129032258064516, "writeRatioMax": 0.016129032258064516 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.06451612903225806, "computeRatioMax": 0.06451612903225806, "endMs": "1665778752541", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "47298", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778752506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.043010752688172046, "writeRatioMax": 0.043010752688172046 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03494623655913978, "computeRatioMax": 0.03494623655913978, "endMs": "1665778752560", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778752519", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002688172043010753, "waitRatioMax": 0.002688172043010753, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03494623655913978, "writeRatioMax": 0.03494623655913978 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "18", "elapsedMs": "594", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3966" }, { "activeUnits": "2", "completedUnits": "223", "elapsedMs": "989", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11256" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "11256", "transferredBytes": "0" }, "startTime": "1665778751604", "totalBytesProcessed": "82559911", "totalSlotMs": "11256" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0fd9dfce_4be5_4fd6_b13c_4b796f5dc95d" }, "priority": "INTERACTIVE", "query": "-- start query 87 in stream 0 using template query87.tpl\n\n/*\nCount how many customers have ordered on the same day items on the web and the catalog \nand on the same day have bought items in a store.\n*/\n\nselect count(*) \nfrom ((select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n except distinct\n (select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200+11)\n) cool_cust\n;\n\n-- end query 87 in stream 0 using template query87.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "FPth9Bn2JnPJVqzjTSvnIg==", "id": "test-project-364309:europe-west1.query87_1665778753", "jobReference": { "jobId": "query87_1665778753", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query87_1665778753?location=europe-west1", "statistics": { "creationTime": "1665778754362", "endTime": "1665778755472", "finalExecutionDurationMs": "895", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "917" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "101", "computeMsMax": "101", "computeRatioAvg": 0.3186119873817035, "computeRatioMax": 0.3186119873817035, "endMs": "1665778754625", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.025236593059936908, "readRatioMax": 0.025236593059936908, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "119", "startMs": "1665778754529", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03470031545741325, "writeRatioMax": 0.03470031545741325 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.05362776025236593, "computeRatioMax": 0.05362776025236593, "endMs": "1665778754583", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01892744479495268, "readRatioMax": 0.01892744479495268, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778754544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03785488958990536, "writeRatioMax": 0.03785488958990536 }, { "completedParallelInputs": "1", "computeMsAvg": "89", "computeMsMax": "89", "computeRatioAvg": 0.2807570977917981, "computeRatioMax": 0.2807570977917981, "endMs": "1665778754663", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.025236593059936908, "readRatioMax": 0.025236593059936908, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665778754572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03470031545741325, "writeRatioMax": 0.03470031545741325 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.028391167192429023, "computeRatioMax": 0.028391167192429023, "endMs": "1665778754665", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.015772870662460567, "readRatioMax": 0.015772870662460567, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778754626", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "35", "waitMsMax": "35", "waitRatioAvg": 0.11041009463722397, "waitRatioMax": 0.11041009463722397, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.050473186119873815, "writeRatioMax": 0.050473186119873815 }, { "completedParallelInputs": "1", "computeMsAvg": "99", "computeMsMax": "99", "computeRatioAvg": 0.31230283911671924, "computeRatioMax": 0.31230283911671924, "endMs": "1665778754755", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.022082018927444796, "readRatioMax": 0.022082018927444796, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "112", "startMs": "1665778754663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "37", "waitMsMax": "37", "waitRatioAvg": 0.1167192429022082, "waitRatioMax": 0.1167192429022082, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.031545741324921134, "writeRatioMax": 0.031545741324921134 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.04416403785488959, "computeRatioMax": 0.04416403785488959, "endMs": "1665778754710", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.025236593059936908, "readRatioMax": 0.025236593059936908, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778754663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "19", "waitMsMax": "19", "waitRatioAvg": 0.05993690851735016, "waitRatioMax": 0.05993690851735016, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0473186119873817, "writeRatioMax": 0.0473186119873817 }, { "completedParallelInputs": "5", "computeMsAvg": "220", "computeMsMax": "251", "computeRatioAvg": 0.694006309148265, "computeRatioMax": 0.7917981072555205, "endMs": "1665778754857", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "10", "readRatioAvg": 0.028391167192429023, "readRatioMax": 0.031545741324921134, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "885", "startMs": "1665778754694", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.01892744479495268, "writeRatioMax": 0.025236593059936908 }, { "completedParallelInputs": "6", "computeMsAvg": "252", "computeMsMax": "317", "computeRatioAvg": 0.7949526813880127, "computeRatioMax": 1, "endMs": "1665778754882", "id": "11", "inputStages": [ "4", "3" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "11", "readRatioAvg": 0.031545741324921134, "readRatioMax": 0.03470031545741325, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1268", "startMs": "1665778754697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0B_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.01892744479495268, "writeRatioMax": 0.022082018927444796 }, { "completedParallelInputs": "1", "computeMsAvg": "180", "computeMsMax": "180", "computeRatioAvg": 0.5678233438485805, "computeRatioMax": 0.5678233438485805, "endMs": "1665778754923", "id": "13", "inputStages": [ "7", "6" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.028391167192429023, "readRatioMax": 0.028391167192429023, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "169", "startMs": "1665778754794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0D_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.050473186119873815, "writeRatioMax": 0.050473186119873815 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.07255520504731862, "computeRatioMax": 0.07255520504731862, "endMs": "1665778755014", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778754963", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.07255520504731862, "writeRatioMax": 0.07255520504731862 }, { "completedParallelInputs": "1", "computeMsAvg": "81", "computeMsMax": "81", "computeRatioAvg": 0.2555205047318612, "computeRatioMax": 0.2555205047318612, "endMs": "1665778755056", "id": "15", "inputStages": [ "10" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "89", "startMs": "1665778754982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.0694006309148265, "writeRatioMax": 0.0694006309148265 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.028391167192429023, "computeRatioMax": 0.06309148264984227, "endMs": "1665778755126", "id": "16", "inputStages": [ "15" ], "name": "S10: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3712", "startMs": "1665778755074", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "10", "waitRatioAvg": 0.006309148264984227, "waitRatioMax": 0.031545741324921134, "writeMsAvg": "20", "writeMsMax": "32", "writeRatioAvg": 0.06309148264984227, "writeRatioMax": 0.10094637223974763 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.025236593059936908, "computeRatioMax": 0.05993690851735016, "endMs": "1665778755134", "id": "17", "inputStages": [ "14" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "3325", "startMs": "1665778755075", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.028391167192429023, "waitRatioMax": 0.03470031545741325, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.0473186119873817, "writeRatioMax": 0.0946372239747634 }, { "completedParallelInputs": "1", "computeMsAvg": "285", "computeMsMax": "285", "computeRatioAvg": 0.8990536277602523, "computeRatioMax": 0.8990536277602523, "endMs": "1665778755303", "id": "18", "inputStages": [ "11", "17", "16" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "47298", "shuffleOutputBytes": "1257512", "shuffleOutputBytesSpilled": "0", "slotMs": "256", "startMs": "1665778755091", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "ANTI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "ANTI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage12_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00946372239747634, "waitRatioMax": 0.00946372239747634, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01892744479495268, "writeRatioMax": 0.01892744479495268 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.13564668769716087, "computeRatioMax": 0.13564668769716087, "endMs": "1665778755373", "id": "19", "inputStages": [ "18" ], "name": "S13: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "47298", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778755337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006309148264984227, "waitRatioMax": 0.006309148264984227, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012618296529968454, "writeRatioMax": 0.012618296529968454 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.01892744479495268, "computeRatioMax": 0.01892744479495268, "endMs": "1665778755395", "id": "20", "inputStages": [ "19" ], "name": "S14: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778755350", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.025236593059936908, "writeRatioMax": 0.025236593059936908 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "19", "elapsedMs": "600", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2968" }, { "activeUnits": "1", "completedUnits": "223", "elapsedMs": "989", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10389" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "10389", "transferredBytes": "0" }, "startTime": "1665778754430", "totalBytesProcessed": "82559911", "totalSlotMs": "10389" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
