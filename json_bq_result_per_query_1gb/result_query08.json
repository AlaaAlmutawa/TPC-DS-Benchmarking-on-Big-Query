{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1b657bac_4ed5_4948_a856_e4bff1b0d9b5" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "4YXjlJHDgSHJQegyYxmM2Q==", "id": "test-project-364309:europe-west1.query08_1665768219", "jobReference": { "jobId": "query08_1665768219", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665768219?location=europe-west1", "statistics": { "creationTime": "1665768220251", "endTime": "1665768221187", "finalExecutionDurationMs": "662", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "629" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.1388888888888889, "computeRatioMax": 0.1388888888888889, "endMs": "1665768220486", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.041666666666666664, "readRatioMax": 0.041666666666666664, "recordsRead": "100000", "recordsWritten": "47428", "shuffleOutputBytes": "426852", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768220446", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.1527777777777778, "writeRatioMax": 0.1527777777777778 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.2569444444444444, "computeRatioMax": 0.2569444444444444, "endMs": "1665768220537", "id": "2", "inputStages": [ "0" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.034722222222222224, "readRatioMax": 0.034722222222222224, "recordsRead": "97428", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768220500", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.034722222222222224 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06944444444444445, "computeRatioMax": 0.06944444444444445, "endMs": "1665768220604", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768220567", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1111111111111111, "writeRatioMax": 0.1111111111111111 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.125, "endMs": "1665768220672", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "4035", "startMs": "1665768220610", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.020833333333333332, "waitRatioMax": 0.027777777777777776, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.10416666666666667, "writeRatioMax": 0.1875 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.11805555555555555, "computeRatioMax": 0.11805555555555555, "endMs": "1665768220693", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.027777777777777776, "readRatioMax": 0.027777777777777776, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768220629", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.04861111111111111, "waitRatioMax": 0.04861111111111111, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.10416666666666667, "computeRatioMax": 0.10416666666666667, "endMs": "1665768220766", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768220721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.13194444444444445, "writeRatioMax": 0.13194444444444445 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.041666666666666664, "endMs": "1665768220768", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.020833333333333332, "readRatioMax": 0.020833333333333332, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768220733", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1111111111111111, "writeRatioMax": 0.1111111111111111 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08333333333333333, "computeRatioMax": 0.08333333333333333, "endMs": "1665768220791", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05555555555555555, "readRatioMax": 0.05555555555555555, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768220750", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013888888888888888, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.09027777777777778, "writeRatioMax": 0.09027777777777778 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.1111111111111111, "endMs": "1665768220862", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3911", "startMs": "1665768220800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.020833333333333332, "waitRatioMax": 0.034722222222222224, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.09722222222222222, "writeRatioMax": 0.19444444444444445 }, { "completedParallelInputs": "6", "computeMsAvg": "119", "computeMsMax": "144", "computeRatioAvg": 0.8263888888888888, "computeRatioMax": 1, "endMs": "1665768221007", "id": "11", "inputStages": [ "8", "10", "7" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "22", "readRatioAvg": 0.10416666666666667, "readRatioMax": 0.1527777777777778, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "933", "startMs": "1665768220819", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.013888888888888888, "waitRatioMax": 0.020833333333333332, "writeMsAvg": "17", "writeMsMax": "55", "writeRatioAvg": 0.11805555555555555, "writeRatioMax": 0.3819444444444444 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06944444444444445, "computeRatioMax": 0.06944444444444445, "endMs": "1665768221056", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768221016", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.09722222222222222, "writeRatioMax": 0.09722222222222222 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.04861111111111111, "computeRatioMax": 0.04861111111111111, "endMs": "1665768221075", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768221031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "211", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "8628" }, { "activeUnits": "4", "completedUnits": "215", "elapsedMs": "811", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9157" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "9157", "transferredBytes": "0" }, "startTime": "1665768220314", "totalBytesProcessed": "91590020", "totalSlotMs": "9157" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1327d3dd_a26e_4a34_bdf0_8b819e22798e" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "6o+mnaM4XACfRddsFsF0gw==", "id": "test-project-364309:europe-west1.query08_1665776510", "jobReference": { "jobId": "query08_1665776510", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776510?location=europe-west1", "statistics": { "creationTime": "1665776510706", "endTime": "1665776511494", "finalExecutionDurationMs": "574", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "632" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.14534883720930233, "computeRatioMax": 0.14534883720930233, "endMs": "1665776510908", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.046511627906976744, "readRatioMax": 0.046511627906976744, "recordsRead": "100000", "recordsWritten": "47428", "shuffleOutputBytes": "426852", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776510865", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.11046511627906977, "writeRatioMax": 0.11046511627906977 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.21511627906976744, "computeRatioMax": 0.21511627906976744, "endMs": "1665776510953", "id": "2", "inputStages": [ "0" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.029069767441860465, "readRatioMax": 0.029069767441860465, "recordsRead": "97428", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776510915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.023255813953488372, "writeRatioMax": 0.023255813953488372 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.10465116279069768, "computeRatioMax": 0.10465116279069768, "endMs": "1665776511016", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776510979", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08139534883720931, "writeRatioMax": 0.08139534883720931 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.046511627906976744, "computeRatioMax": 0.11046511627906977, "endMs": "1665776511088", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "4419", "startMs": "1665776511026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.011627906976744186, "waitRatioMax": 0.01744186046511628, "writeMsAvg": "19", "writeMsMax": "32", "writeRatioAvg": 0.11046511627906977, "writeRatioMax": 0.18604651162790697 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.11627906976744186, "computeRatioMax": 0.11627906976744186, "endMs": "1665776511108", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.029069767441860465, "readRatioMax": 0.029069767441860465, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776511038", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.023255813953488372, "waitRatioMax": 0.023255813953488372, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.011627906976744186, "writeRatioMax": 0.011627906976744186 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.029069767441860465, "computeRatioMax": 0.029069767441860465, "endMs": "1665776511189", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776511153", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.1686046511627907, "writeRatioMax": 0.1686046511627907 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.040697674418604654, "computeRatioMax": 0.040697674418604654, "endMs": "1665776511204", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.01744186046511628, "readRatioMax": 0.01744186046511628, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776511168", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.14534883720930233, "writeRatioMax": 0.14534883720930233 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05813953488372093, "computeRatioMax": 0.05813953488372093, "endMs": "1665776511221", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.05232558139534884, "readRatioMax": 0.05232558139534884, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776511184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.046511627906976744, "writeRatioMax": 0.046511627906976744 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "11", "computeRatioAvg": 0.040697674418604654, "computeRatioMax": 0.06395348837209303, "endMs": "1665776511290", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3867", "startMs": "1665776511232", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.029069767441860465, "waitRatioMax": 0.03488372093023256, "writeMsAvg": "13", "writeMsMax": "21", "writeRatioAvg": 0.0755813953488372, "writeRatioMax": 0.12209302325581395 }, { "completedParallelInputs": "6", "computeMsAvg": "120", "computeMsMax": "172", "computeRatioAvg": 0.6976744186046512, "computeRatioMax": 1, "endMs": "1665776511362", "id": "11", "inputStages": [ "8", "10", "7" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.05813953488372093, "readRatioMax": 0.0755813953488372, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "986", "startMs": "1665776511245", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.01744186046511628, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.03488372093023256, "writeRatioMax": 0.046511627906976744 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05232558139534884, "computeRatioMax": 0.05232558139534884, "endMs": "1665776511402", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776511369", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011627906976744186, "waitRatioMax": 0.011627906976744186, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.05813953488372093, "writeRatioMax": 0.05813953488372093 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.06395348837209303, "computeRatioMax": 0.06395348837209303, "endMs": "1665776511411", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776511382", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03488372093023256, "writeRatioMax": 0.03488372093023256 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "213", "elapsedMs": "612", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9581" }, { "activeUnits": "0", "completedUnits": "215", "elapsedMs": "698", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9681" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "9681", "transferredBytes": "0" }, "startTime": "1665776510753", "totalBytesProcessed": "91590020", "totalSlotMs": "9681" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0722e0a4_9022_4fa8_a274_dfdc709af007" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "mGSI0tRz/rITOcxv8/9l1Q==", "id": "test-project-364309:europe-west1.query08_1665776512", "jobReference": { "jobId": "query08_1665776512", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776512?location=europe-west1", "statistics": { "creationTime": "1665776513114", "endTime": "1665776514005", "finalExecutionDurationMs": "672", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "627" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.2642857142857143, "computeRatioMax": 0.2642857142857143, "endMs": "1665776513328", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.05, "readRatioMax": 0.05, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776513291", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06428571428571428, "writeRatioMax": 0.06428571428571428 }, { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.4, "computeRatioMax": 0.4, "endMs": "1665776513378", "id": "2", "inputStages": [ "1" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04285714285714286, "readRatioMax": 0.04285714285714286, "recordsRead": "150000", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776513334", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $50 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.1, "computeRatioMax": 0.1, "endMs": "1665776513439", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776513402", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.10714285714285714, "writeRatioMax": 0.10714285714285714 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.10714285714285714, "endMs": "1665776513516", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "5292", "startMs": "1665776513451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.014285714285714285, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.10714285714285714, "writeRatioMax": 0.2 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.15714285714285714, "computeRatioMax": 0.15714285714285714, "endMs": "1665776513536", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04285714285714286, "readRatioMax": 0.04285714285714286, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776513459", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.02142857142857143, "waitRatioMax": 0.02142857142857143, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02142857142857143, "writeRatioMax": 0.02142857142857143 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08571428571428572, "computeRatioMax": 0.08571428571428572, "endMs": "1665776513617", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776513579", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.10714285714285714, "writeRatioMax": 0.10714285714285714 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07142857142857142, "computeRatioMax": 0.07142857142857142, "endMs": "1665776513633", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.02857142857142857, "readRatioMax": 0.02857142857142857, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665776513594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.10714285714285714, "writeRatioMax": 0.10714285714285714 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07857142857142857, "computeRatioMax": 0.07857142857142857, "endMs": "1665776513640", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05714285714285714, "readRatioMax": 0.05714285714285714, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776513611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.09285714285714286, "writeRatioMax": 0.09285714285714286 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.14285714285714285, "endMs": "1665776513708", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "4949", "startMs": "1665776513646", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.02142857142857143, "writeMsAvg": "18", "writeMsMax": "32", "writeRatioAvg": 0.12857142857142856, "writeRatioMax": 0.22857142857142856 }, { "completedParallelInputs": "6", "computeMsAvg": "108", "computeMsMax": "140", "computeRatioAvg": 0.7714285714285715, "computeRatioMax": 1, "endMs": "1665776513811", "id": "11", "inputStages": [ "8", "10", "7" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "21", "readRatioAvg": 0.08571428571428572, "readRatioMax": 0.15, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "857", "startMs": "1665776513660", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.014285714285714285, "waitRatioMax": 0.02857142857142857, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.05, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.04285714285714286, "computeRatioMax": 0.04285714285714286, "endMs": "1665776513898", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776513823", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "68", "writeMsMax": "68", "writeRatioAvg": 0.4857142857142857, "writeRatioMax": 0.4857142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06428571428571428, "computeRatioMax": 0.06428571428571428, "endMs": "1665776513916", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "102", "startMs": "1665776513851", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06428571428571428, "writeRatioMax": 0.06428571428571428 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "209", "elapsedMs": "610", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "10989" }, { "activeUnits": "3", "completedUnits": "215", "elapsedMs": "786", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11613" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "11613", "transferredBytes": "0" }, "startTime": "1665776513167", "totalBytesProcessed": "91590020", "totalSlotMs": "11613" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon77ceeaea_a422_4aa3_ab7d_e1ab4f0f9046" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Nb3cp+wVRGirO4a352ooJg==", "id": "test-project-364309:europe-west1.query08_1665776515", "jobReference": { "jobId": "query08_1665776515", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776515?location=europe-west1", "statistics": { "creationTime": "1665776515684", "endTime": "1665776516624", "finalExecutionDurationMs": "682", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "631" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.1510791366906475, "computeRatioMax": 0.1510791366906475, "endMs": "1665776515919", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.06474820143884892, "readRatioMax": 0.06474820143884892, "recordsRead": "100000", "recordsWritten": "47428", "shuffleOutputBytes": "426852", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665776515874", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.16546762589928057, "writeRatioMax": 0.16546762589928057 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.302158273381295, "computeRatioMax": 0.302158273381295, "endMs": "1665776515969", "id": "2", "inputStages": [ "0" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04316546762589928, "readRatioMax": 0.04316546762589928, "recordsRead": "97428", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776515930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02877697841726619, "writeRatioMax": 0.02877697841726619 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.14388489208633093, "computeRatioMax": 0.14388489208633093, "endMs": "1665776516033", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776515996", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.08633093525179857, "writeRatioMax": 0.08633093525179857 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.06474820143884892, "computeRatioMax": 0.1223021582733813, "endMs": "1665776516121", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "5247", "startMs": "1665776516047", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.02877697841726619, "writeMsAvg": "20", "writeMsMax": "47", "writeRatioAvg": 0.14388489208633093, "writeRatioMax": 0.3381294964028777 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.17985611510791366, "computeRatioMax": 0.17985611510791366, "endMs": "1665776516140", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05755395683453238, "readRatioMax": 0.05755395683453238, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776516061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.07194244604316546, "waitRatioMax": 0.07194244604316546, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03597122302158273, "writeRatioMax": 0.03597122302158273 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08633093525179857, "computeRatioMax": 0.08633093525179857, "endMs": "1665776516226", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776516189", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10071942446043165, "writeRatioMax": 0.10071942446043165 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07194244604316546, "computeRatioMax": 0.07194244604316546, "endMs": "1665776516248", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05755395683453238, "readRatioMax": 0.05755395683453238, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776516205", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07913669064748201, "writeRatioMax": 0.07913669064748201 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.09352517985611511, "computeRatioMax": 0.09352517985611511, "endMs": "1665776516270", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.07194244604316546, "readRatioMax": 0.07194244604316546, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776516224", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07913669064748201, "writeRatioMax": 0.07913669064748201 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.1223021582733813, "endMs": "1665776516344", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "6428", "startMs": "1665776516279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "7", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.050359712230215826, "writeMsAvg": "27", "writeMsMax": "47", "writeRatioAvg": 0.19424460431654678, "writeRatioMax": 0.3381294964028777 }, { "completedParallelInputs": "6", "computeMsAvg": "113", "computeMsMax": "139", "computeRatioAvg": 0.8129496402877698, "computeRatioMax": 1, "endMs": "1665776516436", "id": "11", "inputStages": [ "8", "7", "10" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.08633093525179857, "readRatioMax": 0.11510791366906475, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "976", "startMs": "1665776516300", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.02158273381294964, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.04316546762589928, "writeRatioMax": 0.050359712230215826 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08633093525179857, "computeRatioMax": 0.08633093525179857, "endMs": "1665776516502", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "97", "startMs": "1665776516448", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.11510791366906475, "writeRatioMax": 0.11510791366906475 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.05755395683453238, "endMs": "1665776516514", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776516468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.050359712230215826, "waitRatioMax": 0.050359712230215826, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05755395683453238, "writeRatioMax": 0.05755395683453238 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "207", "elapsedMs": "637", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "12185" }, { "activeUnits": "6", "completedUnits": "215", "elapsedMs": "833", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13154" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "13154", "transferredBytes": "0" }, "startTime": "1665776515738", "totalBytesProcessed": "91590020", "totalSlotMs": "13154" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon980ed374_71fb_43d4_9a90_82dbece4ffcd" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "zRCG15frzyctLrOW5h6tNA==", "id": "test-project-364309:europe-west1.query08_1665776517", "jobReference": { "jobId": "query08_1665776517", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776517?location=europe-west1", "statistics": { "creationTime": "1665776518330", "endTime": "1665776519284", "finalExecutionDurationMs": "639", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "635" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.2786885245901639, "computeRatioMax": 0.2786885245901639, "endMs": "1665776518553", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.07377049180327869, "readRatioMax": 0.07377049180327869, "recordsRead": "100000", "recordsWritten": "47428", "shuffleOutputBytes": "426852", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665776518509", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.18032786885245902, "writeRatioMax": 0.18032786885245902 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.4672131147540984, "computeRatioMax": 0.4672131147540984, "endMs": "1665776518617", "id": "2", "inputStages": [ "0" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04918032786885246, "readRatioMax": 0.04918032786885246, "recordsRead": "97428", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "86", "startMs": "1665776518563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.05737704918032787, "writeRatioMax": 0.05737704918032787 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.12295081967213115, "computeRatioMax": 0.12295081967213115, "endMs": "1665776518686", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776518648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.10655737704918032, "writeRatioMax": 0.10655737704918032 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.06557377049180328, "computeRatioMax": 0.13934426229508196, "endMs": "1665776518765", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "3962", "startMs": "1665776518697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.01639344262295082, "waitRatioMax": 0.03278688524590164, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.13114754098360656, "writeRatioMax": 0.22950819672131148 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.1557377049180328, "computeRatioMax": 0.1557377049180328, "endMs": "1665776518779", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04918032786885246, "readRatioMax": 0.04918032786885246, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776518708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.04918032786885246, "waitRatioMax": 0.04918032786885246, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.040983606557377046, "writeRatioMax": 0.040983606557377046 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.09836065573770492, "computeRatioMax": 0.09836065573770492, "endMs": "1665776518859", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776518824", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.13114754098360656, "writeRatioMax": 0.13114754098360656 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.06557377049180328, "computeRatioMax": 0.06557377049180328, "endMs": "1665776518882", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.040983606557377046, "readRatioMax": 0.040983606557377046, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776518841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.14754098360655737, "writeRatioMax": 0.14754098360655737 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.07377049180327869, "computeRatioMax": 0.07377049180327869, "endMs": "1665776518898", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04918032786885246, "readRatioMax": 0.04918032786885246, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776518858", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.11475409836065574, "writeRatioMax": 0.11475409836065574 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.06557377049180328, "computeRatioMax": 0.12295081967213115, "endMs": "1665776518966", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "5095", "startMs": "1665776518908", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.02459016393442623, "writeMsAvg": "19", "writeMsMax": "31", "writeRatioAvg": 0.1557377049180328, "writeRatioMax": 0.2540983606557377 }, { "completedParallelInputs": "6", "computeMsAvg": "103", "computeMsMax": "122", "computeRatioAvg": 0.8442622950819673, "computeRatioMax": 1, "endMs": "1665776519040", "id": "11", "inputStages": [ "7", "8", "10" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "15", "readRatioAvg": 0.10655737704918032, "readRatioMax": 0.12295081967213115, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "957", "startMs": "1665776518923", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.01639344262295082, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.05737704918032787, "writeRatioMax": 0.07377049180327869 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.05737704918032787, "computeRatioMax": 0.05737704918032787, "endMs": "1665776519086", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776519051", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00819672131147541, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.13114754098360656, "writeRatioMax": 0.13114754098360656 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.07377049180327869, "computeRatioMax": 0.07377049180327869, "endMs": "1665776519109", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776519067", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01639344262295082, "waitRatioMax": 0.01639344262295082, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.05737704918032787, "writeRatioMax": 0.05737704918032787 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "207", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "9532" }, { "activeUnits": "6", "completedUnits": "215", "elapsedMs": "776", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10521" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "10521", "transferredBytes": "0" }, "startTime": "1665776518378", "totalBytesProcessed": "91590020", "totalSlotMs": "10521" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8a51299d_85fe_46d1_bad4_ada5374a8b71" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "RHUXl5gcpFf5NpeQtZ1Muw==", "id": "test-project-364309:europe-west1.query08_1665776520", "jobReference": { "jobId": "query08_1665776520", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776520?location=europe-west1", "statistics": { "creationTime": "1665776520989", "endTime": "1665776522196", "finalExecutionDurationMs": "879", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "635" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.15760869565217392, "computeRatioMax": 0.15760869565217392, "endMs": "1665776521306", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03804347826086957, "readRatioMax": 0.03804347826086957, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776521268", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005434782608695652, "waitRatioMax": 0.005434782608695652, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.059782608695652176, "writeRatioMax": 0.059782608695652176 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.20652173913043478, "computeRatioMax": 0.20652173913043478, "endMs": "1665776521363", "id": "2", "inputStages": [ "1" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "150000", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776521325", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $50 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.016304347826086956, "waitRatioMax": 0.016304347826086956, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06521739130434782, "computeRatioMax": 0.06521739130434782, "endMs": "1665776521425", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776521391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005434782608695652, "waitRatioMax": 0.005434782608695652, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07608695652173914, "writeRatioMax": 0.07608695652173914 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.07608695652173914, "endMs": "1665776521497", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "5379", "startMs": "1665776521436", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.010869565217391304, "waitRatioMax": 0.016304347826086956, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.08152173913043478, "writeRatioMax": 0.14130434782608695 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.10869565217391304, "computeRatioMax": 0.10869565217391304, "endMs": "1665776521524", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.04891304347826087, "readRatioMax": 0.04891304347826087, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776521446", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.043478260869565216, "waitRatioMax": 0.043478260869565216, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05434782608695652, "computeRatioMax": 0.05434782608695652, "endMs": "1665776521598", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776521561", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005434782608695652, "waitRatioMax": 0.005434782608695652, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.15217391304347827, "writeRatioMax": 0.15217391304347827 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05434782608695652, "computeRatioMax": 0.05434782608695652, "endMs": "1665776521613", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03804347826086957, "readRatioMax": 0.03804347826086957, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776521576", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010869565217391304, "waitRatioMax": 0.010869565217391304, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665776521679", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "52", "readMsMax": "52", "readRatioAvg": 0.2826086956521739, "readRatioMax": 0.2826086956521739, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665776521594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.016304347826086956, "waitRatioMax": 0.016304347826086956, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.125, "writeRatioMax": 0.125 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.08152173913043478, "endMs": "1665776521746", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "4237", "startMs": "1665776521686", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.005434782608695652, "waitRatioMax": 0.016304347826086956, "writeMsAvg": "17", "writeMsMax": "31", "writeRatioAvg": 0.09239130434782608, "writeRatioMax": 0.16847826086956522 }, { "completedParallelInputs": "6", "computeMsAvg": "105", "computeMsMax": "135", "computeRatioAvg": 0.5706521739130435, "computeRatioMax": 0.7336956521739131, "endMs": "1665776521857", "id": "11", "inputStages": [ "10", "7", "8" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "27", "readRatioAvg": 0.07608695652173914, "readRatioMax": 0.14673913043478262, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "915", "startMs": "1665776521701", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.005434782608695652, "waitRatioMax": 0.016304347826086956, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.03804347826086957, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03260869565217391, "computeRatioMax": 0.03260869565217391, "endMs": "1665776521908", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776521870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005434782608695652, "waitRatioMax": 0.005434782608695652, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.15217391304347827, "writeRatioMax": 0.15217391304347827 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.021739130434782608, "endMs": "1665776522091", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "172", "startMs": "1665776521888", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010869565217391304, "waitRatioMax": 0.010869565217391304, "writeMsAvg": "184", "writeMsMax": "184", "writeRatioAvg": 1, "writeRatioMax": 1 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "207", "elapsedMs": "655", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "10041" }, { "activeUnits": "6", "completedUnits": "215", "elapsedMs": "1046", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11175" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "11175", "transferredBytes": "0" }, "startTime": "1665776521099", "totalBytesProcessed": "91590020", "totalSlotMs": "11175" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5a7b555c_37f6_4088_8760_6e2281583c8b" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "kiCyAMOykyrCmSkkR9Z2Mw==", "id": "test-project-364309:europe-west1.query08_1665776775", "jobReference": { "jobId": "query08_1665776775", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776775?location=europe-west1", "statistics": { "creationTime": "1665776775796", "endTime": "1665776776660", "finalExecutionDurationMs": "637", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "651" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.27884615384615385, "computeRatioMax": 0.27884615384615385, "endMs": "1665776776006", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.08653846153846154, "readRatioMax": 0.08653846153846154, "recordsRead": "100000", "recordsWritten": "47428", "shuffleOutputBytes": "426852", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776775961", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.20192307692307693, "writeRatioMax": 0.20192307692307693 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.27884615384615385, "computeRatioMax": 0.27884615384615385, "endMs": "1665776776047", "id": "2", "inputStages": [ "0" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.04807692307692308, "readRatioMax": 0.04807692307692308, "recordsRead": "97428", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776776016", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.019230769230769232, "waitRatioMax": 0.019230769230769232, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.04807692307692308, "writeRatioMax": 0.04807692307692308 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.1346153846153846, "computeRatioMax": 0.1346153846153846, "endMs": "1665776776107", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776776077", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.09615384615384616, "writeRatioMax": 0.09615384615384616 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.17307692307692307, "endMs": "1665776776162", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "3056", "startMs": "1665776776111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.019230769230769232, "waitRatioMax": 0.019230769230769232, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.1346153846153846, "writeRatioMax": 0.18269230769230768 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.2403846153846154, "computeRatioMax": 0.2403846153846154, "endMs": "1665776776186", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.057692307692307696, "readRatioMax": 0.057692307692307696, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776776119", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.038461538461538464, "waitRatioMax": 0.038461538461538464, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.057692307692307696, "writeRatioMax": 0.057692307692307696 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.07692307692307693, "endMs": "1665776776241", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776776205", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.14423076923076922, "writeRatioMax": 0.14423076923076922 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.07692307692307693, "endMs": "1665776776259", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.028846153846153848, "readRatioMax": 0.028846153846153848, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776776221", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.15384615384615385, "writeRatioMax": 0.15384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.07692307692307693, "endMs": "1665776776275", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.057692307692307696, "readRatioMax": 0.057692307692307696, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776776237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.11538461538461539, "writeRatioMax": 0.11538461538461539 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.0673076923076923, "computeRatioMax": 0.11538461538461539, "endMs": "1665776776345", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3777", "startMs": "1665776776288", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.019230769230769232, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.19230769230769232, "writeRatioMax": 0.2980769230769231 }, { "completedParallelInputs": "6", "computeMsAvg": "96", "computeMsMax": "104", "computeRatioAvg": 0.9230769230769231, "computeRatioMax": 1, "endMs": "1665776776487", "id": "11", "inputStages": [ "10", "8", "7" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.11538461538461539, "readRatioMax": 0.15384615384615385, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "1122", "startMs": "1665776776302", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.04807692307692308, "writeRatioMax": 0.0673076923076923 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.08653846153846154, "computeRatioMax": 0.08653846153846154, "endMs": "1665776776543", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776776508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.1346153846153846, "writeRatioMax": 0.1346153846153846 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.07692307692307693, "endMs": "1665776776563", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776776522", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009615384615384616, "waitRatioMax": 0.009615384615384616, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0673076923076923, "writeRatioMax": 0.0673076923076923 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "207", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "7048" }, { "activeUnits": "6", "completedUnits": "215", "elapsedMs": "751", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8253" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "8253", "transferredBytes": "0" }, "startTime": "1665776775857", "totalBytesProcessed": "91590020", "totalSlotMs": "8253" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0662ff8e_e239_493e_a8d2_3ebfd6d15b48" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "yD18Mped6O9lAWI3xWhtXg==", "id": "test-project-364309:europe-west1.query08_1665776777", "jobReference": { "jobId": "query08_1665776777", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776777?location=europe-west1", "statistics": { "creationTime": "1665776778319", "endTime": "1665776779309", "finalExecutionDurationMs": "711", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "650" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.21428571428571427, "computeRatioMax": 0.21428571428571427, "endMs": "1665776778564", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06349206349206349, "readRatioMax": 0.06349206349206349, "recordsRead": "100000", "recordsWritten": "47428", "shuffleOutputBytes": "426852", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776778516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007936507936507936, "waitRatioMax": 0.007936507936507936, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.19047619047619047, "writeRatioMax": 0.19047619047619047 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.4365079365079365, "computeRatioMax": 0.4365079365079365, "endMs": "1665776778633", "id": "2", "inputStages": [ "0" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.047619047619047616, "readRatioMax": 0.047619047619047616, "recordsRead": "97428", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665776778589", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015873015873015872, "waitRatioMax": 0.015873015873015872, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03968253968253968, "writeRatioMax": 0.03968253968253968 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.12698412698412698, "computeRatioMax": 0.12698412698412698, "endMs": "1665776778736", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776778697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007936507936507936, "waitRatioMax": 0.007936507936507936, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.1111111111111111, "writeRatioMax": 0.1111111111111111 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.06349206349206349, "computeRatioMax": 0.15079365079365079, "endMs": "1665776778823", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "4759", "startMs": "1665776778747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.023809523809523808, "waitRatioMax": 0.031746031746031744, "writeMsAvg": "17", "writeMsMax": "45", "writeRatioAvg": 0.1349206349206349, "writeRatioMax": 0.35714285714285715 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.15079365079365079, "computeRatioMax": 0.15079365079365079, "endMs": "1665776778843", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03968253968253968, "readRatioMax": 0.03968253968253968, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776778759", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.031746031746031744, "waitRatioMax": 0.031746031746031744, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03968253968253968, "writeRatioMax": 0.03968253968253968 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.03968253968253968, "computeRatioMax": 0.03968253968253968, "endMs": "1665776778910", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776778875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015873015873015872, "waitRatioMax": 0.015873015873015872, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.11904761904761904, "writeRatioMax": 0.11904761904761904 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.05555555555555555, "endMs": "1665776778927", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0873015873015873, "readRatioMax": 0.0873015873015873, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776778889", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007936507936507936, "waitRatioMax": 0.007936507936507936, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.06349206349206349, "writeRatioMax": 0.06349206349206349 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.09523809523809523, "computeRatioMax": 0.09523809523809523, "endMs": "1665776778948", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.07142857142857142, "readRatioMax": 0.07142857142857142, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776778907", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015873015873015872, "waitRatioMax": 0.015873015873015872, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0873015873015873, "writeRatioMax": 0.0873015873015873 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "19", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.15079365079365079, "endMs": "1665776779014", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3454", "startMs": "1665776778957", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.023809523809523808, "waitRatioMax": 0.07142857142857142, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.1111111111111111, "writeRatioMax": 0.21428571428571427 }, { "completedParallelInputs": "6", "computeMsAvg": "105", "computeMsMax": "126", "computeRatioAvg": 0.8333333333333334, "computeRatioMax": 1, "endMs": "1665776779114", "id": "11", "inputStages": [ "7", "10", "8" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.10317460317460317, "readRatioMax": 0.1349206349206349, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "799", "startMs": "1665776778973", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.007936507936507936, "waitRatioMax": 0.015873015873015872, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.06349206349206349, "writeRatioMax": 0.07936507936507936 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.05555555555555555, "endMs": "1665776779166", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776779129", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015873015873015872, "waitRatioMax": 0.015873015873015872, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.2222222222222222, "writeRatioMax": 0.2222222222222222 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.047619047619047616, "endMs": "1665776779192", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776779149", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007936507936507936, "waitRatioMax": 0.007936507936507936, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.06349206349206349, "writeRatioMax": 0.06349206349206349 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "207", "elapsedMs": "629", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "8515" }, { "activeUnits": "6", "completedUnits": "215", "elapsedMs": "859", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9365" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "9365", "transferredBytes": "0" }, "startTime": "1665776778388", "totalBytesProcessed": "91590020", "totalSlotMs": "9365" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon89c5872b_fca8_4881_95ed_bd79d09ded32" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "DzSK1xruZ5RPAxRdPiZrHw==", "id": "test-project-364309:europe-west1.query08_1665776780", "jobReference": { "jobId": "query08_1665776780", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776780?location=europe-west1", "statistics": { "creationTime": "1665776780979", "endTime": "1665776781855", "finalExecutionDurationMs": "632", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "654" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.16556291390728478, "computeRatioMax": 0.16556291390728478, "endMs": "1665776781193", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.033112582781456956, "readRatioMax": 0.033112582781456956, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776781160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006622516556291391, "waitRatioMax": 0.006622516556291391, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.059602649006622516, "writeRatioMax": 0.059602649006622516 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.2251655629139073, "computeRatioMax": 0.2251655629139073, "endMs": "1665776781250", "id": "2", "inputStages": [ "1" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.052980132450331126, "readRatioMax": 0.052980132450331126, "recordsRead": "150000", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776781212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $50 = $40" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013245033112582781, "waitRatioMax": 0.013245033112582781, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.026490066225165563, "writeRatioMax": 0.026490066225165563 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0728476821192053, "computeRatioMax": 0.0728476821192053, "endMs": "1665776781314", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776781277", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006622516556291391, "waitRatioMax": 0.006622516556291391, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.17218543046357615, "writeRatioMax": 0.17218543046357615 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.059602649006622516, "computeRatioMax": 0.13245033112582782, "endMs": "1665776781396", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "4354", "startMs": "1665776781328", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.019867549668874173, "waitRatioMax": 0.026490066225165563, "writeMsAvg": "18", "writeMsMax": "38", "writeRatioAvg": 0.11920529801324503, "writeRatioMax": 0.25165562913907286 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.19205298013245034, "computeRatioMax": 0.19205298013245034, "endMs": "1665776781421", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.046357615894039736, "readRatioMax": 0.046357615894039736, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776781337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.026490066225165563, "waitRatioMax": 0.026490066225165563, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.026490066225165563, "writeRatioMax": 0.026490066225165563 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0728476821192053, "computeRatioMax": 0.0728476821192053, "endMs": "1665776781492", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776781454", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006622516556291391, "waitRatioMax": 0.006622516556291391, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.09933774834437085, "writeRatioMax": 0.09933774834437085 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.039735099337748346, "computeRatioMax": 0.039735099337748346, "endMs": "1665776781499", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.033112582781456956, "readRatioMax": 0.033112582781456956, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776781469", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006622516556291391, "waitRatioMax": 0.006622516556291391, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.11920529801324503, "writeRatioMax": 0.11920529801324503 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.09271523178807947, "computeRatioMax": 0.09271523178807947, "endMs": "1665776781519", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.046357615894039736, "readRatioMax": 0.046357615894039736, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776781482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006622516556291391, "waitRatioMax": 0.006622516556291391, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.052980132450331126, "writeRatioMax": 0.052980132450331126 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.052980132450331126, "computeRatioMax": 0.10596026490066225, "endMs": "1665776781592", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3845", "startMs": "1665776781535", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "7", "waitRatioAvg": 0.013245033112582781, "waitRatioMax": 0.046357615894039736, "writeMsAvg": "22", "writeMsMax": "31", "writeRatioAvg": 0.1456953642384106, "writeRatioMax": 0.2052980132450331 }, { "completedParallelInputs": "6", "computeMsAvg": "99", "computeMsMax": "151", "computeRatioAvg": 0.6556291390728477, "computeRatioMax": 1, "endMs": "1665776781693", "id": "11", "inputStages": [ "7", "10", "8" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.0728476821192053, "readRatioMax": 0.11258278145695365, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "736", "startMs": "1665776781548", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.006622516556291391, "waitRatioMax": 0.013245033112582781, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.039735099337748346, "writeRatioMax": 0.046357615894039736 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.052980132450331126, "computeRatioMax": 0.052980132450331126, "endMs": "1665776781738", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776781699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013245033112582781, "waitRatioMax": 0.013245033112582781, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.09271523178807947, "writeRatioMax": 0.09271523178807947 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0728476821192053, "computeRatioMax": 0.0728476821192053, "endMs": "1665776781747", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776781715", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006622516556291391, "waitRatioMax": 0.006622516556291391, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.052980132450331126, "writeRatioMax": 0.052980132450331126 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "211", "elapsedMs": "616", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "8910" }, { "activeUnits": "3", "completedUnits": "215", "elapsedMs": "760", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9238" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "9238", "transferredBytes": "0" }, "startTime": "1665776781031", "totalBytesProcessed": "91590020", "totalSlotMs": "9238" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon702b11ce_e164_4459_af6e_2119146e2686" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "vEOJcqmBOq07cT9aBtWySw==", "id": "test-project-364309:europe-west1.query08_1665776782", "jobReference": { "jobId": "query08_1665776782", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776782?location=europe-west1", "statistics": { "creationTime": "1665776783390", "endTime": "1665776784299", "finalExecutionDurationMs": "679", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "653" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.19745222929936307, "computeRatioMax": 0.19745222929936307, "endMs": "1665776783614", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.06369426751592357, "readRatioMax": 0.06369426751592357, "recordsRead": "100000", "recordsWritten": "47428", "shuffleOutputBytes": "426852", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665776783553", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.15286624203821655, "writeRatioMax": 0.15286624203821655 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.2802547770700637, "computeRatioMax": 0.2802547770700637, "endMs": "1665776783668", "id": "2", "inputStages": [ "0" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.050955414012738856, "readRatioMax": 0.050955414012738856, "recordsRead": "97428", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665776783620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.050955414012738856, "writeRatioMax": 0.050955414012738856 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07006369426751592, "computeRatioMax": 0.07006369426751592, "endMs": "1665776783740", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776783690", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.17834394904458598, "writeRatioMax": 0.17834394904458598 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.050955414012738856, "computeRatioMax": 0.12101910828025478, "endMs": "1665776783817", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "4406", "startMs": "1665776783747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012738853503184714, "waitRatioMax": 0.01910828025477707, "writeMsAvg": "28", "writeMsMax": "55", "writeRatioAvg": 0.17834394904458598, "writeRatioMax": 0.3503184713375796 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.09554140127388536, "computeRatioMax": 0.09554140127388536, "endMs": "1665776783844", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.025477707006369428, "readRatioMax": 0.025477707006369428, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665776783821", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012738853503184714, "waitRatioMax": 0.012738853503184714, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03184713375796178, "writeRatioMax": 0.03184713375796178 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.050955414012738856, "computeRatioMax": 0.050955414012738856, "endMs": "1665776783919", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776783876", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.1592356687898089, "writeRatioMax": 0.1592356687898089 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.050955414012738856, "computeRatioMax": 0.050955414012738856, "endMs": "1665776783931", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.01910828025477707, "readRatioMax": 0.01910828025477707, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776783895", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.09554140127388536, "writeRatioMax": 0.09554140127388536 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07006369426751592, "computeRatioMax": 0.07006369426751592, "endMs": "1665776783956", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.050955414012738856, "readRatioMax": 0.050955414012738856, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776783911", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08917197452229299, "writeRatioMax": 0.08917197452229299 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.050955414012738856, "computeRatioMax": 0.10191082802547771, "endMs": "1665776784016", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3448", "startMs": "1665776783967", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012738853503184714, "waitRatioMax": 0.01910828025477707, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.08917197452229299, "writeRatioMax": 0.12101910828025478 }, { "completedParallelInputs": "6", "computeMsAvg": "124", "computeMsMax": "157", "computeRatioAvg": 0.7898089171974523, "computeRatioMax": 1, "endMs": "1665776784121", "id": "11", "inputStages": [ "8", "10", "7" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.08280254777070063, "readRatioMax": 0.10191082802547771, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "762", "startMs": "1665776783980", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.012738853503184714, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.044585987261146494, "writeRatioMax": 0.050955414012738856 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.03184713375796178, "computeRatioMax": 0.03184713375796178, "endMs": "1665776784170", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776784136", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012738853503184714, "waitRatioMax": 0.012738853503184714, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.09554140127388536, "writeRatioMax": 0.09554140127388536 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.08280254777070063, "computeRatioMax": 0.08280254777070063, "endMs": "1665776784193", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776784151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.050955414012738856, "writeRatioMax": 0.050955414012738856 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "207", "elapsedMs": "616", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "8290" }, { "activeUnits": "6", "completedUnits": "215", "elapsedMs": "806", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9048" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "9048", "transferredBytes": "0" }, "startTime": "1665776783438", "totalBytesProcessed": "91590020", "totalSlotMs": "9048" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf7911f6c_0c7b_4c84_9250_d43fb877c72a" }, "priority": "INTERACTIVE", "query": "-- start query 8 in stream 0 using template query8.tpl\nselect s_store_name\n ,sum(ss_net_profit)\n from store_sales\n ,date_dim\n ,store,\n (select ca_zip\n from (\n SELECT substr(ca_zip,1,5) ca_zip\n FROM customer_address\n WHERE substr(ca_zip,1,5) IN (\n '24128',\n '76232',\n '65084',\n '87816',\n '83926',\n '77556',\n '20548',\n '26231',\n '43848',\n '15126',\n '91137',\n '61265',\n '98294',\n '25782',\n '17920',\n '18426',\n '98235',\n '40081',\n '84093',\n '28577',\n '55565',\n '17183',\n '54601',\n '67897',\n '22752',\n '86284',\n '18376',\n '38607',\n '45200',\n '21756',\n '29741',\n '96765',\n '23932',\n '89360',\n '29839',\n '25989',\n '28898',\n '91068',\n '72550',\n '10390',\n '18845',\n '47770',\n '82636',\n '41367',\n '76638',\n '86198',\n '81312',\n '37126',\n '39192',\n '88424',\n '72175',\n '81426',\n '53672',\n '10445',\n '42666',\n '66864',\n '66708',\n '41248',\n '48583',\n '82276',\n '18842',\n '78890',\n '49448',\n '14089',\n '38122',\n '34425',\n '79077',\n '19849',\n '43285',\n '39861',\n '66162',\n '77610',\n '13695',\n '99543',\n '83444',\n '83041',\n '12305',\n '57665',\n '68341',\n '25003',\n '57834',\n '62878',\n '49130',\n '81096',\n '18840',\n '27700',\n '23470',\n '50412',\n '21195',\n '16021',\n '76107',\n '71954',\n '68309',\n '18119',\n '98359',\n '64544',\n '10336',\n '86379',\n '27068',\n '39736',\n '98569',\n '28915',\n '24206',\n '56529',\n '57647',\n '54917',\n '42961',\n '91110',\n '63981',\n '14922',\n '36420',\n '23006',\n '67467',\n '32754',\n '30903',\n '20260',\n '31671',\n '51798',\n '72325',\n '85816',\n '68621',\n '13955',\n '36446',\n '41766',\n '68806',\n '16725',\n '15146',\n '22744',\n '35850',\n '88086',\n '51649',\n '18270',\n '52867',\n '39972',\n '96976',\n '63792',\n '11376',\n '94898',\n '13595',\n '10516',\n '90225',\n '58943',\n '39371',\n '94945',\n '28587',\n '96576',\n '57855',\n '28488',\n '26105',\n '83933',\n '25858',\n '34322',\n '44438',\n '73171',\n '30122',\n '34102',\n '22685',\n '71256',\n '78451',\n '54364',\n '13354',\n '45375',\n '40558',\n '56458',\n '28286',\n '45266',\n '47305',\n '69399',\n '83921',\n '26233',\n '11101',\n '15371',\n '69913',\n '35942',\n '15882',\n '25631',\n '24610',\n '44165',\n '99076',\n '33786',\n '70738',\n '26653',\n '14328',\n '72305',\n '62496',\n '22152',\n '10144',\n '64147',\n '48425',\n '14663',\n '21076',\n '18799',\n '30450',\n '63089',\n '81019',\n '68893',\n '24996',\n '51200',\n '51211',\n '45692',\n '92712',\n '70466',\n '79994',\n '22437',\n '25280',\n '38935',\n '71791',\n '73134',\n '56571',\n '14060',\n '19505',\n '72425',\n '56575',\n '74351',\n '68786',\n '51650',\n '20004',\n '18383',\n '76614',\n '11634',\n '18906',\n '15765',\n '41368',\n '73241',\n '76698',\n '78567',\n '97189',\n '28545',\n '76231',\n '75691',\n '22246',\n '51061',\n '90578',\n '56691',\n '68014',\n '51103',\n '94167',\n '57047',\n '14867',\n '73520',\n '15734',\n '63435',\n '25733',\n '35474',\n '24676',\n '94627',\n '53535',\n '17879',\n '15559',\n '53268',\n '59166',\n '11928',\n '59402',\n '33282',\n '45721',\n '43933',\n '68101',\n '33515',\n '36634',\n '71286',\n '19736',\n '58058',\n '55253',\n '67473',\n '41918',\n '19515',\n '36495',\n '19430',\n '22351',\n '77191',\n '91393',\n '49156',\n '50298',\n '87501',\n '18652',\n '53179',\n '18767',\n '63193',\n '23968',\n '65164',\n '68880',\n '21286',\n '72823',\n '58470',\n '67301',\n '13394',\n '31016',\n '70372',\n '67030',\n '40604',\n '24317',\n '45748',\n '39127',\n '26065',\n '77721',\n '31029',\n '31880',\n '60576',\n '24671',\n '45549',\n '13376',\n '50016',\n '33123',\n '19769',\n '22927',\n '97789',\n '46081',\n '72151',\n '15723',\n '46136',\n '51949',\n '68100',\n '96888',\n '64528',\n '14171',\n '79777',\n '28709',\n '11489',\n '25103',\n '32213',\n '78668',\n '22245',\n '15798',\n '27156',\n '37930',\n '62971',\n '21337',\n '51622',\n '67853',\n '10567',\n '38415',\n '15455',\n '58263',\n '42029',\n '60279',\n '37125',\n '56240',\n '88190',\n '50308',\n '26859',\n '64457',\n '89091',\n '82136',\n '62377',\n '36233',\n '63837',\n '58078',\n '17043',\n '30010',\n '60099',\n '28810',\n '98025',\n '29178',\n '87343',\n '73273',\n '30469',\n '64034',\n '39516',\n '86057',\n '21309',\n '90257',\n '67875',\n '40162',\n '11356',\n '73650',\n '61810',\n '72013',\n '30431',\n '22461',\n '19512',\n '13375',\n '55307',\n '30625',\n '83849',\n '68908',\n '26689',\n '96451',\n '38193',\n '46820',\n '88885',\n '84935',\n '69035',\n '83144',\n '47537',\n '56616',\n '94983',\n '48033',\n '69952',\n '25486',\n '61547',\n '27385',\n '61860',\n '58048',\n '56910',\n '16807',\n '17871',\n '35258',\n '31387',\n '35458',\n '35576')\n intersect distinct\n select ca_zip\n from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n FROM customer_address, customer\n WHERE ca_address_sk = c_current_addr_sk and\n c_preferred_cust_flag='Y'\n group by ca_zip\n having count(*) > 10)A1)A2) V1\n where ss_store_sk = s_store_sk\n and ss_sold_date_sk = d_date_sk\n and d_qoy = 2 and d_year = 1998\n and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\n group by s_store_name\n order by s_store_name\n limit 100;\n\n-- end query 8 in stream 0 using template query8.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ptKqfdK8QaKeormASn68Xg==", "id": "test-project-364309:europe-west1.query08_1665776785", "jobReference": { "jobId": "query08_1665776785", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query08_1665776785?location=europe-west1", "statistics": { "creationTime": "1665776785868", "endTime": "1665776786734", "finalExecutionDurationMs": "610", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "91590020", "performanceInsights": { "avgPreviousExecutionMs": "654" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.1564625850340136, "computeRatioMax": 0.1564625850340136, "endMs": "1665776786107", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.08163265306122448, "readRatioMax": 0.08163265306122448, "recordsRead": "100000", "recordsWritten": "47428", "shuffleOutputBytes": "426852", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776786059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_current_addr_sk, $51:c_preferred_cust_flag", "FROM customer", "WHERE equal($51, 'Y')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.14285714285714285, "writeRatioMax": 0.14285714285714285 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.29931972789115646, "computeRatioMax": 0.29931972789115646, "endMs": "1665776786160", "id": "2", "inputStages": [ "0" ], "name": "S02: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.047619047619047616, "readRatioMax": 0.047619047619047616, "recordsRead": "97428", "recordsWritten": "3146", "shuffleOutputBytes": "59765", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776786116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_zip", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $130", "$120 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := substr($170, 1, 5)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$120, $180", "TO __stage02_output", "BY HASH($180)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.027210884353741496, "writeRatioMax": 0.027210884353741496 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.10204081632653061, "computeRatioMax": 0.10204081632653061, "endMs": "1665776786225", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3146", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776786184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $180", "FROM __stage02_output" ] }, { "kind": "FILTER", "substeps": [ "greater($110, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$110 := SUM_OF_COUNTS($120)" ] }, { "kind": "WRITE", "substeps": [ "$190", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.10884353741496598, "writeRatioMax": 0.10884353741496598 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.08843537414965986, "endMs": "1665776786296", "id": "4", "inputStages": [ "3" ], "name": "S04: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "962", "recordsWritten": "962", "shuffleOutputBytes": "9611", "shuffleOutputBytesSpilled": "0", "slotMs": "3823", "startMs": "1665776786238", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.02040816326530612, "waitRatioMax": 0.04081632653061224, "writeMsAvg": "22", "writeMsMax": "30", "writeRatioAvg": 0.14965986394557823, "writeRatioMax": 0.20408163265306123 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.17006802721088435, "computeRatioMax": 0.17006802721088435, "endMs": "1665776786321", "id": "5", "inputStages": [ "4" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04081632653061224, "readRatioMax": 0.04081632653061224, "recordsRead": "50962", "recordsWritten": "5", "shuffleOutputBytes": "50", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776786247", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_zip", "FROM customer_address", "WHERE in(substr($30, 1, 5), '24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', ...)" ] }, { "kind": "READ", "substeps": [ "$190", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200" ] }, { "kind": "JOIN", "substeps": [ "$200 := $160", "SEMI HASH JOIN EACH WITH ALL ON $160 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $100" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := substr($30, 1, 5)" ] }, { "kind": "WRITE", "substeps": [ "$210", "TO __stage05_output", "BY HASH($210)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.034013605442176874, "writeRatioMax": 0.034013605442176874 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05442176870748299, "computeRatioMax": 0.05442176870748299, "endMs": "1665776786389", "id": "6", "inputStages": [ "5" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776786358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210", "FROM __stage05_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := substr($220, 1, 2)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006802721088435374, "waitRatioMax": 0.006802721088435374, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.09523809523809523, "writeRatioMax": 0.09523809523809523 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05442176870748299, "computeRatioMax": 0.05442176870748299, "endMs": "1665776786413", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04081632653061224, "readRatioMax": 0.04081632653061224, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776786372", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006802721088435374, "waitRatioMax": 0.006802721088435374, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.11564625850340136, "writeRatioMax": 0.11564625850340136 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.061224489795918366, "computeRatioMax": 0.061224489795918366, "endMs": "1665776786428", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.034013605442176874, "readRatioMax": 0.034013605442176874, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776786387", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim", "WHERE and(equal($22, 2), equal($21, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.10204081632653061, "writeRatioMax": 0.10204081632653061 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.05442176870748299, "computeRatioMax": 0.08843537414965986, "endMs": "1665776786492", "id": "10", "inputStages": [ "6" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "3465", "startMs": "1665776786437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "8", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.05442176870748299, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.09523809523809523, "writeRatioMax": 0.14965986394557823 }, { "completedParallelInputs": "6", "computeMsAvg": "115", "computeMsMax": "147", "computeRatioAvg": 0.782312925170068, "computeRatioMax": 1, "endMs": "1665776786578", "id": "11", "inputStages": [ "8", "7", "10" ], "name": "S0B: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "21", "readRatioAvg": 0.09523809523809523, "readRatioMax": 0.14285714285714285, "recordsRead": "2881052", "recordsWritten": "30", "shuffleOutputBytes": "780", "shuffleOutputBytesSpilled": "0", "slotMs": "881", "startMs": "1665776786451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$70 := SUM($231)" ] }, { "kind": "JOIN", "substeps": [ "$230 := $151, $231 := $150", "INNER HASH JOIN EACH WITH ALL ON $80 = $90" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := substr($152, 1, 2)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $2, $152 := $3", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "JOIN", "substeps": [ "$140 := $11, $141 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "WRITE", "substeps": [ "$240, $70", "TO __stage0B_output", "BY HASH($240)" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.006802721088435374, "waitRatioMax": 0.027210884353741496, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.047619047619047616, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08163265306122448, "computeRatioMax": 0.08163265306122448, "endMs": "1665776786618", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776786583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240, $70", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$250 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006802721088435374, "waitRatioMax": 0.006802721088435374, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.08843537414965986, "writeRatioMax": 0.08843537414965986 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.061224489795918366, "computeRatioMax": 0.061224489795918366, "endMs": "1665776786629", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "130", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776786600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013605442176870748, "waitRatioMax": 0.013605442176870748, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04081632653061224, "writeRatioMax": 0.04081632653061224 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "208", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "7654" }, { "activeUnits": "5", "completedUnits": "215", "elapsedMs": "752", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8482" } ], "totalBytesBilled": "92274688", "totalBytesProcessed": "91590020", "totalPartitionsProcessed": "0", "totalSlotMs": "8482", "transferredBytes": "0" }, "startTime": "1665776785927", "totalBytesProcessed": "91590020", "totalSlotMs": "8482" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
