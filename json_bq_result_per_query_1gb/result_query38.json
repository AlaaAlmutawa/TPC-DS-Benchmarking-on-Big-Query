{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5af47a65_ec34_417f_baff_fe0244fb8335" }, "priority": "INTERACTIVE", "query": "select count(*) from (\n select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n) hot_cust\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/AXH17Nl2V6D4RPYq1ruTw==", "id": "test-project-364309:europe-west1.query38_1665768335", "jobReference": { "jobId": "query38_1665768335", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query38_1665768335?location=europe-west1", "statistics": { "creationTime": "1665768335846", "endTime": "1665768336935", "finalExecutionDurationMs": "894", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "842" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "73", "computeMsMax": "73", "computeRatioAvg": 0.25, "computeRatioMax": 0.25, "endMs": "1665768336074", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030821917808219176, "readRatioMax": 0.030821917808219176, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "125", "startMs": "1665768335985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003424657534246575, "waitRatioMax": 0.003424657534246575, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03767123287671233, "writeRatioMax": 0.03767123287671233 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03767123287671233, "computeRatioMax": 0.03767123287671233, "endMs": "1665768336054", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0273972602739726, "readRatioMax": 0.0273972602739726, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768336010", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04452054794520548, "writeRatioMax": 0.04452054794520548 }, { "completedParallelInputs": "1", "computeMsAvg": "113", "computeMsMax": "113", "computeRatioAvg": 0.386986301369863, "computeRatioMax": 0.386986301369863, "endMs": "1665768336153", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030821917808219176, "readRatioMax": 0.030821917808219176, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "177", "startMs": "1665768336040", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003424657534246575, "waitRatioMax": 0.003424657534246575, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.05821917808219178, "writeRatioMax": 0.05821917808219178 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03424657534246575, "computeRatioMax": 0.03424657534246575, "endMs": "1665768336095", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02054794520547945, "readRatioMax": 0.02054794520547945, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768336055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04794520547945205, "writeRatioMax": 0.04794520547945205 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.3732876712328767, "computeRatioMax": 0.3732876712328767, "endMs": "1665768336224", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03424657534246575, "readRatioMax": 0.03424657534246575, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "153", "startMs": "1665768336113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "30", "waitMsMax": "30", "waitRatioAvg": 0.10273972602739725, "waitRatioMax": 0.10273972602739725, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04794520547945205, "writeRatioMax": 0.04794520547945205 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0273972602739726, "computeRatioMax": 0.0273972602739726, "endMs": "1665768336151", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0136986301369863, "readRatioMax": 0.0136986301369863, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768336114", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "16", "waitMsMax": "16", "waitRatioAvg": 0.0547945205479452, "waitRatioMax": 0.0547945205479452, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04794520547945205, "writeRatioMax": 0.04794520547945205 }, { "completedParallelInputs": "5", "computeMsAvg": "194", "computeMsMax": "231", "computeRatioAvg": 0.6643835616438356, "computeRatioMax": 0.791095890410959, "endMs": "1665768336295", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "8", "readMsMax": "10", "readRatioAvg": 0.0273972602739726, "readRatioMax": 0.03424657534246575, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "953", "startMs": "1665768336138", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003424657534246575, "waitRatioMax": 0.003424657534246575, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.023972602739726026, "writeRatioMax": 0.03424657534246575 }, { "completedParallelInputs": "6", "computeMsAvg": "254", "computeMsMax": "292", "computeRatioAvg": 0.8698630136986302, "computeRatioMax": 1, "endMs": "1665768336381", "id": "13", "inputStages": [ "3", "4" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.0410958904109589, "readRatioMax": 0.05136986301369863, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1506", "startMs": "1665768336197", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0D_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003424657534246575, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.023972602739726026, "writeRatioMax": 0.030821917808219176 }, { "completedParallelInputs": "1", "computeMsAvg": "200", "computeMsMax": "200", "computeRatioAvg": 0.684931506849315, "computeRatioMax": 0.684931506849315, "endMs": "1665768336428", "id": "14", "inputStages": [ "6", "7" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03424657534246575, "readRatioMax": 0.03424657534246575, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "281", "startMs": "1665768336269", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.07534246575342465, "writeRatioMax": 0.07534246575342465 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.08561643835616438, "computeRatioMax": 0.08561643835616438, "endMs": "1665768336520", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665768336476", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.07534246575342465, "writeRatioMax": 0.07534246575342465 }, { "completedParallelInputs": "1", "computeMsAvg": "95", "computeMsMax": "95", "computeRatioAvg": 0.3253424657534247, "computeRatioMax": 0.3253424657534247, "endMs": "1665768336577", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "121", "startMs": "1665768336492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003424657534246575, "waitRatioMax": 0.003424657534246575, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.0821917808219178, "writeRatioMax": 0.0821917808219178 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.030821917808219176, "computeRatioMax": 0.0684931506849315, "endMs": "1665768336643", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "4044", "startMs": "1665768336589", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.017123287671232876, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.05136986301369863, "writeRatioMax": 0.0958904109589041 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "22", "computeRatioAvg": 0.0273972602739726, "computeRatioMax": 0.07534246575342465, "endMs": "1665768336654", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "4225", "startMs": "1665768336589", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.0136986301369863, "waitRatioMax": 0.02054794520547945, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.04794520547945205, "writeRatioMax": 0.07191780821917808 }, { "completedParallelInputs": "1", "computeMsAvg": "242", "computeMsMax": "242", "computeRatioAvg": 0.8287671232876712, "computeRatioMax": 0.8287671232876712, "endMs": "1665768336776", "id": "19", "inputStages": [ "18", "17", "13" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "107", "shuffleOutputBytes": "749", "shuffleOutputBytesSpilled": "0", "slotMs": "242", "startMs": "1665768336608", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "SEMI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "SEMI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003424657534246575, "waitRatioMax": 0.003424657534246575, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010273972602739725, "writeRatioMax": 0.010273972602739725 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.030821917808219176, "computeRatioMax": 0.030821917808219176, "endMs": "1665768336827", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "107", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768336786", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003424657534246575, "waitRatioMax": 0.003424657534246575, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.06164383561643835, "writeRatioMax": 0.06164383561643835 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.030821917808219176, "computeRatioMax": 0.030821917808219176, "endMs": "1665768336847", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665768336801", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003424657534246575, "waitRatioMax": 0.003424657534246575, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02054794520547945, "writeRatioMax": 0.02054794520547945 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "18", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3337" }, { "activeUnits": "1", "completedUnits": "223", "elapsedMs": "990", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12055" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "12055", "transferredBytes": "0" }, "startTime": "1665768335891", "totalBytesProcessed": "82559911", "totalSlotMs": "12055" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonfe99c277_67fb_4d92_8476_fe4ceb588274" }, "priority": "INTERACTIVE", "query": "select count(*) from (\n select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n) hot_cust\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2HFTl27Qe+CzB+bpnt+KCA==", "id": "test-project-364309:europe-west1.query38_1665777362", "jobReference": { "jobId": "query38_1665777362", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query38_1665777362?location=europe-west1", "statistics": { "creationTime": "1665777363184", "endTime": "1665777364210", "finalExecutionDurationMs": "802", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "850" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "156", "computeMsMax": "156", "computeRatioAvg": 0.3979591836734694, "computeRatioMax": 0.3979591836734694, "endMs": "1665777363462", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017857142857142856, "readRatioMax": 0.017857142857142856, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665777363344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.025510204081632654, "writeRatioMax": 0.025510204081632654 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04081632653061224, "computeRatioMax": 0.04081632653061224, "endMs": "1665777363399", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015306122448979591, "readRatioMax": 0.015306122448979591, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777363359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "82", "computeMsMax": "82", "computeRatioAvg": 0.20918367346938777, "computeRatioMax": 0.20918367346938777, "endMs": "1665777363483", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02295918367346939, "readRatioMax": 0.02295918367346939, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "109", "startMs": "1665777363388", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.030612244897959183, "writeRatioMax": 0.030612244897959183 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03316326530612245, "computeRatioMax": 0.03316326530612245, "endMs": "1665777363439", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017857142857142856, "readRatioMax": 0.017857142857142856, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777363403", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02040816326530612, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "1", "computeMsAvg": "121", "computeMsMax": "121", "computeRatioAvg": 0.3086734693877551, "computeRatioMax": 0.3086734693877551, "endMs": "1665777363537", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017857142857142856, "readRatioMax": 0.017857142857142856, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "127", "startMs": "1665777363432", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.030612244897959183, "writeRatioMax": 0.030612244897959183 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03826530612244898, "computeRatioMax": 0.03826530612244898, "endMs": "1665777363490", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017857142857142856, "readRatioMax": 0.017857142857142856, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777363448", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.030612244897959183, "writeRatioMax": 0.030612244897959183 }, { "completedParallelInputs": "5", "computeMsAvg": "185", "computeMsMax": "233", "computeRatioAvg": 0.4719387755102041, "computeRatioMax": 0.5943877551020408, "endMs": "1665777363636", "id": "11", "inputStages": [ "1", "0" ], "name": "S0B: Join+", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "11", "readRatioAvg": 0.02295918367346939, "readRatioMax": 0.02806122448979592, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "841", "startMs": "1665777363501", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0B_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.015306122448979591, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "6", "computeMsAvg": "270", "computeMsMax": "392", "computeRatioAvg": 0.6887755102040817, "computeRatioMax": 1, "endMs": "1665777363740", "id": "12", "inputStages": [ "3", "4" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "13", "readRatioAvg": 0.02295918367346939, "readRatioMax": 0.03316326530612245, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1395", "startMs": "1665777363506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0C_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.015306122448979591, "writeRatioMax": 0.017857142857142856 }, { "completedParallelInputs": "1", "computeMsAvg": "212", "computeMsMax": "212", "computeRatioAvg": 0.5408163265306123, "computeRatioMax": 0.5408163265306123, "endMs": "1665777363706", "id": "14", "inputStages": [ "7", "6" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.02806122448979592, "readRatioMax": 0.02806122448979592, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665777363560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.05102040816326531, "writeRatioMax": 0.05102040816326531 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.061224489795918366, "computeRatioMax": 0.061224489795918366, "endMs": "1665777363808", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777363771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05612244897959184, "writeRatioMax": 0.05612244897959184 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.2780612244897959, "computeRatioMax": 0.2780612244897959, "endMs": "1665777363875", "id": "16", "inputStages": [ "11" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "113", "startMs": "1665777363787", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.058673469387755105, "writeRatioMax": 0.058673469387755105 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.02295918367346939, "computeRatioMax": 0.05357142857142857, "endMs": "1665777363952", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3342", "startMs": "1665777363896", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.03826530612244898, "writeRatioMax": 0.06887755102040816 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.02040816326530612, "computeRatioMax": 0.05102040816326531, "endMs": "1665777363955", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "2839", "startMs": "1665777363896", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "9", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.02295918367346939, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.03826530612244898, "writeRatioMax": 0.0663265306122449 }, { "completedParallelInputs": "1", "computeMsAvg": "131", "computeMsMax": "131", "computeRatioAvg": 0.33418367346938777, "computeRatioMax": 0.33418367346938777, "endMs": "1665777364034", "id": "19", "inputStages": [ "17", "18", "12" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "107", "shuffleOutputBytes": "749", "shuffleOutputBytesSpilled": "0", "slotMs": "112", "startMs": "1665777363910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "SEMI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "SEMI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007653061224489796, "waitRatioMax": 0.007653061224489796, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01020408163265306, "writeRatioMax": 0.01020408163265306 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015306122448979591, "computeRatioMax": 0.015306122448979591, "endMs": "1665777364100", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "107", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777364064", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.00510204081632653, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.025510204081632654, "computeRatioMax": 0.025510204081632654, "endMs": "1665777364108", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777364079", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002551020408163265, "waitRatioMax": 0.002551020408163265, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.015306122448979591, "writeRatioMax": 0.015306122448979591 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "19", "elapsedMs": "607", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2985" }, { "activeUnits": "1", "completedUnits": "223", "elapsedMs": "909", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9455" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "9455", "transferredBytes": "0" }, "startTime": "1665777363239", "totalBytesProcessed": "82559911", "totalSlotMs": "9455" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon37f629d0_291c_4239_b449_40ece8df51b5" }, "priority": "INTERACTIVE", "query": "select count(*) from (\n select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n) hot_cust\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8Qoig8jIimmbJCAP2gR6hA==", "id": "test-project-364309:europe-west1.query38_1665777365", "jobReference": { "jobId": "query38_1665777365", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query38_1665777365?location=europe-west1", "statistics": { "creationTime": "1665777365794", "endTime": "1665777366856", "finalExecutionDurationMs": "865", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "844" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "86", "computeMsMax": "86", "computeRatioAvg": 0.33992094861660077, "computeRatioMax": 0.33992094861660077, "endMs": "1665777366048", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03557312252964427, "readRatioMax": 0.03557312252964427, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "107", "startMs": "1665777365951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04743083003952569, "writeRatioMax": 0.04743083003952569 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.039525691699604744, "computeRatioMax": 0.039525691699604744, "endMs": "1665777366013", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019762845849802372, "readRatioMax": 0.019762845849802372, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777365970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05928853754940711, "writeRatioMax": 0.05928853754940711 }, { "completedParallelInputs": "1", "computeMsAvg": "101", "computeMsMax": "101", "computeRatioAvg": 0.39920948616600793, "computeRatioMax": 0.39920948616600793, "endMs": "1665777366107", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03162055335968379, "readRatioMax": 0.03162055335968379, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "114", "startMs": "1665777366011", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05138339920948617, "computeRatioMax": 0.05138339920948617, "endMs": "1665777366070", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.023715415019762844, "readRatioMax": 0.023715415019762844, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777366031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05533596837944664, "writeRatioMax": 0.05533596837944664 }, { "completedParallelInputs": "1", "computeMsAvg": "65", "computeMsMax": "65", "computeRatioAvg": 0.25691699604743085, "computeRatioMax": 0.25691699604743085, "endMs": "1665777366134", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03557312252964427, "readRatioMax": 0.03557312252964427, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665777366066", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03557312252964427, "writeRatioMax": 0.03557312252964427 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.06324110671936758, "computeRatioMax": 0.06324110671936758, "endMs": "1665777366124", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777366087", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "5", "computeMsAvg": "198", "computeMsMax": "253", "computeRatioAvg": 0.782608695652174, "computeRatioMax": 1, "endMs": "1665777366284", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "11", "readRatioAvg": 0.03557312252964427, "readRatioMax": 0.043478260869565216, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "843", "startMs": "1665777366136", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.019762845849802372, "writeRatioMax": 0.023715415019762844 }, { "completedParallelInputs": "6", "computeMsAvg": "215", "computeMsMax": "244", "computeRatioAvg": 0.849802371541502, "computeRatioMax": 0.9644268774703557, "endMs": "1665777366328", "id": "12", "inputStages": [ "4", "3" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "11", "readRatioAvg": 0.03557312252964427, "readRatioMax": 0.043478260869565216, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1138", "startMs": "1665777366159", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0C_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.019762845849802372, "writeRatioMax": 0.023715415019762844 }, { "completedParallelInputs": "1", "computeMsAvg": "155", "computeMsMax": "155", "computeRatioAvg": 0.6126482213438735, "computeRatioMax": 0.6126482213438735, "endMs": "1665777366330", "id": "14", "inputStages": [ "7", "6" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.023715415019762844, "readRatioMax": 0.023715415019762844, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "156", "startMs": "1665777366202", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007905138339920948, "waitRatioMax": 0.007905138339920948, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.08695652173913043, "writeRatioMax": 0.08695652173913043 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.14624505928853754, "computeRatioMax": 0.14624505928853754, "endMs": "1665777366413", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665777366361", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.09090909090909091, "writeRatioMax": 0.09090909090909091 }, { "completedParallelInputs": "1", "computeMsAvg": "95", "computeMsMax": "95", "computeRatioAvg": 0.37549407114624506, "computeRatioMax": 0.37549407114624506, "endMs": "1665777366460", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "96", "startMs": "1665777366381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.1067193675889328, "writeRatioMax": 0.1067193675889328 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.03557312252964427, "computeRatioMax": 0.07114624505928854, "endMs": "1665777366539", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3393", "startMs": "1665777366481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.007905138339920948, "waitRatioMax": 0.019762845849802372, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.05928853754940711, "writeRatioMax": 0.1067193675889328 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.03162055335968379, "computeRatioMax": 0.06324110671936758, "endMs": "1665777366543", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "2771", "startMs": "1665777366481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.015810276679841896, "waitRatioMax": 0.023715415019762844, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.05533596837944664, "writeRatioMax": 0.08300395256916997 }, { "completedParallelInputs": "1", "computeMsAvg": "145", "computeMsMax": "145", "computeRatioAvg": 0.5731225296442688, "computeRatioMax": 0.5731225296442688, "endMs": "1665777366661", "id": "19", "inputStages": [ "18", "17", "12" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "107", "shuffleOutputBytes": "749", "shuffleOutputBytesSpilled": "0", "slotMs": "158", "startMs": "1665777366497", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "SEMI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "SEMI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.015810276679841896, "waitRatioMax": 0.015810276679841896, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.011857707509881422, "writeRatioMax": 0.011857707509881422 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03162055335968379, "computeRatioMax": 0.03162055335968379, "endMs": "1665777366747", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "107", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777366704", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007905138339920948, "waitRatioMax": 0.007905138339920948, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07114624505928854, "writeRatioMax": 0.07114624505928854 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665777366768", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777366721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03557312252964427, "writeRatioMax": 0.03557312252964427 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "19", "elapsedMs": "611", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3419" }, { "activeUnits": "1", "completedUnits": "223", "elapsedMs": "965", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9920" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "9920", "transferredBytes": "0" }, "startTime": "1665777365842", "totalBytesProcessed": "82559911", "totalSlotMs": "9920" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2811fc2b_41a5_4966_acec_6f5444ea99db" }, "priority": "INTERACTIVE", "query": "select count(*) from (\n select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n) hot_cust\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ZCUeQsaJwh/a8v1ErQNl4w==", "id": "test-project-364309:europe-west1.query38_1665777368", "jobReference": { "jobId": "query38_1665777368", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query38_1665777368?location=europe-west1", "statistics": { "creationTime": "1665777369357", "endTime": "1665777370506", "finalExecutionDurationMs": "917", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "846" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "75", "computeMsMax": "75", "computeRatioAvg": 0.2516778523489933, "computeRatioMax": 0.2516778523489933, "endMs": "1665777369607", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030201342281879196, "readRatioMax": 0.030201342281879196, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665777369523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.040268456375838924, "writeRatioMax": 0.040268456375838924 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0436241610738255, "computeRatioMax": 0.0436241610738255, "endMs": "1665777369583", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020134228187919462, "readRatioMax": 0.020134228187919462, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777369545", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03691275167785235, "writeRatioMax": 0.03691275167785235 }, { "completedParallelInputs": "1", "computeMsAvg": "73", "computeMsMax": "73", "computeRatioAvg": 0.24496644295302014, "computeRatioMax": 0.24496644295302014, "endMs": "1665777369657", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030201342281879196, "readRatioMax": 0.030201342281879196, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665777369582", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04697986577181208, "writeRatioMax": 0.04697986577181208 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.030201342281879196, "computeRatioMax": 0.030201342281879196, "endMs": "1665777369647", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020134228187919462, "readRatioMax": 0.020134228187919462, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777369607", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04697986577181208, "writeRatioMax": 0.04697986577181208 }, { "completedParallelInputs": "1", "computeMsAvg": "101", "computeMsMax": "101", "computeRatioAvg": 0.3389261744966443, "computeRatioMax": 0.3389261744966443, "endMs": "1665777369771", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0436241610738255, "readRatioMax": 0.0436241610738255, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "139", "startMs": "1665777369647", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.06375838926174497, "writeRatioMax": 0.06375838926174497 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.06040268456375839, "computeRatioMax": 0.06040268456375839, "endMs": "1665777369715", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030201342281879196, "readRatioMax": 0.030201342281879196, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777369666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006711409395973154, "waitRatioMax": 0.006711409395973154, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.050335570469798654, "writeRatioMax": 0.050335570469798654 }, { "completedParallelInputs": "5", "computeMsAvg": "188", "computeMsMax": "211", "computeRatioAvg": 0.6308724832214765, "computeRatioMax": 0.7080536912751678, "endMs": "1665777369849", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.03355704697986577, "readRatioMax": 0.040268456375838924, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "822", "startMs": "1665777369709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006711409395973154, "waitRatioMax": 0.006711409395973154, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.020134228187919462, "writeRatioMax": 0.02348993288590604 }, { "completedParallelInputs": "6", "computeMsAvg": "244", "computeMsMax": "298", "computeRatioAvg": 0.8187919463087249, "computeRatioMax": 1, "endMs": "1665777369946", "id": "12", "inputStages": [ "3", "4" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "18", "readRatioAvg": 0.03691275167785235, "readRatioMax": 0.06040268456375839, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1563", "startMs": "1665777369738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0C_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.006711409395973154, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.02348993288590604, "writeRatioMax": 0.030201342281879196 }, { "completedParallelInputs": "1", "computeMsAvg": "166", "computeMsMax": "166", "computeRatioAvg": 0.5570469798657718, "computeRatioMax": 0.5570469798657718, "endMs": "1665777369937", "id": "14", "inputStages": [ "7", "6" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030201342281879196, "readRatioMax": 0.030201342281879196, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "182", "startMs": "1665777369792", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.08053691275167785, "writeRatioMax": 0.08053691275167785 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.06711409395973154, "computeRatioMax": 0.06711409395973154, "endMs": "1665777370047", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665777369976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006711409395973154, "waitRatioMax": 0.006711409395973154, "writeMsAvg": "56", "writeMsMax": "56", "writeRatioAvg": 0.18791946308724833, "writeRatioMax": 0.18791946308724833 }, { "completedParallelInputs": "1", "computeMsAvg": "102", "computeMsMax": "102", "computeRatioAvg": 0.3422818791946309, "computeRatioMax": 0.3422818791946309, "endMs": "1665777370075", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "83", "startMs": "1665777369996", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.07046979865771812, "writeRatioMax": 0.07046979865771812 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.030201342281879196, "computeRatioMax": 0.06040268456375839, "endMs": "1665777370154", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3874", "startMs": "1665777370095", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.006711409395973154, "waitRatioMax": 0.013422818791946308, "writeMsAvg": "21", "writeMsMax": "34", "writeRatioAvg": 0.07046979865771812, "writeRatioMax": 0.11409395973154363 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.030201342281879196, "computeRatioMax": 0.06711409395973154, "endMs": "1665777370159", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "3593", "startMs": "1665777370095", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "8", "waitRatioAvg": 0.013422818791946308, "waitRatioMax": 0.026845637583892617, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.04697986577181208, "writeRatioMax": 0.07046979865771812 }, { "completedParallelInputs": "1", "computeMsAvg": "199", "computeMsMax": "199", "computeRatioAvg": 0.6677852348993288, "computeRatioMax": 0.6677852348993288, "endMs": "1665777370298", "id": "19", "inputStages": [ "18", "17", "12" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "107", "shuffleOutputBytes": "749", "shuffleOutputBytesSpilled": "0", "slotMs": "189", "startMs": "1665777370117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "SEMI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "SEMI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.013422818791946308, "waitRatioMax": 0.013422818791946308, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010067114093959731, "writeRatioMax": 0.010067114093959731 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.020134228187919462, "computeRatioMax": 0.020134228187919462, "endMs": "1665777370364", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "107", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777370315", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.09060402684563758, "writeRatioMax": 0.09060402684563758 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02348993288590604, "computeRatioMax": 0.02348993288590604, "endMs": "1665777370392", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777370336", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003355704697986577, "waitRatioMax": 0.003355704697986577, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.020134228187919462, "writeRatioMax": 0.020134228187919462 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "18", "elapsedMs": "609", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "2987" }, { "activeUnits": "2", "completedUnits": "223", "elapsedMs": "1025", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10694" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "10694", "transferredBytes": "0" }, "startTime": "1665777369416", "totalBytesProcessed": "82559911", "totalSlotMs": "10694" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonaec98027_10e5_4a2e_a489_8187a6cae9df" }, "priority": "INTERACTIVE", "query": "select count(*) from (\n select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n) hot_cust\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "axxabazTtfLloPexFINF1g==", "id": "test-project-364309:europe-west1.query38_1665777371", "jobReference": { "jobId": "query38_1665777371", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query38_1665777371?location=europe-west1", "statistics": { "creationTime": "1665777372122", "endTime": "1665777373198", "finalExecutionDurationMs": "854", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "853" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "75", "computeMsMax": "75", "computeRatioAvg": 0.21613832853025935, "computeRatioMax": 0.21613832853025935, "endMs": "1665777372382", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.025936599423631124, "readRatioMax": 0.025936599423631124, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "98", "startMs": "1665777372293", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005763688760806916, "waitRatioMax": 0.005763688760806916, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0345821325648415, "writeRatioMax": 0.0345821325648415 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0345821325648415, "computeRatioMax": 0.0345821325648415, "endMs": "1665777372350", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.023054755043227664, "readRatioMax": 0.023054755043227664, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777372311", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.06051873198847262, "writeRatioMax": 0.06051873198847262 }, { "completedParallelInputs": "1", "computeMsAvg": "94", "computeMsMax": "94", "computeRatioAvg": 0.27089337175792505, "computeRatioMax": 0.27089337175792505, "endMs": "1665777372462", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03170028818443804, "readRatioMax": 0.03170028818443804, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "127", "startMs": "1665777372342", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005763688760806916, "waitRatioMax": 0.005763688760806916, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.06628242074927954, "writeRatioMax": 0.06628242074927954 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.05763688760806916, "computeRatioMax": 0.05763688760806916, "endMs": "1665777372393", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0345821325648415, "readRatioMax": 0.0345821325648415, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777372359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005763688760806916, "waitRatioMax": 0.005763688760806916, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.025936599423631124, "writeRatioMax": 0.025936599423631124 }, { "completedParallelInputs": "1", "computeMsAvg": "100", "computeMsMax": "100", "computeRatioAvg": 0.2881844380403458, "computeRatioMax": 0.2881844380403458, "endMs": "1665777372481", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02881844380403458, "readRatioMax": 0.02881844380403458, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "102", "startMs": "1665777372394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.040345821325648415, "writeRatioMax": 0.040345821325648415 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.040345821325648415, "computeRatioMax": 0.040345821325648415, "endMs": "1665777372467", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.020172910662824207, "readRatioMax": 0.020172910662824207, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777372415", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.05475504322766571, "writeRatioMax": 0.05475504322766571 }, { "completedParallelInputs": "5", "computeMsAvg": "191", "computeMsMax": "238", "computeRatioAvg": 0.5504322766570605, "computeRatioMax": 0.6858789625360231, "endMs": "1665777372594", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "27", "readRatioAvg": 0.0345821325648415, "readRatioMax": 0.07780979827089338, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "771", "startMs": "1665777372458", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.01440922190201729, "writeRatioMax": 0.01729106628242075 }, { "completedParallelInputs": "6", "computeMsAvg": "276", "computeMsMax": "347", "computeRatioAvg": 0.7953890489913544, "computeRatioMax": 1, "endMs": "1665777372708", "id": "12", "inputStages": [ "3", "4" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "13", "readRatioAvg": 0.025936599423631124, "readRatioMax": 0.037463976945244955, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1387", "startMs": "1665777372491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0C_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.005763688760806916, "writeMsAvg": "8", "writeMsMax": "12", "writeRatioAvg": 0.023054755043227664, "writeRatioMax": 0.0345821325648415 }, { "completedParallelInputs": "1", "computeMsAvg": "213", "computeMsMax": "213", "computeRatioAvg": 0.6138328530259366, "computeRatioMax": 0.6138328530259366, "endMs": "1665777372670", "id": "14", "inputStages": [ "6", "7" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02881844380403458, "readRatioMax": 0.02881844380403458, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "196", "startMs": "1665777372523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005763688760806916, "waitRatioMax": 0.005763688760806916, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.06340057636887608, "writeRatioMax": 0.06340057636887608 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.06628242074927954, "computeRatioMax": 0.06628242074927954, "endMs": "1665777372790", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777372739", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005763688760806916, "waitRatioMax": 0.005763688760806916, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.07204610951008646, "writeRatioMax": 0.07204610951008646 }, { "completedParallelInputs": "1", "computeMsAvg": "137", "computeMsMax": "137", "computeRatioAvg": 0.39481268011527376, "computeRatioMax": 0.39481268011527376, "endMs": "1665777372849", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "97", "startMs": "1665777372756", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005763688760806916, "waitRatioMax": 0.005763688760806916, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.069164265129683, "writeRatioMax": 0.069164265129683 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.023054755043227664, "computeRatioMax": 0.04610951008645533, "endMs": "1665777372928", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "2983", "startMs": "1665777372878", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005763688760806916, "waitRatioMax": 0.011527377521613832, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.040345821325648415, "writeRatioMax": 0.07204610951008646 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.023054755043227664, "computeRatioMax": 0.04610951008645533, "endMs": "1665777372932", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "2516", "startMs": "1665777372879", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.011527377521613832, "waitRatioMax": 0.01440922190201729, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.040345821325648415, "writeRatioMax": 0.06051873198847262 }, { "completedParallelInputs": "1", "computeMsAvg": "151", "computeMsMax": "151", "computeRatioAvg": 0.43515850144092216, "computeRatioMax": 0.43515850144092216, "endMs": "1665777373036", "id": "19", "inputStages": [ "18", "12", "17" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "107", "shuffleOutputBytes": "749", "shuffleOutputBytesSpilled": "0", "slotMs": "143", "startMs": "1665777372895", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "SEMI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "SEMI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.011527377521613832, "waitRatioMax": 0.011527377521613832, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01440922190201729, "writeRatioMax": 0.01440922190201729 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.023054755043227664, "computeRatioMax": 0.023054755043227664, "endMs": "1665777373087", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "107", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777373048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005763688760806916, "waitRatioMax": 0.005763688760806916, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0345821325648415, "writeRatioMax": 0.0345821325648415 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.023054755043227664, "computeRatioMax": 0.023054755043227664, "endMs": "1665777373103", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777373065", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01729106628242075, "writeRatioMax": 0.01729106628242075 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "19", "elapsedMs": "612", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2978" }, { "activeUnits": "1", "completedUnits": "223", "elapsedMs": "966", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8754" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "8754", "transferredBytes": "0" }, "startTime": "1665777372182", "totalBytesProcessed": "82559911", "totalSlotMs": "8754" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona1fb6f4c_3744_4c80_9da0_a0ec081a17cb" }, "priority": "INTERACTIVE", "query": "select count(*) from (\n select distinct c_last_name, c_first_name, d_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n intersect distinct\n select distinct c_last_name, c_first_name, d_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1200 and 1200 + 11\n) hot_cust\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "cf7PQKvOeSt2TIHsFXNg1w==", "id": "test-project-364309:europe-west1.query38_1665777374", "jobReference": { "jobId": "query38_1665777374", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query38_1665777374?location=europe-west1", "statistics": { "creationTime": "1665777374754", "endTime": "1665777375713", "finalExecutionDurationMs": "778", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "82559911", "performanceInsights": { "avgPreviousExecutionMs": "853" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "75", "computeMsMax": "75", "computeRatioAvg": 0.20604395604395603, "computeRatioMax": 0.20604395604395603, "endMs": "1665777374964", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02197802197802198, "readRatioMax": 0.02197802197802198, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665777374890", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_first_name, $22:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03296703296703297, "writeRatioMax": 0.03296703296703297 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.038461538461538464, "computeRatioMax": 0.038461538461538464, "endMs": "1665777374940", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777374905", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date, $82:d_month_seq", "FROM date_dim", "WHERE between($82, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.019230769230769232 }, { "completedParallelInputs": "1", "computeMsAvg": "91", "computeMsMax": "91", "computeRatioAvg": 0.25, "computeRatioMax": 0.25, "endMs": "1665777375036", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.03296703296703297, "readRatioMax": 0.03296703296703297, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "134", "startMs": "1665777374930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_first_name, $12:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.046703296703296704, "writeRatioMax": 0.046703296703296704 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.0521978021978022, "computeRatioMax": 0.0521978021978022, "endMs": "1665777374978", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013736263736263736, "readRatioMax": 0.013736263736263736, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777374941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_date, $72:d_month_seq", "FROM date_dim", "WHERE between($72, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.019230769230769232 }, { "completedParallelInputs": "1", "computeMsAvg": "119", "computeMsMax": "119", "computeRatioAvg": 0.3269230769230769, "computeRatioMax": 0.3269230769230769, "endMs": "1665777375073", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.024725274725274724, "readRatioMax": 0.024725274725274724, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3026661", "shuffleOutputBytesSpilled": "0", "slotMs": "131", "startMs": "1665777374968", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_first_name, $3:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03021978021978022, "computeRatioMax": 0.03021978021978022, "endMs": "1665777375023", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "5124", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777374981", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date, $62:d_month_seq", "FROM date_dim", "WHERE between($62, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.038461538461538464 }, { "completedParallelInputs": "5", "computeMsAvg": "174", "computeMsMax": "199", "computeRatioAvg": 0.47802197802197804, "computeRatioMax": 0.5467032967032966, "endMs": "1665777375159", "id": "10", "inputStages": [ "1", "0" ], "name": "S0A: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "16", "readRatioAvg": 0.03021978021978022, "readRatioMax": 0.04395604395604396, "recordsRead": "1943378", "recordsWritten": "131344", "shuffleOutputBytes": "3470815", "shuffleOutputBytesSpilled": "0", "slotMs": "821", "startMs": "1665777375010", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:cs_sold_date_sk, $51:cs_bill_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $161, $172 := $160" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $21, $162 := $22", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $51, $151 := $81", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $172", "TO __stage0A_output", "BY HASH($170, $171, $172)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.02197802197802198 }, { "completedParallelInputs": "6", "computeMsAvg": "236", "computeMsMax": "364", "computeRatioAvg": 0.6483516483516484, "computeRatioMax": 1, "endMs": "1665777375260", "id": "13", "inputStages": [ "4", "3" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "8", "readMsMax": "11", "readRatioAvg": 0.02197802197802198, "readRatioMax": 0.03021978021978022, "recordsRead": "3482600", "recordsWritten": "244947", "shuffleOutputBytes": "6483613", "shuffleOutputBytesSpilled": "0", "slotMs": "1257", "startMs": "1665777375047", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $122, $131 := $121, $132 := $120" ] }, { "kind": "JOIN", "substeps": [ "$120 := $111, $121 := $11, $122 := $12", "INNER HASH JOIN EACH WITH ALL ON $110 = $10" ] }, { "kind": "JOIN", "substeps": [ "$110 := $41, $111 := $71", "INNER HASH JOIN EACH WITH ALL ON $40 = $70" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132", "TO __stage0D_output", "BY HASH($130, $131, $132)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "13", "writeMsMax": "15", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.04120879120879121 }, { "completedParallelInputs": "1", "computeMsAvg": "178", "computeMsMax": "178", "computeRatioAvg": 0.489010989010989, "computeRatioMax": 0.489010989010989, "endMs": "1665777375232", "id": "14", "inputStages": [ "6", "7" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "819750", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "163", "startMs": "1665777375104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211, $222 := $210" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $2, $212 := $3", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $31, $201 := $61", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $222", "TO __stage0E_output", "BY HASH($220, $221, $222)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04945054945054945, "writeRatioMax": 0.04945054945054945 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.10989010989010989, "computeRatioMax": 0.10989010989010989, "endMs": "1665777375344", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665777375279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $222", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.07692307692307693, "writeRatioMax": 0.07692307692307693 }, { "completedParallelInputs": "1", "computeMsAvg": "84", "computeMsMax": "84", "computeRatioAvg": 0.23076923076923078, "computeRatioMax": 0.23076923076923078, "endMs": "1665777375371", "id": "16", "inputStages": [ "10" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "131344", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "93", "startMs": "1665777375298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $172", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171, $182 := $172" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.06043956043956044, "writeRatioMax": 0.06043956043956044 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.024725274725274724, "computeRatioMax": 0.04120879120879121, "endMs": "1665777375437", "id": "17", "inputStages": [ "16" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31723", "recordsWritten": "31723", "shuffleOutputBytes": "838901", "shuffleOutputBytesSpilled": "0", "slotMs": "3135", "startMs": "1665777375386", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.01098901098901099, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.06868131868131869 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.02197802197802198, "computeRatioMax": 0.04945054945054945, "endMs": "1665777375454", "id": "18", "inputStages": [ "15" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11788", "recordsWritten": "11788", "shuffleOutputBytes": "310951", "shuffleOutputBytesSpilled": "0", "slotMs": "3420", "startMs": "1665777375386", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.008241758241758242, "waitRatioMax": 0.013736263736263736, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.07692307692307693 }, { "completedParallelInputs": "1", "computeMsAvg": "147", "computeMsMax": "147", "computeRatioAvg": 0.40384615384615385, "computeRatioMax": 0.40384615384615385, "endMs": "1665777375557", "id": "19", "inputStages": [ "13", "17", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288458", "recordsWritten": "107", "shuffleOutputBytes": "749", "shuffleOutputBytesSpilled": "0", "slotMs": "129", "startMs": "1665777375400", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $241, $251 := $240, $252 := $242" ] }, { "kind": "JOIN", "substeps": [ "$240 := $190, $241 := $191, $242 := $192", "SEMI HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232" ] }, { "kind": "JOIN", "substeps": [ "$190 := $141, $191 := $140, $192 := $142", "SEMI HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $252", "TO __stage13_output", "BY HASH($250, $251, $252)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.01098901098901099, "waitRatioMax": 0.01098901098901099, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.013736263736263736, "writeRatioMax": 0.013736263736263736 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.019230769230769232, "computeRatioMax": 0.019230769230769232, "endMs": "1665777375623", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "107", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665777375601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $252", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := COUNT_STAR()" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.038461538461538464 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.013736263736263736, "computeRatioMax": 0.013736263736263736, "endMs": "1665777375639", "id": "21", "inputStages": [ "20" ], "name": "S15: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665777375612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage14_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.013736263736263736, "writeRatioMax": 0.013736263736263736 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "199", "completedUnits": "20", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "201", "totalSlotMs": "2955" }, { "activeUnits": "199", "completedUnits": "223", "elapsedMs": "866", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9556" } ], "totalBytesBilled": "82837504", "totalBytesProcessed": "82559911", "totalPartitionsProcessed": "0", "totalSlotMs": "9556", "transferredBytes": "0" }, "startTime": "1665777374802", "totalBytesProcessed": "82559911", "totalSlotMs": "9556" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
