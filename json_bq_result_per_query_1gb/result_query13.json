{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9d91166a_0e7d_44fc_b74a_65236da4b820" }, "priority": "INTERACTIVE", "query": "select avg(ss_quantity)\r\n ,avg(ss_ext_sales_price)\r\n ,avg(ss_ext_wholesale_cost)\r\n ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n ,store\r\n ,customer_demographics\r\n ,household_demographics\r\n ,customer_address\r\n ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'M'\r\n and cd_education_status = 'Advanced Degree'\r\n and ss_sales_price between 100.00 and 150.00\r\n and hd_dep_count = 3 \r\n )or\r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'S'\r\n and cd_education_status = 'College'\r\n and ss_sales_price between 50.00 and 100.00 \r\n and hd_dep_count = 1\r\n ) or \r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'W'\r\n and cd_education_status = '2 yr Degree'\r\n and ss_sales_price between 150.00 and 200.00 \r\n and hd_dep_count = 1 \r\n ))\r\n and((ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('TX', 'OH', 'TX')\r\n and ss_net_profit between 100 and 200 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('OR', 'NM', 'KY')\r\n and ss_net_profit between 150 and 300 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('VA', 'TX', 'MS')\r\n and ss_net_profit between 50 and 250 \r\n ))\r\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "q4OOaEzEv5bjw3Dh9rak/w==", "id": "test-project-364309:europe-west1.query13_1665768236", "jobReference": { "jobId": "query13_1665768236", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query13_1665768236?location=europe-west1", "statistics": { "creationTime": "1665768236762", "endTime": "1665768237864", "finalExecutionDurationMs": "864", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "354003429", "performanceInsights": { "avgPreviousExecutionMs": "897" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.013353115727002967, "computeRatioMax": 0.013353115727002967, "endMs": "1665768237007", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.019287833827893175, "readRatioMax": 0.019287833827893175, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768236965", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.011869436201780416, "writeRatioMax": 0.011869436201780416 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.028189910979228485, "computeRatioMax": 0.028189910979228485, "endMs": "1665768237033", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01483679525222552, "readRatioMax": 0.01483679525222552, "recordsRead": "50000", "recordsWritten": "11613", "shuffleOutputBytes": "185808", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768236990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_country", "FROM customer_address", "WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'OH', 'TX'), in($11, 'OR', 'NM', 'KY'), in($11, 'VA', 'TX', 'MS')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001483679525222552, "waitRatioMax": 0.001483679525222552, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01483679525222552, "writeRatioMax": 0.01483679525222552 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01483679525222552, "computeRatioMax": 0.01483679525222552, "endMs": "1665768237039", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008902077151335312, "readRatioMax": 0.008902077151335312, "recordsRead": "7200", "recordsWritten": "1440", "shuffleOutputBytes": "25920", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768237009", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:hd_demo_sk, $21:hd_dep_count", "FROM household_demographics", "WHERE or(equal($21, 3), equal($21, 1), equal($21, 1))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001483679525222552, "waitRatioMax": 0.001483679525222552, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.025222551928783383, "writeRatioMax": 0.025222551928783383 }, { "completedParallelInputs": "1", "computeMsAvg": "285", "computeMsMax": "285", "computeRatioAvg": 0.4228486646884273, "computeRatioMax": 0.4228486646884273, "endMs": "1665768237248", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01483679525222552, "readRatioMax": 0.01483679525222552, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "245", "startMs": "1665768237027", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_marital_status, $42:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($41, 'M'), equal($41, 'S'), equal($41, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001483679525222552, "waitRatioMax": 0.001483679525222552, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.017804154302670624, "writeRatioMax": 0.017804154302670624 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011869436201780416, "computeRatioMax": 0.011869436201780416, "endMs": "1665768237090", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00741839762611276, "readRatioMax": 0.00741839762611276, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665768237041", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002967359050445104, "waitRatioMax": 0.002967359050445104, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03560830860534125, "writeRatioMax": 0.03560830860534125 }, { "completedParallelInputs": "6", "computeMsAvg": "557", "computeMsMax": "674", "computeRatioAvg": 0.8264094955489614, "computeRatioMax": 1, "endMs": "1665768237713", "id": "7", "inputStages": [ "3", "0", "4", "2", "1" ], "name": "S07: Join+", "parallelInputs": "6", "readMsAvg": "35", "readMsMax": "46", "readRatioAvg": 0.05192878338278932, "readRatioMax": 0.06824925816023739, "recordsRead": "5924504", "recordsWritten": "6", "shuffleOutputBytes": "260", "shuffleOutputBytesSpilled": "0", "slotMs": "3064", "startMs": "1665768237280", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_cdemo_sk, $52:ss_hdemo_sk, $53:ss_addr_sk, $54:ss_store_sk, $55:ss_quantity, $56:ss_sales_price, $57:ss_ext_sales_price, $58:ss_ext_wholesale_cost, $59:ss_net_profit", "FROM store_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := SHARD_AVG($150)", "$71 := SHARD_AVG($151)", "$72 := SHARD_AVG($152)", "$73 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $142, $152 := $143", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($145, 'TX', 'OH', 'TX'), between($144, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $122, $141 := $124, $142 := $126, $143 := $127, $144 := $128, $145 := $11", "INNER HASH JOIN EACH WITH ALL ON $123 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($120, 'M'), equal($121, 'Advanced Degree'), between($125, NUMERIC<...>, NUMERIC<...>), equal($129, 3)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $108, $121 := $109, $122 := $100, $123 := $102, $124 := $103, $125 := $104, $126 := $105, $127 := $106, $128 := $107, $129 := $21", "INNER HASH JOIN EACH WITH ALL ON $101 = $20" ] }, { "kind": "JOIN", "substeps": [ "$100 := $80, $101 := $82, $102 := $83, $103 := $84, $104 := $85, $105 := $86, $106 := $87, $107 := $88, $108 := $41, $109 := $42", "INNER HASH JOIN EACH WITH ALL ON $81 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $50, $81 := $51, $82 := $52, $83 := $53, $84 := $55, $85 := $56, $86 := $57, $87 := $58, $88 := $59", "INNER HASH JOIN EACH WITH ALL ON $54 = $30" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001483679525222552, "waitRatioMax": 0.001483679525222552, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001483679525222552, "writeRatioMax": 0.001483679525222552 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.010385756676557863, "computeRatioMax": 0.010385756676557863, "endMs": "1665768237727", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "57", "shuffleOutputBytesSpilled": "0", "slotMs": "253", "startMs": "1665768237285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70, $71, $72, $73", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := ROOT_AVG($70)", "$61 := ROOT_AVG($71)", "$62 := ROOT_AVG($72)", "$63 := SUM($73)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004451038575667656, "waitRatioMax": 0.004451038575667656, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.00741839762611276, "writeRatioMax": 0.00741839762611276 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "5", "elapsedMs": "656", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "1040" }, { "activeUnits": "7", "completedUnits": "12", "elapsedMs": "1013", "estimatedRunnableUnits": "1", "pendingUnits": "0", "totalSlotMs": "4022" } ], "totalBytesBilled": "354418688", "totalBytesProcessed": "354003429", "totalPartitionsProcessed": "0", "totalSlotMs": "4022", "transferredBytes": "0" }, "startTime": "1665768236809", "totalBytesProcessed": "354003429", "totalSlotMs": "4022" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon306863f1_6a94_40ef_b07c_bf010dc0add1" }, "priority": "INTERACTIVE", "query": "select avg(ss_quantity)\r\n ,avg(ss_ext_sales_price)\r\n ,avg(ss_ext_wholesale_cost)\r\n ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n ,store\r\n ,customer_demographics\r\n ,household_demographics\r\n ,customer_address\r\n ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'M'\r\n and cd_education_status = 'Advanced Degree'\r\n and ss_sales_price between 100.00 and 150.00\r\n and hd_dep_count = 3 \r\n )or\r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'S'\r\n and cd_education_status = 'College'\r\n and ss_sales_price between 50.00 and 100.00 \r\n and hd_dep_count = 1\r\n ) or \r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'W'\r\n and cd_education_status = '2 yr Degree'\r\n and ss_sales_price between 150.00 and 200.00 \r\n and hd_dep_count = 1 \r\n ))\r\n and((ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('TX', 'OH', 'TX')\r\n and ss_net_profit between 100 and 200 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('OR', 'NM', 'KY')\r\n and ss_net_profit between 150 and 300 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('VA', 'TX', 'MS')\r\n and ss_net_profit between 50 and 250 \r\n ))\r\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "YdlCCH9R4vG6QuaM2WxoXg==", "id": "test-project-364309:europe-west1.query13_1665776854", "jobReference": { "jobId": "query13_1665776854", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query13_1665776854?location=europe-west1", "statistics": { "creationTime": "1665776855082", "endTime": "1665776856275", "finalExecutionDurationMs": "935", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "354003429", "performanceInsights": { "avgPreviousExecutionMs": "891" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.011826544021024968, "computeRatioMax": 0.011826544021024968, "endMs": "1665776855324", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009198423127463863, "readRatioMax": 0.009198423127463863, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776855286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03153745072273324, "writeRatioMax": 0.03153745072273324 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.017082785808147174, "computeRatioMax": 0.017082785808147174, "endMs": "1665776855339", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009198423127463863, "readRatioMax": 0.009198423127463863, "recordsRead": "50000", "recordsWritten": "11613", "shuffleOutputBytes": "185808", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776855303", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_country", "FROM customer_address", "WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'OH', 'TX'), in($11, 'OR', 'NM', 'KY'), in($11, 'VA', 'TX', 'MS')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.010512483574244415, "writeRatioMax": 0.010512483574244415 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01445466491458607, "computeRatioMax": 0.01445466491458607, "endMs": "1665776855362", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009198423127463863, "readRatioMax": 0.009198423127463863, "recordsRead": "7200", "recordsWritten": "1440", "shuffleOutputBytes": "25920", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776855317", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:hd_demo_sk, $21:hd_dep_count", "FROM household_demographics", "WHERE or(equal($21, 3), equal($21, 1), equal($21, 1))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.03810775295663601, "writeRatioMax": 0.03810775295663601 }, { "completedParallelInputs": "1", "computeMsAvg": "410", "computeMsMax": "410", "computeRatioAvg": 0.5387647831800263, "computeRatioMax": 0.5387647831800263, "endMs": "1665776855619", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.01445466491458607, "readRatioMax": 0.01445466491458607, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "397", "startMs": "1665776855333", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_marital_status, $42:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($41, 'M'), equal($41, 'S'), equal($41, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.026281208935611037, "writeRatioMax": 0.026281208935611037 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013140604467805518, "computeRatioMax": 0.013140604467805518, "endMs": "1665776855388", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005256241787122208, "readRatioMax": 0.005256241787122208, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776855346", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.022339027595269383, "writeRatioMax": 0.022339027595269383 }, { "completedParallelInputs": "6", "computeMsAvg": "645", "computeMsMax": "761", "computeRatioAvg": 0.8475689881734559, "computeRatioMax": 1, "endMs": "1665776856174", "id": "7", "inputStages": [ "3", "4", "2", "0", "1" ], "name": "S07: Join+", "parallelInputs": "6", "readMsAvg": "39", "readMsMax": "49", "readRatioAvg": 0.051248357424441525, "readRatioMax": 0.06438896189224705, "recordsRead": "5924504", "recordsWritten": "6", "shuffleOutputBytes": "260", "shuffleOutputBytesSpilled": "0", "slotMs": "3779", "startMs": "1665776855707", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_cdemo_sk, $52:ss_hdemo_sk, $53:ss_addr_sk, $54:ss_store_sk, $55:ss_quantity, $56:ss_sales_price, $57:ss_ext_sales_price, $58:ss_ext_wholesale_cost, $59:ss_net_profit", "FROM store_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := SHARD_AVG($150)", "$71 := SHARD_AVG($151)", "$72 := SHARD_AVG($152)", "$73 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $142, $152 := $143", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($145, 'TX', 'OH', 'TX'), between($144, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $122, $141 := $124, $142 := $126, $143 := $127, $144 := $128, $145 := $11", "INNER HASH JOIN EACH WITH ALL ON $123 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($120, 'M'), equal($121, 'Advanced Degree'), between($125, NUMERIC<...>, NUMERIC<...>), equal($129, 3)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $108, $121 := $109, $122 := $100, $123 := $102, $124 := $103, $125 := $104, $126 := $105, $127 := $106, $128 := $107, $129 := $21", "INNER HASH JOIN EACH WITH ALL ON $101 = $20" ] }, { "kind": "JOIN", "substeps": [ "$100 := $80, $101 := $82, $102 := $83, $103 := $84, $104 := $85, $105 := $86, $106 := $87, $107 := $88, $108 := $41, $109 := $42", "INNER HASH JOIN EACH WITH ALL ON $81 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $50, $81 := $51, $82 := $52, $83 := $53, $84 := $55, $85 := $56, $86 := $57, $87 := $58, $88 := $59", "INNER HASH JOIN EACH WITH ALL ON $54 = $30" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001314060446780552, "waitRatioMax": 0.001314060446780552, "writeMsAvg": "1", "writeMsMax": "3", "writeRatioAvg": 0.001314060446780552, "writeRatioMax": 0.003942181340341655 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01445466491458607, "computeRatioMax": 0.01445466491458607, "endMs": "1665776856173", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "57", "shuffleOutputBytesSpilled": "0", "slotMs": "182", "startMs": "1665776855713", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70, $71, $72, $73", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := ROOT_AVG($70)", "$61 := ROOT_AVG($71)", "$62 := ROOT_AVG($72)", "$63 := SUM($73)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.005256241787122208, "waitRatioMax": 0.005256241787122208, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.00788436268068331, "writeRatioMax": 0.00788436268068331 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "5", "elapsedMs": "635", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "2059" }, { "activeUnits": "7", "completedUnits": "12", "elapsedMs": "1069", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6022" } ], "totalBytesBilled": "354418688", "totalBytesProcessed": "354003429", "totalPartitionsProcessed": "0", "totalSlotMs": "6022", "transferredBytes": "0" }, "startTime": "1665776855153", "totalBytesProcessed": "354003429", "totalSlotMs": "6022" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona2edb66c_b59b_4b8c_ae17_7d4088d4c96a" }, "priority": "INTERACTIVE", "query": "select avg(ss_quantity)\r\n ,avg(ss_ext_sales_price)\r\n ,avg(ss_ext_wholesale_cost)\r\n ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n ,store\r\n ,customer_demographics\r\n ,household_demographics\r\n ,customer_address\r\n ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'M'\r\n and cd_education_status = 'Advanced Degree'\r\n and ss_sales_price between 100.00 and 150.00\r\n and hd_dep_count = 3 \r\n )or\r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'S'\r\n and cd_education_status = 'College'\r\n and ss_sales_price between 50.00 and 100.00 \r\n and hd_dep_count = 1\r\n ) or \r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'W'\r\n and cd_education_status = '2 yr Degree'\r\n and ss_sales_price between 150.00 and 200.00 \r\n and hd_dep_count = 1 \r\n ))\r\n and((ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('TX', 'OH', 'TX')\r\n and ss_net_profit between 100 and 200 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('OR', 'NM', 'KY')\r\n and ss_net_profit between 150 and 300 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('VA', 'TX', 'MS')\r\n and ss_net_profit between 50 and 250 \r\n ))\r\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "USD2PrD/hQ66tYWrgUo+aA==", "id": "test-project-364309:europe-west1.query13_1665776857", "jobReference": { "jobId": "query13_1665776857", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query13_1665776857?location=europe-west1", "statistics": { "creationTime": "1665776857915", "endTime": "1665776859143", "finalExecutionDurationMs": "968", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "354003429", "performanceInsights": { "avgPreviousExecutionMs": "898" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009150326797385621, "computeRatioMax": 0.009150326797385621, "endMs": "1665776858152", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006535947712418301, "readRatioMax": 0.006535947712418301, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776858115", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00261437908496732, "waitRatioMax": 0.00261437908496732, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02091503267973856, "writeRatioMax": 0.02091503267973856 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.026143790849673203, "computeRatioMax": 0.026143790849673203, "endMs": "1665776858179", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.01699346405228758, "readRatioMax": 0.01699346405228758, "recordsRead": "50000", "recordsWritten": "11613", "shuffleOutputBytes": "185808", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776858134", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_country", "FROM customer_address", "WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'OH', 'TX'), in($11, 'OR', 'NM', 'KY'), in($11, 'VA', 'TX', 'MS')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.011764705882352941, "writeRatioMax": 0.011764705882352941 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.022222222222222223, "endMs": "1665776858191", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.01045751633986928, "readRatioMax": 0.01045751633986928, "recordsRead": "7200", "recordsWritten": "1440", "shuffleOutputBytes": "25920", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776858150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:hd_demo_sk, $21:hd_dep_count", "FROM household_demographics", "WHERE or(equal($21, 3), equal($21, 1), equal($21, 1))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.013071895424836602, "writeRatioMax": 0.013071895424836602 }, { "completedParallelInputs": "1", "computeMsAvg": "366", "computeMsMax": "366", "computeRatioAvg": 0.47843137254901963, "computeRatioMax": 0.47843137254901963, "endMs": "1665776858397", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.01437908496732026, "readRatioMax": 0.01437908496732026, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "349", "startMs": "1665776858165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_marital_status, $42:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($41, 'M'), equal($41, 'S'), equal($41, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0196078431372549, "writeRatioMax": 0.0196078431372549 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.00522875816993464, "computeRatioMax": 0.00522875816993464, "endMs": "1665776858212", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00392156862745098, "readRatioMax": 0.00392156862745098, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665776858178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0196078431372549, "writeRatioMax": 0.0196078431372549 }, { "completedParallelInputs": "6", "computeMsAvg": "627", "computeMsMax": "765", "computeRatioAvg": 0.8196078431372549, "computeRatioMax": 1, "endMs": "1665776858933", "id": "7", "inputStages": [ "4", "3", "0", "1", "2" ], "name": "S07: Join+", "parallelInputs": "6", "readMsAvg": "33", "readMsMax": "45", "readRatioAvg": 0.043137254901960784, "readRatioMax": 0.058823529411764705, "recordsRead": "5924504", "recordsWritten": "6", "shuffleOutputBytes": "260", "shuffleOutputBytesSpilled": "0", "slotMs": "3222", "startMs": "1665776858404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_cdemo_sk, $52:ss_hdemo_sk, $53:ss_addr_sk, $54:ss_store_sk, $55:ss_quantity, $56:ss_sales_price, $57:ss_ext_sales_price, $58:ss_ext_wholesale_cost, $59:ss_net_profit", "FROM store_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := SHARD_AVG($150)", "$71 := SHARD_AVG($151)", "$72 := SHARD_AVG($152)", "$73 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $142, $152 := $143", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($145, 'TX', 'OH', 'TX'), between($144, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $122, $141 := $124, $142 := $126, $143 := $127, $144 := $128, $145 := $11", "INNER HASH JOIN EACH WITH ALL ON $123 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($120, 'M'), equal($121, 'Advanced Degree'), between($125, NUMERIC<...>, NUMERIC<...>), equal($129, 3)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $108, $121 := $109, $122 := $100, $123 := $102, $124 := $103, $125 := $104, $126 := $105, $127 := $106, $128 := $107, $129 := $21", "INNER HASH JOIN EACH WITH ALL ON $101 = $20" ] }, { "kind": "JOIN", "substeps": [ "$100 := $80, $101 := $82, $102 := $83, $103 := $84, $104 := $85, $105 := $86, $106 := $87, $107 := $88, $108 := $41, $109 := $42", "INNER HASH JOIN EACH WITH ALL ON $81 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $50, $81 := $51, $82 := $52, $83 := $53, $84 := $55, $85 := $56, $86 := $57, $87 := $58, $88 := $59", "INNER HASH JOIN EACH WITH ALL ON $54 = $30" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00130718954248366, "waitRatioMax": 0.00130718954248366, "writeMsAvg": "1", "writeMsMax": "2", "writeRatioAvg": 0.00130718954248366, "writeRatioMax": 0.00261437908496732 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013071895424836602, "computeRatioMax": 0.013071895424836602, "endMs": "1665776858954", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "57", "shuffleOutputBytesSpilled": "0", "slotMs": "448", "startMs": "1665776858409", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70, $71, $72, $73", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := ROOT_AVG($70)", "$61 := ROOT_AVG($71)", "$62 := ROOT_AVG($72)", "$63 := SUM($73)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.00522875816993464, "waitRatioMax": 0.00522875816993464, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.006535947712418301, "writeRatioMax": 0.006535947712418301 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "5", "elapsedMs": "635", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "1307" }, { "activeUnits": "7", "completedUnits": "12", "elapsedMs": "1099", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4812" } ], "totalBytesBilled": "354418688", "totalBytesProcessed": "354003429", "totalPartitionsProcessed": "0", "totalSlotMs": "4812", "transferredBytes": "0" }, "startTime": "1665776857981", "totalBytesProcessed": "354003429", "totalSlotMs": "4812" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon20224488_5b83_47ec_b3d9_1c0d3d4804c8" }, "priority": "INTERACTIVE", "query": "select avg(ss_quantity)\r\n ,avg(ss_ext_sales_price)\r\n ,avg(ss_ext_wholesale_cost)\r\n ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n ,store\r\n ,customer_demographics\r\n ,household_demographics\r\n ,customer_address\r\n ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'M'\r\n and cd_education_status = 'Advanced Degree'\r\n and ss_sales_price between 100.00 and 150.00\r\n and hd_dep_count = 3 \r\n )or\r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'S'\r\n and cd_education_status = 'College'\r\n and ss_sales_price between 50.00 and 100.00 \r\n and hd_dep_count = 1\r\n ) or \r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'W'\r\n and cd_education_status = '2 yr Degree'\r\n and ss_sales_price between 150.00 and 200.00 \r\n and hd_dep_count = 1 \r\n ))\r\n and((ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('TX', 'OH', 'TX')\r\n and ss_net_profit between 100 and 200 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('OR', 'NM', 'KY')\r\n and ss_net_profit between 150 and 300 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('VA', 'TX', 'MS')\r\n and ss_net_profit between 50 and 250 \r\n ))\r\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "P3AD6uIJsbqRUFyobHYFtA==", "id": "test-project-364309:europe-west1.query13_1665776860", "jobReference": { "jobId": "query13_1665776860", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query13_1665776860?location=europe-west1", "statistics": { "creationTime": "1665776860726", "endTime": "1665776861931", "finalExecutionDurationMs": "934", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "354003429", "performanceInsights": { "avgPreviousExecutionMs": "908" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.019157088122605363, "computeRatioMax": 0.019157088122605363, "endMs": "1665776860982", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0140485312899106, "readRatioMax": 0.0140485312899106, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776860936", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001277139208173691, "waitRatioMax": 0.001277139208173691, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01277139208173691, "writeRatioMax": 0.01277139208173691 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.01532567049808429, "computeRatioMax": 0.01532567049808429, "endMs": "1665776860994", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007662835249042145, "readRatioMax": 0.007662835249042145, "recordsRead": "50000", "recordsWritten": "11613", "shuffleOutputBytes": "185808", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776860956", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_country", "FROM customer_address", "WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'OH', 'TX'), in($11, 'OR', 'NM', 'KY'), in($11, 'VA', 'TX', 'MS')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001277139208173691, "waitRatioMax": 0.001277139208173691, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.01532567049808429, "writeRatioMax": 0.01532567049808429 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.007662835249042145, "computeRatioMax": 0.007662835249042145, "endMs": "1665776861015", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0038314176245210726, "readRatioMax": 0.0038314176245210726, "recordsRead": "7200", "recordsWritten": "1440", "shuffleOutputBytes": "25920", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776860976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:hd_demo_sk, $21:hd_dep_count", "FROM household_demographics", "WHERE or(equal($21, 3), equal($21, 1), equal($21, 1))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002554278416347382, "waitRatioMax": 0.002554278416347382, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.020434227330779056, "writeRatioMax": 0.020434227330779056 }, { "completedParallelInputs": "1", "computeMsAvg": "395", "computeMsMax": "395", "computeRatioAvg": 0.5044699872286079, "computeRatioMax": 0.5044699872286079, "endMs": "1665776861275", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0140485312899106, "readRatioMax": 0.0140485312899106, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "399", "startMs": "1665776860993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_marital_status, $42:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($41, 'M'), equal($41, 'S'), equal($41, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001277139208173691, "waitRatioMax": 0.001277139208173691, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.017879948914431672, "writeRatioMax": 0.017879948914431672 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.01532567049808429, "computeRatioMax": 0.01532567049808429, "endMs": "1665776861057", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006385696040868455, "readRatioMax": 0.006385696040868455, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776861011", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001277139208173691, "waitRatioMax": 0.001277139208173691, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02554278416347382, "writeRatioMax": 0.02554278416347382 }, { "completedParallelInputs": "6", "computeMsAvg": "618", "computeMsMax": "783", "computeRatioAvg": 0.789272030651341, "computeRatioMax": 1, "endMs": "1665776861811", "id": "7", "inputStages": [ "3", "2", "4", "1", "0" ], "name": "S07: Join+", "parallelInputs": "6", "readMsAvg": "33", "readMsMax": "39", "readRatioAvg": 0.0421455938697318, "readRatioMax": 0.04980842911877394, "recordsRead": "5924504", "recordsWritten": "6", "shuffleOutputBytes": "260", "shuffleOutputBytesSpilled": "0", "slotMs": "4052", "startMs": "1665776861306", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_cdemo_sk, $52:ss_hdemo_sk, $53:ss_addr_sk, $54:ss_store_sk, $55:ss_quantity, $56:ss_sales_price, $57:ss_ext_sales_price, $58:ss_ext_wholesale_cost, $59:ss_net_profit", "FROM store_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := SHARD_AVG($150)", "$71 := SHARD_AVG($151)", "$72 := SHARD_AVG($152)", "$73 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $142, $152 := $143", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($145, 'TX', 'OH', 'TX'), between($144, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $122, $141 := $124, $142 := $126, $143 := $127, $144 := $128, $145 := $11", "INNER HASH JOIN EACH WITH ALL ON $123 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($120, 'M'), equal($121, 'Advanced Degree'), between($125, NUMERIC<...>, NUMERIC<...>), equal($129, 3)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $108, $121 := $109, $122 := $100, $123 := $102, $124 := $103, $125 := $104, $126 := $105, $127 := $106, $128 := $107, $129 := $21", "INNER HASH JOIN EACH WITH ALL ON $101 = $20" ] }, { "kind": "JOIN", "substeps": [ "$100 := $80, $101 := $82, $102 := $83, $103 := $84, $104 := $85, $105 := $86, $106 := $87, $107 := $88, $108 := $41, $109 := $42", "INNER HASH JOIN EACH WITH ALL ON $81 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $50, $81 := $51, $82 := $52, $83 := $53, $84 := $55, $85 := $56, $86 := $57, $87 := $58, $88 := $59", "INNER HASH JOIN EACH WITH ALL ON $54 = $30" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002554278416347382, "waitRatioMax": 0.002554278416347382, "writeMsAvg": "1", "writeMsMax": "2", "writeRatioAvg": 0.001277139208173691, "writeRatioMax": 0.002554278416347382 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.007662835249042145, "computeRatioMax": 0.007662835249042145, "endMs": "1665776861817", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "57", "shuffleOutputBytesSpilled": "0", "slotMs": "171", "startMs": "1665776861313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70, $71, $72, $73", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := ROOT_AVG($70)", "$61 := ROOT_AVG($71)", "$62 := ROOT_AVG($72)", "$63 := SUM($73)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage08_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.006385696040868455, "waitRatioMax": 0.006385696040868455, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.006385696040868455, "writeRatioMax": 0.006385696040868455 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "5", "elapsedMs": "641", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "1676" }, { "activeUnits": "7", "completedUnits": "12", "elapsedMs": "1078", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5724" } ], "totalBytesBilled": "354418688", "totalBytesProcessed": "354003429", "totalPartitionsProcessed": "0", "totalSlotMs": "5724", "transferredBytes": "0" }, "startTime": "1665776860796", "totalBytesProcessed": "354003429", "totalSlotMs": "5724" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon960853fc_28a8_4941_86f0_5573973a93f6" }, "priority": "INTERACTIVE", "query": "select avg(ss_quantity)\r\n ,avg(ss_ext_sales_price)\r\n ,avg(ss_ext_wholesale_cost)\r\n ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n ,store\r\n ,customer_demographics\r\n ,household_demographics\r\n ,customer_address\r\n ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'M'\r\n and cd_education_status = 'Advanced Degree'\r\n and ss_sales_price between 100.00 and 150.00\r\n and hd_dep_count = 3 \r\n )or\r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'S'\r\n and cd_education_status = 'College'\r\n and ss_sales_price between 50.00 and 100.00 \r\n and hd_dep_count = 1\r\n ) or \r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'W'\r\n and cd_education_status = '2 yr Degree'\r\n and ss_sales_price between 150.00 and 200.00 \r\n and hd_dep_count = 1 \r\n ))\r\n and((ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('TX', 'OH', 'TX')\r\n and ss_net_profit between 100 and 200 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('OR', 'NM', 'KY')\r\n and ss_net_profit between 150 and 300 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('VA', 'TX', 'MS')\r\n and ss_net_profit between 50 and 250 \r\n ))\r\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "jHA6BErnvSXXBNZy1Zkhrw==", "id": "test-project-364309:europe-west1.query13_1665776863", "jobReference": { "jobId": "query13_1665776863", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query13_1665776863?location=europe-west1", "statistics": { "creationTime": "1665776863596", "endTime": "1665776864676", "finalExecutionDurationMs": "823", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "354003429", "performanceInsights": { "avgPreviousExecutionMs": "911" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.015643802647412757, "computeRatioMax": 0.015643802647412757, "endMs": "1665776863839", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007220216606498195, "readRatioMax": 0.007220216606498195, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776863803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024067388688327317, "waitRatioMax": 0.0024067388688327317, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.010830324909747292, "writeRatioMax": 0.010830324909747292 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.019253910950661854, "computeRatioMax": 0.019253910950661854, "endMs": "1665776863858", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00842358604091456, "readRatioMax": 0.00842358604091456, "recordsRead": "50000", "recordsWritten": "11613", "shuffleOutputBytes": "185808", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776863819", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_country", "FROM customer_address", "WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'OH', 'TX'), in($11, 'OR', 'NM', 'KY'), in($11, 'VA', 'TX', 'MS')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012033694344163659, "waitRatioMax": 0.0012033694344163659, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.010830324909747292, "writeRatioMax": 0.010830324909747292 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.00842358604091456, "computeRatioMax": 0.00842358604091456, "endMs": "1665776863871", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0048134777376654635, "readRatioMax": 0.0048134777376654635, "recordsRead": "7200", "recordsWritten": "1440", "shuffleOutputBytes": "25920", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776863833", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:hd_demo_sk, $21:hd_dep_count", "FROM household_demographics", "WHERE or(equal($21, 3), equal($21, 1), equal($21, 1))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024067388688327317, "waitRatioMax": 0.0024067388688327317, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.019253910950661854, "writeRatioMax": 0.019253910950661854 }, { "completedParallelInputs": "1", "computeMsAvg": "220", "computeMsMax": "220", "computeRatioAvg": 0.2647412755716005, "computeRatioMax": 0.2647412755716005, "endMs": "1665776864014", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.013237063778580024, "readRatioMax": 0.013237063778580024, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "212", "startMs": "1665776863847", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_marital_status, $42:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($41, 'M'), equal($41, 'S'), equal($41, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024067388688327317, "waitRatioMax": 0.0024067388688327317, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01684717208182912, "writeRatioMax": 0.01684717208182912 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.013237063778580024, "computeRatioMax": 0.013237063778580024, "endMs": "1665776863901", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006016847172081829, "readRatioMax": 0.006016847172081829, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776863863", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024067388688327317, "waitRatioMax": 0.0024067388688327317, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.019253910950661854, "writeRatioMax": 0.019253910950661854 }, { "completedParallelInputs": "6", "computeMsAvg": "620", "computeMsMax": "831", "computeRatioAvg": 0.7460890493381468, "computeRatioMax": 1, "endMs": "1665776864534", "id": "7", "inputStages": [ "2", "4", "1", "3", "0" ], "name": "S07: Join+", "parallelInputs": "6", "readMsAvg": "31", "readMsMax": "38", "readRatioAvg": 0.03730445246690734, "readRatioMax": 0.0457280385078219, "recordsRead": "5924504", "recordsWritten": "6", "shuffleOutputBytes": "260", "shuffleOutputBytesSpilled": "0", "slotMs": "3377", "startMs": "1665776864045", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_cdemo_sk, $52:ss_hdemo_sk, $53:ss_addr_sk, $54:ss_store_sk, $55:ss_quantity, $56:ss_sales_price, $57:ss_ext_sales_price, $58:ss_ext_wholesale_cost, $59:ss_net_profit", "FROM store_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := SHARD_AVG($150)", "$71 := SHARD_AVG($151)", "$72 := SHARD_AVG($152)", "$73 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $142, $152 := $143", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($145, 'TX', 'OH', 'TX'), between($144, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $122, $141 := $124, $142 := $126, $143 := $127, $144 := $128, $145 := $11", "INNER HASH JOIN EACH WITH ALL ON $123 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($120, 'M'), equal($121, 'Advanced Degree'), between($125, NUMERIC<...>, NUMERIC<...>), equal($129, 3)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $108, $121 := $109, $122 := $100, $123 := $102, $124 := $103, $125 := $104, $126 := $105, $127 := $106, $128 := $107, $129 := $21", "INNER HASH JOIN EACH WITH ALL ON $101 = $20" ] }, { "kind": "JOIN", "substeps": [ "$100 := $80, $101 := $82, $102 := $83, $103 := $84, $104 := $85, $105 := $86, $106 := $87, $107 := $88, $108 := $41, $109 := $42", "INNER HASH JOIN EACH WITH ALL ON $81 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $50, $81 := $51, $82 := $52, $83 := $53, $84 := $55, $85 := $56, $86 := $57, $87 := $58, $88 := $59", "INNER HASH JOIN EACH WITH ALL ON $54 = $30" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012033694344163659, "waitRatioMax": 0.0012033694344163659, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0012033694344163659, "writeRatioMax": 0.0012033694344163659 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012033694344163659, "computeRatioMax": 0.012033694344163659, "endMs": "1665776864542", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "57", "shuffleOutputBytesSpilled": "0", "slotMs": "332", "startMs": "1665776864051", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70, $71, $72, $73", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := ROOT_AVG($70)", "$61 := ROOT_AVG($71)", "$62 := ROOT_AVG($72)", "$63 := SUM($73)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage08_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.006016847172081829, "waitRatioMax": 0.006016847172081829, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.006016847172081829, "writeRatioMax": 0.006016847172081829 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "5", "elapsedMs": "651", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "554" }, { "activeUnits": "7", "completedUnits": "12", "elapsedMs": "972", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4091" } ], "totalBytesBilled": "354418688", "totalBytesProcessed": "354003429", "totalPartitionsProcessed": "0", "totalSlotMs": "4091", "transferredBytes": "0" }, "startTime": "1665776863653", "totalBytesProcessed": "354003429", "totalSlotMs": "4091" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anondd78e5af_4386_43e1_a0d5_4de6d189e834" }, "priority": "INTERACTIVE", "query": "select avg(ss_quantity)\r\n ,avg(ss_ext_sales_price)\r\n ,avg(ss_ext_wholesale_cost)\r\n ,sum(ss_ext_wholesale_cost)\r\n from store_sales\r\n ,store\r\n ,customer_demographics\r\n ,household_demographics\r\n ,customer_address\r\n ,date_dim\r\n where s_store_sk = ss_store_sk\r\n and ss_sold_date_sk = d_date_sk and d_year = 2001\r\n and((ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'M'\r\n and cd_education_status = 'Advanced Degree'\r\n and ss_sales_price between 100.00 and 150.00\r\n and hd_dep_count = 3 \r\n )or\r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'S'\r\n and cd_education_status = 'College'\r\n and ss_sales_price between 50.00 and 100.00 \r\n and hd_dep_count = 1\r\n ) or \r\n (ss_hdemo_sk=hd_demo_sk\r\n and cd_demo_sk = ss_cdemo_sk\r\n and cd_marital_status = 'W'\r\n and cd_education_status = '2 yr Degree'\r\n and ss_sales_price between 150.00 and 200.00 \r\n and hd_dep_count = 1 \r\n ))\r\n and((ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('TX', 'OH', 'TX')\r\n and ss_net_profit between 100 and 200 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('OR', 'NM', 'KY')\r\n and ss_net_profit between 150 and 300 \r\n ) or\r\n (ss_addr_sk = ca_address_sk\r\n and ca_country = 'United States'\r\n and ca_state in ('VA', 'TX', 'MS')\r\n and ss_net_profit between 50 and 250 \r\n ))\r\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "s8PygbCQhQA8qZhsInKxXw==", "id": "test-project-364309:europe-west1.query13_1665776865", "jobReference": { "jobId": "query13_1665776865", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query13_1665776865?location=europe-west1", "statistics": { "creationTime": "1665776866319", "endTime": "1665776867573", "finalExecutionDurationMs": "992", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "354003429", "performanceInsights": { "avgPreviousExecutionMs": "901" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009334889148191364, "computeRatioMax": 0.009334889148191364, "endMs": "1665776866549", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005834305717619603, "readRatioMax": 0.005834305717619603, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776866521", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011668611435239206, "waitRatioMax": 0.0011668611435239206, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01633605600933489, "writeRatioMax": 0.01633605600933489 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012835472578763127, "computeRatioMax": 0.012835472578763127, "endMs": "1665776866574", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005834305717619603, "readRatioMax": 0.005834305717619603, "recordsRead": "50000", "recordsWritten": "11613", "shuffleOutputBytes": "185808", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776866534", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_country", "FROM customer_address", "WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'OH', 'TX'), in($11, 'OR', 'NM', 'KY'), in($11, 'VA', 'TX', 'MS')))" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011668611435239206, "waitRatioMax": 0.0011668611435239206, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01633605600933489, "writeRatioMax": 0.01633605600933489 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.014002333722287048, "computeRatioMax": 0.014002333722287048, "endMs": "1665776866593", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.003500583430571762, "readRatioMax": 0.003500583430571762, "recordsRead": "7200", "recordsWritten": "1440", "shuffleOutputBytes": "25920", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776866552", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:hd_demo_sk, $21:hd_dep_count", "FROM household_demographics", "WHERE or(equal($21, 3), equal($21, 1), equal($21, 1))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011668611435239206, "waitRatioMax": 0.0011668611435239206, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.019836639439906652, "writeRatioMax": 0.019836639439906652 }, { "completedParallelInputs": "1", "computeMsAvg": "331", "computeMsMax": "331", "computeRatioAvg": 0.3862310385064177, "computeRatioMax": 0.3862310385064177, "endMs": "1665776866815", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.012835472578763127, "readRatioMax": 0.012835472578763127, "recordsRead": "1920800", "recordsWritten": "493920", "shuffleOutputBytes": "15311520", "shuffleOutputBytesSpilled": "0", "slotMs": "330", "startMs": "1665776866568", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_marital_status, $42:cd_education_status", "FROM customer_demographics", "WHERE and(or(equal($41, 'M'), equal($41, 'S'), equal($41, 'W')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011668611435239206, "waitRatioMax": 0.0011668611435239206, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01633605600933489, "writeRatioMax": 0.01633605600933489 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.008168028004667444, "computeRatioMax": 0.008168028004667444, "endMs": "1665776866623", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004667444574095682, "readRatioMax": 0.004667444574095682, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776866585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011668611435239206, "waitRatioMax": 0.0011668611435239206, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.019836639439906652, "writeRatioMax": 0.019836639439906652 }, { "completedParallelInputs": "6", "computeMsAvg": "698", "computeMsMax": "857", "computeRatioAvg": 0.8144690781796966, "computeRatioMax": 1, "endMs": "1665776867459", "id": "7", "inputStages": [ "3", "1", "4", "2", "0" ], "name": "S07: Join+", "parallelInputs": "6", "readMsAvg": "37", "readMsMax": "44", "readRatioAvg": 0.043173862310385065, "readRatioMax": 0.051341890315052506, "recordsRead": "5924504", "recordsWritten": "6", "shuffleOutputBytes": "260", "shuffleOutputBytesSpilled": "0", "slotMs": "4034", "startMs": "1665776866879", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_cdemo_sk, $52:ss_hdemo_sk, $53:ss_addr_sk, $54:ss_store_sk, $55:ss_quantity, $56:ss_sales_price, $57:ss_ext_sales_price, $58:ss_ext_wholesale_cost, $59:ss_net_profit", "FROM store_sales", "WHERE and(...)" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := SHARD_AVG($150)", "$71 := SHARD_AVG($151)", "$72 := SHARD_AVG($152)", "$73 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $141, $151 := $142, $152 := $143", "INNER HASH JOIN EACH WITH ALL ON $140 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(and(in($145, 'TX', 'OH', 'TX'), between($144, NUMERIC<...>, NUMERIC<...>)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $122, $141 := $124, $142 := $126, $143 := $127, $144 := $128, $145 := $11", "INNER HASH JOIN EACH WITH ALL ON $123 = $10" ] }, { "kind": "FILTER", "substeps": [ "or(and(equal($120, 'M'), equal($121, 'Advanced Degree'), between($125, NUMERIC<...>, NUMERIC<...>), equal($129, 3)), ...)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $108, $121 := $109, $122 := $100, $123 := $102, $124 := $103, $125 := $104, $126 := $105, $127 := $106, $128 := $107, $129 := $21", "INNER HASH JOIN EACH WITH ALL ON $101 = $20" ] }, { "kind": "JOIN", "substeps": [ "$100 := $80, $101 := $82, $102 := $83, $103 := $84, $104 := $85, $105 := $86, $106 := $87, $107 := $88, $108 := $41, $109 := $42", "INNER HASH JOIN EACH WITH ALL ON $81 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $50, $81 := $51, $82 := $52, $83 := $53, $84 := $55, $85 := $56, $86 := $57, $87 := $58, $88 := $59", "INNER HASH JOIN EACH WITH ALL ON $54 = $30" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011668611435239206, "waitRatioMax": 0.0011668611435239206, "writeMsAvg": "1", "writeMsMax": "2", "writeRatioAvg": 0.0011668611435239206, "writeRatioMax": 0.002333722287047841 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.004667444574095682, "computeRatioMax": 0.004667444574095682, "endMs": "1665776867472", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "57", "shuffleOutputBytesSpilled": "0", "slotMs": "147", "startMs": "1665776866883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70, $71, $72, $73", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$60 := ROOT_AVG($70)", "$61 := ROOT_AVG($71)", "$62 := ROOT_AVG($72)", "$63 := SUM($73)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003500583430571762, "waitRatioMax": 0.003500583430571762, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.004667444574095682, "writeRatioMax": 0.004667444574095682 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "5", "elapsedMs": "647", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "1812" }, { "activeUnits": "7", "completedUnits": "12", "elapsedMs": "1142", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5752" } ], "totalBytesBilled": "354418688", "totalBytesProcessed": "354003429", "totalPartitionsProcessed": "0", "totalSlotMs": "5752", "transferredBytes": "0" }, "startTime": "1665776866376", "totalBytesProcessed": "354003429", "totalSlotMs": "5752" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
