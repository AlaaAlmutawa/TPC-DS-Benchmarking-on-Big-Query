{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon10dc2674_34b8_41fc_8dd7_904bd62c40dc" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "r5AFrVcXywpSGcn/UF8Nkg==", "id": "test-project-364309:europe-west1.query06_1665768213", "jobReference": { "jobId": "query06_1665768213", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665768213?location=europe-west1", "statistics": { "creationTime": "1665768214725", "endTime": "1665768215785", "finalExecutionDurationMs": "828", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "720" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.023109243697478993, "computeRatioMax": 0.023109243697478993, "endMs": "1665768214911", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.01680672268907563, "readRatioMax": 0.01680672268907563, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665768214889", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01050420168067227, "writeRatioMax": 0.01050420168067227 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.023109243697478993, "computeRatioMax": 0.023109243697478993, "endMs": "1665768214943", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01050420168067227, "readRatioMax": 0.01050420168067227, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768214903", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.01050420168067227, "computeRatioMax": 0.01050420168067227, "endMs": "1665768214940", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665768214930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.023109243697478993, "waitRatioMax": 0.023109243697478993, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0021008403361344537, "writeRatioMax": 0.0021008403361344537 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012605042016806723, "computeRatioMax": 0.012605042016806723, "endMs": "1665768214969", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768214931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "12", "waitMsMax": "12", "waitRatioAvg": 0.025210084033613446, "waitRatioMax": 0.025210084033613446, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0063025210084033615, "writeRatioMax": 0.0063025210084033615 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02100840336134454, "computeRatioMax": 0.02100840336134454, "endMs": "1665768215051", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768215003", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.052521008403361345, "writeRatioMax": 0.052521008403361345 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.03991596638655462, "computeRatioMax": 0.03991596638655462, "endMs": "1665768215072", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014705882352941176, "readRatioMax": 0.014705882352941176, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665768215018", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.04831932773109244, "writeRatioMax": 0.04831932773109244 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.037815126050420166, "computeRatioMax": 0.037815126050420166, "endMs": "1665768215075", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014705882352941176, "readRatioMax": 0.014705882352941176, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768215036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.037815126050420166, "writeRatioMax": 0.037815126050420166 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.07773109243697479, "computeRatioMax": 0.07773109243697479, "endMs": "1665768215106", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012605042016806723, "readRatioMax": 0.012605042016806723, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768215066", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.025210084033613446, "writeRatioMax": 0.025210084033613446 }, { "completedParallelInputs": "1", "computeMsAvg": "159", "computeMsMax": "159", "computeRatioAvg": 0.33403361344537813, "computeRatioMax": 0.33403361344537813, "endMs": "1665768215265", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014705882352941176, "readRatioMax": 0.014705882352941176, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "174", "startMs": "1665768215136", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.046218487394957986, "writeRatioMax": 0.046218487394957986 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.037815126050420166, "endMs": "1665768215333", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "3853", "startMs": "1665768215280", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.008403361344537815, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.031512605042016806, "writeRatioMax": 0.037815126050420166 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "23", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.04831932773109244, "endMs": "1665768215337", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3750", "startMs": "1665768215280", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0063025210084033615, "waitRatioMax": 0.008403361344537815, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.014705882352941176, "computeRatioMax": 0.0273109243697479, "endMs": "1665768215340", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3378", "startMs": "1665768215281", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "4", "waitMsMax": "8", "waitRatioAvg": 0.008403361344537815, "waitRatioMax": 0.01680672268907563, "writeMsAvg": "14", "writeMsMax": "31", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.06512605042016807 }, { "completedParallelInputs": "6", "computeMsAvg": "319", "computeMsMax": "476", "computeRatioAvg": 0.6701680672268907, "computeRatioMax": 1, "endMs": "1665768215625", "id": "14", "inputStages": [ "13", "3", "11", "5", "12" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "20", "readRatioAvg": 0.029411764705882353, "readRatioMax": 0.04201680672268908, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "2025", "startMs": "1665768215298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.008403361344537815, "writeMsAvg": "6", "writeMsMax": "11", "writeRatioAvg": 0.012605042016806723, "writeRatioMax": 0.023109243697478993 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.018907563025210083, "computeRatioMax": 0.018907563025210083, "endMs": "1665768215680", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768215639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03361344537815126, "writeRatioMax": 0.03361344537815126 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012605042016806723, "computeRatioMax": 0.012605042016806723, "endMs": "1665768215693", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768215656", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01050420168067227, "writeRatioMax": 0.01050420168067227 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "593", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "12626" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "929", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14724" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "14724", "transferredBytes": "0" }, "startTime": "1665768214797", "totalBytesProcessed": "72155347", "totalSlotMs": "14724" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon202cc692_3dec_4c07_8c08_bc85866275a2" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "dRfXAvcxg1yyWMZcsowBJw==", "id": "test-project-364309:europe-west1.query06_1665776483", "jobReference": { "jobId": "query06_1665776483", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776483?location=europe-west1", "statistics": { "creationTime": "1665776484225", "endTime": "1665776485388", "finalExecutionDurationMs": "947", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "721" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.014218009478672985, "computeRatioMax": 0.014218009478672985, "endMs": "1665776484394", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011848341232227487, "readRatioMax": 0.011848341232227487, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665776484377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.011848341232227487, "writeRatioMax": 0.011848341232227487 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02843601895734597, "computeRatioMax": 0.02843601895734597, "endMs": "1665776484419", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016587677725118485, "readRatioMax": 0.016587677725118485, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776484390", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02843601895734597, "writeRatioMax": 0.02843601895734597 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.014218009478672985, "computeRatioMax": 0.014218009478672985, "endMs": "1665776484419", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665776484408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002369668246445498, "writeRatioMax": 0.002369668246445498 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.030805687203791468, "computeRatioMax": 0.030805687203791468, "endMs": "1665776484450", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776484410", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004739336492890996, "waitRatioMax": 0.004739336492890996, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.009478672985781991, "writeRatioMax": 0.009478672985781991 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.018957345971563982, "computeRatioMax": 0.018957345971563982, "endMs": "1665776484525", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776484476", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "41", "writeMsMax": "41", "writeRatioAvg": 0.0971563981042654, "writeRatioMax": 0.0971563981042654 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04265402843601896, "computeRatioMax": 0.04265402843601896, "endMs": "1665776484547", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014218009478672985, "readRatioMax": 0.014218009478672985, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665776484491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.054502369668246446, "writeRatioMax": 0.054502369668246446 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.04028436018957346, "computeRatioMax": 0.04028436018957346, "endMs": "1665776484551", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.023696682464454975, "readRatioMax": 0.023696682464454975, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776484506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.04976303317535545, "writeRatioMax": 0.04976303317535545 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.0924170616113744, "computeRatioMax": 0.0924170616113744, "endMs": "1665776484575", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016587677725118485, "readRatioMax": 0.016587677725118485, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776484534", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004739336492890996, "waitRatioMax": 0.004739336492890996, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.023696682464454975, "writeRatioMax": 0.023696682464454975 }, { "completedParallelInputs": "1", "computeMsAvg": "370", "computeMsMax": "370", "computeRatioAvg": 0.8767772511848341, "computeRatioMax": 0.8767772511848341, "endMs": "1665776484869", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.04976303317535545, "readRatioMax": 0.04976303317535545, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "616", "startMs": "1665776484596", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.07819905213270142, "writeRatioMax": 0.07819905213270142 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.018957345971563982, "computeRatioMax": 0.035545023696682464, "endMs": "1665776484970", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "3942", "startMs": "1665776484912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.0071090047393364926, "waitRatioMax": 0.016587677725118485, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.035545023696682464, "writeRatioMax": 0.05924170616113744 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.018957345971563982, "computeRatioMax": 0.04028436018957346, "endMs": "1665776484992", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "4821", "startMs": "1665776484914", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.014218009478672985, "waitRatioMax": 0.018957345971563982, "writeMsAvg": "17", "writeMsMax": "31", "writeRatioAvg": 0.04028436018957346, "writeRatioMax": 0.07345971563981042 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.016587677725118485, "computeRatioMax": 0.037914691943127965, "endMs": "1665776484981", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3162", "startMs": "1665776484916", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.016587677725118485, "waitRatioMax": 0.02132701421800948, "writeMsAvg": "8", "writeMsMax": "30", "writeRatioAvg": 0.018957345971563982, "writeRatioMax": 0.07109004739336493 }, { "completedParallelInputs": "6", "computeMsAvg": "361", "computeMsMax": "422", "computeRatioAvg": 0.8554502369668247, "computeRatioMax": 1, "endMs": "1665776485244", "id": "14", "inputStages": [ "11", "13", "3", "5", "12" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "22", "readRatioAvg": 0.03317535545023697, "readRatioMax": 0.052132701421800945, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "2249", "startMs": "1665776484936", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004739336492890996, "waitRatioMax": 0.009478672985781991, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.011848341232227487, "writeRatioMax": 0.014218009478672985 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016587677725118485, "computeRatioMax": 0.016587677725118485, "endMs": "1665776485287", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776485251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.06398104265402843, "writeRatioMax": 0.06398104265402843 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.026066350710900472, "computeRatioMax": 0.026066350710900472, "endMs": "1665776485306", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776485264", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002369668246445498, "waitRatioMax": 0.002369668246445498, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.030805687203791468, "writeRatioMax": 0.030805687203791468 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "15", "elapsedMs": "592", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2764" }, { "activeUnits": "0", "completedUnits": "317", "elapsedMs": "1050", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "16786" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "16786", "transferredBytes": "0" }, "startTime": "1665776484287", "totalBytesProcessed": "72155347", "totalSlotMs": "16786" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon48ad5448_169c_408a_b972_0f13cc088aa5" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "BDe+Z0a2C6jSL0UQpG34Fg==", "id": "test-project-364309:europe-west1.query06_1665776486", "jobReference": { "jobId": "query06_1665776486", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776486?location=europe-west1", "statistics": { "creationTime": "1665776487543", "endTime": "1665776488639", "finalExecutionDurationMs": "895", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "724" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.025056947608200455, "computeRatioMax": 0.025056947608200455, "endMs": "1665776487697", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011389521640091117, "readRatioMax": 0.011389521640091117, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776487677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01366742596810934, "writeRatioMax": 0.01366742596810934 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.025056947608200455, "computeRatioMax": 0.025056947608200455, "endMs": "1665776487736", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015945330296127564, "readRatioMax": 0.015945330296127564, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776487694", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03416856492027335, "writeRatioMax": 0.03416856492027335 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.018223234624145785, "computeRatioMax": 0.018223234624145785, "endMs": "1665776487725", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665776487713", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002277904328018223, "writeRatioMax": 0.002277904328018223 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02050113895216401, "computeRatioMax": 0.02050113895216401, "endMs": "1665776487756", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665776487715", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00683371298405467, "waitRatioMax": 0.00683371298405467, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03644646924829157, "writeRatioMax": 0.03644646924829157 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.05011389521640091, "computeRatioMax": 0.05011389521640091, "endMs": "1665776487871", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665776487793", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.0888382687927107, "writeRatioMax": 0.0888382687927107 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.05922551252847381, "computeRatioMax": 0.05922551252847381, "endMs": "1665776487863", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.022779043280182234, "readRatioMax": 0.022779043280182234, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "88", "startMs": "1665776487811", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.05922551252847381, "writeRatioMax": 0.05922551252847381 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.03644646924829157, "computeRatioMax": 0.03644646924829157, "endMs": "1665776487896", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01366742596810934, "readRatioMax": 0.01366742596810934, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665776487829", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.07289293849658314, "writeRatioMax": 0.07289293849658314 }, { "completedParallelInputs": "1", "computeMsAvg": "50", "computeMsMax": "50", "computeRatioAvg": 0.11389521640091116, "computeRatioMax": 0.11389521640091116, "endMs": "1665776487921", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.02733485193621868, "readRatioMax": 0.02733485193621868, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665776487869", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.029612756264236904, "writeRatioMax": 0.029612756264236904 }, { "completedParallelInputs": "1", "computeMsAvg": "190", "computeMsMax": "190", "computeRatioAvg": 0.4328018223234624, "computeRatioMax": 0.4328018223234624, "endMs": "1665776488087", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02050113895216401, "readRatioMax": 0.02050113895216401, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "212", "startMs": "1665776487939", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.05694760820045558, "writeRatioMax": 0.05694760820045558 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.018223234624145785, "computeRatioMax": 0.04100227790432802, "endMs": "1665776488163", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "4233", "startMs": "1665776488102", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.00683371298405467, "waitRatioMax": 0.015945330296127564, "writeMsAvg": "22", "writeMsMax": "44", "writeRatioAvg": 0.05011389521640091, "writeRatioMax": 0.10022779043280182 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.018223234624145785, "computeRatioMax": 0.04100227790432802, "endMs": "1665776488189", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "6596", "startMs": "1665776488104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.015945330296127564, "waitRatioMax": 0.02050113895216401, "writeMsAvg": "45", "writeMsMax": "58", "writeRatioAvg": 0.10250569476082004, "writeRatioMax": 0.13211845102505695 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.018223234624145785, "computeRatioMax": 0.03416856492027335, "endMs": "1665776488162", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "4285", "startMs": "1665776488105", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.018223234624145785, "waitRatioMax": 0.022779043280182234, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.03416856492027335, "writeRatioMax": 0.06605922551252848 }, { "completedParallelInputs": "6", "computeMsAvg": "399", "computeMsMax": "439", "computeRatioAvg": 0.908883826879271, "computeRatioMax": 1, "endMs": "1665776488469", "id": "14", "inputStages": [ "13", "5", "12", "11", "3" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "22", "readRatioAvg": 0.03189066059225513, "readRatioMax": 0.05011389521640091, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "2638", "startMs": "1665776488143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "5", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.011389521640091117, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.011389521640091117, "writeRatioMax": 0.01366742596810934 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.029612756264236904, "computeRatioMax": 0.029612756264236904, "endMs": "1665776488543", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665776488477", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002277904328018223, "waitRatioMax": 0.002277904328018223, "writeMsAvg": "37", "writeMsMax": "37", "writeRatioAvg": 0.08428246013667426, "writeRatioMax": 0.08428246013667426 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.029612756264236904, "computeRatioMax": 0.029612756264236904, "endMs": "1665776488549", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776488498", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.009111617312072893, "waitRatioMax": 0.009111617312072893, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02050113895216401, "writeRatioMax": 0.02050113895216401 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "42", "completedUnits": "273", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "42", "totalSlotMs": "14966" }, { "activeUnits": "42", "completedUnits": "317", "elapsedMs": "997", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "20409" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "20409", "transferredBytes": "0" }, "startTime": "1665776487589", "totalBytesProcessed": "72155347", "totalSlotMs": "20409" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6c0c0f23_f203_4cb3_ac5c_97f2bb8d9a3e" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "dO9DCvKbT/xZW3Ek3sPULQ==", "id": "test-project-364309:europe-west1.query06_1665776489", "jobReference": { "jobId": "query06_1665776489", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776489?location=europe-west1", "statistics": { "creationTime": "1665776490372", "endTime": "1665776491369", "finalExecutionDurationMs": "803", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "727" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.017429193899782137, "computeRatioMax": 0.017429193899782137, "endMs": "1665776490525", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010893246187363835, "readRatioMax": 0.010893246187363835, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665776490508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008714596949891068, "writeRatioMax": 0.008714596949891068 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02832244008714597, "computeRatioMax": 0.02832244008714597, "endMs": "1665776490563", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015250544662309368, "readRatioMax": 0.015250544662309368, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776490520", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02832244008714597, "writeRatioMax": 0.02832244008714597 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.008714596949891068, "computeRatioMax": 0.008714596949891068, "endMs": "1665776490548", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665776490536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002178649237472767, "writeRatioMax": 0.002178649237472767 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0196078431372549, "computeRatioMax": 0.0196078431372549, "endMs": "1665776490576", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776490538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006535947712418301, "waitRatioMax": 0.006535947712418301, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.013071895424836602, "writeRatioMax": 0.013071895424836602 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.015250544662309368, "computeRatioMax": 0.015250544662309368, "endMs": "1665776490650", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776490604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.05664488017429194, "writeRatioMax": 0.05664488017429194 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.032679738562091505, "computeRatioMax": 0.032679738562091505, "endMs": "1665776490656", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010893246187363835, "readRatioMax": 0.010893246187363835, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776490618", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.0457516339869281, "writeRatioMax": 0.0457516339869281 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.04793028322440087, "computeRatioMax": 0.04793028322440087, "endMs": "1665776490675", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017429193899782137, "readRatioMax": 0.017429193899782137, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776490634", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0392156862745098, "writeRatioMax": 0.0392156862745098 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.04357298474945534, "computeRatioMax": 0.04357298474945534, "endMs": "1665776490710", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010893246187363835, "readRatioMax": 0.010893246187363835, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776490678", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.032679738562091505, "writeRatioMax": 0.032679738562091505 }, { "completedParallelInputs": "1", "computeMsAvg": "115", "computeMsMax": "115", "computeRatioAvg": 0.25054466230936817, "computeRatioMax": 0.25054466230936817, "endMs": "1665776490827", "id": "10", "inputStages": [ "9" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015250544662309368, "readRatioMax": 0.015250544662309368, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "122", "startMs": "1665776490727", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "JOIN", "substeps": [ "$141 := $50, $140 := $41", "INNER HASH JOIN EACH WITH ALL ON $51 = $40" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.054466230936819175, "writeRatioMax": 0.054466230936819175 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.0196078431372549, "computeRatioMax": 0.0457516339869281, "endMs": "1665776490912", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "3083", "startMs": "1665776490839", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.004357298474945534, "waitRatioMax": 0.013071895424836602, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.032679738562091505, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.015250544662309368, "computeRatioMax": 0.034858387799564274, "endMs": "1665776490899", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "2332", "startMs": "1665776490837", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.010893246187363835, "waitRatioMax": 0.015250544662309368, "writeMsAvg": "11", "writeMsMax": "25", "writeRatioAvg": 0.023965141612200435, "writeRatioMax": 0.054466230936819175 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.017429193899782137, "computeRatioMax": 0.04357298474945534, "endMs": "1665776490893", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "2310", "startMs": "1665776490838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "6", "waitMsMax": "9", "waitRatioAvg": 0.013071895424836602, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "5", "writeMsMax": "18", "writeRatioAvg": 0.010893246187363835, "writeRatioMax": 0.0392156862745098 }, { "completedParallelInputs": "6", "computeMsAvg": "325", "computeMsMax": "459", "computeRatioAvg": 0.7080610021786492, "computeRatioMax": 1, "endMs": "1665776491206", "id": "14", "inputStages": [ "11", "13", "3", "5", "12" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "19", "readRatioAvg": 0.026143790849673203, "readRatioMax": 0.04139433551198257, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "1638", "startMs": "1665776490853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.013071895424836602, "writeRatioMax": 0.015250544662309368 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.017429193899782137, "computeRatioMax": 0.017429193899782137, "endMs": "1665776491271", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776491231", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.06318082788671024, "writeRatioMax": 0.06318082788671024 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.017429193899782137, "computeRatioMax": 0.017429193899782137, "endMs": "1665776491285", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776491257", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002178649237472767, "waitRatioMax": 0.002178649237472767, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.015250544662309368, "writeRatioMax": 0.015250544662309368 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "587", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "8724" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "898", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10120" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "10120", "transferredBytes": "0" }, "startTime": "1665776490420", "totalBytesProcessed": "72155347", "totalSlotMs": "10120" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7ba5a25c_f091_4603_8c7e_470e81c4be5e" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "wdZwN9rYzZGWYSnGqfxmGQ==", "id": "test-project-364309:europe-west1.query06_1665776492", "jobReference": { "jobId": "query06_1665776492", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776492?location=europe-west1", "statistics": { "creationTime": "1665776493269", "endTime": "1665776494426", "finalExecutionDurationMs": "948", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "728" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009817671809256662, "computeRatioMax": 0.009817671809256662, "endMs": "1665776493430", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005610098176718092, "readRatioMax": 0.005610098176718092, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665776493413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002805049088359046, "waitRatioMax": 0.002805049088359046, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0070126227208976155, "writeRatioMax": 0.0070126227208976155 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009817671809256662, "computeRatioMax": 0.009817671809256662, "endMs": "1665776493468", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0070126227208976155, "readRatioMax": 0.0070126227208976155, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776493430", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001402524544179523, "waitRatioMax": 0.001402524544179523, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0182328190743338, "writeRatioMax": 0.0182328190743338 }, { "completedParallelInputs": "1", "computeMsAvg": "3", "computeMsMax": "3", "computeRatioAvg": 0.004207573632538569, "computeRatioMax": 0.004207573632538569, "endMs": "1665776493441", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665776493433", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001402524544179523, "waitRatioMax": 0.001402524544179523, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.008415147265077139, "computeRatioMax": 0.008415147265077139, "endMs": "1665776493474", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776493437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004207573632538569, "waitRatioMax": 0.004207573632538569, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.021037868162692847, "writeRatioMax": 0.021037868162692847 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.015427769985974754, "computeRatioMax": 0.015427769985974754, "endMs": "1665776493710", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "195", "startMs": "1665776493505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001402524544179523, "waitRatioMax": 0.001402524544179523, "writeMsAvg": "196", "writeMsMax": "196", "writeRatioAvg": 0.27489481065918653, "writeRatioMax": 0.27489481065918653 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.023842917251051893, "computeRatioMax": 0.023842917251051893, "endMs": "1665776493635", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0070126227208976155, "readRatioMax": 0.0070126227208976155, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "116", "startMs": "1665776493522", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001402524544179523, "waitRatioMax": 0.001402524544179523, "writeMsAvg": "85", "writeMsMax": "85", "writeRatioAvg": 0.11921458625525946, "writeRatioMax": 0.11921458625525946 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.0364656381486676, "computeRatioMax": 0.0364656381486676, "endMs": "1665776493656", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011220196353436185, "readRatioMax": 0.011220196353436185, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776493603", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002805049088359046, "waitRatioMax": 0.002805049088359046, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.03506311360448808, "writeRatioMax": 0.03506311360448808 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.028050490883590462, "computeRatioMax": 0.028050490883590462, "endMs": "1665776493682", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011220196353436185, "readRatioMax": 0.011220196353436185, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776493649", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001402524544179523, "waitRatioMax": 0.001402524544179523, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.015427769985974754, "writeRatioMax": 0.015427769985974754 }, { "completedParallelInputs": "1", "computeMsAvg": "135", "computeMsMax": "135", "computeRatioAvg": 0.18934081346423562, "computeRatioMax": 0.18934081346423562, "endMs": "1665776493800", "id": "10", "inputStages": [ "9" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008415147265077139, "readRatioMax": 0.008415147265077139, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "182", "startMs": "1665776493700", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "JOIN", "substeps": [ "$141 := $50, $140 := $41", "INNER HASH JOIN EACH WITH ALL ON $51 = $40" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001402524544179523, "waitRatioMax": 0.001402524544179523, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.03506311360448808, "writeRatioMax": 0.03506311360448808 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.012622720897615708, "computeRatioMax": 0.023842917251051893, "endMs": "1665776493865", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "4563", "startMs": "1665776493813", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.004207573632538569, "waitRatioMax": 0.012622720897615708, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.025245441795231416, "writeRatioMax": 0.04067321178120617 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.009817671809256662, "computeRatioMax": 0.019635343618513323, "endMs": "1665776493879", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3685", "startMs": "1665776493813", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.012622720897615708, "waitRatioMax": 0.015427769985974754, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.021037868162692847, "writeRatioMax": 0.04067321178120617 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.011220196353436185, "computeRatioMax": 0.019635343618513323, "endMs": "1665776493868", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3562", "startMs": "1665776493813", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.014025245441795231, "waitRatioMax": 0.016830294530154277, "writeMsAvg": "10", "writeMsMax": "29", "writeRatioAvg": 0.014025245441795231, "writeRatioMax": 0.04067321178120617 }, { "completedParallelInputs": "6", "computeMsAvg": "415", "computeMsMax": "713", "computeRatioAvg": 0.5820476858345021, "computeRatioMax": 1, "endMs": "1665776494267", "id": "14", "inputStages": [ "12", "5", "13", "11", "3" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "24", "readRatioAvg": 0.02244039270687237, "readRatioMax": 0.033660589060308554, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "2714", "startMs": "1665776493831", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.001402524544179523, "waitRatioMax": 0.004207573632538569, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.005610098176718092, "writeRatioMax": 0.008415147265077139 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.015427769985974754, "computeRatioMax": 0.015427769985974754, "endMs": "1665776494316", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665776494274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002805049088359046, "waitRatioMax": 0.002805049088359046, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.03927068723702665, "writeRatioMax": 0.03927068723702665 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.015427769985974754, "computeRatioMax": 0.015427769985974754, "endMs": "1665776494337", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776494289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001402524544179523, "waitRatioMax": 0.001402524544179523, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.012622720897615708, "writeRatioMax": 0.012622720897615708 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "592", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "13352" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "1046", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "16108" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "16108", "transferredBytes": "0" }, "startTime": "1665776493322", "totalBytesProcessed": "72155347", "totalSlotMs": "16108" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1bd8c468_97a6_44fd_ba2c_78451ca7521d" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "K0KWcTjevTUGd2l7224KZg==", "id": "test-project-364309:europe-west1.query06_1665776495", "jobReference": { "jobId": "query06_1665776495", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776495?location=europe-west1", "statistics": { "creationTime": "1665776496153", "endTime": "1665776497202", "finalExecutionDurationMs": "827", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "730" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012526096033402923, "computeRatioMax": 0.012526096033402923, "endMs": "1665776496324", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008350730688935281, "readRatioMax": 0.008350730688935281, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665776496309", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020876826722338203, "waitRatioMax": 0.0020876826722338203, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008350730688935281, "writeRatioMax": 0.008350730688935281 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.029227557411273485, "computeRatioMax": 0.029227557411273485, "endMs": "1665776496383", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012526096033402923, "readRatioMax": 0.012526096033402923, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "77", "startMs": "1665776496329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020876826722338203, "waitRatioMax": 0.0020876826722338203, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.05845511482254697, "writeRatioMax": 0.05845511482254697 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.008350730688935281, "computeRatioMax": 0.008350730688935281, "endMs": "1665776496339", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665776496331", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0041753653444676405, "waitRatioMax": 0.0041753653444676405, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.014613778705636743, "computeRatioMax": 0.014613778705636743, "endMs": "1665776496381", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776496331", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020876826722338203, "waitRatioMax": 0.0020876826722338203, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.033402922755741124, "writeRatioMax": 0.033402922755741124 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012526096033402923, "computeRatioMax": 0.012526096033402923, "endMs": "1665776496466", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776496418", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0041753653444676405, "waitRatioMax": 0.0041753653444676405, "writeMsAvg": "40", "writeMsMax": "40", "writeRatioAvg": 0.08350730688935282, "writeRatioMax": 0.08350730688935282 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.06680584551148225, "computeRatioMax": 0.06680584551148225, "endMs": "1665776496501", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.031315240083507306, "readRatioMax": 0.031315240083507306, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "109", "startMs": "1665776496442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0041753653444676405, "waitRatioMax": 0.0041753653444676405, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.04384133611691023, "writeRatioMax": 0.04384133611691023 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.04175365344467641, "computeRatioMax": 0.04175365344467641, "endMs": "1665776496520", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.016701461377870562, "readRatioMax": 0.016701461377870562, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665776496459", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020876826722338203, "waitRatioMax": 0.0020876826722338203, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.05219206680584551, "writeRatioMax": 0.05219206680584551 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.10647181628392484, "computeRatioMax": 0.10647181628392484, "endMs": "1665776496555", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.027139874739039668, "readRatioMax": 0.027139874739039668, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776496501", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0041753653444676405, "waitRatioMax": 0.0041753653444676405, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.027139874739039668, "writeRatioMax": 0.027139874739039668 }, { "completedParallelInputs": "1", "computeMsAvg": "141", "computeMsMax": "141", "computeRatioAvg": 0.29436325678496866, "computeRatioMax": 0.29436325678496866, "endMs": "1665776496684", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012526096033402923, "readRatioMax": 0.012526096033402923, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "143", "startMs": "1665776496578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020876826722338203, "waitRatioMax": 0.0020876826722338203, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.04592901878914405, "writeRatioMax": 0.04592901878914405 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.018789144050104383, "computeRatioMax": 0.033402922755741124, "endMs": "1665776496762", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "4632", "startMs": "1665776496695", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.006263048016701462, "waitRatioMax": 0.014613778705636743, "writeMsAvg": "17", "writeMsMax": "48", "writeRatioAvg": 0.03549060542797495, "writeRatioMax": 0.10020876826722339 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.016701461377870562, "computeRatioMax": 0.031315240083507306, "endMs": "1665776496762", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "4288", "startMs": "1665776496697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.012526096033402923, "waitRatioMax": 0.016701461377870562, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.029227557411273485, "writeRatioMax": 0.05845511482254697 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.016701461377870562, "computeRatioMax": 0.03966597077244259, "endMs": "1665776496757", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3852", "startMs": "1665776496696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.014613778705636743, "waitRatioMax": 0.018789144050104383, "writeMsAvg": "15", "writeMsMax": "36", "writeRatioAvg": 0.031315240083507306, "writeRatioMax": 0.07515657620041753 }, { "completedParallelInputs": "6", "computeMsAvg": "378", "computeMsMax": "479", "computeRatioAvg": 0.7891440501043842, "computeRatioMax": 1, "endMs": "1665776497027", "id": "14", "inputStages": [ "11", "12", "13", "3", "5" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.027139874739039668, "readRatioMax": 0.03549060542797495, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "1944", "startMs": "1665776496716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0020876826722338203, "waitRatioMax": 0.006263048016701462, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.012526096033402923, "writeRatioMax": 0.016701461377870562 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.016701461377870562, "computeRatioMax": 0.016701461377870562, "endMs": "1665776497085", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776497040", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020876826722338203, "waitRatioMax": 0.0020876826722338203, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.05219206680584551, "writeRatioMax": 0.05219206680584551 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012526096033402923, "computeRatioMax": 0.012526096033402923, "endMs": "1665776497104", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776497061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0041753653444676405, "waitRatioMax": 0.0041753653444676405, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.012526096033402923, "writeRatioMax": 0.012526096033402923 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "14208" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "944", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "16167" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "16167", "transferredBytes": "0" }, "startTime": "1665776496206", "totalBytesProcessed": "72155347", "totalSlotMs": "16167" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone718bcfd_4c77_4960_84c5_08e7512aa0e1" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "3fZZzOyREAwi3PqvakOe6Q==", "id": "test-project-364309:europe-west1.query06_1665776750", "jobReference": { "jobId": "query06_1665776750", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776750?location=europe-west1", "statistics": { "creationTime": "1665776750794", "endTime": "1665776751785", "finalExecutionDurationMs": "794", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "732" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01511879049676026, "computeRatioMax": 0.01511879049676026, "endMs": "1665776750949", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008639308855291577, "readRatioMax": 0.008639308855291577, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665776750934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004319654427645789, "waitRatioMax": 0.004319654427645789, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008639308855291577, "writeRatioMax": 0.008639308855291577 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.028077753779697623, "computeRatioMax": 0.028077753779697623, "endMs": "1665776751002", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.04319654427645788, "readRatioMax": 0.04319654427645788, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776750951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021598272138228943, "waitRatioMax": 0.0021598272138228943, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.019438444924406047, "writeRatioMax": 0.019438444924406047 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.008639308855291577, "computeRatioMax": 0.008639308855291577, "endMs": "1665776750963", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665776750953", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004319654427645789, "waitRatioMax": 0.004319654427645789, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0021598272138228943, "writeRatioMax": 0.0021598272138228943 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.019438444924406047, "computeRatioMax": 0.019438444924406047, "endMs": "1665776751003", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776750953", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004319654427645789, "waitRatioMax": 0.004319654427645789, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03455723542116631, "writeRatioMax": 0.03455723542116631 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.03455723542116631, "computeRatioMax": 0.03455723542116631, "endMs": "1665776751083", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776751032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021598272138228943, "waitRatioMax": 0.0021598272138228943, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.08423326133909287, "writeRatioMax": 0.08423326133909287 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0367170626349892, "computeRatioMax": 0.0367170626349892, "endMs": "1665776751107", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012958963282937365, "readRatioMax": 0.012958963282937365, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776751050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021598272138228943, "waitRatioMax": 0.0021598272138228943, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.056155507559395246, "writeRatioMax": 0.056155507559395246 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.04967602591792657, "computeRatioMax": 0.04967602591792657, "endMs": "1665776751113", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.017278617710583154, "readRatioMax": 0.017278617710583154, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776751068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021598272138228943, "waitRatioMax": 0.0021598272138228943, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.04319654427645788, "writeRatioMax": 0.04319654427645788 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.0734341252699784, "computeRatioMax": 0.0734341252699784, "endMs": "1665776751141", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012958963282937365, "readRatioMax": 0.012958963282937365, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776751104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021598272138228943, "waitRatioMax": 0.0021598272138228943, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02159827213822894, "writeRatioMax": 0.02159827213822894 }, { "completedParallelInputs": "1", "computeMsAvg": "97", "computeMsMax": "97", "computeRatioAvg": 0.20950323974082075, "computeRatioMax": 0.20950323974082075, "endMs": "1665776751256", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01079913606911447, "readRatioMax": 0.01079913606911447, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "99", "startMs": "1665776751174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021598272138228943, "waitRatioMax": 0.0021598272138228943, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.047516198704103674, "writeRatioMax": 0.047516198704103674 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.019438444924406047, "computeRatioMax": 0.032397408207343416, "endMs": "1665776751344", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "3655", "startMs": "1665776751273", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "7", "waitRatioAvg": 0.008639308855291577, "waitRatioMax": 0.01511879049676026, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.03455723542116631, "writeRatioMax": 0.06047516198704104 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "22", "computeRatioAvg": 0.017278617710583154, "computeRatioMax": 0.047516198704103674, "endMs": "1665776751345", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3569", "startMs": "1665776751274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.012958963282937365, "waitRatioMax": 0.01511879049676026, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.03023758099352052, "writeRatioMax": 0.06263498920086392 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.017278617710583154, "computeRatioMax": 0.04103671706263499, "endMs": "1665776751339", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3036", "startMs": "1665776751275", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.012958963282937365, "waitRatioMax": 0.017278617710583154, "writeMsAvg": "11", "writeMsMax": "31", "writeRatioAvg": 0.023758099352051837, "writeRatioMax": 0.06695464362850972 }, { "completedParallelInputs": "6", "computeMsAvg": "386", "computeMsMax": "463", "computeRatioAvg": 0.8336933045356372, "computeRatioMax": 1, "endMs": "1665776751630", "id": "14", "inputStages": [ "12", "13", "5", "3", "11" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "21", "readRatioAvg": 0.0367170626349892, "readRatioMax": 0.04535637149028078, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "2194", "startMs": "1665776751294", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.0021598272138228943, "waitRatioMax": 0.008639308855291577, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.01511879049676026, "writeRatioMax": 0.019438444924406047 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.01079913606911447, "computeRatioMax": 0.01079913606911447, "endMs": "1665776751672", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665776751638", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021598272138228943, "waitRatioMax": 0.0021598272138228943, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.056155507559395246, "writeRatioMax": 0.056155507559395246 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02159827213822894, "computeRatioMax": 0.02159827213822894, "endMs": "1665776751698", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776751658", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004319654427645789, "waitRatioMax": 0.004319654427645789, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01079913606911447, "writeRatioMax": 0.01079913606911447 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "10879" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "892", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13144" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "13144", "transferredBytes": "0" }, "startTime": "1665776750846", "totalBytesProcessed": "72155347", "totalSlotMs": "13144" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon438184b5_d59c_419c_9dcc_bc8c870c686f" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/J8poNy4qsOliaQ7bLg6oQ==", "id": "test-project-364309:europe-west1.query06_1665776752", "jobReference": { "jobId": "query06_1665776752", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776752?location=europe-west1", "statistics": { "creationTime": "1665776753453", "endTime": "1665776754648", "finalExecutionDurationMs": "986", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "732" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.013293943870014771, "computeRatioMax": 0.013293943870014771, "endMs": "1665776753621", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007385524372230428, "readRatioMax": 0.007385524372230428, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665776753602", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.007385524372230428, "writeRatioMax": 0.007385524372230428 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.01772525849335303, "computeRatioMax": 0.01772525849335303, "endMs": "1665776753655", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007385524372230428, "readRatioMax": 0.007385524372230428, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776753616", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.019202363367799114, "writeRatioMax": 0.019202363367799114 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.008862629246676515, "computeRatioMax": 0.008862629246676515, "endMs": "1665776753646", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665776753633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0014771048744460858, "writeRatioMax": 0.0014771048744460858 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011816838995568686, "computeRatioMax": 0.011816838995568686, "endMs": "1665776753676", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776753636", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004431314623338257, "waitRatioMax": 0.004431314623338257, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.025110782865583457, "writeRatioMax": 0.025110782865583457 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0206794682422452, "computeRatioMax": 0.0206794682422452, "endMs": "1665776753770", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776753709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "42", "writeMsMax": "42", "writeRatioAvg": 0.0620384047267356, "writeRatioMax": 0.0620384047267356 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.03249630723781388, "computeRatioMax": 0.03249630723781388, "endMs": "1665776753768", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0103397341211226, "readRatioMax": 0.0103397341211226, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776753723", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03545051698670606, "writeRatioMax": 0.03545051698670606 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.03692762186115214, "computeRatioMax": 0.03692762186115214, "endMs": "1665776753789", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011816838995568686, "readRatioMax": 0.011816838995568686, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776753738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03545051698670606, "writeRatioMax": 0.03545051698670606 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.07680945347119646, "computeRatioMax": 0.07680945347119646, "endMs": "1665776753814", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0103397341211226, "readRatioMax": 0.0103397341211226, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776753768", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.014771048744460856, "writeRatioMax": 0.014771048744460856 }, { "completedParallelInputs": "1", "computeMsAvg": "143", "computeMsMax": "143", "computeRatioAvg": 0.21122599704579026, "computeRatioMax": 0.21122599704579026, "endMs": "1665776753959", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011816838995568686, "readRatioMax": 0.011816838995568686, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "166", "startMs": "1665776753834", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.03988183161004431, "writeRatioMax": 0.03988183161004431 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.013293943870014771, "computeRatioMax": 0.022156573116691284, "endMs": "1665776754046", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "3230", "startMs": "1665776753991", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.004431314623338257, "waitRatioMax": 0.0103397341211226, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.022156573116691284, "writeRatioMax": 0.0413589364844904 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.011816838995568686, "computeRatioMax": 0.026587887740029542, "endMs": "1665776754052", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3164", "startMs": "1665776753992", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.008862629246676515, "waitRatioMax": 0.011816838995568686, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.022156573116691284, "writeRatioMax": 0.04283604135893648 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "23", "computeRatioAvg": 0.011816838995568686, "computeRatioMax": 0.033973412112259974, "endMs": "1665776754053", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "2715", "startMs": "1665776753993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.0103397341211226, "waitRatioMax": 0.011816838995568686, "writeMsAvg": "10", "writeMsMax": "25", "writeRatioAvg": 0.014771048744460856, "writeRatioMax": 0.03692762186115214 }, { "completedParallelInputs": "6", "computeMsAvg": "456", "computeMsMax": "677", "computeRatioAvg": 0.6735598227474151, "computeRatioMax": 1, "endMs": "1665776754484", "id": "14", "inputStages": [ "11", "12", "13", "5", "3" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "58", "readRatioAvg": 0.033973412112259974, "readRatioMax": 0.08567208271787297, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "2355", "startMs": "1665776754006", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0029542097488921715, "writeMsAvg": "8", "writeMsMax": "16", "writeRatioAvg": 0.011816838995568686, "writeRatioMax": 0.023633677991137372 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.014771048744460856, "computeRatioMax": 0.014771048744460856, "endMs": "1665776754541", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776754489", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.04283604135893648, "writeRatioMax": 0.04283604135893648 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.014771048744460856, "computeRatioMax": 0.014771048744460856, "endMs": "1665776754563", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776754503", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014771048744460858, "waitRatioMax": 0.0014771048744460858, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0103397341211226, "writeRatioMax": 0.0103397341211226 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "597", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "10540" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "1094", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12923" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "12923", "transferredBytes": "0" }, "startTime": "1665776753506", "totalBytesProcessed": "72155347", "totalSlotMs": "12923" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2001ab9b_8bd2_4708_b8a5_d735001bfa5e" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "tiVKhpd9vYVVUHbkPLZIYw==", "id": "test-project-364309:europe-west1.query06_1665776755", "jobReference": { "jobId": "query06_1665776755", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776755?location=europe-west1", "statistics": { "creationTime": "1665776756264", "endTime": "1665776757309", "finalExecutionDurationMs": "839", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "736" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02109704641350211, "computeRatioMax": 0.02109704641350211, "endMs": "1665776756444", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.0379746835443038, "readRatioMax": 0.0379746835443038, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776756411", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.010548523206751054, "writeRatioMax": 0.010548523206751054 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.023206751054852322, "computeRatioMax": 0.023206751054852322, "endMs": "1665776756461", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776756422", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002109704641350211, "waitRatioMax": 0.002109704641350211, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.027426160337552744, "writeRatioMax": 0.027426160337552744 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.010548523206751054, "computeRatioMax": 0.010548523206751054, "endMs": "1665776756465", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665776756458", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002109704641350211, "waitRatioMax": 0.002109704641350211, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0189873417721519, "computeRatioMax": 0.0189873417721519, "endMs": "1665776756497", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776756460", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.027426160337552744, "writeRatioMax": 0.027426160337552744 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.016877637130801686, "computeRatioMax": 0.016877637130801686, "endMs": "1665776756580", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776756531", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002109704641350211, "waitRatioMax": 0.002109704641350211, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.06329113924050633, "writeRatioMax": 0.06329113924050633 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.03375527426160337, "computeRatioMax": 0.03375527426160337, "endMs": "1665776756587", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010548523206751054, "readRatioMax": 0.010548523206751054, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776756547", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.05063291139240506, "writeRatioMax": 0.05063291139240506 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.0379746835443038, "computeRatioMax": 0.0379746835443038, "endMs": "1665776756612", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776756563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002109704641350211, "waitRatioMax": 0.002109704641350211, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.046413502109704644, "writeRatioMax": 0.046413502109704644 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.08016877637130802, "computeRatioMax": 0.08016877637130802, "endMs": "1665776756628", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014767932489451477, "readRatioMax": 0.014767932489451477, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776756590", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002109704641350211, "waitRatioMax": 0.002109704641350211, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0189873417721519, "writeRatioMax": 0.0189873417721519 }, { "completedParallelInputs": "1", "computeMsAvg": "193", "computeMsMax": "193", "computeRatioAvg": 0.40717299578059074, "computeRatioMax": 0.40717299578059074, "endMs": "1665776756782", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014767932489451477, "readRatioMax": 0.014767932489451477, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "181", "startMs": "1665776756657", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002109704641350211, "waitRatioMax": 0.002109704641350211, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.05063291139240506, "writeRatioMax": 0.05063291139240506 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.0189873417721519, "computeRatioMax": 0.04852320675105485, "endMs": "1665776756863", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "3476", "startMs": "1665776756800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.0189873417721519, "writeMsAvg": "17", "writeMsMax": "29", "writeRatioAvg": 0.035864978902953586, "writeRatioMax": 0.06118143459915612 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.014767932489451477, "computeRatioMax": 0.027426160337552744, "endMs": "1665776756854", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "2612", "startMs": "1665776756800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.016877637130801686, "waitRatioMax": 0.02109704641350211, "writeMsAvg": "8", "writeMsMax": "27", "writeRatioAvg": 0.016877637130801686, "writeRatioMax": 0.056962025316455694 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.014767932489451477, "computeRatioMax": 0.027426160337552744, "endMs": "1665776756856", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "2381", "startMs": "1665776756800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.0189873417721519, "waitRatioMax": 0.023206751054852322, "writeMsAvg": "5", "writeMsMax": "15", "writeRatioAvg": 0.010548523206751054, "writeRatioMax": 0.03164556962025317 }, { "completedParallelInputs": "6", "computeMsAvg": "369", "computeMsMax": "474", "computeRatioAvg": 0.7784810126582279, "computeRatioMax": 1, "endMs": "1665776757163", "id": "14", "inputStages": [ "13", "12", "11", "5", "3" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "22", "readRatioAvg": 0.03164556962025317, "readRatioMax": 0.046413502109704644, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "1989", "startMs": "1665776756820", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.008438818565400843, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.014767932489451477, "writeRatioMax": 0.0189873417721519 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012658227848101266, "computeRatioMax": 0.012658227848101266, "endMs": "1665776757205", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776757169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002109704641350211, "waitRatioMax": 0.002109704641350211, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03375527426160337, "writeRatioMax": 0.03375527426160337 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.014767932489451477, "computeRatioMax": 0.014767932489451477, "endMs": "1665776757229", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776757186", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002109704641350211, "waitRatioMax": 0.002109704641350211, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.014767932489451477, "writeRatioMax": 0.014767932489451477 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "10154" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "944", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12152" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "12152", "transferredBytes": "0" }, "startTime": "1665776756318", "totalBytesProcessed": "72155347", "totalSlotMs": "12152" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf9d5068a_3c28_40c2_a968_13d9a13ce3be" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "zYJ4V+LV3ylmGwv0CNxOsA==", "id": "test-project-364309:europe-west1.query06_1665776758", "jobReference": { "jobId": "query06_1665776758", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776758?location=europe-west1", "statistics": { "creationTime": "1665776758981", "endTime": "1665776760036", "finalExecutionDurationMs": "870", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "737" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.033734939759036145, "computeRatioMax": 0.033734939759036145, "endMs": "1665776759129", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016867469879518072, "readRatioMax": 0.016867469879518072, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665776759106", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.012048192771084338, "writeRatioMax": 0.012048192771084338 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02650602409638554, "computeRatioMax": 0.02650602409638554, "endMs": "1665776759163", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.012048192771084338, "readRatioMax": 0.012048192771084338, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776759122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004819277108433735, "waitRatioMax": 0.004819277108433735, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03132530120481928, "writeRatioMax": 0.03132530120481928 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.012048192771084338, "computeRatioMax": 0.012048192771084338, "endMs": "1665776759150", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665776759139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0024096385542168677, "writeRatioMax": 0.0024096385542168677 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01927710843373494, "computeRatioMax": 0.01927710843373494, "endMs": "1665776759183", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776759142", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007228915662650603, "waitRatioMax": 0.007228915662650603, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.021686746987951807, "writeRatioMax": 0.021686746987951807 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.021686746987951807, "computeRatioMax": 0.021686746987951807, "endMs": "1665776759257", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776759208", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "41", "writeMsMax": "41", "writeRatioAvg": 0.09879518072289156, "writeRatioMax": 0.09879518072289156 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04578313253012048, "computeRatioMax": 0.04578313253012048, "endMs": "1665776759277", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.012048192771084338, "readRatioMax": 0.012048192771084338, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776759225", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.05783132530120482, "writeRatioMax": 0.05783132530120482 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.04096385542168675, "computeRatioMax": 0.04096385542168675, "endMs": "1665776759305", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014457831325301205, "readRatioMax": 0.014457831325301205, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776759245", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "41", "writeMsMax": "41", "writeRatioAvg": 0.09879518072289156, "writeRatioMax": 0.09879518072289156 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.11566265060240964, "computeRatioMax": 0.11566265060240964, "endMs": "1665776759327", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016867469879518072, "readRatioMax": 0.016867469879518072, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776759279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02650602409638554, "writeRatioMax": 0.02650602409638554 }, { "completedParallelInputs": "1", "computeMsAvg": "122", "computeMsMax": "122", "computeRatioAvg": 0.29397590361445786, "computeRatioMax": 0.29397590361445786, "endMs": "1665776759456", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016867469879518072, "readRatioMax": 0.016867469879518072, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665776759358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05301204819277108, "writeRatioMax": 0.05301204819277108 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.021686746987951807, "computeRatioMax": 0.043373493975903614, "endMs": "1665776759534", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "3031", "startMs": "1665776759476", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.004819277108433735, "waitRatioMax": 0.012048192771084338, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.03614457831325301, "writeRatioMax": 0.060240963855421686 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.01927710843373494, "computeRatioMax": 0.043373493975903614, "endMs": "1665776759534", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "2888", "startMs": "1665776759477", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.00963855421686747, "waitRatioMax": 0.014457831325301205, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.03614457831325301, "writeRatioMax": 0.06746987951807229 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.01927710843373494, "computeRatioMax": 0.05060240963855422, "endMs": "1665776759535", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "2624", "startMs": "1665776759476", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.012048192771084338, "waitRatioMax": 0.014457831325301205, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.033734939759036145, "writeRatioMax": 0.06746987951807229 }, { "completedParallelInputs": "6", "computeMsAvg": "352", "computeMsMax": "415", "computeRatioAvg": 0.8481927710843373, "computeRatioMax": 1, "endMs": "1665776759873", "id": "14", "inputStages": [ "5", "11", "13", "3", "12" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.03132530120481928, "readRatioMax": 0.04096385542168675, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "2008", "startMs": "1665776759494", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.007228915662650603, "writeMsAvg": "8", "writeMsMax": "17", "writeRatioAvg": 0.01927710843373494, "writeRatioMax": 0.04096385542168675 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01927710843373494, "computeRatioMax": 0.01927710843373494, "endMs": "1665776759929", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776759883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.06265060240963856, "writeRatioMax": 0.06265060240963856 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016867469879518072, "computeRatioMax": 0.016867469879518072, "endMs": "1665776759962", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776759904", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024096385542168677, "waitRatioMax": 0.0024096385542168677, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.05301204819277108, "writeRatioMax": 0.05301204819277108 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "579", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "9948" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "961", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12020" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "12020", "transferredBytes": "0" }, "startTime": "1665776759028", "totalBytesProcessed": "72155347", "totalSlotMs": "12020" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf4e063a7_f4c3_4dec_a4b2_83afea1dd756" }, "priority": "INTERACTIVE", "query": "-- start query 6 in stream 0 using template query6.tpl\nselect a.ca_state state, count(*) cnt\n from customer_address a\n ,customer c\n ,store_sales s\n ,date_dim d\n ,item i\n where a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t (select distinct (d_month_seq)\n \t from date_dim\n where d_year = 2001\n \t and d_moy = 1 )\n \tand i.i_current_price > 1.2 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n (select avg(j.i_current_price) \n \t from item j \n \t where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n ;\n\n-- end query 6 in stream 0 using template query6.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "wpCrbSA5nMLEj/B9wQU1lw==", "id": "test-project-364309:europe-west1.query06_1665776761", "jobReference": { "jobId": "query06_1665776761", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query06_1665776761?location=europe-west1", "statistics": { "creationTime": "1665776761652", "endTime": "1665776762583", "finalExecutionDurationMs": "743", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "72155347", "performanceInsights": { "avgPreviousExecutionMs": "738" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01904761904761905, "computeRatioMax": 0.01904761904761905, "endMs": "1665776761805", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03333333333333333, "readRatioMax": 0.03333333333333333, "recordsRead": "73049", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665776761782", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_month_seq, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), equal($62, 1))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $60" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage00_output", "BY HASH($120)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.009523809523809525, "writeRatioMax": 0.009523809523809525 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02857142857142857, "computeRatioMax": 0.02857142857142857, "endMs": "1665776761824", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014285714285714285, "readRatioMax": 0.014285714285714285, "recordsRead": "18000", "recordsWritten": "11", "shuffleOutputBytes": "284", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665776761796", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_current_price, $11:i_category", "FROM item" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $11", "$110 := SHARD_AVG($10)" ] }, { "kind": "WRITE", "substeps": [ "$180, $110", "TO __stage01_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.030952380952380953, "writeRatioMax": 0.030952380952380953 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.009523809523809525, "computeRatioMax": 0.009523809523809525, "endMs": "1665776761820", "id": "2", "inputStages": [ "0" ], "name": "S02: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665776761812", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120", "FROM __stage00_output" ] }, { "kind": "LIMIT", "substeps": [ "2" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02857142857142857, "computeRatioMax": 0.02857142857142857, "endMs": "1665776761854", "id": "3", "inputStages": [ "2" ], "name": "S03: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776761815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_AND_CHECK($130)" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02142857142857143, "computeRatioMax": 0.02142857142857143, "endMs": "1665776761924", "id": "4", "inputStages": [ "1" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776761879", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $110", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $190", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.08571428571428572, "writeRatioMax": 0.08571428571428572 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04523809523809524, "computeRatioMax": 0.04523809523809524, "endMs": "1665776761932", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.009523809523809525, "readRatioMax": 0.009523809523809525, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "662957", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776761893", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_current_price, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.05476190476190476, "writeRatioMax": 0.05476190476190476 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04523809523809524, "computeRatioMax": 0.04523809523809524, "endMs": "1665776761952", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016666666666666666, "readRatioMax": 0.016666666666666666, "recordsRead": "73050", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776761909", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim" ] }, { "kind": "FILTER", "substeps": [ "equal($31, $100)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.047619047619047616, "writeRatioMax": 0.047619047619047616 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.0880952380952381, "computeRatioMax": 0.0880952380952381, "endMs": "1665776761981", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011904761904761904, "readRatioMax": 0.011904761904761904, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776761941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:c_customer_sk, $51:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02619047619047619, "writeRatioMax": 0.02619047619047619 }, { "completedParallelInputs": "1", "computeMsAvg": "118", "computeMsMax": "118", "computeRatioAvg": 0.28095238095238095, "computeRatioMax": 0.28095238095238095, "endMs": "1665776762114", "id": "10", "inputStages": [ "8" ], "name": "S0A: Join", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011904761904761904, "readRatioMax": 0.011904761904761904, "recordsRead": "150000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665776762010", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$140 := $41, $141 := $50", "INNER HASH JOIN EACH WITH ALL ON $40 = $51" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.05476190476190476, "writeRatioMax": 0.05476190476190476 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.02142857142857143, "computeRatioMax": 0.05, "endMs": "1665776762199", "id": "11", "inputStages": [ "10" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1581388", "shuffleOutputBytesSpilled": "0", "slotMs": "3956", "startMs": "1665776762136", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.004761904761904762, "waitRatioMax": 0.011904761904761904, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.0380952380952381, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "22", "computeRatioAvg": 0.01904761904761905, "computeRatioMax": 0.05238095238095238, "endMs": "1665776762198", "id": "12", "inputStages": [ "6" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "31", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3716", "startMs": "1665776762137", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.011904761904761904, "waitRatioMax": 0.016666666666666666, "writeMsAvg": "14", "writeMsMax": "35", "writeRatioAvg": 0.03333333333333333, "writeRatioMax": 0.08333333333333333 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.01904761904761905, "computeRatioMax": 0.047619047619047616, "endMs": "1665776762203", "id": "13", "inputStages": [ "4" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10", "recordsWritten": "10", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "3903", "startMs": "1665776762138", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage04_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.014285714285714285, "waitRatioMax": 0.01904761904761905, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.0380952380952381, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "6", "computeMsAvg": "304", "computeMsMax": "420", "computeRatioAvg": 0.7238095238095238, "computeRatioMax": 1, "endMs": "1665776762453", "id": "14", "inputStages": [ "13", "3", "12", "11", "5" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "14", "readRatioAvg": 0.030952380952380953, "readRatioMax": 0.03333333333333333, "recordsRead": "3588656", "recordsWritten": "288", "shuffleOutputBytes": "4572", "shuffleOutputBytesSpilled": "0", "slotMs": "1970", "startMs": "1665776762151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$90, $190", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $201", "$80 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "greater($200, multiply(NUMERIC<...>, $202))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $171, $201 := $170, $202 := $90", "INNER HASH JOIN EACH WITH ALL ON $172 = $190" ] }, { "kind": "JOIN", "substeps": [ "$170 := $161, $171 := $2, $172 := $3", "INNER HASH JOIN EACH WITH ALL ON $160 = $1" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $150", "INNER HASH JOIN EACH WITH ALL ON $151 = $30" ] }, { "kind": "JOIN", "substeps": [ "$151 := $20, $152 := $21, $150 := $140", "INNER HASH JOIN EACH WITH ALL ON $22 = $141" ] }, { "kind": "WRITE", "substeps": [ "$210, $80", "TO __stage0E_output", "BY HASH($210)" ] } ], "waitMsAvg": "1", "waitMsMax": "6", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.014285714285714285, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.014285714285714285, "writeRatioMax": 0.01904761904761905 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02142857142857143, "computeRatioMax": 0.02142857142857143, "endMs": "1665776762500", "id": "15", "inputStages": [ "14" ], "name": "S0F: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "288", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776762463", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $80", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC, $220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater_or_equal($70, 10)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210", "$70 := SUM_OF_COUNTS($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.030952380952380953, "computeRatioMax": 0.030952380952380953, "endMs": "1665776762507", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "45", "recordsWritten": "45", "shuffleOutputBytes": "714", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776762479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$231 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002380952380952381, "waitRatioMax": 0.002380952380952381, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.016666666666666666, "writeRatioMax": 0.016666666666666666 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "309", "elapsedMs": "577", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "13419" }, { "activeUnits": "6", "completedUnits": "317", "elapsedMs": "827", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15340" } ], "totalBytesBilled": "72351744", "totalBytesProcessed": "72155347", "totalPartitionsProcessed": "0", "totalSlotMs": "15340", "transferredBytes": "0" }, "startTime": "1665776761706", "totalBytesProcessed": "72155347", "totalSlotMs": "15340" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
