{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon321172fd_a809_4995_af25_02cad7c90b41" }, "priority": "INTERACTIVE", "query": "-- start query 30 in stream 0 using template query30.tpl\nwith customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n ,date_dim\n ,customer_address\n where wr_returned_date_sk = d_date_sk \n and d_year =2002\n and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n ,ca_state)\n select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n limit 100\n;\n\n-- end query 30 in stream 0 using template query30.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ip9CBR+sNTibPxLHrKs7QA==", "id": "test-project-364309:europe-west1.query30_1665768312", "jobReference": { "jobId": "query30_1665768312", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query30_1665768312?location=europe-west1", "statistics": { "creationTime": "1665768312667", "endTime": "1665768313448", "finalExecutionDurationMs": "557", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "17303812", "performanceInsights": { "avgPreviousExecutionMs": "584" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.30392156862745096, "computeRatioMax": 0.30392156862745096, "endMs": "1665768312889", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.09803921568627451, "readRatioMax": 0.09803921568627451, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "89", "startMs": "1665768312827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.12745098039215685, "writeRatioMax": 0.12745098039215685 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.16666666666666666, "computeRatioMax": 0.16666666666666666, "endMs": "1665768312892", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.17647058823529413, "readRatioMax": 0.17647058823529413, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768312847", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.10784313725490197, "writeRatioMax": 0.10784313725490197 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.21568627450980393, "computeRatioMax": 0.21568627450980393, "endMs": "1665768312911", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.058823529411764705, "readRatioMax": 0.058823529411764705, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768312881", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.08823529411764706, "writeRatioMax": 0.08823529411764706 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.12745098039215685, "computeRatioMax": 0.12745098039215685, "endMs": "1665768312935", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.058823529411764705, "readRatioMax": 0.058823529411764705, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768312896", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.12745098039215685, "writeRatioMax": 0.12745098039215685 }, { "completedParallelInputs": "1", "computeMsAvg": "49", "computeMsMax": "49", "computeRatioAvg": 0.4803921568627451, "computeRatioMax": 0.4803921568627451, "endMs": "1665768312968", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.10784313725490197, "readRatioMax": 0.10784313725490197, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665768312915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:wr_returned_date_sk, $71:wr_returning_customer_sk, $72:wr_returning_addr_sk, $73:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240, $251 := $242", "$140 := SUM($241)" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $232, $242 := $61", "INNER HASH JOIN EACH WITH ALL ON $231 = $60" ] }, { "kind": "JOIN", "substeps": [ "$230 := $71, $231 := $72, $232 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $140", "TO __stage06_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.049019607843137254, "writeRatioMax": 0.049019607843137254 }, { "completedParallelInputs": "1", "computeMsAvg": "68", "computeMsMax": "68", "computeRatioAvg": 0.6666666666666666, "computeRatioMax": 0.6666666666666666, "endMs": "1665768313000", "id": "7", "inputStages": [ "3", "4" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.08823529411764706, "readRatioMax": 0.08823529411764706, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665768312943", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_returned_date_sk, $41:wr_returning_customer_sk, $42:wr_returning_addr_sk, $43:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.049019607843137254, "writeRatioMax": 0.049019607843137254 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.19607843137254902, "computeRatioMax": 0.19607843137254902, "endMs": "1665768313044", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "52", "shuffleOutputBytes": "1211", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768313005", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $261", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$270, $110", "TO __stage08_output", "BY HASH($270)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.11764705882352941, "writeRatioMax": 0.11764705882352941 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09803921568627451, "computeRatioMax": 0.09803921568627451, "endMs": "1665768313113", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768313064", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.2549019607843137, "writeRatioMax": 0.2549019607843137 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.3137254901960784, "computeRatioMax": 0.3137254901960784, "endMs": "1665768313133", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665768313080", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.21568627450980393, "writeRatioMax": 0.21568627450980393 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.12745098039215685, "computeRatioMax": 0.12745098039215685, "endMs": "1665768313141", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.08823529411764706, "readRatioMax": 0.08823529411764706, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768313095", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state", "FROM customer_address", "WHERE equal($21, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1568627450980392, "writeRatioMax": 0.1568627450980392 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.0784313725490196, "computeRatioMax": 0.16666666666666666, "endMs": "1665768313208", "id": "13", "inputStages": [ "10" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13316", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "4301", "startMs": "1665768313147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.029411764705882353, "waitRatioMax": 0.049019607843137254, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.19607843137254902, "writeRatioMax": 0.30392156862745096 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0784313725490196, "computeRatioMax": 0.14705882352941177, "endMs": "1665768313206", "id": "14", "inputStages": [ "9" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "4040", "startMs": "1665768313147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.06862745098039216, "waitRatioMax": 0.08823529411764706, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.13725490196078433, "writeRatioMax": 0.27450980392156865 }, { "completedParallelInputs": "1", "computeMsAvg": "102", "computeMsMax": "102", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768313292", "id": "15", "inputStages": [ "11", "14", "13" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.19607843137254902, "readRatioMax": 0.19607843137254902, "recordsRead": "115813", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "162", "startMs": "1665768313159", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name, $7:c_preferred_cust_flag, $8:c_birth_day, $9:c_birth_month, $10:c_birth_year, $11:c_birth_country, $12:c_login, $13:c_email_address, $14:c_last_review_date", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$90, $280", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC, $293 ASC, $294 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($302, multiply($303, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$290 := $210, $291 := $211, $292 := $212, $293 := $213, $294 := $214, $295 := $215, $296 := $216, $297 := $217, $298 := $218, $299 := $219, $300 := $220, $301 := $221, $302 := $223, $303 := $90", "INNER HASH JOIN EACH WITH ALL ON $222 = $280" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $201, $223 := $100", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $7, $156 := $8, $157 := $9, $158 := $10, $159 := $11, $160 := $12, $161 := $13, $162 := $14", "INNER HASH JOIN EACH WITH ALL ON $3 = $20" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "TO __stage0F_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.09803921568627451, "waitRatioMax": 0.09803921568627451, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00980392156862745, "writeRatioMax": 0.00980392156862745 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0784313725490196, "computeRatioMax": 0.0784313725490196, "endMs": "1665768313310", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "149", "startMs": "1665768313170", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $321 ASC, $322 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.029411764705882353, "waitRatioMax": 0.029411764705882353, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.08823529411764706, "writeRatioMax": 0.08823529411764706 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "212", "elapsedMs": "621", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9176" }, { "activeUnits": "0", "completedUnits": "212", "elapsedMs": "675", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9176" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "17303812", "totalPartitionsProcessed": "0", "totalSlotMs": "9176", "transferredBytes": "0" }, "startTime": "1665768312713", "totalBytesProcessed": "17303812", "totalSlotMs": "9176" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon72d3f056_9c48_4fd5_aa13_ae63c9e6f029" }, "priority": "INTERACTIVE", "query": "-- start query 30 in stream 0 using template query30.tpl\nwith customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n ,date_dim\n ,customer_address\n where wr_returned_date_sk = d_date_sk \n and d_year =2002\n and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n ,ca_state)\n select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n limit 100\n;\n\n-- end query 30 in stream 0 using template query30.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "J543FiNDK0wfqYWQF4lpCQ==", "id": "test-project-364309:europe-west1.query30_1665777250", "jobReference": { "jobId": "query30_1665777250", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query30_1665777250?location=europe-west1", "statistics": { "creationTime": "1665777251198", "endTime": "1665777251912", "finalExecutionDurationMs": "485", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "17303812", "performanceInsights": { "avgPreviousExecutionMs": "581" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.22033898305084745, "computeRatioMax": 0.22033898305084745, "endMs": "1665777251423", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06779661016949153, "readRatioMax": 0.06779661016949153, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777251381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.1440677966101695, "writeRatioMax": 0.1440677966101695 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.11864406779661017, "computeRatioMax": 0.11864406779661017, "endMs": "1665777251431", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.09322033898305085, "readRatioMax": 0.09322033898305085, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665777251394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.11016949152542373, "writeRatioMax": 0.11016949152542373 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.2457627118644068, "computeRatioMax": 0.2457627118644068, "endMs": "1665777251451", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.05084745762711865, "readRatioMax": 0.05084745762711865, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777251419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.09322033898305085, "writeRatioMax": 0.09322033898305085 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0847457627118644, "computeRatioMax": 0.0847457627118644, "endMs": "1665777251462", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.05084745762711865, "readRatioMax": 0.05084745762711865, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777251434", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1271186440677966, "writeRatioMax": 0.1271186440677966 }, { "completedParallelInputs": "1", "computeMsAvg": "73", "computeMsMax": "73", "computeRatioAvg": 0.6186440677966102, "computeRatioMax": 0.6186440677966102, "endMs": "1665777251522", "id": "6", "inputStages": [ "0", "1" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.11016949152542373, "readRatioMax": 0.11016949152542373, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "86", "startMs": "1665777251451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:wr_returned_date_sk, $71:wr_returning_customer_sk, $72:wr_returning_addr_sk, $73:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240, $251 := $242", "$140 := SUM($241)" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $232, $242 := $61", "INNER HASH JOIN EACH WITH ALL ON $231 = $60" ] }, { "kind": "JOIN", "substeps": [ "$230 := $71, $231 := $72, $232 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $140", "TO __stage06_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.059322033898305086, "writeRatioMax": 0.059322033898305086 }, { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.3983050847457627, "computeRatioMax": 0.3983050847457627, "endMs": "1665777251515", "id": "7", "inputStages": [ "4", "3" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06779661016949153, "readRatioMax": 0.06779661016949153, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777251468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_returned_date_sk, $41:wr_returning_customer_sk, $42:wr_returning_addr_sk, $43:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.03389830508474576, "writeRatioMax": 0.03389830508474576 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.16101694915254236, "computeRatioMax": 0.16101694915254236, "endMs": "1665777251598", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "52", "shuffleOutputBytes": "1211", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777251559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $261", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$270, $110", "TO __stage08_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.17796610169491525, "writeRatioMax": 0.17796610169491525 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.06779661016949153, "computeRatioMax": 0.06779661016949153, "endMs": "1665777251672", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777251621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.2457627118644068, "writeRatioMax": 0.2457627118644068 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.2457627118644068, "computeRatioMax": 0.2457627118644068, "endMs": "1665777251680", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777251637", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.1864406779661017, "writeRatioMax": 0.1864406779661017 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.07627118644067797, "computeRatioMax": 0.07627118644067797, "endMs": "1665777251676", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0423728813559322, "readRatioMax": 0.0423728813559322, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777251649", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state", "FROM customer_address", "WHERE equal($21, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.00847457627118644, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.11864406779661017, "writeRatioMax": 0.11864406779661017 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.07627118644067797, "computeRatioMax": 0.1694915254237288, "endMs": "1665777251759", "id": "14", "inputStages": [ "10" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13316", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "3399", "startMs": "1665777251696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.03389830508474576, "waitRatioMax": 0.0423728813559322, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.1271186440677966, "writeRatioMax": 0.211864406779661 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.06779661016949153, "computeRatioMax": 0.13559322033898305, "endMs": "1665777251754", "id": "15", "inputStages": [ "9" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "3112", "startMs": "1665777251699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.03389830508474576, "waitRatioMax": 0.0423728813559322, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.11864406779661017, "writeRatioMax": 0.15254237288135594 }, { "completedParallelInputs": "1", "computeMsAvg": "118", "computeMsMax": "118", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777251817", "id": "16", "inputStages": [ "11", "14", "15" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.11864406779661017, "readRatioMax": 0.11864406779661017, "recordsRead": "115813", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "130", "startMs": "1665777251706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name, $7:c_preferred_cust_flag, $8:c_birth_day, $9:c_birth_month, $10:c_birth_year, $11:c_birth_country, $12:c_login, $13:c_email_address, $14:c_last_review_date", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$90, $280", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC, $293 ASC, $294 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($302, multiply($303, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$290 := $210, $291 := $211, $292 := $212, $293 := $213, $294 := $214, $295 := $215, $296 := $216, $297 := $217, $298 := $218, $299 := $219, $300 := $220, $301 := $221, $302 := $223, $303 := $90", "INNER HASH JOIN EACH WITH ALL ON $222 = $280" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $201, $223 := $100", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $7, $156 := $8, $157 := $9, $158 := $10, $159 := $11, $160 := $12, $161 := $13, $162 := $14", "INNER HASH JOIN EACH WITH ALL ON $3 = $20" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "TO __stage10_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.0423728813559322, "waitRatioMax": 0.0423728813559322, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.03389830508474576, "writeRatioMax": 0.03389830508474576 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.07627118644067797, "computeRatioMax": 0.07627118644067797, "endMs": "1665777251833", "id": "17", "inputStages": [ "16" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777251713", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $321 ASC, $322 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.0423728813559322, "waitRatioMax": 0.0423728813559322, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.025423728813559324, "writeRatioMax": 0.025423728813559324 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "212", "elapsedMs": "582", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7187" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "17303812", "totalPartitionsProcessed": "0", "totalSlotMs": "7187", "transferredBytes": "0" }, "startTime": "1665777251282", "totalBytesProcessed": "17303812", "totalSlotMs": "7187" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonaf5f58e5_39b6_4432_af51_a307f0e016a4" }, "priority": "INTERACTIVE", "query": "-- start query 30 in stream 0 using template query30.tpl\nwith customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n ,date_dim\n ,customer_address\n where wr_returned_date_sk = d_date_sk \n and d_year =2002\n and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n ,ca_state)\n select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n limit 100\n;\n\n-- end query 30 in stream 0 using template query30.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/RGzPCu8dyRjRVBBafbTcw==", "id": "test-project-364309:europe-west1.query30_1665777253", "jobReference": { "jobId": "query30_1665777253", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query30_1665777253?location=europe-west1", "statistics": { "creationTime": "1665777253585", "endTime": "1665777254331", "finalExecutionDurationMs": "540", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "17303812", "performanceInsights": { "avgPreviousExecutionMs": "570" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.14473684210526316, "computeRatioMax": 0.14473684210526316, "endMs": "1665777253776", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03289473684210526, "readRatioMax": 0.03289473684210526, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777253734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.07894736842105263, "writeRatioMax": 0.07894736842105263 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.09210526315789473, "computeRatioMax": 0.09210526315789473, "endMs": "1665777253782", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.08552631578947369, "readRatioMax": 0.08552631578947369, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777253749", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05263157894736842, "writeRatioMax": 0.05263157894736842 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.1118421052631579, "computeRatioMax": 0.1118421052631579, "endMs": "1665777253817", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.02631578947368421, "readRatioMax": 0.02631578947368421, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777253776", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.08552631578947369, "writeRatioMax": 0.08552631578947369 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05263157894736842, "computeRatioMax": 0.05263157894736842, "endMs": "1665777253843", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.046052631578947366, "readRatioMax": 0.046052631578947366, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777253794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05263157894736842, "writeRatioMax": 0.05263157894736842 }, { "completedParallelInputs": "1", "computeMsAvg": "92", "computeMsMax": "92", "computeRatioAvg": 0.6052631578947368, "computeRatioMax": 0.6052631578947368, "endMs": "1665777253906", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.14473684210526316, "readRatioMax": 0.14473684210526316, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "123", "startMs": "1665777253811", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:wr_returned_date_sk, $71:wr_returning_customer_sk, $72:wr_returning_addr_sk, $73:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240, $251 := $242", "$140 := SUM($241)" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $232, $242 := $61", "INNER HASH JOIN EACH WITH ALL ON $231 = $60" ] }, { "kind": "JOIN", "substeps": [ "$230 := $71, $231 := $72, $232 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $140", "TO __stage06_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05263157894736842, "writeRatioMax": 0.05263157894736842 }, { "completedParallelInputs": "1", "computeMsAvg": "62", "computeMsMax": "62", "computeRatioAvg": 0.40789473684210525, "computeRatioMax": 0.40789473684210525, "endMs": "1665777253922", "id": "7", "inputStages": [ "4", "3" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.08552631578947369, "readRatioMax": 0.08552631578947369, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665777253859", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_returned_date_sk, $41:wr_returning_customer_sk, $42:wr_returning_addr_sk, $43:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013157894736842105, "waitRatioMax": 0.013157894736842105, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.09210526315789473, "computeRatioMax": 0.09210526315789473, "endMs": "1665777253960", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "52", "shuffleOutputBytes": "1211", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777253925", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $261", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$270, $110", "TO __stage08_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07236842105263158, "writeRatioMax": 0.07236842105263158 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.039473684210526314, "computeRatioMax": 0.039473684210526314, "endMs": "1665777254031", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777253985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.2565789473684211, "writeRatioMax": 0.2565789473684211 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.23684210526315788, "computeRatioMax": 0.23684210526315788, "endMs": "1665777254041", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777254001", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.11842105263157894, "writeRatioMax": 0.11842105263157894 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.03289473684210526, "computeRatioMax": 0.03289473684210526, "endMs": "1665777254054", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.08552631578947369, "readRatioMax": 0.08552631578947369, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777254017", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state", "FROM customer_address", "WHERE equal($21, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.11842105263157894, "writeRatioMax": 0.11842105263157894 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.05263157894736842, "computeRatioMax": 0.1118421052631579, "endMs": "1665777254131", "id": "13", "inputStages": [ "10" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13316", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "3370", "startMs": "1665777254067", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.019736842105263157, "waitRatioMax": 0.039473684210526314, "writeMsAvg": "21", "writeMsMax": "31", "writeRatioAvg": 0.13815789473684212, "writeRatioMax": 0.20394736842105263 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.046052631578947366, "computeRatioMax": 0.09210526315789473, "endMs": "1665777254131", "id": "14", "inputStages": [ "9" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "2392", "startMs": "1665777254068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.046052631578947366, "waitRatioMax": 0.05921052631578947, "writeMsAvg": "13", "writeMsMax": "27", "writeRatioAvg": 0.08552631578947369, "writeRatioMax": 0.17763157894736842 }, { "completedParallelInputs": "1", "computeMsAvg": "152", "computeMsMax": "152", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777254213", "id": "15", "inputStages": [ "11", "14", "13" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.09210526315789473, "readRatioMax": 0.09210526315789473, "recordsRead": "115813", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "147", "startMs": "1665777254088", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name, $7:c_preferred_cust_flag, $8:c_birth_day, $9:c_birth_month, $10:c_birth_year, $11:c_birth_country, $12:c_login, $13:c_email_address, $14:c_last_review_date", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$90, $280", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC, $293 ASC, $294 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($302, multiply($303, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$290 := $210, $291 := $211, $292 := $212, $293 := $213, $294 := $214, $295 := $215, $296 := $216, $297 := $217, $298 := $218, $299 := $219, $300 := $220, $301 := $221, $302 := $223, $303 := $90", "INNER HASH JOIN EACH WITH ALL ON $222 = $280" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $201, $223 := $100", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $7, $156 := $8, $157 := $9, $158 := $10, $159 := $11, $160 := $12, $161 := $13, $162 := $14", "INNER HASH JOIN EACH WITH ALL ON $3 = $20" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "TO __stage0F_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.05263157894736842, "waitRatioMax": 0.05263157894736842, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05263157894736842, "computeRatioMax": 0.05263157894736842, "endMs": "1665777254220", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665777254095", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $321 ASC, $322 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.02631578947368421, "waitRatioMax": 0.02631578947368421, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "212", "elapsedMs": "606", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6433" }, { "activeUnits": "0", "completedUnits": "212", "elapsedMs": "648", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6433" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "17303812", "totalPartitionsProcessed": "0", "totalSlotMs": "6433", "transferredBytes": "0" }, "startTime": "1665777253631", "totalBytesProcessed": "17303812", "totalSlotMs": "6433" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3c3adc5c_d48d_4a7c_a43a_2db498d72104" }, "priority": "INTERACTIVE", "query": "-- start query 30 in stream 0 using template query30.tpl\nwith customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n ,date_dim\n ,customer_address\n where wr_returned_date_sk = d_date_sk \n and d_year =2002\n and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n ,ca_state)\n select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n limit 100\n;\n\n-- end query 30 in stream 0 using template query30.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "q6D30T4ptde61akZXcIK2A==", "id": "test-project-364309:europe-west1.query30_1665777255", "jobReference": { "jobId": "query30_1665777255", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query30_1665777255?location=europe-west1", "statistics": { "creationTime": "1665777255997", "endTime": "1665777256842", "finalExecutionDurationMs": "562", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "17303812", "performanceInsights": { "avgPreviousExecutionMs": "567" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.25547445255474455, "computeRatioMax": 0.25547445255474455, "endMs": "1665777256242", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.08759124087591241, "readRatioMax": 0.08759124087591241, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777256195", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.08029197080291971, "writeRatioMax": 0.08029197080291971 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.058394160583941604, "computeRatioMax": 0.058394160583941604, "endMs": "1665777256248", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.051094890510948905, "readRatioMax": 0.051094890510948905, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777256212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.15328467153284672, "writeRatioMax": 0.15328467153284672 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.2116788321167883, "computeRatioMax": 0.2116788321167883, "endMs": "1665777256287", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.072992700729927, "readRatioMax": 0.072992700729927, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777256246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10218978102189781, "writeRatioMax": 0.10218978102189781 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.058394160583941604, "computeRatioMax": 0.058394160583941604, "endMs": "1665777256306", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.043795620437956206, "readRatioMax": 0.043795620437956206, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777256267", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10218978102189781, "writeRatioMax": 0.10218978102189781 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.3722627737226277, "computeRatioMax": 0.3722627737226277, "endMs": "1665777256343", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.08029197080291971, "readRatioMax": 0.08029197080291971, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665777256288", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:wr_returned_date_sk, $71:wr_returning_customer_sk, $72:wr_returning_addr_sk, $73:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240, $251 := $242", "$140 := SUM($241)" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $232, $242 := $61", "INNER HASH JOIN EACH WITH ALL ON $231 = $60" ] }, { "kind": "JOIN", "substeps": [ "$230 := $71, $231 := $72, $232 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $140", "TO __stage06_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.043795620437956206, "writeRatioMax": 0.043795620437956206 }, { "completedParallelInputs": "1", "computeMsAvg": "76", "computeMsMax": "76", "computeRatioAvg": 0.5547445255474452, "computeRatioMax": 0.5547445255474452, "endMs": "1665777256395", "id": "7", "inputStages": [ "4", "3" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.08759124087591241, "readRatioMax": 0.08759124087591241, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665777256322", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_returned_date_sk, $41:wr_returning_customer_sk, $42:wr_returning_addr_sk, $43:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06569343065693431, "writeRatioMax": 0.06569343065693431 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.10948905109489052, "computeRatioMax": 0.10948905109489052, "endMs": "1665777256407", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "52", "shuffleOutputBytes": "1211", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777256372", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $261", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$270, $110", "TO __stage08_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.072992700729927, "writeRatioMax": 0.072992700729927 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.08029197080291971, "computeRatioMax": 0.08029197080291971, "endMs": "1665777256483", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777256435", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $280", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014598540145985401, "waitRatioMax": 0.014598540145985401, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.2846715328467153, "writeRatioMax": 0.2846715328467153 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.2116788321167883, "computeRatioMax": 0.2116788321167883, "endMs": "1665777256509", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777256450", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.17518248175182483, "writeRatioMax": 0.17518248175182483 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.12408759124087591, "computeRatioMax": 0.12408759124087591, "endMs": "1665777256500", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.08029197080291971, "readRatioMax": 0.08029197080291971, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777256466", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state", "FROM customer_address", "WHERE equal($21, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.072992700729927, "writeRatioMax": 0.072992700729927 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.058394160583941604, "computeRatioMax": 0.10218978102189781, "endMs": "1665777256582", "id": "14", "inputStages": [ "10" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13316", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "3315", "startMs": "1665777256520", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.029197080291970802, "waitRatioMax": 0.0364963503649635, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.10948905109489052, "writeRatioMax": 0.1897810218978102 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.058394160583941604, "computeRatioMax": 0.10218978102189781, "endMs": "1665777256576", "id": "15", "inputStages": [ "9" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "2942", "startMs": "1665777256523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.0364963503649635, "waitRatioMax": 0.043795620437956206, "writeMsAvg": "13", "writeMsMax": "21", "writeRatioAvg": 0.0948905109489051, "writeRatioMax": 0.15328467153284672 }, { "completedParallelInputs": "1", "computeMsAvg": "137", "computeMsMax": "137", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777256681", "id": "16", "inputStages": [ "11", "14", "15" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.12408759124087591, "readRatioMax": 0.12408759124087591, "recordsRead": "115813", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "140", "startMs": "1665777256534", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name, $7:c_preferred_cust_flag, $8:c_birth_day, $9:c_birth_month, $10:c_birth_year, $11:c_birth_country, $12:c_login, $13:c_email_address, $14:c_last_review_date", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$90, $280", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC, $293 ASC, $294 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($302, multiply($303, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$290 := $210, $291 := $211, $292 := $212, $293 := $213, $294 := $214, $295 := $215, $296 := $216, $297 := $217, $298 := $218, $299 := $219, $300 := $220, $301 := $221, $302 := $223, $303 := $90", "INNER HASH JOIN EACH WITH ALL ON $222 = $280" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $201, $223 := $100", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $7, $156 := $8, $157 := $9, $158 := $10, $159 := $11, $160 := $12, $161 := $13, $162 := $14", "INNER HASH JOIN EACH WITH ALL ON $3 = $20" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "TO __stage10_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.051094890510948905, "waitRatioMax": 0.051094890510948905, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.014598540145985401, "writeRatioMax": 0.014598540145985401 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0364963503649635, "computeRatioMax": 0.0364963503649635, "endMs": "1665777256717", "id": "17", "inputStages": [ "16" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665777256538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $321 ASC, $322 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.014598540145985401, "writeRatioMax": 0.014598540145985401 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "616", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6880" }, { "activeUnits": "1", "completedUnits": "212", "elapsedMs": "679", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6998" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "17303812", "totalPartitionsProcessed": "0", "totalSlotMs": "6998", "transferredBytes": "0" }, "startTime": "1665777256081", "totalBytesProcessed": "17303812", "totalSlotMs": "6998" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon17990b23_8e5f_43d3_a294_7bf0b2ee9efb" }, "priority": "INTERACTIVE", "query": "-- start query 30 in stream 0 using template query30.tpl\nwith customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n ,date_dim\n ,customer_address\n where wr_returned_date_sk = d_date_sk \n and d_year =2002\n and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n ,ca_state)\n select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n limit 100\n;\n\n-- end query 30 in stream 0 using template query30.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "h+bmXKgVPmCVMlfN4b7KMA==", "id": "test-project-364309:europe-west1.query30_1665777257", "jobReference": { "jobId": "query30_1665777257", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query30_1665777257?location=europe-west1", "statistics": { "creationTime": "1665777258517", "endTime": "1665777259151", "finalExecutionDurationMs": "432", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "17303812", "performanceInsights": { "avgPreviousExecutionMs": "567" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.26436781609195403, "computeRatioMax": 0.26436781609195403, "endMs": "1665777258698", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.10344827586206896, "readRatioMax": 0.10344827586206896, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777258660", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.13793103448275862, "writeRatioMax": 0.13793103448275862 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.13793103448275862, "computeRatioMax": 0.13793103448275862, "endMs": "1665777258706", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.13793103448275862, "readRatioMax": 0.13793103448275862, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777258675", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.10344827586206896, "writeRatioMax": 0.10344827586206896 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.26436781609195403, "computeRatioMax": 0.26436781609195403, "endMs": "1665777258727", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.09195402298850575, "readRatioMax": 0.09195402298850575, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777258695", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.09195402298850575, "writeRatioMax": 0.09195402298850575 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.09195402298850575, "computeRatioMax": 0.09195402298850575, "endMs": "1665777258747", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.05747126436781609, "readRatioMax": 0.05747126436781609, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777258709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.16091954022988506, "writeRatioMax": 0.16091954022988506 }, { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.6436781609195402, "computeRatioMax": 0.6436781609195402, "endMs": "1665777258778", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.10344827586206896, "readRatioMax": 0.10344827586206896, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665777258725", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:wr_returned_date_sk, $71:wr_returning_customer_sk, $72:wr_returning_addr_sk, $73:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240, $251 := $242", "$140 := SUM($241)" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $232, $242 := $61", "INNER HASH JOIN EACH WITH ALL ON $231 = $60" ] }, { "kind": "JOIN", "substeps": [ "$230 := $71, $231 := $72, $232 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $140", "TO __stage06_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.6666666666666666, "computeRatioMax": 0.6666666666666666, "endMs": "1665777258819", "id": "7", "inputStages": [ "3", "4" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.13793103448275862, "readRatioMax": 0.13793103448275862, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665777258760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_returned_date_sk, $41:wr_returning_customer_sk, $42:wr_returning_addr_sk, $43:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.08045977011494253, "writeRatioMax": 0.08045977011494253 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.22988505747126436, "computeRatioMax": 0.22988505747126436, "endMs": "1665777258847", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "52", "shuffleOutputBytes": "1211", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777258809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $261", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$270, $110", "TO __stage08_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.26436781609195403, "writeRatioMax": 0.26436781609195403 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665777258922", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777258873", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.3218390804597701, "writeRatioMax": 0.3218390804597701 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.25287356321839083, "computeRatioMax": 0.25287356321839083, "endMs": "1665777258926", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777258885", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.26436781609195403, "writeRatioMax": 0.26436781609195403 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.10344827586206896, "computeRatioMax": 0.10344827586206896, "endMs": "1665777258929", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.06896551724137931, "readRatioMax": 0.06896551724137931, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777258900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state", "FROM customer_address", "WHERE equal($21, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.16091954022988506, "writeRatioMax": 0.16091954022988506 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.09195402298850575, "computeRatioMax": 0.1724137931034483, "endMs": "1665777258994", "id": "13", "inputStages": [ "10" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13316", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "3272", "startMs": "1665777258936", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.022988505747126436, "waitRatioMax": 0.04597701149425287, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.1724137931034483, "writeRatioMax": 0.2988505747126437 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.09195402298850575, "computeRatioMax": 0.19540229885057472, "endMs": "1665777259003", "id": "14", "inputStages": [ "9" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "2956", "startMs": "1665777258938", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.05747126436781609, "waitRatioMax": 0.06896551724137931, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.16091954022988506, "writeRatioMax": 0.2988505747126437 }, { "completedParallelInputs": "1", "computeMsAvg": "87", "computeMsMax": "87", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777259058", "id": "15", "inputStages": [ "14", "11", "13" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.12643678160919541, "readRatioMax": 0.12643678160919541, "recordsRead": "115813", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665777258946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name, $7:c_preferred_cust_flag, $8:c_birth_day, $9:c_birth_month, $10:c_birth_year, $11:c_birth_country, $12:c_login, $13:c_email_address, $14:c_last_review_date", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$90, $280", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC, $293 ASC, $294 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($302, multiply($303, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$290 := $210, $291 := $211, $292 := $212, $293 := $213, $294 := $214, $295 := $215, $296 := $216, $297 := $217, $298 := $218, $299 := $219, $300 := $220, $301 := $221, $302 := $223, $303 := $90", "INNER HASH JOIN EACH WITH ALL ON $222 = $280" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $201, $223 := $100", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $7, $156 := $8, $157 := $9, $158 := $10, $159 := $11, $160 := $12, $161 := $13, $162 := $14", "INNER HASH JOIN EACH WITH ALL ON $3 = $20" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "TO __stage0F_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.09195402298850575, "waitRatioMax": 0.09195402298850575, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.06896551724137931, "computeRatioMax": 0.06896551724137931, "endMs": "1665777259062", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777258953", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $321 ASC, $322 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.034482758620689655, "waitRatioMax": 0.034482758620689655, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.022988505747126436, "writeRatioMax": 0.022988505747126436 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "212", "elapsedMs": "521", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6813" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "17303812", "totalPartitionsProcessed": "0", "totalSlotMs": "6813", "transferredBytes": "0" }, "startTime": "1665777258574", "totalBytesProcessed": "17303812", "totalSlotMs": "6813" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2c46e3b4_d573_4e10_af25_6bd8b285a95a" }, "priority": "INTERACTIVE", "query": "-- start query 30 in stream 0 using template query30.tpl\nwith customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n ,date_dim\n ,customer_address\n where wr_returned_date_sk = d_date_sk \n and d_year =2002\n and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n ,ca_state)\n select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n ,c_last_review_date,ctr_total_return\n limit 100\n;\n\n-- end query 30 in stream 0 using template query30.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "LqZusyY0SsU79uoVuSl19g==", "id": "test-project-364309:europe-west1.query30_1665777260", "jobReference": { "jobId": "query30_1665777260", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query30_1665777260?location=europe-west1", "statistics": { "creationTime": "1665777260898", "endTime": "1665777261905", "finalExecutionDurationMs": "628", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "17303812", "performanceInsights": { "avgPreviousExecutionMs": "556" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.375, "computeRatioMax": 0.375, "endMs": "1665777261263", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0703125, "readRatioMax": 0.0703125, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777261216", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.0078125, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.109375, "writeRatioMax": 0.109375 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.109375, "computeRatioMax": 0.109375, "endMs": "1665777261268", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0546875, "readRatioMax": 0.0546875, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777261233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.0078125, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.046875, "writeRatioMax": 0.046875 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.2109375, "computeRatioMax": 0.2109375, "endMs": "1665777261319", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.2421875, "readRatioMax": 0.2421875, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777261262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.0078125, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0546875, "writeRatioMax": 0.0546875 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.1015625, "computeRatioMax": 0.1015625, "endMs": "1665777261318", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0546875, "readRatioMax": 0.0546875, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777261278", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015625, "waitRatioMax": 0.015625, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.09375, "writeRatioMax": 0.09375 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.40625, "computeRatioMax": 0.40625, "endMs": "1665777261370", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.1171875, "readRatioMax": 0.1171875, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665777261304", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:wr_returned_date_sk, $71:wr_returning_customer_sk, $72:wr_returning_addr_sk, $73:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240, $251 := $242", "$140 := SUM($241)" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $232, $242 := $61", "INNER HASH JOIN EACH WITH ALL ON $231 = $60" ] }, { "kind": "JOIN", "substeps": [ "$230 := $71, $231 := $72, $232 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$251, $250, $140", "TO __stage06_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.0078125, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0390625, "writeRatioMax": 0.0390625 }, { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.359375, "computeRatioMax": 0.359375, "endMs": "1665777261420", "id": "8", "inputStages": [ "3", "4" ], "name": "S08: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0625, "readRatioMax": 0.0625, "recordsRead": "122128", "recordsWritten": "13357", "shuffleOutputBytes": "436643", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777261374", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wr_returned_date_sk, $41:wr_returning_customer_sk, $42:wr_returning_addr_sk, $43:wr_return_amt", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage08_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.0078125, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.03125, "writeRatioMax": 0.03125 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.1796875, "computeRatioMax": 0.1796875, "endMs": "1665777261456", "id": "9", "inputStages": [ "6" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "52", "shuffleOutputBytes": "1211", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665777261406", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$251, $250, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $261", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$270, $110", "TO __stage09_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.0078125, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.078125, "writeRatioMax": 0.078125 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0859375, "computeRatioMax": 0.0859375, "endMs": "1665777261528", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777261479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $110", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $280", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015625, "waitRatioMax": 0.015625, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.234375, "writeRatioMax": 0.234375 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.171875, "computeRatioMax": 0.171875, "endMs": "1665777261535", "id": "11", "inputStages": [ "8" ], "name": "S0B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13357", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777261495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015625, "waitRatioMax": 0.015625, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.171875, "writeRatioMax": 0.171875 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.1015625, "computeRatioMax": 0.1015625, "endMs": "1665777261554", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.046875, "readRatioMax": 0.046875, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777261511", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_state", "FROM customer_address", "WHERE equal($21, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015625, "waitRatioMax": 0.015625, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.125, "writeRatioMax": 0.125 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0625, "computeRatioMax": 0.1171875, "endMs": "1665777261629", "id": "14", "inputStages": [ "11" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13316", "recordsWritten": "13316", "shuffleOutputBytes": "435816", "shuffleOutputBytesSpilled": "0", "slotMs": "3636", "startMs": "1665777261562", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "7", "waitRatioAvg": 0.03125, "waitRatioMax": 0.0546875, "writeMsAvg": "18", "writeMsMax": "26", "writeRatioAvg": 0.140625, "writeRatioMax": 0.203125 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "25", "computeRatioAvg": 0.0625, "computeRatioMax": 0.1953125, "endMs": "1665777261621", "id": "15", "inputStages": [ "10" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "2867", "startMs": "1665777261563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "7", "waitMsMax": "11", "waitRatioAvg": 0.0546875, "waitRatioMax": 0.0859375, "writeMsAvg": "10", "writeMsMax": "22", "writeRatioAvg": 0.078125, "writeRatioMax": 0.171875 }, { "completedParallelInputs": "1", "computeMsAvg": "128", "computeMsMax": "128", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777261703", "id": "16", "inputStages": [ "14", "12", "15" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0859375, "readRatioMax": 0.0859375, "recordsRead": "115813", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "112", "startMs": "1665777261577", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name, $7:c_preferred_cust_flag, $8:c_birth_day, $9:c_birth_month, $10:c_birth_year, $11:c_birth_country, $12:c_login, $13:c_email_address, $14:c_last_review_date", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$90, $280", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC, $293 ASC, $294 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($302, multiply($303, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$290 := $210, $291 := $211, $292 := $212, $293 := $213, $294 := $214, $295 := $215, $296 := $216, $297 := $217, $298 := $218, $299 := $219, $300 := $220, $301 := $221, $302 := $223, $303 := $90", "INNER HASH JOIN EACH WITH ALL ON $222 = $280" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $201, $223 := $100", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $7, $156 := $8, $157 := $9, $158 := $10, $159 := $11, $160 := $12, $161 := $13, $162 := $14", "INNER HASH JOIN EACH WITH ALL ON $3 = $20" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "TO __stage10_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.078125, "waitRatioMax": 0.078125, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.078125, "computeRatioMax": 0.078125, "endMs": "1665777261738", "id": "17", "inputStages": [ "16" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15581", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665777261583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $321 ASC, $322 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.015625, "waitRatioMax": 0.015625, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.03125, "writeRatioMax": 0.03125 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "777", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7111" }, { "activeUnits": "1", "completedUnits": "212", "elapsedMs": "908", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7195" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "17303812", "totalPartitionsProcessed": "0", "totalSlotMs": "7195", "transferredBytes": "0" }, "startTime": "1665777260941", "totalBytesProcessed": "17303812", "totalSlotMs": "7195" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
