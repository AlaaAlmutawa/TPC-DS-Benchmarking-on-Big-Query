{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon04214549_cf58_4701_a632_f06e902d83c4" }, "priority": "INTERACTIVE", "query": "-- start query 50 in stream 0 using template query50.tpl\nselect \n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 \n else 0 \n end) as days_30\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 \n else 0 end) as days_31_61\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 \n else 0 end) as days_61_90\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 \n else 0 end) as days_91_120 \n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 \n else 0 end) as more_120_days\nfrom\n store_sales\n ,store_returns\n ,store\n ,date_dim d1\n ,date_dim d2\nwhere\n d2.d_year = 2001\nand d2.d_moy = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk = d1.d_date_sk\nand sr_returned_date_sk = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\norder by s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n limit 100\n;\n\n-- end query 50 in stream 0 using template query50.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "rdi4hri2cmYsS5oiEzFA4w==", "id": "test-project-364309:europe-west1.query50_1665768375", "jobReference": { "jobId": "query50_1665768375", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query50_1665768375?location=europe-west1", "statistics": { "creationTime": "1665768376125", "endTime": "1665768377248", "finalExecutionDurationMs": "889", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "122891623", "performanceInsights": { "avgPreviousExecutionMs": "894" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011004126547455296, "computeRatioMax": 0.011004126547455296, "endMs": "1665768376361", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0068775790921595595, "readRatioMax": 0.0068775790921595595, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768376310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 8))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001375515818431912, "waitRatioMax": 0.001375515818431912, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.037138927097661624, "writeRatioMax": 0.037138927097661624 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.04401650618982118, "computeRatioMax": 0.04401650618982118, "endMs": "1665768376384", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0068775790921595595, "readRatioMax": 0.0068775790921595595, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "657441", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665768376325", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001375515818431912, "waitRatioMax": 0.001375515818431912, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.027510316368638238, "writeRatioMax": 0.027510316368638238 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012379642365887207, "computeRatioMax": 0.012379642365887207, "endMs": "1665768376419", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008253094910591471, "readRatioMax": 0.008253094910591471, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "1443", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665768376346", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_name, $22:s_company_id, $23:s_street_number, $24:s_street_name, $25:s_street_type, $26:s_suite_number, $27:s_city, $28:s_county, $29:s_state, $30:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001375515818431912, "waitRatioMax": 0.001375515818431912, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.039889958734525444, "writeRatioMax": 0.039889958734525444 }, { "completedParallelInputs": "1", "computeMsAvg": "212", "computeMsMax": "212", "computeRatioAvg": 0.29160935350756534, "computeRatioMax": 0.29160935350756534, "endMs": "1665768376565", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.01925722145804677, "readRatioMax": 0.01925722145804677, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "9950080", "shuffleOutputBytesSpilled": "0", "slotMs": "241", "startMs": "1665768376381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:sr_returned_date_sk, $51:sr_item_sk, $52:sr_customer_sk, $53:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002751031636863824, "waitRatioMax": 0.002751031636863824, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01925722145804677, "writeRatioMax": 0.01925722145804677 }, { "completedParallelInputs": "6", "computeMsAvg": "621", "computeMsMax": "727", "computeRatioAvg": 0.8541953232462174, "computeRatioMax": 1, "endMs": "1665768377077", "id": "5", "inputStages": [ "2", "3", "1", "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "21", "readRatioAvg": 0.02200825309491059, "readRatioMax": 0.02888583218707015, "recordsRead": "4983944", "recordsWritten": "36", "shuffleOutputBytes": "5526", "shuffleOutputBytesSpilled": "0", "slotMs": "3506", "startMs": "1665768376615", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_customer_sk, $43:ss_store_sk, $44:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $147, $168 := $148, $169 := $149", "$70 := SUM($84)", "$71 := SUM($83)", "$72 := SUM($82)", "$73 := SUM($81)", "$74 := SUM($80)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := case_no_value(greater(subtract($151, $150), 120), 1, 0)", "$81 := case_no_value(and(greater(subtract($151, $150), 90), less_or_equal(subtract($151, $150), 120)), 1, 0)", "$82 := case_no_value(and(greater(subtract($151, $150), 60), less_or_equal(subtract($151, $150), 90)), 1, 0)", "$83 := case_no_value(and(greater(subtract($151, $150), 30), less_or_equal(subtract($151, $150), 60)), 1, 0)", "$84 := case_no_value(less_or_equal(subtract($151, $150), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $120, $141 := $121, $142 := $122, $143 := $123, $144 := $124, $145 := $125, $146 := $126, $147 := $127, $148 := $128, $149 := $129, $150 := $130, $151 := $131", "INNER HASH JOIN EACH WITH ALL ON $131 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $102, $121 := $103, $122 := $104, $123 := $105, $124 := $106, $125 := $107, $126 := $108, $127 := $109, $128 := $110, $129 := $111, $130 := $100, $131 := $101", "INNER HASH JOIN EACH WITH ALL ON $100 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $90, $101 := $92, $102 := $21, $103 := $22, $104 := $23, $105 := $24, $106 := $25, $107 := $26, $108 := $27, $109 := $28, $110 := $29, $111 := $30", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $40, $91 := $43, $92 := $50", "INNER HASH JOIN EACH WITH ALL ON $44 = $53, $41 = $51, $42 = $52" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "TO __stage05_output", "BY HASH($160, $161, $162, $163, $164, $165, $166, $167, $168, $169)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001375515818431912, "waitRatioMax": 0.001375515818431912, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0068775790921595595, "writeRatioMax": 0.0068775790921595595 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.016506189821182942, "computeRatioMax": 0.016506189821182942, "endMs": "1665768377100", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665768377083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$170 ASC, $171 ASC, $172 ASC, $173 ASC, $174 ASC, $175 ASC, $176 ASC, $177 ASC, $178 ASC, $179 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161, $172 := $162, $173 := $163, $174 := $164, $175 := $165, $176 := $166, $177 := $167, $178 := $168, $179 := $169", "$60 := SUM($70)", "$61 := SUM($71)", "$62 := SUM($72)", "$63 := SUM($73)", "$64 := SUM($74)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001375515818431912, "waitRatioMax": 0.001375515818431912, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001375515818431912, "writeRatioMax": 0.001375515818431912 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013755158184319119, "computeRatioMax": 0.013755158184319119, "endMs": "1665768377142", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768377104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC, $182 ASC, $183 ASC, $184 ASC, $185 ASC, $186 ASC, $187 ASC, $188 ASC, $189 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002751031636863824, "waitRatioMax": 0.002751031636863824, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.04126547455295736, "writeRatioMax": 0.04126547455295736 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "4", "elapsedMs": "622", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "988" }, { "activeUnits": "6", "completedUnits": "12", "elapsedMs": "1005", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4371" } ], "totalBytesBilled": "123731968", "totalBytesProcessed": "122891623", "totalPartitionsProcessed": "0", "totalSlotMs": "4371", "transferredBytes": "0" }, "startTime": "1665768376188", "totalBytesProcessed": "122891623", "totalSlotMs": "4371" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5c22ea6c_fa59_4613_a24f_2c7d4f435e27" }, "priority": "INTERACTIVE", "query": "-- start query 50 in stream 0 using template query50.tpl\nselect \n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 \n else 0 \n end) as days_30\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 \n else 0 end) as days_31_61\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 \n else 0 end) as days_61_90\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 \n else 0 end) as days_91_120 \n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 \n else 0 end) as more_120_days\nfrom\n store_sales\n ,store_returns\n ,store\n ,date_dim d1\n ,date_dim d2\nwhere\n d2.d_year = 2001\nand d2.d_moy = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk = d1.d_date_sk\nand sr_returned_date_sk = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\norder by s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n limit 100\n;\n\n-- end query 50 in stream 0 using template query50.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "0EJJSiJuyGbwCeMlsrkMfA==", "id": "test-project-364309:europe-west1.query50_1665777725", "jobReference": { "jobId": "query50_1665777725", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query50_1665777725?location=europe-west1", "statistics": { "creationTime": "1665777726219", "endTime": "1665777727347", "finalExecutionDurationMs": "932", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "122891623", "performanceInsights": { "avgPreviousExecutionMs": "893" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012150668286755772, "computeRatioMax": 0.012150668286755772, "endMs": "1665777726420", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006075334143377886, "readRatioMax": 0.006075334143377886, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777726378", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 8))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001215066828675577, "waitRatioMax": 0.001215066828675577, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.020656136087484813, "writeRatioMax": 0.020656136087484813 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.038882138517618466, "computeRatioMax": 0.038882138517618466, "endMs": "1665777726439", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007290400972053463, "readRatioMax": 0.007290400972053463, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "657441", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777726391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001215066828675577, "waitRatioMax": 0.001215066828675577, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.013365735115431349, "writeRatioMax": 0.013365735115431349 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.007290400972053463, "computeRatioMax": 0.007290400972053463, "endMs": "1665777726446", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004860267314702308, "readRatioMax": 0.004860267314702308, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "1443", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777726406", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_name, $22:s_company_id, $23:s_street_number, $24:s_street_name, $25:s_street_type, $26:s_suite_number, $27:s_city, $28:s_county, $29:s_state, $30:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "TO __stage02_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0036452004860267314, "waitRatioMax": 0.0036452004860267314, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.03645200486026731, "writeRatioMax": 0.03645200486026731 }, { "completedParallelInputs": "1", "computeMsAvg": "345", "computeMsMax": "345", "computeRatioAvg": 0.41919805589307413, "computeRatioMax": 0.41919805589307413, "endMs": "1665777726689", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.018226002430133656, "readRatioMax": 0.018226002430133656, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "9950080", "shuffleOutputBytesSpilled": "0", "slotMs": "351", "startMs": "1665777726426", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:sr_returned_date_sk, $51:sr_item_sk, $52:sr_customer_sk, $53:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001215066828675577, "waitRatioMax": 0.001215066828675577, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.027946537059538274, "writeRatioMax": 0.027946537059538274 }, { "completedParallelInputs": "6", "computeMsAvg": "673", "computeMsMax": "823", "computeRatioAvg": 0.8177399756986634, "computeRatioMax": 1, "endMs": "1665777727197", "id": "5", "inputStages": [ "2", "0", "1", "3" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.018226002430133656, "readRatioMax": 0.02187120291616039, "recordsRead": "4983944", "recordsWritten": "36", "shuffleOutputBytes": "5526", "shuffleOutputBytesSpilled": "0", "slotMs": "3454", "startMs": "1665777726719", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_customer_sk, $43:ss_store_sk, $44:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $147, $168 := $148, $169 := $149", "$70 := SUM($84)", "$71 := SUM($83)", "$72 := SUM($82)", "$73 := SUM($81)", "$74 := SUM($80)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := case_no_value(greater(subtract($151, $150), 120), 1, 0)", "$81 := case_no_value(and(greater(subtract($151, $150), 90), less_or_equal(subtract($151, $150), 120)), 1, 0)", "$82 := case_no_value(and(greater(subtract($151, $150), 60), less_or_equal(subtract($151, $150), 90)), 1, 0)", "$83 := case_no_value(and(greater(subtract($151, $150), 30), less_or_equal(subtract($151, $150), 60)), 1, 0)", "$84 := case_no_value(less_or_equal(subtract($151, $150), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $120, $141 := $121, $142 := $122, $143 := $123, $144 := $124, $145 := $125, $146 := $126, $147 := $127, $148 := $128, $149 := $129, $150 := $130, $151 := $131", "INNER HASH JOIN EACH WITH ALL ON $131 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $102, $121 := $103, $122 := $104, $123 := $105, $124 := $106, $125 := $107, $126 := $108, $127 := $109, $128 := $110, $129 := $111, $130 := $100, $131 := $101", "INNER HASH JOIN EACH WITH ALL ON $100 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $90, $101 := $92, $102 := $21, $103 := $22, $104 := $23, $105 := $24, $106 := $25, $107 := $26, $108 := $27, $109 := $28, $110 := $29, $111 := $30", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $40, $91 := $43, $92 := $50", "INNER HASH JOIN EACH WITH ALL ON $44 = $53, $41 = $51, $42 = $52" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "TO __stage05_output", "BY HASH($160, $161, $162, $163, $164, $165, $166, $167, $168, $169)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001215066828675577, "waitRatioMax": 0.001215066828675577, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.004860267314702308, "writeRatioMax": 0.007290400972053463 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.007290400972053463, "computeRatioMax": 0.007290400972053463, "endMs": "1665777727220", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665777727209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$170 ASC, $171 ASC, $172 ASC, $173 ASC, $174 ASC, $175 ASC, $176 ASC, $177 ASC, $178 ASC, $179 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161, $172 := $162, $173 := $163, $174 := $164, $175 := $165, $176 := $166, $177 := $167, $178 := $168, $179 := $169", "$60 := SUM($70)", "$61 := SUM($71)", "$62 := SUM($72)", "$63 := SUM($73)", "$64 := SUM($74)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002430133657351154, "waitRatioMax": 0.002430133657351154, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001215066828675577, "writeRatioMax": 0.001215066828675577 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012150668286755772, "computeRatioMax": 0.012150668286755772, "endMs": "1665777727263", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777727225", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC, $182 ASC, $183 ASC, $184 ASC, $185 ASC, $186 ASC, $187 ASC, $188 ASC, $189 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001215066828675577, "waitRatioMax": 0.001215066828675577, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.03523693803159174, "writeRatioMax": 0.03523693803159174 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "4", "elapsedMs": "611", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "815" }, { "activeUnits": "6", "completedUnits": "12", "elapsedMs": "1030", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4307" } ], "totalBytesBilled": "123731968", "totalBytesProcessed": "122891623", "totalPartitionsProcessed": "0", "totalSlotMs": "4307", "transferredBytes": "0" }, "startTime": "1665777726268", "totalBytesProcessed": "122891623", "totalSlotMs": "4307" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonfbfcf3b2_7726_4466_8f15_08fd5bb71a82" }, "priority": "INTERACTIVE", "query": "-- start query 50 in stream 0 using template query50.tpl\nselect \n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 \n else 0 \n end) as days_30\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 \n else 0 end) as days_31_61\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 \n else 0 end) as days_61_90\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 \n else 0 end) as days_91_120 \n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 \n else 0 end) as more_120_days\nfrom\n store_sales\n ,store_returns\n ,store\n ,date_dim d1\n ,date_dim d2\nwhere\n d2.d_year = 2001\nand d2.d_moy = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk = d1.d_date_sk\nand sr_returned_date_sk = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\norder by s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n limit 100\n;\n\n-- end query 50 in stream 0 using template query50.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "41z019Ftzc+Wbf2BMC6BgA==", "id": "test-project-364309:europe-west1.query50_1665777728", "jobReference": { "jobId": "query50_1665777728", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query50_1665777728?location=europe-west1", "statistics": { "creationTime": "1665777728983", "endTime": "1665777729946", "finalExecutionDurationMs": "775", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "122891623", "performanceInsights": { "avgPreviousExecutionMs": "897" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01008827238335435, "computeRatioMax": 0.01008827238335435, "endMs": "1665777729170", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007566204287515763, "readRatioMax": 0.007566204287515763, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777729132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 8))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012610340479192938, "waitRatioMax": 0.0012610340479192938, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.018915510718789406, "writeRatioMax": 0.018915510718789406 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.0403530895334174, "computeRatioMax": 0.0403530895334174, "endMs": "1665777729195", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008827238335435058, "readRatioMax": 0.008827238335435058, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "657441", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777729147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0025220680958385876, "waitRatioMax": 0.0025220680958385876, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.013871374527112233, "writeRatioMax": 0.013871374527112233 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.008827238335435058, "computeRatioMax": 0.008827238335435058, "endMs": "1665777729204", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005044136191677175, "readRatioMax": 0.005044136191677175, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "1443", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777729165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_name, $22:s_company_id, $23:s_street_number, $24:s_street_name, $25:s_street_type, $26:s_suite_number, $27:s_city, $28:s_county, $29:s_state, $30:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012610340479192938, "waitRatioMax": 0.0012610340479192938, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.021437578814627996, "writeRatioMax": 0.021437578814627996 }, { "completedParallelInputs": "1", "computeMsAvg": "285", "computeMsMax": "285", "computeRatioAvg": 0.3593947036569987, "computeRatioMax": 0.3593947036569987, "endMs": "1665777729379", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.01639344262295082, "readRatioMax": 0.01639344262295082, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "9950080", "shuffleOutputBytesSpilled": "0", "slotMs": "264", "startMs": "1665777729182", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:sr_returned_date_sk, $51:sr_item_sk, $52:sr_customer_sk, $53:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012610340479192938, "waitRatioMax": 0.0012610340479192938, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01639344262295082, "writeRatioMax": 0.01639344262295082 }, { "completedParallelInputs": "6", "computeMsAvg": "600", "computeMsMax": "793", "computeRatioAvg": 0.7566204287515763, "computeRatioMax": 1, "endMs": "1665777729797", "id": "5", "inputStages": [ "0", "1", "3", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "17", "readRatioAvg": 0.015132408575031526, "readRatioMax": 0.021437578814627996, "recordsRead": "4983944", "recordsWritten": "36", "shuffleOutputBytes": "5526", "shuffleOutputBytesSpilled": "0", "slotMs": "2689", "startMs": "1665777729406", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_customer_sk, $43:ss_store_sk, $44:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $147, $168 := $148, $169 := $149", "$70 := SUM($84)", "$71 := SUM($83)", "$72 := SUM($82)", "$73 := SUM($81)", "$74 := SUM($80)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := case_no_value(greater(subtract($151, $150), 120), 1, 0)", "$81 := case_no_value(and(greater(subtract($151, $150), 90), less_or_equal(subtract($151, $150), 120)), 1, 0)", "$82 := case_no_value(and(greater(subtract($151, $150), 60), less_or_equal(subtract($151, $150), 90)), 1, 0)", "$83 := case_no_value(and(greater(subtract($151, $150), 30), less_or_equal(subtract($151, $150), 60)), 1, 0)", "$84 := case_no_value(less_or_equal(subtract($151, $150), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $120, $141 := $121, $142 := $122, $143 := $123, $144 := $124, $145 := $125, $146 := $126, $147 := $127, $148 := $128, $149 := $129, $150 := $130, $151 := $131", "INNER HASH JOIN EACH WITH ALL ON $131 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $102, $121 := $103, $122 := $104, $123 := $105, $124 := $106, $125 := $107, $126 := $108, $127 := $109, $128 := $110, $129 := $111, $130 := $100, $131 := $101", "INNER HASH JOIN EACH WITH ALL ON $100 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $90, $101 := $92, $102 := $21, $103 := $22, $104 := $23, $105 := $24, $106 := $25, $107 := $26, $108 := $27, $109 := $28, $110 := $29, $111 := $30", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $40, $91 := $43, $92 := $50", "INNER HASH JOIN EACH WITH ALL ON $44 = $53, $41 = $51, $42 = $52" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "TO __stage05_output", "BY HASH($160, $161, $162, $163, $164, $165, $166, $167, $168, $169)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0025220680958385876, "waitRatioMax": 0.0025220680958385876, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.005044136191677175, "writeRatioMax": 0.005044136191677175 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.005044136191677175, "computeRatioMax": 0.005044136191677175, "endMs": "1665777729824", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665777729815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$170 ASC, $171 ASC, $172 ASC, $173 ASC, $174 ASC, $175 ASC, $176 ASC, $177 ASC, $178 ASC, $179 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161, $172 := $162, $173 := $163, $174 := $164, $175 := $165, $176 := $166, $177 := $167, $178 := $168, $179 := $169", "$60 := SUM($70)", "$61 := SUM($71)", "$62 := SUM($72)", "$63 := SUM($73)", "$64 := SUM($74)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0025220680958385876, "waitRatioMax": 0.0025220680958385876, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012610340479192938, "computeRatioMax": 0.012610340479192938, "endMs": "1665777729866", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777729829", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC, $182 ASC, $183 ASC, $184 ASC, $185 ASC, $186 ASC, $187 ASC, $188 ASC, $189 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0025220680958385876, "waitRatioMax": 0.0025220680958385876, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0201765447667087, "writeRatioMax": 0.0201765447667087 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "4", "elapsedMs": "599", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "1042" }, { "activeUnits": "6", "completedUnits": "12", "elapsedMs": "868", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3509" } ], "totalBytesBilled": "123731968", "totalBytesProcessed": "122891623", "totalPartitionsProcessed": "0", "totalSlotMs": "3509", "transferredBytes": "0" }, "startTime": "1665777729034", "totalBytesProcessed": "122891623", "totalSlotMs": "3509" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf3b8a32c_2cc9_4cb8_90f7_1f4e60cad818" }, "priority": "INTERACTIVE", "query": "-- start query 50 in stream 0 using template query50.tpl\nselect \n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 \n else 0 \n end) as days_30\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 \n else 0 end) as days_31_61\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 \n else 0 end) as days_61_90\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 \n else 0 end) as days_91_120 \n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 \n else 0 end) as more_120_days\nfrom\n store_sales\n ,store_returns\n ,store\n ,date_dim d1\n ,date_dim d2\nwhere\n d2.d_year = 2001\nand d2.d_moy = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk = d1.d_date_sk\nand sr_returned_date_sk = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\norder by s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n limit 100\n;\n\n-- end query 50 in stream 0 using template query50.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Vk+/Emd6dbEaUNzO54PlWQ==", "id": "test-project-364309:europe-west1.query50_1665777731", "jobReference": { "jobId": "query50_1665777731", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query50_1665777731?location=europe-west1", "statistics": { "creationTime": "1665777731634", "endTime": "1665777732610", "finalExecutionDurationMs": "794", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "122891623", "performanceInsights": { "avgPreviousExecutionMs": "885" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01557632398753894, "computeRatioMax": 0.01557632398753894, "endMs": "1665777731805", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009345794392523364, "readRatioMax": 0.009345794392523364, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777731772", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 8))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001557632398753894, "waitRatioMax": 0.001557632398753894, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.010903426791277258, "writeRatioMax": 0.010903426791277258 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.048286604361370715, "computeRatioMax": 0.048286604361370715, "endMs": "1665777731824", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010903426791277258, "readRatioMax": 0.010903426791277258, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "657441", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777731786", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001557632398753894, "waitRatioMax": 0.001557632398753894, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01557632398753894, "writeRatioMax": 0.01557632398753894 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.017133956386292833, "computeRatioMax": 0.017133956386292833, "endMs": "1665777731828", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009345794392523364, "readRatioMax": 0.009345794392523364, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "1443", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777731800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_name, $22:s_company_id, $23:s_street_number, $24:s_street_name, $25:s_street_type, $26:s_suite_number, $27:s_city, $28:s_county, $29:s_state, $30:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001557632398753894, "waitRatioMax": 0.001557632398753894, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.018691588785046728, "writeRatioMax": 0.018691588785046728 }, { "completedParallelInputs": "1", "computeMsAvg": "245", "computeMsMax": "245", "computeRatioAvg": 0.38161993769470404, "computeRatioMax": 0.38161993769470404, "endMs": "1665777732026", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.03582554517133956, "readRatioMax": 0.03582554517133956, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "9950080", "shuffleOutputBytesSpilled": "0", "slotMs": "221", "startMs": "1665777731814", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:sr_returned_date_sk, $51:sr_item_sk, $52:sr_customer_sk, $53:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001557632398753894, "waitRatioMax": 0.001557632398753894, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.037383177570093455, "writeRatioMax": 0.037383177570093455 }, { "completedParallelInputs": "6", "computeMsAvg": "560", "computeMsMax": "642", "computeRatioAvg": 0.8722741433021807, "computeRatioMax": 1, "endMs": "1665777732474", "id": "5", "inputStages": [ "1", "0", "3", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "23", "readRatioAvg": 0.0264797507788162, "readRatioMax": 0.03582554517133956, "recordsRead": "4983944", "recordsWritten": "36", "shuffleOutputBytes": "5526", "shuffleOutputBytesSpilled": "0", "slotMs": "2989", "startMs": "1665777732056", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_customer_sk, $43:ss_store_sk, $44:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $147, $168 := $148, $169 := $149", "$70 := SUM($84)", "$71 := SUM($83)", "$72 := SUM($82)", "$73 := SUM($81)", "$74 := SUM($80)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := case_no_value(greater(subtract($151, $150), 120), 1, 0)", "$81 := case_no_value(and(greater(subtract($151, $150), 90), less_or_equal(subtract($151, $150), 120)), 1, 0)", "$82 := case_no_value(and(greater(subtract($151, $150), 60), less_or_equal(subtract($151, $150), 90)), 1, 0)", "$83 := case_no_value(and(greater(subtract($151, $150), 30), less_or_equal(subtract($151, $150), 60)), 1, 0)", "$84 := case_no_value(less_or_equal(subtract($151, $150), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $120, $141 := $121, $142 := $122, $143 := $123, $144 := $124, $145 := $125, $146 := $126, $147 := $127, $148 := $128, $149 := $129, $150 := $130, $151 := $131", "INNER HASH JOIN EACH WITH ALL ON $131 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $102, $121 := $103, $122 := $104, $123 := $105, $124 := $106, $125 := $107, $126 := $108, $127 := $109, $128 := $110, $129 := $111, $130 := $100, $131 := $101", "INNER HASH JOIN EACH WITH ALL ON $100 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $90, $101 := $92, $102 := $21, $103 := $22, $104 := $23, $105 := $24, $106 := $25, $107 := $26, $108 := $27, $109 := $28, $110 := $29, $111 := $30", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $40, $91 := $43, $92 := $50", "INNER HASH JOIN EACH WITH ALL ON $44 = $53, $41 = $51, $42 = $52" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "TO __stage05_output", "BY HASH($160, $161, $162, $163, $164, $165, $166, $167, $168, $169)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001557632398753894, "waitRatioMax": 0.003115264797507788, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.00778816199376947, "writeRatioMax": 0.009345794392523364 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.012461059190031152, "computeRatioMax": 0.012461059190031152, "endMs": "1665777732492", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665777732481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$170 ASC, $171 ASC, $172 ASC, $173 ASC, $174 ASC, $175 ASC, $176 ASC, $177 ASC, $178 ASC, $179 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161, $172 := $162, $173 := $163, $174 := $164, $175 := $165, $176 := $166, $177 := $167, $178 := $168, $179 := $169", "$60 := SUM($70)", "$61 := SUM($71)", "$62 := SUM($72)", "$63 := SUM($73)", "$64 := SUM($74)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001557632398753894, "waitRatioMax": 0.001557632398753894, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001557632398753894, "writeRatioMax": 0.001557632398753894 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.018691588785046728, "computeRatioMax": 0.018691588785046728, "endMs": "1665777732532", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777732496", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC, $182 ASC, $183 ASC, $184 ASC, $185 ASC, $186 ASC, $187 ASC, $188 ASC, $189 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001557632398753894, "waitRatioMax": 0.001557632398753894, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.020249221183800622, "writeRatioMax": 0.020249221183800622 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "4", "elapsedMs": "593", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2508" }, { "activeUnits": "6", "completedUnits": "12", "elapsedMs": "887", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4544" } ], "totalBytesBilled": "123731968", "totalBytesProcessed": "122891623", "totalPartitionsProcessed": "0", "totalSlotMs": "4544", "transferredBytes": "0" }, "startTime": "1665777731679", "totalBytesProcessed": "122891623", "totalSlotMs": "4544" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb0943b3d_1562_4e46_a4a4_1d31cd3c8e78" }, "priority": "INTERACTIVE", "query": "-- start query 50 in stream 0 using template query50.tpl\nselect \n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 \n else 0 \n end) as days_30\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 \n else 0 end) as days_31_61\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 \n else 0 end) as days_61_90\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 \n else 0 end) as days_91_120 \n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 \n else 0 end) as more_120_days\nfrom\n store_sales\n ,store_returns\n ,store\n ,date_dim d1\n ,date_dim d2\nwhere\n d2.d_year = 2001\nand d2.d_moy = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk = d1.d_date_sk\nand sr_returned_date_sk = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\norder by s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n limit 100\n;\n\n-- end query 50 in stream 0 using template query50.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "MHQUjA2bIQgK9oLFqURAmw==", "id": "test-project-364309:europe-west1.query50_1665777733", "jobReference": { "jobId": "query50_1665777733", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query50_1665777733?location=europe-west1", "statistics": { "creationTime": "1665777734262", "endTime": "1665777735257", "finalExecutionDurationMs": "760", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "122891623", "performanceInsights": { "avgPreviousExecutionMs": "877" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.016233766233766232, "computeRatioMax": 0.016233766233766232, "endMs": "1665777734474", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011363636363636364, "readRatioMax": 0.011363636363636364, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777734432", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 8))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016233766233766235, "waitRatioMax": 0.0016233766233766235, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.024350649350649352, "writeRatioMax": 0.024350649350649352 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.04220779220779221, "computeRatioMax": 0.04220779220779221, "endMs": "1665777734480", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00974025974025974, "readRatioMax": 0.00974025974025974, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "657441", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777734447", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016233766233766235, "waitRatioMax": 0.0016233766233766235, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.016233766233766232, "writeRatioMax": 0.016233766233766232 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.011363636363636364, "computeRatioMax": 0.011363636363636364, "endMs": "1665777734489", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008116883116883116, "readRatioMax": 0.008116883116883116, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "1443", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665777734462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_name, $22:s_company_id, $23:s_street_number, $24:s_street_name, $25:s_street_type, $26:s_suite_number, $27:s_city, $28:s_county, $29:s_state, $30:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016233766233766235, "waitRatioMax": 0.0016233766233766235, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.024350649350649352, "writeRatioMax": 0.024350649350649352 }, { "completedParallelInputs": "1", "computeMsAvg": "213", "computeMsMax": "213", "computeRatioAvg": 0.3457792207792208, "computeRatioMax": 0.3457792207792208, "endMs": "1665777734651", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.022727272727272728, "readRatioMax": 0.022727272727272728, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "9950080", "shuffleOutputBytesSpilled": "0", "slotMs": "238", "startMs": "1665777734478", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:sr_returned_date_sk, $51:sr_item_sk, $52:sr_customer_sk, $53:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016233766233766235, "waitRatioMax": 0.0016233766233766235, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.032467532467532464, "writeRatioMax": 0.032467532467532464 }, { "completedParallelInputs": "6", "computeMsAvg": "578", "computeMsMax": "616", "computeRatioAvg": 0.9383116883116883, "computeRatioMax": 1, "endMs": "1665777735092", "id": "5", "inputStages": [ "1", "0", "3", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.021103896103896104, "readRatioMax": 0.027597402597402596, "recordsRead": "4983944", "recordsWritten": "36", "shuffleOutputBytes": "5526", "shuffleOutputBytesSpilled": "0", "slotMs": "3085", "startMs": "1665777734684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_customer_sk, $43:ss_store_sk, $44:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $147, $168 := $148, $169 := $149", "$70 := SUM($84)", "$71 := SUM($83)", "$72 := SUM($82)", "$73 := SUM($81)", "$74 := SUM($80)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := case_no_value(greater(subtract($151, $150), 120), 1, 0)", "$81 := case_no_value(and(greater(subtract($151, $150), 90), less_or_equal(subtract($151, $150), 120)), 1, 0)", "$82 := case_no_value(and(greater(subtract($151, $150), 60), less_or_equal(subtract($151, $150), 90)), 1, 0)", "$83 := case_no_value(and(greater(subtract($151, $150), 30), less_or_equal(subtract($151, $150), 60)), 1, 0)", "$84 := case_no_value(less_or_equal(subtract($151, $150), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $120, $141 := $121, $142 := $122, $143 := $123, $144 := $124, $145 := $125, $146 := $126, $147 := $127, $148 := $128, $149 := $129, $150 := $130, $151 := $131", "INNER HASH JOIN EACH WITH ALL ON $131 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $102, $121 := $103, $122 := $104, $123 := $105, $124 := $106, $125 := $107, $126 := $108, $127 := $109, $128 := $110, $129 := $111, $130 := $100, $131 := $101", "INNER HASH JOIN EACH WITH ALL ON $100 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $90, $101 := $92, $102 := $21, $103 := $22, $104 := $23, $105 := $24, $106 := $25, $107 := $26, $108 := $27, $109 := $28, $110 := $29, $111 := $30", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $40, $91 := $43, $92 := $50", "INNER HASH JOIN EACH WITH ALL ON $44 = $53, $41 = $51, $42 = $52" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "TO __stage05_output", "BY HASH($160, $161, $162, $163, $164, $165, $166, $167, $168, $169)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016233766233766235, "waitRatioMax": 0.0016233766233766235, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.008116883116883116, "writeRatioMax": 0.00974025974025974 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.008116883116883116, "computeRatioMax": 0.008116883116883116, "endMs": "1665777735118", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665777735104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$170 ASC, $171 ASC, $172 ASC, $173 ASC, $174 ASC, $175 ASC, $176 ASC, $177 ASC, $178 ASC, $179 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161, $172 := $162, $173 := $163, $174 := $164, $175 := $165, $176 := $166, $177 := $167, $178 := $168, $179 := $169", "$60 := SUM($70)", "$61 := SUM($71)", "$62 := SUM($72)", "$63 := SUM($73)", "$64 := SUM($74)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016233766233766235, "waitRatioMax": 0.0016233766233766235, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.011363636363636364, "computeRatioMax": 0.011363636363636364, "endMs": "1665777735154", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777735118", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC, $182 ASC, $183 ASC, $184 ASC, $185 ASC, $186 ASC, $187 ASC, $188 ASC, $189 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214", "TO __stage07_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02922077922077922, "writeRatioMax": 0.02922077922077922 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "4", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "820" }, { "activeUnits": "6", "completedUnits": "12", "elapsedMs": "860", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3531" } ], "totalBytesBilled": "123731968", "totalBytesProcessed": "122891623", "totalPartitionsProcessed": "0", "totalSlotMs": "3531", "transferredBytes": "0" }, "startTime": "1665777734325", "totalBytesProcessed": "122891623", "totalSlotMs": "3531" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon87fecda4_1366_4ab7_ae76_d657781c2d23" }, "priority": "INTERACTIVE", "query": "-- start query 50 in stream 0 using template query50.tpl\nselect \n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 \n else 0 \n end) as days_30\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 \n else 0 end) as days_31_61\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 \n else 0 end) as days_61_90\n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 \n else 0 end) as days_91_120 \n ,sum(case \n when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 \n else 0 end) as more_120_days\nfrom\n store_sales\n ,store_returns\n ,store\n ,date_dim d1\n ,date_dim d2\nwhere\n d2.d_year = 2001\nand d2.d_moy = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk = d1.d_date_sk\nand sr_returned_date_sk = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\norder by s_store_name\n ,s_company_id\n ,s_street_number\n ,s_street_name\n ,s_street_type\n ,s_suite_number\n ,s_city\n ,s_county\n ,s_state\n ,s_zip\n limit 100\n;\n\n-- end query 50 in stream 0 using template query50.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "L9uQjPq9OnWJVwb+9+ZB/A==", "id": "test-project-364309:europe-west1.query50_1665777736", "jobReference": { "jobId": "query50_1665777736", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query50_1665777736?location=europe-west1", "statistics": { "creationTime": "1665777736833", "endTime": "1665777737912", "finalExecutionDurationMs": "882", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "122891623", "performanceInsights": { "avgPreviousExecutionMs": "867" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011126564673157162, "computeRatioMax": 0.011126564673157162, "endMs": "1665777737019", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006954102920723227, "readRatioMax": 0.006954102920723227, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777736982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), equal($12, 8))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.019471488178025034, "writeRatioMax": 0.019471488178025034 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.04033379694019471, "computeRatioMax": 0.04033379694019471, "endMs": "1665777737031", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008344923504867872, "readRatioMax": 0.008344923504867872, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "657441", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777736997", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.015299026425591099, "writeRatioMax": 0.015299026425591099 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012517385257301807, "computeRatioMax": 0.012517385257301807, "endMs": "1665777737050", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005563282336578581, "readRatioMax": 0.005563282336578581, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "1443", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777737011", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_name, $22:s_company_id, $23:s_street_number, $24:s_street_name, $25:s_street_type, $26:s_suite_number, $27:s_city, $28:s_county, $29:s_state, $30:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.022253129346314324, "writeRatioMax": 0.022253129346314324 }, { "completedParallelInputs": "1", "computeMsAvg": "231", "computeMsMax": "231", "computeRatioAvg": 0.32127955493741306, "computeRatioMax": 0.32127955493741306, "endMs": "1665777737233", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.016689847009735744, "readRatioMax": 0.016689847009735744, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "9950080", "shuffleOutputBytesSpilled": "0", "slotMs": "237", "startMs": "1665777737027", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:sr_returned_date_sk, $51:sr_item_sk, $52:sr_customer_sk, $53:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.022253129346314324, "writeRatioMax": 0.022253129346314324 }, { "completedParallelInputs": "6", "computeMsAvg": "614", "computeMsMax": "719", "computeRatioAvg": 0.8539638386648123, "computeRatioMax": 1, "endMs": "1665777737761", "id": "5", "inputStages": [ "1", "0", "3", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "21", "readRatioAvg": 0.022253129346314324, "readRatioMax": 0.02920723226703755, "recordsRead": "4983944", "recordsWritten": "36", "shuffleOutputBytes": "5526", "shuffleOutputBytesSpilled": "0", "slotMs": "3229", "startMs": "1665777737283", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_customer_sk, $43:ss_store_sk, $44:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $147, $168 := $148, $169 := $149", "$70 := SUM($84)", "$71 := SUM($83)", "$72 := SUM($82)", "$73 := SUM($81)", "$74 := SUM($80)" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := case_no_value(greater(subtract($151, $150), 120), 1, 0)", "$81 := case_no_value(and(greater(subtract($151, $150), 90), less_or_equal(subtract($151, $150), 120)), 1, 0)", "$82 := case_no_value(and(greater(subtract($151, $150), 60), less_or_equal(subtract($151, $150), 90)), 1, 0)", "$83 := case_no_value(and(greater(subtract($151, $150), 30), less_or_equal(subtract($151, $150), 60)), 1, 0)", "$84 := case_no_value(less_or_equal(subtract($151, $150), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $120, $141 := $121, $142 := $122, $143 := $123, $144 := $124, $145 := $125, $146 := $126, $147 := $127, $148 := $128, $149 := $129, $150 := $130, $151 := $131", "INNER HASH JOIN EACH WITH ALL ON $131 = $10" ] }, { "kind": "JOIN", "substeps": [ "$120 := $102, $121 := $103, $122 := $104, $123 := $105, $124 := $106, $125 := $107, $126 := $108, $127 := $109, $128 := $110, $129 := $111, $130 := $100, $131 := $101", "INNER HASH JOIN EACH WITH ALL ON $100 = $1" ] }, { "kind": "JOIN", "substeps": [ "$100 := $90, $101 := $92, $102 := $21, $103 := $22, $104 := $23, $105 := $24, $106 := $25, $107 := $26, $108 := $27, $109 := $28, $110 := $29, $111 := $30", "INNER HASH JOIN EACH WITH ALL ON $91 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $40, $91 := $43, $92 := $50", "INNER HASH JOIN EACH WITH ALL ON $44 = $53, $41 = $51, $42 = $52" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "TO __stage05_output", "BY HASH($160, $161, $162, $163, $164, $165, $166, $167, $168, $169)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.006954102920723227, "writeRatioMax": 0.008344923504867872 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.006954102920723227, "computeRatioMax": 0.006954102920723227, "endMs": "1665777737782", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "36", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665777737774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$170 ASC, $171 ASC, $172 ASC, $173 ASC, $174 ASC, $175 ASC, $176 ASC, $177 ASC, $178 ASC, $179 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161, $172 := $162, $173 := $163, $174 := $164, $175 := $165, $176 := $166, $177 := $167, $178 := $168, $179 := $169", "$60 := SUM($70)", "$61 := SUM($71)", "$62 := SUM($72)", "$63 := SUM($73)", "$64 := SUM($74)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0013908205841446453, "writeRatioMax": 0.0013908205841446453 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009735744089012517, "computeRatioMax": 0.009735744089012517, "endMs": "1665777737825", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "921", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777737789", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$180 ASC, $181 ASC, $182 ASC, $183 ASC, $184 ASC, $185 ASC, $186 ASC, $187 ASC, $188 ASC, $189 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.037552155771905425, "writeRatioMax": 0.037552155771905425 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "4", "elapsedMs": "593", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "676" }, { "activeUnits": "6", "completedUnits": "12", "elapsedMs": "968", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3713" } ], "totalBytesBilled": "123731968", "totalBytesProcessed": "122891623", "totalPartitionsProcessed": "0", "totalSlotMs": "3713", "transferredBytes": "0" }, "startTime": "1665777736890", "totalBytesProcessed": "122891623", "totalSlotMs": "3713" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
