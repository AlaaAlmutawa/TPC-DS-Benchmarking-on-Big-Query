{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon949f5b0d_009f_4ae1_88b6_5c370ec2027e" }, "priority": "INTERACTIVE", "query": "-- start query 47 in stream 0 using template query47.tpl\n\n/*\nFind the item brands and categories for each store and company, \nthe monthly sales figures for a specified year, \nwhere the monthly sales figure deviated more than 10% of the average monthly sales for the year, \nsorted by deviation and store. \n\nReport deviation of sales from the previous and the following monthly sales.\n*/\n\nwith v1 as(\n select i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand,\n s_store_name, s_company_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n s_store_name, s_company_name\n order by d_year, d_moy) rn\n from item, store_sales, date_dim, store\n where ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name,v1.d_year, v1.d_moy\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1.s_store_name = v1_lag.s_store_name and\n v1.s_store_name = v1_lead.s_store_name and\n v1.s_company_name = v1_lag.s_company_name and\n v1.s_company_name = v1_lead.s_company_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and \n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n limit 100\n ;\n\n-- end query 47 in stream 0 using template query47.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "WFSb2qSC8OQvGF8ULJXC6Q==", "id": "test-project-364309:europe-west1.query47_1665768364", "jobReference": { "jobId": "query47_1665768364", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query47_1665768364?location=europe-west1", "statistics": { "creationTime": "1665768365085", "endTime": "1665768366894", "finalExecutionDurationMs": "1522", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113426519", "performanceInsights": { "avgPreviousExecutionMs": "1442" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.009708737864077669, "computeRatioMax": 0.009708737864077669, "endMs": "1665768365296", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008090614886731391, "readRatioMax": 0.008090614886731391, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768365268", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:s_store_sk, $81:s_store_name, $82:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.025889967637540454, "writeRatioMax": 0.025889967637540454 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.032362459546925564, "computeRatioMax": 0.032362459546925564, "endMs": "1665768365320", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.01779935275080906, "readRatioMax": 0.01779935275080906, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768365282", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.021035598705501618, "writeRatioMax": 0.021035598705501618 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.030744336569579287, "computeRatioMax": 0.030744336569579287, "endMs": "1665768365349", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011326860841423949, "readRatioMax": 0.011326860841423949, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768365307", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.03398058252427184, "writeRatioMax": 0.03398058252427184 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.019417475728155338, "computeRatioMax": 0.019417475728155338, "endMs": "1665768365352", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009708737864077669, "readRatioMax": 0.009708737864077669, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768365317", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name, $12:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.032362459546925564, "writeRatioMax": 0.032362459546925564 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.025889967637540454, "computeRatioMax": 0.025889967637540454, "endMs": "1665768365361", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.012944983818770227, "readRatioMax": 0.012944983818770227, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768365332", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.014563106796116505, "writeRatioMax": 0.014563106796116505 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.03398058252427184, "computeRatioMax": 0.03398058252427184, "endMs": "1665768365423", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.012944983818770227, "readRatioMax": 0.012944983818770227, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665768365357", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.04854368932038835, "writeRatioMax": 0.04854368932038835 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.012944983818770227, "computeRatioMax": 0.012944983818770227, "endMs": "1665768365410", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006472491909385114, "readRatioMax": 0.006472491909385114, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768365369", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.02750809061488673, "writeRatioMax": 0.02750809061488673 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.030744336569579287, "computeRatioMax": 0.030744336569579287, "endMs": "1665768365413", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011326860841423949, "readRatioMax": 0.011326860841423949, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768365384", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.012944983818770227, "writeRatioMax": 0.012944983818770227 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.030744336569579287, "computeRatioMax": 0.030744336569579287, "endMs": "1665768365451", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.012944983818770227, "readRatioMax": 0.012944983818770227, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768365410", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.032362459546925564, "writeRatioMax": 0.032362459546925564 }, { "completedParallelInputs": "6", "computeMsAvg": "529", "computeMsMax": "607", "computeRatioAvg": 0.8559870550161812, "computeRatioMax": 0.982200647249191, "endMs": "1665768365761", "id": "12", "inputStages": [ "1", "0", "3" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "15", "readRatioAvg": 0.016181229773462782, "readRatioMax": 0.024271844660194174, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2536", "startMs": "1665768365415", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $820 := $811, $821 := $810, $822 := $815, $823 := $816, $824 := $813, $825 := $814", "$690 := SUM($812)" ] }, { "kind": "JOIN", "substeps": [ "$810 := $800, $811 := $801, $812 := $803, $813 := $804, $814 := $805, $815 := $81, $816 := $82", "INNER HASH JOIN EACH WITH ALL ON $802 = $80" ] }, { "kind": "JOIN", "substeps": [ "$800 := $780, $801 := $781, $802 := $783, $803 := $784, $804 := $111, $805 := $112", "INNER HASH JOIN EACH WITH ALL ON $782 = $110" ] }, { "kind": "JOIN", "substeps": [ "$782 := $100, $783 := $102, $784 := $103, $780 := $91, $781 := $92", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "TO __stage0C_output", "BY HASH($820, $821, $822, $823, $824, $825)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.008090614886731391, "writeRatioMax": 0.009708737864077669 }, { "completedParallelInputs": "6", "computeMsAvg": "500", "computeMsMax": "618", "computeRatioAvg": 0.8090614886731392, "computeRatioMax": 1, "endMs": "1665768365845", "id": "13", "inputStages": [ "7", "5", "4" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "19", "readRatioAvg": 0.021035598705501618, "readRatioMax": 0.030744336569579287, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2925", "startMs": "1665768365446", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1031, $1041 := $1030, $1042 := $1035, $1043 := $1036, $1044 := $1033, $1045 := $1034", "$530 := SUM($1032)" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1020, $1031 := $1021, $1032 := $1023, $1033 := $1024, $1034 := $1025, $1035 := $11, $1036 := $12", "INNER HASH JOIN EACH WITH ALL ON $1022 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $1000, $1021 := $1001, $1022 := $1003, $1023 := $1004, $1024 := $71, $1025 := $72", "INNER HASH JOIN EACH WITH ALL ON $1002 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1002 := $60, $1003 := $62, $1004 := $63, $1000 := $51, $1001 := $52", "INNER HASH JOIN EACH WITH ALL ON $61 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "TO __stage0D_output", "BY HASH($1040, $1041, $1042, $1043, $1044, $1045)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "20", "writeMsMax": "23", "writeRatioAvg": 0.032362459546925564, "writeRatioMax": 0.0372168284789644 }, { "completedParallelInputs": "6", "computeMsAvg": "384", "computeMsMax": "454", "computeRatioAvg": 0.6213592233009708, "computeRatioMax": 0.7346278317152104, "endMs": "1665768365753", "id": "14", "inputStages": [ "11", "9", "8" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.016181229773462782, "readRatioMax": 0.021035598705501618, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "1925", "startMs": "1665768365466", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1191, $1201 := $1190, $1202 := $1195, $1203 := $1196, $1204 := $1193, $1205 := $1194", "$430 := SUM($1192)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1180, $1191 := $1181, $1192 := $1183, $1193 := $1184, $1194 := $1185, $1195 := $2, $1196 := $3", "INNER HASH JOIN EACH WITH ALL ON $1182 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1160, $1181 := $1161, $1182 := $1163, $1183 := $1164, $1184 := $41, $1185 := $42", "INNER HASH JOIN EACH WITH ALL ON $1162 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1162 := $30, $1163 := $32, $1164 := $33, $1160 := $21, $1161 := $22", "INNER HASH JOIN EACH WITH ALL ON $31 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "TO __stage0E_output", "BY HASH($1200, $1201, $1202, $1203, $1204, $1205)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "21", "writeMsMax": "24", "writeRatioAvg": 0.03398058252427184, "writeRatioMax": 0.038834951456310676 }, { "completedParallelInputs": "1", "computeMsAvg": "402", "computeMsMax": "402", "computeRatioAvg": 0.6504854368932039, "computeRatioMax": 0.6504854368932039, "endMs": "1665768366001", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "391", "startMs": "1665768365774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204, $1215 := $1205", "$240 := SUM($430)" ] }, { "kind": "WRITE", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003236245954692557, "waitRatioMax": 0.003236245954692557, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.0372168284789644, "writeRatioMax": 0.0372168284789644 }, { "completedParallelInputs": "1", "computeMsAvg": "495", "computeMsMax": "495", "computeRatioAvg": 0.8009708737864077, "computeRatioMax": 0.8009708737864077, "endMs": "1665768366049", "id": "16", "inputStages": [ "12" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "476", "startMs": "1665768365789", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $820, $831 := $821, $832 := $822, $833 := $823, $834 := $824, $835 := $825", "$580 := SUM($690)" ] }, { "kind": "WRITE", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.0372168284789644, "writeRatioMax": 0.0372168284789644 }, { "completedParallelInputs": "1", "computeMsAvg": "454", "computeMsMax": "454", "computeRatioAvg": 0.7346278317152104, "computeRatioMax": 0.7346278317152104, "endMs": "1665768366102", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "401", "startMs": "1665768365861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044, $1055 := $1045", "$270 := SUM($530)" ] }, { "kind": "WRITE", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.03559870550161812, "writeRatioMax": 0.03559870550161812 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.009708737864077669, "computeRatioMax": 0.009708737864077669, "endMs": "1665768366117", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768366080", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$760, $870, $871, $872, $873, $874", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := coalesce($880, '')", "$631 := coalesce($880, '0')", "$632 := coalesce($881, '')", "$633 := coalesce($881, '0')", "$634 := coalesce($882, 0)", "$635 := coalesce($882, 1)", "$636 := coalesce($883, '')", "$637 := coalesce($883, '0')", "$638 := coalesce($884, '')", "$639 := coalesce($884, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $880 := $870, $881 := $871, $882 := $872, $883 := $873, $884 := $874", "$730 := ROOT_AVG($760)" ] }, { "kind": "WRITE", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02912621359223301, "writeRatioMax": 0.02912621359223301 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "22", "computeRatioAvg": 0.012944983818770227, "computeRatioMax": 0.03559870550161812, "endMs": "1665768366180", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3423", "startMs": "1665768366124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003236245954692557, "waitRatioMax": 0.0048543689320388345, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.021035598705501618, "writeRatioMax": 0.032362459546925564 }, { "completedParallelInputs": "101", "computeMsAvg": "14", "computeMsMax": "28", "computeRatioAvg": 0.022653721682847898, "computeRatioMax": 0.045307443365695796, "endMs": "1665768366191", "id": "21", "inputStages": [ "20", "16" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "65298", "shuffleOutputBytes": "6918247", "shuffleOutputBytesSpilled": "0", "slotMs": "4081", "startMs": "1665768366137", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$710, $711, $712, $713, $714, $715, $716", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := AVG($846) OVER (PARTITION BY $845, $844, $840, $841, $842 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$705 ASC, $704 ASC, $700 ASC, $701 ASC, $702 ASC" ] }, { "kind": "JOIN", "substeps": [ "$890 := $720, $891 := $721, $892 := $722, $893 := $723, $894 := $724, $895 := $725, $896 := $726, $897 := $730", "INNER HASH JOIN EACH WITH ALL ON $620 = $630, $621 = $631, $622 = $632, $623 = $633, $624 = $634, $625 = $635, $626 = $636, $627 = $637, $628 = $638, $629 = $639" ] }, { "kind": "COMPUTE", "substeps": [ "$620 := coalesce($720, '')", "$621 := coalesce($720, '0')", "$622 := coalesce($721, '')", "$623 := coalesce($721, '0')", "$624 := coalesce($722, 0)", "$625 := coalesce($722, 1)", "$626 := coalesce($724, '')", "$627 := coalesce($724, '0')", "$628 := coalesce($725, '')", "$629 := coalesce($725, '0')" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0048543689320388345, "writeMsAvg": "13", "writeMsMax": "28", "writeRatioAvg": 0.021035598705501618, "writeRatioMax": 0.045307443365695796 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.014563106796116505, "computeRatioMax": 0.014563106796116505, "endMs": "1665768366326", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768366289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$610, $1282, $1283, $1284, $1285, $1281, $1280", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := coalesce($1290, '')", "$311 := coalesce($1290, '0')", "$312 := coalesce($1291, '')", "$313 := coalesce($1291, '0')", "$314 := coalesce($1292, '')", "$315 := coalesce($1292, '0')", "$316 := coalesce($1293, '')", "$317 := coalesce($1293, '0')", "$318 := coalesce($1294, 0)", "$319 := coalesce($1294, 1)", "$320 := coalesce($1295, 0)", "$321 := coalesce($1295, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1290 := $1280, $1291 := $1281, $1292 := $1282, $1293 := $1283, $1294 := $1284, $1295 := $1285", "$470 := MIN($610)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.02750809061488673, "writeRatioMax": 0.02750809061488673 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.011326860841423949, "computeRatioMax": 0.011326860841423949, "endMs": "1665768366355", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768366318", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $1122, $1123, $1124, $1125, $1121, $1120", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($1130, '')", "$411 := coalesce($1130, '0')", "$412 := coalesce($1131, '')", "$413 := coalesce($1131, '0')", "$414 := coalesce($1132, '')", "$415 := coalesce($1132, '0')", "$416 := coalesce($1133, '')", "$417 := coalesce($1133, '0')", "$418 := coalesce($1134, 0)", "$419 := coalesce($1134, 1)", "$420 := coalesce($1135, 0)", "$421 := coalesce($1135, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124, $1135 := $1125", "$570 := MIN($670)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02912621359223301, "writeRatioMax": 0.02912621359223301 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.025889967637540454, "computeRatioMax": 0.025889967637540454, "endMs": "1665768366391", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768366348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $972, $973, $974, $975, $971, $970", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$370 := coalesce($980, '')", "$371 := coalesce($980, '0')", "$372 := coalesce($981, '')", "$373 := coalesce($981, '0')", "$374 := coalesce($982, '')", "$375 := coalesce($982, '0')", "$376 := coalesce($983, '')", "$377 := coalesce($983, '0')", "$378 := coalesce($984, 0)", "$379 := coalesce($984, 1)", "$380 := coalesce($985, 0)", "$381 := coalesce($985, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970, $981 := $971, $982 := $972, $983 := $973, $984 := $974, $985 := $975", "$520 := MIN($650)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.032362459546925564, "writeRatioMax": 0.032362459546925564 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.014563106796116505, "computeRatioMax": 0.025889967637540454, "endMs": "1665768366425", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3946", "startMs": "1665768366365", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "4", "waitMsMax": "8", "waitRatioAvg": 0.006472491909385114, "waitRatioMax": 0.012944983818770227, "writeMsAvg": "15", "writeMsMax": "35", "writeRatioAvg": 0.024271844660194174, "writeRatioMax": 0.05663430420711974 }, { "completedParallelInputs": "101", "computeMsAvg": "15", "computeMsMax": "24", "computeRatioAvg": 0.024271844660194174, "computeRatioMax": 0.038834951456310676, "endMs": "1665768366476", "id": "29", "inputStages": [ "28", "15" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "7889", "startMs": "1665768366380", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$450, $1250, $1251, $1252, $1253, $1254, $1255, $1256", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := subtract($164, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1225, $1224, $1220, $1221 ORDER BY $1222 ASC, $1223 ASC)" ] }, { "kind": "SORT", "substeps": [ "$445 ASC, $444 ASC, $440 ASC, $441 ASC, $442 ASC, $443 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1300 := $460, $1301 := $461, $1302 := $464, $1303 := $465, $1304 := $466, $1305 := $470", "INNER HASH JOIN EACH WITH ALL ON $290 = $310, $291 = $311, $292 = $312, $293 = $313, $294 = $314, $295 = $315, $296 = $316, $297 = $317, $298 = $318, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($465, '')", "$291 := coalesce($465, '0')", "$292 := coalesce($464, '')", "$293 := coalesce($464, '0')", "$294 := coalesce($460, '')", "$295 := coalesce($460, '0')", "$296 := coalesce($461, '')", "$297 := coalesce($461, '0')", "$298 := coalesce($462, 0)", "$299 := coalesce($462, 1)", "$300 := coalesce($463, 0)", "$301 := coalesce($463, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $160, $161, $162, $163, $165", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.003236245954692557, "waitRatioMax": 0.006472491909385114, "writeMsAvg": "60", "writeMsMax": "68", "writeRatioAvg": 0.0970873786407767, "writeRatioMax": 0.11003236245954692 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.012944983818770227, "computeRatioMax": 0.030744336569579287, "endMs": "1665768366438", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3545", "startMs": "1665768366381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0048543689320388345, "waitRatioMax": 0.006472491909385114, "writeMsAvg": "13", "writeMsMax": "21", "writeRatioAvg": 0.021035598705501618, "writeRatioMax": 0.03398058252427184 }, { "completedParallelInputs": "101", "computeMsAvg": "14", "computeMsMax": "27", "computeRatioAvg": 0.022653721682847898, "computeRatioMax": 0.043689320388349516, "endMs": "1665768366444", "id": "31", "inputStages": [ "17", "30" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3717", "startMs": "1665768366395", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$550, $1090, $1091, $1092, $1093, $1094, $1095, $1096", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := add($204, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$230 := RANK() OVER (PARTITION BY $1065, $1064, $1060, $1061 ORDER BY $1062 ASC, $1063 ASC)" ] }, { "kind": "SORT", "substeps": [ "$545 ASC, $544 ASC, $540 ASC, $541 ASC, $542 ASC, $543 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $560, $1141 := $561, $1142 := $564, $1143 := $565, $1144 := $566, $1145 := $570", "INNER HASH JOIN EACH WITH ALL ON $390 = $410, $391 = $411, $392 = $412, $393 = $413, $394 = $414, $395 = $415, $396 = $416, $397 = $417, $398 = $418, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$390 := coalesce($565, '')", "$391 := coalesce($565, '0')", "$392 := coalesce($564, '')", "$393 := coalesce($564, '0')", "$394 := coalesce($560, '')", "$395 := coalesce($560, '0')", "$396 := coalesce($561, '')", "$397 := coalesce($561, '0')", "$398 := coalesce($562, 0)", "$399 := coalesce($562, 1)", "$400 := coalesce($563, 0)", "$401 := coalesce($563, 1)" ] }, { "kind": "WRITE", "substeps": [ "$140, $200, $201, $202, $203, $205", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003236245954692557, "waitRatioMax": 0.0048543689320388345, "writeMsAvg": "12", "writeMsMax": "18", "writeRatioAvg": 0.019417475728155338, "writeRatioMax": 0.02912621359223301 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.012944983818770227, "computeRatioMax": 0.02912621359223301, "endMs": "1665768366469", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3330", "startMs": "1665768366403", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003236245954692557, "waitRatioMax": 0.0048543689320388345, "writeMsAvg": "13", "writeMsMax": "22", "writeRatioAvg": 0.021035598705501618, "writeRatioMax": 0.03559870550161812 }, { "completedParallelInputs": "100", "computeMsAvg": "11", "computeMsMax": "18", "computeRatioAvg": 0.01779935275080906, "computeRatioMax": 0.02912621359223301, "endMs": "1665768366515", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "4405", "startMs": "1665768366455", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.003236245954692557, "waitRatioMax": 0.006472491909385114, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.024271844660194174, "writeRatioMax": 0.04854368932038835 }, { "completedParallelInputs": "100", "computeMsAvg": "12", "computeMsMax": "20", "computeRatioAvg": 0.019417475728155338, "computeRatioMax": 0.032362459546925564, "endMs": "1665768366536", "id": "36", "inputStages": [ "29" ], "name": "S24: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "4010", "startMs": "1665768366483", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "8", "waitRatioAvg": 0.003236245954692557, "waitRatioMax": 0.012944983818770227, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.024271844660194174, "writeRatioMax": 0.045307443365695796 }, { "completedParallelInputs": "101", "computeMsAvg": "154", "computeMsMax": "254", "computeRatioAvg": 0.24919093851132687, "computeRatioMax": 0.4110032362459547, "endMs": "1665768366715", "id": "37", "inputStages": [ "21", "32", "34", "36" ], "name": "S25: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12896898", "recordsWritten": "10000", "shuffleOutputBytes": "1556877", "shuffleOutputBytesSpilled": "0", "slotMs": "16241", "startMs": "1665768366491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$500, $940, $941, $942, $943, $944, $945, $946, $947", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$140, $200, $201, $202, $203, $205", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$130, $160, $161, $162, $163, $165", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1319 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($1317, $1316)" ] }, { "kind": "JOIN", "substeps": [ "$1310 := $1150, $1311 := $1151, $1312 := $1152, $1313 := $1153, $1314 := $1154, $1315 := $1155, $1316 := $1157, $1317 := $1158, $1318 := $1159, $1319 := $165", "INNER HASH JOIN EACH WITH ALL ON $1155 = $163, $1154 = $162, $1150 = $160, $1151 = $161, $1156 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1150 := $180, $1151 := $181, $1152 := $182, $1153 := $183, $1154 := $184, $1155 := $185, $1156 := $186, $1157 := $187, $1158 := $188, $1159 := $205", "INNER HASH JOIN EACH WITH ALL ON $185 = $203, $184 = $202, $180 = $200, $181 = $201, $186 = $140" ] }, { "kind": "FILTER", "substeps": [ "and(equal($182, 1999), greater($187, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $905, $904, $900, $901 ORDER BY $902 ASC, $903 ASC)" ] }, { "kind": "SORT", "substeps": [ "$495 ASC, $494 ASC, $490 ASC, $491 ASC, $492 ASC, $493 ASC" ] }, { "kind": "JOIN", "substeps": [ "$990 := $510, $991 := $511, $992 := $512, $993 := $513, $994 := $514, $995 := $515, $996 := $516, $997 := $517, $998 := $520", "INNER HASH JOIN EACH WITH ALL ON $350 = $370, $351 = $371, $352 = $372, $353 = $373, $354 = $374, $355 = $375, $356 = $376, $357 = $377, $358 = $378, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($515, '')", "$351 := coalesce($515, '0')", "$352 := coalesce($514, '')", "$353 := coalesce($514, '0')", "$354 := coalesce($510, '')", "$355 := coalesce($510, '0')", "$356 := coalesce($511, '')", "$357 := coalesce($511, '0')", "$358 := coalesce($512, 0)", "$359 := coalesce($512, 1)", "$360 := coalesce($513, 0)", "$361 := coalesce($513, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "TO __stage25_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.014563106796116505, "waitRatioMax": 0.01779935275080906, "writeMsAvg": "4", "writeMsMax": "53", "writeRatioAvg": 0.006472491909385114, "writeRatioMax": 0.08576051779935275 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.025889967637540454, "computeRatioMax": 0.025889967637540454, "endMs": "1665768366727", "id": "38", "inputStages": [ "37" ], "name": "S26: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "13917", "shuffleOutputBytesSpilled": "0", "slotMs": "138", "startMs": "1665768366505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "FROM __stage25_output" ] }, { "kind": "SORT", "substeps": [ "$1320 ASC, $1321 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1340, $1341, $1342, $1343, $1344, $1345, $1346, $1347, $1348, $1349", "TO __stage26_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.011326860841423949, "waitRatioMax": 0.011326860841423949, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.006472491909385114, "writeRatioMax": 0.006472491909385114 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "24", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "6830" }, { "activeUnits": "0", "completedUnits": "1039", "elapsedMs": "1684", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "65638" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113426519", "totalPartitionsProcessed": "0", "totalSlotMs": "65638", "transferredBytes": "0" }, "startTime": "1665768365144", "totalBytesProcessed": "113426519", "totalSlotMs": "65638" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon01087c0d_7970_49dc_b168_32d8d440bb54" }, "priority": "INTERACTIVE", "query": "-- start query 47 in stream 0 using template query47.tpl\n\n/*\nFind the item brands and categories for each store and company, \nthe monthly sales figures for a specified year, \nwhere the monthly sales figure deviated more than 10% of the average monthly sales for the year, \nsorted by deviation and store. \n\nReport deviation of sales from the previous and the following monthly sales.\n*/\n\nwith v1 as(\n select i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand,\n s_store_name, s_company_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n s_store_name, s_company_name\n order by d_year, d_moy) rn\n from item, store_sales, date_dim, store\n where ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name,v1.d_year, v1.d_moy\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1.s_store_name = v1_lag.s_store_name and\n v1.s_store_name = v1_lead.s_store_name and\n v1.s_company_name = v1_lag.s_company_name and\n v1.s_company_name = v1_lead.s_company_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and \n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n limit 100\n ;\n\n-- end query 47 in stream 0 using template query47.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "e1Vtco57GeHlRCGOiUhDPQ==", "id": "test-project-364309:europe-west1.query47_1665777670", "jobReference": { "jobId": "query47_1665777670", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query47_1665777670?location=europe-west1", "statistics": { "creationTime": "1665777670733", "endTime": "1665777672965", "finalExecutionDurationMs": "1962", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113426519", "performanceInsights": { "avgPreviousExecutionMs": "1469" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009512485136741973, "computeRatioMax": 0.009512485136741973, "endMs": "1665777670943", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008323424494649227, "readRatioMax": 0.008323424494649227, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777670904", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:s_store_sk, $81:s_store_name, $82:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.013079667063020214, "writeRatioMax": 0.013079667063020214 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.020214030915576695, "computeRatioMax": 0.020214030915576695, "endMs": "1665777670963", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008323424494649227, "readRatioMax": 0.008323424494649227, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777670922", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.013079667063020214, "writeRatioMax": 0.013079667063020214 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.028537455410225922, "computeRatioMax": 0.028537455410225922, "endMs": "1665777671013", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.01070154577883472, "readRatioMax": 0.01070154577883472, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777670955", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.026159334126040427, "writeRatioMax": 0.026159334126040427 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009512485136741973, "computeRatioMax": 0.009512485136741973, "endMs": "1665777671015", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005945303210463734, "readRatioMax": 0.005945303210463734, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777670973", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name, $12:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011890606420927466, "waitRatioMax": 0.0011890606420927466, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02140309155766944, "writeRatioMax": 0.02140309155766944 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.02497027348394768, "computeRatioMax": 0.02497027348394768, "endMs": "1665777671029", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008323424494649227, "readRatioMax": 0.008323424494649227, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777670989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011890606420927466, "waitRatioMax": 0.0011890606420927466, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01070154577883472, "writeRatioMax": 0.01070154577883472 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.028537455410225922, "computeRatioMax": 0.028537455410225922, "endMs": "1665777671077", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009512485136741973, "readRatioMax": 0.009512485136741973, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777671022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.03804994054696789, "writeRatioMax": 0.03804994054696789 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.02140309155766944, "computeRatioMax": 0.02140309155766944, "endMs": "1665777671091", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.011890606420927468, "readRatioMax": 0.011890606420927468, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777671037", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.019024970273483946, "writeRatioMax": 0.019024970273483946 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.022592152199762187, "computeRatioMax": 0.022592152199762187, "endMs": "1665777671091", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008323424494649227, "readRatioMax": 0.008323424494649227, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777671053", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011890606420927466, "waitRatioMax": 0.0011890606420927466, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.009512485136741973, "writeRatioMax": 0.009512485136741973 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.026159334126040427, "computeRatioMax": 0.026159334126040427, "endMs": "1665777671144", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007134363852556481, "readRatioMax": 0.007134363852556481, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777671084", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.03329369797859691, "writeRatioMax": 0.03329369797859691 }, { "completedParallelInputs": "6", "computeMsAvg": "489", "computeMsMax": "841", "computeRatioAvg": 0.5814506539833532, "computeRatioMax": 1, "endMs": "1665777671647", "id": "12", "inputStages": [ "3", "1", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "21", "readRatioAvg": 0.016646848989298454, "readRatioMax": 0.02497027348394768, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2989", "startMs": "1665777671097", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $820 := $811, $821 := $810, $822 := $815, $823 := $816, $824 := $813, $825 := $814", "$690 := SUM($812)" ] }, { "kind": "JOIN", "substeps": [ "$810 := $800, $811 := $801, $812 := $803, $813 := $804, $814 := $805, $815 := $81, $816 := $82", "INNER HASH JOIN EACH WITH ALL ON $802 = $80" ] }, { "kind": "JOIN", "substeps": [ "$800 := $780, $801 := $781, $802 := $783, $803 := $784, $804 := $111, $805 := $112", "INNER HASH JOIN EACH WITH ALL ON $782 = $110" ] }, { "kind": "JOIN", "substeps": [ "$782 := $100, $783 := $102, $784 := $103, $780 := $91, $781 := $92", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "TO __stage0C_output", "BY HASH($820, $821, $822, $823, $824, $825)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0035671819262782403, "writeMsAvg": "9", "writeMsMax": "14", "writeRatioAvg": 0.01070154577883472, "writeRatioMax": 0.016646848989298454 }, { "completedParallelInputs": "6", "computeMsAvg": "452", "computeMsMax": "826", "computeRatioAvg": 0.5374554102259215, "computeRatioMax": 0.9821640903686087, "endMs": "1665777671609", "id": "13", "inputStages": [ "4", "7", "5" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "18", "readRatioAvg": 0.013079667063020214, "readRatioMax": 0.02140309155766944, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2483", "startMs": "1665777671123", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1031, $1041 := $1030, $1042 := $1035, $1043 := $1036, $1044 := $1033, $1045 := $1034", "$530 := SUM($1032)" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1020, $1031 := $1021, $1032 := $1023, $1033 := $1024, $1034 := $1025, $1035 := $11, $1036 := $12", "INNER HASH JOIN EACH WITH ALL ON $1022 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $1000, $1021 := $1001, $1022 := $1003, $1023 := $1004, $1024 := $71, $1025 := $72", "INNER HASH JOIN EACH WITH ALL ON $1002 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1002 := $60, $1003 := $62, $1004 := $63, $1000 := $51, $1001 := $52", "INNER HASH JOIN EACH WITH ALL ON $61 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "TO __stage0D_output", "BY HASH($1040, $1041, $1042, $1043, $1044, $1045)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0035671819262782403, "writeMsAvg": "21", "writeMsMax": "23", "writeRatioAvg": 0.02497027348394768, "writeRatioMax": 0.027348394768133173 }, { "completedParallelInputs": "6", "computeMsAvg": "440", "computeMsMax": "747", "computeRatioAvg": 0.5231866825208086, "computeRatioMax": 0.8882282996432818, "endMs": "1665777671577", "id": "14", "inputStages": [ "8", "9", "11" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.013079667063020214, "readRatioMax": 0.016646848989298454, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2318", "startMs": "1665777671178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1191, $1201 := $1190, $1202 := $1195, $1203 := $1196, $1204 := $1193, $1205 := $1194", "$430 := SUM($1192)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1180, $1191 := $1181, $1192 := $1183, $1193 := $1184, $1194 := $1185, $1195 := $2, $1196 := $3", "INNER HASH JOIN EACH WITH ALL ON $1182 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1160, $1181 := $1161, $1182 := $1163, $1183 := $1164, $1184 := $41, $1185 := $42", "INNER HASH JOIN EACH WITH ALL ON $1162 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1162 := $30, $1163 := $32, $1164 := $33, $1160 := $21, $1161 := $22", "INNER HASH JOIN EACH WITH ALL ON $31 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "TO __stage0E_output", "BY HASH($1200, $1201, $1202, $1203, $1204, $1205)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "22", "writeMsMax": "23", "writeRatioAvg": 0.026159334126040427, "writeRatioMax": 0.027348394768133173 }, { "completedParallelInputs": "1", "computeMsAvg": "402", "computeMsMax": "402", "computeRatioAvg": 0.4780023781212842, "computeRatioMax": 0.4780023781212842, "endMs": "1665777671935", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "353", "startMs": "1665777671666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204, $1215 := $1205", "$240 := SUM($430)" ] }, { "kind": "WRITE", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "47", "writeMsMax": "47", "writeRatioAvg": 0.0558858501783591, "writeRatioMax": 0.0558858501783591 }, { "completedParallelInputs": "1", "computeMsAvg": "495", "computeMsMax": "495", "computeRatioAvg": 0.5885850178359097, "computeRatioMax": 0.5885850178359097, "endMs": "1665777671963", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "408", "startMs": "1665777671686", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044, $1055 := $1045", "$270 := SUM($530)" ] }, { "kind": "WRITE", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011890606420927466, "waitRatioMax": 0.0011890606420927466, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.026159334126040427, "writeRatioMax": 0.026159334126040427 }, { "completedParallelInputs": "1", "computeMsAvg": "354", "computeMsMax": "354", "computeRatioAvg": 0.42092746730083236, "computeRatioMax": 0.42092746730083236, "endMs": "1665777671951", "id": "17", "inputStages": [ "12" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "327", "startMs": "1665777671705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $820, $831 := $821, $832 := $822, $833 := $823, $834 := $824, $835 := $825", "$580 := SUM($690)" ] }, { "kind": "WRITE", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011890606420927466, "waitRatioMax": 0.0011890606420927466, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.029726516052318668, "writeRatioMax": 0.029726516052318668 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011890606420927468, "computeRatioMax": 0.011890606420927468, "endMs": "1665777672028", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777671987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$760, $870, $871, $872, $873, $874", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := coalesce($880, '')", "$631 := coalesce($880, '0')", "$632 := coalesce($881, '')", "$633 := coalesce($881, '0')", "$634 := coalesce($882, 0)", "$635 := coalesce($882, 1)", "$636 := coalesce($883, '')", "$637 := coalesce($883, '0')", "$638 := coalesce($884, '')", "$639 := coalesce($884, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $880 := $870, $881 := $871, $882 := $872, $883 := $873, $884 := $874", "$730 := ROOT_AVG($760)" ] }, { "kind": "WRITE", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011890606420927466, "waitRatioMax": 0.0011890606420927466, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02140309155766944, "writeRatioMax": 0.02140309155766944 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.01070154577883472, "computeRatioMax": 0.019024970273483946, "endMs": "1665777672097", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3909", "startMs": "1665777672039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0035671819262782403, "waitRatioMax": 0.0047562425683709865, "writeMsAvg": "20", "writeMsMax": "36", "writeRatioAvg": 0.023781212841854936, "writeRatioMax": 0.04280618311533888 }, { "completedParallelInputs": "101", "computeMsAvg": "14", "computeMsMax": "28", "computeRatioAvg": 0.016646848989298454, "computeRatioMax": 0.03329369797859691, "endMs": "1665777672117", "id": "21", "inputStages": [ "20", "17" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "65298", "shuffleOutputBytes": "6918247", "shuffleOutputBytesSpilled": "0", "slotMs": "3683", "startMs": "1665777672057", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$710, $711, $712, $713, $714, $715, $716", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := AVG($846) OVER (PARTITION BY $845, $844, $840, $841, $842 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$705 ASC, $704 ASC, $700 ASC, $701 ASC, $702 ASC" ] }, { "kind": "JOIN", "substeps": [ "$890 := $720, $891 := $721, $892 := $722, $893 := $723, $894 := $724, $895 := $725, $896 := $726, $897 := $730", "INNER HASH JOIN EACH WITH ALL ON $620 = $630, $621 = $631, $622 = $632, $623 = $633, $624 = $634, $625 = $635, $626 = $636, $627 = $637, $628 = $638, $629 = $639" ] }, { "kind": "COMPUTE", "substeps": [ "$620 := coalesce($720, '')", "$621 := coalesce($720, '0')", "$622 := coalesce($721, '')", "$623 := coalesce($721, '0')", "$624 := coalesce($722, 0)", "$625 := coalesce($722, 1)", "$626 := coalesce($724, '')", "$627 := coalesce($724, '0')", "$628 := coalesce($725, '')", "$629 := coalesce($725, '0')" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.005945303210463734, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.016646848989298454, "writeRatioMax": 0.03329369797859691 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011890606420927468, "computeRatioMax": 0.011890606420927468, "endMs": "1665777672305", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777672241", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$610, $1282, $1283, $1284, $1285, $1281, $1280", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := coalesce($1290, '')", "$311 := coalesce($1290, '0')", "$312 := coalesce($1291, '')", "$313 := coalesce($1291, '0')", "$314 := coalesce($1292, '')", "$315 := coalesce($1292, '0')", "$316 := coalesce($1293, '')", "$317 := coalesce($1293, '0')", "$318 := coalesce($1294, 0)", "$319 := coalesce($1294, 1)", "$320 := coalesce($1295, 0)", "$321 := coalesce($1295, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1290 := $1280, $1291 := $1281, $1292 := $1282, $1293 := $1283, $1294 := $1284, $1295 := $1285", "$470 := MIN($610)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "57", "writeMsMax": "57", "writeRatioAvg": 0.06777645659928656, "writeRatioMax": 0.06777645659928656 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009512485136741973, "computeRatioMax": 0.009512485136741973, "endMs": "1665777672415", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777672357", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $1122, $1123, $1124, $1125, $1121, $1120", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($1130, '')", "$411 := coalesce($1130, '0')", "$412 := coalesce($1131, '')", "$413 := coalesce($1131, '0')", "$414 := coalesce($1132, '')", "$415 := coalesce($1132, '0')", "$416 := coalesce($1133, '')", "$417 := coalesce($1133, '0')", "$418 := coalesce($1134, 0)", "$419 := coalesce($1134, 1)", "$420 := coalesce($1135, 0)", "$421 := coalesce($1135, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124, $1135 := $1125", "$570 := MIN($670)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.0023781212841854932, "writeMsAvg": "47", "writeMsMax": "47", "writeRatioAvg": 0.0558858501783591, "writeRatioMax": 0.0558858501783591 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011890606420927468, "computeRatioMax": 0.011890606420927468, "endMs": "1665777672438", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777672391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $972, $973, $974, $975, $971, $970", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$370 := coalesce($980, '')", "$371 := coalesce($980, '0')", "$372 := coalesce($981, '')", "$373 := coalesce($981, '0')", "$374 := coalesce($982, '')", "$375 := coalesce($982, '0')", "$376 := coalesce($983, '')", "$377 := coalesce($983, '0')", "$378 := coalesce($984, 0)", "$379 := coalesce($984, 1)", "$380 := coalesce($985, 0)", "$381 := coalesce($985, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970, $981 := $971, $982 := $972, $983 := $973, $984 := $974, $985 := $975", "$520 := MIN($650)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011890606420927466, "waitRatioMax": 0.0011890606420927466, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.03329369797859691, "writeRatioMax": 0.03329369797859691 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.009512485136741973, "computeRatioMax": 0.016646848989298454, "endMs": "1665777672503", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3309", "startMs": "1665777672408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "4", "waitMsMax": "7", "waitRatioAvg": 0.0047562425683709865, "waitRatioMax": 0.008323424494649227, "writeMsAvg": "24", "writeMsMax": "42", "writeRatioAvg": 0.028537455410225922, "writeRatioMax": 0.04994054696789536 }, { "completedParallelInputs": "101", "computeMsAvg": "14", "computeMsMax": "24", "computeRatioAvg": 0.016646848989298454, "computeRatioMax": 0.028537455410225922, "endMs": "1665777672506", "id": "29", "inputStages": [ "28", "15" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3707", "startMs": "1665777672425", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$450, $1250, $1251, $1252, $1253, $1254, $1255, $1256", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := subtract($164, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1225, $1224, $1220, $1221 ORDER BY $1222 ASC, $1223 ASC)" ] }, { "kind": "SORT", "substeps": [ "$445 ASC, $444 ASC, $440 ASC, $441 ASC, $442 ASC, $443 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1300 := $460, $1301 := $461, $1302 := $464, $1303 := $465, $1304 := $466, $1305 := $470", "INNER HASH JOIN EACH WITH ALL ON $290 = $310, $291 = $311, $292 = $312, $293 = $313, $294 = $314, $295 = $315, $296 = $316, $297 = $317, $298 = $318, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($465, '')", "$291 := coalesce($465, '0')", "$292 := coalesce($464, '')", "$293 := coalesce($464, '0')", "$294 := coalesce($460, '')", "$295 := coalesce($460, '0')", "$296 := coalesce($461, '')", "$297 := coalesce($461, '0')", "$298 := coalesce($462, 0)", "$299 := coalesce($462, 1)", "$300 := coalesce($463, 0)", "$301 := coalesce($463, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $160, $161, $162, $163, $165", "TO __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.0047562425683709865, "waitRatioMax": 0.007134363852556481, "writeMsAvg": "14", "writeMsMax": "30", "writeRatioAvg": 0.016646848989298454, "writeRatioMax": 0.0356718192627824 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.008323424494649227, "computeRatioMax": 0.0178359096313912, "endMs": "1665777672533", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3202", "startMs": "1665777672426", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.005945303210463734, "waitRatioMax": 0.008323424494649227, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.0178359096313912, "writeRatioMax": 0.03210463733650416 }, { "completedParallelInputs": "101", "computeMsAvg": "14", "computeMsMax": "24", "computeRatioAvg": 0.016646848989298454, "computeRatioMax": 0.028537455410225922, "endMs": "1665777672525", "id": "31", "inputStages": [ "30", "16" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3830", "startMs": "1665777672441", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$550, $1090, $1091, $1092, $1093, $1094, $1095, $1096", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := add($204, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$230 := RANK() OVER (PARTITION BY $1065, $1064, $1060, $1061 ORDER BY $1062 ASC, $1063 ASC)" ] }, { "kind": "SORT", "substeps": [ "$545 ASC, $544 ASC, $540 ASC, $541 ASC, $542 ASC, $543 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $560, $1141 := $561, $1142 := $564, $1143 := $565, $1144 := $566, $1145 := $570", "INNER HASH JOIN EACH WITH ALL ON $390 = $410, $391 = $411, $392 = $412, $393 = $413, $394 = $414, $395 = $415, $396 = $416, $397 = $417, $398 = $418, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$390 := coalesce($565, '')", "$391 := coalesce($565, '0')", "$392 := coalesce($564, '')", "$393 := coalesce($564, '0')", "$394 := coalesce($560, '')", "$395 := coalesce($560, '0')", "$396 := coalesce($561, '')", "$397 := coalesce($561, '0')", "$398 := coalesce($562, 0)", "$399 := coalesce($562, 1)", "$400 := coalesce($563, 0)", "$401 := coalesce($563, 1)" ] }, { "kind": "WRITE", "substeps": [ "$140, $200, $201, $202, $203, $205", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0023781212841854932, "waitRatioMax": 0.007134363852556481, "writeMsAvg": "20", "writeMsMax": "33", "writeRatioAvg": 0.023781212841854936, "writeRatioMax": 0.039239001189060645 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.008323424494649227, "computeRatioMax": 0.015457788347205707, "endMs": "1665777672532", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3594", "startMs": "1665777672455", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0011890606420927466, "waitRatioMax": 0.0035671819262782403, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.019024970273483946, "writeRatioMax": 0.0356718192627824 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.011890606420927468, "computeRatioMax": 0.02140309155766944, "endMs": "1665777672611", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "4370", "startMs": "1665777672537", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.0035671819262782403, "waitRatioMax": 0.01070154577883472, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.020214030915576695, "writeRatioMax": 0.0356718192627824 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.01070154577883472, "computeRatioMax": 0.020214030915576695, "endMs": "1665777672616", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "4385", "startMs": "1665777672539", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.009512485136741973, "waitRatioMax": 0.011890606420927468, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.019024970273483946, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "101", "computeMsAvg": "158", "computeMsMax": "310", "computeRatioAvg": 0.187871581450654, "computeRatioMax": 0.3686087990487515, "endMs": "1665777672775", "id": "36", "inputStages": [ "32", "35", "34", "21" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12896898", "recordsWritten": "10000", "shuffleOutputBytes": "1556877", "shuffleOutputBytesSpilled": "0", "slotMs": "17387", "startMs": "1665777672554", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$500, $940, $941, $942, $943, $944, $945, $946, $947", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$140, $200, $201, $202, $203, $205", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$130, $160, $161, $162, $163, $165", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1319 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($1317, $1316)" ] }, { "kind": "JOIN", "substeps": [ "$1310 := $1150, $1311 := $1151, $1312 := $1152, $1313 := $1153, $1314 := $1154, $1315 := $1155, $1316 := $1157, $1317 := $1158, $1318 := $1159, $1319 := $165", "INNER HASH JOIN EACH WITH ALL ON $1155 = $163, $1154 = $162, $1150 = $160, $1151 = $161, $1156 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1150 := $180, $1151 := $181, $1152 := $182, $1153 := $183, $1154 := $184, $1155 := $185, $1156 := $186, $1157 := $187, $1158 := $188, $1159 := $205", "INNER HASH JOIN EACH WITH ALL ON $185 = $203, $184 = $202, $180 = $200, $181 = $201, $186 = $140" ] }, { "kind": "FILTER", "substeps": [ "and(equal($182, 1999), greater($187, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $905, $904, $900, $901 ORDER BY $902 ASC, $903 ASC)" ] }, { "kind": "SORT", "substeps": [ "$495 ASC, $494 ASC, $490 ASC, $491 ASC, $492 ASC, $493 ASC" ] }, { "kind": "JOIN", "substeps": [ "$990 := $510, $991 := $511, $992 := $512, $993 := $513, $994 := $514, $995 := $515, $996 := $516, $997 := $517, $998 := $520", "INNER HASH JOIN EACH WITH ALL ON $350 = $370, $351 = $371, $352 = $372, $353 = $373, $354 = $374, $355 = $375, $356 = $376, $357 = $377, $358 = $378, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($515, '')", "$351 := coalesce($515, '0')", "$352 := coalesce($514, '')", "$353 := coalesce($514, '0')", "$354 := coalesce($510, '')", "$355 := coalesce($510, '0')", "$356 := coalesce($511, '')", "$357 := coalesce($511, '0')", "$358 := coalesce($512, 0)", "$359 := coalesce($512, 1)", "$360 := coalesce($513, 0)", "$361 := coalesce($513, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "TO __stage24_output" ] } ], "waitMsAvg": "9", "waitMsMax": "13", "waitRatioAvg": 0.01070154577883472, "waitRatioMax": 0.015457788347205707, "writeMsAvg": "4", "writeMsMax": "29", "writeRatioAvg": 0.0047562425683709865, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.015457788347205707, "computeRatioMax": 0.015457788347205707, "endMs": "1665777672784", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "13917", "shuffleOutputBytesSpilled": "0", "slotMs": "130", "startMs": "1665777672573", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1320 ASC, $1321 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1340, $1341, $1342, $1343, $1344, $1345, $1346, $1347, $1348, $1349", "TO __stage25_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.016646848989298454, "waitRatioMax": 0.016646848989298454, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0035671819262782403, "writeRatioMax": 0.0035671819262782403 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "12", "completedUnits": "19", "elapsedMs": "626", "estimatedRunnableUnits": "0", "pendingUnits": "8", "totalSlotMs": "4562" }, { "activeUnits": "303", "completedUnits": "1039", "elapsedMs": "2133", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "64871" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113426519", "totalPartitionsProcessed": "0", "totalSlotMs": "64871", "transferredBytes": "0" }, "startTime": "1665777670780", "totalBytesProcessed": "113426519", "totalSlotMs": "64871" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2a807544_67ea_44e6_9876_5394b1f2720a" }, "priority": "INTERACTIVE", "query": "-- start query 47 in stream 0 using template query47.tpl\n\n/*\nFind the item brands and categories for each store and company, \nthe monthly sales figures for a specified year, \nwhere the monthly sales figure deviated more than 10% of the average monthly sales for the year, \nsorted by deviation and store. \n\nReport deviation of sales from the previous and the following monthly sales.\n*/\n\nwith v1 as(\n select i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand,\n s_store_name, s_company_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n s_store_name, s_company_name\n order by d_year, d_moy) rn\n from item, store_sales, date_dim, store\n where ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name,v1.d_year, v1.d_moy\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1.s_store_name = v1_lag.s_store_name and\n v1.s_store_name = v1_lead.s_store_name and\n v1.s_company_name = v1_lag.s_company_name and\n v1.s_company_name = v1_lead.s_company_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and \n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n limit 100\n ;\n\n-- end query 47 in stream 0 using template query47.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "N5sM6V4c0NEqIvSRD3S1kA==", "id": "test-project-364309:europe-west1.query47_1665777674", "jobReference": { "jobId": "query47_1665777674", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query47_1665777674?location=europe-west1", "statistics": { "creationTime": "1665777674610", "endTime": "1665777676397", "finalExecutionDurationMs": "1535", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113426519", "performanceInsights": { "avgPreviousExecutionMs": "1592" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01174934725848564, "computeRatioMax": 0.01174934725848564, "endMs": "1665777674813", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007832898172323759, "readRatioMax": 0.007832898172323759, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777674774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:s_store_sk, $81:s_store_name, $82:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0195822454308094, "writeRatioMax": 0.0195822454308094 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.030026109660574413, "computeRatioMax": 0.030026109660574413, "endMs": "1665777674818", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.010443864229765013, "readRatioMax": 0.010443864229765013, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777674789", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.007832898172323759, "writeRatioMax": 0.007832898172323759 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.028720626631853787, "computeRatioMax": 0.028720626631853787, "endMs": "1665777674861", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006527415143603133, "readRatioMax": 0.006527415143603133, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777674818", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.03263707571801567, "writeRatioMax": 0.03263707571801567 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.014360313315926894, "computeRatioMax": 0.014360313315926894, "endMs": "1665777674863", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.015665796344647518, "readRatioMax": 0.015665796344647518, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777674831", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name, $12:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.014360313315926894, "writeRatioMax": 0.014360313315926894 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.02741514360313316, "computeRatioMax": 0.02741514360313316, "endMs": "1665777674872", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009138381201044387, "readRatioMax": 0.009138381201044387, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777674845", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.009138381201044387, "writeRatioMax": 0.009138381201044387 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.022193211488250653, "computeRatioMax": 0.022193211488250653, "endMs": "1665777674915", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006527415143603133, "readRatioMax": 0.006527415143603133, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777674875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.031331592689295036, "writeRatioMax": 0.031331592689295036 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013054830287206266, "computeRatioMax": 0.013054830287206266, "endMs": "1665777674916", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007832898172323759, "readRatioMax": 0.007832898172323759, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777674886", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.022193211488250653, "writeRatioMax": 0.022193211488250653 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.022193211488250653, "computeRatioMax": 0.022193211488250653, "endMs": "1665777674928", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009138381201044387, "readRatioMax": 0.009138381201044387, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777674899", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01174934725848564, "writeRatioMax": 0.01174934725848564 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.022193211488250653, "computeRatioMax": 0.022193211488250653, "endMs": "1665777674965", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009138381201044387, "readRatioMax": 0.009138381201044387, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777674926", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.024804177545691905, "writeRatioMax": 0.024804177545691905 }, { "completedParallelInputs": "6", "computeMsAvg": "375", "computeMsMax": "439", "computeRatioAvg": 0.489556135770235, "computeRatioMax": 0.5731070496083551, "endMs": "1665777675227", "id": "12", "inputStages": [ "0", "1", "3" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.013054830287206266, "readRatioMax": 0.016971279373368148, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "1998", "startMs": "1665777674930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $820 := $811, $821 := $810, $822 := $815, $823 := $816, $824 := $813, $825 := $814", "$690 := SUM($812)" ] }, { "kind": "JOIN", "substeps": [ "$810 := $800, $811 := $801, $812 := $803, $813 := $804, $814 := $805, $815 := $81, $816 := $82", "INNER HASH JOIN EACH WITH ALL ON $802 = $80" ] }, { "kind": "JOIN", "substeps": [ "$800 := $780, $801 := $781, $802 := $783, $803 := $784, $804 := $111, $805 := $112", "INNER HASH JOIN EACH WITH ALL ON $782 = $110" ] }, { "kind": "JOIN", "substeps": [ "$782 := $100, $783 := $102, $784 := $103, $780 := $91, $781 := $92", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "TO __stage0C_output", "BY HASH($820, $821, $822, $823, $824, $825)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.007832898172323759, "writeRatioMax": 0.010443864229765013 }, { "completedParallelInputs": "6", "computeMsAvg": "443", "computeMsMax": "766", "computeRatioAvg": 0.5783289817232375, "computeRatioMax": 1, "endMs": "1665777675397", "id": "13", "inputStages": [ "5", "7", "4" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "16", "readRatioAvg": 0.014360313315926894, "readRatioMax": 0.020887728459530026, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2296", "startMs": "1665777674942", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1031, $1041 := $1030, $1042 := $1035, $1043 := $1036, $1044 := $1033, $1045 := $1034", "$530 := SUM($1032)" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1020, $1031 := $1021, $1032 := $1023, $1033 := $1024, $1034 := $1025, $1035 := $11, $1036 := $12", "INNER HASH JOIN EACH WITH ALL ON $1022 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $1000, $1021 := $1001, $1022 := $1003, $1023 := $1004, $1024 := $71, $1025 := $72", "INNER HASH JOIN EACH WITH ALL ON $1002 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1002 := $60, $1003 := $62, $1004 := $63, $1000 := $51, $1001 := $52", "INNER HASH JOIN EACH WITH ALL ON $61 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "TO __stage0D_output", "BY HASH($1040, $1041, $1042, $1043, $1044, $1045)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "21", "writeMsMax": "26", "writeRatioAvg": 0.02741514360313316, "writeRatioMax": 0.033942558746736295 }, { "completedParallelInputs": "6", "computeMsAvg": "498", "computeMsMax": "670", "computeRatioAvg": 0.6501305483028721, "computeRatioMax": 0.8746736292428199, "endMs": "1665777675356", "id": "14", "inputStages": [ "9", "11", "8" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "15", "readRatioAvg": 0.013054830287206266, "readRatioMax": 0.0195822454308094, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2641", "startMs": "1665777674980", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1191, $1201 := $1190, $1202 := $1195, $1203 := $1196, $1204 := $1193, $1205 := $1194", "$430 := SUM($1192)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1180, $1191 := $1181, $1192 := $1183, $1193 := $1184, $1194 := $1185, $1195 := $2, $1196 := $3", "INNER HASH JOIN EACH WITH ALL ON $1182 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1160, $1181 := $1161, $1182 := $1163, $1183 := $1164, $1184 := $41, $1185 := $42", "INNER HASH JOIN EACH WITH ALL ON $1162 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1162 := $30, $1163 := $32, $1164 := $33, $1160 := $21, $1161 := $22", "INNER HASH JOIN EACH WITH ALL ON $31 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "TO __stage0E_output", "BY HASH($1200, $1201, $1202, $1203, $1204, $1205)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0026109660574412533, "writeMsAvg": "21", "writeMsMax": "24", "writeRatioAvg": 0.02741514360313316, "writeRatioMax": 0.031331592689295036 }, { "completedParallelInputs": "1", "computeMsAvg": "357", "computeMsMax": "357", "computeRatioAvg": 0.4660574412532637, "computeRatioMax": 0.4660574412532637, "endMs": "1665777675441", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "306", "startMs": "1665777675244", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $820, $831 := $821, $832 := $822, $833 := $823, $834 := $824, $835 := $825", "$580 := SUM($690)" ] }, { "kind": "WRITE", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.028720626631853787, "writeRatioMax": 0.028720626631853787 }, { "completedParallelInputs": "1", "computeMsAvg": "530", "computeMsMax": "530", "computeRatioAvg": 0.6919060052219321, "computeRatioMax": 0.6919060052219321, "endMs": "1665777675672", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "466", "startMs": "1665777675378", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204, $1215 := $1205", "$240 := SUM($430)" ] }, { "kind": "WRITE", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.02741514360313316, "writeRatioMax": 0.02741514360313316 }, { "completedParallelInputs": "1", "computeMsAvg": "580", "computeMsMax": "580", "computeRatioAvg": 0.7571801566579635, "computeRatioMax": 0.7571801566579635, "endMs": "1665777675768", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "472", "startMs": "1665777675466", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044, $1055 := $1045", "$270 := SUM($530)" ] }, { "kind": "WRITE", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.028720626631853787, "writeRatioMax": 0.028720626631853787 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.010443864229765013, "computeRatioMax": 0.010443864229765013, "endMs": "1665777675530", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777675504", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$760, $870, $871, $872, $873, $874", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := coalesce($880, '')", "$631 := coalesce($880, '0')", "$632 := coalesce($881, '')", "$633 := coalesce($881, '0')", "$634 := coalesce($882, 0)", "$635 := coalesce($882, 1)", "$636 := coalesce($883, '')", "$637 := coalesce($883, '0')", "$638 := coalesce($884, '')", "$639 := coalesce($884, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $880 := $870, $881 := $871, $882 := $872, $883 := $873, $884 := $874", "$730 := ROOT_AVG($760)" ] }, { "kind": "WRITE", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.024804177545691905, "writeRatioMax": 0.024804177545691905 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.010443864229765013, "computeRatioMax": 0.022193211488250653, "endMs": "1665777675585", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3229", "startMs": "1665777675535", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0026109660574412533, "waitRatioMax": 0.0039164490861618795, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.018276762402088774, "writeRatioMax": 0.02610966057441253 }, { "completedParallelInputs": "101", "computeMsAvg": "13", "computeMsMax": "23", "computeRatioAvg": 0.016971279373368148, "computeRatioMax": 0.030026109660574413, "endMs": "1665777675603", "id": "21", "inputStages": [ "15", "20" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "65298", "shuffleOutputBytes": "6918247", "shuffleOutputBytesSpilled": "0", "slotMs": "3116", "startMs": "1665777675555", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$710, $711, $712, $713, $714, $715, $716", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := AVG($846) OVER (PARTITION BY $845, $844, $840, $841, $842 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$705 ASC, $704 ASC, $700 ASC, $701 ASC, $702 ASC" ] }, { "kind": "JOIN", "substeps": [ "$890 := $720, $891 := $721, $892 := $722, $893 := $723, $894 := $724, $895 := $725, $896 := $726, $897 := $730", "INNER HASH JOIN EACH WITH ALL ON $620 = $630, $621 = $631, $622 = $632, $623 = $633, $624 = $634, $625 = $635, $626 = $636, $627 = $637, $628 = $638, $629 = $639" ] }, { "kind": "COMPUTE", "substeps": [ "$620 := coalesce($720, '')", "$621 := coalesce($720, '0')", "$622 := coalesce($721, '')", "$623 := coalesce($721, '0')", "$624 := coalesce($722, 0)", "$625 := coalesce($722, 1)", "$626 := coalesce($724, '')", "$627 := coalesce($724, '0')", "$628 := coalesce($725, '')", "$629 := coalesce($725, '0')" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0026109660574412533, "waitRatioMax": 0.005221932114882507, "writeMsAvg": "13", "writeMsMax": "24", "writeRatioAvg": 0.016971279373368148, "writeRatioMax": 0.031331592689295036 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.014360313315926894, "computeRatioMax": 0.014360313315926894, "endMs": "1665777675830", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777675790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$610, $1282, $1283, $1284, $1285, $1281, $1280", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := coalesce($1290, '')", "$311 := coalesce($1290, '0')", "$312 := coalesce($1291, '')", "$313 := coalesce($1291, '0')", "$314 := coalesce($1292, '')", "$315 := coalesce($1292, '0')", "$316 := coalesce($1293, '')", "$317 := coalesce($1293, '0')", "$318 := coalesce($1294, 0)", "$319 := coalesce($1294, 1)", "$320 := coalesce($1295, 0)", "$321 := coalesce($1295, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1290 := $1280, $1291 := $1281, $1292 := $1282, $1293 := $1283, $1294 := $1284, $1295 := $1285", "$470 := MIN($610)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02349869451697128, "writeRatioMax": 0.02349869451697128 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.010443864229765013, "computeRatioMax": 0.010443864229765013, "endMs": "1665777675850", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777675816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $1122, $1123, $1124, $1125, $1121, $1120", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($1130, '')", "$411 := coalesce($1130, '0')", "$412 := coalesce($1131, '')", "$413 := coalesce($1131, '0')", "$414 := coalesce($1132, '')", "$415 := coalesce($1132, '0')", "$416 := coalesce($1133, '')", "$417 := coalesce($1133, '0')", "$418 := coalesce($1134, 0)", "$419 := coalesce($1134, 1)", "$420 := coalesce($1135, 0)", "$421 := coalesce($1135, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124, $1135 := $1125", "$570 := MIN($670)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.022193211488250653, "writeRatioMax": 0.022193211488250653 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009138381201044387, "computeRatioMax": 0.009138381201044387, "endMs": "1665777675885", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777675847", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $972, $973, $974, $975, $971, $970", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$370 := coalesce($980, '')", "$371 := coalesce($980, '0')", "$372 := coalesce($981, '')", "$373 := coalesce($981, '0')", "$374 := coalesce($982, '')", "$375 := coalesce($982, '0')", "$376 := coalesce($983, '')", "$377 := coalesce($983, '0')", "$378 := coalesce($984, 0)", "$379 := coalesce($984, 1)", "$380 := coalesce($985, 0)", "$381 := coalesce($985, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970, $981 := $971, $982 := $972, $983 := $973, $984 := $974, $985 := $975", "$520 := MIN($650)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02610966057441253, "writeRatioMax": 0.02610966057441253 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.010443864229765013, "computeRatioMax": 0.02349869451697128, "endMs": "1665777675923", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3556", "startMs": "1665777675863", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.0039164490861618795, "waitRatioMax": 0.006527415143603133, "writeMsAvg": "25", "writeMsMax": "32", "writeRatioAvg": 0.03263707571801567, "writeRatioMax": 0.04177545691906005 }, { "completedParallelInputs": "101", "computeMsAvg": "13", "computeMsMax": "25", "computeRatioAvg": 0.016971279373368148, "computeRatioMax": 0.03263707571801567, "endMs": "1665777675946", "id": "29", "inputStages": [ "28", "16" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "4619", "startMs": "1665777675877", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$450, $1250, $1251, $1252, $1253, $1254, $1255, $1256", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := subtract($164, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1225, $1224, $1220, $1221 ORDER BY $1222 ASC, $1223 ASC)" ] }, { "kind": "SORT", "substeps": [ "$445 ASC, $444 ASC, $440 ASC, $441 ASC, $442 ASC, $443 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1300 := $460, $1301 := $461, $1302 := $464, $1303 := $465, $1304 := $466, $1305 := $470", "INNER HASH JOIN EACH WITH ALL ON $290 = $310, $291 = $311, $292 = $312, $293 = $313, $294 = $314, $295 = $315, $296 = $316, $297 = $317, $298 = $318, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($465, '')", "$291 := coalesce($465, '0')", "$292 := coalesce($464, '')", "$293 := coalesce($464, '0')", "$294 := coalesce($460, '')", "$295 := coalesce($460, '0')", "$296 := coalesce($461, '')", "$297 := coalesce($461, '0')", "$298 := coalesce($462, 0)", "$299 := coalesce($462, 1)", "$300 := coalesce($463, 0)", "$301 := coalesce($463, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $160, $161, $162, $163, $165", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "11", "waitRatioAvg": 0.0026109660574412533, "waitRatioMax": 0.014360313315926894, "writeMsAvg": "31", "writeMsMax": "56", "writeRatioAvg": 0.04046997389033943, "writeRatioMax": 0.0731070496083551 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.010443864229765013, "computeRatioMax": 0.018276762402088774, "endMs": "1665777675945", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2519", "startMs": "1665777675878", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "10", "waitMsMax": "15", "waitRatioAvg": 0.013054830287206266, "waitRatioMax": 0.0195822454308094, "writeMsAvg": "5", "writeMsMax": "17", "writeRatioAvg": 0.006527415143603133, "writeRatioMax": 0.022193211488250653 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.009138381201044387, "computeRatioMax": 0.0195822454308094, "endMs": "1665777675946", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2720", "startMs": "1665777675896", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.006527415143603133, "waitRatioMax": 0.007832898172323759, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.018276762402088774, "writeRatioMax": 0.030026109660574413 }, { "completedParallelInputs": "101", "computeMsAvg": "13", "computeMsMax": "22", "computeRatioAvg": 0.016971279373368148, "computeRatioMax": 0.028720626631853787, "endMs": "1665777675955", "id": "33", "inputStages": [ "32", "21" ], "name": "S21: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "49634", "shuffleOutputBytes": "5720708", "shuffleOutputBytesSpilled": "0", "slotMs": "3063", "startMs": "1665777675912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$500, $940, $941, $942, $943, $944, $945, $946, $947", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "FROM __stage20_output" ] }, { "kind": "FILTER", "substeps": [ "and(equal($182, 1999), greater($187, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $905, $904, $900, $901 ORDER BY $902 ASC, $903 ASC)" ] }, { "kind": "SORT", "substeps": [ "$495 ASC, $494 ASC, $490 ASC, $491 ASC, $492 ASC, $493 ASC" ] }, { "kind": "JOIN", "substeps": [ "$990 := $510, $991 := $511, $992 := $512, $993 := $513, $994 := $514, $995 := $515, $996 := $516, $997 := $517, $998 := $520", "INNER HASH JOIN EACH WITH ALL ON $350 = $370, $351 = $371, $352 = $372, $353 = $373, $354 = $374, $355 = $375, $356 = $376, $357 = $377, $358 = $378, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($515, '')", "$351 := coalesce($515, '0')", "$352 := coalesce($514, '')", "$353 := coalesce($514, '0')", "$354 := coalesce($510, '')", "$355 := coalesce($510, '0')", "$356 := coalesce($511, '')", "$357 := coalesce($511, '0')", "$358 := coalesce($512, 0)", "$359 := coalesce($512, 1)", "$360 := coalesce($513, 0)", "$361 := coalesce($513, 1)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188", "TO __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0026109660574412533, "waitRatioMax": 0.005221932114882507, "writeMsAvg": "11", "writeMsMax": "18", "writeRatioAvg": 0.014360313315926894, "writeRatioMax": 0.02349869451697128 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.01174934725848564, "computeRatioMax": 0.022193211488250653, "endMs": "1665777676020", "id": "34", "inputStages": [ "33" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "49634", "recordsWritten": "49634", "shuffleOutputBytes": "5720708", "shuffleOutputBytesSpilled": "0", "slotMs": "4026", "startMs": "1665777675958", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0026109660574412533, "waitRatioMax": 0.005221932114882507, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.0195822454308094, "writeRatioMax": 0.03263707571801567 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.01174934725848564, "computeRatioMax": 0.02349869451697128, "endMs": "1665777676011", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "2901", "startMs": "1665777675959", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.006527415143603133, "waitRatioMax": 0.007832898172323759, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.016971279373368148, "writeRatioMax": 0.024804177545691905 }, { "completedParallelInputs": "101", "computeMsAvg": "155", "computeMsMax": "255", "computeRatioAvg": 0.20234986945169714, "computeRatioMax": 0.3328981723237598, "endMs": "1665777676217", "id": "36", "inputStages": [ "34", "17", "30", "35" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11444498", "recordsWritten": "10000", "shuffleOutputBytes": "1556877", "shuffleOutputBytesSpilled": "0", "slotMs": "17085", "startMs": "1665777675968", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$550, $1090, $1091, $1092, $1093, $1094, $1095, $1096", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $184, $185, $186, $187, $188", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$130, $160, $161, $162, $163, $165", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1319 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($1317, $1316)" ] }, { "kind": "JOIN", "substeps": [ "$1310 := $1150, $1311 := $1151, $1312 := $1152, $1313 := $1153, $1314 := $1154, $1315 := $1155, $1316 := $1157, $1317 := $1158, $1318 := $1159, $1319 := $165", "INNER HASH JOIN EACH WITH ALL ON $1155 = $163, $1154 = $162, $1150 = $160, $1151 = $161, $1156 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1159 := $205, $1150 := $180, $1151 := $181, $1152 := $182, $1153 := $183, $1154 := $184, $1155 := $185, $1156 := $186, $1157 := $187, $1158 := $188", "INNER HASH JOIN EACH WITH ALL ON $203 = $185, $202 = $184, $200 = $180, $201 = $181, $140 = $186" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := add($204, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$230 := RANK() OVER (PARTITION BY $1065, $1064, $1060, $1061 ORDER BY $1062 ASC, $1063 ASC)" ] }, { "kind": "SORT", "substeps": [ "$545 ASC, $544 ASC, $540 ASC, $541 ASC, $542 ASC, $543 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $560, $1141 := $561, $1142 := $564, $1143 := $565, $1144 := $566, $1145 := $570", "INNER HASH JOIN EACH WITH ALL ON $390 = $410, $391 = $411, $392 = $412, $393 = $413, $394 = $414, $395 = $415, $396 = $416, $397 = $417, $398 = $418, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$390 := coalesce($565, '')", "$391 := coalesce($565, '0')", "$392 := coalesce($564, '')", "$393 := coalesce($564, '0')", "$394 := coalesce($560, '')", "$395 := coalesce($560, '0')", "$396 := coalesce($561, '')", "$397 := coalesce($561, '0')", "$398 := coalesce($562, 0)", "$399 := coalesce($562, 1)", "$400 := coalesce($563, 0)", "$401 := coalesce($563, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "TO __stage24_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.007832898172323759, "waitRatioMax": 0.009138381201044387, "writeMsAvg": "3", "writeMsMax": "24", "writeRatioAvg": 0.0039164490861618795, "writeRatioMax": 0.031331592689295036 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013054830287206266, "computeRatioMax": 0.013054830287206266, "endMs": "1665777676216", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "13917", "shuffleOutputBytesSpilled": "0", "slotMs": "136", "startMs": "1665777675978", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1320 ASC, $1321 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1340, $1341, $1342, $1343, $1344, $1345, $1346, $1347, $1348, $1349", "TO __stage25_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.010443864229765013, "waitRatioMax": 0.010443864229765013, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0026109660574412533, "writeRatioMax": 0.0026109660574412533 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "24", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "5635" }, { "activeUnits": "2", "completedUnits": "1039", "elapsedMs": "1672", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "59121" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113426519", "totalPartitionsProcessed": "0", "totalSlotMs": "59121", "transferredBytes": "0" }, "startTime": "1665777674663", "totalBytesProcessed": "113426519", "totalSlotMs": "59121" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5f49f351_2d07_4b68_a944_b9d1fe839e47" }, "priority": "INTERACTIVE", "query": "-- start query 47 in stream 0 using template query47.tpl\n\n/*\nFind the item brands and categories for each store and company, \nthe monthly sales figures for a specified year, \nwhere the monthly sales figure deviated more than 10% of the average monthly sales for the year, \nsorted by deviation and store. \n\nReport deviation of sales from the previous and the following monthly sales.\n*/\n\nwith v1 as(\n select i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand,\n s_store_name, s_company_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n s_store_name, s_company_name\n order by d_year, d_moy) rn\n from item, store_sales, date_dim, store\n where ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name,v1.d_year, v1.d_moy\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1.s_store_name = v1_lag.s_store_name and\n v1.s_store_name = v1_lead.s_store_name and\n v1.s_company_name = v1_lag.s_company_name and\n v1.s_company_name = v1_lead.s_company_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and \n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n limit 100\n ;\n\n-- end query 47 in stream 0 using template query47.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "xuEvbJxGF/LhBbcFvTb7nQ==", "id": "test-project-364309:europe-west1.query47_1665777678", "jobReference": { "jobId": "query47_1665777678", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query47_1665777678?location=europe-west1", "statistics": { "creationTime": "1665777678655", "endTime": "1665777680500", "finalExecutionDurationMs": "1615", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113426519", "performanceInsights": { "avgPreviousExecutionMs": "1580" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.011164274322169059, "computeRatioMax": 0.011164274322169059, "endMs": "1665777678881", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006379585326953748, "readRatioMax": 0.006379585326953748, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777678842", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:s_store_sk, $81:s_store_name, $82:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.028708133971291867, "writeRatioMax": 0.028708133971291867 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02073365231259968, "computeRatioMax": 0.02073365231259968, "endMs": "1665777678882", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009569377990430622, "readRatioMax": 0.009569377990430622, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777678857", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.014354066985645933, "writeRatioMax": 0.014354066985645933 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02073365231259968, "computeRatioMax": 0.02073365231259968, "endMs": "1665777678922", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009569377990430622, "readRatioMax": 0.009569377990430622, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777678882", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03827751196172249, "writeRatioMax": 0.03827751196172249 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.009569377990430622, "computeRatioMax": 0.009569377990430622, "endMs": "1665777678944", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006379585326953748, "readRatioMax": 0.006379585326953748, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777678906", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name, $12:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage04_output" ] } ], "waitMsAvg": "12", "waitMsMax": "12", "waitRatioAvg": 0.019138755980861243, "waitRatioMax": 0.019138755980861243, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.023923444976076555, "writeRatioMax": 0.023923444976076555 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.02711323763955343, "computeRatioMax": 0.02711323763955343, "endMs": "1665777678968", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009569377990430622, "readRatioMax": 0.009569377990430622, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777678908", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "42", "writeMsMax": "42", "writeRatioAvg": 0.06698564593301436, "writeRatioMax": 0.06698564593301436 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.03349282296650718, "computeRatioMax": 0.03349282296650718, "endMs": "1665777678975", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006379585326953748, "readRatioMax": 0.006379585326953748, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777678935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03827751196172249, "writeRatioMax": 0.03827751196172249 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02073365231259968, "computeRatioMax": 0.02073365231259968, "endMs": "1665777678986", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011164274322169059, "readRatioMax": 0.011164274322169059, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777678950", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01594896331738437, "writeRatioMax": 0.01594896331738437 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.03189792663476874, "computeRatioMax": 0.03189792663476874, "endMs": "1665777679029", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009569377990430622, "readRatioMax": 0.009569377990430622, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777678966", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "45", "writeMsMax": "45", "writeRatioAvg": 0.07177033492822966, "writeRatioMax": 0.07177033492822966 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.03508771929824561, "computeRatioMax": 0.03508771929824561, "endMs": "1665777679038", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.017543859649122806, "readRatioMax": 0.017543859649122806, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777678991", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.03189792663476874, "writeRatioMax": 0.03189792663476874 }, { "completedParallelInputs": "6", "computeMsAvg": "431", "computeMsMax": "528", "computeRatioAvg": 0.6874003189792663, "computeRatioMax": 0.8421052631578947, "endMs": "1665777679334", "id": "12", "inputStages": [ "1", "3", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "14", "readRatioAvg": 0.01594896331738437, "readRatioMax": 0.022328548644338118, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2072", "startMs": "1665777678994", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $820 := $811, $821 := $810, $822 := $815, $823 := $816, $824 := $813, $825 := $814", "$690 := SUM($812)" ] }, { "kind": "JOIN", "substeps": [ "$810 := $800, $811 := $801, $812 := $803, $813 := $804, $814 := $805, $815 := $81, $816 := $82", "INNER HASH JOIN EACH WITH ALL ON $802 = $80" ] }, { "kind": "JOIN", "substeps": [ "$800 := $780, $801 := $781, $802 := $783, $803 := $784, $804 := $111, $805 := $112", "INNER HASH JOIN EACH WITH ALL ON $782 = $110" ] }, { "kind": "JOIN", "substeps": [ "$782 := $100, $783 := $102, $784 := $103, $780 := $91, $781 := $92", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "TO __stage0C_output", "BY HASH($820, $821, $822, $823, $824, $825)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.007974481658692184, "writeRatioMax": 0.011164274322169059 }, { "completedParallelInputs": "6", "computeMsAvg": "387", "computeMsMax": "495", "computeRatioAvg": 0.6172248803827751, "computeRatioMax": 0.7894736842105263, "endMs": "1665777679361", "id": "13", "inputStages": [ "7", "5", "4" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.01594896331738437, "readRatioMax": 0.019138755980861243, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2055", "startMs": "1665777679008", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1031, $1041 := $1030, $1042 := $1035, $1043 := $1036, $1044 := $1033, $1045 := $1034", "$530 := SUM($1032)" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1020, $1031 := $1021, $1032 := $1023, $1033 := $1024, $1034 := $1025, $1035 := $11, $1036 := $12", "INNER HASH JOIN EACH WITH ALL ON $1022 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $1000, $1021 := $1001, $1022 := $1003, $1023 := $1004, $1024 := $71, $1025 := $72", "INNER HASH JOIN EACH WITH ALL ON $1002 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1002 := $60, $1003 := $62, $1004 := $63, $1000 := $51, $1001 := $52", "INNER HASH JOIN EACH WITH ALL ON $61 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "TO __stage0D_output", "BY HASH($1040, $1041, $1042, $1043, $1044, $1045)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "19", "writeMsMax": "21", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.03349282296650718 }, { "completedParallelInputs": "6", "computeMsAvg": "421", "computeMsMax": "502", "computeRatioAvg": 0.671451355661882, "computeRatioMax": 0.8006379585326954, "endMs": "1665777679389", "id": "14", "inputStages": [ "8", "9", "11" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.02073365231259968, "readRatioMax": 0.028708133971291867, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2256", "startMs": "1665777679061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1191, $1201 := $1190, $1202 := $1195, $1203 := $1196, $1204 := $1193, $1205 := $1194", "$430 := SUM($1192)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1180, $1191 := $1181, $1192 := $1183, $1193 := $1184, $1194 := $1185, $1195 := $2, $1196 := $3", "INNER HASH JOIN EACH WITH ALL ON $1182 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1160, $1181 := $1161, $1182 := $1163, $1183 := $1164, $1184 := $41, $1185 := $42", "INNER HASH JOIN EACH WITH ALL ON $1162 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1162 := $30, $1163 := $32, $1164 := $33, $1160 := $21, $1161 := $22", "INNER HASH JOIN EACH WITH ALL ON $31 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "TO __stage0E_output", "BY HASH($1200, $1201, $1202, $1203, $1204, $1205)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "21", "writeMsMax": "22", "writeRatioAvg": 0.03349282296650718, "writeRatioMax": 0.03508771929824561 }, { "completedParallelInputs": "1", "computeMsAvg": "360", "computeMsMax": "360", "computeRatioAvg": 0.5741626794258373, "computeRatioMax": 0.5741626794258373, "endMs": "1665777679602", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "341", "startMs": "1665777679360", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $820, $831 := $821, $832 := $822, $833 := $823, $834 := $824, $835 := $825", "$580 := SUM($690)" ] }, { "kind": "WRITE", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.03508771929824561, "writeRatioMax": 0.03508771929824561 }, { "completedParallelInputs": "1", "computeMsAvg": "627", "computeMsMax": "627", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777679772", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "599", "startMs": "1665777679382", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044, $1055 := $1045", "$270 := SUM($530)" ] }, { "kind": "WRITE", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.03508771929824561, "writeRatioMax": 0.03508771929824561 }, { "completedParallelInputs": "1", "computeMsAvg": "321", "computeMsMax": "321", "computeRatioAvg": 0.5119617224880383, "computeRatioMax": 0.5119617224880383, "endMs": "1665777679602", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "262", "startMs": "1665777679405", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204, $1215 := $1205", "$240 := SUM($430)" ] }, { "kind": "WRITE", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.02711323763955343, "writeRatioMax": 0.02711323763955343 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.006379585326953748, "computeRatioMax": 0.006379585326953748, "endMs": "1665777679740", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777679706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$760, $870, $871, $872, $873, $874", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := coalesce($880, '')", "$631 := coalesce($880, '0')", "$632 := coalesce($881, '')", "$633 := coalesce($881, '0')", "$634 := coalesce($882, 0)", "$635 := coalesce($882, 1)", "$636 := coalesce($883, '')", "$637 := coalesce($883, '0')", "$638 := coalesce($884, '')", "$639 := coalesce($884, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $880 := $870, $881 := $871, $882 := $872, $883 := $873, $884 := $874", "$730 := ROOT_AVG($760)" ] }, { "kind": "WRITE", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.028708133971291867, "writeRatioMax": 0.028708133971291867 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.012759170653907496, "computeRatioMax": 0.023923444976076555, "endMs": "1665777679801", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3285", "startMs": "1665777679753", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.003189792663476874, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.022328548644338118, "writeRatioMax": 0.03189792663476874 }, { "completedParallelInputs": "101", "computeMsAvg": "13", "computeMsMax": "21", "computeRatioAvg": 0.02073365231259968, "computeRatioMax": 0.03349282296650718, "endMs": "1665777679821", "id": "21", "inputStages": [ "20", "15" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "65298", "shuffleOutputBytes": "6918247", "shuffleOutputBytesSpilled": "0", "slotMs": "3341", "startMs": "1665777679767", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$710, $711, $712, $713, $714, $715, $716", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := AVG($846) OVER (PARTITION BY $845, $844, $840, $841, $842 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$705 ASC, $704 ASC, $700 ASC, $701 ASC, $702 ASC" ] }, { "kind": "JOIN", "substeps": [ "$890 := $720, $891 := $721, $892 := $722, $893 := $723, $894 := $724, $895 := $725, $896 := $726, $897 := $730", "INNER HASH JOIN EACH WITH ALL ON $620 = $630, $621 = $631, $622 = $632, $623 = $633, $624 = $634, $625 = $635, $626 = $636, $627 = $637, $628 = $638, $629 = $639" ] }, { "kind": "COMPUTE", "substeps": [ "$620 := coalesce($720, '')", "$621 := coalesce($720, '0')", "$622 := coalesce($721, '')", "$623 := coalesce($721, '0')", "$624 := coalesce($722, 0)", "$625 := coalesce($722, 1)", "$626 := coalesce($724, '')", "$627 := coalesce($724, '0')", "$628 := coalesce($725, '')", "$629 := coalesce($725, '0')" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003189792663476874, "waitRatioMax": 0.004784688995215311, "writeMsAvg": "13", "writeMsMax": "29", "writeRatioAvg": 0.02073365231259968, "writeRatioMax": 0.046251993620414676 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.009569377990430622, "computeRatioMax": 0.009569377990430622, "endMs": "1665777679978", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777679942", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$610, $1282, $1283, $1284, $1285, $1281, $1280", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := coalesce($1290, '')", "$311 := coalesce($1290, '0')", "$312 := coalesce($1291, '')", "$313 := coalesce($1291, '0')", "$314 := coalesce($1292, '')", "$315 := coalesce($1292, '0')", "$316 := coalesce($1293, '')", "$317 := coalesce($1293, '0')", "$318 := coalesce($1294, 0)", "$319 := coalesce($1294, 1)", "$320 := coalesce($1295, 0)", "$321 := coalesce($1295, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1290 := $1280, $1291 := $1281, $1292 := $1282, $1293 := $1283, $1294 := $1284, $1295 := $1285", "$470 := MIN($610)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02073365231259968, "computeRatioMax": 0.02073365231259968, "endMs": "1665777680010", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777679970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $1122, $1123, $1124, $1125, $1121, $1120", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($1130, '')", "$411 := coalesce($1130, '0')", "$412 := coalesce($1131, '')", "$413 := coalesce($1131, '0')", "$414 := coalesce($1132, '')", "$415 := coalesce($1132, '0')", "$416 := coalesce($1133, '')", "$417 := coalesce($1133, '0')", "$418 := coalesce($1134, 0)", "$419 := coalesce($1134, 1)", "$420 := coalesce($1135, 0)", "$421 := coalesce($1135, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124, $1135 := $1125", "$570 := MIN($670)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.007974481658692184, "computeRatioMax": 0.007974481658692184, "endMs": "1665777680042", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777679999", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $972, $973, $974, $975, $971, $970", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$370 := coalesce($980, '')", "$371 := coalesce($980, '0')", "$372 := coalesce($981, '')", "$373 := coalesce($981, '0')", "$374 := coalesce($982, '')", "$375 := coalesce($982, '0')", "$376 := coalesce($983, '')", "$377 := coalesce($983, '0')", "$378 := coalesce($984, 0)", "$379 := coalesce($984, 1)", "$380 := coalesce($985, 0)", "$381 := coalesce($985, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970, $981 := $971, $982 := $972, $983 := $973, $984 := $974, $985 := $975", "$520 := MIN($650)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001594896331738437, "waitRatioMax": 0.001594896331738437, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.03189792663476874, "writeRatioMax": 0.03189792663476874 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.014354066985645933, "computeRatioMax": 0.02711323763955343, "endMs": "1665777680086", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3246", "startMs": "1665777680015", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.007974481658692184, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.023923444976076555, "writeRatioMax": 0.03349282296650718 }, { "completedParallelInputs": "101", "computeMsAvg": "13", "computeMsMax": "21", "computeRatioAvg": 0.02073365231259968, "computeRatioMax": 0.03349282296650718, "endMs": "1665777680083", "id": "29", "inputStages": [ "17", "28" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3277", "startMs": "1665777680028", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$450, $1250, $1251, $1252, $1253, $1254, $1255, $1256", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := subtract($164, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1225, $1224, $1220, $1221 ORDER BY $1222 ASC, $1223 ASC)" ] }, { "kind": "SORT", "substeps": [ "$445 ASC, $444 ASC, $440 ASC, $441 ASC, $442 ASC, $443 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1300 := $460, $1301 := $461, $1302 := $464, $1303 := $465, $1304 := $466, $1305 := $470", "INNER HASH JOIN EACH WITH ALL ON $290 = $310, $291 = $311, $292 = $312, $293 = $313, $294 = $314, $295 = $315, $296 = $316, $297 = $317, $298 = $318, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($465, '')", "$291 := coalesce($465, '0')", "$292 := coalesce($464, '')", "$293 := coalesce($464, '0')", "$294 := coalesce($460, '')", "$295 := coalesce($460, '0')", "$296 := coalesce($461, '')", "$297 := coalesce($461, '0')", "$298 := coalesce($462, 0)", "$299 := coalesce($462, 1)", "$300 := coalesce($463, 0)", "$301 := coalesce($463, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $160, $161, $162, $163, $165", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.003189792663476874, "waitRatioMax": 0.006379585326953748, "writeMsAvg": "12", "writeMsMax": "17", "writeRatioAvg": 0.019138755980861243, "writeRatioMax": 0.02711323763955343 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.011164274322169059, "computeRatioMax": 0.019138755980861243, "endMs": "1665777680120", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4237", "startMs": "1665777680029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.006379585326953748, "writeMsAvg": "26", "writeMsMax": "60", "writeRatioAvg": 0.04146730462519936, "writeRatioMax": 0.09569377990430622 }, { "completedParallelInputs": "101", "computeMsAvg": "13", "computeMsMax": "24", "computeRatioAvg": 0.02073365231259968, "computeRatioMax": 0.03827751196172249, "endMs": "1665777680125", "id": "31", "inputStages": [ "30", "16" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3498", "startMs": "1665777680048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$550, $1090, $1091, $1092, $1093, $1094, $1095, $1096", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := add($204, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$230 := RANK() OVER (PARTITION BY $1065, $1064, $1060, $1061 ORDER BY $1062 ASC, $1063 ASC)" ] }, { "kind": "SORT", "substeps": [ "$545 ASC, $544 ASC, $540 ASC, $541 ASC, $542 ASC, $543 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $560, $1141 := $561, $1142 := $564, $1143 := $565, $1144 := $566, $1145 := $570", "INNER HASH JOIN EACH WITH ALL ON $390 = $410, $391 = $411, $392 = $412, $393 = $413, $394 = $414, $395 = $415, $396 = $416, $397 = $417, $398 = $418, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$390 := coalesce($565, '')", "$391 := coalesce($565, '0')", "$392 := coalesce($564, '')", "$393 := coalesce($564, '0')", "$394 := coalesce($560, '')", "$395 := coalesce($560, '0')", "$396 := coalesce($561, '')", "$397 := coalesce($561, '0')", "$398 := coalesce($562, 0)", "$399 := coalesce($562, 1)", "$400 := coalesce($563, 0)", "$401 := coalesce($563, 1)" ] }, { "kind": "WRITE", "substeps": [ "$140, $200, $201, $202, $203, $205", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003189792663476874, "waitRatioMax": 0.004784688995215311, "writeMsAvg": "13", "writeMsMax": "58", "writeRatioAvg": 0.02073365231259968, "writeRatioMax": 0.09250398724082935 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.011164274322169059, "computeRatioMax": 0.02073365231259968, "endMs": "1665777680126", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4094", "startMs": "1665777680049", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.003189792663476874, "waitRatioMax": 0.006379585326953748, "writeMsAvg": "16", "writeMsMax": "52", "writeRatioAvg": 0.025518341307814992, "writeRatioMax": 0.08293460925039872 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.014354066985645933, "computeRatioMax": 0.025518341307814992, "endMs": "1665777680182", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3383", "startMs": "1665777680132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.003189792663476874, "waitRatioMax": 0.006379585326953748, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.023923444976076555, "writeRatioMax": 0.0430622009569378 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.012759170653907496, "computeRatioMax": 0.023923444976076555, "endMs": "1665777680183", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "2965", "startMs": "1665777680133", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.006379585326953748, "waitRatioMax": 0.009569377990430622, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.022328548644338118, "writeRatioMax": 0.028708133971291867 }, { "completedParallelInputs": "101", "computeMsAvg": "163", "computeMsMax": "342", "computeRatioAvg": 0.25996810207336524, "computeRatioMax": 0.5454545454545454, "endMs": "1665777680375", "id": "36", "inputStages": [ "32", "34", "35", "21" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12896898", "recordsWritten": "10000", "shuffleOutputBytes": "1556877", "shuffleOutputBytesSpilled": "0", "slotMs": "16634", "startMs": "1665777680142", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$500, $940, $941, $942, $943, $944, $945, $946, $947", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$140, $200, $201, $202, $203, $205", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$130, $160, $161, $162, $163, $165", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1319 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($1317, $1316)" ] }, { "kind": "JOIN", "substeps": [ "$1310 := $1150, $1311 := $1151, $1312 := $1152, $1313 := $1153, $1314 := $1154, $1315 := $1155, $1316 := $1157, $1317 := $1158, $1318 := $1159, $1319 := $165", "INNER HASH JOIN EACH WITH ALL ON $1155 = $163, $1154 = $162, $1150 = $160, $1151 = $161, $1156 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1150 := $180, $1151 := $181, $1152 := $182, $1153 := $183, $1154 := $184, $1155 := $185, $1156 := $186, $1157 := $187, $1158 := $188, $1159 := $205", "INNER HASH JOIN EACH WITH ALL ON $185 = $203, $184 = $202, $180 = $200, $181 = $201, $186 = $140" ] }, { "kind": "FILTER", "substeps": [ "and(equal($182, 1999), greater($187, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $905, $904, $900, $901 ORDER BY $902 ASC, $903 ASC)" ] }, { "kind": "SORT", "substeps": [ "$495 ASC, $494 ASC, $490 ASC, $491 ASC, $492 ASC, $493 ASC" ] }, { "kind": "JOIN", "substeps": [ "$990 := $510, $991 := $511, $992 := $512, $993 := $513, $994 := $514, $995 := $515, $996 := $516, $997 := $517, $998 := $520", "INNER HASH JOIN EACH WITH ALL ON $350 = $370, $351 = $371, $352 = $372, $353 = $373, $354 = $374, $355 = $375, $356 = $376, $357 = $377, $358 = $378, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($515, '')", "$351 := coalesce($515, '0')", "$352 := coalesce($514, '')", "$353 := coalesce($514, '0')", "$354 := coalesce($510, '')", "$355 := coalesce($510, '0')", "$356 := coalesce($511, '')", "$357 := coalesce($511, '0')", "$358 := coalesce($512, 0)", "$359 := coalesce($512, 1)", "$360 := coalesce($513, 0)", "$361 := coalesce($513, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "TO __stage24_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.007974481658692184, "waitRatioMax": 0.011164274322169059, "writeMsAvg": "3", "writeMsMax": "17", "writeRatioAvg": 0.004784688995215311, "writeRatioMax": 0.02711323763955343 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02073365231259968, "computeRatioMax": 0.02073365231259968, "endMs": "1665777680386", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "13917", "shuffleOutputBytesSpilled": "0", "slotMs": "101", "startMs": "1665777680150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1320 ASC, $1321 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1340, $1341, $1342, $1343, $1344, $1345, $1346, $1347, $1348, $1349", "TO __stage25_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.011164274322169059, "waitRatioMax": 0.011164274322169059, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.006379585326953748, "writeRatioMax": 0.006379585326953748 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "8", "completedUnits": "22", "elapsedMs": "643", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "5676" }, { "activeUnits": "10", "completedUnits": "232", "elapsedMs": "1156", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14878" }, { "activeUnits": "0", "completedUnits": "1039", "elapsedMs": "1748", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "60255" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113426519", "totalPartitionsProcessed": "0", "totalSlotMs": "60255", "transferredBytes": "0" }, "startTime": "1665777678701", "totalBytesProcessed": "113426519", "totalSlotMs": "60255" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb14342ea_1a51_4740_9924_6ab05350e0c1" }, "priority": "INTERACTIVE", "query": "-- start query 47 in stream 0 using template query47.tpl\n\n/*\nFind the item brands and categories for each store and company, \nthe monthly sales figures for a specified year, \nwhere the monthly sales figure deviated more than 10% of the average monthly sales for the year, \nsorted by deviation and store. \n\nReport deviation of sales from the previous and the following monthly sales.\n*/\n\nwith v1 as(\n select i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand,\n s_store_name, s_company_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n s_store_name, s_company_name\n order by d_year, d_moy) rn\n from item, store_sales, date_dim, store\n where ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name,v1.d_year, v1.d_moy\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1.s_store_name = v1_lag.s_store_name and\n v1.s_store_name = v1_lead.s_store_name and\n v1.s_company_name = v1_lag.s_company_name and\n v1.s_company_name = v1_lead.s_company_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and \n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n limit 100\n ;\n\n-- end query 47 in stream 0 using template query47.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ruptMUqBYqkPj/Zl+yRuGA==", "id": "test-project-364309:europe-west1.query47_1665777682", "jobReference": { "jobId": "query47_1665777682", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query47_1665777682?location=europe-west1", "statistics": { "creationTime": "1665777682595", "endTime": "1665777684604", "finalExecutionDurationMs": "1742", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113426519", "performanceInsights": { "avgPreviousExecutionMs": "1586" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.007473841554559043, "computeRatioMax": 0.007473841554559043, "endMs": "1665777682818", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.004484304932735426, "readRatioMax": 0.004484304932735426, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777682780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:s_store_sk, $81:s_store_name, $82:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02391629297458894, "writeRatioMax": 0.02391629297458894 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.025411061285500747, "computeRatioMax": 0.025411061285500747, "endMs": "1665777682831", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.013452914798206279, "readRatioMax": 0.013452914798206279, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777682799", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.013452914798206279, "writeRatioMax": 0.013452914798206279 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.025411061285500747, "computeRatioMax": 0.025411061285500747, "endMs": "1665777682889", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008968609865470852, "readRatioMax": 0.008968609865470852, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777682830", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.04185351270553064, "writeRatioMax": 0.04185351270553064 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.013452914798206279, "computeRatioMax": 0.013452914798206279, "endMs": "1665777682892", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007473841554559043, "readRatioMax": 0.007473841554559043, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777682848", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name, $12:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.028400597907324365, "writeRatioMax": 0.028400597907324365 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.025411061285500747, "computeRatioMax": 0.025411061285500747, "endMs": "1665777682895", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.01195814648729447, "readRatioMax": 0.01195814648729447, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777682866", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.014947683109118086, "writeRatioMax": 0.014947683109118086 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.028400597907324365, "computeRatioMax": 0.028400597907324365, "endMs": "1665777682951", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007473841554559043, "readRatioMax": 0.007473841554559043, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777682899", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03587443946188341, "writeRatioMax": 0.03587443946188341 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017937219730941704, "computeRatioMax": 0.017937219730941704, "endMs": "1665777682957", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005979073243647235, "readRatioMax": 0.005979073243647235, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777682915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.029895366218236172, "writeRatioMax": 0.029895366218236172 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.0343796711509716, "computeRatioMax": 0.0343796711509716, "endMs": "1665777682970", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008968609865470852, "readRatioMax": 0.008968609865470852, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777682934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.026905829596412557, "writeRatioMax": 0.026905829596412557 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.025411061285500747, "computeRatioMax": 0.025411061285500747, "endMs": "1665777683021", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005979073243647235, "readRatioMax": 0.005979073243647235, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777682968", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.03736920777279522, "writeRatioMax": 0.03736920777279522 }, { "completedParallelInputs": "6", "computeMsAvg": "479", "computeMsMax": "646", "computeRatioAvg": 0.7159940209267563, "computeRatioMax": 0.9656203288490284, "endMs": "1665777683349", "id": "12", "inputStages": [ "0", "3", "1" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.01943198804185351, "readRatioMax": 0.026905829596412557, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2438", "startMs": "1665777682972", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $820 := $811, $821 := $810, $822 := $815, $823 := $816, $824 := $813, $825 := $814", "$690 := SUM($812)" ] }, { "kind": "JOIN", "substeps": [ "$810 := $800, $811 := $801, $812 := $803, $813 := $804, $814 := $805, $815 := $81, $816 := $82", "INNER HASH JOIN EACH WITH ALL ON $802 = $80" ] }, { "kind": "JOIN", "substeps": [ "$800 := $780, $801 := $781, $802 := $783, $803 := $784, $804 := $111, $805 := $112", "INNER HASH JOIN EACH WITH ALL ON $782 = $110" ] }, { "kind": "JOIN", "substeps": [ "$782 := $100, $783 := $102, $784 := $103, $780 := $91, $781 := $92", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "TO __stage0C_output", "BY HASH($820, $821, $822, $823, $824, $825)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.008968609865470852, "writeRatioMax": 0.01046337817638266 }, { "completedParallelInputs": "6", "computeMsAvg": "503", "computeMsMax": "669", "computeRatioAvg": 0.7518684603886397, "computeRatioMax": 1, "endMs": "1665777683423", "id": "13", "inputStages": [ "5", "7", "4" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "25", "readRatioAvg": 0.01943198804185351, "readRatioMax": 0.03736920777279522, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2920", "startMs": "1665777682989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1031, $1041 := $1030, $1042 := $1035, $1043 := $1036, $1044 := $1033, $1045 := $1034", "$530 := SUM($1032)" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1020, $1031 := $1021, $1032 := $1023, $1033 := $1024, $1034 := $1025, $1035 := $11, $1036 := $12", "INNER HASH JOIN EACH WITH ALL ON $1022 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $1000, $1021 := $1001, $1022 := $1003, $1023 := $1004, $1024 := $71, $1025 := $72", "INNER HASH JOIN EACH WITH ALL ON $1002 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1002 := $60, $1003 := $62, $1004 := $63, $1000 := $51, $1001 := $52", "INNER HASH JOIN EACH WITH ALL ON $61 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "TO __stage0D_output", "BY HASH($1040, $1041, $1042, $1043, $1044, $1045)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "22", "writeMsMax": "29", "writeRatioAvg": 0.03288490284005979, "writeRatioMax": 0.043348281016442454 }, { "completedParallelInputs": "6", "computeMsAvg": "502", "computeMsMax": "663", "computeRatioAvg": 0.750373692077728, "computeRatioMax": 0.9910313901345291, "endMs": "1665777683413", "id": "14", "inputStages": [ "11", "9", "8" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.014947683109118086, "readRatioMax": 0.01943198804185351, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2435", "startMs": "1665777683055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1191, $1201 := $1190, $1202 := $1195, $1203 := $1196, $1204 := $1193, $1205 := $1194", "$430 := SUM($1192)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1180, $1191 := $1181, $1192 := $1183, $1193 := $1184, $1194 := $1185, $1195 := $2, $1196 := $3", "INNER HASH JOIN EACH WITH ALL ON $1182 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1160, $1181 := $1161, $1182 := $1163, $1183 := $1164, $1184 := $41, $1185 := $42", "INNER HASH JOIN EACH WITH ALL ON $1162 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1162 := $30, $1163 := $32, $1164 := $33, $1160 := $21, $1161 := $22", "INNER HASH JOIN EACH WITH ALL ON $31 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "TO __stage0E_output", "BY HASH($1200, $1201, $1202, $1203, $1204, $1205)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "21", "writeMsMax": "22", "writeRatioAvg": 0.03139013452914798, "writeRatioMax": 0.03288490284005979 }, { "completedParallelInputs": "1", "computeMsAvg": "373", "computeMsMax": "373", "computeRatioAvg": 0.5575485799701047, "computeRatioMax": 0.5575485799701047, "endMs": "1665777683621", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "343", "startMs": "1665777683375", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $820, $831 := $821, $832 := $822, $833 := $823, $834 := $824, $835 := $825", "$580 := SUM($690)" ] }, { "kind": "WRITE", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03587443946188341, "writeRatioMax": 0.03587443946188341 }, { "completedParallelInputs": "1", "computeMsAvg": "379", "computeMsMax": "379", "computeRatioAvg": 0.5665171898355755, "computeRatioMax": 0.5665171898355755, "endMs": "1665777683655", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "331", "startMs": "1665777683439", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204, $1215 := $1205", "$240 := SUM($430)" ] }, { "kind": "WRITE", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.0343796711509716, "writeRatioMax": 0.0343796711509716 }, { "completedParallelInputs": "1", "computeMsAvg": "317", "computeMsMax": "317", "computeRatioAvg": 0.47384155455904337, "computeRatioMax": 0.47384155455904337, "endMs": "1665777683682", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "296", "startMs": "1665777683461", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044, $1055 := $1045", "$270 := SUM($530)" ] }, { "kind": "WRITE", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.03288490284005979, "writeRatioMax": 0.03288490284005979 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01046337817638266, "computeRatioMax": 0.01046337817638266, "endMs": "1665777683738", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777683705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$760, $870, $871, $872, $873, $874", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := coalesce($880, '')", "$631 := coalesce($880, '0')", "$632 := coalesce($881, '')", "$633 := coalesce($881, '0')", "$634 := coalesce($882, 0)", "$635 := coalesce($882, 1)", "$636 := coalesce($883, '')", "$637 := coalesce($883, '0')", "$638 := coalesce($884, '')", "$639 := coalesce($884, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $880 := $870, $881 := $871, $882 := $872, $883 := $873, $884 := $874", "$730 := ROOT_AVG($760)" ] }, { "kind": "WRITE", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.04185351270553064, "writeRatioMax": 0.04185351270553064 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.013452914798206279, "computeRatioMax": 0.02242152466367713, "endMs": "1665777683797", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3685", "startMs": "1665777683742", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0029895366218236174, "writeMsAvg": "20", "writeMsMax": "30", "writeRatioAvg": 0.029895366218236172, "writeRatioMax": 0.04484304932735426 }, { "completedParallelInputs": "101", "computeMsAvg": "15", "computeMsMax": "30", "computeRatioAvg": 0.02242152466367713, "computeRatioMax": 0.04484304932735426, "endMs": "1665777683818", "id": "21", "inputStages": [ "20", "15" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "65298", "shuffleOutputBytes": "6918247", "shuffleOutputBytesSpilled": "0", "slotMs": "3947", "startMs": "1665777683760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$710, $711, $712, $713, $714, $715, $716", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := AVG($846) OVER (PARTITION BY $845, $844, $840, $841, $842 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$705 ASC, $704 ASC, $700 ASC, $701 ASC, $702 ASC" ] }, { "kind": "JOIN", "substeps": [ "$890 := $720, $891 := $721, $892 := $722, $893 := $723, $894 := $724, $895 := $725, $896 := $726, $897 := $730", "INNER HASH JOIN EACH WITH ALL ON $620 = $630, $621 = $631, $622 = $632, $623 = $633, $624 = $634, $625 = $635, $626 = $636, $627 = $637, $628 = $638, $629 = $639" ] }, { "kind": "COMPUTE", "substeps": [ "$620 := coalesce($720, '')", "$621 := coalesce($720, '0')", "$622 := coalesce($721, '')", "$623 := coalesce($721, '0')", "$624 := coalesce($722, 0)", "$625 := coalesce($722, 1)", "$626 := coalesce($724, '')", "$627 := coalesce($724, '0')", "$628 := coalesce($725, '')", "$629 := coalesce($725, '0')" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "6", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.008968609865470852, "writeMsAvg": "18", "writeMsMax": "36", "writeRatioAvg": 0.026905829596412557, "writeRatioMax": 0.053811659192825115 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017937219730941704, "computeRatioMax": 0.017937219730941704, "endMs": "1665777683992", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777683954", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$610, $1282, $1283, $1284, $1285, $1281, $1280", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := coalesce($1290, '')", "$311 := coalesce($1290, '0')", "$312 := coalesce($1291, '')", "$313 := coalesce($1291, '0')", "$314 := coalesce($1292, '')", "$315 := coalesce($1292, '0')", "$316 := coalesce($1293, '')", "$317 := coalesce($1293, '0')", "$318 := coalesce($1294, 0)", "$319 := coalesce($1294, 1)", "$320 := coalesce($1295, 0)", "$321 := coalesce($1295, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1290 := $1280, $1291 := $1281, $1292 := $1282, $1293 := $1283, $1294 := $1284, $1295 := $1285", "$470 := MIN($610)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.04783258594917788, "writeRatioMax": 0.04783258594917788 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01943198804185351, "computeRatioMax": 0.01943198804185351, "endMs": "1665777684028", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777683990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $1122, $1123, $1124, $1125, $1121, $1120", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($1130, '')", "$411 := coalesce($1130, '0')", "$412 := coalesce($1131, '')", "$413 := coalesce($1131, '0')", "$414 := coalesce($1132, '')", "$415 := coalesce($1132, '0')", "$416 := coalesce($1133, '')", "$417 := coalesce($1133, '0')", "$418 := coalesce($1134, 0)", "$419 := coalesce($1134, 1)", "$420 := coalesce($1135, 0)", "$421 := coalesce($1135, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124, $1135 := $1125", "$570 := MIN($670)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.04484304932735426, "writeRatioMax": 0.04484304932735426 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01195814648729447, "computeRatioMax": 0.01195814648729447, "endMs": "1665777684081", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777684033", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $972, $973, $974, $975, $971, $970", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$370 := coalesce($980, '')", "$371 := coalesce($980, '0')", "$372 := coalesce($981, '')", "$373 := coalesce($981, '0')", "$374 := coalesce($982, '')", "$375 := coalesce($982, '0')", "$376 := coalesce($983, '')", "$377 := coalesce($983, '0')", "$378 := coalesce($984, 0)", "$379 := coalesce($984, 1)", "$380 := coalesce($985, 0)", "$381 := coalesce($985, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970, $981 := $971, $982 := $972, $983 := $973, $984 := $974, $985 := $975", "$520 := MIN($650)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014947683109118087, "waitRatioMax": 0.0014947683109118087, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.04484304932735426, "writeRatioMax": 0.04484304932735426 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.01195814648729447, "computeRatioMax": 0.02391629297458894, "endMs": "1665777684132", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "5351", "startMs": "1665777684052", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004484304932735426, "waitRatioMax": 0.005979073243647235, "writeMsAvg": "49", "writeMsMax": "59", "writeRatioAvg": 0.07324364723467862, "writeRatioMax": 0.08819133034379671 }, { "completedParallelInputs": "101", "computeMsAvg": "14", "computeMsMax": "24", "computeRatioAvg": 0.02092675635276532, "computeRatioMax": 0.03587443946188341, "endMs": "1665777684147", "id": "29", "inputStages": [ "28", "16" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "5215", "startMs": "1665777684069", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$450, $1250, $1251, $1252, $1253, $1254, $1255, $1256", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := subtract($164, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1225, $1224, $1220, $1221 ORDER BY $1222 ASC, $1223 ASC)" ] }, { "kind": "SORT", "substeps": [ "$445 ASC, $444 ASC, $440 ASC, $441 ASC, $442 ASC, $443 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1300 := $460, $1301 := $461, $1302 := $464, $1303 := $465, $1304 := $466, $1305 := $470", "INNER HASH JOIN EACH WITH ALL ON $290 = $310, $291 = $311, $292 = $312, $293 = $313, $294 = $314, $295 = $315, $296 = $316, $297 = $317, $298 = $318, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($465, '')", "$291 := coalesce($465, '0')", "$292 := coalesce($464, '')", "$293 := coalesce($464, '0')", "$294 := coalesce($460, '')", "$295 := coalesce($460, '0')", "$296 := coalesce($461, '')", "$297 := coalesce($461, '0')", "$298 := coalesce($462, 0)", "$299 := coalesce($462, 1)", "$300 := coalesce($463, 0)", "$301 := coalesce($463, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $160, $161, $162, $163, $165", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.0029895366218236174, "waitRatioMax": 0.007473841554559043, "writeMsAvg": "37", "writeMsMax": "53", "writeRatioAvg": 0.05530642750373692, "writeRatioMax": 0.07922272047832586 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.013452914798206279, "computeRatioMax": 0.028400597907324365, "endMs": "1665777684132", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3783", "startMs": "1665777684070", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.005979073243647235, "waitRatioMax": 0.007473841554559043, "writeMsAvg": "21", "writeMsMax": "51", "writeRatioAvg": 0.03139013452914798, "writeRatioMax": 0.07623318385650224 }, { "completedParallelInputs": "101", "computeMsAvg": "15", "computeMsMax": "31", "computeRatioAvg": 0.02242152466367713, "computeRatioMax": 0.04633781763826607, "endMs": "1665777684149", "id": "31", "inputStages": [ "30", "17" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3854", "startMs": "1665777684098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$550, $1090, $1091, $1092, $1093, $1094, $1095, $1096", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := add($204, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$230 := RANK() OVER (PARTITION BY $1065, $1064, $1060, $1061 ORDER BY $1062 ASC, $1063 ASC)" ] }, { "kind": "SORT", "substeps": [ "$545 ASC, $544 ASC, $540 ASC, $541 ASC, $542 ASC, $543 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $560, $1141 := $561, $1142 := $564, $1143 := $565, $1144 := $566, $1145 := $570", "INNER HASH JOIN EACH WITH ALL ON $390 = $410, $391 = $411, $392 = $412, $393 = $413, $394 = $414, $395 = $415, $396 = $416, $397 = $417, $398 = $418, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$390 := coalesce($565, '')", "$391 := coalesce($565, '0')", "$392 := coalesce($564, '')", "$393 := coalesce($564, '0')", "$394 := coalesce($560, '')", "$395 := coalesce($560, '0')", "$396 := coalesce($561, '')", "$397 := coalesce($561, '0')", "$398 := coalesce($562, 0)", "$399 := coalesce($562, 1)", "$400 := coalesce($563, 0)", "$401 := coalesce($563, 1)" ] }, { "kind": "WRITE", "substeps": [ "$140, $200, $201, $202, $203, $205", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0029895366218236174, "waitRatioMax": 0.005979073243647235, "writeMsAvg": "17", "writeMsMax": "29", "writeRatioAvg": 0.025411061285500747, "writeRatioMax": 0.043348281016442454 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.01195814648729447, "computeRatioMax": 0.02242152466367713, "endMs": "1665777684152", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3225", "startMs": "1665777684099", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004484304932735426, "waitRatioMax": 0.005979073243647235, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.02092675635276532, "writeRatioMax": 0.03139013452914798 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.013452914798206279, "computeRatioMax": 0.028400597907324365, "endMs": "1665777684330", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3524", "startMs": "1665777684273", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0029895366218236174, "waitRatioMax": 0.005979073243647235, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.02242152466367713, "writeRatioMax": 0.04035874439461883 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.013452914798206279, "computeRatioMax": 0.02242152466367713, "endMs": "1665777684331", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3476", "startMs": "1665777684274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.007473841554559043, "waitRatioMax": 0.008968609865470852, "writeMsAvg": "14", "writeMsMax": "38", "writeRatioAvg": 0.02092675635276532, "writeRatioMax": 0.05680119581464873 }, { "completedParallelInputs": "101", "computeMsAvg": "159", "computeMsMax": "276", "computeRatioAvg": 0.23766816143497757, "computeRatioMax": 0.4125560538116592, "endMs": "1665777684470", "id": "36", "inputStages": [ "21", "34", "32", "35" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12896898", "recordsWritten": "10000", "shuffleOutputBytes": "1556877", "shuffleOutputBytesSpilled": "0", "slotMs": "16697", "startMs": "1665777684284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$500, $940, $941, $942, $943, $944, $945, $946, $947", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$140, $200, $201, $202, $203, $205", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$130, $160, $161, $162, $163, $165", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1319 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($1317, $1316)" ] }, { "kind": "JOIN", "substeps": [ "$1310 := $1150, $1311 := $1151, $1312 := $1152, $1313 := $1153, $1314 := $1154, $1315 := $1155, $1316 := $1157, $1317 := $1158, $1318 := $1159, $1319 := $165", "INNER HASH JOIN EACH WITH ALL ON $1155 = $163, $1154 = $162, $1150 = $160, $1151 = $161, $1156 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1150 := $180, $1151 := $181, $1152 := $182, $1153 := $183, $1154 := $184, $1155 := $185, $1156 := $186, $1157 := $187, $1158 := $188, $1159 := $205", "INNER HASH JOIN EACH WITH ALL ON $185 = $203, $184 = $202, $180 = $200, $181 = $201, $186 = $140" ] }, { "kind": "FILTER", "substeps": [ "and(equal($182, 1999), greater($187, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $905, $904, $900, $901 ORDER BY $902 ASC, $903 ASC)" ] }, { "kind": "SORT", "substeps": [ "$495 ASC, $494 ASC, $490 ASC, $491 ASC, $492 ASC, $493 ASC" ] }, { "kind": "JOIN", "substeps": [ "$990 := $510, $991 := $511, $992 := $512, $993 := $513, $994 := $514, $995 := $515, $996 := $516, $997 := $517, $998 := $520", "INNER HASH JOIN EACH WITH ALL ON $350 = $370, $351 = $371, $352 = $372, $353 = $373, $354 = $374, $355 = $375, $356 = $376, $357 = $377, $358 = $378, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($515, '')", "$351 := coalesce($515, '0')", "$352 := coalesce($514, '')", "$353 := coalesce($514, '0')", "$354 := coalesce($510, '')", "$355 := coalesce($510, '0')", "$356 := coalesce($511, '')", "$357 := coalesce($511, '0')", "$358 := coalesce($512, 0)", "$359 := coalesce($512, 1)", "$360 := coalesce($513, 0)", "$361 := coalesce($513, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "TO __stage24_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.008968609865470852, "waitRatioMax": 0.01046337817638266, "writeMsAvg": "3", "writeMsMax": "18", "writeRatioAvg": 0.004484304932735426, "writeRatioMax": 0.026905829596412557 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.028400597907324365, "computeRatioMax": 0.028400597907324365, "endMs": "1665777684479", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "13917", "shuffleOutputBytesSpilled": "0", "slotMs": "97", "startMs": "1665777684292", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1320 ASC, $1321 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1340, $1341, $1342, $1343, $1344, $1345, $1346, $1347, $1348, $1349", "TO __stage25_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.007473841554559043, "waitRatioMax": 0.007473841554559043, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.007473841554559043, "writeRatioMax": 0.007473841554559043 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "13", "completedUnits": "17", "elapsedMs": "634", "estimatedRunnableUnits": "0", "pendingUnits": "10", "totalSlotMs": "4651" }, { "activeUnits": "124", "completedUnits": "226", "elapsedMs": "1162", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "16982" }, { "activeUnits": "282", "completedUnits": "1039", "elapsedMs": "1894", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "65878" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113426519", "totalPartitionsProcessed": "0", "totalSlotMs": "65878", "transferredBytes": "0" }, "startTime": "1665777682648", "totalBytesProcessed": "113426519", "totalSlotMs": "65878" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon89b3348c_3cf0_4e14_b24a_f925ab41af12" }, "priority": "INTERACTIVE", "query": "-- start query 47 in stream 0 using template query47.tpl\n\n/*\nFind the item brands and categories for each store and company, \nthe monthly sales figures for a specified year, \nwhere the monthly sales figure deviated more than 10% of the average monthly sales for the year, \nsorted by deviation and store. \n\nReport deviation of sales from the previous and the following monthly sales.\n*/\n\nwith v1 as(\n select i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand,\n s_store_name, s_company_name, d_year)\n avg_monthly_sales,\n rank() over\n (partition by i_category, i_brand,\n s_store_name, s_company_name\n order by d_year, d_moy) rn\n from item, store_sales, date_dim, store\n where ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n (\n d_year = 1999 or\n ( d_year = 1999-1 and d_moy =12) or\n ( d_year = 1999+1 and d_moy =1)\n )\n group by i_category, i_brand,\n s_store_name, s_company_name,\n d_year, d_moy),\n v2 as(\n select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name,v1.d_year, v1.d_moy\n ,v1.avg_monthly_sales\n ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n v1.i_category = v1_lead.i_category and\n v1.i_brand = v1_lag.i_brand and\n v1.i_brand = v1_lead.i_brand and\n v1.s_store_name = v1_lag.s_store_name and\n v1.s_store_name = v1_lead.s_store_name and\n v1.s_company_name = v1_lag.s_company_name and\n v1.s_company_name = v1_lead.s_company_name and\n v1.rn = v1_lag.rn + 1 and\n v1.rn = v1_lead.rn - 1)\n select *\n from v2\n where d_year = 1999 and \n avg_monthly_sales > 0 and\n case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n limit 100\n ;\n\n-- end query 47 in stream 0 using template query47.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "nH43DJHI2iExYwgmAS3rkg==", "id": "test-project-364309:europe-west1.query47_1665777686", "jobReference": { "jobId": "query47_1665777686", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query47_1665777686?location=europe-west1", "statistics": { "creationTime": "1665777686599", "endTime": "1665777688345", "finalExecutionDurationMs": "1489", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113426519", "performanceInsights": { "avgPreviousExecutionMs": "1608" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.015193370165745856, "computeRatioMax": 0.015193370165745856, "endMs": "1665777686796", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006906077348066298, "readRatioMax": 0.006906077348066298, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777686764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:s_store_sk, $81:s_store_name, $82:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.027624309392265192, "writeRatioMax": 0.027624309392265192 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.017955801104972375, "computeRatioMax": 0.017955801104972375, "endMs": "1665777686805", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006906077348066298, "readRatioMax": 0.006906077348066298, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777686780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year, $112:d_moy", "FROM date_dim", "WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.015193370165745856, "writeRatioMax": 0.015193370165745856 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.019337016574585635, "computeRatioMax": 0.019337016574585635, "endMs": "1665777686850", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008287292817679558, "readRatioMax": 0.008287292817679558, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777686808", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:i_item_sk, $91:i_brand, $92:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.03591160220994475, "writeRatioMax": 0.03591160220994475 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013812154696132596, "computeRatioMax": 0.013812154696132596, "endMs": "1665777686864", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0055248618784530384, "readRatioMax": 0.0055248618784530384, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777686824", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name, $12:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.022099447513812154, "writeRatioMax": 0.022099447513812154 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.024861878453038673, "computeRatioMax": 0.024861878453038673, "endMs": "1665777686877", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008287292817679558, "readRatioMax": 0.008287292817679558, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777686837", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year, $72:d_moy", "FROM date_dim", "WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.011049723756906077, "writeRatioMax": 0.011049723756906077 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.023480662983425413, "computeRatioMax": 0.023480662983425413, "endMs": "1665777686905", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0055248618784530384, "readRatioMax": 0.0055248618784530384, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777686864", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_brand, $52:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.034530386740331494, "writeRatioMax": 0.034530386740331494 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013812154696132596, "computeRatioMax": 0.013812154696132596, "endMs": "1665777686907", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006906077348066298, "readRatioMax": 0.006906077348066298, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777686877", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.023480662983425413, "writeRatioMax": 0.023480662983425413 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.019337016574585635, "computeRatioMax": 0.019337016574585635, "endMs": "1665777686935", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.015193370165745856, "readRatioMax": 0.015193370165745856, "recordsRead": "73049", "recordsWritten": "427", "shuffleOutputBytes": "11529", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777686895", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_moy", "FROM date_dim", "WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.008287292817679558, "writeRatioMax": 0.008287292817679558 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.03729281767955801, "computeRatioMax": 0.03729281767955801, "endMs": "1665777686979", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006906077348066298, "readRatioMax": 0.006906077348066298, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "738410", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777686922", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_brand, $22:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.034530386740331494, "writeRatioMax": 0.034530386740331494 }, { "completedParallelInputs": "6", "computeMsAvg": "454", "computeMsMax": "612", "computeRatioAvg": 0.6270718232044199, "computeRatioMax": 0.8453038674033149, "endMs": "1665777687278", "id": "12", "inputStages": [ "3", "1", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.015193370165745856, "readRatioMax": 0.023480662983425413, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2379", "startMs": "1665777686927", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $820 := $811, $821 := $810, $822 := $815, $823 := $816, $824 := $813, $825 := $814", "$690 := SUM($812)" ] }, { "kind": "JOIN", "substeps": [ "$810 := $800, $811 := $801, $812 := $803, $813 := $804, $814 := $805, $815 := $81, $816 := $82", "INNER HASH JOIN EACH WITH ALL ON $802 = $80" ] }, { "kind": "JOIN", "substeps": [ "$800 := $780, $801 := $781, $802 := $783, $803 := $784, $804 := $111, $805 := $112", "INNER HASH JOIN EACH WITH ALL ON $782 = $110" ] }, { "kind": "JOIN", "substeps": [ "$782 := $100, $783 := $102, $784 := $103, $780 := $91, $781 := $92", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "TO __stage0C_output", "BY HASH($820, $821, $822, $823, $824, $825)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.008287292817679558, "writeRatioMax": 0.011049723756906077 }, { "completedParallelInputs": "6", "computeMsAvg": "446", "computeMsMax": "636", "computeRatioAvg": 0.6160220994475138, "computeRatioMax": 0.8784530386740331, "endMs": "1665777687318", "id": "13", "inputStages": [ "7", "5", "4" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "13", "readRatioAvg": 0.016574585635359115, "readRatioMax": 0.017955801104972375, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2550", "startMs": "1665777686942", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1031, $1041 := $1030, $1042 := $1035, $1043 := $1036, $1044 := $1033, $1045 := $1034", "$530 := SUM($1032)" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1020, $1031 := $1021, $1032 := $1023, $1033 := $1024, $1034 := $1025, $1035 := $11, $1036 := $12", "INNER HASH JOIN EACH WITH ALL ON $1022 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1020 := $1000, $1021 := $1001, $1022 := $1003, $1023 := $1004, $1024 := $71, $1025 := $72", "INNER HASH JOIN EACH WITH ALL ON $1002 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1002 := $60, $1003 := $62, $1004 := $63, $1000 := $51, $1001 := $52", "INNER HASH JOIN EACH WITH ALL ON $61 = $50" ] }, { "kind": "WRITE", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "TO __stage0D_output", "BY HASH($1040, $1041, $1042, $1043, $1044, $1045)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "22", "writeMsMax": "24", "writeRatioAvg": 0.03038674033149171, "writeRatioMax": 0.03314917127071823 }, { "completedParallelInputs": "6", "computeMsAvg": "497", "computeMsMax": "724", "computeRatioAvg": 0.68646408839779, "computeRatioMax": 1, "endMs": "1665777687429", "id": "14", "inputStages": [ "9", "8", "11" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "12", "readRatioAvg": 0.015193370165745856, "readRatioMax": 0.016574585635359115, "recordsRead": "2991038", "recordsWritten": "212285", "shuffleOutputBytes": "18770749", "shuffleOutputBytesSpilled": "0", "slotMs": "2496", "startMs": "1665777687002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1200 := $1191, $1201 := $1190, $1202 := $1195, $1203 := $1196, $1204 := $1193, $1205 := $1194", "$430 := SUM($1192)" ] }, { "kind": "JOIN", "substeps": [ "$1190 := $1180, $1191 := $1181, $1192 := $1183, $1193 := $1184, $1194 := $1185, $1195 := $2, $1196 := $3", "INNER HASH JOIN EACH WITH ALL ON $1182 = $1" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1160, $1181 := $1161, $1182 := $1163, $1183 := $1164, $1184 := $41, $1185 := $42", "INNER HASH JOIN EACH WITH ALL ON $1162 = $40" ] }, { "kind": "JOIN", "substeps": [ "$1162 := $30, $1163 := $32, $1164 := $33, $1160 := $21, $1161 := $22", "INNER HASH JOIN EACH WITH ALL ON $31 = $20" ] }, { "kind": "WRITE", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "TO __stage0E_output", "BY HASH($1200, $1201, $1202, $1203, $1204, $1205)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "21", "writeMsMax": "23", "writeRatioAvg": 0.029005524861878452, "writeRatioMax": 0.031767955801104975 }, { "completedParallelInputs": "1", "computeMsAvg": "400", "computeMsMax": "400", "computeRatioAvg": 0.5524861878453039, "computeRatioMax": 0.5524861878453039, "endMs": "1665777687482", "id": "15", "inputStages": [ "12" ], "name": "S0F: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "347", "startMs": "1665777687307", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$822, $823, $821, $820, $824, $825, $690", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $820, $831 := $821, $832 := $822, $833 := $823, $834 := $824, $835 := $825", "$580 := SUM($690)" ] }, { "kind": "WRITE", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.027624309392265192, "writeRatioMax": 0.027624309392265192 }, { "completedParallelInputs": "1", "computeMsAvg": "312", "computeMsMax": "312", "computeRatioAvg": 0.430939226519337, "computeRatioMax": 0.430939226519337, "endMs": "1665777687539", "id": "16", "inputStages": [ "13" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "282", "startMs": "1665777687345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1042, $1043, $1041, $1040, $1044, $1045, $530", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1050 := $1040, $1051 := $1041, $1052 := $1042, $1053 := $1043, $1054 := $1044, $1055 := $1045", "$270 := SUM($530)" ] }, { "kind": "WRITE", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03314917127071823, "writeRatioMax": 0.03314917127071823 }, { "completedParallelInputs": "1", "computeMsAvg": "356", "computeMsMax": "356", "computeRatioAvg": 0.49171270718232046, "computeRatioMax": 0.49171270718232046, "endMs": "1665777687667", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "212285", "recordsWritten": "65298", "shuffleOutputBytes": "5808357", "shuffleOutputBytesSpilled": "0", "slotMs": "298", "startMs": "1665777687453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1202, $1203, $1201, $1200, $1204, $1205, $430", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1210 := $1200, $1211 := $1201, $1212 := $1202, $1213 := $1203, $1214 := $1204, $1215 := $1205", "$240 := SUM($430)" ] }, { "kind": "WRITE", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0027624309392265192, "waitRatioMax": 0.0027624309392265192, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.029005524861878452, "writeRatioMax": 0.029005524861878452 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012430939226519336, "computeRatioMax": 0.012430939226519336, "endMs": "1665777687544", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777687506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$760, $870, $871, $872, $873, $874", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := coalesce($880, '')", "$631 := coalesce($880, '0')", "$632 := coalesce($881, '')", "$633 := coalesce($881, '0')", "$634 := coalesce($882, 0)", "$635 := coalesce($882, 1)", "$636 := coalesce($883, '')", "$637 := coalesce($883, '0')", "$638 := coalesce($884, '')", "$639 := coalesce($884, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $880 := $870, $881 := $871, $882 := $872, $883 := $873, $884 := $874", "$730 := ROOT_AVG($760)" ] }, { "kind": "WRITE", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.024861878453038673, "writeRatioMax": 0.024861878453038673 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.011049723756906077, "computeRatioMax": 0.017955801104972375, "endMs": "1665777687636", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3788", "startMs": "1665777687574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0027624309392265192, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "24", "writeMsMax": "31", "writeRatioAvg": 0.03314917127071823, "writeRatioMax": 0.04281767955801105 }, { "completedParallelInputs": "101", "computeMsAvg": "15", "computeMsMax": "27", "computeRatioAvg": 0.020718232044198894, "computeRatioMax": 0.03729281767955801, "endMs": "1665777687645", "id": "21", "inputStages": [ "20", "15" ], "name": "S15: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "65298", "shuffleOutputBytes": "6918247", "shuffleOutputBytesSpilled": "0", "slotMs": "3813", "startMs": "1665777687591", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$832, $833, $831, $830, $834, $835, $580", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$710, $711, $712, $713, $714, $715, $716", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$630, $631, $632, $633, $634, $635, $636, $637, $638, $639, $730", "FROM __stage14_output" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$480 := AVG($846) OVER (PARTITION BY $845, $844, $840, $841, $842 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$705 ASC, $704 ASC, $700 ASC, $701 ASC, $702 ASC" ] }, { "kind": "JOIN", "substeps": [ "$890 := $720, $891 := $721, $892 := $722, $893 := $723, $894 := $724, $895 := $725, $896 := $726, $897 := $730", "INNER HASH JOIN EACH WITH ALL ON $620 = $630, $621 = $631, $622 = $632, $623 = $633, $624 = $634, $625 = $635, $626 = $636, $627 = $637, $628 = $638, $629 = $639" ] }, { "kind": "COMPUTE", "substeps": [ "$620 := coalesce($720, '')", "$621 := coalesce($720, '0')", "$622 := coalesce($721, '')", "$623 := coalesce($721, '0')", "$624 := coalesce($722, 0)", "$625 := coalesce($722, 1)", "$626 := coalesce($724, '')", "$627 := coalesce($724, '0')", "$628 := coalesce($725, '')", "$629 := coalesce($725, '0')" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0027624309392265192, "waitRatioMax": 0.004143646408839779, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.019337016574585635, "writeRatioMax": 0.04005524861878453 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012430939226519336, "computeRatioMax": 0.012430939226519336, "endMs": "1665777687820", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777687780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$610, $1282, $1283, $1284, $1285, $1281, $1280", "FROM __SHUFFLE17" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := coalesce($1290, '')", "$311 := coalesce($1290, '0')", "$312 := coalesce($1291, '')", "$313 := coalesce($1291, '0')", "$314 := coalesce($1292, '')", "$315 := coalesce($1292, '0')", "$316 := coalesce($1293, '')", "$317 := coalesce($1293, '0')", "$318 := coalesce($1294, 0)", "$319 := coalesce($1294, 1)", "$320 := coalesce($1295, 0)", "$321 := coalesce($1295, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1290 := $1280, $1291 := $1281, $1292 := $1282, $1293 := $1283, $1294 := $1284, $1295 := $1285", "$470 := MIN($610)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "34", "writeMsMax": "34", "writeRatioAvg": 0.04696132596685083, "writeRatioMax": 0.04696132596685083 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.006906077348066298, "computeRatioMax": 0.006906077348066298, "endMs": "1665777687857", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777687822", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $1122, $1123, $1124, $1125, $1121, $1120", "FROM __SHUFFLE12" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := coalesce($1130, '')", "$411 := coalesce($1130, '0')", "$412 := coalesce($1131, '')", "$413 := coalesce($1131, '0')", "$414 := coalesce($1132, '')", "$415 := coalesce($1132, '0')", "$416 := coalesce($1133, '')", "$417 := coalesce($1133, '0')", "$418 := coalesce($1134, 0)", "$419 := coalesce($1134, 1)", "$420 := coalesce($1135, 0)", "$421 := coalesce($1135, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1130 := $1120, $1131 := $1121, $1132 := $1122, $1133 := $1123, $1134 := $1124, $1135 := $1125", "$570 := MIN($670)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.04143646408839779, "writeRatioMax": 0.04143646408839779 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012430939226519336, "computeRatioMax": 0.012430939226519336, "endMs": "1665777687903", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777687862", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $972, $973, $974, $975, $971, $970", "FROM __SHUFFLE7" ] }, { "kind": "COMPUTE", "substeps": [ "$370 := coalesce($980, '')", "$371 := coalesce($980, '0')", "$372 := coalesce($981, '')", "$373 := coalesce($981, '0')", "$374 := coalesce($982, '')", "$375 := coalesce($982, '0')", "$376 := coalesce($983, '')", "$377 := coalesce($983, '0')", "$378 := coalesce($984, 0)", "$379 := coalesce($984, 1)", "$380 := coalesce($985, 0)", "$381 := coalesce($985, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970, $981 := $971, $982 := $972, $983 := $973, $984 := $974, $985 := $975", "$520 := MIN($650)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0027624309392265192, "waitRatioMax": 0.0027624309392265192, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.04558011049723757, "writeRatioMax": 0.04558011049723757 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.012430939226519336, "computeRatioMax": 0.022099447513812154, "endMs": "1665777687961", "id": "28", "inputStages": [ "22" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4718", "startMs": "1665777687882", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004143646408839779, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "22", "writeMsMax": "30", "writeRatioAvg": 0.03038674033149171, "writeRatioMax": 0.04143646408839779 }, { "completedParallelInputs": "101", "computeMsAvg": "13", "computeMsMax": "23", "computeRatioAvg": 0.017955801104972375, "computeRatioMax": 0.031767955801104975, "endMs": "1665777687961", "id": "29", "inputStages": [ "28", "17" ], "name": "S1D: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3662", "startMs": "1665777687901", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1212, $1213, $1211, $1210, $1214, $1215, $240", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$450, $1250, $1251, $1252, $1253, $1254, $1255, $1256", "FROM __SHUFFLE16" ] }, { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $470", "FROM __stage1C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := subtract($164, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$210 := RANK() OVER (PARTITION BY $1225, $1224, $1220, $1221 ORDER BY $1222 ASC, $1223 ASC)" ] }, { "kind": "SORT", "substeps": [ "$445 ASC, $444 ASC, $440 ASC, $441 ASC, $442 ASC, $443 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1300 := $460, $1301 := $461, $1302 := $464, $1303 := $465, $1304 := $466, $1305 := $470", "INNER HASH JOIN EACH WITH ALL ON $290 = $310, $291 = $311, $292 = $312, $293 = $313, $294 = $314, $295 = $315, $296 = $316, $297 = $317, $298 = $318, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$290 := coalesce($465, '')", "$291 := coalesce($465, '0')", "$292 := coalesce($464, '')", "$293 := coalesce($464, '0')", "$294 := coalesce($460, '')", "$295 := coalesce($460, '0')", "$296 := coalesce($461, '')", "$297 := coalesce($461, '0')", "$298 := coalesce($462, 0)", "$299 := coalesce($462, 1)", "$300 := coalesce($463, 0)", "$301 := coalesce($463, 1)" ] }, { "kind": "WRITE", "substeps": [ "$130, $160, $161, $162, $163, $165", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0027624309392265192, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "18", "writeMsMax": "31", "writeRatioAvg": 0.024861878453038673, "writeRatioMax": 0.04281767955801105 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.011049723756906077, "computeRatioMax": 0.023480662983425413, "endMs": "1665777687978", "id": "30", "inputStages": [ "24" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3620", "startMs": "1665777687902", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.008287292817679558, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.020718232044198894, "writeRatioMax": 0.03867403314917127 }, { "completedParallelInputs": "101", "computeMsAvg": "14", "computeMsMax": "27", "computeRatioAvg": 0.019337016574585635, "computeRatioMax": 0.03729281767955801, "endMs": "1665777687977", "id": "31", "inputStages": [ "30", "16" ], "name": "S1F: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "65298", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3691", "startMs": "1665777687920", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1052, $1053, $1051, $1050, $1054, $1055, $270", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$550, $1090, $1091, $1092, $1093, $1094, $1095, $1096", "FROM __SHUFFLE11" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $414, $415, $416, $417, $418, $419, $420, $421, $570", "FROM __stage1E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := add($204, 1)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$230 := RANK() OVER (PARTITION BY $1065, $1064, $1060, $1061 ORDER BY $1062 ASC, $1063 ASC)" ] }, { "kind": "SORT", "substeps": [ "$545 ASC, $544 ASC, $540 ASC, $541 ASC, $542 ASC, $543 ASC" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $560, $1141 := $561, $1142 := $564, $1143 := $565, $1144 := $566, $1145 := $570", "INNER HASH JOIN EACH WITH ALL ON $390 = $410, $391 = $411, $392 = $412, $393 = $413, $394 = $414, $395 = $415, $396 = $416, $397 = $417, $398 = $418, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$390 := coalesce($565, '')", "$391 := coalesce($565, '0')", "$392 := coalesce($564, '')", "$393 := coalesce($564, '0')", "$394 := coalesce($560, '')", "$395 := coalesce($560, '0')", "$396 := coalesce($561, '')", "$397 := coalesce($561, '0')", "$398 := coalesce($562, 0)", "$399 := coalesce($562, 1)", "$400 := coalesce($563, 0)", "$401 := coalesce($563, 1)" ] }, { "kind": "WRITE", "substeps": [ "$140, $200, $201, $202, $203, $205", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0027624309392265192, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.020718232044198894, "writeRatioMax": 0.04281767955801105 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.011049723756906077, "computeRatioMax": 0.020718232044198894, "endMs": "1665777688012", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3231", "startMs": "1665777687920", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "12", "waitRatioAvg": 0.004143646408839779, "waitRatioMax": 0.016574585635359115, "writeMsAvg": "19", "writeMsMax": "30", "writeRatioAvg": 0.026243093922651933, "writeRatioMax": 0.04143646408839779 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "19", "computeRatioAvg": 0.013812154696132596, "computeRatioMax": 0.026243093922651933, "endMs": "1665777688048", "id": "34", "inputStages": [ "31" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3240", "startMs": "1665777687986", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0027624309392265192, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.019337016574585635, "writeRatioMax": 0.03867403314917127 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.012430939226519336, "computeRatioMax": 0.022099447513812154, "endMs": "1665777688051", "id": "35", "inputStages": [ "29" ], "name": "S23: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "64158", "recordsWritten": "64158", "shuffleOutputBytes": "5147271", "shuffleOutputBytesSpilled": "0", "slotMs": "3063", "startMs": "1665777687989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004143646408839779, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "9", "writeMsMax": "19", "writeRatioAvg": 0.012430939226519336, "writeRatioMax": 0.026243093922651933 }, { "completedParallelInputs": "101", "computeMsAvg": "158", "computeMsMax": "296", "computeRatioAvg": 0.21823204419889503, "computeRatioMax": 0.4088397790055249, "endMs": "1665777688203", "id": "36", "inputStages": [ "32", "35", "34", "21" ], "name": "S24: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "12896898", "recordsWritten": "10000", "shuffleOutputBytes": "1556877", "shuffleOutputBytesSpilled": "0", "slotMs": "16213", "startMs": "1665777688004", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$500, $940, $941, $942, $943, $944, $945, $946, $947", "FROM __SHUFFLE6" ] }, { "kind": "READ", "substeps": [ "$370, $371, $372, $373, $374, $375, $376, $377, $378, $379, $380, $381, $520", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$140, $200, $201, $202, $203, $205", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$130, $160, $161, $162, $163, $165", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC, $1319 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := subtract($1317, $1316)" ] }, { "kind": "JOIN", "substeps": [ "$1310 := $1150, $1311 := $1151, $1312 := $1152, $1313 := $1153, $1314 := $1154, $1315 := $1155, $1316 := $1157, $1317 := $1158, $1318 := $1159, $1319 := $165", "INNER HASH JOIN EACH WITH ALL ON $1155 = $163, $1154 = $162, $1150 = $160, $1151 = $161, $1156 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1150 := $180, $1151 := $181, $1152 := $182, $1153 := $183, $1154 := $184, $1155 := $185, $1156 := $186, $1157 := $187, $1158 := $188, $1159 := $205", "INNER HASH JOIN EACH WITH ALL ON $185 = $203, $184 = $202, $180 = $200, $181 = $201, $186 = $140" ] }, { "kind": "FILTER", "substeps": [ "and(equal($182, 1999), greater($187, NUMERIC<...>), ...)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$220 := RANK() OVER (PARTITION BY $905, $904, $900, $901 ORDER BY $902 ASC, $903 ASC)" ] }, { "kind": "SORT", "substeps": [ "$495 ASC, $494 ASC, $490 ASC, $491 ASC, $492 ASC, $493 ASC" ] }, { "kind": "JOIN", "substeps": [ "$990 := $510, $991 := $511, $992 := $512, $993 := $513, $994 := $514, $995 := $515, $996 := $516, $997 := $517, $998 := $520", "INNER HASH JOIN EACH WITH ALL ON $350 = $370, $351 = $371, $352 = $372, $353 = $373, $354 = $374, $355 = $375, $356 = $376, $357 = $377, $358 = $378, ..." ] }, { "kind": "COMPUTE", "substeps": [ "$350 := coalesce($515, '')", "$351 := coalesce($515, '0')", "$352 := coalesce($514, '')", "$353 := coalesce($514, '0')", "$354 := coalesce($510, '')", "$355 := coalesce($510, '0')", "$356 := coalesce($511, '')", "$357 := coalesce($511, '0')", "$358 := coalesce($512, 0)", "$359 := coalesce($512, 1)", "$360 := coalesce($513, 0)", "$361 := coalesce($513, 1)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "TO __stage24_output" ] } ], "waitMsAvg": "11", "waitMsMax": "20", "waitRatioAvg": 0.015193370165745856, "waitRatioMax": 0.027624309392265192, "writeMsAvg": "3", "writeMsMax": "18", "writeRatioAvg": 0.004143646408839779, "writeRatioMax": 0.024861878453038673 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.020718232044198894, "computeRatioMax": 0.020718232044198894, "endMs": "1665777688208", "id": "37", "inputStages": [ "36" ], "name": "S25: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10000", "recordsWritten": "100", "shuffleOutputBytes": "13917", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665777688013", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330", "FROM __stage24_output" ] }, { "kind": "SORT", "substeps": [ "$1320 ASC, $1321 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$1340, $1341, $1342, $1343, $1344, $1345, $1346, $1347, $1348, $1349", "TO __stage25_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.015193370165745856, "waitRatioMax": 0.015193370165745856, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.006906077348066298, "writeRatioMax": 0.006906077348066298 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "8", "completedUnits": "20", "elapsedMs": "620", "estimatedRunnableUnits": "0", "pendingUnits": "7", "totalSlotMs": "5714" }, { "activeUnits": "0", "completedUnits": "1039", "elapsedMs": "1647", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "60529" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113426519", "totalPartitionsProcessed": "0", "totalSlotMs": "60529", "transferredBytes": "0" }, "startTime": "1665777686647", "totalBytesProcessed": "113426519", "totalSlotMs": "60529" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
