{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3b6d8a11_487a_4a86_ad33_fc23a60d6c56" }, "priority": "INTERACTIVE", "query": "-- start query 74 in stream 0 using template query74.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ss_net_paid) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ws_net_paid) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n )\n select\n t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.year = 2001\n and t_s_secyear.year = 2001+1\n and t_w_firstyear.year = 2001\n and t_w_secyear.year = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 1,1,1\n limit 100\n;\n\n-- end query 74 in stream 0 using template query74.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "jF7Z+D8tr/Ohi740hHm1KQ==", "id": "test-project-364309:europe-west1.query74_1665768460", "jobReference": { "jobId": "query74_1665768460", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query74_1665768460?location=europe-west1", "statistics": { "creationTime": "1665768461043", "endTime": "1665768462624", "finalExecutionDurationMs": "1322", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116347975", "performanceInsights": { "avgPreviousExecutionMs": "1279" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01585014409221902, "computeRatioMax": 0.01585014409221902, "endMs": "1665768461268", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011527377521613832, "readRatioMax": 0.011527377521613832, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768461220", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE and(in($111, 2001, 2002), equal($111, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02881844380403458, "writeRatioMax": 0.02881844380403458 }, { "completedParallelInputs": "1", "computeMsAvg": "100", "computeMsMax": "100", "computeRatioAvg": 0.1440922190201729, "computeRatioMax": 0.1440922190201729, "endMs": "1665768461378", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.01729106628242075, "readRatioMax": 0.01729106628242075, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "137", "startMs": "1665768461267", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.040345821325648415, "writeRatioMax": 0.040345821325648415 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.020172910662824207, "computeRatioMax": 0.020172910662824207, "endMs": "1665768461327", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.012968299711815562, "readRatioMax": 0.012968299711815562, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768461287", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE and(in($81, 2001, 2002), equal($81, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004322766570605188, "waitRatioMax": 0.004322766570605188, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01440922190201729, "writeRatioMax": 0.01440922190201729 }, { "completedParallelInputs": "1", "computeMsAvg": "142", "computeMsMax": "142", "computeRatioAvg": 0.20461095100864554, "computeRatioMax": 0.20461095100864554, "endMs": "1665768461465", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.018731988472622477, "readRatioMax": 0.018731988472622477, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "121", "startMs": "1665768461336", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.01729106628242075, "writeRatioMax": 0.01729106628242075 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.010086455331412104, "computeRatioMax": 0.010086455331412104, "endMs": "1665768461403", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011527377521613832, "readRatioMax": 0.011527377521613832, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768461367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE and(in($51, 2001, 2002), equal($51, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02881844380403458, "writeRatioMax": 0.02881844380403458 }, { "completedParallelInputs": "1", "computeMsAvg": "104", "computeMsMax": "104", "computeRatioAvg": 0.14985590778097982, "computeRatioMax": 0.14985590778097982, "endMs": "1665768461505", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011527377521613832, "readRatioMax": 0.011527377521613832, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665768461404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01585014409221902, "writeRatioMax": 0.01585014409221902 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012968299711815562, "computeRatioMax": 0.012968299711815562, "endMs": "1665768461468", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010086455331412104, "readRatioMax": 0.010086455331412104, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768461424", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE and(in($21, 2001, 2002), equal($21, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.023054755043227664, "writeRatioMax": 0.023054755043227664 }, { "completedParallelInputs": "1", "computeMsAvg": "191", "computeMsMax": "191", "computeRatioAvg": 0.27521613832853026, "computeRatioMax": 0.27521613832853026, "endMs": "1665768461653", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.027377521613832854, "readRatioMax": 0.027377521613832854, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "233", "startMs": "1665768461465", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.027377521613832854, "writeRatioMax": 0.027377521613832854 }, { "completedParallelInputs": "6", "computeMsAvg": "575", "computeMsMax": "694", "computeRatioAvg": 0.8285302593659942, "computeRatioMax": 1, "endMs": "1665768461902", "id": "12", "inputStages": [ "0", "2" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "26", "readRatioAvg": 0.027377521613832854, "readRatioMax": 0.037463976945244955, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "13690155", "shuffleOutputBytesSpilled": "0", "slotMs": "3056", "startMs": "1665768461473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214", "$190 := SUM($213)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $204, $214 := $111", "INNER HASH JOIN EACH WITH ALL ON $203 = $110" ] }, { "kind": "JOIN", "substeps": [ "$203 := $100, $204 := $102, $200 := $91, $201 := $92, $202 := $93", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $190", "TO __stage0C_output", "BY HASH($220, $221, $222, $223)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.004322766570605188, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.011527377521613832, "writeRatioMax": 0.01440922190201729 }, { "completedParallelInputs": "1", "computeMsAvg": "569", "computeMsMax": "569", "computeRatioAvg": 0.8198847262247838, "computeRatioMax": 0.8198847262247838, "endMs": "1665768461842", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.02881844380403458, "readRatioMax": 0.02881844380403458, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "788619", "shuffleOutputBytesSpilled": "0", "slotMs": "482", "startMs": "1665768461491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304", "$180 := SUM($303)" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $291, $302 := $292, $303 := $294, $304 := $81", "INNER HASH JOIN EACH WITH ALL ON $293 = $80" ] }, { "kind": "JOIN", "substeps": [ "$293 := $70, $294 := $72, $290 := $61, $291 := $62, $292 := $63", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $180", "TO __stage0D_output", "BY HASH($310, $311, $312, $313)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02881844380403458, "writeRatioMax": 0.02881844380403458 }, { "completedParallelInputs": "6", "computeMsAvg": "520", "computeMsMax": "584", "computeRatioAvg": 0.7492795389048992, "computeRatioMax": 0.8414985590778098, "endMs": "1665768461881", "id": "14", "inputStages": [ "6", "8" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.020172910662824207, "readRatioMax": 0.024495677233429394, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "13784786", "shuffleOutputBytesSpilled": "0", "slotMs": "2626", "startMs": "1665768461538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254", "$170 := SUM($253)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $244, $254 := $51", "INNER HASH JOIN EACH WITH ALL ON $243 = $50" ] }, { "kind": "JOIN", "substeps": [ "$243 := $40, $244 := $42, $240 := $31, $241 := $32, $242 := $33", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $170", "TO __stage0E_output", "BY HASH($260, $261, $262, $263)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001440922190201729, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.008645533141210375, "writeRatioMax": 0.012968299711815562 }, { "completedParallelInputs": "1", "computeMsAvg": "454", "computeMsMax": "454", "computeRatioAvg": 0.654178674351585, "computeRatioMax": 0.654178674351585, "endMs": "1665768461989", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.03170028818443804, "readRatioMax": 0.03170028818443804, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "768704", "shuffleOutputBytesSpilled": "0", "slotMs": "433", "startMs": "1665768461679", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354", "$150 := SUM($353)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $340, $351 := $341, $352 := $342, $353 := $344, $354 := $21", "INNER HASH JOIN EACH WITH ALL ON $343 = $20" ] }, { "kind": "JOIN", "substeps": [ "$343 := $10, $344 := $12, $340 := $2, $341 := $3, $342 := $4", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $150", "TO __stage0F_output", "BY HASH($360, $361, $362, $363)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.037463976945244955, "writeRatioMax": 0.037463976945244955 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.03602305475504323, "computeRatioMax": 0.03602305475504323, "endMs": "1665768462065", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768462013", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $370", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004322766570605188, "waitRatioMax": 0.004322766570605188, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.03025936599423631, "writeRatioMax": 0.03025936599423631 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.037463976945244955, "computeRatioMax": 0.037463976945244955, "endMs": "1665768462087", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768462032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $180", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313", "$140 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$140, $320", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001440922190201729, "waitRatioMax": 0.001440922190201729, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.03314121037463977, "writeRatioMax": 0.03314121037463977 }, { "completedParallelInputs": "1", "computeMsAvg": "272", "computeMsMax": "272", "computeRatioAvg": 0.3919308357348703, "computeRatioMax": 0.3919308357348703, "endMs": "1665768462225", "id": "18", "inputStages": [ "14" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2261938", "shuffleOutputBytesSpilled": "0", "slotMs": "240", "startMs": "1665768462051", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $170", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263", "$130 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$130, $270, $271, $272", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002881844380403458, "waitRatioMax": 0.002881844380403458, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.0345821325648415, "writeRatioMax": 0.0345821325648415 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.01440922190201729, "computeRatioMax": 0.025936599423631124, "endMs": "1665768462349", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2261938", "shuffleOutputBytesSpilled": "0", "slotMs": "6156", "startMs": "1665768462250", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.004322766570605188, "waitRatioMax": 0.010086455331412104, "writeMsAvg": "19", "writeMsMax": "51", "writeRatioAvg": 0.027377521613832854, "writeRatioMax": 0.07348703170028818 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.011527377521613832, "computeRatioMax": 0.024495677233429394, "endMs": "1665768462341", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "3744", "startMs": "1665768462251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "9", "waitMsMax": "12", "waitRatioAvg": 0.012968299711815562, "waitRatioMax": 0.01729106628242075, "writeMsAvg": "8", "writeMsMax": "28", "writeRatioAvg": 0.011527377521613832, "writeRatioMax": 0.040345821325648415 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.011527377521613832, "computeRatioMax": 0.023054755043227664, "endMs": "1665768462353", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "5233", "startMs": "1665768462252", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "12", "waitMsMax": "14", "waitRatioAvg": 0.01729106628242075, "waitRatioMax": 0.020172910662824207, "writeMsAvg": "4", "writeMsMax": "18", "writeRatioAvg": 0.005763688760806916, "writeRatioMax": 0.025936599423631124 }, { "completedParallelInputs": "1", "computeMsAvg": "200", "computeMsMax": "200", "computeRatioAvg": 0.2881844380403458, "computeRatioMax": 0.2881844380403458, "endMs": "1665768462469", "id": "23", "inputStages": [ "12", "21", "22", "20" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "221", "startMs": "1665768462272", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $190", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $270, $271, $272", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $320", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $370", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$380 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($384, NUMERIC<...>), divide($386, $384), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $330, $381 := $331, $382 := $332, $383 := $334, $384 := $336, $385 := $335, $386 := $120", "INNER HASH JOIN EACH WITH ALL ON $333 = $370" ] }, { "kind": "JOIN", "substeps": [ "$330 := $282, $331 := $283, $332 := $284, $333 := $280, $334 := $285, $335 := $281, $336 := $140", "INNER HASH JOIN EACH WITH ALL ON $280 = $320" ] }, { "kind": "JOIN", "substeps": [ "$280 := $230, $281 := $160, $282 := $270, $283 := $271, $284 := $272, $285 := $130", "INNER HASH JOIN EACH WITH ALL ON $230 = $270" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392", "TO __stage17_output" ] } ], "waitMsAvg": "18", "waitMsMax": "18", "waitRatioAvg": 0.025936599423631124, "waitRatioMax": 0.025936599423631124, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001440922190201729, "writeRatioMax": 0.001440922190201729 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01585014409221902, "computeRatioMax": 0.01585014409221902, "endMs": "1665768462487", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "111", "startMs": "1665768462277", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $391, $392", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402", "TO __stage18_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.007204610951008645, "waitRatioMax": 0.007204610951008645, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.007204610951008645, "writeRatioMax": 0.007204610951008645 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "624", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "2033" }, { "activeUnits": "0", "completedUnits": "327", "elapsedMs": "1469", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "23623" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116347975", "totalPartitionsProcessed": "0", "totalSlotMs": "23623", "transferredBytes": "0" }, "startTime": "1665768461096", "totalBytesProcessed": "116347975", "totalSlotMs": "23623" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0b87a22f_8704_4344_a6b8_dad5384e5b86" }, "priority": "INTERACTIVE", "query": "-- start query 74 in stream 0 using template query74.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ss_net_paid) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ws_net_paid) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n )\n select\n t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.year = 2001\n and t_s_secyear.year = 2001+1\n and t_w_firstyear.year = 2001\n and t_w_secyear.year = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 1,1,1\n limit 100\n;\n\n-- end query 74 in stream 0 using template query74.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/NuIRtVeDuSV7XwZ2Hx+XA==", "id": "test-project-364309:europe-west1.query74_1665778528", "jobReference": { "jobId": "query74_1665778528", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query74_1665778528?location=europe-west1", "statistics": { "creationTime": "1665778529532", "endTime": "1665778530903", "finalExecutionDurationMs": "1148", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116347975", "performanceInsights": { "avgPreviousExecutionMs": "1286" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.016455696202531647, "computeRatioMax": 0.016455696202531647, "endMs": "1665778529724", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.015189873417721518, "readRatioMax": 0.015189873417721518, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778529693", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE and(in($111, 2001, 2002), equal($111, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01139240506329114, "writeRatioMax": 0.01139240506329114 }, { "completedParallelInputs": "1", "computeMsAvg": "77", "computeMsMax": "77", "computeRatioAvg": 0.09746835443037975, "computeRatioMax": 0.09746835443037975, "endMs": "1665778529814", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "109", "startMs": "1665778529723", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.013924050632911392, "writeRatioMax": 0.013924050632911392 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01139240506329114, "computeRatioMax": 0.01139240506329114, "endMs": "1665778529828", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008860759493670886, "readRatioMax": 0.008860759493670886, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778529787", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE and(in($81, 2001, 2002), equal($81, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "50", "waitMsMax": "50", "waitRatioAvg": 0.06329113924050633, "waitRatioMax": 0.06329113924050633, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.017721518987341773, "writeRatioMax": 0.017721518987341773 }, { "completedParallelInputs": "1", "computeMsAvg": "125", "computeMsMax": "125", "computeRatioAvg": 0.15822784810126583, "computeRatioMax": 0.15822784810126583, "endMs": "1665778529900", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.013924050632911392, "readRatioMax": 0.013924050632911392, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "161", "startMs": "1665778529787", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage05_output" ] } ], "waitMsAvg": "22", "waitMsMax": "22", "waitRatioAvg": 0.027848101265822784, "waitRatioMax": 0.027848101265822784, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.013924050632911392, "writeRatioMax": 0.013924050632911392 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012658227848101266, "computeRatioMax": 0.012658227848101266, "endMs": "1665778529823", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008860759493670886, "readRatioMax": 0.008860759493670886, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778529788", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE and(in($51, 2001, 2002), equal($51, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.008860759493670886, "waitRatioMax": 0.008860759493670886, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02531645569620253, "writeRatioMax": 0.02531645569620253 }, { "completedParallelInputs": "1", "computeMsAvg": "130", "computeMsMax": "130", "computeRatioAvg": 0.16455696202531644, "computeRatioMax": 0.16455696202531644, "endMs": "1665778529924", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.013924050632911392, "readRatioMax": 0.013924050632911392, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "148", "startMs": "1665778529808", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0189873417721519, "writeRatioMax": 0.0189873417721519 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012658227848101266, "computeRatioMax": 0.012658227848101266, "endMs": "1665778529860", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008860759493670886, "readRatioMax": 0.008860759493670886, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778529824", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE and(in($21, 2001, 2002), equal($21, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.010126582278481013, "writeRatioMax": 0.010126582278481013 }, { "completedParallelInputs": "1", "computeMsAvg": "133", "computeMsMax": "133", "computeRatioAvg": 0.16835443037974684, "computeRatioMax": 0.16835443037974684, "endMs": "1665778529963", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "150", "startMs": "1665778529853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.013924050632911392, "writeRatioMax": 0.013924050632911392 }, { "completedParallelInputs": "6", "computeMsAvg": "657", "computeMsMax": "790", "computeRatioAvg": 0.8316455696202532, "computeRatioMax": 1, "endMs": "1665778530389", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "26", "readRatioAvg": 0.024050632911392405, "readRatioMax": 0.03291139240506329, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "13690155", "shuffleOutputBytesSpilled": "0", "slotMs": "3756", "startMs": "1665778529858", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214", "$190 := SUM($213)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $204, $214 := $111", "INNER HASH JOIN EACH WITH ALL ON $203 = $110" ] }, { "kind": "JOIN", "substeps": [ "$203 := $100, $204 := $102, $200 := $91, $201 := $92, $202 := $93", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $190", "TO __stage0C_output", "BY HASH($220, $221, $222, $223)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "12", "writeMsMax": "30", "writeRatioAvg": 0.015189873417721518, "writeRatioMax": 0.0379746835443038 }, { "completedParallelInputs": "1", "computeMsAvg": "354", "computeMsMax": "354", "computeRatioAvg": 0.4481012658227848, "computeRatioMax": 0.4481012658227848, "endMs": "1665778530197", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.020253164556962026, "readRatioMax": 0.020253164556962026, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "788619", "shuffleOutputBytesSpilled": "0", "slotMs": "353", "startMs": "1665778529944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304", "$180 := SUM($303)" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $291, $302 := $292, $303 := $294, $304 := $81", "INNER HASH JOIN EACH WITH ALL ON $293 = $80" ] }, { "kind": "JOIN", "substeps": [ "$293 := $70, $294 := $72, $290 := $61, $291 := $62, $292 := $63", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $180", "TO __stage0D_output", "BY HASH($310, $311, $312, $313)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02531645569620253, "writeRatioMax": 0.02531645569620253 }, { "completedParallelInputs": "6", "computeMsAvg": "525", "computeMsMax": "632", "computeRatioAvg": 0.6645569620253164, "computeRatioMax": 0.8, "endMs": "1665778530351", "id": "14", "inputStages": [ "8", "6" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "20", "readRatioAvg": 0.0189873417721519, "readRatioMax": 0.02531645569620253, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "13784786", "shuffleOutputBytesSpilled": "0", "slotMs": "2683", "startMs": "1665778529973", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254", "$170 := SUM($253)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $244, $254 := $51", "INNER HASH JOIN EACH WITH ALL ON $243 = $50" ] }, { "kind": "JOIN", "substeps": [ "$243 := $40, $244 := $42, $240 := $31, $241 := $32, $242 := $33", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $170", "TO __stage0E_output", "BY HASH($260, $261, $262, $263)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "12", "writeMsMax": "42", "writeRatioAvg": 0.015189873417721518, "writeRatioMax": 0.053164556962025315 }, { "completedParallelInputs": "1", "computeMsAvg": "505", "computeMsMax": "505", "computeRatioAvg": 0.6392405063291139, "computeRatioMax": 0.6392405063291139, "endMs": "1665778530308", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.017721518987341773, "readRatioMax": 0.017721518987341773, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "768704", "shuffleOutputBytesSpilled": "0", "slotMs": "569", "startMs": "1665778529987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354", "$150 := SUM($353)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $340, $351 := $341, $352 := $342, $353 := $344, $354 := $21", "INNER HASH JOIN EACH WITH ALL ON $343 = $20" ] }, { "kind": "JOIN", "substeps": [ "$343 := $10, $344 := $12, $340 := $2, $341 := $3, $342 := $4", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $150", "TO __stage0F_output", "BY HASH($360, $361, $362, $363)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.030379746835443037, "writeRatioMax": 0.030379746835443037 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.02531645569620253, "computeRatioMax": 0.02531645569620253, "endMs": "1665778530470", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665778530417", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $370", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.03291139240506329, "writeRatioMax": 0.03291139240506329 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.026582278481012658, "computeRatioMax": 0.026582278481012658, "endMs": "1665778530471", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778530432", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $180", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313", "$140 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$140, $320", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.030379746835443037, "writeRatioMax": 0.030379746835443037 }, { "completedParallelInputs": "1", "computeMsAvg": "145", "computeMsMax": "145", "computeRatioAvg": 0.18354430379746836, "computeRatioMax": 0.18354430379746836, "endMs": "1665778530570", "id": "19", "inputStages": [ "12" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "144", "startMs": "1665778530461", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $190", "FROM __stage0C_output" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $230", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.024050632911392405, "writeRatioMax": 0.024050632911392405 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.010126582278481013, "computeRatioMax": 0.021518987341772152, "endMs": "1665778530635", "id": "20", "inputStages": [ "19" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "3752", "startMs": "1665778530582", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.0037974683544303796, "waitRatioMax": 0.007594936708860759, "writeMsAvg": "15", "writeMsMax": "22", "writeRatioAvg": 0.0189873417721519, "writeRatioMax": 0.027848101265822784 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.008860759493670886, "computeRatioMax": 0.020253164556962026, "endMs": "1665778530635", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "2797", "startMs": "1665778530583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.008860759493670886, "waitRatioMax": 0.010126582278481013, "writeMsAvg": "12", "writeMsMax": "20", "writeRatioAvg": 0.015189873417721518, "writeRatioMax": 0.02531645569620253 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.008860759493670886, "computeRatioMax": 0.020253164556962026, "endMs": "1665778530634", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "2893", "startMs": "1665778530583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.008860759493670886, "waitRatioMax": 0.01139240506329114, "writeMsAvg": "8", "writeMsMax": "19", "writeRatioAvg": 0.010126582278481013, "writeRatioMax": 0.024050632911392405 }, { "completedParallelInputs": "1", "computeMsAvg": "222", "computeMsMax": "222", "computeRatioAvg": 0.2810126582278481, "computeRatioMax": 0.2810126582278481, "endMs": "1665778530789", "id": "23", "inputStages": [ "20", "21", "22", "14" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "262866", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665778530603", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $170", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$160, $230", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $320", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $370", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$380 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($384, NUMERIC<...>), divide($386, $384), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $330, $381 := $331, $382 := $332, $383 := $334, $384 := $336, $385 := $335, $386 := $120", "INNER HASH JOIN EACH WITH ALL ON $333 = $370" ] }, { "kind": "JOIN", "substeps": [ "$330 := $282, $331 := $283, $332 := $284, $333 := $280, $334 := $285, $335 := $281, $336 := $140", "INNER HASH JOIN EACH WITH ALL ON $280 = $320" ] }, { "kind": "JOIN", "substeps": [ "$282 := $270, $283 := $271, $284 := $272, $285 := $130, $280 := $230, $281 := $160", "INNER HASH JOIN EACH WITH ALL ON $270 = $230" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263", "$130 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392", "TO __stage17_output" ] } ], "waitMsAvg": "22", "waitMsMax": "22", "waitRatioAvg": 0.027848101265822784, "waitRatioMax": 0.027848101265822784, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0012658227848101266, "writeRatioMax": 0.0012658227848101266 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.017721518987341773, "computeRatioMax": 0.017721518987341773, "endMs": "1665778530804", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "194", "startMs": "1665778530604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $391, $392", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402", "TO __stage18_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.007594936708860759, "waitRatioMax": 0.007594936708860759, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.010126582278481013, "writeRatioMax": 0.010126582278481013 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "2273" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1260", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "18693" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116347975", "totalPartitionsProcessed": "0", "totalSlotMs": "18693", "transferredBytes": "0" }, "startTime": "1665778529590", "totalBytesProcessed": "116347975", "totalSlotMs": "18693" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone71da178_cd7c_4b0a_b691_6cfff8568349" }, "priority": "INTERACTIVE", "query": "-- start query 74 in stream 0 using template query74.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ss_net_paid) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ws_net_paid) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n )\n select\n t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.year = 2001\n and t_s_secyear.year = 2001+1\n and t_w_firstyear.year = 2001\n and t_w_secyear.year = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 1,1,1\n limit 100\n;\n\n-- end query 74 in stream 0 using template query74.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "6h5gqx3HC5vw1DGYpEpgUg==", "id": "test-project-364309:europe-west1.query74_1665778532", "jobReference": { "jobId": "query74_1665778532", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query74_1665778532?location=europe-west1", "statistics": { "creationTime": "1665778533498", "endTime": "1665778535038", "finalExecutionDurationMs": "1335", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116347975", "performanceInsights": { "avgPreviousExecutionMs": "1266" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.013064133016627079, "computeRatioMax": 0.013064133016627079, "endMs": "1665778533685", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00831353919239905, "readRatioMax": 0.00831353919239905, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778533646", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE and(in($111, 2001, 2002), equal($111, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.015439429928741092, "writeRatioMax": 0.015439429928741092 }, { "completedParallelInputs": "1", "computeMsAvg": "82", "computeMsMax": "82", "computeRatioAvg": 0.09738717339667459, "computeRatioMax": 0.09738717339667459, "endMs": "1665778533742", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.010688836104513063, "readRatioMax": 0.010688836104513063, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "95", "startMs": "1665778533668", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.011876484560570071, "writeRatioMax": 0.011876484560570071 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009501187648456057, "computeRatioMax": 0.009501187648456057, "endMs": "1665778533721", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00831353919239905, "readRatioMax": 0.00831353919239905, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778533683", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE and(in($81, 2001, 2002), equal($81, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.009501187648456057, "writeRatioMax": 0.009501187648456057 }, { "completedParallelInputs": "1", "computeMsAvg": "81", "computeMsMax": "81", "computeRatioAvg": 0.09619952494061758, "computeRatioMax": 0.09619952494061758, "endMs": "1665778533844", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007125890736342043, "readRatioMax": 0.007125890736342043, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665778533743", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage05_output" ] } ], "waitMsAvg": "24", "waitMsMax": "24", "waitRatioAvg": 0.028503562945368172, "waitRatioMax": 0.028503562945368172, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.04631828978622328, "writeRatioMax": 0.04631828978622328 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009501187648456057, "computeRatioMax": 0.009501187648456057, "endMs": "1665778533861", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00831353919239905, "readRatioMax": 0.00831353919239905, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778533803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE and(in($51, 2001, 2002), equal($51, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "71", "waitMsMax": "71", "waitRatioAvg": 0.08432304038004751, "waitRatioMax": 0.08432304038004751, "writeMsAvg": "44", "writeMsMax": "44", "writeRatioAvg": 0.052256532066508314, "writeRatioMax": 0.052256532066508314 }, { "completedParallelInputs": "1", "computeMsAvg": "84", "computeMsMax": "84", "computeRatioAvg": 0.0997624703087886, "computeRatioMax": 0.0997624703087886, "endMs": "1665778533903", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.010688836104513063, "readRatioMax": 0.010688836104513063, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "115", "startMs": "1665778533804", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "44", "waitMsMax": "44", "waitRatioAvg": 0.052256532066508314, "waitRatioMax": 0.052256532066508314, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.023752969121140142, "writeRatioMax": 0.023752969121140142 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011876484560570071, "computeRatioMax": 0.011876484560570071, "endMs": "1665778533843", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0059382422802850355, "readRatioMax": 0.0059382422802850355, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778533804", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE and(in($21, 2001, 2002), equal($21, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "31", "waitMsMax": "31", "waitRatioAvg": 0.03681710213776722, "waitRatioMax": 0.03681710213776722, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0166270783847981, "writeRatioMax": 0.0166270783847981 }, { "completedParallelInputs": "1", "computeMsAvg": "114", "computeMsMax": "114", "computeRatioAvg": 0.13539192399049882, "computeRatioMax": 0.13539192399049882, "endMs": "1665778533913", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.011876484560570071, "readRatioMax": 0.011876484560570071, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665778533804", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.015439429928741092, "writeRatioMax": 0.015439429928741092 }, { "completedParallelInputs": "6", "computeMsAvg": "515", "computeMsMax": "623", "computeRatioAvg": 0.6116389548693587, "computeRatioMax": 0.7399049881235155, "endMs": "1665778534163", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.0166270783847981, "readRatioMax": 0.020190023752969122, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "13690155", "shuffleOutputBytesSpilled": "0", "slotMs": "2896", "startMs": "1665778533807", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214", "$190 := SUM($213)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $204, $214 := $111", "INNER HASH JOIN EACH WITH ALL ON $203 = $110" ] }, { "kind": "JOIN", "substeps": [ "$203 := $100, $204 := $102, $200 := $91, $201 := $92, $202 := $93", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $190", "TO __stage0C_output", "BY HASH($220, $221, $222, $223)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.00831353919239905, "writeRatioMax": 0.010688836104513063 }, { "completedParallelInputs": "1", "computeMsAvg": "415", "computeMsMax": "415", "computeRatioAvg": 0.49287410926365793, "computeRatioMax": 0.49287410926365793, "endMs": "1665778534151", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.02494061757719715, "readRatioMax": 0.02494061757719715, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "788619", "shuffleOutputBytesSpilled": "0", "slotMs": "431", "startMs": "1665778533861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304", "$180 := SUM($303)" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $291, $302 := $292, $303 := $294, $304 := $81", "INNER HASH JOIN EACH WITH ALL ON $293 = $80" ] }, { "kind": "JOIN", "substeps": [ "$293 := $70, $294 := $72, $290 := $61, $291 := $62, $292 := $63", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $180", "TO __stage0D_output", "BY HASH($310, $311, $312, $313)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.022565320665083134, "writeRatioMax": 0.022565320665083134 }, { "completedParallelInputs": "6", "computeMsAvg": "594", "computeMsMax": "842", "computeRatioAvg": 0.7054631828978623, "computeRatioMax": 1, "endMs": "1665778534411", "id": "14", "inputStages": [ "6", "8" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "23", "readRatioAvg": 0.02494061757719715, "readRatioMax": 0.027315914489311165, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "13784786", "shuffleOutputBytesSpilled": "0", "slotMs": "3712", "startMs": "1665778533919", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254", "$170 := SUM($253)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $244, $254 := $51", "INNER HASH JOIN EACH WITH ALL ON $243 = $50" ] }, { "kind": "JOIN", "substeps": [ "$243 := $40, $244 := $42, $240 := $31, $241 := $32, $242 := $33", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $170", "TO __stage0E_output", "BY HASH($260, $261, $262, $263)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "9", "writeMsMax": "14", "writeRatioAvg": 0.010688836104513063, "writeRatioMax": 0.0166270783847981 }, { "completedParallelInputs": "1", "computeMsAvg": "489", "computeMsMax": "489", "computeRatioAvg": 0.5807600950118765, "computeRatioMax": 0.5807600950118765, "endMs": "1665778534221", "id": "15", "inputStages": [ "9", "11" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.017814726840855107, "readRatioMax": 0.017814726840855107, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "768704", "shuffleOutputBytesSpilled": "0", "slotMs": "489", "startMs": "1665778533931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354", "$150 := SUM($353)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $340, $351 := $341, $352 := $342, $353 := $344, $354 := $21", "INNER HASH JOIN EACH WITH ALL ON $343 = $20" ] }, { "kind": "JOIN", "substeps": [ "$343 := $10, $344 := $12, $340 := $2, $341 := $3, $342 := $4", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $150", "TO __stage0F_output", "BY HASH($360, $361, $362, $363)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.023752969121140142, "writeRatioMax": 0.023752969121140142 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.03681710213776722, "computeRatioMax": 0.03681710213776722, "endMs": "1665778534493", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665778534442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $370", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.02494061757719715, "writeRatioMax": 0.02494061757719715 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.027315914489311165, "computeRatioMax": 0.027315914489311165, "endMs": "1665778534505", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778534456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $180", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313", "$140 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$140, $320", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.023752969121140142, "writeRatioMax": 0.023752969121140142 }, { "completedParallelInputs": "1", "computeMsAvg": "298", "computeMsMax": "298", "computeRatioAvg": 0.35391923990498814, "computeRatioMax": 0.35391923990498814, "endMs": "1665778534653", "id": "19", "inputStages": [ "12" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "243", "startMs": "1665778534487", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $190", "FROM __stage0C_output" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $230", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011876484560570072, "waitRatioMax": 0.0011876484560570072, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.02494061757719715, "writeRatioMax": 0.02494061757719715 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.010688836104513063, "computeRatioMax": 0.027315914489311165, "endMs": "1665778534742", "id": "20", "inputStages": [ "19" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "4033", "startMs": "1665778534688", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0023752969121140144, "waitRatioMax": 0.004750593824228029, "writeMsAvg": "17", "writeMsMax": "28", "writeRatioAvg": 0.020190023752969122, "writeRatioMax": 0.0332541567695962 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.00831353919239905, "computeRatioMax": 0.015439429928741092, "endMs": "1665778534740", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "3135", "startMs": "1665778534689", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.004750593824228029, "waitRatioMax": 0.0059382422802850355, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.017814726840855107, "writeRatioMax": 0.032066508313539195 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.00831353919239905, "computeRatioMax": 0.014251781472684086, "endMs": "1665778534739", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3097", "startMs": "1665778534690", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.0059382422802850355, "waitRatioMax": 0.007125890736342043, "writeMsAvg": "8", "writeMsMax": "19", "writeRatioAvg": 0.009501187648456057, "writeRatioMax": 0.022565320665083134 }, { "completedParallelInputs": "1", "computeMsAvg": "258", "computeMsMax": "258", "computeRatioAvg": 0.30641330166270786, "computeRatioMax": 0.30641330166270786, "endMs": "1665778534916", "id": "23", "inputStages": [ "20", "22", "21", "14" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "262866", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "261", "startMs": "1665778534703", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $170", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$160, $230", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $320", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $370", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$380 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($384, NUMERIC<...>), divide($386, $384), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $330, $381 := $331, $382 := $332, $383 := $334, $384 := $336, $385 := $335, $386 := $120", "INNER HASH JOIN EACH WITH ALL ON $333 = $370" ] }, { "kind": "JOIN", "substeps": [ "$330 := $282, $331 := $283, $332 := $284, $333 := $280, $334 := $285, $335 := $281, $336 := $140", "INNER HASH JOIN EACH WITH ALL ON $280 = $320" ] }, { "kind": "JOIN", "substeps": [ "$282 := $270, $283 := $271, $284 := $272, $285 := $130, $280 := $230, $281 := $160", "INNER HASH JOIN EACH WITH ALL ON $270 = $230" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263", "$130 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392", "TO __stage17_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.010688836104513063, "waitRatioMax": 0.010688836104513063, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0023752969121140144, "writeRatioMax": 0.0023752969121140144 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.013064133016627079, "computeRatioMax": 0.013064133016627079, "endMs": "1665778534935", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "340", "startMs": "1665778534706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $391, $392", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402", "TO __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0035629453681710215, "waitRatioMax": 0.0035629453681710215, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.004750593824228029, "writeRatioMax": 0.004750593824228029 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "12", "completedUnits": "12", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "10", "totalSlotMs": "3942" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1445", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "19913" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116347975", "totalPartitionsProcessed": "0", "totalSlotMs": "19913", "transferredBytes": "0" }, "startTime": "1665778533544", "totalBytesProcessed": "116347975", "totalSlotMs": "19913" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1277d753_1931_415d_a7e3_93af37bbc12b" }, "priority": "INTERACTIVE", "query": "-- start query 74 in stream 0 using template query74.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ss_net_paid) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ws_net_paid) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n )\n select\n t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.year = 2001\n and t_s_secyear.year = 2001+1\n and t_w_firstyear.year = 2001\n and t_w_secyear.year = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 1,1,1\n limit 100\n;\n\n-- end query 74 in stream 0 using template query74.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "bkF683xSAceeVV/8VU4CYg==", "id": "test-project-364309:europe-west1.query74_1665778536", "jobReference": { "jobId": "query74_1665778536", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query74_1665778536?location=europe-west1", "statistics": { "creationTime": "1665778537486", "endTime": "1665778539024", "finalExecutionDurationMs": "1332", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116347975", "performanceInsights": { "avgPreviousExecutionMs": "1275" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010169491525423728, "computeRatioMax": 0.010169491525423728, "endMs": "1665778537670", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005649717514124294, "readRatioMax": 0.005649717514124294, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778537632", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE and(in($111, 2001, 2002), equal($111, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.014689265536723164, "writeRatioMax": 0.014689265536723164 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.12316384180790961, "computeRatioMax": 0.12316384180790961, "endMs": "1665778537779", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.014689265536723164, "readRatioMax": 0.014689265536723164, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "151", "startMs": "1665778537664", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.013559322033898305, "writeRatioMax": 0.013559322033898305 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010169491525423728, "computeRatioMax": 0.010169491525423728, "endMs": "1665778537818", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006779661016949152, "readRatioMax": 0.006779661016949152, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778537780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE and(in($81, 2001, 2002), equal($81, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "96", "waitMsMax": "96", "waitRatioAvg": 0.10847457627118644, "waitRatioMax": 0.10847457627118644, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.013559322033898305, "writeRatioMax": 0.013559322033898305 }, { "completedParallelInputs": "1", "computeMsAvg": "138", "computeMsMax": "138", "computeRatioAvg": 0.15593220338983052, "computeRatioMax": 0.15593220338983052, "endMs": "1665778537929", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.012429378531073447, "readRatioMax": 0.012429378531073447, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "176", "startMs": "1665778537815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage05_output" ] } ], "waitMsAvg": "95", "waitMsMax": "95", "waitRatioAvg": 0.10734463276836158, "waitRatioMax": 0.10734463276836158, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.012429378531073447, "writeRatioMax": 0.012429378531073447 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013559322033898305, "computeRatioMax": 0.013559322033898305, "endMs": "1665778537861", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.00903954802259887, "readRatioMax": 0.00903954802259887, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665778537816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE and(in($51, 2001, 2002), equal($51, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "80", "waitMsMax": "80", "waitRatioAvg": 0.0903954802259887, "waitRatioMax": 0.0903954802259887, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01807909604519774, "writeRatioMax": 0.01807909604519774 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.11073446327683616, "computeRatioMax": 0.11073446327683616, "endMs": "1665778537903", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.011299435028248588, "readRatioMax": 0.011299435028248588, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "151", "startMs": "1665778537816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "49", "waitMsMax": "49", "waitRatioAvg": 0.05536723163841808, "waitRatioMax": 0.05536723163841808, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.015819209039548022, "writeRatioMax": 0.015819209039548022 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011299435028248588, "computeRatioMax": 0.011299435028248588, "endMs": "1665778537857", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006779661016949152, "readRatioMax": 0.006779661016949152, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665778537816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE and(in($21, 2001, 2002), equal($21, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "35", "waitMsMax": "35", "waitRatioAvg": 0.03954802259887006, "waitRatioMax": 0.03954802259887006, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.015819209039548022, "writeRatioMax": 0.015819209039548022 }, { "completedParallelInputs": "1", "computeMsAvg": "105", "computeMsMax": "105", "computeRatioAvg": 0.11864406779661017, "computeRatioMax": 0.11864406779661017, "endMs": "1665778537909", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.012429378531073447, "readRatioMax": 0.012429378531073447, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "147", "startMs": "1665778537816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.013559322033898305, "writeRatioMax": 0.013559322033898305 }, { "completedParallelInputs": "6", "computeMsAvg": "570", "computeMsMax": "696", "computeRatioAvg": 0.6440677966101694, "computeRatioMax": 0.7864406779661017, "endMs": "1665778538252", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "25", "readRatioAvg": 0.021468926553672316, "readRatioMax": 0.02824858757062147, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "13690155", "shuffleOutputBytesSpilled": "0", "slotMs": "3842", "startMs": "1665778537818", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214", "$190 := SUM($213)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $204, $214 := $111", "INNER HASH JOIN EACH WITH ALL ON $203 = $110" ] }, { "kind": "JOIN", "substeps": [ "$203 := $100, $204 := $102, $200 := $91, $201 := $92, $202 := $93", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $190", "TO __stage0C_output", "BY HASH($220, $221, $222, $223)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "9", "writeMsMax": "13", "writeRatioAvg": 0.010169491525423728, "writeRatioMax": 0.014689265536723164 }, { "completedParallelInputs": "6", "computeMsAvg": "646", "computeMsMax": "885", "computeRatioAvg": 0.7299435028248588, "computeRatioMax": 1, "endMs": "1665778538422", "id": "13", "inputStages": [ "8", "6" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "19", "readRatioAvg": 0.01694915254237288, "readRatioMax": 0.021468926553672316, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "13784786", "shuffleOutputBytesSpilled": "0", "slotMs": "3587", "startMs": "1665778537916", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254", "$170 := SUM($253)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $244, $254 := $51", "INNER HASH JOIN EACH WITH ALL ON $243 = $50" ] }, { "kind": "JOIN", "substeps": [ "$243 := $40, $244 := $42, $240 := $31, $241 := $32, $242 := $33", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $170", "TO __stage0D_output", "BY HASH($260, $261, $262, $263)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.007909604519774011, "writeRatioMax": 0.00903954802259887 }, { "completedParallelInputs": "1", "computeMsAvg": "452", "computeMsMax": "452", "computeRatioAvg": 0.5107344632768361, "computeRatioMax": 0.5107344632768361, "endMs": "1665778538229", "id": "14", "inputStages": [ "9", "11" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.020338983050847456, "readRatioMax": 0.020338983050847456, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "768704", "shuffleOutputBytesSpilled": "0", "slotMs": "489", "startMs": "1665778537943", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354", "$150 := SUM($353)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $340, $351 := $341, $352 := $342, $353 := $344, $354 := $21", "INNER HASH JOIN EACH WITH ALL ON $343 = $20" ] }, { "kind": "JOIN", "substeps": [ "$343 := $10, $344 := $12, $340 := $2, $341 := $3, $342 := $4", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $150", "TO __stage0E_output", "BY HASH($360, $361, $362, $363)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.023728813559322035, "writeRatioMax": 0.023728813559322035 }, { "completedParallelInputs": "1", "computeMsAvg": "503", "computeMsMax": "503", "computeRatioAvg": 0.5683615819209039, "computeRatioMax": 0.5683615819209039, "endMs": "1665778538285", "id": "15", "inputStages": [ "3", "5" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.022598870056497175, "readRatioMax": 0.022598870056497175, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "788619", "shuffleOutputBytesSpilled": "0", "slotMs": "530", "startMs": "1665778537972", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304", "$180 := SUM($303)" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $291, $302 := $292, $303 := $294, $304 := $81", "INNER HASH JOIN EACH WITH ALL ON $293 = $80" ] }, { "kind": "JOIN", "substeps": [ "$293 := $70, $294 := $72, $290 := $61, $291 := $62, $292 := $63", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $180", "TO __stage0F_output", "BY HASH($310, $311, $312, $313)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.023728813559322035, "writeRatioMax": 0.023728813559322035 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.02824858757062147, "computeRatioMax": 0.02824858757062147, "endMs": "1665778538500", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778538453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $150", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $370", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.020338983050847456, "writeRatioMax": 0.020338983050847456 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.03615819209039548, "computeRatioMax": 0.03615819209039548, "endMs": "1665778538511", "id": "17", "inputStages": [ "15" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665778538466", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $180", "FROM __stage0F_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313", "$140 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$140, $320", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.020338983050847456, "writeRatioMax": 0.020338983050847456 }, { "completedParallelInputs": "1", "computeMsAvg": "274", "computeMsMax": "274", "computeRatioAvg": 0.3096045197740113, "computeRatioMax": 0.3096045197740113, "endMs": "1665778538638", "id": "18", "inputStages": [ "13" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2261938", "shuffleOutputBytesSpilled": "0", "slotMs": "299", "startMs": "1665778538480", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $170", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263", "$130 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$130, $270, $271, $272", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011299435028248588, "waitRatioMax": 0.0011299435028248588, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.022598870056497175, "writeRatioMax": 0.022598870056497175 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.00903954802259887, "computeRatioMax": 0.01694915254237288, "endMs": "1665778538723", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2261938", "shuffleOutputBytesSpilled": "0", "slotMs": "4199", "startMs": "1665778538670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.0022598870056497176, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.020338983050847456 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.007909604519774011, "computeRatioMax": 0.015819209039548022, "endMs": "1665778538723", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "3513", "startMs": "1665778538670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.004519774011299435, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.02824858757062147 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.007909604519774011, "computeRatioMax": 0.01807909604519774, "endMs": "1665778538720", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3151", "startMs": "1665778538670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.004519774011299435, "waitRatioMax": 0.006779661016949152, "writeMsAvg": "8", "writeMsMax": "18", "writeRatioAvg": 0.00903954802259887, "writeRatioMax": 0.020338983050847456 }, { "completedParallelInputs": "1", "computeMsAvg": "233", "computeMsMax": "233", "computeRatioAvg": 0.2632768361581921, "computeRatioMax": 0.2632768361581921, "endMs": "1665778538885", "id": "23", "inputStages": [ "21", "22", "12", "20" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "287", "startMs": "1665778538684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $190", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $270, $271, $272", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $320", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $370", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$380 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($384, NUMERIC<...>), divide($386, $384), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $330, $381 := $331, $382 := $332, $383 := $334, $384 := $336, $385 := $335, $386 := $120", "INNER HASH JOIN EACH WITH ALL ON $333 = $370" ] }, { "kind": "JOIN", "substeps": [ "$330 := $282, $331 := $283, $332 := $284, $333 := $280, $334 := $285, $335 := $281, $336 := $140", "INNER HASH JOIN EACH WITH ALL ON $280 = $320" ] }, { "kind": "JOIN", "substeps": [ "$280 := $230, $281 := $160, $282 := $270, $283 := $271, $284 := $272, $285 := $130", "INNER HASH JOIN EACH WITH ALL ON $230 = $270" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392", "TO __stage17_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.006779661016949152, "waitRatioMax": 0.006779661016949152, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0011299435028248588, "writeRatioMax": 0.0011299435028248588 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.004519774011299435, "computeRatioMax": 0.004519774011299435, "endMs": "1665778538900", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "190", "startMs": "1665778538689", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $391, $392", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0022598870056497176, "waitRatioMax": 0.0022598870056497176, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.003389830508474576, "writeRatioMax": 0.003389830508474576 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "601", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "2206" }, { "activeUnits": "13", "completedUnits": "327", "elapsedMs": "1439", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "20981" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116347975", "totalPartitionsProcessed": "0", "totalSlotMs": "20981", "transferredBytes": "0" }, "startTime": "1665778537533", "totalBytesProcessed": "116347975", "totalSlotMs": "20981" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon46e8aec3_a96b_4bdb_b14c_88be5a1df6de" }, "priority": "INTERACTIVE", "query": "-- start query 74 in stream 0 using template query74.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ss_net_paid) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ws_net_paid) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n )\n select\n t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.year = 2001\n and t_s_secyear.year = 2001+1\n and t_w_firstyear.year = 2001\n and t_w_secyear.year = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 1,1,1\n limit 100\n;\n\n-- end query 74 in stream 0 using template query74.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "k0rXY+eYAg8mPbvoVbX0Sw==", "id": "test-project-364309:europe-west1.query74_1665778540", "jobReference": { "jobId": "query74_1665778540", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query74_1665778540?location=europe-west1", "statistics": { "creationTime": "1665778541406", "endTime": "1665778542814", "finalExecutionDurationMs": "1200", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116347975", "performanceInsights": { "avgPreviousExecutionMs": "1281" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.018005540166204988, "computeRatioMax": 0.018005540166204988, "endMs": "1665778541644", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.013850415512465374, "readRatioMax": 0.013850415512465374, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665778541561", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE and(in($111, 2001, 2002), equal($111, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.018005540166204988, "writeRatioMax": 0.018005540166204988 }, { "completedParallelInputs": "1", "computeMsAvg": "88", "computeMsMax": "88", "computeRatioAvg": 0.12188365650969529, "computeRatioMax": 0.12188365650969529, "endMs": "1665778541717", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.013850415512465374, "readRatioMax": 0.013850415512465374, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "200", "startMs": "1665778541597", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013850415512465374, "waitRatioMax": 0.0013850415512465374, "writeMsAvg": "42", "writeMsMax": "42", "writeRatioAvg": 0.05817174515235457, "writeRatioMax": 0.05817174515235457 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.019390581717451522, "computeRatioMax": 0.019390581717451522, "endMs": "1665778541686", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0110803324099723, "readRatioMax": 0.0110803324099723, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778541642", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE and(in($81, 2001, 2002), equal($81, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.019390581717451522, "writeRatioMax": 0.019390581717451522 }, { "completedParallelInputs": "1", "computeMsAvg": "87", "computeMsMax": "87", "computeRatioAvg": 0.12049861495844875, "computeRatioMax": 0.12049861495844875, "endMs": "1665778541817", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008310249307479225, "readRatioMax": 0.008310249307479225, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "173", "startMs": "1665778541717", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage05_output" ] } ], "waitMsAvg": "36", "waitMsMax": "36", "waitRatioAvg": 0.04986149584487535, "waitRatioMax": 0.04986149584487535, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.012465373961218837, "writeRatioMax": 0.012465373961218837 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.015235457063711912, "computeRatioMax": 0.015235457063711912, "endMs": "1665778541816", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006925207756232687, "readRatioMax": 0.006925207756232687, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778541780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE and(in($51, 2001, 2002), equal($51, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "79", "waitMsMax": "79", "waitRatioAvg": 0.10941828254847645, "waitRatioMax": 0.10941828254847645, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.018005540166204988, "writeRatioMax": 0.018005540166204988 }, { "completedParallelInputs": "1", "computeMsAvg": "74", "computeMsMax": "74", "computeRatioAvg": 0.10249307479224377, "computeRatioMax": 0.10249307479224377, "endMs": "1665778541884", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.01662049861495845, "readRatioMax": 0.01662049861495845, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "130", "startMs": "1665778541788", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "55", "waitMsMax": "55", "waitRatioAvg": 0.07617728531855955, "waitRatioMax": 0.07617728531855955, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.027700831024930747, "writeRatioMax": 0.027700831024930747 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009695290858725761, "computeRatioMax": 0.009695290858725761, "endMs": "1665778541834", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008310249307479225, "readRatioMax": 0.008310249307479225, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778541790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE and(in($21, 2001, 2002), equal($21, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "38", "waitMsMax": "38", "waitRatioAvg": 0.05263157894736842, "waitRatioMax": 0.05263157894736842, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0221606648199446, "writeRatioMax": 0.0221606648199446 }, { "completedParallelInputs": "1", "computeMsAvg": "86", "computeMsMax": "86", "computeRatioAvg": 0.11911357340720222, "computeRatioMax": 0.11911357340720222, "endMs": "1665778541876", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.013850415512465374, "readRatioMax": 0.013850415512465374, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "109", "startMs": "1665778541788", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004155124653739612, "waitRatioMax": 0.004155124653739612, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.018005540166204988, "writeRatioMax": 0.018005540166204988 }, { "completedParallelInputs": "6", "computeMsAvg": "443", "computeMsMax": "595", "computeRatioAvg": 0.6135734072022161, "computeRatioMax": 0.8240997229916898, "endMs": "1665778542135", "id": "12", "inputStages": [ "0", "2" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.018005540166204988, "readRatioMax": 0.0221606648199446, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "13690155", "shuffleOutputBytesSpilled": "0", "slotMs": "2550", "startMs": "1665778541791", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214", "$190 := SUM($213)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $204, $214 := $111", "INNER HASH JOIN EACH WITH ALL ON $203 = $110" ] }, { "kind": "JOIN", "substeps": [ "$203 := $100, $204 := $102, $200 := $91, $201 := $92, $202 := $93", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $190", "TO __stage0C_output", "BY HASH($220, $221, $222, $223)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.008310249307479225, "writeRatioMax": 0.0110803324099723 }, { "completedParallelInputs": "1", "computeMsAvg": "435", "computeMsMax": "435", "computeRatioAvg": 0.6024930747922438, "computeRatioMax": 0.6024930747922438, "endMs": "1665778542122", "id": "13", "inputStages": [ "3", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.024930747922437674, "readRatioMax": 0.024930747922437674, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "788619", "shuffleOutputBytesSpilled": "0", "slotMs": "309", "startMs": "1665778541859", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304", "$180 := SUM($303)" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $291, $302 := $292, $303 := $294, $304 := $81", "INNER HASH JOIN EACH WITH ALL ON $293 = $80" ] }, { "kind": "JOIN", "substeps": [ "$293 := $70, $294 := $72, $290 := $61, $291 := $62, $292 := $63", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $180", "TO __stage0D_output", "BY HASH($310, $311, $312, $313)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.024930747922437674, "writeRatioMax": 0.024930747922437674 }, { "completedParallelInputs": "1", "computeMsAvg": "450", "computeMsMax": "450", "computeRatioAvg": 0.6232686980609419, "computeRatioMax": 0.6232686980609419, "endMs": "1665778542113", "id": "14", "inputStages": [ "11", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.018005540166204988, "readRatioMax": 0.018005540166204988, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "768704", "shuffleOutputBytesSpilled": "0", "slotMs": "518", "startMs": "1665778541906", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354", "$150 := SUM($353)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $340, $351 := $341, $352 := $342, $353 := $344, $354 := $21", "INNER HASH JOIN EACH WITH ALL ON $343 = $20" ] }, { "kind": "JOIN", "substeps": [ "$343 := $10, $344 := $12, $340 := $2, $341 := $3, $342 := $4", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $150", "TO __stage0E_output", "BY HASH($360, $361, $362, $363)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 }, { "completedParallelInputs": "6", "computeMsAvg": "508", "computeMsMax": "722", "computeRatioAvg": 0.703601108033241, "computeRatioMax": 1, "endMs": "1665778542290", "id": "15", "inputStages": [ "8", "6" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "15", "readRatioAvg": 0.018005540166204988, "readRatioMax": 0.02077562326869806, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "13784786", "shuffleOutputBytesSpilled": "0", "slotMs": "3480", "startMs": "1665778541912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254", "$170 := SUM($253)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $244, $254 := $51", "INNER HASH JOIN EACH WITH ALL ON $243 = $50" ] }, { "kind": "JOIN", "substeps": [ "$243 := $40, $244 := $42, $240 := $31, $241 := $32, $242 := $33", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $170", "TO __stage0F_output", "BY HASH($260, $261, $262, $263)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.008310249307479225, "writeRatioMax": 0.009695290858725761 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.05955678670360111, "computeRatioMax": 0.05955678670360111, "endMs": "1665778542374", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665778542329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $150", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $370", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.027700831024930747, "writeRatioMax": 0.027700831024930747 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.04986149584487535, "computeRatioMax": 0.04986149584487535, "endMs": "1665778542398", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665778542347", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $180", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313", "$140 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$140, $320", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.024930747922437674, "writeRatioMax": 0.024930747922437674 }, { "completedParallelInputs": "1", "computeMsAvg": "176", "computeMsMax": "176", "computeRatioAvg": 0.24376731301939059, "computeRatioMax": 0.24376731301939059, "endMs": "1665778542490", "id": "18", "inputStages": [ "15" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2261938", "shuffleOutputBytesSpilled": "0", "slotMs": "208", "startMs": "1665778542364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $170", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263", "$130 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$130, $270, $271, $272", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.0110803324099723, "computeRatioMax": 0.019390581717451522, "endMs": "1665778542570", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2261938", "shuffleOutputBytesSpilled": "0", "slotMs": "4337", "startMs": "1665778542508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "5", "waitMsMax": "9", "waitRatioAvg": 0.006925207756232687, "waitRatioMax": 0.012465373961218837, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.0221606648199446, "writeRatioMax": 0.04016620498614958 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0110803324099723, "computeRatioMax": 0.02077562326869806, "endMs": "1665778542582", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "4866", "startMs": "1665778542509", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.012465373961218837, "waitRatioMax": 0.013850415512465374, "writeMsAvg": "18", "writeMsMax": "54", "writeRatioAvg": 0.024930747922437674, "writeRatioMax": 0.07479224376731301 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0110803324099723, "computeRatioMax": 0.0221606648199446, "endMs": "1665778542570", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3303", "startMs": "1665778542510", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.012465373961218837, "waitRatioMax": 0.015235457063711912, "writeMsAvg": "5", "writeMsMax": "18", "writeRatioAvg": 0.006925207756232687, "writeRatioMax": 0.024930747922437674 }, { "completedParallelInputs": "1", "computeMsAvg": "196", "computeMsMax": "196", "computeRatioAvg": 0.27146814404432135, "computeRatioMax": 0.27146814404432135, "endMs": "1665778542689", "id": "23", "inputStages": [ "22", "12", "21", "20" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "186", "startMs": "1665778542527", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $190", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $270, $271, $272", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $320", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $370", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$380 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($384, NUMERIC<...>), divide($386, $384), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $330, $381 := $331, $382 := $332, $383 := $334, $384 := $336, $385 := $335, $386 := $120", "INNER HASH JOIN EACH WITH ALL ON $333 = $370" ] }, { "kind": "JOIN", "substeps": [ "$330 := $282, $331 := $283, $332 := $284, $333 := $280, $334 := $285, $335 := $281, $336 := $140", "INNER HASH JOIN EACH WITH ALL ON $280 = $320" ] }, { "kind": "JOIN", "substeps": [ "$280 := $230, $281 := $160, $282 := $270, $283 := $271, $284 := $272, $285 := $130", "INNER HASH JOIN EACH WITH ALL ON $230 = $270" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392", "TO __stage17_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.018005540166204988, "waitRatioMax": 0.018005540166204988, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0013850415512465374, "writeRatioMax": 0.0013850415512465374 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013850415512465374, "computeRatioMax": 0.013850415512465374, "endMs": "1665778542717", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "183", "startMs": "1665778542532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $391, $392", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402", "TO __stage18_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.009695290858725761, "waitRatioMax": 0.009695290858725761, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.00554016620498615, "writeRatioMax": 0.00554016620498615 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "12", "completedUnits": "10", "elapsedMs": "616", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "3107" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1321", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "21592" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116347975", "totalPartitionsProcessed": "0", "totalSlotMs": "21592", "transferredBytes": "0" }, "startTime": "1665778541446", "totalBytesProcessed": "116347975", "totalSlotMs": "21592" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonfe15b927_7329_42a0_9fbd_03ca1547dd13" }, "priority": "INTERACTIVE", "query": "-- start query 74 in stream 0 using template query74.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ss_net_paid) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,d_year as year\n ,sum(ws_net_paid) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n and d_year in (2001,2001+1)\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,d_year\n )\n select\n t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.year = 2001\n and t_s_secyear.year = 2001+1\n and t_w_firstyear.year = 2001\n and t_w_secyear.year = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 1,1,1\n limit 100\n;\n\n-- end query 74 in stream 0 using template query74.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "U4+Xxl+yQre+KiiiFn2T5g==", "id": "test-project-364309:europe-west1.query74_1665778544", "jobReference": { "jobId": "query74_1665778544", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query74_1665778544?location=europe-west1", "statistics": { "creationTime": "1665778545385", "endTime": "1665778546934", "finalExecutionDurationMs": "1356", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116347975", "performanceInsights": { "avgPreviousExecutionMs": "1273" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017366136034732273, "computeRatioMax": 0.017366136034732273, "endMs": "1665778545564", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008683068017366137, "readRatioMax": 0.008683068017366137, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778545523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE and(in($111, 2001, 2002), equal($111, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01881331403762663, "writeRatioMax": 0.01881331403762663 }, { "completedParallelInputs": "1", "computeMsAvg": "110", "computeMsMax": "110", "computeRatioAvg": 0.15918958031837915, "computeRatioMax": 0.15918958031837915, "endMs": "1665778545670", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.017366136034732273, "readRatioMax": 0.017366136034732273, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "145", "startMs": "1665778545553", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01881331403762663, "writeRatioMax": 0.01881331403762663 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011577424023154847, "computeRatioMax": 0.011577424023154847, "endMs": "1665778545707", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010130246020260492, "readRatioMax": 0.010130246020260492, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778545671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE and(in($81, 2001, 2002), equal($81, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "104", "waitMsMax": "104", "waitRatioAvg": 0.15050651230101303, "waitRatioMax": 0.15050651230101303, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02604920405209841, "writeRatioMax": 0.02604920405209841 }, { "completedParallelInputs": "1", "computeMsAvg": "124", "computeMsMax": "124", "computeRatioAvg": 0.17945007235890015, "computeRatioMax": 0.17945007235890015, "endMs": "1665778545812", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01447178002894356, "readRatioMax": 0.01447178002894356, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "144", "startMs": "1665778545705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63", "TO __stage05_output" ] } ], "waitMsAvg": "100", "waitMsMax": "100", "waitRatioAvg": 0.1447178002894356, "waitRatioMax": 0.1447178002894356, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.015918958031837915, "writeRatioMax": 0.015918958031837915 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01447178002894356, "computeRatioMax": 0.01447178002894356, "endMs": "1665778545741", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008683068017366137, "readRatioMax": 0.008683068017366137, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778545707", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE and(in($51, 2001, 2002), equal($51, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "83", "waitMsMax": "83", "waitRatioAvg": 0.12011577424023155, "waitRatioMax": 0.12011577424023155, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.010130246020260492, "writeRatioMax": 0.010130246020260492 }, { "completedParallelInputs": "1", "computeMsAvg": "86", "computeMsMax": "86", "computeRatioAvg": 0.12445730824891461, "computeRatioMax": 0.12445730824891461, "endMs": "1665778545801", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.015918958031837915, "readRatioMax": 0.015918958031837915, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665778545705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "50", "waitMsMax": "50", "waitRatioAvg": 0.0723589001447178, "waitRatioMax": 0.0723589001447178, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.015918958031837915, "writeRatioMax": 0.015918958031837915 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01881331403762663, "computeRatioMax": 0.01881331403762663, "endMs": "1665778545731", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.013024602026049204, "readRatioMax": 0.013024602026049204, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778545705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE and(in($21, 2001, 2002), equal($21, 2002))" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "35", "waitMsMax": "35", "waitRatioAvg": 0.05065123010130246, "waitRatioMax": 0.05065123010130246, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.008683068017366137, "writeRatioMax": 0.008683068017366137 }, { "completedParallelInputs": "1", "computeMsAvg": "159", "computeMsMax": "159", "computeRatioAvg": 0.2301013024602026, "computeRatioMax": 0.2301013024602026, "endMs": "1665778545831", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.015918958031837915, "readRatioMax": 0.015918958031837915, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5126661", "shuffleOutputBytesSpilled": "0", "slotMs": "188", "startMs": "1665778545705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage0B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.005788712011577424, "waitRatioMax": 0.005788712011577424, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01881331403762663, "writeRatioMax": 0.01881331403762663 }, { "completedParallelInputs": "6", "computeMsAvg": "475", "computeMsMax": "516", "computeRatioAvg": 0.6874095513748191, "computeRatioMax": 0.7467438494934877, "endMs": "1665778546024", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "15", "readRatioAvg": 0.01881331403762663, "readRatioMax": 0.02170767004341534, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "13690155", "shuffleOutputBytesSpilled": "0", "slotMs": "2681", "startMs": "1665778545706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214", "$190 := SUM($213)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $204, $214 := $111", "INNER HASH JOIN EACH WITH ALL ON $203 = $110" ] }, { "kind": "JOIN", "substeps": [ "$203 := $100, $204 := $102, $200 := $91, $201 := $92, $202 := $93", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $190", "TO __stage0C_output", "BY HASH($220, $221, $222, $223)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002894356005788712, "waitRatioMax": 0.002894356005788712, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.008683068017366137, "writeRatioMax": 0.010130246020260492 }, { "completedParallelInputs": "6", "computeMsAvg": "560", "computeMsMax": "691", "computeRatioAvg": 0.8104196816208393, "computeRatioMax": 1, "endMs": "1665778546275", "id": "13", "inputStages": [ "8", "6" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.020260492040520984, "readRatioMax": 0.027496382054992764, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "13784786", "shuffleOutputBytesSpilled": "0", "slotMs": "3146", "startMs": "1665778545831", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254", "$170 := SUM($253)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $244, $254 := $51", "INNER HASH JOIN EACH WITH ALL ON $243 = $50" ] }, { "kind": "JOIN", "substeps": [ "$243 := $40, $244 := $42, $240 := $31, $241 := $32, $242 := $33", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $170", "TO __stage0D_output", "BY HASH($260, $261, $262, $263)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.002894356005788712, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.010130246020260492, "writeRatioMax": 0.011577424023154847 }, { "completedParallelInputs": "1", "computeMsAvg": "399", "computeMsMax": "399", "computeRatioAvg": 0.5774240231548481, "computeRatioMax": 0.5774240231548481, "endMs": "1665778546102", "id": "14", "inputStages": [ "3", "5" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.020260492040520984, "readRatioMax": 0.020260492040520984, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "788619", "shuffleOutputBytesSpilled": "0", "slotMs": "365", "startMs": "1665778545849", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304", "$180 := SUM($303)" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $291, $302 := $292, $303 := $294, $304 := $81", "INNER HASH JOIN EACH WITH ALL ON $293 = $80" ] }, { "kind": "JOIN", "substeps": [ "$293 := $70, $294 := $72, $290 := $61, $291 := $62, $292 := $63", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $180", "TO __stage0E_output", "BY HASH($310, $311, $312, $313)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002894356005788712, "waitRatioMax": 0.002894356005788712, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02894356005788712, "writeRatioMax": 0.02894356005788712 }, { "completedParallelInputs": "1", "computeMsAvg": "413", "computeMsMax": "413", "computeRatioAvg": 0.597684515195369, "computeRatioMax": 0.597684515195369, "endMs": "1665778546133", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.020260492040520984, "readRatioMax": 0.020260492040520984, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "768704", "shuffleOutputBytesSpilled": "0", "slotMs": "409", "startMs": "1665778545875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354", "$150 := SUM($353)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $340, $351 := $341, $352 := $342, $353 := $344, $354 := $21", "INNER HASH JOIN EACH WITH ALL ON $343 = $20" ] }, { "kind": "JOIN", "substeps": [ "$343 := $10, $344 := $12, $340 := $2, $341 := $3, $342 := $4", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $150", "TO __stage0F_output", "BY HASH($360, $361, $362, $363)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.030390738060781478, "writeRatioMax": 0.030390738060781478 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.04052098408104197, "computeRatioMax": 0.04052098408104197, "endMs": "1665778546355", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778546303", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $370", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002894356005788712, "waitRatioMax": 0.002894356005788712, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.03328509406657019, "writeRatioMax": 0.03328509406657019 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.04775687409551375, "computeRatioMax": 0.04775687409551375, "endMs": "1665778546371", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778546318", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $180", "FROM __stage0E_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313", "$140 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$140, $320", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.027496382054992764, "writeRatioMax": 0.027496382054992764 }, { "completedParallelInputs": "1", "computeMsAvg": "224", "computeMsMax": "224", "computeRatioAvg": 0.32416787264833574, "computeRatioMax": 0.32416787264833574, "endMs": "1665778546484", "id": "19", "inputStages": [ "12" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "224", "startMs": "1665778546348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $190", "FROM __stage0C_output" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $230", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.03183791606367583, "writeRatioMax": 0.03183791606367583 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.011577424023154847, "computeRatioMax": 0.023154848046309694, "endMs": "1665778546559", "id": "20", "inputStages": [ "19" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "3719", "startMs": "1665778546502", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.004341534008683068, "waitRatioMax": 0.013024602026049204, "writeMsAvg": "20", "writeMsMax": "32", "writeRatioAvg": 0.02894356005788712, "writeRatioMax": 0.04630969609261939 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.010130246020260492, "computeRatioMax": 0.01881331403762663, "endMs": "1665778546561", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "2882", "startMs": "1665778546503", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "11", "waitMsMax": "13", "waitRatioAvg": 0.015918958031837915, "waitRatioMax": 0.01881331403762663, "writeMsAvg": "4", "writeMsMax": "16", "writeRatioAvg": 0.005788712011577424, "writeRatioMax": 0.023154848046309694 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.010130246020260492, "computeRatioMax": 0.023154848046309694, "endMs": "1665778546568", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "2925", "startMs": "1665778546504", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "12", "waitMsMax": "15", "waitRatioAvg": 0.017366136034732273, "waitRatioMax": 0.02170767004341534, "writeMsAvg": "8", "writeMsMax": "29", "writeRatioAvg": 0.011577424023154847, "writeRatioMax": 0.041968162083936326 }, { "completedParallelInputs": "1", "computeMsAvg": "289", "computeMsMax": "289", "computeRatioAvg": 0.4182344428364689, "computeRatioMax": 0.4182344428364689, "endMs": "1665778546736", "id": "23", "inputStages": [ "21", "22", "13", "20" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "262866", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "312", "startMs": "1665778546524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $170", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$160, $230", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $320", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $370", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$380 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($384, NUMERIC<...>), divide($386, $384), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $330, $381 := $331, $382 := $332, $383 := $334, $384 := $336, $385 := $335, $386 := $120", "INNER HASH JOIN EACH WITH ALL ON $333 = $370" ] }, { "kind": "JOIN", "substeps": [ "$330 := $282, $331 := $283, $332 := $284, $333 := $280, $334 := $285, $335 := $281, $336 := $140", "INNER HASH JOIN EACH WITH ALL ON $280 = $320" ] }, { "kind": "JOIN", "substeps": [ "$282 := $270, $283 := $271, $284 := $272, $285 := $130, $280 := $230, $281 := $160", "INNER HASH JOIN EACH WITH ALL ON $270 = $230" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263", "$130 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392", "TO __stage17_output" ] } ], "waitMsAvg": "15", "waitMsMax": "15", "waitRatioAvg": 0.02170767004341534, "waitRatioMax": 0.02170767004341534, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.002894356005788712, "writeRatioMax": 0.002894356005788712 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017366136034732273, "computeRatioMax": 0.017366136034732273, "endMs": "1665778546791", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "92", "shuffleOutputBytes": "3944", "shuffleOutputBytesSpilled": "0", "slotMs": "216", "startMs": "1665778546528", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $391, $392", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402", "TO __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004341534008683068, "waitRatioMax": 0.004341534008683068, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.008683068017366137, "writeRatioMax": 0.008683068017366137 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "10", "completedUnits": "13", "elapsedMs": "599", "estimatedRunnableUnits": "0", "pendingUnits": "9", "totalSlotMs": "3181" }, { "activeUnits": "301", "completedUnits": "327", "elapsedMs": "1465", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "17794" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116347975", "totalPartitionsProcessed": "0", "totalSlotMs": "17794", "transferredBytes": "0" }, "startTime": "1665778545425", "totalBytesProcessed": "116347975", "totalSlotMs": "17794" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
