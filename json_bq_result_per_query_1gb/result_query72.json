{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon01f360a8_a15e_41b9_8a53_f3223bd2bb03" }, "priority": "INTERACTIVE", "query": "select i_item_desc\n ,w_warehouse_name\n ,d1.d_week_seq\n ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n and inv_quantity_on_hand < cs_quantity \n and d3.d_date > d1.d_date + 5\n and hd_buy_potential = '1001-5000'\n and d1.d_year = 1998\n and cd_marital_status = 'S'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "oxgvOp3rUpDkgjxGTM7wUA==", "id": "test-project-364309:europe-west1.query72_1665768446", "jobReference": { "jobId": "query72_1665768446", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query72_1665768446?location=europe-west1", "statistics": { "creationTime": "1665768447150", "endTime": "1665768456914", "finalExecutionDurationMs": "9480", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "490943434", "performanceInsights": { "avgPreviousExecutionMs": "7667" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "114", "computeMsMax": "114", "computeRatioAvg": 0.013814832767813864, "computeRatioMax": 0.013814832767813864, "endMs": "1665768447489", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0010906446921958312, "readRatioMax": 0.0010906446921958312, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "2593206", "shuffleOutputBytesSpilled": "0", "slotMs": "127", "startMs": "1665768447388", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002423654871546292, "waitRatioMax": 0.0002423654871546292, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.001454192922927775, "writeRatioMax": 0.001454192922927775 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0008482792050412022, "computeRatioMax": 0.0008482792050412022, "endMs": "1665768447444", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006059137178865729, "readRatioMax": 0.0006059137178865729, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768447403", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001211827435773146, "waitRatioMax": 0.0001211827435773146, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002060106640814348, "writeRatioMax": 0.002060106640814348 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.004120213281628696, "computeRatioMax": 0.004120213281628696, "endMs": "1665768447456", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0008482792050412022, "readRatioMax": 0.0008482792050412022, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768447418", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001211827435773146, "waitRatioMax": 0.0001211827435773146, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0012118274357731458, "writeRatioMax": 0.0012118274357731458 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.004241396025206011, "computeRatioMax": 0.004241396025206011, "endMs": "1665768447474", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0009694619486185168, "readRatioMax": 0.0009694619486185168, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768447433", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002423654871546292, "waitRatioMax": 0.0002423654871546292, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0013330101793504604, "writeRatioMax": 0.0013330101793504604 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0013330101793504604, "computeRatioMax": 0.0013330101793504604, "endMs": "1665768447478", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0008482792050412022, "readRatioMax": 0.0008482792050412022, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "8395", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665768447451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date, $42:d_week_seq, $43:d_year", "FROM date_dim", "WHERE equal($43, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002423654871546292, "waitRatioMax": 0.0002423654871546292, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0013330101793504604, "writeRatioMax": 0.0013330101793504604 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0015753756665050896, "computeRatioMax": 0.0015753756665050896, "endMs": "1665768447496", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0007270964614638875, "readRatioMax": 0.0007270964614638875, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768447465", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:hd_demo_sk, $51:hd_buy_potential", "FROM household_demographics", "WHERE equal($51, '1001-5000')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001211827435773146, "waitRatioMax": 0.0001211827435773146, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0019389238972370335, "writeRatioMax": 0.0019389238972370335 }, { "completedParallelInputs": "1", "computeMsAvg": "166", "computeMsMax": "166", "computeRatioAvg": 0.02011633543383422, "computeRatioMax": 0.02011633543383422, "endMs": "1665768447613", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.0021812893843916625, "readRatioMax": 0.0021812893843916625, "recordsRead": "1920800", "recordsWritten": "384160", "shuffleOutputBytes": "3457440", "shuffleOutputBytesSpilled": "0", "slotMs": "177", "startMs": "1665768447479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cd_demo_sk, $71:cd_marital_status", "FROM customer_demographics", "WHERE equal($71, 'S')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002423654871546292, "waitRatioMax": 0.0002423654871546292, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.0025448376151236064, "writeRatioMax": 0.0025448376151236064 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.007634512845370819, "computeRatioMax": 0.007634512845370819, "endMs": "1665768447585", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.0016965584100824044, "readRatioMax": 0.0016965584100824044, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2054502", "shuffleOutputBytesSpilled": "0", "slotMs": "97", "startMs": "1665768447495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002423654871546292, "waitRatioMax": 0.0002423654871546292, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0016965584100824044, "writeRatioMax": 0.0016965584100824044 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0007270964614638875, "computeRatioMax": 0.0007270964614638875, "endMs": "1665768447551", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0007270964614638875, "readRatioMax": 0.0007270964614638875, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768447511", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001211827435773146, "waitRatioMax": 0.0001211827435773146, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002060106640814348, "writeRatioMax": 0.002060106640814348 }, { "completedParallelInputs": "1", "computeMsAvg": "7074", "computeMsMax": "7074", "computeRatioAvg": 0.8572467280659234, "computeRatioMax": 0.8572467280659234, "endMs": "1665768451041", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "30", "readMsMax": "30", "readRatioAvg": 0.003635482307319438, "readRatioMax": 0.003635482307319438, "recordsRead": "11745000", "recordsWritten": "11745000", "shuffleOutputBytes": "418124696", "shuffleOutputBytesSpilled": "0", "slotMs": "5649", "startMs": "1665768447526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:inv_date_sk, $101:inv_item_sk, $102:inv_warehouse_sk, $103:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001211827435773146, "waitRatioMax": 0.0001211827435773146, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0010906446921958312, "writeRatioMax": 0.0010906446921958312 }, { "completedParallelInputs": "5", "computeMsAvg": "541", "computeMsMax": "622", "computeRatioAvg": 0.06555986427532719, "computeRatioMax": 0.07537566650508967, "endMs": "1665768447988", "id": "10", "name": "S0A: Input", "parallelInputs": "5", "readMsAvg": "29", "readMsMax": "35", "readRatioAvg": 0.003514299563742123, "readRatioMax": 0.004241396025206011, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "103448560", "shuffleOutputBytesSpilled": "0", "slotMs": "2436", "startMs": "1665768447541", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:cs_sold_date_sk, $91:cs_ship_date_sk, $92:cs_bill_cdemo_sk, $93:cs_bill_hdemo_sk, $94:cs_item_sk, $95:cs_promo_sk, $96:cs_order_number, $97:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0001211827435773146, "waitRatioMax": 0.00036354823073194375, "writeMsAvg": "38", "writeMsMax": "52", "writeRatioAvg": 0.0046049442559379546, "writeRatioMax": 0.006301502666020358 }, { "completedParallelInputs": "100", "computeMsAvg": "3623", "computeMsMax": "8252", "computeRatioAvg": 0.43904507998061076, "computeRatioMax": 1, "endMs": "1665768456602", "id": "11", "inputStages": [ "2", "0", "4", "10", "9", "6", "8", "7", "5", "1", "3" ], "name": "S0B: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "82606048", "recordsWritten": "2232", "shuffleOutputBytes": "353924", "shuffleOutputBytesSpilled": "0", "slotMs": "298793", "startMs": "1665768451085", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $272, $281 := $273, $282 := $271", "$120 := SUM($131)", "$121 := SUM($130)", "$122 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(not(is_null($270)), 1, 0)", "$131 := case_no_value(is_null($270), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $265, $271 := $260, $272 := $261, $273 := $262", "LEFT OUTER HASH JOIN EACH WITH ALL ON $263 = $1, $264 = $2" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $253, $263 := $254, $264 := $256, $265 := $10", "LEFT OUTER HASH JOIN EACH WITH ALL ON $255 = $10" ] }, { "kind": "FILTER", "substeps": [ "greater($257, add($250, 5))" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $243, $254 := $245, $255 := $246, $256 := $247, $257 := $21", "INNER HASH JOIN EACH WITH ALL ON $244 = $20" ] }, { "kind": "JOIN", "substeps": [ "$240 := $237, $241 := $238, $242 := $230, $243 := $231, $244 := $232, $245 := $233, $246 := $234, $247 := $235", "INNER HASH JOIN EACH WITH ALL ON $236 = $30, $238 = $31" ] }, { "kind": "JOIN", "substeps": [ "$230 := $210, $231 := $211, $232 := $213, $233 := $214, $234 := $215, $235 := $216, $236 := $217, $237 := $41, $238 := $42", "INNER HASH JOIN EACH WITH ALL ON $212 = $40" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $193, $214 := $195, $215 := $196, $216 := $197, $217 := $198", "INNER HASH JOIN EACH WITH ALL ON $194 = $50" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $170, $192 := $171, $193 := $172, $194 := $174, $195 := $175, $196 := $176, $197 := $177, $198 := $178", "INNER HASH JOIN EACH WITH ALL ON $173 = $70" ] }, { "kind": "JOIN", "substeps": [ "$170 := $168, $171 := $160, $172 := $161, $173 := $162, $174 := $163, $175 := $164, $176 := $165, $177 := $166, $178 := $167, $179 := $61", "INNER HASH JOIN EACH WITH ALL ON $164 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $148, $168 := $81", "INNER HASH JOIN EACH WITH ALL ON $149 = $80" ] }, { "kind": "FILTER", "substeps": [ "less($150, $147)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $90, $141 := $91, $142 := $92, $143 := $93, $144 := $94, $145 := $95, $146 := $96, $147 := $97, $148 := $100, $149 := $102, $150 := $103", "INNER HASH JOIN EACH WITH EACH ON $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$282, $280, $281, $120, $121, $122", "TO __stage0B_output", "BY HASH($280, $281, $282)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0002423654871546292, "waitRatioMax": 0.00036354823073194375, "writeMsAvg": "4", "writeMsMax": "12", "writeRatioAvg": 0.0004847309743092584, "writeRatioMax": 0.001454192922927775 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.001454192922927775, "computeRatioMax": 0.001454192922927775, "endMs": "1665768456793", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2232", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665768456777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$282, $280, $281, $120, $121, $122", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$112 DESC, $290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282", "$110 := SUM($120)", "$111 := SUM($121)", "$112 := SUM_OF_COUNTS($122)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $303, $304, $305", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001211827435773146, "waitRatioMax": 0.0001211827435773146, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0001211827435773146, "writeRatioMax": 0.0001211827435773146 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.001454192922927775, "computeRatioMax": 0.001454192922927775, "endMs": "1665768456831", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768456795", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $303, $304, $305", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$305 DESC, $301 ASC, $302 ASC, $300 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002423654871546292, "waitRatioMax": 0.0002423654871546292, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0019389238972370335, "writeRatioMax": 0.0019389238972370335 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "12", "elapsedMs": "683", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "1974" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "1224", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4443" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "2666", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6054" }, { "activeUnits": "100", "completedUnits": "15", "elapsedMs": "4338", "estimatedRunnableUnits": "0", "pendingUnits": "100", "totalSlotMs": "34012" }, { "activeUnits": "87", "completedUnits": "63", "elapsedMs": "5743", "estimatedRunnableUnits": "0", "pendingUnits": "52", "totalSlotMs": "227780" }, { "activeUnits": "24", "completedUnits": "109", "elapsedMs": "6754", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "287015" }, { "activeUnits": "6", "completedUnits": "114", "elapsedMs": "8140", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "303004" }, { "activeUnits": "3", "completedUnits": "117", "elapsedMs": "9667", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "307544" } ], "totalBytesBilled": "491782144", "totalBytesProcessed": "490943434", "totalPartitionsProcessed": "0", "totalSlotMs": "307544", "transferredBytes": "0" }, "startTime": "1665768447206", "totalBytesProcessed": "490943434", "totalSlotMs": "307544" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona29f2426_e60e_431b_ba6f_2b9844f01c63" }, "priority": "INTERACTIVE", "query": "select i_item_desc\n ,w_warehouse_name\n ,d1.d_week_seq\n ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n and inv_quantity_on_hand < cs_quantity \n and d3.d_date > d1.d_date + 5\n and hd_buy_potential = '1001-5000'\n and d1.d_year = 1998\n and cd_marital_status = 'S'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "RhTxN8I/0RY+V9QVGesSAA==", "id": "test-project-364309:europe-west1.query72_1665778459", "jobReference": { "jobId": "query72_1665778459", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query72_1665778459?location=europe-west1", "statistics": { "creationTime": "1665778459689", "endTime": "1665778468008", "finalExecutionDurationMs": "8051", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "490943434", "performanceInsights": { "avgPreviousExecutionMs": "7969" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.0074221338634857525, "computeRatioMax": 0.0074221338634857525, "endMs": "1665778459970", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0011928429423459245, "readRatioMax": 0.0011928429423459245, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "2593206", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665778459893", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014579191517561298, "writeRatioMax": 0.0014579191517561298 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0007952286282306163, "computeRatioMax": 0.0007952286282306163, "endMs": "1665778459946", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006626905235255136, "readRatioMax": 0.0006626905235255136, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778459907", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0021206096752816434, "writeRatioMax": 0.0021206096752816434 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.005699138502319417, "computeRatioMax": 0.005699138502319417, "endMs": "1665778459959", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0007952286282306163, "readRatioMax": 0.0007952286282306163, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778459919", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014579191517561298, "writeRatioMax": 0.0014579191517561298 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.0038436050364479787, "computeRatioMax": 0.0038436050364479787, "endMs": "1665778459967", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0007952286282306163, "readRatioMax": 0.0007952286282306163, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665778459933", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0011928429423459245, "writeRatioMax": 0.0011928429423459245 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0011928429423459245, "computeRatioMax": 0.0011928429423459245, "endMs": "1665778459987", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0007952286282306163, "readRatioMax": 0.0007952286282306163, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "8395", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778459947", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date, $42:d_week_seq, $43:d_year", "FROM date_dim", "WHERE equal($43, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0019880715705765406, "writeRatioMax": 0.0019880715705765406 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0009277667329357191, "computeRatioMax": 0.0009277667329357191, "endMs": "1665778459988", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006626905235255136, "readRatioMax": 0.0006626905235255136, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778459959", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:hd_demo_sk, $51:hd_buy_potential", "FROM household_demographics", "WHERE equal($51, '1001-5000')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0022531477799867462, "writeRatioMax": 0.0022531477799867462 }, { "completedParallelInputs": "1", "computeMsAvg": "104", "computeMsMax": "104", "computeRatioAvg": 0.013783962889330682, "computeRatioMax": 0.013783962889330682, "endMs": "1665778460082", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0013253810470510272, "readRatioMax": 0.0013253810470510272, "recordsRead": "1920800", "recordsWritten": "384160", "shuffleOutputBytes": "3457440", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665778459974", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cd_demo_sk, $71:cd_marital_status", "FROM customer_demographics", "WHERE equal($71, 'S')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.002783300198807157, "writeRatioMax": 0.002783300198807157 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.006891981444665341, "computeRatioMax": 0.006891981444665341, "endMs": "1665778460042", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0011928429423459245, "readRatioMax": 0.0011928429423459245, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2054502", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778459987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0010603048376408217, "writeRatioMax": 0.0010603048376408217 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0013253810470510272, "computeRatioMax": 0.0013253810470510272, "endMs": "1665778460039", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009277667329357191, "readRatioMax": 0.0009277667329357191, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778460000", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0013253810470510272, "writeRatioMax": 0.0013253810470510272 }, { "completedParallelInputs": "1", "computeMsAvg": "7545", "computeMsMax": "7545", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778464100", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "40", "readMsMax": "40", "readRatioAvg": 0.005301524188204109, "readRatioMax": 0.005301524188204109, "recordsRead": "11745000", "recordsWritten": "11745000", "shuffleOutputBytes": "418124696", "shuffleOutputBytesSpilled": "0", "slotMs": "6600", "startMs": "1665778460014", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:inv_date_sk, $101:inv_item_sk, $102:inv_warehouse_sk, $103:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.0029158383035122596, "writeRatioMax": 0.0029158383035122596 }, { "completedParallelInputs": "5", "computeMsAvg": "406", "computeMsMax": "554", "computeRatioAvg": 0.053810470510271706, "computeRatioMax": 0.07342611000662691, "endMs": "1665778460336", "id": "10", "name": "S0A: Input", "parallelInputs": "5", "readMsAvg": "19", "readMsMax": "21", "readRatioAvg": 0.0025182239893969515, "readRatioMax": 0.002783300198807157, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "103448560", "shuffleOutputBytesSpilled": "0", "slotMs": "1824", "startMs": "1665778460024", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:cs_sold_date_sk, $91:cs_ship_date_sk, $92:cs_bill_cdemo_sk, $93:cs_bill_hdemo_sk, $94:cs_item_sk, $95:cs_promo_sk, $96:cs_order_number, $97:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "26", "writeMsMax": "32", "writeRatioAvg": 0.0034459907223326706, "writeRatioMax": 0.004241219350563287 }, { "completedParallelInputs": "100", "computeMsAvg": "3505", "computeMsMax": "6882", "computeRatioAvg": 0.464546056991385, "computeRatioMax": 0.9121272365805169, "endMs": "1665778467848", "id": "11", "inputStages": [ "6", "0", "5", "4", "3", "9", "7", "8", "2", "10", "1" ], "name": "S0B: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "82606048", "recordsWritten": "2232", "shuffleOutputBytes": "353924", "shuffleOutputBytesSpilled": "0", "slotMs": "308913", "startMs": "1665778464108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $272, $281 := $273, $282 := $271", "$120 := SUM($131)", "$121 := SUM($130)", "$122 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(not(is_null($270)), 1, 0)", "$131 := case_no_value(is_null($270), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $265, $271 := $260, $272 := $261, $273 := $262", "LEFT OUTER HASH JOIN EACH WITH ALL ON $263 = $1, $264 = $2" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $253, $263 := $254, $264 := $256, $265 := $10", "LEFT OUTER HASH JOIN EACH WITH ALL ON $255 = $10" ] }, { "kind": "FILTER", "substeps": [ "greater($257, add($250, 5))" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $243, $254 := $245, $255 := $246, $256 := $247, $257 := $21", "INNER HASH JOIN EACH WITH ALL ON $244 = $20" ] }, { "kind": "JOIN", "substeps": [ "$240 := $237, $241 := $238, $242 := $230, $243 := $231, $244 := $232, $245 := $233, $246 := $234, $247 := $235", "INNER HASH JOIN EACH WITH ALL ON $236 = $30, $238 = $31" ] }, { "kind": "JOIN", "substeps": [ "$230 := $210, $231 := $211, $232 := $213, $233 := $214, $234 := $215, $235 := $216, $236 := $217, $237 := $41, $238 := $42", "INNER HASH JOIN EACH WITH ALL ON $212 = $40" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $193, $214 := $195, $215 := $196, $216 := $197, $217 := $198", "INNER HASH JOIN EACH WITH ALL ON $194 = $50" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $170, $192 := $171, $193 := $172, $194 := $174, $195 := $175, $196 := $176, $197 := $177, $198 := $178", "INNER HASH JOIN EACH WITH ALL ON $173 = $70" ] }, { "kind": "JOIN", "substeps": [ "$170 := $168, $171 := $160, $172 := $161, $173 := $162, $174 := $163, $175 := $164, $176 := $165, $177 := $166, $178 := $167, $179 := $61", "INNER HASH JOIN EACH WITH ALL ON $164 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $148, $168 := $81", "INNER HASH JOIN EACH WITH ALL ON $149 = $80" ] }, { "kind": "FILTER", "substeps": [ "less($150, $147)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $90, $141 := $91, $142 := $92, $143 := $93, $144 := $94, $145 := $95, $146 := $96, $147 := $97, $148 := $100, $149 := $102, $150 := $103", "INNER HASH JOIN EACH WITH EACH ON $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$282, $280, $281, $120, $121, $122", "TO __stage0B_output", "BY HASH($280, $281, $282)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002650762094102054, "waitRatioMax": 0.0002650762094102054, "writeMsAvg": "5", "writeMsMax": "17", "writeRatioAvg": 0.0006626905235255136, "writeRatioMax": 0.0022531477799867462 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0017229953611663353, "computeRatioMax": 0.0017229953611663353, "endMs": "1665778467875", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2232", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778467854", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$282, $280, $281, $120, $121, $122", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$112 DESC, $290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282", "$110 := SUM($120)", "$111 := SUM($121)", "$112 := SUM_OF_COUNTS($122)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $303, $304, $305", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0001325381047051027, "writeRatioMax": 0.0001325381047051027 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0013253810470510272, "computeRatioMax": 0.0013253810470510272, "endMs": "1665778467908", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778467871", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $303, $304, $305", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$305 DESC, $301 ASC, $302 ASC, $300 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001325381047051027, "waitRatioMax": 0.0001325381047051027, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0021206096752816434, "writeRatioMax": 0.0021206096752816434 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2776" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "1617", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4541" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "3617", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7715" }, { "activeUnits": "100", "completedUnits": "30", "elapsedMs": "5593", "estimatedRunnableUnits": "0", "pendingUnits": "85", "totalSlotMs": "168504" }, { "activeUnits": "55", "completedUnits": "92", "elapsedMs": "6661", "estimatedRunnableUnits": "0", "pendingUnits": "23", "totalSlotMs": "288115" }, { "activeUnits": "10", "completedUnits": "117", "elapsedMs": "8187", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "317877" } ], "totalBytesBilled": "491782144", "totalBytesProcessed": "490943434", "totalPartitionsProcessed": "0", "totalSlotMs": "317877", "transferredBytes": "0" }, "startTime": "1665778459763", "totalBytesProcessed": "490943434", "totalSlotMs": "317877" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1b1cba2f_2d16_4e28_8960_2f35467b35ed" }, "priority": "INTERACTIVE", "query": "select i_item_desc\n ,w_warehouse_name\n ,d1.d_week_seq\n ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n and inv_quantity_on_hand < cs_quantity \n and d3.d_date > d1.d_date + 5\n and hd_buy_potential = '1001-5000'\n and d1.d_year = 1998\n and cd_marital_status = 'S'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "hDp2kfecJxZ1NG94vwsCuA==", "id": "test-project-364309:europe-west1.query72_1665778469", "jobReference": { "jobId": "query72_1665778469", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query72_1665778469?location=europe-west1", "statistics": { "creationTime": "1665778470202", "endTime": "1665778479679", "finalExecutionDurationMs": "9245", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "490943434", "performanceInsights": { "avgPreviousExecutionMs": "7981" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "83", "computeMsMax": "83", "computeRatioAvg": 0.010120716985733446, "computeRatioMax": 0.010120716985733446, "endMs": "1665778470462", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0008535544445799293, "readRatioMax": 0.0008535544445799293, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "2593206", "shuffleOutputBytesSpilled": "0", "slotMs": "117", "startMs": "1665778470378", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.001341299841482746, "writeRatioMax": 0.001341299841482746 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0010974271430313376, "computeRatioMax": 0.0010974271430313376, "endMs": "1665778470435", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.0017071088891598585, "readRatioMax": 0.0017071088891598585, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778470394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00024387269845140838, "waitRatioMax": 0.00024387269845140838, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0007316180953542251, "writeRatioMax": 0.0007316180953542251 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.004633581270576759, "computeRatioMax": 0.004633581270576759, "endMs": "1665778470452", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0010974271430313376, "readRatioMax": 0.0010974271430313376, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778470408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.001341299841482746, "writeRatioMax": 0.001341299841482746 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.003901963175222534, "computeRatioMax": 0.003901963175222534, "endMs": "1665778470465", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0007316180953542251, "readRatioMax": 0.0007316180953542251, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778470424", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0015851725399341544, "writeRatioMax": 0.0015851725399341544 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0017071088891598585, "computeRatioMax": 0.0017071088891598585, "endMs": "1665778470473", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0007316180953542251, "readRatioMax": 0.0007316180953542251, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "8395", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778470441", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date, $42:d_week_seq, $43:d_year", "FROM date_dim", "WHERE equal($43, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00024387269845140838, "waitRatioMax": 0.00024387269845140838, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.001950981587611267, "writeRatioMax": 0.001950981587611267 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0009754907938056335, "computeRatioMax": 0.0009754907938056335, "endMs": "1665778470484", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006096817461285209, "readRatioMax": 0.0006096817461285209, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665778470457", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:hd_demo_sk, $51:hd_buy_potential", "FROM household_demographics", "WHERE equal($51, '1001-5000')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0018290452383855627, "writeRatioMax": 0.0018290452383855627 }, { "completedParallelInputs": "1", "computeMsAvg": "151", "computeMsMax": "151", "computeRatioAvg": 0.01841238873308133, "computeRatioMax": 0.01841238873308133, "endMs": "1665778470595", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0010974271430313376, "readRatioMax": 0.0010974271430313376, "recordsRead": "1920800", "recordsWritten": "384160", "shuffleOutputBytes": "3457440", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665778470472", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cd_demo_sk, $71:cd_marital_status", "FROM customer_demographics", "WHERE equal($71, 'S')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0023167906352883796, "writeRatioMax": 0.0023167906352883796 }, { "completedParallelInputs": "1", "computeMsAvg": "59", "computeMsMax": "59", "computeRatioAvg": 0.007194244604316547, "computeRatioMax": 0.007194244604316547, "endMs": "1665778470560", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0012193634922570418, "readRatioMax": 0.0012193634922570418, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2054502", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665778470487", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00024387269845140838, "waitRatioMax": 0.00024387269845140838, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0018290452383855627, "writeRatioMax": 0.0018290452383855627 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.001341299841482746, "computeRatioMax": 0.001341299841482746, "endMs": "1665778470542", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006096817461285209, "readRatioMax": 0.0006096817461285209, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778470501", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0018290452383855627, "writeRatioMax": 0.0018290452383855627 }, { "completedParallelInputs": "1", "computeMsAvg": "7477", "computeMsMax": "7477", "computeRatioAvg": 0.9117180831605902, "computeRatioMax": 0.9117180831605902, "endMs": "1665778474668", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "44", "readMsMax": "44", "readRatioAvg": 0.005365199365930984, "readRatioMax": 0.005365199365930984, "recordsRead": "11745000", "recordsWritten": "11745000", "shuffleOutputBytes": "418124696", "shuffleOutputBytesSpilled": "0", "slotMs": "6068", "startMs": "1665778470516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:inv_date_sk, $101:inv_item_sk, $102:inv_warehouse_sk, $103:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0008535544445799293, "writeRatioMax": 0.0008535544445799293 }, { "completedParallelInputs": "5", "computeMsAvg": "547", "computeMsMax": "801", "computeRatioAvg": 0.06669918302646019, "computeRatioMax": 0.09767101572978905, "endMs": "1665778470969", "id": "10", "name": "S0A: Input", "parallelInputs": "5", "readMsAvg": "25", "readMsMax": "32", "readRatioAvg": 0.0030484087306426044, "readRatioMax": 0.003901963175222534, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "103448560", "shuffleOutputBytesSpilled": "0", "slotMs": "2648", "startMs": "1665778470533", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:cs_sold_date_sk, $91:cs_ship_date_sk, $92:cs_bill_cdemo_sk, $93:cs_bill_hdemo_sk, $94:cs_item_sk, $95:cs_promo_sk, $96:cs_order_number, $97:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00024387269845140838, "waitRatioMax": 0.00024387269845140838, "writeMsAvg": "27", "writeMsMax": "31", "writeRatioAvg": 0.003292281429094013, "writeRatioMax": 0.0037800268259968297 }, { "completedParallelInputs": "100", "computeMsAvg": "3693", "computeMsMax": "8201", "computeRatioAvg": 0.45031093769052555, "computeRatioMax": 1, "endMs": "1665778479478", "id": "11", "inputStages": [ "5", "2", "0", "9", "6", "4", "3", "1", "7", "8", "10" ], "name": "S0B: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "82606048", "recordsWritten": "2232", "shuffleOutputBytes": "353924", "shuffleOutputBytesSpilled": "0", "slotMs": "342764", "startMs": "1665778474685", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $272, $281 := $273, $282 := $271", "$120 := SUM($131)", "$121 := SUM($130)", "$122 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(not(is_null($270)), 1, 0)", "$131 := case_no_value(is_null($270), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $265, $271 := $260, $272 := $261, $273 := $262", "LEFT OUTER HASH JOIN EACH WITH ALL ON $263 = $1, $264 = $2" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $253, $263 := $254, $264 := $256, $265 := $10", "LEFT OUTER HASH JOIN EACH WITH ALL ON $255 = $10" ] }, { "kind": "FILTER", "substeps": [ "greater($257, add($250, 5))" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $243, $254 := $245, $255 := $246, $256 := $247, $257 := $21", "INNER HASH JOIN EACH WITH ALL ON $244 = $20" ] }, { "kind": "JOIN", "substeps": [ "$240 := $237, $241 := $238, $242 := $230, $243 := $231, $244 := $232, $245 := $233, $246 := $234, $247 := $235", "INNER HASH JOIN EACH WITH ALL ON $236 = $30, $238 = $31" ] }, { "kind": "JOIN", "substeps": [ "$230 := $210, $231 := $211, $232 := $213, $233 := $214, $234 := $215, $235 := $216, $236 := $217, $237 := $41, $238 := $42", "INNER HASH JOIN EACH WITH ALL ON $212 = $40" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $193, $214 := $195, $215 := $196, $216 := $197, $217 := $198", "INNER HASH JOIN EACH WITH ALL ON $194 = $50" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $170, $192 := $171, $193 := $172, $194 := $174, $195 := $175, $196 := $176, $197 := $177, $198 := $178", "INNER HASH JOIN EACH WITH ALL ON $173 = $70" ] }, { "kind": "JOIN", "substeps": [ "$170 := $168, $171 := $160, $172 := $161, $173 := $162, $174 := $163, $175 := $164, $176 := $165, $177 := $166, $178 := $167, $179 := $61", "INNER HASH JOIN EACH WITH ALL ON $164 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $148, $168 := $81", "INNER HASH JOIN EACH WITH ALL ON $149 = $80" ] }, { "kind": "FILTER", "substeps": [ "less($150, $147)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $90, $141 := $91, $142 := $92, $143 := $93, $144 := $94, $145 := $95, $146 := $96, $147 := $97, $148 := $100, $149 := $102, $150 := $103", "INNER HASH JOIN EACH WITH EACH ON $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$282, $280, $281, $120, $121, $122", "TO __stage0B_output", "BY HASH($280, $281, $282)" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.00048774539690281675, "waitRatioMax": 0.0007316180953542251, "writeMsAvg": "10", "writeMsMax": "26", "writeRatioAvg": 0.0012193634922570418, "writeRatioMax": 0.0031703450798683088 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0009754907938056335, "computeRatioMax": 0.0009754907938056335, "endMs": "1665778479546", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2232", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665778479531", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$282, $280, $281, $120, $121, $122", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$112 DESC, $290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282", "$110 := SUM($120)", "$111 := SUM($121)", "$112 := SUM_OF_COUNTS($122)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $303, $304, $305", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00012193634922570419, "writeRatioMax": 0.00012193634922570419 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0012193634922570418, "computeRatioMax": 0.0012193634922570418, "endMs": "1665778479584", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778479548", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $303, $304, $305", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$305 DESC, $301 ASC, $302 ASC, $300 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00012193634922570419, "waitRatioMax": 0.00012193634922570419, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.0030484087306426044, "writeRatioMax": 0.0030484087306426044 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "13", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "2934" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "1219", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4369" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "2612", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6514" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "3612", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7958" }, { "activeUnits": "100", "completedUnits": "15", "elapsedMs": "4612", "estimatedRunnableUnits": "0", "pendingUnits": "100", "totalSlotMs": "11567" }, { "activeUnits": "92", "completedUnits": "49", "elapsedMs": "6140", "estimatedRunnableUnits": "0", "pendingUnits": "66", "totalSlotMs": "227455" }, { "activeUnits": "36", "completedUnits": "97", "elapsedMs": "7153", "estimatedRunnableUnits": "0", "pendingUnits": "18", "totalSlotMs": "311737" }, { "activeUnits": "14", "completedUnits": "112", "elapsedMs": "8253", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "344690" }, { "activeUnits": "4", "completedUnits": "117", "elapsedMs": "9377", "estimatedRunnableUnits": "16", "pendingUnits": "0", "totalSlotMs": "352066" } ], "totalBytesBilled": "491782144", "totalBytesProcessed": "490943434", "totalPartitionsProcessed": "0", "totalSlotMs": "352066", "transferredBytes": "0" }, "startTime": "1665778470252", "totalBytesProcessed": "490943434", "totalSlotMs": "352066" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6df09eae_1b5b_4c59_b9e4_116ee3c0bba2" }, "priority": "INTERACTIVE", "query": "select i_item_desc\n ,w_warehouse_name\n ,d1.d_week_seq\n ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n and inv_quantity_on_hand < cs_quantity \n and d3.d_date > d1.d_date + 5\n and hd_buy_potential = '1001-5000'\n and d1.d_year = 1998\n and cd_marital_status = 'S'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "sxQM9IZhCW7dx2b/dbUqrQ==", "id": "test-project-364309:europe-west1.query72_1665778481", "jobReference": { "jobId": "query72_1665778481", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query72_1665778481?location=europe-west1", "statistics": { "creationTime": "1665778481674", "endTime": "1665778491230", "finalExecutionDurationMs": "9250", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "490943434", "performanceInsights": { "avgPreviousExecutionMs": "8139" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "103", "computeMsMax": "103", "computeRatioAvg": 0.011226158038147138, "computeRatioMax": 0.011226158038147138, "endMs": "1665778482025", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0011989100817438691, "readRatioMax": 0.0011989100817438691, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "2593206", "shuffleOutputBytesSpilled": "0", "slotMs": "135", "startMs": "1665778481913", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00021798365122615803, "waitRatioMax": 0.00021798365122615803, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0017438692098092643, "writeRatioMax": 0.0017438692098092643 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0005449591280653951, "computeRatioMax": 0.0005449591280653951, "endMs": "1665778481966", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00032697547683923706, "readRatioMax": 0.00032697547683923706, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778481930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00021798365122615803, "waitRatioMax": 0.00021798365122615803, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0016348773841961854, "writeRatioMax": 0.0016348773841961854 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.006321525885558583, "computeRatioMax": 0.006321525885558583, "endMs": "1665778482005", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0014168937329700274, "readRatioMax": 0.0014168937329700274, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665778481947", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00010899182561307902, "waitRatioMax": 0.00010899182561307902, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0010899182561307902, "writeRatioMax": 0.0010899182561307902 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.00446866485013624, "computeRatioMax": 0.00446866485013624, "endMs": "1665778482001", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0006539509536784741, "readRatioMax": 0.0006539509536784741, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778481962", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00010899182561307902, "waitRatioMax": 0.00010899182561307902, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0010899182561307902, "writeRatioMax": 0.0010899182561307902 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0011989100817438691, "computeRatioMax": 0.0011989100817438691, "endMs": "1665778482065", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0005449591280653951, "readRatioMax": 0.0005449591280653951, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "8395", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665778482002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date, $42:d_week_seq, $43:d_year", "FROM date_dim", "WHERE equal($43, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage04_output" ] } ], "waitMsAvg": "26", "waitMsMax": "26", "waitRatioAvg": 0.0028337874659400547, "waitRatioMax": 0.0028337874659400547, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.0039237057220708445, "writeRatioMax": 0.0039237057220708445 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0018528610354223434, "computeRatioMax": 0.0018528610354223434, "endMs": "1665778482054", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0008719346049046321, "readRatioMax": 0.0008719346049046321, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778482006", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:hd_demo_sk, $51:hd_buy_potential", "FROM household_demographics", "WHERE equal($51, '1001-5000')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.0015258855585831062, "waitRatioMax": 0.0015258855585831062, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.002070844686648501, "writeRatioMax": 0.002070844686648501 }, { "completedParallelInputs": "1", "computeMsAvg": "136", "computeMsMax": "136", "computeRatioAvg": 0.014822888283378747, "computeRatioMax": 0.014822888283378747, "endMs": "1665778482147", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0014168937329700274, "readRatioMax": 0.0014168937329700274, "recordsRead": "1920800", "recordsWritten": "384160", "shuffleOutputBytes": "3457440", "shuffleOutputBytesSpilled": "0", "slotMs": "157", "startMs": "1665778482026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cd_demo_sk, $71:cd_marital_status", "FROM customer_demographics", "WHERE equal($71, 'S')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage06_output" ] } ], "waitMsAvg": "17", "waitMsMax": "17", "waitRatioAvg": 0.0018528610354223434, "waitRatioMax": 0.0018528610354223434, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.0022888283378746594, "writeRatioMax": 0.0022888283378746594 }, { "completedParallelInputs": "1", "computeMsAvg": "65", "computeMsMax": "65", "computeRatioAvg": 0.007084468664850136, "computeRatioMax": 0.007084468664850136, "endMs": "1665778482110", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0009809264305177111, "readRatioMax": 0.0009809264305177111, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2054502", "shuffleOutputBytesSpilled": "0", "slotMs": "88", "startMs": "1665778482026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00021798365122615803, "waitRatioMax": 0.00021798365122615803, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0017438692098092643, "writeRatioMax": 0.0017438692098092643 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0008719346049046321, "computeRatioMax": 0.0008719346049046321, "endMs": "1665778482082", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.00043596730245231606, "readRatioMax": 0.00043596730245231606, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778482040", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00010899182561307902, "waitRatioMax": 0.00010899182561307902, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.0021798365122615805, "writeRatioMax": 0.0021798365122615805 }, { "completedParallelInputs": "1", "computeMsAvg": "7286", "computeMsMax": "7286", "computeRatioAvg": 0.7941144414168937, "computeRatioMax": 0.7941144414168937, "endMs": "1665778485891", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "34", "readMsMax": "34", "readRatioAvg": 0.0037057220708446867, "readRatioMax": 0.0037057220708446867, "recordsRead": "11745000", "recordsWritten": "11745000", "shuffleOutputBytes": "418124696", "shuffleOutputBytesSpilled": "0", "slotMs": "5583", "startMs": "1665778482059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:inv_date_sk, $101:inv_item_sk, $102:inv_warehouse_sk, $103:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00021798365122615803, "waitRatioMax": 0.00021798365122615803, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0007629427792915531, "writeRatioMax": 0.0007629427792915531 }, { "completedParallelInputs": "5", "computeMsAvg": "456", "computeMsMax": "581", "computeRatioAvg": 0.04970027247956403, "computeRatioMax": 0.06332425068119892, "endMs": "1665778482400", "id": "10", "name": "S0A: Input", "parallelInputs": "5", "readMsAvg": "21", "readMsMax": "26", "readRatioAvg": 0.0022888283378746594, "readRatioMax": 0.0028337874659400547, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "103448560", "shuffleOutputBytesSpilled": "0", "slotMs": "1965", "startMs": "1665778482074", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:cs_sold_date_sk, $91:cs_ship_date_sk, $92:cs_bill_cdemo_sk, $93:cs_bill_hdemo_sk, $94:cs_item_sk, $95:cs_promo_sk, $96:cs_order_number, $97:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00010899182561307902, "waitRatioMax": 0.00021798365122615803, "writeMsAvg": "27", "writeMsMax": "34", "writeRatioAvg": 0.0029427792915531336, "writeRatioMax": 0.0037057220708446867 }, { "completedParallelInputs": "100", "computeMsAvg": "3620", "computeMsMax": "9175", "computeRatioAvg": 0.39455040871934605, "computeRatioMax": 1, "endMs": "1665778490855", "id": "11", "inputStages": [ "10", "6", "4", "9", "3", "0", "7", "2", "1", "8", "5" ], "name": "S0B: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "82606048", "recordsWritten": "2232", "shuffleOutputBytes": "353924", "shuffleOutputBytesSpilled": "0", "slotMs": "312996", "startMs": "1665778485904", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $272, $281 := $273, $282 := $271", "$120 := SUM($131)", "$121 := SUM($130)", "$122 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(not(is_null($270)), 1, 0)", "$131 := case_no_value(is_null($270), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $265, $271 := $260, $272 := $261, $273 := $262", "LEFT OUTER HASH JOIN EACH WITH ALL ON $263 = $1, $264 = $2" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $253, $263 := $254, $264 := $256, $265 := $10", "LEFT OUTER HASH JOIN EACH WITH ALL ON $255 = $10" ] }, { "kind": "FILTER", "substeps": [ "greater($257, add($250, 5))" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $243, $254 := $245, $255 := $246, $256 := $247, $257 := $21", "INNER HASH JOIN EACH WITH ALL ON $244 = $20" ] }, { "kind": "JOIN", "substeps": [ "$240 := $237, $241 := $238, $242 := $230, $243 := $231, $244 := $232, $245 := $233, $246 := $234, $247 := $235", "INNER HASH JOIN EACH WITH ALL ON $236 = $30, $238 = $31" ] }, { "kind": "JOIN", "substeps": [ "$230 := $210, $231 := $211, $232 := $213, $233 := $214, $234 := $215, $235 := $216, $236 := $217, $237 := $41, $238 := $42", "INNER HASH JOIN EACH WITH ALL ON $212 = $40" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $193, $214 := $195, $215 := $196, $216 := $197, $217 := $198", "INNER HASH JOIN EACH WITH ALL ON $194 = $50" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $170, $192 := $171, $193 := $172, $194 := $174, $195 := $175, $196 := $176, $197 := $177, $198 := $178", "INNER HASH JOIN EACH WITH ALL ON $173 = $70" ] }, { "kind": "JOIN", "substeps": [ "$170 := $168, $171 := $160, $172 := $161, $173 := $162, $174 := $163, $175 := $164, $176 := $165, $177 := $166, $178 := $167, $179 := $61", "INNER HASH JOIN EACH WITH ALL ON $164 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $148, $168 := $81", "INNER HASH JOIN EACH WITH ALL ON $149 = $80" ] }, { "kind": "FILTER", "substeps": [ "less($150, $147)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $90, $141 := $91, $142 := $92, $143 := $93, $144 := $94, $145 := $95, $146 := $96, $147 := $97, $148 := $100, $149 := $102, $150 := $103", "INNER HASH JOIN EACH WITH EACH ON $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$282, $280, $281, $120, $121, $122", "TO __stage0B_output", "BY HASH($280, $281, $282)" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.0005449591280653951, "waitRatioMax": 0.0007629427792915531, "writeMsAvg": "5", "writeMsMax": "50", "writeRatioAvg": 0.0005449591280653951, "writeRatioMax": 0.005449591280653951 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0014168937329700274, "computeRatioMax": 0.0014168937329700274, "endMs": "1665778491072", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2232", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665778491058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$282, $280, $281, $120, $121, $122", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$112 DESC, $290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282", "$110 := SUM($120)", "$111 := SUM($121)", "$112 := SUM_OF_COUNTS($122)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $303, $304, $305", "TO __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00032697547683923706, "waitRatioMax": 0.00032697547683923706, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00010899182561307902, "writeRatioMax": 0.00010899182561307902 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0009809264305177111, "computeRatioMax": 0.0009809264305177111, "endMs": "1665778491106", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778491073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $303, $304, $305", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$305 DESC, $301 ASC, $302 ASC, $300 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00010899182561307902, "waitRatioMax": 0.00010899182561307902, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.0026158038147138965, "writeRatioMax": 0.0026158038147138965 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "657", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2663" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "1635", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4016" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "2636", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "5478" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "3636", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6944" }, { "activeUnits": "100", "completedUnits": "30", "elapsedMs": "5563", "estimatedRunnableUnits": "0", "pendingUnits": "85", "totalSlotMs": "187199" }, { "activeUnits": "52", "completedUnits": "102", "elapsedMs": "6602", "estimatedRunnableUnits": "0", "pendingUnits": "13", "totalSlotMs": "294915" }, { "activeUnits": "12", "completedUnits": "114", "elapsedMs": "7630", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "315597" }, { "activeUnits": "2", "completedUnits": "117", "elapsedMs": "9412", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "321286" } ], "totalBytesBilled": "491782144", "totalBytesProcessed": "490943434", "totalPartitionsProcessed": "0", "totalSlotMs": "321286", "transferredBytes": "0" }, "startTime": "1665778481757", "totalBytesProcessed": "490943434", "totalSlotMs": "321286" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7ed0d5cc_f8e0_4e12_b2e0_94a663162cbb" }, "priority": "INTERACTIVE", "query": "select i_item_desc\n ,w_warehouse_name\n ,d1.d_week_seq\n ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n and inv_quantity_on_hand < cs_quantity \n and d3.d_date > d1.d_date + 5\n and hd_buy_potential = '1001-5000'\n and d1.d_year = 1998\n and cd_marital_status = 'S'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "d27MXdSN+IJDES2TPKXATw==", "id": "test-project-364309:europe-west1.query72_1665778492", "jobReference": { "jobId": "query72_1665778492", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query72_1665778492?location=europe-west1", "statistics": { "creationTime": "1665778493241", "endTime": "1665778503457", "finalExecutionDurationMs": "9945", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "490943434", "performanceInsights": { "avgPreviousExecutionMs": "8262" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "106", "computeMsMax": "106", "computeRatioAvg": 0.012504423734811844, "computeRatioMax": 0.012504423734811844, "endMs": "1665778493549", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00070779756989501, "readRatioMax": 0.00070779756989501, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "2593206", "shuffleOutputBytesSpilled": "0", "slotMs": "114", "startMs": "1665778493454", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002359325232983367, "waitRatioMax": 0.0002359325232983367, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.001061696354842515, "writeRatioMax": 0.001061696354842515 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0015335614014391884, "computeRatioMax": 0.0015335614014391884, "endMs": "1665778493525", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00070779756989501, "readRatioMax": 0.00070779756989501, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778493475", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002359325232983367, "waitRatioMax": 0.0002359325232983367, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.002477291494632535, "writeRatioMax": 0.002477291494632535 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.004600684204317565, "computeRatioMax": 0.004600684204317565, "endMs": "1665778493556", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0009437300931933467, "readRatioMax": 0.0009437300931933467, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665778493498", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002359325232983367, "waitRatioMax": 0.0002359325232983367, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0015335614014391884, "writeRatioMax": 0.0015335614014391884 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.005072549250914238, "computeRatioMax": 0.005072549250914238, "endMs": "1665778493563", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00070779756989501, "readRatioMax": 0.00070779756989501, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778493516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002359325232983367, "waitRatioMax": 0.0002359325232983367, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.00141559513979002, "writeRatioMax": 0.00141559513979002 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0011796626164916834, "computeRatioMax": 0.0011796626164916834, "endMs": "1665778493610", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0011796626164916834, "readRatioMax": 0.0011796626164916834, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "8395", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778493551", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date, $42:d_week_seq, $43:d_year", "FROM date_dim", "WHERE equal($43, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage04_output" ] } ], "waitMsAvg": "16", "waitMsMax": "16", "waitRatioAvg": 0.0018874601863866935, "waitRatioMax": 0.0018874601863866935, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0015335614014391884, "writeRatioMax": 0.0015335614014391884 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0012976288781408518, "computeRatioMax": 0.0012976288781408518, "endMs": "1665778493607", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0011796626164916834, "readRatioMax": 0.0011796626164916834, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778493557", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:hd_demo_sk, $51:hd_buy_potential", "FROM household_demographics", "WHERE equal($51, '1001-5000')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00011796626164916834, "waitRatioMax": 0.00011796626164916834, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.002477291494632535, "writeRatioMax": 0.002477291494632535 }, { "completedParallelInputs": "1", "computeMsAvg": "131", "computeMsMax": "131", "computeRatioAvg": 0.015453580276041053, "computeRatioMax": 0.015453580276041053, "endMs": "1665778493715", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.001769493924737525, "readRatioMax": 0.001769493924737525, "recordsRead": "1920800", "recordsWritten": "384160", "shuffleOutputBytes": "3457440", "shuffleOutputBytesSpilled": "0", "slotMs": "165", "startMs": "1665778493581", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cd_demo_sk, $71:cd_marital_status", "FROM customer_demographics", "WHERE equal($71, 'S')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.000353898784947505, "waitRatioMax": 0.000353898784947505, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.0033030553261767133, "writeRatioMax": 0.0033030553261767133 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.006134245605756754, "computeRatioMax": 0.006134245605756754, "endMs": "1665778493665", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0012976288781408518, "readRatioMax": 0.0012976288781408518, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2054502", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665778493600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00011796626164916834, "waitRatioMax": 0.00011796626164916834, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0011796626164916834, "writeRatioMax": 0.0011796626164916834 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.00283119027958004, "computeRatioMax": 0.00283119027958004, "endMs": "1665778493670", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.001061696354842515, "readRatioMax": 0.001061696354842515, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778493623", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002359325232983367, "waitRatioMax": 0.0002359325232983367, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0016515276630883566, "writeRatioMax": 0.0016515276630883566 }, { "completedParallelInputs": "1", "computeMsAvg": "8310", "computeMsMax": "8310", "computeRatioAvg": 0.9802996343045889, "computeRatioMax": 0.9802996343045889, "endMs": "1665778498305", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.00424678541937006, "readRatioMax": 0.00424678541937006, "recordsRead": "11745000", "recordsWritten": "11745000", "shuffleOutputBytes": "418124696", "shuffleOutputBytesSpilled": "0", "slotMs": "6926", "startMs": "1665778493641", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:inv_date_sk, $101:inv_item_sk, $102:inv_warehouse_sk, $103:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.000353898784947505, "waitRatioMax": 0.000353898784947505, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.00141559513979002, "writeRatioMax": 0.00141559513979002 }, { "completedParallelInputs": "5", "computeMsAvg": "438", "computeMsMax": "652", "computeRatioAvg": 0.05166922260233573, "computeRatioMax": 0.07691400259525775, "endMs": "1665778493998", "id": "10", "name": "S0A: Input", "parallelInputs": "5", "readMsAvg": "18", "readMsMax": "21", "readRatioAvg": 0.00212339270968503, "readRatioMax": 0.002477291494632535, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "103448560", "shuffleOutputBytesSpilled": "0", "slotMs": "1935", "startMs": "1665778493658", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:cs_sold_date_sk, $91:cs_ship_date_sk, $92:cs_bill_cdemo_sk, $93:cs_bill_hdemo_sk, $94:cs_item_sk, $95:cs_promo_sk, $96:cs_order_number, $97:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002359325232983367, "waitRatioMax": 0.0002359325232983367, "writeMsAvg": "25", "writeMsMax": "33", "writeRatioAvg": 0.0029491565412292082, "writeRatioMax": 0.003892886634422555 }, { "completedParallelInputs": "100", "computeMsAvg": "3666", "computeMsMax": "8477", "computeRatioAvg": 0.4324643152058511, "computeRatioMax": 1, "endMs": "1665778503262", "id": "11", "inputStages": [ "10", "6", "5", "1", "0", "8", "9", "3", "4", "2", "7" ], "name": "S0B: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "82606048", "recordsWritten": "2232", "shuffleOutputBytes": "353924", "shuffleOutputBytesSpilled": "0", "slotMs": "347349", "startMs": "1665778498315", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $272, $281 := $273, $282 := $271", "$120 := SUM($131)", "$121 := SUM($130)", "$122 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(not(is_null($270)), 1, 0)", "$131 := case_no_value(is_null($270), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $265, $271 := $260, $272 := $261, $273 := $262", "LEFT OUTER HASH JOIN EACH WITH ALL ON $263 = $1, $264 = $2" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $253, $263 := $254, $264 := $256, $265 := $10", "LEFT OUTER HASH JOIN EACH WITH ALL ON $255 = $10" ] }, { "kind": "FILTER", "substeps": [ "greater($257, add($250, 5))" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $243, $254 := $245, $255 := $246, $256 := $247, $257 := $21", "INNER HASH JOIN EACH WITH ALL ON $244 = $20" ] }, { "kind": "JOIN", "substeps": [ "$240 := $237, $241 := $238, $242 := $230, $243 := $231, $244 := $232, $245 := $233, $246 := $234, $247 := $235", "INNER HASH JOIN EACH WITH ALL ON $236 = $30, $238 = $31" ] }, { "kind": "JOIN", "substeps": [ "$230 := $210, $231 := $211, $232 := $213, $233 := $214, $234 := $215, $235 := $216, $236 := $217, $237 := $41, $238 := $42", "INNER HASH JOIN EACH WITH ALL ON $212 = $40" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $193, $214 := $195, $215 := $196, $216 := $197, $217 := $198", "INNER HASH JOIN EACH WITH ALL ON $194 = $50" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $170, $192 := $171, $193 := $172, $194 := $174, $195 := $175, $196 := $176, $197 := $177, $198 := $178", "INNER HASH JOIN EACH WITH ALL ON $173 = $70" ] }, { "kind": "JOIN", "substeps": [ "$170 := $168, $171 := $160, $172 := $161, $173 := $162, $174 := $163, $175 := $164, $176 := $165, $177 := $166, $178 := $167, $179 := $61", "INNER HASH JOIN EACH WITH ALL ON $164 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $148, $168 := $81", "INNER HASH JOIN EACH WITH ALL ON $149 = $80" ] }, { "kind": "FILTER", "substeps": [ "less($150, $147)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $90, $141 := $91, $142 := $92, $143 := $93, $144 := $94, $145 := $95, $146 := $96, $147 := $97, $148 := $100, $149 := $102, $150 := $103", "INNER HASH JOIN EACH WITH EACH ON $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$282, $280, $281, $120, $121, $122", "TO __stage0B_output", "BY HASH($280, $281, $282)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.000353898784947505, "waitRatioMax": 0.0004718650465966734, "writeMsAvg": "5", "writeMsMax": "12", "writeRatioAvg": 0.0005898313082458417, "writeRatioMax": 0.00141559513979002 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0020054264480358617, "computeRatioMax": 0.0020054264480358617, "endMs": "1665778503308", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2232", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778503283", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$282, $280, $281, $120, $121, $122", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$112 DESC, $290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282", "$110 := SUM($120)", "$111 := SUM($121)", "$112 := SUM_OF_COUNTS($122)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $303, $304, $305", "TO __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.000353898784947505, "waitRatioMax": 0.000353898784947505, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0002359325232983367, "writeRatioMax": 0.0002359325232983367 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0011796626164916834, "computeRatioMax": 0.0011796626164916834, "endMs": "1665778503349", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778503301", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $303, $304, $305", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$305 DESC, $301 ASC, $302 ASC, $300 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002359325232983367, "waitRatioMax": 0.0002359325232983367, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.003185089064527545, "writeRatioMax": 0.003185089064527545 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "12", "elapsedMs": "644", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "1821" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "1175", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3236" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "3624", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6952" }, { "activeUnits": "100", "completedUnits": "15", "elapsedMs": "5497", "estimatedRunnableUnits": "0", "pendingUnits": "100", "totalSlotMs": "45066" }, { "activeUnits": "93", "completedUnits": "54", "elapsedMs": "6800", "estimatedRunnableUnits": "0", "pendingUnits": "61", "totalSlotMs": "246201" }, { "activeUnits": "32", "completedUnits": "99", "elapsedMs": "7822", "estimatedRunnableUnits": "0", "pendingUnits": "16", "totalSlotMs": "321189" }, { "activeUnits": "14", "completedUnits": "111", "elapsedMs": "8882", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "349623" }, { "activeUnits": "4", "completedUnits": "117", "elapsedMs": "10091", "estimatedRunnableUnits": "10", "pendingUnits": "0", "totalSlotMs": "356984" } ], "totalBytesBilled": "491782144", "totalBytesProcessed": "490943434", "totalPartitionsProcessed": "0", "totalSlotMs": "356984", "transferredBytes": "0" }, "startTime": "1665778493312", "totalBytesProcessed": "490943434", "totalSlotMs": "356984" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona038ba20_4ce7_4f28_abf4_7c2ad80b1358" }, "priority": "INTERACTIVE", "query": "select i_item_desc\n ,w_warehouse_name\n ,d1.d_week_seq\n ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n and inv_quantity_on_hand < cs_quantity \n and d3.d_date > d1.d_date + 5\n and hd_buy_potential = '1001-5000'\n and d1.d_year = 1998\n and cd_marital_status = 'S'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "HE2YKSZTUT+xfKabUQvzfw==", "id": "test-project-364309:europe-west1.query72_1665778506", "jobReference": { "jobId": "query72_1665778506", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query72_1665778506?location=europe-west1", "statistics": { "creationTime": "1665778506824", "endTime": "1665778514599", "finalExecutionDurationMs": "7497", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "490943434", "performanceInsights": { "avgPreviousExecutionMs": "8431" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "69", "computeMsMax": "69", "computeRatioAvg": 0.009077752927246415, "computeRatioMax": 0.009077752927246415, "endMs": "1665778507119", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010524930930140772, "readRatioMax": 0.0010524930930140772, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "2593206", "shuffleOutputBytesSpilled": "0", "slotMs": "102", "startMs": "1665778507035", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013156163662675965, "waitRatioMax": 0.00013156163662675965, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0015787396395211155, "writeRatioMax": 0.0015787396395211155 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.001447178002894356, "computeRatioMax": 0.001447178002894356, "endMs": "1665778507102", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010524930930140772, "readRatioMax": 0.0010524930930140772, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778507054", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013156163662675965, "waitRatioMax": 0.00013156163662675965, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0023681094592816736, "writeRatioMax": 0.0023681094592816736 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.004341534008683068, "computeRatioMax": 0.004341534008683068, "endMs": "1665778507115", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009209314563873174, "readRatioMax": 0.0009209314563873174, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778507073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013156163662675965, "waitRatioMax": 0.00013156163662675965, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0017103012761478752, "writeRatioMax": 0.0017103012761478752 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.004999342191816867, "computeRatioMax": 0.004999342191816867, "endMs": "1665778507136", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009209314563873174, "readRatioMax": 0.0009209314563873174, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778507092", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013156163662675965, "waitRatioMax": 0.00013156163662675965, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0017103012761478752, "writeRatioMax": 0.0017103012761478752 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0015787396395211155, "computeRatioMax": 0.0015787396395211155, "endMs": "1665778507152", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0007893698197605578, "readRatioMax": 0.0007893698197605578, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "8395", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778507116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date, $42:d_week_seq, $43:d_year", "FROM date_dim", "WHERE equal($43, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage04_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.0006578081831337982, "waitRatioMax": 0.0006578081831337982, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0024996710959084333, "writeRatioMax": 0.0024996710959084333 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0006578081831337982, "computeRatioMax": 0.0006578081831337982, "endMs": "1665778507170", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005262465465070386, "readRatioMax": 0.0005262465465070386, "recordsRead": "7200", "recordsWritten": "1200", "shuffleOutputBytes": "10800", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778507132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:hd_demo_sk, $51:hd_buy_potential", "FROM household_demographics", "WHERE equal($51, '1001-5000')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0005262465465070386, "waitRatioMax": 0.0005262465465070386, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002236547822654914, "writeRatioMax": 0.002236547822654914 }, { "completedParallelInputs": "1", "computeMsAvg": "176", "computeMsMax": "176", "computeRatioAvg": 0.023154848046309694, "computeRatioMax": 0.023154848046309694, "endMs": "1665778507266", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0011840547296408368, "readRatioMax": 0.0011840547296408368, "recordsRead": "1920800", "recordsWritten": "384160", "shuffleOutputBytes": "3457440", "shuffleOutputBytesSpilled": "0", "slotMs": "126", "startMs": "1665778507147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cd_demo_sk, $71:cd_marital_status", "FROM customer_demographics", "WHERE equal($71, 'S')" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013156163662675965, "waitRatioMax": 0.00013156163662675965, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0024996710959084333, "writeRatioMax": 0.0024996710959084333 }, { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.006051835284830943, "computeRatioMax": 0.006051835284830943, "endMs": "1665778507219", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009209314563873174, "readRatioMax": 0.0009209314563873174, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2054502", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665778507168", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:i_item_sk, $61:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002631232732535193, "waitRatioMax": 0.0002631232732535193, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0010524930930140772, "writeRatioMax": 0.0010524930930140772 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0007893698197605578, "computeRatioMax": 0.0007893698197605578, "endMs": "1665778507231", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0003946849098802789, "readRatioMax": 0.0003946849098802789, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778507192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:w_warehouse_sk, $81:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002631232732535193, "waitRatioMax": 0.0002631232732535193, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0023681094592816736, "writeRatioMax": 0.0023681094592816736 }, { "completedParallelInputs": "1", "computeMsAvg": "5620", "computeMsMax": "5620", "computeRatioAvg": 0.7393763978423892, "computeRatioMax": 0.7393763978423892, "endMs": "1665778510055", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.0030259176424154714, "readRatioMax": 0.0030259176424154714, "recordsRead": "11745000", "recordsWritten": "11745000", "shuffleOutputBytes": "418124696", "shuffleOutputBytesSpilled": "0", "slotMs": "4494", "startMs": "1665778507212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:inv_date_sk, $101:inv_item_sk, $102:inv_warehouse_sk, $103:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013156163662675965, "waitRatioMax": 0.00013156163662675965, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0009209314563873174, "writeRatioMax": 0.0009209314563873174 }, { "completedParallelInputs": "5", "computeMsAvg": "499", "computeMsMax": "621", "computeRatioAvg": 0.06564925667675306, "computeRatioMax": 0.08169977634521773, "endMs": "1665778507568", "id": "10", "name": "S0A: Input", "parallelInputs": "5", "readMsAvg": "19", "readMsMax": "22", "readRatioAvg": 0.0024996710959084333, "readRatioMax": 0.002894356005788712, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "103448560", "shuffleOutputBytesSpilled": "0", "slotMs": "2117", "startMs": "1665778507229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:cs_sold_date_sk, $91:cs_ship_date_sk, $92:cs_bill_cdemo_sk, $93:cs_bill_hdemo_sk, $94:cs_item_sk, $95:cs_promo_sk, $96:cs_order_number, $97:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013156163662675965, "waitRatioMax": 0.00013156163662675965, "writeMsAvg": "24", "writeMsMax": "30", "writeRatioAvg": 0.003157479279042231, "writeRatioMax": 0.003946849098802789 }, { "completedParallelInputs": "100", "computeMsAvg": "3582", "computeMsMax": "7601", "computeRatioAvg": 0.471253782397053, "computeRatioMax": 1, "endMs": "1665778514316", "id": "11", "inputStages": [ "10", "5", "9", "7", "3", "2", "1", "0", "6", "8", "4" ], "name": "S0B: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "82606048", "recordsWritten": "2232", "shuffleOutputBytes": "353924", "shuffleOutputBytesSpilled": "0", "slotMs": "323904", "startMs": "1665778510071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $272, $281 := $273, $282 := $271", "$120 := SUM($131)", "$121 := SUM($130)", "$122 := COUNT_STAR()" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(not(is_null($270)), 1, 0)", "$131 := case_no_value(is_null($270), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $265, $271 := $260, $272 := $261, $273 := $262", "LEFT OUTER HASH JOIN EACH WITH ALL ON $263 = $1, $264 = $2" ] }, { "kind": "JOIN", "substeps": [ "$260 := $251, $261 := $252, $262 := $253, $263 := $254, $264 := $256, $265 := $10", "LEFT OUTER HASH JOIN EACH WITH ALL ON $255 = $10" ] }, { "kind": "FILTER", "substeps": [ "greater($257, add($250, 5))" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $241, $252 := $242, $253 := $243, $254 := $245, $255 := $246, $256 := $247, $257 := $21", "INNER HASH JOIN EACH WITH ALL ON $244 = $20" ] }, { "kind": "JOIN", "substeps": [ "$240 := $237, $241 := $238, $242 := $230, $243 := $231, $244 := $232, $245 := $233, $246 := $234, $247 := $235", "INNER HASH JOIN EACH WITH ALL ON $236 = $30, $238 = $31" ] }, { "kind": "JOIN", "substeps": [ "$230 := $210, $231 := $211, $232 := $213, $233 := $214, $234 := $215, $235 := $216, $236 := $217, $237 := $41, $238 := $42", "INNER HASH JOIN EACH WITH ALL ON $212 = $40" ] }, { "kind": "JOIN", "substeps": [ "$210 := $190, $211 := $191, $212 := $192, $213 := $193, $214 := $195, $215 := $196, $216 := $197, $217 := $198", "INNER HASH JOIN EACH WITH ALL ON $194 = $50" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $170, $192 := $171, $193 := $172, $194 := $174, $195 := $175, $196 := $176, $197 := $177, $198 := $178", "INNER HASH JOIN EACH WITH ALL ON $173 = $70" ] }, { "kind": "JOIN", "substeps": [ "$170 := $168, $171 := $160, $172 := $161, $173 := $162, $174 := $163, $175 := $164, $176 := $165, $177 := $166, $178 := $167, $179 := $61", "INNER HASH JOIN EACH WITH ALL ON $164 = $60" ] }, { "kind": "JOIN", "substeps": [ "$160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $148, $168 := $81", "INNER HASH JOIN EACH WITH ALL ON $149 = $80" ] }, { "kind": "FILTER", "substeps": [ "less($150, $147)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $90, $141 := $91, $142 := $92, $143 := $93, $144 := $94, $145 := $95, $146 := $96, $147 := $97, $148 := $100, $149 := $102, $150 := $103", "INNER HASH JOIN EACH WITH EACH ON $94 = $101" ] }, { "kind": "WRITE", "substeps": [ "$282, $280, $281, $120, $121, $122", "TO __stage0B_output", "BY HASH($280, $281, $282)" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.0002631232732535193, "waitRatioMax": 0.0006578081831337982, "writeMsAvg": "4", "writeMsMax": "11", "writeRatioAvg": 0.0005262465465070386, "writeRatioMax": 0.001447178002894356 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.0023681094592816736, "computeRatioMax": 0.0023681094592816736, "endMs": "1665778514413", "id": "12", "inputStages": [ "11" ], "name": "S0C: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2232", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778514394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$282, $280, $281, $120, $121, $122", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$112 DESC, $290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282", "$110 := SUM($120)", "$111 := SUM($121)", "$112 := SUM_OF_COUNTS($122)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $303, $304, $305", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013156163662675965, "waitRatioMax": 0.00013156163662675965, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0002631232732535193, "writeRatioMax": 0.0002631232732535193 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.001447178002894356, "computeRatioMax": 0.001447178002894356, "endMs": "1665778514487", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15000", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665778514422", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $303, $304, $305", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$305 DESC, $301 ASC, $302 ASC, $300 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0005262465465070386, "waitRatioMax": 0.0005262465465070386, "writeMsAvg": "52", "writeMsMax": "52", "writeRatioAvg": 0.006841205104591501, "writeRatioMax": 0.006841205104591501 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "13", "elapsedMs": "644", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "2351" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "1177", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3672" }, { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "2621", "estimatedRunnableUnits": "5", "pendingUnits": "1", "totalSlotMs": "6083" }, { "activeUnits": "100", "completedUnits": "24", "elapsedMs": "4261", "estimatedRunnableUnits": "0", "pendingUnits": "91", "totalSlotMs": "137599" }, { "activeUnits": "75", "completedUnits": "76", "elapsedMs": "5269", "estimatedRunnableUnits": "0", "pendingUnits": "39", "totalSlotMs": "273333" }, { "activeUnits": "24", "completedUnits": "111", "elapsedMs": "6306", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "318698" }, { "activeUnits": "6", "completedUnits": "117", "elapsedMs": "7648", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "331152" } ], "totalBytesBilled": "491782144", "totalBytesProcessed": "490943434", "totalPartitionsProcessed": "0", "totalSlotMs": "331152", "transferredBytes": "0" }, "startTime": "1665778506893", "totalBytesProcessed": "490943434", "totalSlotMs": "331152" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
