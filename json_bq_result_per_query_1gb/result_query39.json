{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon139d4b13_6279_487e_b228_5890fc7b529d" }, "priority": "INTERACTIVE", "query": "-- start query 39 in stream 0 using template query39.tpl\n/*\nThis query contains multiple, related iterations:\n Iteration 1: Calculate the coefficient of variation and mean of every item and warehouse of two consecutive months\n Iteration 2: Find items that had a coefficient of variation in the first months of 1.5 or large\n*/\n\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\n and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\n\n-- end query 39 in stream 0 using template query39.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "BHcpW2Bpyc7Sxv9KnNXgvQ==", "id": "test-project-364309:europe-west1.query39_1665768338", "jobReference": { "jobId": "query39_1665768338", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query39_1665768338?location=europe-west1", "statistics": { "creationTime": "1665768338612", "endTime": "1665768346121", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "w_warehouse_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "w_warehouse_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean_1", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov_1", "type": "FLOAT" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "746586112", "totalBytesProcessed": "746083980", "totalSlotMs": "20453" }, "startTime": "1665768338668", "totalBytesProcessed": "746083980", "totalSlotMs": "20453" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon276f9f71_bfa3_406e_8b8a_c5c75c646059" }, "priority": "INTERACTIVE", "query": "-- start query 39 in stream 0 using template query39.tpl\n/*\nThis query contains multiple, related iterations:\n Iteration 1: Calculate the coefficient of variation and mean of every item and warehouse of two consecutive months\n Iteration 2: Find items that had a coefficient of variation in the first months of 1.5 or large\n*/\n\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\n and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\n\n-- end query 39 in stream 0 using template query39.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "3YQxZIybeD2S7Gmcd6AAzg==", "id": "test-project-364309:europe-west1.query39_1665777376", "jobReference": { "jobId": "query39_1665777376", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query39_1665777376?location=europe-west1", "statistics": { "creationTime": "1665777377497", "endTime": "1665777385861", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "w_warehouse_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "w_warehouse_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean_1", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov_1", "type": "FLOAT" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "746586112", "totalBytesProcessed": "746083980", "totalSlotMs": "20185" }, "startTime": "1665777377574", "totalBytesProcessed": "746083980", "totalSlotMs": "20185" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9fc2c20a_2fd0_467e_926c_6aaf291ea775" }, "priority": "INTERACTIVE", "query": "-- start query 39 in stream 0 using template query39.tpl\n/*\nThis query contains multiple, related iterations:\n Iteration 1: Calculate the coefficient of variation and mean of every item and warehouse of two consecutive months\n Iteration 2: Find items that had a coefficient of variation in the first months of 1.5 or large\n*/\n\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\n and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\n\n-- end query 39 in stream 0 using template query39.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "o28JhwygTM5zddukbR4RpQ==", "id": "test-project-364309:europe-west1.query39_1665777387", "jobReference": { "jobId": "query39_1665777387", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query39_1665777387?location=europe-west1", "statistics": { "creationTime": "1665777388274", "endTime": "1665777394543", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "w_warehouse_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "w_warehouse_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean_1", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov_1", "type": "FLOAT" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "746586112", "totalBytesProcessed": "746083980", "totalSlotMs": "16200" }, "startTime": "1665777388341", "totalBytesProcessed": "746083980", "totalSlotMs": "16200" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb08153ff_aaa8_4e80_974e_c0a94c1b8664" }, "priority": "INTERACTIVE", "query": "-- start query 39 in stream 0 using template query39.tpl\n/*\nThis query contains multiple, related iterations:\n Iteration 1: Calculate the coefficient of variation and mean of every item and warehouse of two consecutive months\n Iteration 2: Find items that had a coefficient of variation in the first months of 1.5 or large\n*/\n\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\n and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\n\n-- end query 39 in stream 0 using template query39.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "TwYXLpEv7xTirXoNIcWUgQ==", "id": "test-project-364309:europe-west1.query39_1665777396", "jobReference": { "jobId": "query39_1665777396", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query39_1665777396?location=europe-west1", "statistics": { "creationTime": "1665777396873", "endTime": "1665777404016", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "w_warehouse_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "w_warehouse_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean_1", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov_1", "type": "FLOAT" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "746586112", "totalBytesProcessed": "746083980", "totalSlotMs": "15654" }, "startTime": "1665777396948", "totalBytesProcessed": "746083980", "totalSlotMs": "15654" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf6320bb9_03dc_40c1_9a66_3b4e937099a3" }, "priority": "INTERACTIVE", "query": "-- start query 39 in stream 0 using template query39.tpl\n/*\nThis query contains multiple, related iterations:\n Iteration 1: Calculate the coefficient of variation and mean of every item and warehouse of two consecutive months\n Iteration 2: Find items that had a coefficient of variation in the first months of 1.5 or large\n*/\n\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\n and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\n\n-- end query 39 in stream 0 using template query39.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "eo/vmlH9UlDS74GGkxqE5Q==", "id": "test-project-364309:europe-west1.query39_1665777406", "jobReference": { "jobId": "query39_1665777406", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query39_1665777406?location=europe-west1", "statistics": { "creationTime": "1665777406598", "endTime": "1665777413637", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "w_warehouse_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "w_warehouse_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean_1", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov_1", "type": "FLOAT" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "746586112", "totalBytesProcessed": "746083980", "totalSlotMs": "17230" }, "startTime": "1665777406645", "totalBytesProcessed": "746083980", "totalSlotMs": "17230" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona32a7047_1893_49e7_9788_a9e051553751" }, "priority": "INTERACTIVE", "query": "-- start query 39 in stream 0 using template query39.tpl\n/*\nThis query contains multiple, related iterations:\n Iteration 1: Calculate the coefficient of variation and mean of every item and warehouse of two consecutive months\n Iteration 2: Find items that had a coefficient of variation in the first months of 1.5 or large\n*/\n\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n from inventory\n ,item\n ,warehouse\n ,date_dim\n where inv_item_sk = i_item_sk\n and inv_warehouse_sk = w_warehouse_sk\n and inv_date_sk = d_date_sk\n and d_year =2001\n group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n and inv1.w_warehouse_sk = inv2.w_warehouse_sk\n and inv1.d_moy=1\n and inv2.d_moy=1+1\n and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n ,inv2.d_moy,inv2.mean, inv2.cov\n;\n\n-- end query 39 in stream 0 using template query39.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "3vE1nogYEIO0zfyxeRo8Ww==", "id": "test-project-364309:europe-west1.query39_1665777415", "jobReference": { "jobId": "query39_1665777415", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query39_1665777415?location=europe-west1", "statistics": { "creationTime": "1665777416248", "endTime": "1665777423514", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "w_warehouse_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "w_warehouse_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "i_item_sk_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "d_moy_1", "type": "INTEGER" }, { "mode": "NULLABLE", "name": "mean_1", "type": "FLOAT" }, { "mode": "NULLABLE", "name": "cov_1", "type": "FLOAT" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "746586112", "totalBytesProcessed": "746083980", "totalSlotMs": "17067" }, "startTime": "1665777416300", "totalBytesProcessed": "746083980", "totalSlotMs": "17067" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
