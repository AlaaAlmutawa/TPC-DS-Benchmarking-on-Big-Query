{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1db6485f_18d8_495b_8d23_d15a5a783995" }, "priority": "INTERACTIVE", "query": "with cs_ui as\n (select cs_item_sk\n ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n from catalog_sales\n ,catalog_returns\n where cs_item_sk = cr_item_sk\n and cs_order_number = cr_order_number\n group by cs_item_sk\n having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n ,i_item_sk item_sk\n ,s_store_name store_name\n ,s_zip store_zip\n ,ad1.ca_street_number b_street_number\n ,ad1.ca_street_name b_street_name\n ,ad1.ca_city b_city\n ,ad1.ca_zip b_zip\n ,ad2.ca_street_number c_street_number\n ,ad2.ca_street_name c_street_name\n ,ad2.ca_city c_city\n ,ad2.ca_zip c_zip\n ,d1.d_year as syear\n ,d2.d_year as fsyear\n ,d3.d_year s2year\n ,count(*) cnt\n ,sum(ss_wholesale_cost) s1\n ,sum(ss_list_price) s2\n ,sum(ss_coupon_amt) s3\n FROM store_sales\n ,store_returns\n ,cs_ui\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,customer\n ,customer_demographics cd1\n ,customer_demographics cd2\n ,promotion\n ,household_demographics hd1\n ,household_demographics hd2\n ,customer_address ad1\n ,customer_address ad2\n ,income_band ib1\n ,income_band ib2\n ,item\n WHERE ss_store_sk = s_store_sk AND\n ss_sold_date_sk = d1.d_date_sk AND\n ss_customer_sk = c_customer_sk AND\n ss_cdemo_sk= cd1.cd_demo_sk AND\n ss_hdemo_sk = hd1.hd_demo_sk AND\n ss_addr_sk = ad1.ca_address_sk and\n ss_item_sk = i_item_sk and\n ss_item_sk = sr_item_sk and\n ss_ticket_number = sr_ticket_number and\n ss_item_sk = cs_ui.cs_item_sk and\n c_current_cdemo_sk = cd2.cd_demo_sk AND\n c_current_hdemo_sk = hd2.hd_demo_sk AND\n c_current_addr_sk = ad2.ca_address_sk and\n c_first_sales_date_sk = d2.d_date_sk and\n c_first_shipto_date_sk = d3.d_date_sk and\n ss_promo_sk = p_promo_sk and\n hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n cd1.cd_marital_status <> cd2.cd_marital_status and\n i_color in ('orange','lace','lawn','misty','blush','pink') and\n i_current_price between 48 and 48 + 10 and\n i_current_price between 48 + 1 and 48 + 15\ngroup by i_product_name\n ,i_item_sk\n ,s_store_name\n ,s_zip\n ,ad1.ca_street_number\n ,ad1.ca_street_name\n ,ad1.ca_city\n ,ad1.ca_zip\n ,ad2.ca_street_number\n ,ad2.ca_street_name\n ,ad2.ca_city\n ,ad2.ca_zip\n ,d1.d_year\n ,d2.d_year\n ,d3.d_year\n)\nselect cs1.product_name\n ,cs1.store_name\n ,cs1.store_zip\n ,cs1.b_street_number\n ,cs1.b_street_name\n ,cs1.b_city\n ,cs1.b_zip\n ,cs1.c_street_number\n ,cs1.c_street_name\n ,cs1.c_city\n ,cs1.c_zip\n ,cs1.syear\n ,cs1.cnt\n ,cs1.s1 as s11\n ,cs1.s2 as s21\n ,cs1.s3 as s31\n ,cs2.s1 as s12\n ,cs2.s2 as s22\n ,cs2.s3 as s32\n ,cs2.syear\n ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n cs1.syear = 1999 and\n cs2.syear = 1999 + 1 and\n cs2.cnt <= cs1.cnt and\n cs1.store_name = cs2.store_name and\n cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n ,cs1.store_name\n ,cs2.cnt\n ,cs1.s1\n ,cs2.s1;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "4KwqD7roel0W94Ssn1zRuQ==", "id": "test-project-364309:europe-west1.query64_1665768413", "jobReference": { "jobId": "query64_1665768413", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query64_1665768413?location=europe-west1", "statistics": { "creationTime": "1665768414154", "endTime": "1665768421246", "finalExecutionDurationMs": "6706", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "421895625", "performanceInsights": { "avgPreviousExecutionMs": "6402" }, "queryPlan": [ { "completedParallelInputs": "5", "computeMsAvg": "258", "computeMsMax": "358", "computeRatioAvg": 0.03676261043032203, "computeRatioMax": 0.051011684240524366, "endMs": "1665768414687", "id": "1", "name": "S01: Input", "parallelInputs": "5", "readMsAvg": "19", "readMsMax": "28", "readRatioAvg": 0.002707324023938444, "readRatioMax": 0.003989740666856654, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "50341364", "shuffleOutputBytesSpilled": "0", "slotMs": "1330", "startMs": "1665768414470", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280:cs_item_sk, $281:cs_order_number, $282:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "18", "writeMsMax": "22", "writeRatioAvg": 0.002564833285836421, "writeRatioMax": 0.003134796238244514 }, { "completedParallelInputs": "1", "computeMsAvg": "236", "computeMsMax": "236", "computeRatioAvg": 0.03362781419207751, "computeRatioMax": 0.03362781419207751, "endMs": "1665768414721", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0021373610715303506, "readRatioMax": 0.0021373610715303506, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "282", "startMs": "1665768414483", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260:cr_item_sk, $261:cr_order_number, $262:cr_refunded_cash, $263:cr_reversed_charge, $264:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021373610715303506, "writeRatioMax": 0.0021373610715303506 }, { "completedParallelInputs": "1", "computeMsAvg": "1895", "computeMsMax": "1895", "computeRatioAvg": 0.2700199487033343, "computeRatioMax": 0.2700199487033343, "endMs": "1665768415848", "id": "4", "inputStages": [ "1" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0017098888572242804, "readRatioMax": 0.0017098888572242804, "recordsRead": "1585615", "recordsWritten": "17862", "shuffleOutputBytes": "767810", "shuffleOutputBytesSpilled": "0", "slotMs": "1699", "startMs": "1665768414700", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290:cr_item_sk, $291:cr_order_number, $292:cr_refunded_cash, $293:cr_reversed_charge, $294:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$280, $281, $282", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $1070", "$470 := SUM($1071)", "$471 := SUM($490)" ] }, { "kind": "COMPUTE", "substeps": [ "$490 := add(add($1072, $1073), $1074)" ] }, { "kind": "JOIN", "substeps": [ "$1072 := $292, $1073 := $293, $1074 := $294, $1070 := $280, $1071 := $282", "INNER HASH JOIN EACH WITH ALL ON $290 = $280, $291 = $281" ] }, { "kind": "WRITE", "substeps": [ "$1080, $470, $471", "TO __stage04_output", "BY HASH($1080)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0008549444286121402, "writeRatioMax": 0.0008549444286121402 }, { "completedParallelInputs": "5", "computeMsAvg": "394", "computeMsMax": "511", "computeRatioAvg": 0.056141350812197205, "computeRatioMax": 0.07281276717013394, "endMs": "1665768415070", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "24", "readRatioAvg": 0.002279851809632374, "readRatioMax": 0.003419777714448561, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "1872", "startMs": "1665768414735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250:cs_item_sk, $251:cs_order_number, $252:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $660", "$460 := SUM($661)", "$461 := SUM($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := add(add($662, $663), $664)" ] }, { "kind": "JOIN", "substeps": [ "$660 := $250, $661 := $252, $662 := $262, $663 := $263, $664 := $264", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261" ] }, { "kind": "WRITE", "substeps": [ "$670, $460, $461", "TO __stage05_output", "BY HASH($670)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "7", "writeMsMax": "12", "writeRatioAvg": 0.0009974351667141636, "writeRatioMax": 0.0017098888572242804 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.0037047591906526076, "computeRatioMax": 0.0037047591906526076, "endMs": "1665768415124", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008549444286121402, "readRatioMax": 0.0008549444286121402, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768415092", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0005699629524080935, "waitRatioMax": 0.0005699629524080935, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014249073810202336, "writeRatioMax": 0.0014249073810202336 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.006269592476489028, "computeRatioMax": 0.006269592476489028, "endMs": "1665768415150", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.001139925904816187, "readRatioMax": 0.001139925904816187, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768415108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0005699629524080935, "waitRatioMax": 0.0005699629524080935, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.001567398119122257, "writeRatioMax": 0.001567398119122257 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.001139925904816187, "computeRatioMax": 0.001139925904816187, "endMs": "1665768415159", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009974351667141636, "readRatioMax": 0.0009974351667141636, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768415123", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_store_name, $42:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.003134796238244514, "writeRatioMax": 0.003134796238244514 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0009974351667141636, "computeRatioMax": 0.0009974351667141636, "endMs": "1665768415179", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005699629524080935, "readRatioMax": 0.0005699629524080935, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768415140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.002279851809632374, "writeRatioMax": 0.002279851809632374 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.007836990595611285, "computeRatioMax": 0.007836990595611285, "endMs": "1665768415241", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0012824166429182104, "readRatioMax": 0.0012824166429182104, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "99", "startMs": "1665768415155", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_street_number, $82:ca_street_name, $83:ca_city, $84:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001994870333428327, "writeRatioMax": 0.001994870333428327 }, { "completedParallelInputs": "1", "computeMsAvg": "54", "computeMsMax": "54", "computeRatioAvg": 0.007694499857509262, "computeRatioMax": 0.007694499857509262, "endMs": "1665768415242", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.001139925904816187, "readRatioMax": 0.001139925904816187, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665768415172", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_street_number, $102:ca_street_name, $103:ca_city, $104:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0004274722143060701, "waitRatioMax": 0.0004274722143060701, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001994870333428327, "writeRatioMax": 0.001994870333428327 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.0032772869763465374, "computeRatioMax": 0.0032772869763465374, "endMs": "1665768415238", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.001567398119122257, "readRatioMax": 0.001567398119122257, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665768415187", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.0037047591906526076, "writeRatioMax": 0.0037047591906526076 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0018523795953263038, "computeRatioMax": 0.0018523795953263038, "endMs": "1665768415260", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007124536905101168, "readRatioMax": 0.0007124536905101168, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665768415201", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "46", "writeMsMax": "46", "writeRatioAvg": 0.006554573952693075, "writeRatioMax": 0.006554573952693075 }, { "completedParallelInputs": "1", "computeMsAvg": "62", "computeMsMax": "62", "computeRatioAvg": 0.00883442576232545, "computeRatioMax": 0.00883442576232545, "endMs": "1665768415276", "id": "14", "inputStages": [ "5" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665768415228", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $460, $461", "FROM __stage05_output" ] }, { "kind": "FILTER", "substeps": [ "greater($440, multiply(NUMERIC<...>, $441))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670", "$440 := SUM($460)", "$441 := SUM($461)" ] }, { "kind": "WRITE", "substeps": [ "$680", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.001139925904816187, "writeRatioMax": 0.001139925904816187 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0017098888572242804, "computeRatioMax": 0.0017098888572242804, "endMs": "1665768415283", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008549444286121402, "readRatioMax": 0.0008549444286121402, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768415242", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year", "FROM date_dim", "WHERE equal($161, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.002279851809632374, "writeRatioMax": 0.002279851809632374 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0018523795953263038, "computeRatioMax": 0.0018523795953263038, "endMs": "1665768415298", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009974351667141636, "readRatioMax": 0.0009974351667141636, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768415256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $193:i_product_name, $191:i_current_price, $192:i_color", "FROM item", "WHERE and(in($192, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($191, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$190, $193", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001994870333428327, "writeRatioMax": 0.001994870333428327 }, { "completedParallelInputs": "1", "computeMsAvg": "133", "computeMsMax": "133", "computeRatioAvg": 0.018951268167569108, "computeRatioMax": 0.018951268167569108, "endMs": "1665768415393", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.001567398119122257, "readRatioMax": 0.001567398119122257, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "144", "startMs": "1665768415270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:sr_item_sk, $181:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$180, $181", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0018523795953263038, "writeRatioMax": 0.0018523795953263038 }, { "completedParallelInputs": "1", "computeMsAvg": "868", "computeMsMax": "868", "computeRatioAvg": 0.12368196067255628, "computeRatioMax": 0.12368196067255628, "endMs": "1665768415784", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014249073810202336, "readRatioMax": 0.0014249073810202336, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "695", "startMs": "1665768415283", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:cd_demo_sk, $221:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$220, $221", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "75", "writeMsMax": "75", "writeRatioAvg": 0.010686805357651753, "writeRatioMax": 0.010686805357651753 }, { "completedParallelInputs": "1", "computeMsAvg": "995", "computeMsMax": "995", "computeRatioAvg": 0.14177828441151324, "computeRatioMax": 0.14177828441151324, "endMs": "1665768415931", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0017098888572242804, "readRatioMax": 0.0017098888572242804, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "835", "startMs": "1665768415296", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240:cd_demo_sk, $241:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "82", "writeMsMax": "82", "writeRatioAvg": 0.011684240524365916, "writeRatioMax": 0.011684240524365916 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.001994870333428327, "computeRatioMax": 0.001994870333428327, "endMs": "1665768415349", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005699629524080935, "readRatioMax": 0.0005699629524080935, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768415310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300:hd_demo_sk, $301:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001994870333428327, "writeRatioMax": 0.001994870333428327 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0018523795953263038, "computeRatioMax": 0.0018523795953263038, "endMs": "1665768415363", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007124536905101168, "readRatioMax": 0.0007124536905101168, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768415323", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320:hd_demo_sk, $321:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001994870333428327, "writeRatioMax": 0.001994870333428327 }, { "completedParallelInputs": "1", "computeMsAvg": "106", "computeMsMax": "106", "computeRatioAvg": 0.015104018238814477, "computeRatioMax": 0.015104018238814477, "endMs": "1665768415441", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009974351667141636, "readRatioMax": 0.0009974351667141636, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "119", "startMs": "1665768415340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360:c_customer_sk, $361:c_current_cdemo_sk, $362:c_current_hdemo_sk, $363:c_current_addr_sk, $364:c_first_shipto_date_sk, $365:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $364, $365", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001994870333428327, "writeRatioMax": 0.001994870333428327 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.005414648047876888, "computeRatioMax": 0.005414648047876888, "endMs": "1665768416188", "id": "25", "name": "S19: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008549444286121402, "readRatioMax": 0.0008549444286121402, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768416153", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0012824166429182104, "writeRatioMax": 0.0012824166429182104 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.003847249928754631, "computeRatioMax": 0.003847249928754631, "endMs": "1665768416200", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008549444286121402, "readRatioMax": 0.0008549444286121402, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768416167", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014249073810202336, "writeRatioMax": 0.0014249073810202336 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.001994870333428327, "computeRatioMax": 0.001994870333428327, "endMs": "1665768416219", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.001139925904816187, "readRatioMax": 0.001139925904816187, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768416182", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_store_name, $52:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0009974351667141636, "writeRatioMax": 0.0009974351667141636 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.001567398119122257, "computeRatioMax": 0.001567398119122257, "endMs": "1665768416238", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009974351667141636, "readRatioMax": 0.0009974351667141636, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768416203", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0012824166429182104, "writeRatioMax": 0.0012824166429182104 }, { "completedParallelInputs": "1", "computeMsAvg": "61", "computeMsMax": "61", "computeRatioAvg": 0.008691935024223425, "computeRatioMax": 0.008691935024223425, "endMs": "1665768416291", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0012824166429182104, "readRatioMax": 0.0012824166429182104, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665768416221", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_street_number, $92:ca_street_name, $93:ca_city, $94:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0024223425477343974, "writeRatioMax": 0.0024223425477343974 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.008121972071815331, "computeRatioMax": 0.008121972071815331, "endMs": "1665768416306", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009974351667141636, "readRatioMax": 0.0009974351667141636, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665768416236", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ca_address_sk, $111:ca_street_number, $112:ca_street_name, $113:ca_city, $114:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114", "TO __stage1E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0024223425477343974, "writeRatioMax": 0.0024223425477343974 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0021373610715303506, "computeRatioMax": 0.0021373610715303506, "endMs": "1665768416291", "id": "31", "name": "S1F: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.001994870333428327, "readRatioMax": 0.001994870333428327, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768416250", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021373610715303506, "writeRatioMax": 0.0021373610715303506 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.001139925904816187, "computeRatioMax": 0.001139925904816187, "endMs": "1665768416303", "id": "32", "name": "S20: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005699629524080935, "readRatioMax": 0.0005699629524080935, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768416264", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage20_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0024223425477343974, "writeRatioMax": 0.0024223425477343974 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.002707324023938444, "computeRatioMax": 0.002707324023938444, "endMs": "1665768416468", "id": "33", "inputStages": [ "4" ], "name": "S21: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17862", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "159", "startMs": "1665768416276", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1080, $470, $471", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "greater($450, multiply(NUMERIC<...>, $451))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080", "$450 := SUM($470)", "$451 := SUM($471)" ] }, { "kind": "WRITE", "substeps": [ "$1090", "TO __stage21_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "177", "writeMsMax": "177", "writeRatioAvg": 0.025220860644058138, "writeRatioMax": 0.025220860644058138 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0018523795953263038, "computeRatioMax": 0.0018523795953263038, "endMs": "1665768416330", "id": "34", "name": "S22: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.001139925904816187, "readRatioMax": 0.001139925904816187, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768416291", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage22_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014249073810202336, "writeRatioMax": 0.0014249073810202336 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0021373610715303506, "computeRatioMax": 0.0021373610715303506, "endMs": "1665768416341", "id": "35", "name": "S23: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009974351667141636, "readRatioMax": 0.0009974351667141636, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768416305", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $213:i_product_name, $211:i_current_price, $212:i_color", "FROM item", "WHERE and(in($212, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($211, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$210, $213", "TO __stage23_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0009974351667141636, "writeRatioMax": 0.0009974351667141636 }, { "completedParallelInputs": "1", "computeMsAvg": "129", "computeMsMax": "129", "computeRatioAvg": 0.018381305215161015, "computeRatioMax": 0.018381305215161015, "endMs": "1665768416458", "id": "36", "name": "S24: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.001139925904816187, "readRatioMax": 0.001139925904816187, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "173", "startMs": "1665768416320", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:sr_item_sk, $201:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$200, $201", "TO __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0018523795953263038, "writeRatioMax": 0.0018523795953263038 }, { "completedParallelInputs": "1", "computeMsAvg": "606", "computeMsMax": "606", "computeRatioAvg": 0.08634938728982616, "computeRatioMax": 0.08634938728982616, "endMs": "1665768416889", "id": "37", "name": "S25: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.002564833285836421, "readRatioMax": 0.002564833285836421, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "791", "startMs": "1665768416344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:cd_demo_sk, $231:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage25_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "79", "writeMsMax": "79", "writeRatioAvg": 0.011256768310059846, "writeRatioMax": 0.011256768310059846 }, { "completedParallelInputs": "1", "computeMsAvg": "582", "computeMsMax": "582", "computeRatioAvg": 0.0829296095753776, "computeRatioMax": 0.0829296095753776, "endMs": "1665768416853", "id": "38", "name": "S26: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0012824166429182104, "readRatioMax": 0.0012824166429182104, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "639", "startMs": "1665768416361", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270:cd_demo_sk, $271:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage26_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "76", "writeMsMax": "76", "writeRatioAvg": 0.010829296095753777, "writeRatioMax": 0.010829296095753777 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0017098888572242804, "computeRatioMax": 0.0017098888572242804, "endMs": "1665768416406", "id": "39", "name": "S27: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007124536905101168, "readRatioMax": 0.0007124536905101168, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768416374", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310:hd_demo_sk, $311:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$310, $311", "TO __stage27_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.002564833285836421, "writeRatioMax": 0.002564833285836421 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.001994870333428327, "computeRatioMax": 0.001994870333428327, "endMs": "1665768416434", "id": "40", "name": "S28: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007124536905101168, "readRatioMax": 0.0007124536905101168, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768416389", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330:hd_demo_sk, $331:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$330, $331", "TO __stage28_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.002279851809632374, "writeRatioMax": 0.002279851809632374 }, { "completedParallelInputs": "1", "computeMsAvg": "155", "computeMsMax": "155", "computeRatioAvg": 0.02208606440581362, "computeRatioMax": 0.02208606440581362, "endMs": "1665768416525", "id": "41", "name": "S29: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.001139925904816187, "readRatioMax": 0.001139925904816187, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "173", "startMs": "1665768416406", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390:c_customer_sk, $391:c_current_cdemo_sk, $392:c_current_hdemo_sk, $393:c_current_addr_sk, $394:c_first_shipto_date_sk, $395:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392, $393, $394, $395", "TO __stage29_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.001567398119122257, "writeRatioMax": 0.001567398119122257 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.0012824166429182104, "computeRatioMax": 0.001994870333428327, "endMs": "1665768416478", "id": "43", "inputStages": [ "14" ], "name": "S2B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3363", "startMs": "1665768416426", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "5", "waitMsMax": "9", "waitRatioAvg": 0.0007124536905101168, "waitRatioMax": 0.0012824166429182104, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.002279851809632374, "writeRatioMax": 0.004132231404958678 }, { "completedParallelInputs": "6", "computeMsAvg": "4866", "computeMsMax": "6615", "computeRatioAvg": 0.6933599316044458, "computeRatioMax": 0.9425762325448845, "endMs": "1665768419983", "id": "44", "inputStages": [ "19", "12", "17", "16", "11", "8", "7", "6", "18", "21", "22", "13", "9", "43", "10", "20", "15" ], "name": "S2C: Join+", "parallelInputs": "6", "readMsAvg": "27", "readMsMax": "39", "readRatioAvg": 0.003847249928754631, "readRatioMax": 0.005557138785978911, "recordsRead": "29398184", "recordsWritten": "8", "shuffleOutputBytes": "1830", "shuffleOutputBytesSpilled": "0", "slotMs": "23244", "startMs": "1665768416442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340:ss_sold_date_sk, $341:ss_item_sk, $342:ss_customer_sk, $343:ss_cdemo_sk, $344:ss_hdemo_sk, $345:ss_addr_sk, $346:ss_store_sk, $347:ss_promo_sk, $348:ss_ticket_number, $349:ss_wholesale_cost, $350:ss_list_price, $351:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $364, $365", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$240, $241", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$220, $221", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$180, $181", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$190, $193", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$680", "FROM __stage2B_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $870 := $863, $871 := $862, $872 := $851, $873 := $852, $874 := $853, $875 := $854, $876 := $855, $877 := $856, $878 := $857, $879 := $858, $880 := $859, $881 := $860, $882 := $861, $883 := $867, $884 := $850", "$420 := COUNT_STAR()", "$421 := SUM($864)", "$422 := SUM($865)", "$423 := SUM($866)" ] }, { "kind": "JOIN", "substeps": [ "$850 := $847, $851 := $830, $852 := $831, $853 := $832, $854 := $833, $855 := $834, $856 := $835, $857 := $836, $858 := $837, $859 := $838, $860 := $839, $861 := $840, $862 := $841, $863 := $842, $864 := $843, $865 := $844", "INNER HASH JOIN EACH WITH ALL ON $846 = $1" ] }, { "kind": "JOIN", "substeps": [ "$830 := $826, $831 := $827, $832 := $810, $833 := $811, $834 := $812, $835 := $813, $836 := $814, $837 := $815, $838 := $816, $839 := $817, $840 := $818, $841 := $819, $842 := $820, $843 := $821, $844 := $822, $845 := $823", "INNER HASH JOIN EACH WITH ALL ON $824 = $20" ] }, { "kind": "JOIN", "substeps": [ "$810 := $790, $811 := $791, $812 := $792, $813 := $793, $814 := $794, $815 := $795, $816 := $796, $817 := $797, $818 := $798, $819 := $799, $820 := $800, $821 := $802, $822 := $803, $823 := $804, $824 := $805, $825 := $806", "INNER HASH JOIN EACH WITH ALL ON $801 = $40" ] }, { "kind": "JOIN", "substeps": [ "$790 := $784, $791 := $785, $792 := $786, $793 := $787, $794 := $770, $795 := $771, $796 := $772, $797 := $773, $798 := $774, $799 := $775, $800 := $776, $801 := $777, $802 := $779, $803 := $780, $804 := $781, $805 := $782", "INNER HASH JOIN EACH WITH ALL ON $778 = $60" ] }, { "kind": "JOIN", "substeps": [ "$770 := $761, $771 := $762, $772 := $763, $773 := $764, $774 := $750, $775 := $751, $776 := $752, $777 := $754, $778 := $755, $779 := $756, $780 := $757, $781 := $758, $782 := $759, $783 := $760, $784 := $81, $785 := $82", "INNER HASH JOIN EACH WITH ALL ON $753 = $80" ] }, { "kind": "JOIN", "substeps": [ "$750 := $730, $751 := $731, $752 := $732, $753 := $733, $754 := $734, $755 := $735, $756 := $736, $757 := $737, $758 := $738, $759 := $740, $760 := $741, $761 := $101, $762 := $102, $763 := $103, $764 := $104", "INNER HASH JOIN EACH WITH ALL ON $739 = $100" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $712, $733 := $714, $734 := $715, $735 := $716, $736 := $717, $737 := $718, $738 := $719, $739 := $720, $740 := $721, $741 := $722", "INNER HASH JOIN EACH WITH ALL ON $713 = $120" ] }, { "kind": "JOIN", "substeps": [ "$710 := $690, $711 := $691, $712 := $692, $713 := $693, $714 := $695, $715 := $696, $716 := $697, $717 := $698, $718 := $699, $719 := $700, $720 := $701, $721 := $702, $722 := $703", "INNER HASH JOIN EACH WITH ALL ON $694 = $140" ] }, { "kind": "JOIN", "substeps": [ "$690 := $654, $691 := $640, $692 := $641, $693 := $642, $694 := $643, $695 := $645, $696 := $646, $697 := $647, $698 := $648, $699 := $649, $700 := $650, $701 := $651, $702 := $652, $703 := $653", "INNER HASH JOIN EACH WITH ALL ON $644 = $680" ] }, { "kind": "JOIN", "substeps": [ "$640 := $633, $641 := $634, $642 := $620, $643 := $621, $644 := $623, $645 := $624, $646 := $625, $647 := $626, $648 := $627, $649 := $628, $650 := $629, $651 := $630, $652 := $631, $653 := $632, $654 := $161", "INNER HASH JOIN EACH WITH ALL ON $622 = $160" ] }, { "kind": "JOIN", "substeps": [ "$620 := $600, $621 := $601, $622 := $602, $623 := $603, $624 := $604, $625 := $605, $626 := $606, $627 := $607, $628 := $608, $629 := $609, $630 := $610, $631 := $611, $632 := $612, $633 := $190, $634 := $193", "INNER HASH JOIN EACH WITH ALL ON $603 = $190" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $589, $608 := $590, $609 := $591, $610 := $592, $611 := $593, $612 := $594", "INNER HASH JOIN EACH WITH ALL ON $584 = $180, $588 = $181" ] }, { "kind": "FILTER", "substeps": [ "not_equal($595, $580)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $575, $581 := $560, $582 := $561, $583 := $562, $584 := $563, $585 := $565, $586 := $566, $587 := $567, $588 := $568, $589 := $569, $590 := $570, $591 := $571, $592 := $572, $593 := $573, $594 := $574, $595 := $221", "INNER HASH JOIN EACH WITH ALL ON $564 = $220" ] }, { "kind": "JOIN", "substeps": [ "$560 := $555, $561 := $540, $562 := $541, $563 := $542, $564 := $543, $565 := $544, $566 := $545, $567 := $546, $568 := $547, $569 := $548, $570 := $549, $571 := $550, $572 := $552, $573 := $553, $574 := $554, $575 := $241", "INNER HASH JOIN EACH WITH ALL ON $551 = $240" ] }, { "kind": "JOIN", "substeps": [ "$540 := $535, $541 := $520, $542 := $521, $543 := $522, $544 := $524, $545 := $525, $546 := $526, $547 := $527, $548 := $528, $549 := $529, $550 := $530, $551 := $531, $552 := $532, $553 := $533, $554 := $534, $555 := $301", "INNER HASH JOIN EACH WITH ALL ON $523 = $300" ] }, { "kind": "JOIN", "substeps": [ "$520 := $500, $521 := $501, $522 := $502, $523 := $503, $524 := $504, $525 := $505, $526 := $506, $527 := $507, $528 := $508, $529 := $509, $530 := $510, $531 := $511, $532 := $513, $533 := $514, $534 := $515, $535 := $321", "INNER HASH JOIN EACH WITH ALL ON $512 = $320" ] }, { "kind": "JOIN", "substeps": [ "$500 := $340, $501 := $341, $502 := $343, $503 := $344, $504 := $345, $505 := $346, $506 := $347, $507 := $348, $508 := $349, $509 := $350, $510 := $351, $511 := $361, $512 := $362, $513 := $363, $514 := $364, $515 := $365", "INNER HASH JOIN EACH WITH ALL ON $342 = $360" ] }, { "kind": "WRITE", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "TO __stage2C_output", "BY HASH($870, $871, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $883, $884)" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.0007124536905101168, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.0007124536905101168, "writeRatioMax": 0.001139925904816187 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.001139925904816187, "computeRatioMax": 0.002279851809632374, "endMs": "1665768417055", "id": "47", "inputStages": [ "33" ], "name": "S2F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3707", "startMs": "1665768416990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0004274722143060701, "waitRatioMax": 0.0005699629524080935, "writeMsAvg": "26", "writeMsMax": "56", "writeRatioAvg": 0.0037047591906526076, "writeRatioMax": 0.007979481333713309 }, { "completedParallelInputs": "6", "computeMsAvg": "6002", "computeMsMax": "7018", "computeRatioAvg": 0.8552294100883443, "computeRatioMax": 1, "endMs": "1665768420835", "id": "48", "inputStages": [ "41", "35", "25", "36", "32", "30", "39", "38", "31", "37", "28", "40", "29", "26", "47", "34", "27" ], "name": "S30: Join+", "parallelInputs": "6", "readMsAvg": "30", "readMsMax": "36", "readRatioAvg": 0.004274722143060701, "readRatioMax": 0.005129666571672842, "recordsRead": "29661809", "recordsWritten": "11", "shuffleOutputBytes": "2546", "shuffleOutputBytesSpilled": "0", "slotMs": "29773", "startMs": "1665768417013", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370:ss_sold_date_sk, $371:ss_item_sk, $372:ss_customer_sk, $373:ss_cdemo_sk, $374:ss_hdemo_sk, $375:ss_addr_sk, $376:ss_store_sk, $377:ss_promo_sk, $378:ss_ticket_number, $379:ss_wholesale_cost, $380:ss_list_price, $381:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$390, $391, $392, $393, $394, $395", "FROM __stage29_output" ] }, { "kind": "READ", "substeps": [ "$330, $331", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$310, $311", "FROM __stage27_output" ] }, { "kind": "READ", "substeps": [ "$270, $271", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage25_output" ] }, { "kind": "READ", "substeps": [ "$200, $201", "FROM __stage24_output" ] }, { "kind": "READ", "substeps": [ "$210, $213", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$1090", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage19_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1280 := $1273, $1281 := $1272, $1282 := $1261, $1283 := $1262, $1284 := $1263, $1285 := $1264, $1286 := $1265, $1287 := $1266, $1288 := $1267, $1289 := $1268, $1290 := $1269, $1291 := $1270, $1292 := $1271, $1293 := $1277, $1294 := $1260", "$430 := COUNT_STAR()", "$431 := SUM($1274)", "$432 := SUM($1275)", "$433 := SUM($1276)" ] }, { "kind": "JOIN", "substeps": [ "$1260 := $1257, $1261 := $1240, $1262 := $1241, $1263 := $1242, $1264 := $1243, $1265 := $1244, $1266 := $1245, $1267 := $1246, $1268 := $1247, $1269 := $1248, $1270 := $1249, $1271 := $1250, $1272 := $1251, $1273 := $1252, $1274 := $1253, $1275 := $1254", "INNER HASH JOIN EACH WITH ALL ON $1256 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $1236, $1241 := $1237, $1242 := $1220, $1243 := $1221, $1244 := $1222, $1245 := $1223, $1246 := $1224, $1247 := $1225, $1248 := $1226, $1249 := $1227, $1250 := $1228, $1251 := $1229, $1252 := $1230, $1253 := $1231, $1254 := $1232, $1255 := $1233", "INNER HASH JOIN EACH WITH ALL ON $1234 = $30" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $1200, $1221 := $1201, $1222 := $1202, $1223 := $1203, $1224 := $1204, $1225 := $1205, $1226 := $1206, $1227 := $1207, $1228 := $1208, $1229 := $1209, $1230 := $1210, $1231 := $1212, $1232 := $1213, $1233 := $1214, $1234 := $1215, $1235 := $1216", "INNER HASH JOIN EACH WITH ALL ON $1211 = $50" ] }, { "kind": "JOIN", "substeps": [ "$1200 := $1194, $1201 := $1195, $1202 := $1196, $1203 := $1197, $1204 := $1180, $1205 := $1181, $1206 := $1182, $1207 := $1183, $1208 := $1184, $1209 := $1185, $1210 := $1186, $1211 := $1187, $1212 := $1189, $1213 := $1190, $1214 := $1191, $1215 := $1192", "INNER HASH JOIN EACH WITH ALL ON $1188 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1171, $1181 := $1172, $1182 := $1173, $1183 := $1174, $1184 := $1160, $1185 := $1161, $1186 := $1162, $1187 := $1164, $1188 := $1165, $1189 := $1166, $1190 := $1167, $1191 := $1168, $1192 := $1169, $1193 := $1170, $1194 := $91, $1195 := $92", "INNER HASH JOIN EACH WITH ALL ON $1163 = $90" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $1140, $1161 := $1141, $1162 := $1142, $1163 := $1143, $1164 := $1144, $1165 := $1145, $1166 := $1146, $1167 := $1147, $1168 := $1148, $1169 := $1150, $1170 := $1151, $1171 := $111, $1172 := $112, $1173 := $113, $1174 := $114", "INNER HASH JOIN EACH WITH ALL ON $1149 = $110" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $1120, $1141 := $1121, $1142 := $1122, $1143 := $1124, $1144 := $1125, $1145 := $1126, $1146 := $1127, $1147 := $1128, $1148 := $1129, $1149 := $1130, $1150 := $1131, $1151 := $1132", "INNER HASH JOIN EACH WITH ALL ON $1123 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1100, $1121 := $1101, $1122 := $1102, $1123 := $1103, $1124 := $1105, $1125 := $1106, $1126 := $1107, $1127 := $1108, $1128 := $1109, $1129 := $1110, $1130 := $1111, $1131 := $1112, $1132 := $1113", "INNER HASH JOIN EACH WITH ALL ON $1104 = $150" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1064, $1101 := $1050, $1102 := $1051, $1103 := $1052, $1104 := $1053, $1105 := $1055, $1106 := $1056, $1107 := $1057, $1108 := $1058, $1109 := $1059, $1110 := $1060, $1111 := $1061, $1112 := $1062, $1113 := $1063", "INNER HASH JOIN EACH WITH ALL ON $1054 = $1090" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $1043, $1051 := $1044, $1052 := $1030, $1053 := $1031, $1054 := $1033, $1055 := $1034, $1056 := $1035, $1057 := $1036, $1058 := $1037, $1059 := $1038, $1060 := $1039, $1061 := $1040, $1062 := $1041, $1063 := $1042, $1064 := $171", "INNER HASH JOIN EACH WITH ALL ON $1032 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1010, $1031 := $1011, $1032 := $1012, $1033 := $1013, $1034 := $1014, $1035 := $1015, $1036 := $1016, $1037 := $1017, $1038 := $1018, $1039 := $1019, $1040 := $1020, $1041 := $1021, $1042 := $1022, $1043 := $210, $1044 := $213", "INNER HASH JOIN EACH WITH ALL ON $1013 = $210" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $991, $1011 := $992, $1012 := $993, $1013 := $994, $1014 := $995, $1015 := $996, $1016 := $997, $1017 := $999, $1018 := $1000, $1019 := $1001, $1020 := $1002, $1021 := $1003, $1022 := $1004", "INNER HASH JOIN EACH WITH ALL ON $994 = $200, $998 = $201" ] }, { "kind": "FILTER", "substeps": [ "not_equal($1005, $990)" ] }, { "kind": "JOIN", "substeps": [ "$990 := $985, $991 := $970, $992 := $971, $993 := $972, $994 := $973, $995 := $975, $996 := $976, $997 := $977, $998 := $978, $999 := $979, $1000 := $980, $1001 := $981, $1002 := $982, $1003 := $983, $1004 := $984, $1005 := $231", "INNER HASH JOIN EACH WITH ALL ON $974 = $230" ] }, { "kind": "JOIN", "substeps": [ "$970 := $965, $971 := $950, $972 := $951, $973 := $952, $974 := $953, $975 := $954, $976 := $955, $977 := $956, $978 := $957, $979 := $958, $980 := $959, $981 := $960, $982 := $962, $983 := $963, $984 := $964, $985 := $271", "INNER HASH JOIN EACH WITH ALL ON $961 = $270" ] }, { "kind": "JOIN", "substeps": [ "$950 := $945, $951 := $930, $952 := $931, $953 := $932, $954 := $934, $955 := $935, $956 := $936, $957 := $937, $958 := $938, $959 := $939, $960 := $940, $961 := $941, $962 := $942, $963 := $943, $964 := $944, $965 := $311", "INNER HASH JOIN EACH WITH ALL ON $933 = $310" ] }, { "kind": "JOIN", "substeps": [ "$930 := $910, $931 := $911, $932 := $912, $933 := $913, $934 := $914, $935 := $915, $936 := $916, $937 := $917, $938 := $918, $939 := $919, $940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $925, $945 := $331", "INNER HASH JOIN EACH WITH ALL ON $922 = $330" ] }, { "kind": "JOIN", "substeps": [ "$910 := $370, $911 := $371, $912 := $373, $913 := $374, $914 := $375, $915 := $376, $916 := $377, $917 := $378, $918 := $379, $919 := $380, $920 := $381, $921 := $391, $922 := $392, $923 := $393, $924 := $394, $925 := $395", "INNER HASH JOIN EACH WITH ALL ON $372 = $390" ] }, { "kind": "WRITE", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "TO __stage30_output", "BY HASH($1280, $1281, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1293, $1294)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.0004274722143060701, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.001139925904816187, "writeRatioMax": 0.0012824166429182104 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.001139925904816187, "computeRatioMax": 0.001139925904816187, "endMs": "1665768420917", "id": "50", "inputStages": [ "44" ], "name": "S32: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "1686", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768420881", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "FROM __stage2C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $870, $891 := $871, $892 := $872, $893 := $873, $894 := $874, $895 := $875, $896 := $876, $897 := $877, $898 := $878, $899 := $879, $900 := $880, $901 := $881, $902 := $882, $903 := $883, $904 := $884", "$400 := SUM_OF_COUNTS($420)", "$401 := SUM($421)", "$402 := SUM($422)", "$403 := SUM($423)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $890, $891, $892, $893, $894, $895, $896, $897, $898, $899, $900, $901", "TO __stage32_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014249073810202338, "waitRatioMax": 0.00014249073810202338, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.003989740666856654, "writeRatioMax": 0.003989740666856654 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.001139925904816187, "computeRatioMax": 0.002279851809632374, "endMs": "1665768421009", "id": "51", "inputStages": [ "50" ], "name": "S33: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "1686", "shuffleOutputBytesSpilled": "0", "slotMs": "3297", "startMs": "1665768420938", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage32_output" ] } ], "waitMsAvg": "10", "waitMsMax": "13", "waitRatioAvg": 0.0014249073810202336, "waitRatioMax": 0.0018523795953263038, "writeMsAvg": "19", "writeMsMax": "31", "writeRatioAvg": 0.002707324023938444, "writeRatioMax": 0.004417212881162725 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0012824166429182104, "computeRatioMax": 0.0012824166429182104, "endMs": "1665768421040", "id": "52", "inputStages": [ "48", "51" ], "name": "S34: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "19", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768420956", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "FROM __stage30_output" ] }, { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $890, $891, $892, $893, $894, $895, $896, $897, $898, $899, $900, $901", "FROM __stage33_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($1337, $1332)" ] }, { "kind": "JOIN", "substeps": [ "$1336 := $1312, $1337 := $410, $1338 := $411, $1339 := $412, $1340 := $413, $1320 := $892, $1321 := $893, $1322 := $894, $1323 := $895, $1324 := $896, $1325 := $897, $1326 := $898, $1327 := $899, $1328 := $900, $1329 := $901, $1330 := $902", "INNER HASH JOIN EACH WITH ALL ON $1301 = $891, $1302 = $892, $1303 = $893" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1300 := $1280, $1301 := $1281, $1302 := $1282, $1303 := $1283, $1304 := $1284, $1305 := $1285, $1306 := $1286, $1307 := $1287, $1308 := $1288, $1309 := $1289, $1310 := $1290, $1311 := $1291, $1312 := $1292, $1313 := $1293, $1314 := $1294", "$410 := SUM_OF_COUNTS($430)", "$411 := SUM($431)", "$412 := SUM($432)", "$413 := SUM($433)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "TO __stage34_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0005699629524080935, "writeRatioMax": 0.0005699629524080935 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.002564833285836421, "computeRatioMax": 0.002564833285836421, "endMs": "1665768421119", "id": "53", "inputStages": [ "52" ], "name": "S35: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768421058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "FROM __stage34_output" ] }, { "kind": "SORT", "substeps": [ "$1331 ASC, $1320 ASC, $1337 ASC, $1333 ASC, $1338 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1350, $1351, $1352, $1353, $1354, $1355, $1356, $1357, $1358, $1359, $1360, $1361, $1362, $1363, $1364, $1365", "TO __stage35_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00028498147620404675, "waitRatioMax": 0.00028498147620404675, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.004417212881162725, "writeRatioMax": 0.004417212881162725 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "income_band" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "7", "completedUnits": "8", "elapsedMs": "746", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "3418" }, { "activeUnits": "6", "completedUnits": "29", "elapsedMs": "1756", "estimatedRunnableUnits": "1", "pendingUnits": "6", "totalSlotMs": "11401" }, { "activeUnits": "14", "completedUnits": "246", "elapsedMs": "3146", "estimatedRunnableUnits": "1", "pendingUnits": "12", "totalSlotMs": "31543" }, { "activeUnits": "12", "completedUnits": "248", "elapsedMs": "4676", "estimatedRunnableUnits": "13", "pendingUnits": "10", "totalSlotMs": "57626" }, { "activeUnits": "10", "completedUnits": "251", "elapsedMs": "5734", "estimatedRunnableUnits": "2", "pendingUnits": "7", "totalSlotMs": "71817" }, { "activeUnits": "44", "completedUnits": "361", "elapsedMs": "6996", "estimatedRunnableUnits": "2", "pendingUnits": "0", "totalSlotMs": "81710" } ], "totalBytesBilled": "422576128", "totalBytesProcessed": "421895625", "totalPartitionsProcessed": "0", "totalSlotMs": "81710", "transferredBytes": "0" }, "startTime": "1665768414212", "totalBytesProcessed": "421895625", "totalSlotMs": "81710" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone3087ab3_d687_4c55_82d3_fc140e1ec2a4" }, "priority": "INTERACTIVE", "query": "with cs_ui as\n (select cs_item_sk\n ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n from catalog_sales\n ,catalog_returns\n where cs_item_sk = cr_item_sk\n and cs_order_number = cr_order_number\n group by cs_item_sk\n having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n ,i_item_sk item_sk\n ,s_store_name store_name\n ,s_zip store_zip\n ,ad1.ca_street_number b_street_number\n ,ad1.ca_street_name b_street_name\n ,ad1.ca_city b_city\n ,ad1.ca_zip b_zip\n ,ad2.ca_street_number c_street_number\n ,ad2.ca_street_name c_street_name\n ,ad2.ca_city c_city\n ,ad2.ca_zip c_zip\n ,d1.d_year as syear\n ,d2.d_year as fsyear\n ,d3.d_year s2year\n ,count(*) cnt\n ,sum(ss_wholesale_cost) s1\n ,sum(ss_list_price) s2\n ,sum(ss_coupon_amt) s3\n FROM store_sales\n ,store_returns\n ,cs_ui\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,customer\n ,customer_demographics cd1\n ,customer_demographics cd2\n ,promotion\n ,household_demographics hd1\n ,household_demographics hd2\n ,customer_address ad1\n ,customer_address ad2\n ,income_band ib1\n ,income_band ib2\n ,item\n WHERE ss_store_sk = s_store_sk AND\n ss_sold_date_sk = d1.d_date_sk AND\n ss_customer_sk = c_customer_sk AND\n ss_cdemo_sk= cd1.cd_demo_sk AND\n ss_hdemo_sk = hd1.hd_demo_sk AND\n ss_addr_sk = ad1.ca_address_sk and\n ss_item_sk = i_item_sk and\n ss_item_sk = sr_item_sk and\n ss_ticket_number = sr_ticket_number and\n ss_item_sk = cs_ui.cs_item_sk and\n c_current_cdemo_sk = cd2.cd_demo_sk AND\n c_current_hdemo_sk = hd2.hd_demo_sk AND\n c_current_addr_sk = ad2.ca_address_sk and\n c_first_sales_date_sk = d2.d_date_sk and\n c_first_shipto_date_sk = d3.d_date_sk and\n ss_promo_sk = p_promo_sk and\n hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n cd1.cd_marital_status <> cd2.cd_marital_status and\n i_color in ('orange','lace','lawn','misty','blush','pink') and\n i_current_price between 48 and 48 + 10 and\n i_current_price between 48 + 1 and 48 + 15\ngroup by i_product_name\n ,i_item_sk\n ,s_store_name\n ,s_zip\n ,ad1.ca_street_number\n ,ad1.ca_street_name\n ,ad1.ca_city\n ,ad1.ca_zip\n ,ad2.ca_street_number\n ,ad2.ca_street_name\n ,ad2.ca_city\n ,ad2.ca_zip\n ,d1.d_year\n ,d2.d_year\n ,d3.d_year\n)\nselect cs1.product_name\n ,cs1.store_name\n ,cs1.store_zip\n ,cs1.b_street_number\n ,cs1.b_street_name\n ,cs1.b_city\n ,cs1.b_zip\n ,cs1.c_street_number\n ,cs1.c_street_name\n ,cs1.c_city\n ,cs1.c_zip\n ,cs1.syear\n ,cs1.cnt\n ,cs1.s1 as s11\n ,cs1.s2 as s21\n ,cs1.s3 as s31\n ,cs2.s1 as s12\n ,cs2.s2 as s22\n ,cs2.s3 as s32\n ,cs2.syear\n ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n cs1.syear = 1999 and\n cs2.syear = 1999 + 1 and\n cs2.cnt <= cs1.cnt and\n cs1.store_name = cs2.store_name and\n cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n ,cs1.store_name\n ,cs2.cnt\n ,cs1.s1\n ,cs2.s1;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "WkNt5cCDLRc/eRS9rQFMhA==", "id": "test-project-364309:europe-west1.query64_1665777915", "jobReference": { "jobId": "query64_1665777915", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query64_1665777915?location=europe-west1", "statistics": { "creationTime": "1665777915862", "endTime": "1665777922170", "finalExecutionDurationMs": "5930", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "421895625", "performanceInsights": { "avgPreviousExecutionMs": "6453", "stagePerformanceChangeInsights": [ { "inputDataChange": { "recordsReadDiffPercentage": 100 } }, { "inputDataChange": { "recordsReadDiffPercentage": 100 }, "stageId": "2" } ] }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "200", "computeMsMax": "200", "computeRatioAvg": 0.027266530334014997, "computeRatioMax": 0.027266530334014997, "endMs": "1665777916345", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.002317655078391275, "readRatioMax": 0.002317655078391275, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "237", "startMs": "1665777916160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290:cr_item_sk, $291:cr_order_number, $292:cr_refunded_cash, $293:cr_reversed_charge, $294:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0017723244717109748, "writeRatioMax": 0.0017723244717109748 }, { "completedParallelInputs": "1", "computeMsAvg": "261", "computeMsMax": "261", "computeRatioAvg": 0.03558282208588957, "computeRatioMax": 0.03558282208588957, "endMs": "1665777916333", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0013633265167007499, "readRatioMax": 0.0013633265167007499, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "246", "startMs": "1665777916188", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260:cr_item_sk, $261:cr_order_number, $262:cr_refunded_cash, $263:cr_reversed_charge, $264:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014996591683708249, "writeRatioMax": 0.0014996591683708249 }, { "completedParallelInputs": "5", "computeMsAvg": "352", "computeMsMax": "495", "computeRatioAvg": 0.047989093387866395, "computeRatioMax": 0.06748466257668712, "endMs": "1665777916627", "id": "4", "inputStages": [ "2" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.002044989775051125, "readRatioMax": 0.00245398773006135, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "1563", "startMs": "1665777916346", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250:cs_item_sk, $251:cs_order_number, $252:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $660", "$460 := SUM($661)", "$461 := SUM($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := add(add($662, $663), $664)" ] }, { "kind": "JOIN", "substeps": [ "$660 := $250, $661 := $252, $662 := $262, $663 := $263, $664 := $264", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261" ] }, { "kind": "WRITE", "substeps": [ "$670, $460, $461", "TO __stage04_output", "BY HASH($670)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.0006816632583503749, "writeRatioMax": 0.0009543285616905249 }, { "completedParallelInputs": "5", "computeMsAvg": "401", "computeMsMax": "445", "computeRatioAvg": 0.05466939331970007, "computeRatioMax": 0.06066802999318337, "endMs": "1665777916678", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "5", "readMsAvg": "17", "readMsMax": "19", "readRatioAvg": 0.002317655078391275, "readRatioMax": 0.002590320381731425, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "2028", "startMs": "1665777916369", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280:cs_item_sk, $281:cs_order_number, $282:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $1070", "$470 := SUM($1071)", "$471 := SUM($490)" ] }, { "kind": "COMPUTE", "substeps": [ "$490 := add(add($1072, $1073), $1074)" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $280, $1071 := $282, $1072 := $292, $1073 := $293, $1074 := $294", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291" ] }, { "kind": "WRITE", "substeps": [ "$1080, $470, $471", "TO __stage05_output", "BY HASH($1080)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.0008179959100204499, "writeRatioMax": 0.0009543285616905249 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.004771642808452625, "computeRatioMax": 0.004771642808452625, "endMs": "1665777916708", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009543285616905249, "readRatioMax": 0.0009543285616905249, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777916670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0013633265167007499, "writeRatioMax": 0.0013633265167007499 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.005998636673483299, "computeRatioMax": 0.005998636673483299, "endMs": "1665777916723", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009543285616905249, "readRatioMax": 0.0009543285616905249, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777916682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014996591683708249, "writeRatioMax": 0.0014996591683708249 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.001226993865030675, "computeRatioMax": 0.001226993865030675, "endMs": "1665777916726", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777916697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_store_name, $42:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0017723244717109748, "writeRatioMax": 0.0017723244717109748 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0010906612133606, "computeRatioMax": 0.0010906612133606, "endMs": "1665777916745", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777916712", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.0027266530334014998, "writeRatioMax": 0.0027266530334014998 }, { "completedParallelInputs": "1", "computeMsAvg": "62", "computeMsMax": "62", "computeRatioAvg": 0.00845262440354465, "computeRatioMax": 0.00845262440354465, "endMs": "1665777916809", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010906612133606, "readRatioMax": 0.0010906612133606, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665777916727", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_street_number, $82:ca_street_name, $83:ca_city, $84:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014996591683708249, "writeRatioMax": 0.0014996591683708249 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.005998636673483299, "computeRatioMax": 0.005998636673483299, "endMs": "1665777916798", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665777916744", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_street_number, $102:ca_street_name, $103:ca_city, $104:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014996591683708249, "writeRatioMax": 0.0014996591683708249 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0008179959100204499, "computeRatioMax": 0.0008179959100204499, "endMs": "1665777916788", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777916759", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002317655078391275, "writeRatioMax": 0.002317655078391275 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0017723244717109748, "computeRatioMax": 0.0017723244717109748, "endMs": "1665777916812", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005453306066803, "readRatioMax": 0.0005453306066803, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665777916773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002317655078391275, "writeRatioMax": 0.002317655078391275 }, { "completedParallelInputs": "1", "computeMsAvg": "65", "computeMsMax": "65", "computeRatioAvg": 0.008861622358554875, "computeRatioMax": 0.008861622358554875, "endMs": "1665777916831", "id": "14", "inputStages": [ "4" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777916785", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $460, $461", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "greater($440, multiply(NUMERIC<...>, $441))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670", "$440 := SUM($460)", "$441 := SUM($461)" ] }, { "kind": "WRITE", "substeps": [ "$680", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0009543285616905249, "writeRatioMax": 0.0009543285616905249 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0013633265167007499, "computeRatioMax": 0.0013633265167007499, "endMs": "1665777916836", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006816632583503749, "readRatioMax": 0.0006816632583503749, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777916800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year", "FROM date_dim", "WHERE equal($161, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0017723244717109748, "writeRatioMax": 0.0017723244717109748 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.001226993865030675, "computeRatioMax": 0.001226993865030675, "endMs": "1665777916861", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006816632583503749, "readRatioMax": 0.0006816632583503749, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777916815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $193:i_product_name, $191:i_current_price, $192:i_color", "FROM item", "WHERE and(in($192, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($191, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$190, $193", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.002590320381731425, "writeRatioMax": 0.002590320381731425 }, { "completedParallelInputs": "1", "computeMsAvg": "222", "computeMsMax": "222", "computeRatioAvg": 0.030265848670756646, "computeRatioMax": 0.030265848670756646, "endMs": "1665777917002", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0014996591683708249, "readRatioMax": 0.0014996591683708249, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "226", "startMs": "1665777916830", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:sr_item_sk, $181:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$180, $181", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0019086571233810498, "writeRatioMax": 0.0019086571233810498 }, { "completedParallelInputs": "1", "computeMsAvg": "873", "computeMsMax": "873", "computeRatioAvg": 0.11901840490797547, "computeRatioMax": 0.11901840490797547, "endMs": "1665777917427", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0017723244717109748, "readRatioMax": 0.0017723244717109748, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "859", "startMs": "1665777916845", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:cd_demo_sk, $221:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$220, $221", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "71", "writeMsMax": "71", "writeRatioAvg": 0.009679618268575324, "writeRatioMax": 0.009679618268575324 }, { "completedParallelInputs": "1", "computeMsAvg": "818", "computeMsMax": "818", "computeRatioAvg": 0.11152010906612134, "computeRatioMax": 0.11152010906612134, "endMs": "1665777917445", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0013633265167007499, "readRatioMax": 0.0013633265167007499, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "816", "startMs": "1665777916860", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240:cd_demo_sk, $241:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "66", "writeMsMax": "66", "writeRatioAvg": 0.00899795501022495, "writeRatioMax": 0.00899795501022495 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0019086571233810498, "computeRatioMax": 0.0019086571233810498, "endMs": "1665777916918", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777916875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300:hd_demo_sk, $301:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0021813224267212, "writeRatioMax": 0.0021813224267212 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0021813224267212, "computeRatioMax": 0.0021813224267212, "endMs": "1665777916918", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0013633265167007499, "readRatioMax": 0.0013633265167007499, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777916889", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320:hd_demo_sk, $321:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.001226993865030675, "writeRatioMax": 0.001226993865030675 }, { "completedParallelInputs": "1", "computeMsAvg": "75", "computeMsMax": "75", "computeRatioAvg": 0.010224948875255624, "computeRatioMax": 0.010224948875255624, "endMs": "1665777916993", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010906612133606, "readRatioMax": 0.0010906612133606, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "95", "startMs": "1665777916904", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360:c_customer_sk, $361:c_current_cdemo_sk, $362:c_current_hdemo_sk, $363:c_current_addr_sk, $364:c_first_shipto_date_sk, $365:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $364, $365", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0013633265167007499, "writeRatioMax": 0.0013633265167007499 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.0057259713701431495, "computeRatioMax": 0.0057259713701431495, "endMs": "1665777916986", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.0019086571233810498, "readRatioMax": 0.0019086571233810498, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665777916933", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0019086571233810498, "writeRatioMax": 0.0019086571233810498 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.0038173142467620995, "computeRatioMax": 0.0038173142467620995, "endMs": "1665777916982", "id": "25", "name": "S19: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777916947", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0013633265167007499, "writeRatioMax": 0.0013633265167007499 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0010906612133606, "computeRatioMax": 0.0010906612133606, "endMs": "1665777916993", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777916963", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_store_name, $52:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0021813224267212, "writeRatioMax": 0.0021813224267212 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.001226993865030675, "computeRatioMax": 0.001226993865030675, "endMs": "1665777917018", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006816632583503749, "readRatioMax": 0.0006816632583503749, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777916979", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0021813224267212, "writeRatioMax": 0.0021813224267212 }, { "completedParallelInputs": "1", "computeMsAvg": "68", "computeMsMax": "68", "computeRatioAvg": 0.0092706203135651, "computeRatioMax": 0.0092706203135651, "endMs": "1665777917056", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665777916992", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_street_number, $92:ca_street_name, $93:ca_city, $94:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.001226993865030675, "writeRatioMax": 0.001226993865030675 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.006134969325153374, "computeRatioMax": 0.006134969325153374, "endMs": "1665777917087", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008179959100204499, "readRatioMax": 0.0008179959100204499, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665777917008", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ca_address_sk, $111:ca_street_number, $112:ca_street_name, $113:ca_city, $114:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.0029993183367416497, "writeRatioMax": 0.0029993183367416497 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0010906612133606, "computeRatioMax": 0.0010906612133606, "endMs": "1665777917049", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005453306066803, "readRatioMax": 0.0005453306066803, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777917022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.00245398773006135, "writeRatioMax": 0.00245398773006135 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0009543285616905249, "computeRatioMax": 0.0009543285616905249, "endMs": "1665777917074", "id": "31", "name": "S1F: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005453306066803, "readRatioMax": 0.0005453306066803, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777917035", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002317655078391275, "writeRatioMax": 0.002317655078391275 }, { "completedParallelInputs": "1", "computeMsAvg": "61", "computeMsMax": "61", "computeRatioAvg": 0.008316291751874575, "computeRatioMax": 0.008316291751874575, "endMs": "1665777917094", "id": "32", "inputStages": [ "5" ], "name": "S20: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777917048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1080, $470, $471", "FROM __stage05_output" ] }, { "kind": "FILTER", "substeps": [ "greater($450, multiply(NUMERIC<...>, $451))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080", "$450 := SUM($470)", "$451 := SUM($471)" ] }, { "kind": "WRITE", "substeps": [ "$1090", "TO __stage20_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0009543285616905249, "writeRatioMax": 0.0009543285616905249 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0016359918200408998, "computeRatioMax": 0.0016359918200408998, "endMs": "1665777917098", "id": "33", "name": "S21: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010906612133606, "readRatioMax": 0.0010906612133606, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777917062", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage21_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.001226993865030675, "writeRatioMax": 0.001226993865030675 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0019086571233810498, "computeRatioMax": 0.0019086571233810498, "endMs": "1665777917109", "id": "34", "name": "S22: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010906612133606, "readRatioMax": 0.0010906612133606, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777917079", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $213:i_product_name, $211:i_current_price, $212:i_color", "FROM item", "WHERE and(in($212, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($211, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$210, $213", "TO __stage22_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00040899795501022495, "waitRatioMax": 0.00040899795501022495, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0008179959100204499, "writeRatioMax": 0.0008179959100204499 }, { "completedParallelInputs": "1", "computeMsAvg": "125", "computeMsMax": "125", "computeRatioAvg": 0.017041581458759374, "computeRatioMax": 0.017041581458759374, "endMs": "1665777917209", "id": "35", "name": "S23: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0014996591683708249, "readRatioMax": 0.0014996591683708249, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "135", "startMs": "1665777917096", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:sr_item_sk, $201:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$200, $201", "TO __stage23_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0019086571233810498, "writeRatioMax": 0.0019086571233810498 }, { "completedParallelInputs": "1", "computeMsAvg": "1023", "computeMsMax": "1023", "computeRatioAvg": 0.1394683026584867, "computeRatioMax": 0.1394683026584867, "endMs": "1665777917713", "id": "36", "name": "S24: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0016359918200408998, "readRatioMax": 0.0016359918200408998, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "897", "startMs": "1665777917113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:cd_demo_sk, $231:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "85", "writeMsMax": "85", "writeRatioAvg": 0.011588275391956374, "writeRatioMax": 0.011588275391956374 }, { "completedParallelInputs": "1", "computeMsAvg": "571", "computeMsMax": "571", "computeRatioAvg": 0.07784594410361281, "computeRatioMax": 0.07784594410361281, "endMs": "1665777917633", "id": "37", "name": "S25: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0016359918200408998, "readRatioMax": 0.0016359918200408998, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "609", "startMs": "1665777917127", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270:cd_demo_sk, $271:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage25_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "82", "writeMsMax": "82", "writeRatioAvg": 0.011179277436946149, "writeRatioMax": 0.011179277436946149 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0009543285616905249, "computeRatioMax": 0.0009543285616905249, "endMs": "1665777917172", "id": "38", "name": "S26: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005453306066803, "readRatioMax": 0.0005453306066803, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777917145", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310:hd_demo_sk, $311:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$310, $311", "TO __stage26_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002317655078391275, "writeRatioMax": 0.002317655078391275 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0013633265167007499, "computeRatioMax": 0.0013633265167007499, "endMs": "1665777917193", "id": "39", "name": "S27: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005453306066803, "readRatioMax": 0.0005453306066803, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777917156", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330:hd_demo_sk, $331:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$330, $331", "TO __stage27_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.002044989775051125, "writeRatioMax": 0.002044989775051125 }, { "completedParallelInputs": "1", "computeMsAvg": "112", "computeMsMax": "112", "computeRatioAvg": 0.015269256987048398, "computeRatioMax": 0.015269256987048398, "endMs": "1665777917269", "id": "40", "name": "S28: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009543285616905249, "readRatioMax": 0.0009543285616905249, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "98", "startMs": "1665777917170", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390:c_customer_sk, $391:c_current_cdemo_sk, $392:c_current_hdemo_sk, $393:c_current_addr_sk, $394:c_first_shipto_date_sk, $395:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392, $393, $394, $395", "TO __stage28_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0016359918200408998, "writeRatioMax": 0.0016359918200408998 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0010906612133606, "computeRatioMax": 0.0021813224267212, "endMs": "1665777917618", "id": "44", "inputStages": [ "14" ], "name": "S2C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3693", "startMs": "1665777917558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.00040899795501022495, "waitRatioMax": 0.0008179959100204499, "writeMsAvg": "15", "writeMsMax": "22", "writeRatioAvg": 0.002044989775051125, "writeRatioMax": 0.0029993183367416497 }, { "completedParallelInputs": "6", "computeMsAvg": "5322", "computeMsMax": "6044", "computeRatioAvg": 0.725562372188139, "computeRatioMax": 0.8239945466939332, "endMs": "1665777920949", "id": "45", "inputStages": [ "8", "12", "10", "9", "13", "21", "44", "7", "17", "20", "18", "11", "19", "6", "15", "16", "22" ], "name": "S2D: Join+", "parallelInputs": "6", "readMsAvg": "26", "readMsMax": "32", "readRatioAvg": 0.0035446489434219496, "readRatioMax": 0.0043626448534424, "recordsRead": "29398184", "recordsWritten": "8", "shuffleOutputBytes": "1830", "shuffleOutputBytesSpilled": "0", "slotMs": "28044", "startMs": "1665777917574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340:ss_sold_date_sk, $341:ss_item_sk, $342:ss_customer_sk, $343:ss_cdemo_sk, $344:ss_hdemo_sk, $345:ss_addr_sk, $346:ss_store_sk, $347:ss_promo_sk, $348:ss_ticket_number, $349:ss_wholesale_cost, $350:ss_list_price, $351:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $364, $365", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$240, $241", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$220, $221", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$180, $181", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$190, $193", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$680", "FROM __stage2C_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $870 := $863, $871 := $862, $872 := $851, $873 := $852, $874 := $853, $875 := $854, $876 := $855, $877 := $856, $878 := $857, $879 := $858, $880 := $859, $881 := $860, $882 := $861, $883 := $867, $884 := $850", "$420 := COUNT_STAR()", "$421 := SUM($864)", "$422 := SUM($865)", "$423 := SUM($866)" ] }, { "kind": "JOIN", "substeps": [ "$850 := $847, $851 := $830, $852 := $831, $853 := $832, $854 := $833, $855 := $834, $856 := $835, $857 := $836, $858 := $837, $859 := $838, $860 := $839, $861 := $840, $862 := $841, $863 := $842, $864 := $843, $865 := $844", "INNER HASH JOIN EACH WITH ALL ON $846 = $1" ] }, { "kind": "JOIN", "substeps": [ "$830 := $826, $831 := $827, $832 := $810, $833 := $811, $834 := $812, $835 := $813, $836 := $814, $837 := $815, $838 := $816, $839 := $817, $840 := $818, $841 := $819, $842 := $820, $843 := $821, $844 := $822, $845 := $823", "INNER HASH JOIN EACH WITH ALL ON $824 = $20" ] }, { "kind": "JOIN", "substeps": [ "$810 := $790, $811 := $791, $812 := $792, $813 := $793, $814 := $794, $815 := $795, $816 := $796, $817 := $797, $818 := $798, $819 := $799, $820 := $800, $821 := $802, $822 := $803, $823 := $804, $824 := $805, $825 := $806", "INNER HASH JOIN EACH WITH ALL ON $801 = $40" ] }, { "kind": "JOIN", "substeps": [ "$790 := $784, $791 := $785, $792 := $786, $793 := $787, $794 := $770, $795 := $771, $796 := $772, $797 := $773, $798 := $774, $799 := $775, $800 := $776, $801 := $777, $802 := $779, $803 := $780, $804 := $781, $805 := $782", "INNER HASH JOIN EACH WITH ALL ON $778 = $60" ] }, { "kind": "JOIN", "substeps": [ "$770 := $761, $771 := $762, $772 := $763, $773 := $764, $774 := $750, $775 := $751, $776 := $752, $777 := $754, $778 := $755, $779 := $756, $780 := $757, $781 := $758, $782 := $759, $783 := $760, $784 := $81, $785 := $82", "INNER HASH JOIN EACH WITH ALL ON $753 = $80" ] }, { "kind": "JOIN", "substeps": [ "$750 := $730, $751 := $731, $752 := $732, $753 := $733, $754 := $734, $755 := $735, $756 := $736, $757 := $737, $758 := $738, $759 := $740, $760 := $741, $761 := $101, $762 := $102, $763 := $103, $764 := $104", "INNER HASH JOIN EACH WITH ALL ON $739 = $100" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $712, $733 := $714, $734 := $715, $735 := $716, $736 := $717, $737 := $718, $738 := $719, $739 := $720, $740 := $721, $741 := $722", "INNER HASH JOIN EACH WITH ALL ON $713 = $120" ] }, { "kind": "JOIN", "substeps": [ "$710 := $690, $711 := $691, $712 := $692, $713 := $693, $714 := $695, $715 := $696, $716 := $697, $717 := $698, $718 := $699, $719 := $700, $720 := $701, $721 := $702, $722 := $703", "INNER HASH JOIN EACH WITH ALL ON $694 = $140" ] }, { "kind": "JOIN", "substeps": [ "$690 := $654, $691 := $640, $692 := $641, $693 := $642, $694 := $643, $695 := $645, $696 := $646, $697 := $647, $698 := $648, $699 := $649, $700 := $650, $701 := $651, $702 := $652, $703 := $653", "INNER HASH JOIN EACH WITH ALL ON $644 = $680" ] }, { "kind": "JOIN", "substeps": [ "$640 := $633, $641 := $634, $642 := $620, $643 := $621, $644 := $623, $645 := $624, $646 := $625, $647 := $626, $648 := $627, $649 := $628, $650 := $629, $651 := $630, $652 := $631, $653 := $632, $654 := $161", "INNER HASH JOIN EACH WITH ALL ON $622 = $160" ] }, { "kind": "JOIN", "substeps": [ "$620 := $600, $621 := $601, $622 := $602, $623 := $603, $624 := $604, $625 := $605, $626 := $606, $627 := $607, $628 := $608, $629 := $609, $630 := $610, $631 := $611, $632 := $612, $633 := $190, $634 := $193", "INNER HASH JOIN EACH WITH ALL ON $603 = $190" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $589, $608 := $590, $609 := $591, $610 := $592, $611 := $593, $612 := $594", "INNER HASH JOIN EACH WITH ALL ON $584 = $180, $588 = $181" ] }, { "kind": "FILTER", "substeps": [ "not_equal($595, $580)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $575, $581 := $560, $582 := $561, $583 := $562, $584 := $563, $585 := $565, $586 := $566, $587 := $567, $588 := $568, $589 := $569, $590 := $570, $591 := $571, $592 := $572, $593 := $573, $594 := $574, $595 := $221", "INNER HASH JOIN EACH WITH ALL ON $564 = $220" ] }, { "kind": "JOIN", "substeps": [ "$560 := $555, $561 := $540, $562 := $541, $563 := $542, $564 := $543, $565 := $544, $566 := $545, $567 := $546, $568 := $547, $569 := $548, $570 := $549, $571 := $550, $572 := $552, $573 := $553, $574 := $554, $575 := $241", "INNER HASH JOIN EACH WITH ALL ON $551 = $240" ] }, { "kind": "JOIN", "substeps": [ "$540 := $535, $541 := $520, $542 := $521, $543 := $522, $544 := $524, $545 := $525, $546 := $526, $547 := $527, $548 := $528, $549 := $529, $550 := $530, $551 := $531, $552 := $532, $553 := $533, $554 := $534, $555 := $301", "INNER HASH JOIN EACH WITH ALL ON $523 = $300" ] }, { "kind": "JOIN", "substeps": [ "$520 := $500, $521 := $501, $522 := $502, $523 := $503, $524 := $504, $525 := $505, $526 := $506, $527 := $507, $528 := $508, $529 := $509, $530 := $510, $531 := $511, $532 := $513, $533 := $514, $534 := $515, $535 := $321", "INNER HASH JOIN EACH WITH ALL ON $512 = $320" ] }, { "kind": "JOIN", "substeps": [ "$500 := $340, $501 := $341, $502 := $343, $503 := $344, $504 := $345, $505 := $346, $506 := $347, $507 := $348, $508 := $349, $509 := $350, $510 := $351, $511 := $361, $512 := $362, $513 := $363, $514 := $364, $515 := $365", "INNER HASH JOIN EACH WITH ALL ON $342 = $360" ] }, { "kind": "WRITE", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "TO __stage2D_output", "BY HASH($870, $871, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $883, $884)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.00040899795501022495, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.0009543285616905249, "writeRatioMax": 0.0013633265167007499 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0010906612133606, "computeRatioMax": 0.0021813224267212, "endMs": "1665777917822", "id": "47", "inputStages": [ "32" ], "name": "S2F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3577", "startMs": "1665777917767", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00040899795501022495, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.0019086571233810498, "writeRatioMax": 0.0029993183367416497 }, { "completedParallelInputs": "6", "computeMsAvg": "5912", "computeMsMax": "7335", "computeRatioAvg": 0.8059986366734833, "computeRatioMax": 1, "endMs": "1665777921845", "id": "48", "inputStages": [ "39", "27", "30", "33", "40", "47", "26", "24", "37", "28", "31", "34", "38", "36", "29", "35", "25" ], "name": "S30: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "29", "readRatioAvg": 0.0032719836400817996, "readRatioMax": 0.003953646898432175, "recordsRead": "29661809", "recordsWritten": "11", "shuffleOutputBytes": "2546", "shuffleOutputBytesSpilled": "0", "slotMs": "34594", "startMs": "1665777917782", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370:ss_sold_date_sk, $371:ss_item_sk, $372:ss_customer_sk, $373:ss_cdemo_sk, $374:ss_hdemo_sk, $375:ss_addr_sk, $376:ss_store_sk, $377:ss_promo_sk, $378:ss_ticket_number, $379:ss_wholesale_cost, $380:ss_list_price, $381:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$390, $391, $392, $393, $394, $395", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$330, $331", "FROM __stage27_output" ] }, { "kind": "READ", "substeps": [ "$310, $311", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$270, $271", "FROM __stage25_output" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage24_output" ] }, { "kind": "READ", "substeps": [ "$200, $201", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$210, $213", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$1090", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1280 := $1273, $1281 := $1272, $1282 := $1261, $1283 := $1262, $1284 := $1263, $1285 := $1264, $1286 := $1265, $1287 := $1266, $1288 := $1267, $1289 := $1268, $1290 := $1269, $1291 := $1270, $1292 := $1271, $1293 := $1277, $1294 := $1260", "$430 := COUNT_STAR()", "$431 := SUM($1274)", "$432 := SUM($1275)", "$433 := SUM($1276)" ] }, { "kind": "JOIN", "substeps": [ "$1260 := $1257, $1261 := $1240, $1262 := $1241, $1263 := $1242, $1264 := $1243, $1265 := $1244, $1266 := $1245, $1267 := $1246, $1268 := $1247, $1269 := $1248, $1270 := $1249, $1271 := $1250, $1272 := $1251, $1273 := $1252, $1274 := $1253, $1275 := $1254", "INNER HASH JOIN EACH WITH ALL ON $1256 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $1236, $1241 := $1237, $1242 := $1220, $1243 := $1221, $1244 := $1222, $1245 := $1223, $1246 := $1224, $1247 := $1225, $1248 := $1226, $1249 := $1227, $1250 := $1228, $1251 := $1229, $1252 := $1230, $1253 := $1231, $1254 := $1232, $1255 := $1233", "INNER HASH JOIN EACH WITH ALL ON $1234 = $30" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $1200, $1221 := $1201, $1222 := $1202, $1223 := $1203, $1224 := $1204, $1225 := $1205, $1226 := $1206, $1227 := $1207, $1228 := $1208, $1229 := $1209, $1230 := $1210, $1231 := $1212, $1232 := $1213, $1233 := $1214, $1234 := $1215, $1235 := $1216", "INNER HASH JOIN EACH WITH ALL ON $1211 = $50" ] }, { "kind": "JOIN", "substeps": [ "$1200 := $1194, $1201 := $1195, $1202 := $1196, $1203 := $1197, $1204 := $1180, $1205 := $1181, $1206 := $1182, $1207 := $1183, $1208 := $1184, $1209 := $1185, $1210 := $1186, $1211 := $1187, $1212 := $1189, $1213 := $1190, $1214 := $1191, $1215 := $1192", "INNER HASH JOIN EACH WITH ALL ON $1188 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1171, $1181 := $1172, $1182 := $1173, $1183 := $1174, $1184 := $1160, $1185 := $1161, $1186 := $1162, $1187 := $1164, $1188 := $1165, $1189 := $1166, $1190 := $1167, $1191 := $1168, $1192 := $1169, $1193 := $1170, $1194 := $91, $1195 := $92", "INNER HASH JOIN EACH WITH ALL ON $1163 = $90" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $1140, $1161 := $1141, $1162 := $1142, $1163 := $1143, $1164 := $1144, $1165 := $1145, $1166 := $1146, $1167 := $1147, $1168 := $1148, $1169 := $1150, $1170 := $1151, $1171 := $111, $1172 := $112, $1173 := $113, $1174 := $114", "INNER HASH JOIN EACH WITH ALL ON $1149 = $110" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $1120, $1141 := $1121, $1142 := $1122, $1143 := $1124, $1144 := $1125, $1145 := $1126, $1146 := $1127, $1147 := $1128, $1148 := $1129, $1149 := $1130, $1150 := $1131, $1151 := $1132", "INNER HASH JOIN EACH WITH ALL ON $1123 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1100, $1121 := $1101, $1122 := $1102, $1123 := $1103, $1124 := $1105, $1125 := $1106, $1126 := $1107, $1127 := $1108, $1128 := $1109, $1129 := $1110, $1130 := $1111, $1131 := $1112, $1132 := $1113", "INNER HASH JOIN EACH WITH ALL ON $1104 = $150" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1064, $1101 := $1050, $1102 := $1051, $1103 := $1052, $1104 := $1053, $1105 := $1055, $1106 := $1056, $1107 := $1057, $1108 := $1058, $1109 := $1059, $1110 := $1060, $1111 := $1061, $1112 := $1062, $1113 := $1063", "INNER HASH JOIN EACH WITH ALL ON $1054 = $1090" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $1043, $1051 := $1044, $1052 := $1030, $1053 := $1031, $1054 := $1033, $1055 := $1034, $1056 := $1035, $1057 := $1036, $1058 := $1037, $1059 := $1038, $1060 := $1039, $1061 := $1040, $1062 := $1041, $1063 := $1042, $1064 := $171", "INNER HASH JOIN EACH WITH ALL ON $1032 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1010, $1031 := $1011, $1032 := $1012, $1033 := $1013, $1034 := $1014, $1035 := $1015, $1036 := $1016, $1037 := $1017, $1038 := $1018, $1039 := $1019, $1040 := $1020, $1041 := $1021, $1042 := $1022, $1043 := $210, $1044 := $213", "INNER HASH JOIN EACH WITH ALL ON $1013 = $210" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $991, $1011 := $992, $1012 := $993, $1013 := $994, $1014 := $995, $1015 := $996, $1016 := $997, $1017 := $999, $1018 := $1000, $1019 := $1001, $1020 := $1002, $1021 := $1003, $1022 := $1004", "INNER HASH JOIN EACH WITH ALL ON $994 = $200, $998 = $201" ] }, { "kind": "FILTER", "substeps": [ "not_equal($1005, $990)" ] }, { "kind": "JOIN", "substeps": [ "$990 := $985, $991 := $970, $992 := $971, $993 := $972, $994 := $973, $995 := $975, $996 := $976, $997 := $977, $998 := $978, $999 := $979, $1000 := $980, $1001 := $981, $1002 := $982, $1003 := $983, $1004 := $984, $1005 := $231", "INNER HASH JOIN EACH WITH ALL ON $974 = $230" ] }, { "kind": "JOIN", "substeps": [ "$970 := $965, $971 := $950, $972 := $951, $973 := $952, $974 := $953, $975 := $954, $976 := $955, $977 := $956, $978 := $957, $979 := $958, $980 := $959, $981 := $960, $982 := $962, $983 := $963, $984 := $964, $985 := $271", "INNER HASH JOIN EACH WITH ALL ON $961 = $270" ] }, { "kind": "JOIN", "substeps": [ "$950 := $945, $951 := $930, $952 := $931, $953 := $932, $954 := $934, $955 := $935, $956 := $936, $957 := $937, $958 := $938, $959 := $939, $960 := $940, $961 := $941, $962 := $942, $963 := $943, $964 := $944, $965 := $311", "INNER HASH JOIN EACH WITH ALL ON $933 = $310" ] }, { "kind": "JOIN", "substeps": [ "$930 := $910, $931 := $911, $932 := $912, $933 := $913, $934 := $914, $935 := $915, $936 := $916, $937 := $917, $938 := $918, $939 := $919, $940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $925, $945 := $331", "INNER HASH JOIN EACH WITH ALL ON $922 = $330" ] }, { "kind": "JOIN", "substeps": [ "$910 := $370, $911 := $371, $912 := $373, $913 := $374, $914 := $375, $915 := $376, $916 := $377, $917 := $378, $918 := $379, $919 := $380, $920 := $381, $921 := $391, $922 := $392, $923 := $393, $924 := $394, $925 := $395", "INNER HASH JOIN EACH WITH ALL ON $372 = $390" ] }, { "kind": "WRITE", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "TO __stage30_output", "BY HASH($1280, $1281, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1293, $1294)" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.0006816632583503749, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.0006816632583503749, "writeRatioMax": 0.0010906612133606 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0008179959100204499, "computeRatioMax": 0.0008179959100204499, "endMs": "1665777921925", "id": "49", "inputStages": [ "48" ], "name": "S31: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777921878", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "FROM __stage30_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1300 := $1280, $1301 := $1281, $1302 := $1282, $1303 := $1283, $1304 := $1284, $1305 := $1285, $1306 := $1286, $1307 := $1287, $1308 := $1288, $1309 := $1289, $1310 := $1290, $1311 := $1291, $1312 := $1292, $1313 := $1293, $1314 := $1294", "$410 := SUM_OF_COUNTS($430)", "$411 := SUM($431)", "$412 := SUM($432)", "$413 := SUM($433)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "TO __stage31_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000136332651670075, "waitRatioMax": 0.000136332651670075, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.0038173142467620995, "writeRatioMax": 0.0038173142467620995 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.001226993865030675, "computeRatioMax": 0.002317655078391275, "endMs": "1665777921987", "id": "51", "inputStages": [ "49" ], "name": "S33: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "3481", "startMs": "1665777921930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage31_output" ] } ], "waitMsAvg": "3", "waitMsMax": "35", "waitRatioAvg": 0.00040899795501022495, "waitRatioMax": 0.004771642808452625, "writeMsAvg": "15", "writeMsMax": "39", "writeRatioAvg": 0.002044989775051125, "writeRatioMax": 0.005316973415132925 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0017723244717109748, "computeRatioMax": 0.0017723244717109748, "endMs": "1665777922012", "id": "52", "inputStages": [ "51", "45" ], "name": "S34: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "19", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777921964", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "FROM __stage2D_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "FROM __stage33_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($1337, $1332)" ] }, { "kind": "JOIN", "substeps": [ "$1320 := $892, $1321 := $893, $1322 := $894, $1323 := $895, $1324 := $896, $1325 := $897, $1326 := $898, $1327 := $899, $1328 := $900, $1329 := $901, $1330 := $902, $1331 := $890, $1332 := $400, $1333 := $401, $1334 := $402, $1335 := $403", "INNER HASH JOIN EACH WITH ALL ON $891 = $1301, $892 = $1302, $893 = $1303" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $870, $891 := $871, $892 := $872, $893 := $873, $894 := $874, $895 := $875, $896 := $876, $897 := $877, $898 := $878, $899 := $879, $900 := $880, $901 := $881, $902 := $882, $903 := $883, $904 := $884", "$400 := SUM_OF_COUNTS($420)", "$401 := SUM($421)", "$402 := SUM($422)", "$403 := SUM($423)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "TO __stage34_output" ] } ], "waitMsAvg": "25", "waitMsMax": "25", "waitRatioAvg": 0.0034083162917518746, "waitRatioMax": 0.0034083162917518746, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0009543285616905249, "writeRatioMax": 0.0009543285616905249 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0010906612133606, "computeRatioMax": 0.0010906612133606, "endMs": "1665777922056", "id": "53", "inputStages": [ "52" ], "name": "S35: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777922019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "FROM __stage34_output" ] }, { "kind": "SORT", "substeps": [ "$1331 ASC, $1320 ASC, $1337 ASC, $1333 ASC, $1338 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1350, $1351, $1352, $1353, $1354, $1355, $1356, $1357, $1358, $1359, $1360, $1361, $1362, $1363, $1364, $1365", "TO __stage35_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00027266530334015, "waitRatioMax": 0.00027266530334015, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.0038173142467620995, "writeRatioMax": 0.0038173142467620995 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "income_band" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "11", "elapsedMs": "716", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3586" }, { "activeUnits": "14", "completedUnits": "145", "elapsedMs": "1731", "estimatedRunnableUnits": "0", "pendingUnits": "13", "totalSlotMs": "16440" }, { "activeUnits": "12", "completedUnits": "246", "elapsedMs": "2249", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "24396" }, { "activeUnits": "12", "completedUnits": "246", "elapsedMs": "3703", "estimatedRunnableUnits": "6", "pendingUnits": "12", "totalSlotMs": "52576" }, { "activeUnits": "10", "completedUnits": "255", "elapsedMs": "5262", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "77819" }, { "activeUnits": "4", "completedUnits": "361", "elapsedMs": "6171", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "86510" } ], "totalBytesBilled": "422576128", "totalBytesProcessed": "421895625", "totalPartitionsProcessed": "0", "totalSlotMs": "86510", "transferredBytes": "0" }, "startTime": "1665777915945", "totalBytesProcessed": "421895625", "totalSlotMs": "86510" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon51dedfc5_ecac_4b0d_ace1_ee5d0ce03fe8" }, "priority": "INTERACTIVE", "query": "with cs_ui as\n (select cs_item_sk\n ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n from catalog_sales\n ,catalog_returns\n where cs_item_sk = cr_item_sk\n and cs_order_number = cr_order_number\n group by cs_item_sk\n having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n ,i_item_sk item_sk\n ,s_store_name store_name\n ,s_zip store_zip\n ,ad1.ca_street_number b_street_number\n ,ad1.ca_street_name b_street_name\n ,ad1.ca_city b_city\n ,ad1.ca_zip b_zip\n ,ad2.ca_street_number c_street_number\n ,ad2.ca_street_name c_street_name\n ,ad2.ca_city c_city\n ,ad2.ca_zip c_zip\n ,d1.d_year as syear\n ,d2.d_year as fsyear\n ,d3.d_year s2year\n ,count(*) cnt\n ,sum(ss_wholesale_cost) s1\n ,sum(ss_list_price) s2\n ,sum(ss_coupon_amt) s3\n FROM store_sales\n ,store_returns\n ,cs_ui\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,customer\n ,customer_demographics cd1\n ,customer_demographics cd2\n ,promotion\n ,household_demographics hd1\n ,household_demographics hd2\n ,customer_address ad1\n ,customer_address ad2\n ,income_band ib1\n ,income_band ib2\n ,item\n WHERE ss_store_sk = s_store_sk AND\n ss_sold_date_sk = d1.d_date_sk AND\n ss_customer_sk = c_customer_sk AND\n ss_cdemo_sk= cd1.cd_demo_sk AND\n ss_hdemo_sk = hd1.hd_demo_sk AND\n ss_addr_sk = ad1.ca_address_sk and\n ss_item_sk = i_item_sk and\n ss_item_sk = sr_item_sk and\n ss_ticket_number = sr_ticket_number and\n ss_item_sk = cs_ui.cs_item_sk and\n c_current_cdemo_sk = cd2.cd_demo_sk AND\n c_current_hdemo_sk = hd2.hd_demo_sk AND\n c_current_addr_sk = ad2.ca_address_sk and\n c_first_sales_date_sk = d2.d_date_sk and\n c_first_shipto_date_sk = d3.d_date_sk and\n ss_promo_sk = p_promo_sk and\n hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n cd1.cd_marital_status <> cd2.cd_marital_status and\n i_color in ('orange','lace','lawn','misty','blush','pink') and\n i_current_price between 48 and 48 + 10 and\n i_current_price between 48 + 1 and 48 + 15\ngroup by i_product_name\n ,i_item_sk\n ,s_store_name\n ,s_zip\n ,ad1.ca_street_number\n ,ad1.ca_street_name\n ,ad1.ca_city\n ,ad1.ca_zip\n ,ad2.ca_street_number\n ,ad2.ca_street_name\n ,ad2.ca_city\n ,ad2.ca_zip\n ,d1.d_year\n ,d2.d_year\n ,d3.d_year\n)\nselect cs1.product_name\n ,cs1.store_name\n ,cs1.store_zip\n ,cs1.b_street_number\n ,cs1.b_street_name\n ,cs1.b_city\n ,cs1.b_zip\n ,cs1.c_street_number\n ,cs1.c_street_name\n ,cs1.c_city\n ,cs1.c_zip\n ,cs1.syear\n ,cs1.cnt\n ,cs1.s1 as s11\n ,cs1.s2 as s21\n ,cs1.s3 as s31\n ,cs2.s1 as s12\n ,cs2.s2 as s22\n ,cs2.s3 as s32\n ,cs2.syear\n ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n cs1.syear = 1999 and\n cs2.syear = 1999 + 1 and\n cs2.cnt <= cs1.cnt and\n cs1.store_name = cs2.store_name and\n cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n ,cs1.store_name\n ,cs2.cnt\n ,cs1.s1\n ,cs2.s1;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "D/cU5nN247FQlX+QwLEvLQ==", "id": "test-project-364309:europe-west1.query64_1665777923", "jobReference": { "jobId": "query64_1665777923", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query64_1665777923?location=europe-west1", "statistics": { "creationTime": "1665777924105", "endTime": "1665777930321", "finalExecutionDurationMs": "5805", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "421895625", "performanceInsights": { "avgPreviousExecutionMs": "6378" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "297", "computeMsMax": "297", "computeRatioAvg": 0.043465534904141664, "computeRatioMax": 0.043465534904141664, "endMs": "1665777924619", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.002926972047416947, "readRatioMax": 0.002926972047416947, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "371", "startMs": "1665777924392", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290:cr_item_sk, $291:cr_order_number, $292:cr_refunded_cash, $293:cr_reversed_charge, $294:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0019025318308210156, "writeRatioMax": 0.0019025318308210156 }, { "completedParallelInputs": "1", "computeMsAvg": "293", "computeMsMax": "293", "computeRatioAvg": 0.04288014049465828, "computeRatioMax": 0.04288014049465828, "endMs": "1665777924623", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.002048880433191863, "readRatioMax": 0.002048880433191863, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "350", "startMs": "1665777924419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260:cr_item_sk, $261:cr_order_number, $262:cr_refunded_cash, $263:cr_reversed_charge, $264:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0023415776379335576, "writeRatioMax": 0.0023415776379335576 }, { "completedParallelInputs": "5", "computeMsAvg": "381", "computeMsMax": "467", "computeRatioAvg": 0.05575881750329284, "computeRatioMax": 0.06834479730718572, "endMs": "1665777924933", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "26", "readRatioAvg": 0.0023415776379335576, "readRatioMax": 0.003805063661642031, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "1913", "startMs": "1665777924655", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280:cs_item_sk, $281:cs_order_number, $282:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $1070", "$470 := SUM($1071)", "$471 := SUM($490)" ] }, { "kind": "COMPUTE", "substeps": [ "$490 := add(add($1072, $1073), $1074)" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $280, $1071 := $282, $1072 := $292, $1073 := $293, $1074 := $294", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291" ] }, { "kind": "WRITE", "substeps": [ "$1080, $470, $471", "TO __stage04_output", "BY HASH($1080)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.0008780916142250841, "writeRatioMax": 0.0011707888189667788 }, { "completedParallelInputs": "5", "computeMsAvg": "338", "computeMsMax": "570", "computeRatioAvg": 0.04946582760134641, "computeRatioMax": 0.08341870335138299, "endMs": "1665777925023", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "21", "readRatioAvg": 0.0023415776379335576, "readRatioMax": 0.0030733206497877944, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "1697", "startMs": "1665777924678", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250:cs_item_sk, $251:cs_order_number, $252:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $660", "$460 := SUM($661)", "$461 := SUM($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := add(add($662, $663), $664)" ] }, { "kind": "JOIN", "substeps": [ "$660 := $250, $661 := $252, $662 := $262, $663 := $263, $664 := $264", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261" ] }, { "kind": "WRITE", "substeps": [ "$670, $460, $461", "TO __stage05_output", "BY HASH($670)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.0008780916142250841, "writeRatioMax": 0.0011707888189667788 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.006146641299575589, "computeRatioMax": 0.006146641299575589, "endMs": "1665777924993", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011707888189667788, "readRatioMax": 0.0011707888189667788, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777924952", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0016098346260793209, "writeRatioMax": 0.0016098346260793209 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.0035123664569003364, "computeRatioMax": 0.0035123664569003364, "endMs": "1665777925010", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011707888189667788, "readRatioMax": 0.0011707888189667788, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777924976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014634860237084735, "writeRatioMax": 0.0014634860237084735 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0011707888189667788, "computeRatioMax": 0.0011707888189667788, "endMs": "1665777925023", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0010244402165959315, "readRatioMax": 0.0010244402165959315, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777924990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_store_name, $52:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0010244402165959315, "writeRatioMax": 0.0010244402165959315 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0014634860237084735, "computeRatioMax": 0.0014634860237084735, "endMs": "1665777925039", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011707888189667788, "readRatioMax": 0.0011707888189667788, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777925002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0027806234450460997, "writeRatioMax": 0.0027806234450460997 }, { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.006732035709058978, "computeRatioMax": 0.006732035709058978, "endMs": "1665777925080", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0013171374213376262, "readRatioMax": 0.0013171374213376262, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665777925022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_street_number, $92:ca_street_name, $93:ca_city, $94:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0013171374213376262, "writeRatioMax": 0.0013171374213376262 }, { "completedParallelInputs": "1", "computeMsAvg": "68", "computeMsMax": "68", "computeRatioAvg": 0.00995170496121762, "computeRatioMax": 0.00995170496121762, "endMs": "1665777925105", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011707888189667788, "readRatioMax": 0.0011707888189667788, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "88", "startMs": "1665777925038", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ca_address_sk, $111:ca_street_number, $112:ca_street_name, $113:ca_city, $114:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0017561832284501682, "writeRatioMax": 0.0017561832284501682 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0013171374213376262, "computeRatioMax": 0.0013171374213376262, "endMs": "1665777925093", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008780916142250841, "readRatioMax": 0.0008780916142250841, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777925058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0016098346260793209, "writeRatioMax": 0.0016098346260793209 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0011707888189667788, "computeRatioMax": 0.0011707888189667788, "endMs": "1665777925116", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007317430118542368, "readRatioMax": 0.0007317430118542368, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665777925072", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0027806234450460997, "writeRatioMax": 0.0027806234450460997 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.007024732913800673, "computeRatioMax": 0.007024732913800673, "endMs": "1665777925147", "id": "14", "inputStages": [ "4" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665777925087", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1080, $470, $471", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "greater($450, multiply(NUMERIC<...>, $451))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080", "$450 := SUM($470)", "$451 := SUM($471)" ] }, { "kind": "WRITE", "substeps": [ "$1090", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.003951412264012879, "writeRatioMax": 0.003951412264012879 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0014634860237084735, "computeRatioMax": 0.0014634860237084735, "endMs": "1665777925144", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007317430118542368, "readRatioMax": 0.0007317430118542368, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777925104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002048880433191863, "writeRatioMax": 0.002048880433191863 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0016098346260793209, "computeRatioMax": 0.0016098346260793209, "endMs": "1665777925147", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014634860237084735, "readRatioMax": 0.0014634860237084735, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777925120", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $213:i_product_name, $211:i_current_price, $212:i_color", "FROM item", "WHERE and(in($212, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($211, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$210, $213", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0013171374213376262, "writeRatioMax": 0.0013171374213376262 }, { "completedParallelInputs": "1", "computeMsAvg": "145", "computeMsMax": "145", "computeRatioAvg": 0.021220547343772867, "computeRatioMax": 0.021220547343772867, "endMs": "1665777925266", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014634860237084735, "readRatioMax": 0.0014634860237084735, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "154", "startMs": "1665777925134", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:sr_item_sk, $201:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$200, $201", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0016098346260793209, "writeRatioMax": 0.0016098346260793209 }, { "completedParallelInputs": "1", "computeMsAvg": "791", "computeMsMax": "791", "computeRatioAvg": 0.11576174447534027, "computeRatioMax": 0.11576174447534027, "endMs": "1665777925534", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014634860237084735, "readRatioMax": 0.0014634860237084735, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "517", "startMs": "1665777925151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:cd_demo_sk, $231:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.007902824528025758, "writeRatioMax": 0.007902824528025758 }, { "completedParallelInputs": "1", "computeMsAvg": "618", "computeMsMax": "618", "computeRatioAvg": 0.09044343626518367, "computeRatioMax": 0.09044343626518367, "endMs": "1665777925666", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.002048880433191863, "readRatioMax": 0.002048880433191863, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "675", "startMs": "1665777925165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270:cd_demo_sk, $271:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "80", "writeMsMax": "80", "writeRatioAvg": 0.011707888189667788, "writeRatioMax": 0.011707888189667788 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0019025318308210156, "computeRatioMax": 0.0019025318308210156, "endMs": "1665777925217", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008780916142250841, "readRatioMax": 0.0008780916142250841, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777925179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310:hd_demo_sk, $311:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$310, $311", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0011707888189667788, "writeRatioMax": 0.0011707888189667788 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0019025318308210156, "computeRatioMax": 0.0019025318308210156, "endMs": "1665777925232", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007317430118542368, "readRatioMax": 0.0007317430118542368, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777925192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330:hd_demo_sk, $331:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$330, $331", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002048880433191863, "writeRatioMax": 0.002048880433191863 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.01595199765842236, "computeRatioMax": 0.01595199765842236, "endMs": "1665777925306", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011707888189667788, "readRatioMax": 0.0011707888189667788, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "122", "startMs": "1665777925207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390:c_customer_sk, $391:c_current_cdemo_sk, $392:c_current_hdemo_sk, $393:c_current_addr_sk, $394:c_first_shipto_date_sk, $395:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392, $393, $394, $395", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014634860237084735, "writeRatioMax": 0.0014634860237084735 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.005122201082979658, "computeRatioMax": 0.005122201082979658, "endMs": "1665777925283", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0010244402165959315, "readRatioMax": 0.0010244402165959315, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777925243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0013171374213376262, "writeRatioMax": 0.0013171374213376262 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.003805063661642031, "computeRatioMax": 0.003805063661642031, "endMs": "1665777925289", "id": "25", "name": "S19: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007317430118542368, "readRatioMax": 0.0007317430118542368, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777925256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014634860237084735, "writeRatioMax": 0.0014634860237084735 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0010244402165959315, "computeRatioMax": 0.0010244402165959315, "endMs": "1665777925306", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00043904580711254205, "readRatioMax": 0.00043904580711254205, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777925271", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_store_name, $42:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.003805063661642031, "writeRatioMax": 0.003805063661642031 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0011707888189667788, "computeRatioMax": 0.0011707888189667788, "endMs": "1665777925312", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007317430118542368, "readRatioMax": 0.0007317430118542368, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777925285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0023415776379335576, "writeRatioMax": 0.0023415776379335576 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.005853944094833894, "computeRatioMax": 0.005853944094833894, "endMs": "1665777925355", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011707888189667788, "readRatioMax": 0.0011707888189667788, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777925300", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_street_number, $82:ca_street_name, $83:ca_city, $84:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014634860237084735, "writeRatioMax": 0.0014634860237084735 }, { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.006878384311429826, "computeRatioMax": 0.006878384311429826, "endMs": "1665777925370", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008780916142250841, "readRatioMax": 0.0008780916142250841, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665777925313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_street_number, $102:ca_street_name, $103:ca_city, $104:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0013171374213376262, "writeRatioMax": 0.0013171374213376262 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0011707888189667788, "computeRatioMax": 0.0011707888189667788, "endMs": "1665777925365", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00043904580711254205, "readRatioMax": 0.00043904580711254205, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777925325", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0023415776379335576, "writeRatioMax": 0.0023415776379335576 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0014634860237084735, "computeRatioMax": 0.0014634860237084735, "endMs": "1665777925371", "id": "31", "name": "S1F: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007317430118542368, "readRatioMax": 0.0007317430118542368, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777925340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002487926240304405, "writeRatioMax": 0.002487926240304405 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.005853944094833894, "computeRatioMax": 0.005853944094833894, "endMs": "1665777925388", "id": "32", "inputStages": [ "5" ], "name": "S20: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777925355", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $460, $461", "FROM __stage05_output" ] }, { "kind": "FILTER", "substeps": [ "greater($440, multiply(NUMERIC<...>, $441))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670", "$440 := SUM($460)", "$441 := SUM($461)" ] }, { "kind": "WRITE", "substeps": [ "$680", "TO __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0005853944094833894, "writeRatioMax": 0.0005853944094833894 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0016098346260793209, "computeRatioMax": 0.0016098346260793209, "endMs": "1665777925404", "id": "33", "name": "S21: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0019025318308210156, "readRatioMax": 0.0019025318308210156, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777925368", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year", "FROM date_dim", "WHERE equal($161, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0007317430118542368, "writeRatioMax": 0.0007317430118542368 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0019025318308210156, "computeRatioMax": 0.0019025318308210156, "endMs": "1665777925423", "id": "34", "name": "S22: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0010244402165959315, "readRatioMax": 0.0010244402165959315, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777925382", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $193:i_product_name, $191:i_current_price, $192:i_color", "FROM item", "WHERE and(in($192, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($191, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$190, $193", "TO __stage22_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0010244402165959315, "writeRatioMax": 0.0010244402165959315 }, { "completedParallelInputs": "1", "computeMsAvg": "198", "computeMsMax": "198", "computeRatioAvg": 0.028977023269427776, "computeRatioMax": 0.028977023269427776, "endMs": "1665777925563", "id": "35", "name": "S23: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014634860237084735, "readRatioMax": 0.0014634860237084735, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "191", "startMs": "1665777925397", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:sr_item_sk, $181:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$180, $181", "TO __stage23_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021952290355627103, "writeRatioMax": 0.0021952290355627103 }, { "completedParallelInputs": "1", "computeMsAvg": "574", "computeMsMax": "574", "computeRatioAvg": 0.08400409776086638, "computeRatioMax": 0.08400409776086638, "endMs": "1665777925876", "id": "36", "name": "S24: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0013171374213376262, "readRatioMax": 0.0013171374213376262, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "573", "startMs": "1665777925414", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:cd_demo_sk, $221:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$220, $221", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "53", "writeMsMax": "53", "writeRatioAvg": 0.00775647592565491, "writeRatioMax": 0.00775647592565491 }, { "completedParallelInputs": "1", "computeMsAvg": "708", "computeMsMax": "708", "computeRatioAvg": 0.10361481047855993, "computeRatioMax": 0.10361481047855993, "endMs": "1665777926035", "id": "37", "name": "S25: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014634860237084735, "readRatioMax": 0.0014634860237084735, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "758", "startMs": "1665777925427", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240:cd_demo_sk, $241:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage25_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "76", "writeMsMax": "76", "writeRatioAvg": 0.011122493780184399, "writeRatioMax": 0.011122493780184399 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0013171374213376262, "computeRatioMax": 0.0013171374213376262, "endMs": "1665777925481", "id": "38", "name": "S26: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005853944094833894, "readRatioMax": 0.0005853944094833894, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777925440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300:hd_demo_sk, $301:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage26_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021952290355627103, "writeRatioMax": 0.0021952290355627103 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0019025318308210156, "computeRatioMax": 0.0019025318308210156, "endMs": "1665777925492", "id": "39", "name": "S27: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007317430118542368, "readRatioMax": 0.0007317430118542368, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777925456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320:hd_demo_sk, $321:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage27_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014634860237084735, "waitRatioMax": 0.00014634860237084735, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0013171374213376262, "writeRatioMax": 0.0013171374213376262 }, { "completedParallelInputs": "1", "computeMsAvg": "105", "computeMsMax": "105", "computeRatioAvg": 0.015366603248938973, "computeRatioMax": 0.015366603248938973, "endMs": "1665777925566", "id": "40", "name": "S28: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0013171374213376262, "readRatioMax": 0.0013171374213376262, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "119", "startMs": "1665777925469", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360:c_customer_sk, $361:c_current_cdemo_sk, $362:c_current_hdemo_sk, $363:c_current_addr_sk, $364:c_first_shipto_date_sk, $365:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $364, $365", "TO __stage28_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014634860237084735, "writeRatioMax": 0.0014634860237084735 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.0011707888189667788, "computeRatioMax": 0.002926972047416947, "endMs": "1665777925840", "id": "44", "inputStages": [ "14" ], "name": "S2C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3334", "startMs": "1665777925792", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.00043904580711254205, "waitRatioMax": 0.0007317430118542368, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.0021952290355627103, "writeRatioMax": 0.0027806234450460997 }, { "completedParallelInputs": "6", "computeMsAvg": "4863", "computeMsMax": "6415", "computeRatioAvg": 0.7116932533294307, "computeRatioMax": 0.9388262842089858, "endMs": "1665777928915", "id": "45", "inputStages": [ "15", "18", "7", "6", "16", "8", "13", "10", "17", "21", "20", "9", "44", "22", "19", "11", "12" ], "name": "S2D: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "30", "readRatioAvg": 0.0032196692521586417, "readRatioMax": 0.0043904580711254205, "recordsRead": "29661809", "recordsWritten": "11", "shuffleOutputBytes": "2546", "shuffleOutputBytesSpilled": "0", "slotMs": "24345", "startMs": "1665777925807", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370:ss_sold_date_sk, $371:ss_item_sk, $372:ss_customer_sk, $373:ss_cdemo_sk, $374:ss_hdemo_sk, $375:ss_addr_sk, $376:ss_store_sk, $377:ss_promo_sk, $378:ss_ticket_number, $379:ss_wholesale_cost, $380:ss_list_price, $381:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$390, $391, $392, $393, $394, $395", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$330, $331", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$310, $311", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$270, $271", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$200, $201", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$210, $213", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$1090", "FROM __stage2C_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1280 := $1273, $1281 := $1272, $1282 := $1261, $1283 := $1262, $1284 := $1263, $1285 := $1264, $1286 := $1265, $1287 := $1266, $1288 := $1267, $1289 := $1268, $1290 := $1269, $1291 := $1270, $1292 := $1271, $1293 := $1277, $1294 := $1260", "$430 := COUNT_STAR()", "$431 := SUM($1274)", "$432 := SUM($1275)", "$433 := SUM($1276)" ] }, { "kind": "JOIN", "substeps": [ "$1260 := $1257, $1261 := $1240, $1262 := $1241, $1263 := $1242, $1264 := $1243, $1265 := $1244, $1266 := $1245, $1267 := $1246, $1268 := $1247, $1269 := $1248, $1270 := $1249, $1271 := $1250, $1272 := $1251, $1273 := $1252, $1274 := $1253, $1275 := $1254", "INNER HASH JOIN EACH WITH ALL ON $1256 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $1236, $1241 := $1237, $1242 := $1220, $1243 := $1221, $1244 := $1222, $1245 := $1223, $1246 := $1224, $1247 := $1225, $1248 := $1226, $1249 := $1227, $1250 := $1228, $1251 := $1229, $1252 := $1230, $1253 := $1231, $1254 := $1232, $1255 := $1233", "INNER HASH JOIN EACH WITH ALL ON $1234 = $30" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $1200, $1221 := $1201, $1222 := $1202, $1223 := $1203, $1224 := $1204, $1225 := $1205, $1226 := $1206, $1227 := $1207, $1228 := $1208, $1229 := $1209, $1230 := $1210, $1231 := $1212, $1232 := $1213, $1233 := $1214, $1234 := $1215, $1235 := $1216", "INNER HASH JOIN EACH WITH ALL ON $1211 = $50" ] }, { "kind": "JOIN", "substeps": [ "$1200 := $1194, $1201 := $1195, $1202 := $1196, $1203 := $1197, $1204 := $1180, $1205 := $1181, $1206 := $1182, $1207 := $1183, $1208 := $1184, $1209 := $1185, $1210 := $1186, $1211 := $1187, $1212 := $1189, $1213 := $1190, $1214 := $1191, $1215 := $1192", "INNER HASH JOIN EACH WITH ALL ON $1188 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1171, $1181 := $1172, $1182 := $1173, $1183 := $1174, $1184 := $1160, $1185 := $1161, $1186 := $1162, $1187 := $1164, $1188 := $1165, $1189 := $1166, $1190 := $1167, $1191 := $1168, $1192 := $1169, $1193 := $1170, $1194 := $91, $1195 := $92", "INNER HASH JOIN EACH WITH ALL ON $1163 = $90" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $1140, $1161 := $1141, $1162 := $1142, $1163 := $1143, $1164 := $1144, $1165 := $1145, $1166 := $1146, $1167 := $1147, $1168 := $1148, $1169 := $1150, $1170 := $1151, $1171 := $111, $1172 := $112, $1173 := $113, $1174 := $114", "INNER HASH JOIN EACH WITH ALL ON $1149 = $110" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $1120, $1141 := $1121, $1142 := $1122, $1143 := $1124, $1144 := $1125, $1145 := $1126, $1146 := $1127, $1147 := $1128, $1148 := $1129, $1149 := $1130, $1150 := $1131, $1151 := $1132", "INNER HASH JOIN EACH WITH ALL ON $1123 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1100, $1121 := $1101, $1122 := $1102, $1123 := $1103, $1124 := $1105, $1125 := $1106, $1126 := $1107, $1127 := $1108, $1128 := $1109, $1129 := $1110, $1130 := $1111, $1131 := $1112, $1132 := $1113", "INNER HASH JOIN EACH WITH ALL ON $1104 = $150" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1064, $1101 := $1050, $1102 := $1051, $1103 := $1052, $1104 := $1053, $1105 := $1055, $1106 := $1056, $1107 := $1057, $1108 := $1058, $1109 := $1059, $1110 := $1060, $1111 := $1061, $1112 := $1062, $1113 := $1063", "INNER HASH JOIN EACH WITH ALL ON $1054 = $1090" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $1043, $1051 := $1044, $1052 := $1030, $1053 := $1031, $1054 := $1033, $1055 := $1034, $1056 := $1035, $1057 := $1036, $1058 := $1037, $1059 := $1038, $1060 := $1039, $1061 := $1040, $1062 := $1041, $1063 := $1042, $1064 := $171", "INNER HASH JOIN EACH WITH ALL ON $1032 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1010, $1031 := $1011, $1032 := $1012, $1033 := $1013, $1034 := $1014, $1035 := $1015, $1036 := $1016, $1037 := $1017, $1038 := $1018, $1039 := $1019, $1040 := $1020, $1041 := $1021, $1042 := $1022, $1043 := $210, $1044 := $213", "INNER HASH JOIN EACH WITH ALL ON $1013 = $210" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $991, $1011 := $992, $1012 := $993, $1013 := $994, $1014 := $995, $1015 := $996, $1016 := $997, $1017 := $999, $1018 := $1000, $1019 := $1001, $1020 := $1002, $1021 := $1003, $1022 := $1004", "INNER HASH JOIN EACH WITH ALL ON $994 = $200, $998 = $201" ] }, { "kind": "FILTER", "substeps": [ "not_equal($1005, $990)" ] }, { "kind": "JOIN", "substeps": [ "$990 := $985, $991 := $970, $992 := $971, $993 := $972, $994 := $973, $995 := $975, $996 := $976, $997 := $977, $998 := $978, $999 := $979, $1000 := $980, $1001 := $981, $1002 := $982, $1003 := $983, $1004 := $984, $1005 := $231", "INNER HASH JOIN EACH WITH ALL ON $974 = $230" ] }, { "kind": "JOIN", "substeps": [ "$970 := $965, $971 := $950, $972 := $951, $973 := $952, $974 := $953, $975 := $954, $976 := $955, $977 := $956, $978 := $957, $979 := $958, $980 := $959, $981 := $960, $982 := $962, $983 := $963, $984 := $964, $985 := $271", "INNER HASH JOIN EACH WITH ALL ON $961 = $270" ] }, { "kind": "JOIN", "substeps": [ "$950 := $945, $951 := $930, $952 := $931, $953 := $932, $954 := $934, $955 := $935, $956 := $936, $957 := $937, $958 := $938, $959 := $939, $960 := $940, $961 := $941, $962 := $942, $963 := $943, $964 := $944, $965 := $311", "INNER HASH JOIN EACH WITH ALL ON $933 = $310" ] }, { "kind": "JOIN", "substeps": [ "$930 := $910, $931 := $911, $932 := $912, $933 := $913, $934 := $914, $935 := $915, $936 := $916, $937 := $917, $938 := $918, $939 := $919, $940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $925, $945 := $331", "INNER HASH JOIN EACH WITH ALL ON $922 = $330" ] }, { "kind": "JOIN", "substeps": [ "$910 := $370, $911 := $371, $912 := $373, $913 := $374, $914 := $375, $915 := $376, $916 := $377, $917 := $378, $918 := $379, $919 := $380, $920 := $381, $921 := $391, $922 := $392, $923 := $393, $924 := $394, $925 := $395", "INNER HASH JOIN EACH WITH ALL ON $372 = $390" ] }, { "kind": "WRITE", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "TO __stage2D_output", "BY HASH($1280, $1281, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1293, $1294)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.00043904580711254205, "waitRatioMax": 0.0005853944094833894, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.0008780916142250841, "writeRatioMax": 0.0013171374213376262 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.0011707888189667788, "computeRatioMax": 0.002487926240304405, "endMs": "1665777926127", "id": "46", "inputStages": [ "32" ], "name": "S2E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3548", "startMs": "1665777926072", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage20_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.00043904580711254205, "waitRatioMax": 0.0005853944094833894, "writeMsAvg": "19", "writeMsMax": "38", "writeRatioAvg": 0.0027806234450460997, "writeRatioMax": 0.005561246890092199 }, { "completedParallelInputs": "6", "computeMsAvg": "5680", "computeMsMax": "6833", "computeRatioAvg": 0.831260061466413, "computeRatioMax": 1, "endMs": "1665777929931", "id": "47", "inputStages": [ "34", "39", "30", "25", "26", "38", "33", "46", "36", "31", "28", "37", "29", "24", "35", "40", "27" ], "name": "S2F: Join+", "parallelInputs": "6", "readMsAvg": "32", "readMsMax": "37", "readRatioAvg": 0.004683155275867115, "readRatioMax": 0.005414898287721352, "recordsRead": "29398184", "recordsWritten": "8", "shuffleOutputBytes": "1830", "shuffleOutputBytesSpilled": "0", "slotMs": "30311", "startMs": "1665777926087", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340:ss_sold_date_sk, $341:ss_item_sk, $342:ss_customer_sk, $343:ss_cdemo_sk, $344:ss_hdemo_sk, $345:ss_addr_sk, $346:ss_store_sk, $347:ss_promo_sk, $348:ss_ticket_number, $349:ss_wholesale_cost, $350:ss_list_price, $351:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $364, $365", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage27_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$240, $241", "FROM __stage25_output" ] }, { "kind": "READ", "substeps": [ "$220, $221", "FROM __stage24_output" ] }, { "kind": "READ", "substeps": [ "$180, $181", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$190, $193", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$680", "FROM __stage2E_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $870 := $863, $871 := $862, $872 := $851, $873 := $852, $874 := $853, $875 := $854, $876 := $855, $877 := $856, $878 := $857, $879 := $858, $880 := $859, $881 := $860, $882 := $861, $883 := $867, $884 := $850", "$420 := COUNT_STAR()", "$421 := SUM($864)", "$422 := SUM($865)", "$423 := SUM($866)" ] }, { "kind": "JOIN", "substeps": [ "$850 := $847, $851 := $830, $852 := $831, $853 := $832, $854 := $833, $855 := $834, $856 := $835, $857 := $836, $858 := $837, $859 := $838, $860 := $839, $861 := $840, $862 := $841, $863 := $842, $864 := $843, $865 := $844", "INNER HASH JOIN EACH WITH ALL ON $846 = $1" ] }, { "kind": "JOIN", "substeps": [ "$830 := $826, $831 := $827, $832 := $810, $833 := $811, $834 := $812, $835 := $813, $836 := $814, $837 := $815, $838 := $816, $839 := $817, $840 := $818, $841 := $819, $842 := $820, $843 := $821, $844 := $822, $845 := $823", "INNER HASH JOIN EACH WITH ALL ON $824 = $20" ] }, { "kind": "JOIN", "substeps": [ "$810 := $790, $811 := $791, $812 := $792, $813 := $793, $814 := $794, $815 := $795, $816 := $796, $817 := $797, $818 := $798, $819 := $799, $820 := $800, $821 := $802, $822 := $803, $823 := $804, $824 := $805, $825 := $806", "INNER HASH JOIN EACH WITH ALL ON $801 = $40" ] }, { "kind": "JOIN", "substeps": [ "$790 := $784, $791 := $785, $792 := $786, $793 := $787, $794 := $770, $795 := $771, $796 := $772, $797 := $773, $798 := $774, $799 := $775, $800 := $776, $801 := $777, $802 := $779, $803 := $780, $804 := $781, $805 := $782", "INNER HASH JOIN EACH WITH ALL ON $778 = $60" ] }, { "kind": "JOIN", "substeps": [ "$770 := $761, $771 := $762, $772 := $763, $773 := $764, $774 := $750, $775 := $751, $776 := $752, $777 := $754, $778 := $755, $779 := $756, $780 := $757, $781 := $758, $782 := $759, $783 := $760, $784 := $81, $785 := $82", "INNER HASH JOIN EACH WITH ALL ON $753 = $80" ] }, { "kind": "JOIN", "substeps": [ "$750 := $730, $751 := $731, $752 := $732, $753 := $733, $754 := $734, $755 := $735, $756 := $736, $757 := $737, $758 := $738, $759 := $740, $760 := $741, $761 := $101, $762 := $102, $763 := $103, $764 := $104", "INNER HASH JOIN EACH WITH ALL ON $739 = $100" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $712, $733 := $714, $734 := $715, $735 := $716, $736 := $717, $737 := $718, $738 := $719, $739 := $720, $740 := $721, $741 := $722", "INNER HASH JOIN EACH WITH ALL ON $713 = $120" ] }, { "kind": "JOIN", "substeps": [ "$710 := $690, $711 := $691, $712 := $692, $713 := $693, $714 := $695, $715 := $696, $716 := $697, $717 := $698, $718 := $699, $719 := $700, $720 := $701, $721 := $702, $722 := $703", "INNER HASH JOIN EACH WITH ALL ON $694 = $140" ] }, { "kind": "JOIN", "substeps": [ "$690 := $654, $691 := $640, $692 := $641, $693 := $642, $694 := $643, $695 := $645, $696 := $646, $697 := $647, $698 := $648, $699 := $649, $700 := $650, $701 := $651, $702 := $652, $703 := $653", "INNER HASH JOIN EACH WITH ALL ON $644 = $680" ] }, { "kind": "JOIN", "substeps": [ "$640 := $633, $641 := $634, $642 := $620, $643 := $621, $644 := $623, $645 := $624, $646 := $625, $647 := $626, $648 := $627, $649 := $628, $650 := $629, $651 := $630, $652 := $631, $653 := $632, $654 := $161", "INNER HASH JOIN EACH WITH ALL ON $622 = $160" ] }, { "kind": "JOIN", "substeps": [ "$620 := $600, $621 := $601, $622 := $602, $623 := $603, $624 := $604, $625 := $605, $626 := $606, $627 := $607, $628 := $608, $629 := $609, $630 := $610, $631 := $611, $632 := $612, $633 := $190, $634 := $193", "INNER HASH JOIN EACH WITH ALL ON $603 = $190" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $589, $608 := $590, $609 := $591, $610 := $592, $611 := $593, $612 := $594", "INNER HASH JOIN EACH WITH ALL ON $584 = $180, $588 = $181" ] }, { "kind": "FILTER", "substeps": [ "not_equal($595, $580)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $575, $581 := $560, $582 := $561, $583 := $562, $584 := $563, $585 := $565, $586 := $566, $587 := $567, $588 := $568, $589 := $569, $590 := $570, $591 := $571, $592 := $572, $593 := $573, $594 := $574, $595 := $221", "INNER HASH JOIN EACH WITH ALL ON $564 = $220" ] }, { "kind": "JOIN", "substeps": [ "$560 := $555, $561 := $540, $562 := $541, $563 := $542, $564 := $543, $565 := $544, $566 := $545, $567 := $546, $568 := $547, $569 := $548, $570 := $549, $571 := $550, $572 := $552, $573 := $553, $574 := $554, $575 := $241", "INNER HASH JOIN EACH WITH ALL ON $551 = $240" ] }, { "kind": "JOIN", "substeps": [ "$540 := $535, $541 := $520, $542 := $521, $543 := $522, $544 := $524, $545 := $525, $546 := $526, $547 := $527, $548 := $528, $549 := $529, $550 := $530, $551 := $531, $552 := $532, $553 := $533, $554 := $534, $555 := $301", "INNER HASH JOIN EACH WITH ALL ON $523 = $300" ] }, { "kind": "JOIN", "substeps": [ "$520 := $500, $521 := $501, $522 := $502, $523 := $503, $524 := $504, $525 := $505, $526 := $506, $527 := $507, $528 := $508, $529 := $509, $530 := $510, $531 := $511, $532 := $513, $533 := $514, $534 := $515, $535 := $321", "INNER HASH JOIN EACH WITH ALL ON $512 = $320" ] }, { "kind": "JOIN", "substeps": [ "$500 := $340, $501 := $341, $502 := $343, $503 := $344, $504 := $345, $505 := $346, $506 := $347, $507 := $348, $508 := $349, $509 := $350, $510 := $351, $511 := $361, $512 := $362, $513 := $363, $514 := $364, $515 := $365", "INNER HASH JOIN EACH WITH ALL ON $342 = $360" ] }, { "kind": "WRITE", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "TO __stage2F_output", "BY HASH($870, $871, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $883, $884)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.00043904580711254205, "writeMsAvg": "7", "writeMsMax": "11", "writeRatioAvg": 0.0010244402165959315, "writeRatioMax": 0.0016098346260793209 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0013171374213376262, "computeRatioMax": 0.0013171374213376262, "endMs": "1665777930016", "id": "48", "inputStages": [ "45" ], "name": "S30: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777929967", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "FROM __stage2D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1300 := $1280, $1301 := $1281, $1302 := $1282, $1303 := $1283, $1304 := $1284, $1305 := $1285, $1306 := $1286, $1307 := $1287, $1308 := $1288, $1309 := $1289, $1310 := $1290, $1311 := $1291, $1312 := $1292, $1313 := $1293, $1314 := $1294", "$410 := SUM_OF_COUNTS($430)", "$411 := SUM($431)", "$412 := SUM($432)", "$413 := SUM($433)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "TO __stage30_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.0036587150592711838, "writeRatioMax": 0.0036587150592711838 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.0011707888189667788, "computeRatioMax": 0.002926972047416947, "endMs": "1665777930079", "id": "50", "inputStages": [ "48" ], "name": "S32: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "3353", "startMs": "1665777930030", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage30_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.00043904580711254205, "waitRatioMax": 0.0007317430118542368, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.002048880433191863, "writeRatioMax": 0.0026342748426752523 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.002048880433191863, "computeRatioMax": 0.002048880433191863, "endMs": "1665777930109", "id": "51", "inputStages": [ "47", "50" ], "name": "S33: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "19", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777930050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "FROM __stage32_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($1337, $1332)" ] }, { "kind": "JOIN", "substeps": [ "$1320 := $892, $1321 := $893, $1322 := $894, $1323 := $895, $1324 := $896, $1325 := $897, $1326 := $898, $1327 := $899, $1328 := $900, $1329 := $901, $1330 := $902, $1331 := $890, $1332 := $400, $1333 := $401, $1334 := $402, $1335 := $403", "INNER HASH JOIN EACH WITH ALL ON $891 = $1301, $892 = $1302, $893 = $1303" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $870, $891 := $871, $892 := $872, $893 := $873, $894 := $874, $895 := $875, $896 := $876, $897 := $877, $898 := $878, $899 := $879, $900 := $880, $901 := $881, $902 := $882, $903 := $883, $904 := $884", "$400 := SUM_OF_COUNTS($420)", "$401 := SUM($421)", "$402 := SUM($422)", "$403 := SUM($423)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "TO __stage33_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00043904580711254205, "waitRatioMax": 0.00043904580711254205, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0007317430118542368, "writeRatioMax": 0.0007317430118542368 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0010244402165959315, "computeRatioMax": 0.0010244402165959315, "endMs": "1665777930154", "id": "52", "inputStages": [ "51" ], "name": "S34: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777930117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "FROM __stage33_output" ] }, { "kind": "SORT", "substeps": [ "$1331 ASC, $1320 ASC, $1337 ASC, $1333 ASC, $1338 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1350, $1351, $1352, $1353, $1354, $1355, $1356, $1357, $1358, $1359, $1360, $1361, $1362, $1363, $1364, $1365", "TO __stage34_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002926972047416947, "waitRatioMax": 0.0002926972047416947, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021952290355627103, "writeRatioMax": 0.0021952290355627103 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "income_band" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "9", "elapsedMs": "714", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "5500" }, { "activeUnits": "13", "completedUnits": "145", "elapsedMs": "1745", "estimatedRunnableUnits": "0", "pendingUnits": "13", "totalSlotMs": "16861" }, { "activeUnits": "12", "completedUnits": "246", "elapsedMs": "2362", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "25619" }, { "activeUnits": "12", "completedUnits": "250", "elapsedMs": "4527", "estimatedRunnableUnits": "6", "pendingUnits": "8", "totalSlotMs": "64225" }, { "activeUnits": "4", "completedUnits": "361", "elapsedMs": "6066", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "78690" } ], "totalBytesBilled": "422576128", "totalBytesProcessed": "421895625", "totalPartitionsProcessed": "0", "totalSlotMs": "78690", "transferredBytes": "0" }, "startTime": "1665777924179", "totalBytesProcessed": "421895625", "totalSlotMs": "78690" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbd6c137a_ed6d_431f_8317_2f14abb2c6e5" }, "priority": "INTERACTIVE", "query": "with cs_ui as\n (select cs_item_sk\n ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n from catalog_sales\n ,catalog_returns\n where cs_item_sk = cr_item_sk\n and cs_order_number = cr_order_number\n group by cs_item_sk\n having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n ,i_item_sk item_sk\n ,s_store_name store_name\n ,s_zip store_zip\n ,ad1.ca_street_number b_street_number\n ,ad1.ca_street_name b_street_name\n ,ad1.ca_city b_city\n ,ad1.ca_zip b_zip\n ,ad2.ca_street_number c_street_number\n ,ad2.ca_street_name c_street_name\n ,ad2.ca_city c_city\n ,ad2.ca_zip c_zip\n ,d1.d_year as syear\n ,d2.d_year as fsyear\n ,d3.d_year s2year\n ,count(*) cnt\n ,sum(ss_wholesale_cost) s1\n ,sum(ss_list_price) s2\n ,sum(ss_coupon_amt) s3\n FROM store_sales\n ,store_returns\n ,cs_ui\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,customer\n ,customer_demographics cd1\n ,customer_demographics cd2\n ,promotion\n ,household_demographics hd1\n ,household_demographics hd2\n ,customer_address ad1\n ,customer_address ad2\n ,income_band ib1\n ,income_band ib2\n ,item\n WHERE ss_store_sk = s_store_sk AND\n ss_sold_date_sk = d1.d_date_sk AND\n ss_customer_sk = c_customer_sk AND\n ss_cdemo_sk= cd1.cd_demo_sk AND\n ss_hdemo_sk = hd1.hd_demo_sk AND\n ss_addr_sk = ad1.ca_address_sk and\n ss_item_sk = i_item_sk and\n ss_item_sk = sr_item_sk and\n ss_ticket_number = sr_ticket_number and\n ss_item_sk = cs_ui.cs_item_sk and\n c_current_cdemo_sk = cd2.cd_demo_sk AND\n c_current_hdemo_sk = hd2.hd_demo_sk AND\n c_current_addr_sk = ad2.ca_address_sk and\n c_first_sales_date_sk = d2.d_date_sk and\n c_first_shipto_date_sk = d3.d_date_sk and\n ss_promo_sk = p_promo_sk and\n hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n cd1.cd_marital_status <> cd2.cd_marital_status and\n i_color in ('orange','lace','lawn','misty','blush','pink') and\n i_current_price between 48 and 48 + 10 and\n i_current_price between 48 + 1 and 48 + 15\ngroup by i_product_name\n ,i_item_sk\n ,s_store_name\n ,s_zip\n ,ad1.ca_street_number\n ,ad1.ca_street_name\n ,ad1.ca_city\n ,ad1.ca_zip\n ,ad2.ca_street_number\n ,ad2.ca_street_name\n ,ad2.ca_city\n ,ad2.ca_zip\n ,d1.d_year\n ,d2.d_year\n ,d3.d_year\n)\nselect cs1.product_name\n ,cs1.store_name\n ,cs1.store_zip\n ,cs1.b_street_number\n ,cs1.b_street_name\n ,cs1.b_city\n ,cs1.b_zip\n ,cs1.c_street_number\n ,cs1.c_street_name\n ,cs1.c_city\n ,cs1.c_zip\n ,cs1.syear\n ,cs1.cnt\n ,cs1.s1 as s11\n ,cs1.s2 as s21\n ,cs1.s3 as s31\n ,cs2.s1 as s12\n ,cs2.s2 as s22\n ,cs2.s3 as s32\n ,cs2.syear\n ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n cs1.syear = 1999 and\n cs2.syear = 1999 + 1 and\n cs2.cnt <= cs1.cnt and\n cs1.store_name = cs2.store_name and\n cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n ,cs1.store_name\n ,cs2.cnt\n ,cs1.s1\n ,cs2.s1;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "oFA2ASP3HAG0YYvPqe2QcA==", "id": "test-project-364309:europe-west1.query64_1665777931", "jobReference": { "jobId": "query64_1665777931", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query64_1665777931?location=europe-west1", "statistics": { "creationTime": "1665777932472", "endTime": "1665777939652", "finalExecutionDurationMs": "6761", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "421895625", "performanceInsights": { "avgPreviousExecutionMs": "6306" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "308", "computeMsMax": "308", "computeRatioAvg": 0.04163287374966207, "computeRatioMax": 0.04163287374966207, "endMs": "1665777933008", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.0021627466882941336, "readRatioMax": 0.0021627466882941336, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "297", "startMs": "1665777932792", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290:cr_item_sk, $291:cr_order_number, $292:cr_refunded_cash, $293:cr_reversed_charge, $294:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0017572316842389836, "writeRatioMax": 0.0017572316842389836 }, { "completedParallelInputs": "1", "computeMsAvg": "213", "computeMsMax": "213", "computeRatioAvg": 0.02879156528791565, "computeRatioMax": 0.02879156528791565, "endMs": "1665777933010", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0017572316842389836, "readRatioMax": 0.0017572316842389836, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665777932825", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260:cr_item_sk, $261:cr_order_number, $262:cr_refunded_cash, $263:cr_reversed_charge, $264:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.00013517166801838335, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0022979183563125167, "writeRatioMax": 0.0022979183563125167 }, { "completedParallelInputs": "5", "computeMsAvg": "395", "computeMsMax": "547", "computeRatioAvg": 0.05339280886726142, "computeRatioMax": 0.07393890240605569, "endMs": "1665777933396", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "15", "readRatioAvg": 0.0017572316842389836, "readRatioMax": 0.00202757502027575, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "1705", "startMs": "1665777933049", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280:cs_item_sk, $281:cs_order_number, $282:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $1070", "$470 := SUM($1071)", "$471 := SUM($490)" ] }, { "kind": "COMPUTE", "substeps": [ "$490 := add(add($1072, $1073), $1074)" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $280, $1071 := $282, $1072 := $292, $1073 := $293, $1074 := $294", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291" ] }, { "kind": "WRITE", "substeps": [ "$1080, $470, $471", "TO __stage04_output", "BY HASH($1080)" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.0017572316842389836, "waitRatioMax": 0.0017572316842389836, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0006758583400919168, "writeRatioMax": 0.0006758583400919168 }, { "completedParallelInputs": "5", "computeMsAvg": "417", "computeMsMax": "500", "computeRatioAvg": 0.056366585563665854, "computeRatioMax": 0.06758583400919167, "endMs": "1665777933365", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.001892403352257367, "readRatioMax": 0.0024330900243309003, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "1760", "startMs": "1665777933049", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250:cs_item_sk, $251:cs_order_number, $252:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $660", "$460 := SUM($661)", "$461 := SUM($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := add(add($662, $663), $664)" ] }, { "kind": "JOIN", "substeps": [ "$660 := $250, $661 := $252, $662 := $262, $663 := $263, $664 := $264", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261" ] }, { "kind": "WRITE", "substeps": [ "$670, $460, $461", "TO __stage05_output", "BY HASH($670)" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.0009462016761286835, "waitRatioMax": 0.0009462016761286835, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.0006758583400919168, "writeRatioMax": 0.0008110300081103001 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.0032441200324412004, "computeRatioMax": 0.0032441200324412004, "endMs": "1665777933444", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008110300081103001, "readRatioMax": 0.0008110300081103001, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777933399", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.00013517166801838335, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014868883482022169, "writeRatioMax": 0.0014868883482022169 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.0045958367126250335, "computeRatioMax": 0.0045958367126250335, "endMs": "1665777933464", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010813733441470668, "readRatioMax": 0.0010813733441470668, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777933419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.00202757502027575, "writeRatioMax": 0.00202757502027575 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0021627466882941336, "computeRatioMax": 0.0021627466882941336, "endMs": "1665777933498", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008110300081103001, "readRatioMax": 0.0008110300081103001, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777933437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_store_name, $42:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0021627466882941336, "writeRatioMax": 0.0021627466882941336 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0017572316842389836, "computeRatioMax": 0.0017572316842389836, "endMs": "1665777933527", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008110300081103001, "readRatioMax": 0.0008110300081103001, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665777933459", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "55", "writeMsMax": "55", "writeRatioAvg": 0.007434441741011084, "writeRatioMax": 0.007434441741011084 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.007839956745066235, "computeRatioMax": 0.007839956745066235, "endMs": "1665777933562", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0013517166801838335, "readRatioMax": 0.0013517166801838335, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "77", "startMs": "1665777933494", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_street_number, $82:ca_street_name, $83:ca_city, $84:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00040551500405515005, "waitRatioMax": 0.00040551500405515005, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014868883482022169, "writeRatioMax": 0.0014868883482022169 }, { "completedParallelInputs": "1", "computeMsAvg": "64", "computeMsMax": "64", "computeRatioAvg": 0.008650986753176534, "computeRatioMax": 0.008650986753176534, "endMs": "1665777933588", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008110300081103001, "readRatioMax": 0.0008110300081103001, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "93", "startMs": "1665777933513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_street_number, $102:ca_street_name, $103:ca_city, $104:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0012165450121654502, "writeRatioMax": 0.0012165450121654502 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0013517166801838335, "computeRatioMax": 0.0013517166801838335, "endMs": "1665777933592", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009462016761286835, "readRatioMax": 0.0009462016761286835, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777933538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.0032441200324412004, "writeRatioMax": 0.0032441200324412004 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0016220600162206002, "computeRatioMax": 0.0016220600162206002, "endMs": "1665777933602", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006758583400919168, "readRatioMax": 0.0006758583400919168, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777933557", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0024330900243309003, "writeRatioMax": 0.0024330900243309003 }, { "completedParallelInputs": "1", "computeMsAvg": "50", "computeMsMax": "50", "computeRatioAvg": 0.006758583400919167, "computeRatioMax": 0.006758583400919167, "endMs": "1665777933618", "id": "14", "inputStages": [ "5" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777933576", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $460, $461", "FROM __stage05_output" ] }, { "kind": "FILTER", "substeps": [ "greater($440, multiply(NUMERIC<...>, $441))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670", "$440 := SUM($460)", "$441 := SUM($461)" ] }, { "kind": "WRITE", "substeps": [ "$680", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0009462016761286835, "writeRatioMax": 0.0009462016761286835 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.001892403352257367, "computeRatioMax": 0.001892403352257367, "endMs": "1665777933641", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009462016761286835, "readRatioMax": 0.0009462016761286835, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777933596", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year", "FROM date_dim", "WHERE equal($161, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001892403352257367, "writeRatioMax": 0.001892403352257367 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.002703433360367667, "computeRatioMax": 0.002703433360367667, "endMs": "1665777933661", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0013517166801838335, "readRatioMax": 0.0013517166801838335, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777933615", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $193:i_product_name, $191:i_current_price, $192:i_color", "FROM item", "WHERE and(in($192, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($191, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$190, $193", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.00013517166801838335, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0013517166801838335, "writeRatioMax": 0.0013517166801838335 }, { "completedParallelInputs": "1", "computeMsAvg": "156", "computeMsMax": "156", "computeRatioAvg": 0.021086780210867802, "computeRatioMax": 0.021086780210867802, "endMs": "1665777933753", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010813733441470668, "readRatioMax": 0.0010813733441470668, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "151", "startMs": "1665777933634", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:sr_item_sk, $181:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$180, $181", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001892403352257367, "writeRatioMax": 0.001892403352257367 }, { "completedParallelInputs": "1", "computeMsAvg": "1196", "computeMsMax": "1196", "computeRatioAvg": 0.16166531494998648, "computeRatioMax": 0.16166531494998648, "endMs": "1665777934654", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.0022979183563125167, "readRatioMax": 0.0022979183563125167, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "1425", "startMs": "1665777933657", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:cd_demo_sk, $221:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$220, $221", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "186", "writeMsMax": "186", "writeRatioAvg": 0.025141930251419302, "writeRatioMax": 0.025141930251419302 }, { "completedParallelInputs": "1", "computeMsAvg": "503", "computeMsMax": "503", "computeRatioAvg": 0.06799134901324683, "computeRatioMax": 0.06799134901324683, "endMs": "1665777934050", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010813733441470668, "readRatioMax": 0.0010813733441470668, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "447", "startMs": "1665777933694", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240:cd_demo_sk, $241:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.0072992700729927005, "writeRatioMax": 0.0072992700729927005 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.001892403352257367, "computeRatioMax": 0.001892403352257367, "endMs": "1665777933759", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006758583400919168, "readRatioMax": 0.0006758583400919168, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777933713", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300:hd_demo_sk, $301:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0022979183563125167, "writeRatioMax": 0.0022979183563125167 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.001892403352257367, "computeRatioMax": 0.001892403352257367, "endMs": "1665777933775", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005406866720735334, "readRatioMax": 0.0005406866720735334, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777933732", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320:hd_demo_sk, $321:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.00013517166801838335, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.003919978372533117, "writeRatioMax": 0.003919978372533117 }, { "completedParallelInputs": "1", "computeMsAvg": "71", "computeMsMax": "71", "computeRatioAvg": 0.009597188429305218, "computeRatioMax": 0.009597188429305218, "endMs": "1665777933837", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009462016761286835, "readRatioMax": 0.0009462016761286835, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665777933752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360:c_customer_sk, $361:c_current_cdemo_sk, $362:c_current_hdemo_sk, $363:c_current_addr_sk, $364:c_first_shipto_date_sk, $365:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $364, $365", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0013517166801838335, "writeRatioMax": 0.0013517166801838335 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.004325493376588267, "computeRatioMax": 0.004325493376588267, "endMs": "1665777933844", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006758583400919168, "readRatioMax": 0.0006758583400919168, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777933799", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0013517166801838335, "writeRatioMax": 0.0013517166801838335 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.004460665044606651, "computeRatioMax": 0.004460665044606651, "endMs": "1665777933864", "id": "25", "name": "S19: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008110300081103001, "readRatioMax": 0.0008110300081103001, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777933820", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0010813733441470668, "writeRatioMax": 0.0010813733441470668 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0012165450121654502, "computeRatioMax": 0.0012165450121654502, "endMs": "1665777933902", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00040551500405515005, "readRatioMax": 0.00040551500405515005, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777933839", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_store_name, $52:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.00013517166801838335, "writeMsAvg": "40", "writeMsMax": "40", "writeRatioAvg": 0.005406866720735334, "writeRatioMax": 0.005406866720735334 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0013517166801838335, "computeRatioMax": 0.0013517166801838335, "endMs": "1665777933902", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006758583400919168, "readRatioMax": 0.0006758583400919168, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777933858", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0024330900243309003, "writeRatioMax": 0.0024330900243309003 }, { "completedParallelInputs": "1", "computeMsAvg": "65", "computeMsMax": "65", "computeRatioAvg": 0.008786158421194918, "computeRatioMax": 0.008786158421194918, "endMs": "1665777933955", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0013517166801838335, "readRatioMax": 0.0013517166801838335, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665777933876", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_street_number, $92:ca_street_name, $93:ca_city, $94:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.00013517166801838335, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0022979183563125167, "writeRatioMax": 0.0022979183563125167 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.00851581508515815, "computeRatioMax": 0.00851581508515815, "endMs": "1665777933956", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006758583400919168, "readRatioMax": 0.0006758583400919168, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "76", "startMs": "1665777933896", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ca_address_sk, $111:ca_street_number, $112:ca_street_name, $113:ca_city, $114:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114", "TO __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0013517166801838335, "writeRatioMax": 0.0013517166801838335 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0009462016761286835, "computeRatioMax": 0.0009462016761286835, "endMs": "1665777933956", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0006758583400919168, "readRatioMax": 0.0006758583400919168, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777933915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage1E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0022979183563125167, "writeRatioMax": 0.0022979183563125167 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0012165450121654502, "computeRatioMax": 0.0012165450121654502, "endMs": "1665777933986", "id": "31", "name": "S1F: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00040551500405515005, "readRatioMax": 0.00040551500405515005, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777933934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.00013517166801838335, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.003919978372533117, "writeRatioMax": 0.003919978372533117 }, { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.007569613409029468, "computeRatioMax": 0.007569613409029468, "endMs": "1665777934010", "id": "32", "inputStages": [ "4" ], "name": "S20: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665777933962", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1080, $470, $471", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "greater($450, multiply(NUMERIC<...>, $451))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080", "$450 := SUM($470)", "$451 := SUM($471)" ] }, { "kind": "WRITE", "substeps": [ "$1090", "TO __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0009462016761286835, "writeRatioMax": 0.0009462016761286835 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0016220600162206002, "computeRatioMax": 0.0016220600162206002, "endMs": "1665777934029", "id": "33", "name": "S21: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008110300081103001, "readRatioMax": 0.0008110300081103001, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777933987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.001892403352257367, "writeRatioMax": 0.001892403352257367 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.0029737766964044337, "computeRatioMax": 0.0029737766964044337, "endMs": "1665777934046", "id": "34", "name": "S22: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0009462016761286835, "readRatioMax": 0.0009462016761286835, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777934003", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $213:i_product_name, $211:i_current_price, $212:i_color", "FROM item", "WHERE and(in($212, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($211, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$210, $213", "TO __stage22_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0010813733441470668, "writeRatioMax": 0.0010813733441470668 }, { "completedParallelInputs": "1", "computeMsAvg": "104", "computeMsMax": "104", "computeRatioAvg": 0.014057853473911868, "computeRatioMax": 0.014057853473911868, "endMs": "1665777934149", "id": "35", "name": "S23: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0016220600162206002, "readRatioMax": 0.0016220600162206002, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665777934019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:sr_item_sk, $201:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$200, $201", "TO __stage23_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.00013517166801838335, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0016220600162206002, "writeRatioMax": 0.0016220600162206002 }, { "completedParallelInputs": "1", "computeMsAvg": "498", "computeMsMax": "498", "computeRatioAvg": 0.06731549067315491, "computeRatioMax": 0.06731549067315491, "endMs": "1665777934475", "id": "36", "name": "S24: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0013517166801838335, "readRatioMax": 0.0013517166801838335, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "581", "startMs": "1665777934036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:cd_demo_sk, $231:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "61", "writeMsMax": "61", "writeRatioAvg": 0.008245471749121384, "writeRatioMax": 0.008245471749121384 }, { "completedParallelInputs": "1", "computeMsAvg": "848", "computeMsMax": "848", "computeRatioAvg": 0.11462557447958908, "computeRatioMax": 0.11462557447958908, "endMs": "1665777934692", "id": "37", "name": "S25: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.00283860502838605, "readRatioMax": 0.00283860502838605, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "1035", "startMs": "1665777934057", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270:cd_demo_sk, $271:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage25_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00040551500405515005, "waitRatioMax": 0.00040551500405515005, "writeMsAvg": "97", "writeMsMax": "97", "writeRatioAvg": 0.013111651797783185, "writeRatioMax": 0.013111651797783185 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0021627466882941336, "computeRatioMax": 0.0021627466882941336, "endMs": "1665777934120", "id": "38", "name": "S26: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010813733441470668, "readRatioMax": 0.0010813733441470668, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777934076", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310:hd_demo_sk, $311:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$310, $311", "TO __stage26_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.00202757502027575, "writeRatioMax": 0.00202757502027575 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0012165450121654502, "computeRatioMax": 0.0012165450121654502, "endMs": "1665777934142", "id": "39", "name": "S27: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005406866720735334, "readRatioMax": 0.0005406866720735334, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777934103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330:hd_demo_sk, $331:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$330, $331", "TO __stage27_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.00202757502027575, "writeRatioMax": 0.00202757502027575 }, { "completedParallelInputs": "1", "computeMsAvg": "90", "computeMsMax": "90", "computeRatioAvg": 0.012165450121654502, "computeRatioMax": 0.012165450121654502, "endMs": "1665777934220", "id": "40", "name": "S28: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0010813733441470668, "readRatioMax": 0.0010813733441470668, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "104", "startMs": "1665777934127", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390:c_customer_sk, $391:c_current_cdemo_sk, $392:c_current_hdemo_sk, $393:c_current_addr_sk, $394:c_first_shipto_date_sk, $395:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392, $393, $394, $395", "TO __stage28_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0014868883482022169, "writeRatioMax": 0.0014868883482022169 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.0012165450121654502, "computeRatioMax": 0.00283860502838605, "endMs": "1665777934849", "id": "45", "inputStages": [ "14" ], "name": "S2D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3327", "startMs": "1665777934796", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0005406866720735334, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.00202757502027575, "writeRatioMax": 0.003784806704514734 }, { "completedParallelInputs": "6", "computeMsAvg": "5410", "computeMsMax": "7398", "computeRatioAvg": 0.7312787239794539, "computeRatioMax": 1, "endMs": "1665777939064", "id": "46", "inputStages": [ "6", "16", "13", "22", "17", "15", "8", "11", "9", "7", "45", "12", "18", "20", "21", "19", "10" ], "name": "S2E: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "47", "readRatioAvg": 0.003919978372533117, "readRatioMax": 0.006353068396864017, "recordsRead": "29398184", "recordsWritten": "8", "shuffleOutputBytes": "1830", "shuffleOutputBytesSpilled": "0", "slotMs": "29627", "startMs": "1665777934815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340:ss_sold_date_sk, $341:ss_item_sk, $342:ss_customer_sk, $343:ss_cdemo_sk, $344:ss_hdemo_sk, $345:ss_addr_sk, $346:ss_store_sk, $347:ss_promo_sk, $348:ss_ticket_number, $349:ss_wholesale_cost, $350:ss_list_price, $351:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $364, $365", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$240, $241", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$220, $221", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$180, $181", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$190, $193", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$680", "FROM __stage2D_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $870 := $863, $871 := $862, $872 := $851, $873 := $852, $874 := $853, $875 := $854, $876 := $855, $877 := $856, $878 := $857, $879 := $858, $880 := $859, $881 := $860, $882 := $861, $883 := $867, $884 := $850", "$420 := COUNT_STAR()", "$421 := SUM($864)", "$422 := SUM($865)", "$423 := SUM($866)" ] }, { "kind": "JOIN", "substeps": [ "$850 := $847, $851 := $830, $852 := $831, $853 := $832, $854 := $833, $855 := $834, $856 := $835, $857 := $836, $858 := $837, $859 := $838, $860 := $839, $861 := $840, $862 := $841, $863 := $842, $864 := $843, $865 := $844", "INNER HASH JOIN EACH WITH ALL ON $846 = $1" ] }, { "kind": "JOIN", "substeps": [ "$830 := $826, $831 := $827, $832 := $810, $833 := $811, $834 := $812, $835 := $813, $836 := $814, $837 := $815, $838 := $816, $839 := $817, $840 := $818, $841 := $819, $842 := $820, $843 := $821, $844 := $822, $845 := $823", "INNER HASH JOIN EACH WITH ALL ON $824 = $20" ] }, { "kind": "JOIN", "substeps": [ "$810 := $790, $811 := $791, $812 := $792, $813 := $793, $814 := $794, $815 := $795, $816 := $796, $817 := $797, $818 := $798, $819 := $799, $820 := $800, $821 := $802, $822 := $803, $823 := $804, $824 := $805, $825 := $806", "INNER HASH JOIN EACH WITH ALL ON $801 = $40" ] }, { "kind": "JOIN", "substeps": [ "$790 := $784, $791 := $785, $792 := $786, $793 := $787, $794 := $770, $795 := $771, $796 := $772, $797 := $773, $798 := $774, $799 := $775, $800 := $776, $801 := $777, $802 := $779, $803 := $780, $804 := $781, $805 := $782", "INNER HASH JOIN EACH WITH ALL ON $778 = $60" ] }, { "kind": "JOIN", "substeps": [ "$770 := $761, $771 := $762, $772 := $763, $773 := $764, $774 := $750, $775 := $751, $776 := $752, $777 := $754, $778 := $755, $779 := $756, $780 := $757, $781 := $758, $782 := $759, $783 := $760, $784 := $81, $785 := $82", "INNER HASH JOIN EACH WITH ALL ON $753 = $80" ] }, { "kind": "JOIN", "substeps": [ "$750 := $730, $751 := $731, $752 := $732, $753 := $733, $754 := $734, $755 := $735, $756 := $736, $757 := $737, $758 := $738, $759 := $740, $760 := $741, $761 := $101, $762 := $102, $763 := $103, $764 := $104", "INNER HASH JOIN EACH WITH ALL ON $739 = $100" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $712, $733 := $714, $734 := $715, $735 := $716, $736 := $717, $737 := $718, $738 := $719, $739 := $720, $740 := $721, $741 := $722", "INNER HASH JOIN EACH WITH ALL ON $713 = $120" ] }, { "kind": "JOIN", "substeps": [ "$710 := $690, $711 := $691, $712 := $692, $713 := $693, $714 := $695, $715 := $696, $716 := $697, $717 := $698, $718 := $699, $719 := $700, $720 := $701, $721 := $702, $722 := $703", "INNER HASH JOIN EACH WITH ALL ON $694 = $140" ] }, { "kind": "JOIN", "substeps": [ "$690 := $654, $691 := $640, $692 := $641, $693 := $642, $694 := $643, $695 := $645, $696 := $646, $697 := $647, $698 := $648, $699 := $649, $700 := $650, $701 := $651, $702 := $652, $703 := $653", "INNER HASH JOIN EACH WITH ALL ON $644 = $680" ] }, { "kind": "JOIN", "substeps": [ "$640 := $633, $641 := $634, $642 := $620, $643 := $621, $644 := $623, $645 := $624, $646 := $625, $647 := $626, $648 := $627, $649 := $628, $650 := $629, $651 := $630, $652 := $631, $653 := $632, $654 := $161", "INNER HASH JOIN EACH WITH ALL ON $622 = $160" ] }, { "kind": "JOIN", "substeps": [ "$620 := $600, $621 := $601, $622 := $602, $623 := $603, $624 := $604, $625 := $605, $626 := $606, $627 := $607, $628 := $608, $629 := $609, $630 := $610, $631 := $611, $632 := $612, $633 := $190, $634 := $193", "INNER HASH JOIN EACH WITH ALL ON $603 = $190" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $589, $608 := $590, $609 := $591, $610 := $592, $611 := $593, $612 := $594", "INNER HASH JOIN EACH WITH ALL ON $584 = $180, $588 = $181" ] }, { "kind": "FILTER", "substeps": [ "not_equal($595, $580)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $575, $581 := $560, $582 := $561, $583 := $562, $584 := $563, $585 := $565, $586 := $566, $587 := $567, $588 := $568, $589 := $569, $590 := $570, $591 := $571, $592 := $572, $593 := $573, $594 := $574, $595 := $221", "INNER HASH JOIN EACH WITH ALL ON $564 = $220" ] }, { "kind": "JOIN", "substeps": [ "$560 := $555, $561 := $540, $562 := $541, $563 := $542, $564 := $543, $565 := $544, $566 := $545, $567 := $546, $568 := $547, $569 := $548, $570 := $549, $571 := $550, $572 := $552, $573 := $553, $574 := $554, $575 := $241", "INNER HASH JOIN EACH WITH ALL ON $551 = $240" ] }, { "kind": "JOIN", "substeps": [ "$540 := $535, $541 := $520, $542 := $521, $543 := $522, $544 := $524, $545 := $525, $546 := $526, $547 := $527, $548 := $528, $549 := $529, $550 := $530, $551 := $531, $552 := $532, $553 := $533, $554 := $534, $555 := $301", "INNER HASH JOIN EACH WITH ALL ON $523 = $300" ] }, { "kind": "JOIN", "substeps": [ "$520 := $500, $521 := $501, $522 := $502, $523 := $503, $524 := $504, $525 := $505, $526 := $506, $527 := $507, $528 := $508, $529 := $509, $530 := $510, $531 := $511, $532 := $513, $533 := $514, $534 := $515, $535 := $321", "INNER HASH JOIN EACH WITH ALL ON $512 = $320" ] }, { "kind": "JOIN", "substeps": [ "$500 := $340, $501 := $341, $502 := $343, $503 := $344, $504 := $345, $505 := $346, $506 := $347, $507 := $348, $508 := $349, $509 := $350, $510 := $351, $511 := $361, $512 := $362, $513 := $363, $514 := $364, $515 := $365", "INNER HASH JOIN EACH WITH ALL ON $342 = $360" ] }, { "kind": "WRITE", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "TO __stage2E_output", "BY HASH($870, $871, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $883, $884)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.0008110300081103001, "writeRatioMax": 0.0009462016761286835 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.0012165450121654502, "computeRatioMax": 0.0021627466882941336, "endMs": "1665777934887", "id": "47", "inputStages": [ "32" ], "name": "S2F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3613", "startMs": "1665777934819", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0005406866720735334, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.00202757502027575, "writeRatioMax": 0.0025682616923492834 }, { "completedParallelInputs": "6", "computeMsAvg": "5859", "computeMsMax": "6843", "computeRatioAvg": 0.791970802919708, "computeRatioMax": 0.9249797242497972, "endMs": "1665777938681", "id": "48", "inputStages": [ "31", "40", "36", "29", "28", "39", "27", "47", "37", "35", "26", "24", "33", "30", "38", "34", "25" ], "name": "S30: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "38", "readRatioAvg": 0.003919978372533117, "readRatioMax": 0.005136523384698567, "recordsRead": "29661809", "recordsWritten": "11", "shuffleOutputBytes": "2546", "shuffleOutputBytesSpilled": "0", "slotMs": "31809", "startMs": "1665777934841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370:ss_sold_date_sk, $371:ss_item_sk, $372:ss_customer_sk, $373:ss_cdemo_sk, $374:ss_hdemo_sk, $375:ss_addr_sk, $376:ss_store_sk, $377:ss_promo_sk, $378:ss_ticket_number, $379:ss_wholesale_cost, $380:ss_list_price, $381:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$390, $391, $392, $393, $394, $395", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$330, $331", "FROM __stage27_output" ] }, { "kind": "READ", "substeps": [ "$310, $311", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$270, $271", "FROM __stage25_output" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage24_output" ] }, { "kind": "READ", "substeps": [ "$200, $201", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$210, $213", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$1090", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1280 := $1273, $1281 := $1272, $1282 := $1261, $1283 := $1262, $1284 := $1263, $1285 := $1264, $1286 := $1265, $1287 := $1266, $1288 := $1267, $1289 := $1268, $1290 := $1269, $1291 := $1270, $1292 := $1271, $1293 := $1277, $1294 := $1260", "$430 := COUNT_STAR()", "$431 := SUM($1274)", "$432 := SUM($1275)", "$433 := SUM($1276)" ] }, { "kind": "JOIN", "substeps": [ "$1260 := $1257, $1261 := $1240, $1262 := $1241, $1263 := $1242, $1264 := $1243, $1265 := $1244, $1266 := $1245, $1267 := $1246, $1268 := $1247, $1269 := $1248, $1270 := $1249, $1271 := $1250, $1272 := $1251, $1273 := $1252, $1274 := $1253, $1275 := $1254", "INNER HASH JOIN EACH WITH ALL ON $1256 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $1236, $1241 := $1237, $1242 := $1220, $1243 := $1221, $1244 := $1222, $1245 := $1223, $1246 := $1224, $1247 := $1225, $1248 := $1226, $1249 := $1227, $1250 := $1228, $1251 := $1229, $1252 := $1230, $1253 := $1231, $1254 := $1232, $1255 := $1233", "INNER HASH JOIN EACH WITH ALL ON $1234 = $30" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $1200, $1221 := $1201, $1222 := $1202, $1223 := $1203, $1224 := $1204, $1225 := $1205, $1226 := $1206, $1227 := $1207, $1228 := $1208, $1229 := $1209, $1230 := $1210, $1231 := $1212, $1232 := $1213, $1233 := $1214, $1234 := $1215, $1235 := $1216", "INNER HASH JOIN EACH WITH ALL ON $1211 = $50" ] }, { "kind": "JOIN", "substeps": [ "$1200 := $1194, $1201 := $1195, $1202 := $1196, $1203 := $1197, $1204 := $1180, $1205 := $1181, $1206 := $1182, $1207 := $1183, $1208 := $1184, $1209 := $1185, $1210 := $1186, $1211 := $1187, $1212 := $1189, $1213 := $1190, $1214 := $1191, $1215 := $1192", "INNER HASH JOIN EACH WITH ALL ON $1188 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1171, $1181 := $1172, $1182 := $1173, $1183 := $1174, $1184 := $1160, $1185 := $1161, $1186 := $1162, $1187 := $1164, $1188 := $1165, $1189 := $1166, $1190 := $1167, $1191 := $1168, $1192 := $1169, $1193 := $1170, $1194 := $91, $1195 := $92", "INNER HASH JOIN EACH WITH ALL ON $1163 = $90" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $1140, $1161 := $1141, $1162 := $1142, $1163 := $1143, $1164 := $1144, $1165 := $1145, $1166 := $1146, $1167 := $1147, $1168 := $1148, $1169 := $1150, $1170 := $1151, $1171 := $111, $1172 := $112, $1173 := $113, $1174 := $114", "INNER HASH JOIN EACH WITH ALL ON $1149 = $110" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $1120, $1141 := $1121, $1142 := $1122, $1143 := $1124, $1144 := $1125, $1145 := $1126, $1146 := $1127, $1147 := $1128, $1148 := $1129, $1149 := $1130, $1150 := $1131, $1151 := $1132", "INNER HASH JOIN EACH WITH ALL ON $1123 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1100, $1121 := $1101, $1122 := $1102, $1123 := $1103, $1124 := $1105, $1125 := $1106, $1126 := $1107, $1127 := $1108, $1128 := $1109, $1129 := $1110, $1130 := $1111, $1131 := $1112, $1132 := $1113", "INNER HASH JOIN EACH WITH ALL ON $1104 = $150" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1064, $1101 := $1050, $1102 := $1051, $1103 := $1052, $1104 := $1053, $1105 := $1055, $1106 := $1056, $1107 := $1057, $1108 := $1058, $1109 := $1059, $1110 := $1060, $1111 := $1061, $1112 := $1062, $1113 := $1063", "INNER HASH JOIN EACH WITH ALL ON $1054 = $1090" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $1043, $1051 := $1044, $1052 := $1030, $1053 := $1031, $1054 := $1033, $1055 := $1034, $1056 := $1035, $1057 := $1036, $1058 := $1037, $1059 := $1038, $1060 := $1039, $1061 := $1040, $1062 := $1041, $1063 := $1042, $1064 := $171", "INNER HASH JOIN EACH WITH ALL ON $1032 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1010, $1031 := $1011, $1032 := $1012, $1033 := $1013, $1034 := $1014, $1035 := $1015, $1036 := $1016, $1037 := $1017, $1038 := $1018, $1039 := $1019, $1040 := $1020, $1041 := $1021, $1042 := $1022, $1043 := $210, $1044 := $213", "INNER HASH JOIN EACH WITH ALL ON $1013 = $210" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $991, $1011 := $992, $1012 := $993, $1013 := $994, $1014 := $995, $1015 := $996, $1016 := $997, $1017 := $999, $1018 := $1000, $1019 := $1001, $1020 := $1002, $1021 := $1003, $1022 := $1004", "INNER HASH JOIN EACH WITH ALL ON $994 = $200, $998 = $201" ] }, { "kind": "FILTER", "substeps": [ "not_equal($1005, $990)" ] }, { "kind": "JOIN", "substeps": [ "$990 := $985, $991 := $970, $992 := $971, $993 := $972, $994 := $973, $995 := $975, $996 := $976, $997 := $977, $998 := $978, $999 := $979, $1000 := $980, $1001 := $981, $1002 := $982, $1003 := $983, $1004 := $984, $1005 := $231", "INNER HASH JOIN EACH WITH ALL ON $974 = $230" ] }, { "kind": "JOIN", "substeps": [ "$970 := $965, $971 := $950, $972 := $951, $973 := $952, $974 := $953, $975 := $954, $976 := $955, $977 := $956, $978 := $957, $979 := $958, $980 := $959, $981 := $960, $982 := $962, $983 := $963, $984 := $964, $985 := $271", "INNER HASH JOIN EACH WITH ALL ON $961 = $270" ] }, { "kind": "JOIN", "substeps": [ "$950 := $945, $951 := $930, $952 := $931, $953 := $932, $954 := $934, $955 := $935, $956 := $936, $957 := $937, $958 := $938, $959 := $939, $960 := $940, $961 := $941, $962 := $942, $963 := $943, $964 := $944, $965 := $311", "INNER HASH JOIN EACH WITH ALL ON $933 = $310" ] }, { "kind": "JOIN", "substeps": [ "$930 := $910, $931 := $911, $932 := $912, $933 := $913, $934 := $914, $935 := $915, $936 := $916, $937 := $917, $938 := $918, $939 := $919, $940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $925, $945 := $331", "INNER HASH JOIN EACH WITH ALL ON $922 = $330" ] }, { "kind": "JOIN", "substeps": [ "$910 := $370, $911 := $371, $912 := $373, $913 := $374, $914 := $375, $915 := $376, $916 := $377, $917 := $378, $918 := $379, $919 := $380, $920 := $381, $921 := $391, $922 := $392, $923 := $393, $924 := $394, $925 := $395", "INNER HASH JOIN EACH WITH ALL ON $372 = $390" ] }, { "kind": "WRITE", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "TO __stage30_output", "BY HASH($1280, $1281, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1293, $1294)" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.00013517166801838335, "waitRatioMax": 0.0005406866720735334, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.0008110300081103001, "writeRatioMax": 0.0009462016761286835 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0010813733441470668, "computeRatioMax": 0.0010813733441470668, "endMs": "1665777939331", "id": "49", "inputStages": [ "48" ], "name": "S31: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777939284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "FROM __stage30_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1300 := $1280, $1301 := $1281, $1302 := $1282, $1303 := $1283, $1304 := $1284, $1305 := $1285, $1306 := $1286, $1307 := $1287, $1308 := $1288, $1309 := $1289, $1310 := $1290, $1311 := $1291, $1312 := $1292, $1313 := $1293, $1314 := $1294", "$410 := SUM_OF_COUNTS($430)", "$411 := SUM($431)", "$412 := SUM($432)", "$413 := SUM($433)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "TO __stage31_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "37", "writeMsMax": "37", "writeRatioAvg": 0.005001351716680184, "writeRatioMax": 0.005001351716680184 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.0012165450121654502, "computeRatioMax": 0.0024330900243309003, "endMs": "1665777939420", "id": "51", "inputStages": [ "49" ], "name": "S33: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "4957", "startMs": "1665777939340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage31_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.00040551500405515005, "waitRatioMax": 0.0005406866720735334, "writeMsAvg": "25", "writeMsMax": "33", "writeRatioAvg": 0.0033792917004595835, "writeRatioMax": 0.004460665044606651 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0010813733441470668, "computeRatioMax": 0.0010813733441470668, "endMs": "1665777939457", "id": "52", "inputStages": [ "51", "46" ], "name": "S34: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "19", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777939364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "FROM __stage2E_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "FROM __stage33_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($1337, $1332)" ] }, { "kind": "JOIN", "substeps": [ "$1320 := $892, $1321 := $893, $1322 := $894, $1323 := $895, $1324 := $896, $1325 := $897, $1326 := $898, $1327 := $899, $1328 := $900, $1329 := $901, $1330 := $902, $1331 := $890, $1332 := $400, $1333 := $401, $1334 := $402, $1335 := $403", "INNER HASH JOIN EACH WITH ALL ON $891 = $1301, $892 = $1302, $893 = $1303" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $870, $891 := $871, $892 := $872, $893 := $873, $894 := $874, $895 := $875, $896 := $876, $897 := $877, $898 := $878, $899 := $879, $900 := $880, $901 := $881, $902 := $882, $903 := $883, $904 := $884", "$400 := SUM_OF_COUNTS($420)", "$401 := SUM($421)", "$402 := SUM($422)", "$403 := SUM($423)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "TO __stage34_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00040551500405515005, "waitRatioMax": 0.00040551500405515005, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.00040551500405515005, "writeRatioMax": 0.00040551500405515005 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0010813733441470668, "computeRatioMax": 0.0010813733441470668, "endMs": "1665777939502", "id": "53", "inputStages": [ "52" ], "name": "S35: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777939465", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "FROM __stage34_output" ] }, { "kind": "SORT", "substeps": [ "$1331 ASC, $1320 ASC, $1337 ASC, $1333 ASC, $1338 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1350, $1351, $1352, $1353, $1354, $1355, $1356, $1357, $1358, $1359, $1360, $1361, $1362, $1363, $1364, $1365", "TO __stage35_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002703433360367667, "waitRatioMax": 0.0002703433360367667, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0022979183563125167, "writeRatioMax": 0.0022979183563125167 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "income_band" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "10", "completedUnits": "7", "elapsedMs": "736", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "2976" }, { "activeUnits": "15", "completedUnits": "43", "elapsedMs": "1766", "estimatedRunnableUnits": "0", "pendingUnits": "15", "totalSlotMs": "8336" }, { "activeUnits": "12", "completedUnits": "246", "elapsedMs": "2423", "estimatedRunnableUnits": "1", "pendingUnits": "12", "totalSlotMs": "24996" }, { "activeUnits": "12", "completedUnits": "246", "elapsedMs": "4715", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "65319" }, { "activeUnits": "7", "completedUnits": "256", "elapsedMs": "5986", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "83634" }, { "activeUnits": "0", "completedUnits": "361", "elapsedMs": "7034", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "91222" } ], "totalBytesBilled": "422576128", "totalBytesProcessed": "421895625", "totalPartitionsProcessed": "0", "totalSlotMs": "91222", "transferredBytes": "0" }, "startTime": "1665777932557", "totalBytesProcessed": "421895625", "totalSlotMs": "91222" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone51756f1_5957_46fe_b456_afc1d8247cd9" }, "priority": "INTERACTIVE", "query": "with cs_ui as\n (select cs_item_sk\n ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n from catalog_sales\n ,catalog_returns\n where cs_item_sk = cr_item_sk\n and cs_order_number = cr_order_number\n group by cs_item_sk\n having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n ,i_item_sk item_sk\n ,s_store_name store_name\n ,s_zip store_zip\n ,ad1.ca_street_number b_street_number\n ,ad1.ca_street_name b_street_name\n ,ad1.ca_city b_city\n ,ad1.ca_zip b_zip\n ,ad2.ca_street_number c_street_number\n ,ad2.ca_street_name c_street_name\n ,ad2.ca_city c_city\n ,ad2.ca_zip c_zip\n ,d1.d_year as syear\n ,d2.d_year as fsyear\n ,d3.d_year s2year\n ,count(*) cnt\n ,sum(ss_wholesale_cost) s1\n ,sum(ss_list_price) s2\n ,sum(ss_coupon_amt) s3\n FROM store_sales\n ,store_returns\n ,cs_ui\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,customer\n ,customer_demographics cd1\n ,customer_demographics cd2\n ,promotion\n ,household_demographics hd1\n ,household_demographics hd2\n ,customer_address ad1\n ,customer_address ad2\n ,income_band ib1\n ,income_band ib2\n ,item\n WHERE ss_store_sk = s_store_sk AND\n ss_sold_date_sk = d1.d_date_sk AND\n ss_customer_sk = c_customer_sk AND\n ss_cdemo_sk= cd1.cd_demo_sk AND\n ss_hdemo_sk = hd1.hd_demo_sk AND\n ss_addr_sk = ad1.ca_address_sk and\n ss_item_sk = i_item_sk and\n ss_item_sk = sr_item_sk and\n ss_ticket_number = sr_ticket_number and\n ss_item_sk = cs_ui.cs_item_sk and\n c_current_cdemo_sk = cd2.cd_demo_sk AND\n c_current_hdemo_sk = hd2.hd_demo_sk AND\n c_current_addr_sk = ad2.ca_address_sk and\n c_first_sales_date_sk = d2.d_date_sk and\n c_first_shipto_date_sk = d3.d_date_sk and\n ss_promo_sk = p_promo_sk and\n hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n cd1.cd_marital_status <> cd2.cd_marital_status and\n i_color in ('orange','lace','lawn','misty','blush','pink') and\n i_current_price between 48 and 48 + 10 and\n i_current_price between 48 + 1 and 48 + 15\ngroup by i_product_name\n ,i_item_sk\n ,s_store_name\n ,s_zip\n ,ad1.ca_street_number\n ,ad1.ca_street_name\n ,ad1.ca_city\n ,ad1.ca_zip\n ,ad2.ca_street_number\n ,ad2.ca_street_name\n ,ad2.ca_city\n ,ad2.ca_zip\n ,d1.d_year\n ,d2.d_year\n ,d3.d_year\n)\nselect cs1.product_name\n ,cs1.store_name\n ,cs1.store_zip\n ,cs1.b_street_number\n ,cs1.b_street_name\n ,cs1.b_city\n ,cs1.b_zip\n ,cs1.c_street_number\n ,cs1.c_street_name\n ,cs1.c_city\n ,cs1.c_zip\n ,cs1.syear\n ,cs1.cnt\n ,cs1.s1 as s11\n ,cs1.s2 as s21\n ,cs1.s3 as s31\n ,cs2.s1 as s12\n ,cs2.s2 as s22\n ,cs2.s3 as s32\n ,cs2.syear\n ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n cs1.syear = 1999 and\n cs2.syear = 1999 + 1 and\n cs2.cnt <= cs1.cnt and\n cs1.store_name = cs2.store_name and\n cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n ,cs1.store_name\n ,cs2.cnt\n ,cs1.s1\n ,cs2.s1;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "VLhqt1H6F7NUjeAz/QC/Bw==", "id": "test-project-364309:europe-west1.query64_1665778320", "jobReference": { "jobId": "query64_1665778320", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query64_1665778320?location=europe-west1", "statistics": { "creationTime": "1665778320959", "endTime": "1665778327238", "finalExecutionDurationMs": "5782", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "421895625", "performanceInsights": { "avgPreviousExecutionMs": "6357" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "278", "computeMsMax": "278", "computeRatioAvg": 0.040518874799591896, "computeRatioMax": 0.040518874799591896, "endMs": "1665778321576", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.0023320215711995335, "readRatioMax": 0.0023320215711995335, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "339", "startMs": "1665778321364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290:cr_item_sk, $291:cr_order_number, $292:cr_refunded_cash, $293:cr_reversed_charge, $294:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021862702229995625, "writeRatioMax": 0.0021862702229995625 }, { "completedParallelInputs": "1", "computeMsAvg": "203", "computeMsMax": "203", "computeRatioAvg": 0.029587523684594084, "computeRatioMax": 0.029587523684594084, "endMs": "1665778321615", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.002040518874799592, "readRatioMax": 0.002040518874799592, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "266", "startMs": "1665778321398", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260:cr_item_sk, $261:cr_order_number, $262:cr_refunded_cash, $263:cr_reversed_charge, $264:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $263, $264", "TO __stage02_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00043725404459991256, "waitRatioMax": 0.00043725404459991256, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0023320215711995335, "writeRatioMax": 0.0023320215711995335 }, { "completedParallelInputs": "5", "computeMsAvg": "346", "computeMsMax": "471", "computeRatioAvg": 0.05042996647718991, "computeRatioMax": 0.06864888500218627, "endMs": "1665778321918", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "18", "readMsMax": "23", "readRatioAvg": 0.0026235242675994755, "readRatioMax": 0.0033522810085993295, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "2005", "startMs": "1665778321610", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280:cs_item_sk, $281:cs_order_number, $282:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $1070", "$470 := SUM($1071)", "$471 := SUM($490)" ] }, { "kind": "COMPUTE", "substeps": [ "$490 := add(add($1072, $1073), $1074)" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $280, $1071 := $282, $1072 := $292, $1073 := $293, $1074 := $294", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291" ] }, { "kind": "WRITE", "substeps": [ "$1080, $470, $471", "TO __stage04_output", "BY HASH($1080)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "7", "writeMsMax": "11", "writeRatioAvg": 0.001020259437399796, "writeRatioMax": 0.0016032648301996793 }, { "completedParallelInputs": "5", "computeMsAvg": "386", "computeMsMax": "495", "computeRatioAvg": 0.056260020405188745, "computeRatioMax": 0.07214691735898557, "endMs": "1665778321949", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.0023320215711995335, "readRatioMax": 0.002769275615799446, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "1950", "startMs": "1665778321630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250:cs_item_sk, $251:cs_order_number, $252:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $263, $264", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $660", "$460 := SUM($661)", "$461 := SUM($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := add(add($662, $663), $664)" ] }, { "kind": "JOIN", "substeps": [ "$660 := $250, $661 := $252, $662 := $262, $663 := $263, $664 := $264", "INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261" ] }, { "kind": "WRITE", "substeps": [ "$670, $460, $461", "TO __stage05_output", "BY HASH($670)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.0008745080891998251, "writeRatioMax": 0.001020259437399796 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.004226789097799155, "computeRatioMax": 0.004226789097799155, "endMs": "1665778321991", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011660107855997668, "readRatioMax": 0.0011660107855997668, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778321955", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014575134819997085, "writeRatioMax": 0.0014575134819997085 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.004226789097799155, "computeRatioMax": 0.004226789097799155, "endMs": "1665778322005", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011660107855997668, "readRatioMax": 0.0011660107855997668, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778321971", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014575134819997085, "writeRatioMax": 0.0014575134819997085 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0017490161783996502, "computeRatioMax": 0.0017490161783996502, "endMs": "1665778322026", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001020259437399796, "readRatioMax": 0.001020259437399796, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778321985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_store_name, $52:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021862702229995625, "writeRatioMax": 0.0021862702229995625 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0013117621337997377, "computeRatioMax": 0.0013117621337997377, "endMs": "1665778322046", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001020259437399796, "readRatioMax": 0.001020259437399796, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778322002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.004372540445999125, "writeRatioMax": 0.004372540445999125 }, { "completedParallelInputs": "1", "computeMsAvg": "89", "computeMsMax": "89", "computeRatioAvg": 0.012971869989797406, "computeRatioMax": 0.012971869989797406, "endMs": "1665778322108", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008745080891998251, "readRatioMax": 0.0008745080891998251, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "132", "startMs": "1665778322023", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_street_number, $92:ca_street_name, $93:ca_city, $94:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002915026963999417, "waitRatioMax": 0.0002915026963999417, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0013117621337997377, "writeRatioMax": 0.0013117621337997377 }, { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.006704562017198659, "computeRatioMax": 0.006704562017198659, "endMs": "1665778322100", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008745080891998251, "readRatioMax": 0.0008745080891998251, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665778322044", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ca_address_sk, $111:ca_street_number, $112:ca_street_name, $113:ca_city, $114:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0016032648301996793, "writeRatioMax": 0.0016032648301996793 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0008745080891998251, "computeRatioMax": 0.0008745080891998251, "endMs": "1665778322095", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005830053927998834, "readRatioMax": 0.0005830053927998834, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778322057", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021862702229995625, "writeRatioMax": 0.0021862702229995625 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0011660107855997668, "computeRatioMax": 0.0011660107855997668, "endMs": "1665778322097", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008745080891998251, "readRatioMax": 0.0008745080891998251, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778322068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0023320215711995335, "writeRatioMax": 0.0023320215711995335 }, { "completedParallelInputs": "1", "computeMsAvg": "69", "computeMsMax": "69", "computeRatioAvg": 0.010056843025797988, "computeRatioMax": 0.010056843025797988, "endMs": "1665778322134", "id": "14", "inputStages": [ "4" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665778322087", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1080, $470, $471", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "greater($450, multiply(NUMERIC<...>, $451))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080", "$450 := SUM($470)", "$451 := SUM($471)" ] }, { "kind": "WRITE", "substeps": [ "$1090", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002915026963999417, "waitRatioMax": 0.0002915026963999417, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0011660107855997668, "writeRatioMax": 0.0011660107855997668 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0021862702229995625, "computeRatioMax": 0.0021862702229995625, "endMs": "1665778322154", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014575134819997085, "readRatioMax": 0.0014575134819997085, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778322109", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.001894767526599621, "writeRatioMax": 0.001894767526599621 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0021862702229995625, "computeRatioMax": 0.0021862702229995625, "endMs": "1665778322166", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001020259437399796, "readRatioMax": 0.001020259437399796, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778322127", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $213:i_product_name, $211:i_current_price, $212:i_color", "FROM item", "WHERE and(in($212, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($211, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$210, $213", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0013117621337997377, "writeRatioMax": 0.0013117621337997377 }, { "completedParallelInputs": "1", "computeMsAvg": "131", "computeMsMax": "131", "computeRatioAvg": 0.01909342661419618, "computeRatioMax": 0.01909342661419618, "endMs": "1665778322256", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0016032648301996793, "readRatioMax": 0.0016032648301996793, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "157", "startMs": "1665778322145", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:sr_item_sk, $201:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$200, $201", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0026235242675994755, "writeRatioMax": 0.0026235242675994755 }, { "completedParallelInputs": "1", "computeMsAvg": "844", "computeMsMax": "844", "computeRatioAvg": 0.12301413788077539, "computeRatioMax": 0.12301413788077539, "endMs": "1665778322667", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0017490161783996502, "readRatioMax": 0.0017490161783996502, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "768", "startMs": "1665778322164", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:cd_demo_sk, $231:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "75", "writeMsMax": "75", "writeRatioAvg": 0.010931351114997814, "writeRatioMax": 0.010931351114997814 }, { "completedParallelInputs": "1", "computeMsAvg": "783", "computeMsMax": "783", "computeRatioAvg": 0.11412330564057717, "computeRatioMax": 0.11412330564057717, "endMs": "1665778322643", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0016032648301996793, "readRatioMax": 0.0016032648301996793, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "567", "startMs": "1665778322183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270:cd_demo_sk, $271:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "65", "writeMsMax": "65", "writeRatioAvg": 0.009473837632998106, "writeRatioMax": 0.009473837632998106 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.001894767526599621, "computeRatioMax": 0.001894767526599621, "endMs": "1665778322245", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001020259437399796, "readRatioMax": 0.001020259437399796, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778322202", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310:hd_demo_sk, $311:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$310, $311", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0016032648301996793, "writeRatioMax": 0.0016032648301996793 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.001894767526599621, "computeRatioMax": 0.001894767526599621, "endMs": "1665778322255", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005830053927998834, "readRatioMax": 0.0005830053927998834, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778322216", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330:hd_demo_sk, $331:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$330, $331", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021862702229995625, "writeRatioMax": 0.0021862702229995625 }, { "completedParallelInputs": "1", "computeMsAvg": "110", "computeMsMax": "110", "computeRatioAvg": 0.016032648301996792, "computeRatioMax": 0.016032648301996792, "endMs": "1665778322358", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0021862702229995625, "readRatioMax": 0.0021862702229995625, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "190", "startMs": "1665778322229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390:c_customer_sk, $391:c_current_cdemo_sk, $392:c_current_hdemo_sk, $393:c_current_addr_sk, $394:c_first_shipto_date_sk, $395:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392, $393, $394, $395", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002040518874799592, "writeRatioMax": 0.002040518874799592 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.005392799883398921, "computeRatioMax": 0.005392799883398921, "endMs": "1665778322315", "id": "24", "name": "S18: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0016032648301996793, "readRatioMax": 0.0016032648301996793, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665778322261", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0023320215711995335, "writeRatioMax": 0.0023320215711995335 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.004664043142399067, "computeRatioMax": 0.004664043142399067, "endMs": "1665778322317", "id": "25", "name": "S19: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001020259437399796, "readRatioMax": 0.001020259437399796, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778322276", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002040518874799592, "writeRatioMax": 0.002040518874799592 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0011660107855997668, "computeRatioMax": 0.0011660107855997668, "endMs": "1665778322330", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005830053927998834, "readRatioMax": 0.0005830053927998834, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778322289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_store_name, $42:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0024777729193995045, "writeRatioMax": 0.0024777729193995045 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.001020259437399796, "computeRatioMax": 0.001020259437399796, "endMs": "1665778322345", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005830053927998834, "readRatioMax": 0.0005830053927998834, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778322308", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0026235242675994755, "writeRatioMax": 0.0026235242675994755 }, { "completedParallelInputs": "1", "computeMsAvg": "86", "computeMsMax": "86", "computeRatioAvg": 0.012534615945197494, "computeRatioMax": 0.012534615945197494, "endMs": "1665778322411", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001020259437399796, "readRatioMax": 0.001020259437399796, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "96", "startMs": "1665778322323", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_street_number, $82:ca_street_name, $83:ca_city, $84:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0017490161783996502, "writeRatioMax": 0.0017490161783996502 }, { "completedParallelInputs": "1", "computeMsAvg": "54", "computeMsMax": "54", "computeRatioAvg": 0.007870572802798426, "computeRatioMax": 0.007870572802798426, "endMs": "1665778322402", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011660107855997668, "readRatioMax": 0.0011660107855997668, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665778322339", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_street_number, $102:ca_street_name, $103:ca_city, $104:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.001894767526599621, "writeRatioMax": 0.001894767526599621 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0008745080891998251, "computeRatioMax": 0.0008745080891998251, "endMs": "1665778322416", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00043725404459991256, "readRatioMax": 0.00043725404459991256, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665778322351", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "56", "writeMsMax": "56", "writeRatioAvg": 0.008162075499198368, "writeRatioMax": 0.008162075499198368 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0014575134819997085, "computeRatioMax": 0.0014575134819997085, "endMs": "1665778322414", "id": "31", "name": "S1F: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001020259437399796, "readRatioMax": 0.001020259437399796, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665778322366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.004664043142399067, "writeRatioMax": 0.004664043142399067 }, { "completedParallelInputs": "1", "computeMsAvg": "70", "computeMsMax": "70", "computeRatioAvg": 0.01020259437399796, "computeRatioMax": 0.01020259437399796, "endMs": "1665778322434", "id": "32", "inputStages": [ "5" ], "name": "S20: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665778322389", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $460, $461", "FROM __stage05_output" ] }, { "kind": "FILTER", "substeps": [ "greater($440, multiply(NUMERIC<...>, $441))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670", "$440 := SUM($460)", "$441 := SUM($461)" ] }, { "kind": "WRITE", "substeps": [ "$680", "TO __stage20_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0011660107855997668, "writeRatioMax": 0.0011660107855997668 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.001020259437399796, "computeRatioMax": 0.001020259437399796, "endMs": "1665778322445", "id": "33", "name": "S21: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008745080891998251, "readRatioMax": 0.0008745080891998251, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778322405", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year", "FROM date_dim", "WHERE equal($161, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage21_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002040518874799592, "writeRatioMax": 0.002040518874799592 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0021862702229995625, "computeRatioMax": 0.0021862702229995625, "endMs": "1665778322472", "id": "34", "name": "S22: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001020259437399796, "readRatioMax": 0.001020259437399796, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778322428", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $193:i_product_name, $191:i_current_price, $192:i_color", "FROM item", "WHERE and(in($192, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($191, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$190, $193", "TO __stage22_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002040518874799592, "writeRatioMax": 0.002040518874799592 }, { "completedParallelInputs": "1", "computeMsAvg": "171", "computeMsMax": "171", "computeRatioAvg": 0.024923480542195016, "computeRatioMax": 0.024923480542195016, "endMs": "1665778322595", "id": "35", "name": "S23: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0016032648301996793, "readRatioMax": 0.0016032648301996793, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "165", "startMs": "1665778322446", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:sr_item_sk, $181:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$180, $181", "TO __stage23_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0005830053927998834, "waitRatioMax": 0.0005830053927998834, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0021862702229995625, "writeRatioMax": 0.0021862702229995625 }, { "completedParallelInputs": "1", "computeMsAvg": "702", "computeMsMax": "702", "computeRatioAvg": 0.10231744643637954, "computeRatioMax": 0.10231744643637954, "endMs": "1665778322964", "id": "36", "name": "S24: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011660107855997668, "readRatioMax": 0.0011660107855997668, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "679", "startMs": "1665778322456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:cd_demo_sk, $221:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$220, $221", "TO __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "55", "writeMsMax": "55", "writeRatioAvg": 0.008016324150998396, "writeRatioMax": 0.008016324150998396 }, { "completedParallelInputs": "1", "computeMsAvg": "565", "computeMsMax": "565", "computeRatioAvg": 0.08234951173298354, "computeRatioMax": 0.08234951173298354, "endMs": "1665778322987", "id": "37", "name": "S25: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.002040518874799592, "readRatioMax": 0.002040518874799592, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "673", "startMs": "1665778322472", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240:cd_demo_sk, $241:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage25_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.007870572802798426, "writeRatioMax": 0.007870572802798426 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0014575134819997085, "computeRatioMax": 0.0014575134819997085, "endMs": "1665778322531", "id": "38", "name": "S26: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008745080891998251, "readRatioMax": 0.0008745080891998251, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778322485", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300:hd_demo_sk, $301:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage26_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0026235242675994755, "writeRatioMax": 0.0026235242675994755 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0014575134819997085, "computeRatioMax": 0.0014575134819997085, "endMs": "1665778322563", "id": "39", "name": "S27: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0013117621337997377, "readRatioMax": 0.0013117621337997377, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778322511", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320:hd_demo_sk, $321:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage27_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.005247048535198951, "writeRatioMax": 0.005247048535198951 }, { "completedParallelInputs": "1", "computeMsAvg": "114", "computeMsMax": "114", "computeRatioAvg": 0.016615653694796676, "computeRatioMax": 0.016615653694796676, "endMs": "1665778322772", "id": "40", "name": "S28: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011660107855997668, "readRatioMax": 0.0011660107855997668, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "307", "startMs": "1665778322546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360:c_customer_sk, $361:c_current_cdemo_sk, $362:c_current_hdemo_sk, $363:c_current_addr_sk, $364:c_first_shipto_date_sk, $365:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $364, $365", "TO __stage28_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "134", "writeMsMax": "134", "writeRatioAvg": 0.019530680658796092, "writeRatioMax": 0.019530680658796092 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.0013117621337997377, "computeRatioMax": 0.0033522810085993295, "endMs": "1665778322787", "id": "44", "inputStages": [ "14" ], "name": "S2C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "3542", "startMs": "1665778322727", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0002915026963999417, "waitRatioMax": 0.0005830053927998834, "writeMsAvg": "16", "writeMsMax": "27", "writeRatioAvg": 0.0023320215711995335, "writeRatioMax": 0.003935286401399213 }, { "completedParallelInputs": "6", "computeMsAvg": "5139", "computeMsMax": "5844", "computeRatioAvg": 0.7490161783996502, "computeRatioMax": 0.8517708788806296, "endMs": "1665778325948", "id": "45", "inputStages": [ "17", "16", "11", "6", "18", "15", "21", "7", "22", "12", "8", "13", "9", "44", "19", "20", "10" ], "name": "S2D: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "26", "readRatioAvg": 0.0033522810085993295, "readRatioMax": 0.003789535053199242, "recordsRead": "29661809", "recordsWritten": "11", "shuffleOutputBytes": "2546", "shuffleOutputBytesSpilled": "0", "slotMs": "27063", "startMs": "1665778322754", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370:ss_sold_date_sk, $371:ss_item_sk, $372:ss_customer_sk, $373:ss_cdemo_sk, $374:ss_hdemo_sk, $375:ss_addr_sk, $376:ss_store_sk, $377:ss_promo_sk, $378:ss_ticket_number, $379:ss_wholesale_cost, $380:ss_list_price, $381:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$390, $391, $392, $393, $394, $395", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$330, $331", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$310, $311", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$270, $271", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$200, $201", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$210, $213", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$1090", "FROM __stage2C_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1280 := $1273, $1281 := $1272, $1282 := $1261, $1283 := $1262, $1284 := $1263, $1285 := $1264, $1286 := $1265, $1287 := $1266, $1288 := $1267, $1289 := $1268, $1290 := $1269, $1291 := $1270, $1292 := $1271, $1293 := $1277, $1294 := $1260", "$430 := COUNT_STAR()", "$431 := SUM($1274)", "$432 := SUM($1275)", "$433 := SUM($1276)" ] }, { "kind": "JOIN", "substeps": [ "$1260 := $1257, $1261 := $1240, $1262 := $1241, $1263 := $1242, $1264 := $1243, $1265 := $1244, $1266 := $1245, $1267 := $1246, $1268 := $1247, $1269 := $1248, $1270 := $1249, $1271 := $1250, $1272 := $1251, $1273 := $1252, $1274 := $1253, $1275 := $1254", "INNER HASH JOIN EACH WITH ALL ON $1256 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $1236, $1241 := $1237, $1242 := $1220, $1243 := $1221, $1244 := $1222, $1245 := $1223, $1246 := $1224, $1247 := $1225, $1248 := $1226, $1249 := $1227, $1250 := $1228, $1251 := $1229, $1252 := $1230, $1253 := $1231, $1254 := $1232, $1255 := $1233", "INNER HASH JOIN EACH WITH ALL ON $1234 = $30" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $1200, $1221 := $1201, $1222 := $1202, $1223 := $1203, $1224 := $1204, $1225 := $1205, $1226 := $1206, $1227 := $1207, $1228 := $1208, $1229 := $1209, $1230 := $1210, $1231 := $1212, $1232 := $1213, $1233 := $1214, $1234 := $1215, $1235 := $1216", "INNER HASH JOIN EACH WITH ALL ON $1211 = $50" ] }, { "kind": "JOIN", "substeps": [ "$1200 := $1194, $1201 := $1195, $1202 := $1196, $1203 := $1197, $1204 := $1180, $1205 := $1181, $1206 := $1182, $1207 := $1183, $1208 := $1184, $1209 := $1185, $1210 := $1186, $1211 := $1187, $1212 := $1189, $1213 := $1190, $1214 := $1191, $1215 := $1192", "INNER HASH JOIN EACH WITH ALL ON $1188 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1171, $1181 := $1172, $1182 := $1173, $1183 := $1174, $1184 := $1160, $1185 := $1161, $1186 := $1162, $1187 := $1164, $1188 := $1165, $1189 := $1166, $1190 := $1167, $1191 := $1168, $1192 := $1169, $1193 := $1170, $1194 := $91, $1195 := $92", "INNER HASH JOIN EACH WITH ALL ON $1163 = $90" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $1140, $1161 := $1141, $1162 := $1142, $1163 := $1143, $1164 := $1144, $1165 := $1145, $1166 := $1146, $1167 := $1147, $1168 := $1148, $1169 := $1150, $1170 := $1151, $1171 := $111, $1172 := $112, $1173 := $113, $1174 := $114", "INNER HASH JOIN EACH WITH ALL ON $1149 = $110" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $1120, $1141 := $1121, $1142 := $1122, $1143 := $1124, $1144 := $1125, $1145 := $1126, $1146 := $1127, $1147 := $1128, $1148 := $1129, $1149 := $1130, $1150 := $1131, $1151 := $1132", "INNER HASH JOIN EACH WITH ALL ON $1123 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1100, $1121 := $1101, $1122 := $1102, $1123 := $1103, $1124 := $1105, $1125 := $1106, $1126 := $1107, $1127 := $1108, $1128 := $1109, $1129 := $1110, $1130 := $1111, $1131 := $1112, $1132 := $1113", "INNER HASH JOIN EACH WITH ALL ON $1104 = $150" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1064, $1101 := $1050, $1102 := $1051, $1103 := $1052, $1104 := $1053, $1105 := $1055, $1106 := $1056, $1107 := $1057, $1108 := $1058, $1109 := $1059, $1110 := $1060, $1111 := $1061, $1112 := $1062, $1113 := $1063", "INNER HASH JOIN EACH WITH ALL ON $1054 = $1090" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $1043, $1051 := $1044, $1052 := $1030, $1053 := $1031, $1054 := $1033, $1055 := $1034, $1056 := $1035, $1057 := $1036, $1058 := $1037, $1059 := $1038, $1060 := $1039, $1061 := $1040, $1062 := $1041, $1063 := $1042, $1064 := $171", "INNER HASH JOIN EACH WITH ALL ON $1032 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1010, $1031 := $1011, $1032 := $1012, $1033 := $1013, $1034 := $1014, $1035 := $1015, $1036 := $1016, $1037 := $1017, $1038 := $1018, $1039 := $1019, $1040 := $1020, $1041 := $1021, $1042 := $1022, $1043 := $210, $1044 := $213", "INNER HASH JOIN EACH WITH ALL ON $1013 = $210" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $991, $1011 := $992, $1012 := $993, $1013 := $994, $1014 := $995, $1015 := $996, $1016 := $997, $1017 := $999, $1018 := $1000, $1019 := $1001, $1020 := $1002, $1021 := $1003, $1022 := $1004", "INNER HASH JOIN EACH WITH ALL ON $994 = $200, $998 = $201" ] }, { "kind": "FILTER", "substeps": [ "not_equal($1005, $990)" ] }, { "kind": "JOIN", "substeps": [ "$990 := $985, $991 := $970, $992 := $971, $993 := $972, $994 := $973, $995 := $975, $996 := $976, $997 := $977, $998 := $978, $999 := $979, $1000 := $980, $1001 := $981, $1002 := $982, $1003 := $983, $1004 := $984, $1005 := $231", "INNER HASH JOIN EACH WITH ALL ON $974 = $230" ] }, { "kind": "JOIN", "substeps": [ "$970 := $965, $971 := $950, $972 := $951, $973 := $952, $974 := $953, $975 := $954, $976 := $955, $977 := $956, $978 := $957, $979 := $958, $980 := $959, $981 := $960, $982 := $962, $983 := $963, $984 := $964, $985 := $271", "INNER HASH JOIN EACH WITH ALL ON $961 = $270" ] }, { "kind": "JOIN", "substeps": [ "$950 := $945, $951 := $930, $952 := $931, $953 := $932, $954 := $934, $955 := $935, $956 := $936, $957 := $937, $958 := $938, $959 := $939, $960 := $940, $961 := $941, $962 := $942, $963 := $943, $964 := $944, $965 := $311", "INNER HASH JOIN EACH WITH ALL ON $933 = $310" ] }, { "kind": "JOIN", "substeps": [ "$930 := $910, $931 := $911, $932 := $912, $933 := $913, $934 := $914, $935 := $915, $936 := $916, $937 := $917, $938 := $918, $939 := $919, $940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $925, $945 := $331", "INNER HASH JOIN EACH WITH ALL ON $922 = $330" ] }, { "kind": "JOIN", "substeps": [ "$910 := $370, $911 := $371, $912 := $373, $913 := $374, $914 := $375, $915 := $376, $916 := $377, $917 := $378, $918 := $379, $919 := $380, $920 := $381, $921 := $391, $922 := $392, $923 := $393, $924 := $394, $925 := $395", "INNER HASH JOIN EACH WITH ALL ON $372 = $390" ] }, { "kind": "WRITE", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "TO __stage2D_output", "BY HASH($1280, $1281, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1293, $1294)" ] } ], "waitMsAvg": "8", "waitMsMax": "13", "waitRatioAvg": 0.0011660107855997668, "waitRatioMax": 0.001894767526599621, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.0008745080891998251, "writeRatioMax": 0.001020259437399796 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "17", "computeRatioAvg": 0.0014575134819997085, "computeRatioMax": 0.0024777729193995045, "endMs": "1665778323120", "id": "47", "inputStages": [ "32" ], "name": "S2F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "4102", "startMs": "1665778323056", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage20_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0002915026963999417, "waitRatioMax": 0.00043725404459991256, "writeMsAvg": "26", "writeMsMax": "33", "writeRatioAvg": 0.003789535053199242, "writeRatioMax": 0.004809794490599038 }, { "completedParallelInputs": "6", "computeMsAvg": "5677", "computeMsMax": "6861", "computeRatioAvg": 0.8274304037312346, "computeRatioMax": 1, "endMs": "1665778326871", "id": "48", "inputStages": [ "35", "37", "25", "26", "36", "27", "28", "33", "47", "24", "30", "39", "38", "29", "31", "40", "34" ], "name": "S30: Join+", "parallelInputs": "6", "readMsAvg": "27", "readMsMax": "31", "readRatioAvg": 0.003935286401399213, "readRatioMax": 0.004518291794199096, "recordsRead": "29398184", "recordsWritten": "8", "shuffleOutputBytes": "1830", "shuffleOutputBytesSpilled": "0", "slotMs": "34095", "startMs": "1665778323086", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340:ss_sold_date_sk, $341:ss_item_sk, $342:ss_customer_sk, $343:ss_cdemo_sk, $344:ss_hdemo_sk, $345:ss_addr_sk, $346:ss_store_sk, $347:ss_promo_sk, $348:ss_ticket_number, $349:ss_wholesale_cost, $350:ss_list_price, $351:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $364, $365", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage27_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$240, $241", "FROM __stage25_output" ] }, { "kind": "READ", "substeps": [ "$220, $221", "FROM __stage24_output" ] }, { "kind": "READ", "substeps": [ "$180, $181", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$190, $193", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$680", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $870 := $863, $871 := $862, $872 := $851, $873 := $852, $874 := $853, $875 := $854, $876 := $855, $877 := $856, $878 := $857, $879 := $858, $880 := $859, $881 := $860, $882 := $861, $883 := $867, $884 := $850", "$420 := COUNT_STAR()", "$421 := SUM($864)", "$422 := SUM($865)", "$423 := SUM($866)" ] }, { "kind": "JOIN", "substeps": [ "$850 := $847, $851 := $830, $852 := $831, $853 := $832, $854 := $833, $855 := $834, $856 := $835, $857 := $836, $858 := $837, $859 := $838, $860 := $839, $861 := $840, $862 := $841, $863 := $842, $864 := $843, $865 := $844", "INNER HASH JOIN EACH WITH ALL ON $846 = $1" ] }, { "kind": "JOIN", "substeps": [ "$830 := $826, $831 := $827, $832 := $810, $833 := $811, $834 := $812, $835 := $813, $836 := $814, $837 := $815, $838 := $816, $839 := $817, $840 := $818, $841 := $819, $842 := $820, $843 := $821, $844 := $822, $845 := $823", "INNER HASH JOIN EACH WITH ALL ON $824 = $20" ] }, { "kind": "JOIN", "substeps": [ "$810 := $790, $811 := $791, $812 := $792, $813 := $793, $814 := $794, $815 := $795, $816 := $796, $817 := $797, $818 := $798, $819 := $799, $820 := $800, $821 := $802, $822 := $803, $823 := $804, $824 := $805, $825 := $806", "INNER HASH JOIN EACH WITH ALL ON $801 = $40" ] }, { "kind": "JOIN", "substeps": [ "$790 := $784, $791 := $785, $792 := $786, $793 := $787, $794 := $770, $795 := $771, $796 := $772, $797 := $773, $798 := $774, $799 := $775, $800 := $776, $801 := $777, $802 := $779, $803 := $780, $804 := $781, $805 := $782", "INNER HASH JOIN EACH WITH ALL ON $778 = $60" ] }, { "kind": "JOIN", "substeps": [ "$770 := $761, $771 := $762, $772 := $763, $773 := $764, $774 := $750, $775 := $751, $776 := $752, $777 := $754, $778 := $755, $779 := $756, $780 := $757, $781 := $758, $782 := $759, $783 := $760, $784 := $81, $785 := $82", "INNER HASH JOIN EACH WITH ALL ON $753 = $80" ] }, { "kind": "JOIN", "substeps": [ "$750 := $730, $751 := $731, $752 := $732, $753 := $733, $754 := $734, $755 := $735, $756 := $736, $757 := $737, $758 := $738, $759 := $740, $760 := $741, $761 := $101, $762 := $102, $763 := $103, $764 := $104", "INNER HASH JOIN EACH WITH ALL ON $739 = $100" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $712, $733 := $714, $734 := $715, $735 := $716, $736 := $717, $737 := $718, $738 := $719, $739 := $720, $740 := $721, $741 := $722", "INNER HASH JOIN EACH WITH ALL ON $713 = $120" ] }, { "kind": "JOIN", "substeps": [ "$710 := $690, $711 := $691, $712 := $692, $713 := $693, $714 := $695, $715 := $696, $716 := $697, $717 := $698, $718 := $699, $719 := $700, $720 := $701, $721 := $702, $722 := $703", "INNER HASH JOIN EACH WITH ALL ON $694 = $140" ] }, { "kind": "JOIN", "substeps": [ "$690 := $654, $691 := $640, $692 := $641, $693 := $642, $694 := $643, $695 := $645, $696 := $646, $697 := $647, $698 := $648, $699 := $649, $700 := $650, $701 := $651, $702 := $652, $703 := $653", "INNER HASH JOIN EACH WITH ALL ON $644 = $680" ] }, { "kind": "JOIN", "substeps": [ "$640 := $633, $641 := $634, $642 := $620, $643 := $621, $644 := $623, $645 := $624, $646 := $625, $647 := $626, $648 := $627, $649 := $628, $650 := $629, $651 := $630, $652 := $631, $653 := $632, $654 := $161", "INNER HASH JOIN EACH WITH ALL ON $622 = $160" ] }, { "kind": "JOIN", "substeps": [ "$620 := $600, $621 := $601, $622 := $602, $623 := $603, $624 := $604, $625 := $605, $626 := $606, $627 := $607, $628 := $608, $629 := $609, $630 := $610, $631 := $611, $632 := $612, $633 := $190, $634 := $193", "INNER HASH JOIN EACH WITH ALL ON $603 = $190" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $589, $608 := $590, $609 := $591, $610 := $592, $611 := $593, $612 := $594", "INNER HASH JOIN EACH WITH ALL ON $584 = $180, $588 = $181" ] }, { "kind": "FILTER", "substeps": [ "not_equal($595, $580)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $575, $581 := $560, $582 := $561, $583 := $562, $584 := $563, $585 := $565, $586 := $566, $587 := $567, $588 := $568, $589 := $569, $590 := $570, $591 := $571, $592 := $572, $593 := $573, $594 := $574, $595 := $221", "INNER HASH JOIN EACH WITH ALL ON $564 = $220" ] }, { "kind": "JOIN", "substeps": [ "$560 := $555, $561 := $540, $562 := $541, $563 := $542, $564 := $543, $565 := $544, $566 := $545, $567 := $546, $568 := $547, $569 := $548, $570 := $549, $571 := $550, $572 := $552, $573 := $553, $574 := $554, $575 := $241", "INNER HASH JOIN EACH WITH ALL ON $551 = $240" ] }, { "kind": "JOIN", "substeps": [ "$540 := $535, $541 := $520, $542 := $521, $543 := $522, $544 := $524, $545 := $525, $546 := $526, $547 := $527, $548 := $528, $549 := $529, $550 := $530, $551 := $531, $552 := $532, $553 := $533, $554 := $534, $555 := $301", "INNER HASH JOIN EACH WITH ALL ON $523 = $300" ] }, { "kind": "JOIN", "substeps": [ "$520 := $500, $521 := $501, $522 := $502, $523 := $503, $524 := $504, $525 := $505, $526 := $506, $527 := $507, $528 := $508, $529 := $509, $530 := $510, $531 := $511, $532 := $513, $533 := $514, $534 := $515, $535 := $321", "INNER HASH JOIN EACH WITH ALL ON $512 = $320" ] }, { "kind": "JOIN", "substeps": [ "$500 := $340, $501 := $341, $502 := $343, $503 := $344, $504 := $345, $505 := $346, $506 := $347, $507 := $348, $508 := $349, $509 := $350, $510 := $351, $511 := $361, $512 := $362, $513 := $363, $514 := $364, $515 := $365", "INNER HASH JOIN EACH WITH ALL ON $342 = $360" ] }, { "kind": "WRITE", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "TO __stage30_output", "BY HASH($870, $871, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $883, $884)" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.0005830053927998834, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.001020259437399796, "writeRatioMax": 0.0013117621337997377 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0017490161783996502, "computeRatioMax": 0.0017490161783996502, "endMs": "1665778326960", "id": "49", "inputStages": [ "45" ], "name": "S31: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665778326910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "FROM __stage2D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1300 := $1280, $1301 := $1281, $1302 := $1282, $1303 := $1283, $1304 := $1284, $1305 := $1285, $1306 := $1286, $1307 := $1287, $1308 := $1288, $1309 := $1289, $1310 := $1290, $1311 := $1291, $1312 := $1292, $1313 := $1293, $1314 := $1294", "$410 := SUM_OF_COUNTS($430)", "$411 := SUM($431)", "$412 := SUM($432)", "$413 := SUM($433)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "TO __stage31_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014575134819997084, "waitRatioMax": 0.00014575134819997084, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.004081037749599184, "writeRatioMax": 0.004081037749599184 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.0011660107855997668, "computeRatioMax": 0.0024777729193995045, "endMs": "1665778327035", "id": "51", "inputStages": [ "49" ], "name": "S33: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "4286", "startMs": "1665778326971", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage31_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0002915026963999417, "waitRatioMax": 0.00043725404459991256, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.0024777729193995045, "writeRatioMax": 0.004372540445999125 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.002769275615799446, "computeRatioMax": 0.002769275615799446, "endMs": "1665778327051", "id": "52", "inputStages": [ "51", "48" ], "name": "S34: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "19", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778326988", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "FROM __stage30_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "FROM __stage33_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($1337, $1332)" ] }, { "kind": "JOIN", "substeps": [ "$1320 := $892, $1321 := $893, $1322 := $894, $1323 := $895, $1324 := $896, $1325 := $897, $1326 := $898, $1327 := $899, $1328 := $900, $1329 := $901, $1330 := $902, $1331 := $890, $1332 := $400, $1333 := $401, $1334 := $402, $1335 := $403", "INNER HASH JOIN EACH WITH ALL ON $891 = $1301, $892 = $1302, $893 = $1303" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $870, $891 := $871, $892 := $872, $893 := $873, $894 := $874, $895 := $875, $896 := $876, $897 := $877, $898 := $878, $899 := $879, $900 := $880, $901 := $881, $902 := $882, $903 := $883, $904 := $884", "$400 := SUM_OF_COUNTS($420)", "$401 := SUM($421)", "$402 := SUM($422)", "$403 := SUM($423)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "TO __stage34_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0005830053927998834, "waitRatioMax": 0.0005830053927998834, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0011660107855997668, "writeRatioMax": 0.0011660107855997668 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.001020259437399796, "computeRatioMax": 0.001020259437399796, "endMs": "1665778327101", "id": "53", "inputStages": [ "52" ], "name": "S35: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778327069", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "FROM __stage34_output" ] }, { "kind": "SORT", "substeps": [ "$1331 ASC, $1320 ASC, $1337 ASC, $1333 ASC, $1338 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1350, $1351, $1352, $1353, $1354, $1355, $1356, $1357, $1358, $1359, $1360, $1361, $1362, $1363, $1364, $1365", "TO __stage35_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002915026963999417, "waitRatioMax": 0.0002915026963999417, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.001894767526599621, "writeRatioMax": 0.001894767526599621 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "income_band" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "8", "completedUnits": "8", "elapsedMs": "736", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "5901" }, { "activeUnits": "14", "completedUnits": "144", "elapsedMs": "1763", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "16912" }, { "activeUnits": "12", "completedUnits": "246", "elapsedMs": "2341", "estimatedRunnableUnits": "5", "pendingUnits": "12", "totalSlotMs": "28256" }, { "activeUnits": "11", "completedUnits": "248", "elapsedMs": "4351", "estimatedRunnableUnits": "0", "pendingUnits": "10", "totalSlotMs": "67689" }, { "activeUnits": "4", "completedUnits": "256", "elapsedMs": "5520", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "80552" }, { "activeUnits": "4", "completedUnits": "361", "elapsedMs": "6049", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "87632" } ], "totalBytesBilled": "422576128", "totalBytesProcessed": "421895625", "totalPartitionsProcessed": "0", "totalSlotMs": "87632", "transferredBytes": "0" }, "startTime": "1665778321129", "totalBytesProcessed": "421895625", "totalSlotMs": "87632" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon46db8760_440d_494a_ada0_1bdd2213a404" }, "priority": "INTERACTIVE", "query": "with cs_ui as\n (select cs_item_sk\n ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n from catalog_sales\n ,catalog_returns\n where cs_item_sk = cr_item_sk\n and cs_order_number = cr_order_number\n group by cs_item_sk\n having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n ,i_item_sk item_sk\n ,s_store_name store_name\n ,s_zip store_zip\n ,ad1.ca_street_number b_street_number\n ,ad1.ca_street_name b_street_name\n ,ad1.ca_city b_city\n ,ad1.ca_zip b_zip\n ,ad2.ca_street_number c_street_number\n ,ad2.ca_street_name c_street_name\n ,ad2.ca_city c_city\n ,ad2.ca_zip c_zip\n ,d1.d_year as syear\n ,d2.d_year as fsyear\n ,d3.d_year s2year\n ,count(*) cnt\n ,sum(ss_wholesale_cost) s1\n ,sum(ss_list_price) s2\n ,sum(ss_coupon_amt) s3\n FROM store_sales\n ,store_returns\n ,cs_ui\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,customer\n ,customer_demographics cd1\n ,customer_demographics cd2\n ,promotion\n ,household_demographics hd1\n ,household_demographics hd2\n ,customer_address ad1\n ,customer_address ad2\n ,income_band ib1\n ,income_band ib2\n ,item\n WHERE ss_store_sk = s_store_sk AND\n ss_sold_date_sk = d1.d_date_sk AND\n ss_customer_sk = c_customer_sk AND\n ss_cdemo_sk= cd1.cd_demo_sk AND\n ss_hdemo_sk = hd1.hd_demo_sk AND\n ss_addr_sk = ad1.ca_address_sk and\n ss_item_sk = i_item_sk and\n ss_item_sk = sr_item_sk and\n ss_ticket_number = sr_ticket_number and\n ss_item_sk = cs_ui.cs_item_sk and\n c_current_cdemo_sk = cd2.cd_demo_sk AND\n c_current_hdemo_sk = hd2.hd_demo_sk AND\n c_current_addr_sk = ad2.ca_address_sk and\n c_first_sales_date_sk = d2.d_date_sk and\n c_first_shipto_date_sk = d3.d_date_sk and\n ss_promo_sk = p_promo_sk and\n hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n cd1.cd_marital_status <> cd2.cd_marital_status and\n i_color in ('orange','lace','lawn','misty','blush','pink') and\n i_current_price between 48 and 48 + 10 and\n i_current_price between 48 + 1 and 48 + 15\ngroup by i_product_name\n ,i_item_sk\n ,s_store_name\n ,s_zip\n ,ad1.ca_street_number\n ,ad1.ca_street_name\n ,ad1.ca_city\n ,ad1.ca_zip\n ,ad2.ca_street_number\n ,ad2.ca_street_name\n ,ad2.ca_city\n ,ad2.ca_zip\n ,d1.d_year\n ,d2.d_year\n ,d3.d_year\n)\nselect cs1.product_name\n ,cs1.store_name\n ,cs1.store_zip\n ,cs1.b_street_number\n ,cs1.b_street_name\n ,cs1.b_city\n ,cs1.b_zip\n ,cs1.c_street_number\n ,cs1.c_street_name\n ,cs1.c_city\n ,cs1.c_zip\n ,cs1.syear\n ,cs1.cnt\n ,cs1.s1 as s11\n ,cs1.s2 as s21\n ,cs1.s3 as s31\n ,cs2.s1 as s12\n ,cs2.s2 as s22\n ,cs2.s3 as s32\n ,cs2.syear\n ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n cs1.syear = 1999 and\n cs2.syear = 1999 + 1 and\n cs2.cnt <= cs1.cnt and\n cs1.store_name = cs2.store_name and\n cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n ,cs1.store_name\n ,cs2.cnt\n ,cs1.s1\n ,cs2.s1;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "kHAMbUrA0wMaXClKOieptA==", "id": "test-project-364309:europe-west1.query64_1665778329", "jobReference": { "jobId": "query64_1665778329", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query64_1665778329?location=europe-west1", "statistics": { "creationTime": "1665778329716", "endTime": "1665778336973", "finalExecutionDurationMs": "6924", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "421895625", "performanceInsights": { "avgPreviousExecutionMs": "6300" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "298", "computeMsMax": "298", "computeRatioAvg": 0.044043748152527346, "computeRatioMax": 0.044043748152527346, "endMs": "1665778330211", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.00325155187703222, "readRatioMax": 0.00325155187703222, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "9804031", "shuffleOutputBytesSpilled": "0", "slotMs": "375", "startMs": "1665778329970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290:cr_item_sk, $291:cr_order_number, $292:cr_refunded_cash, $293:cr_reversed_charge, $294:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002955956251847473, "waitRatioMax": 0.0002955956251847473, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0026603606266627253, "writeRatioMax": 0.0026603606266627253 }, { "completedParallelInputs": "5", "computeMsAvg": "239", "computeMsMax": "357", "computeRatioAvg": 0.0353236772095773, "computeRatioMax": 0.052763819095477386, "endMs": "1665778330223", "id": "3", "name": "S03: Input", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.002069169376293231, "readRatioMax": 0.002512562814070352, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "50341364", "shuffleOutputBytesSpilled": "0", "slotMs": "1212", "startMs": "1665778330017", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250:cs_item_sk, $251:cs_order_number, $252:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.0022169671888856044, "writeRatioMax": 0.0026603606266627253 }, { "completedParallelInputs": "5", "computeMsAvg": "341", "computeMsMax": "394", "computeRatioAvg": 0.05039905409399941, "computeRatioMax": 0.05823233816139521, "endMs": "1665778330509", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "18", "readMsMax": "26", "readRatioAvg": 0.0026603606266627253, "readRatioMax": 0.0038427431274017146, "recordsRead": "2161883", "recordsWritten": "66995", "shuffleOutputBytes": "2863297", "shuffleOutputBytesSpilled": "0", "slotMs": "2031", "startMs": "1665778330253", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280:cs_item_sk, $281:cs_order_number, $282:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$290, $291, $292, $293, $294", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $1070", "$470 := SUM($1071)", "$471 := SUM($490)" ] }, { "kind": "COMPUTE", "substeps": [ "$490 := add(add($1072, $1073), $1074)" ] }, { "kind": "JOIN", "substeps": [ "$1070 := $280, $1071 := $282, $1072 := $292, $1073 := $293, $1074 := $294", "INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291" ] }, { "kind": "WRITE", "substeps": [ "$1080, $470, $471", "TO __stage04_output", "BY HASH($1080)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.0002955956251847473, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.0010345846881466155, "writeRatioMax": 0.0013301803133313626 }, { "completedParallelInputs": "1", "computeMsAvg": "1313", "computeMsMax": "1313", "computeRatioAvg": 0.19405852793378658, "computeRatioMax": 0.19405852793378658, "endMs": "1665778331061", "id": "5", "inputStages": [ "3" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.0026603606266627253, "readRatioMax": 0.0026603606266627253, "recordsRead": "1585615", "recordsWritten": "17862", "shuffleOutputBytes": "767810", "shuffleOutputBytesSpilled": "0", "slotMs": "1372", "startMs": "1665778330256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260:cr_item_sk, $261:cr_order_number, $262:cr_refunded_cash, $263:cr_reversed_charge, $264:cr_store_credit", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$250, $251, $252", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $660", "$460 := SUM($661)", "$461 := SUM($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := add(add($662, $663), $664)" ] }, { "kind": "JOIN", "substeps": [ "$662 := $262, $663 := $263, $664 := $264, $660 := $250, $661 := $252", "INNER HASH JOIN EACH WITH ALL ON $260 = $250, $261 = $251" ] }, { "kind": "WRITE", "substeps": [ "$670, $460, $461", "TO __stage05_output", "BY HASH($670)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0005911912503694946, "writeRatioMax": 0.0005911912503694946 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.0035471475022169673, "computeRatioMax": 0.0035471475022169673, "endMs": "1665778330571", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007389890629618681, "readRatioMax": 0.0007389890629618681, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778330528", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.00162577593851611, "writeRatioMax": 0.00162577593851611 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.004729530002955957, "computeRatioMax": 0.004729530002955957, "endMs": "1665778330585", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011823825007389892, "readRatioMax": 0.0011823825007389892, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778330546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0017735737511084836, "writeRatioMax": 0.0017735737511084836 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0013301803133313626, "computeRatioMax": 0.0013301803133313626, "endMs": "1665778330603", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005911912503694946, "readRatioMax": 0.0005911912503694946, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778330562", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_store_name, $52:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.002808158439255099, "writeRatioMax": 0.002808158439255099 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0019213715637008573, "computeRatioMax": 0.0019213715637008573, "endMs": "1665778330621", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014779781259237363, "readRatioMax": 0.0014779781259237363, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778330581", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$70", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.00162577593851611, "writeRatioMax": 0.00162577593851611 }, { "completedParallelInputs": "1", "computeMsAvg": "79", "computeMsMax": "79", "computeRatioAvg": 0.011676027194797517, "computeRatioMax": 0.011676027194797517, "endMs": "1665778330685", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0010345846881466155, "readRatioMax": 0.0010345846881466155, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "122", "startMs": "1665778330598", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_street_number, $92:ca_street_name, $93:ca_city, $94:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0019213715637008573, "writeRatioMax": 0.0019213715637008573 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.008572273130357671, "computeRatioMax": 0.008572273130357671, "endMs": "1665778330692", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007389890629618681, "readRatioMax": 0.0007389890629618681, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "91", "startMs": "1665778330616", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ca_address_sk, $111:ca_street_number, $112:ca_street_name, $113:ca_city, $114:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0013301803133313626, "writeRatioMax": 0.0013301803133313626 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0013301803133313626, "computeRatioMax": 0.0013301803133313626, "endMs": "1665778330675", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005911912503694946, "readRatioMax": 0.0005911912503694946, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778330635", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0004433934377771209, "waitRatioMax": 0.0004433934377771209, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0023647650014779783, "writeRatioMax": 0.0023647650014779783 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0010345846881466155, "computeRatioMax": 0.0010345846881466155, "endMs": "1665778330688", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005911912503694946, "readRatioMax": 0.0005911912503694946, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778330648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0002955956251847473, "waitRatioMax": 0.0002955956251847473, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0026603606266627253, "writeRatioMax": 0.0026603606266627253 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.005616316878510198, "computeRatioMax": 0.005616316878510198, "endMs": "1665778330710", "id": "14", "inputStages": [ "4" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "66995", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778330663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1080, $470, $471", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "greater($450, multiply(NUMERIC<...>, $451))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080", "$450 := SUM($470)", "$451 := SUM($471)" ] }, { "kind": "WRITE", "substeps": [ "$1090", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0011823825007389892, "writeRatioMax": 0.0011823825007389892 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0017735737511084836, "computeRatioMax": 0.0017735737511084836, "endMs": "1665778330720", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014779781259237363, "readRatioMax": 0.0014779781259237363, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778330681", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0011823825007389892, "writeRatioMax": 0.0011823825007389892 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.002069169376293231, "computeRatioMax": 0.002069169376293231, "endMs": "1665778330731", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011823825007389892, "readRatioMax": 0.0011823825007389892, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778330698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $213:i_product_name, $211:i_current_price, $212:i_color", "FROM item", "WHERE and(in($212, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($211, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$210, $213", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002069169376293231, "writeRatioMax": 0.002069169376293231 }, { "completedParallelInputs": "1", "computeMsAvg": "179", "computeMsMax": "179", "computeRatioAvg": 0.02645580845403488, "computeRatioMax": 0.02645580845403488, "endMs": "1665778330856", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.00162577593851611, "readRatioMax": 0.00162577593851611, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "188", "startMs": "1665778330716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:sr_item_sk, $201:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$200, $201", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0026603606266627253, "writeRatioMax": 0.0026603606266627253 }, { "completedParallelInputs": "1", "computeMsAvg": "487", "computeMsMax": "487", "computeRatioAvg": 0.07197753473248596, "computeRatioMax": 0.07197753473248596, "endMs": "1665778331161", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.00162577593851611, "readRatioMax": 0.00162577593851611, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "575", "startMs": "1665778330739", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:cd_demo_sk, $231:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "50", "writeMsMax": "50", "writeRatioAvg": 0.0073898906296186815, "writeRatioMax": 0.0073898906296186815 }, { "completedParallelInputs": "1", "computeMsAvg": "518", "computeMsMax": "518", "computeRatioAvg": 0.07655926692284955, "computeRatioMax": 0.07655926692284955, "endMs": "1665778331152", "id": "19", "name": "S13: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0017735737511084836, "readRatioMax": 0.0017735737511084836, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "565", "startMs": "1665778330754", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270:cd_demo_sk, $271:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$270, $271", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "59", "writeMsMax": "59", "writeRatioAvg": 0.008720070942950044, "writeRatioMax": 0.008720070942950044 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.002069169376293231, "computeRatioMax": 0.002069169376293231, "endMs": "1665778330810", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005911912503694946, "readRatioMax": 0.0005911912503694946, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778330769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310:hd_demo_sk, $311:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$310, $311", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002512562814070352, "writeRatioMax": 0.002512562814070352 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0019213715637008573, "computeRatioMax": 0.0019213715637008573, "endMs": "1665778330827", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008867868755542418, "readRatioMax": 0.0008867868755542418, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778330786", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330:hd_demo_sk, $331:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$330, $331", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002069169376293231, "writeRatioMax": 0.002069169376293231 }, { "completedParallelInputs": "1", "computeMsAvg": "91", "computeMsMax": "91", "computeRatioAvg": 0.013449600945906, "computeRatioMax": 0.013449600945906, "endMs": "1665778330908", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0014779781259237363, "readRatioMax": 0.0014779781259237363, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "128", "startMs": "1665778330803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390:c_customer_sk, $391:c_current_cdemo_sk, $392:c_current_hdemo_sk, $393:c_current_addr_sk, $394:c_first_shipto_date_sk, $395:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$390, $391, $392, $393, $394, $395", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.00162577593851611, "writeRatioMax": 0.00162577593851611 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.007094295004433935, "computeRatioMax": 0.007094295004433935, "endMs": "1665778331172", "id": "25", "name": "S19: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008867868755542418, "readRatioMax": 0.0008867868755542418, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778331132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014779781259237363, "writeRatioMax": 0.0014779781259237363 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.0038427431274017146, "computeRatioMax": 0.0038427431274017146, "endMs": "1665778331185", "id": "26", "name": "S1A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008867868755542418, "readRatioMax": 0.0008867868755542418, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1314882", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778331151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0017735737511084836, "writeRatioMax": 0.0017735737511084836 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.00162577593851611, "computeRatioMax": 0.00162577593851611, "endMs": "1665778331230", "id": "27", "name": "S1B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007389890629618681, "readRatioMax": 0.0007389890629618681, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "339", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665778331168", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:s_store_sk, $41:s_store_name, $42:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "47", "writeMsMax": "47", "writeRatioAvg": 0.006946497191841561, "writeRatioMax": 0.006946497191841561 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0014779781259237363, "computeRatioMax": 0.0014779781259237363, "endMs": "1665778331215", "id": "28", "name": "S1C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008867868755542418, "readRatioMax": 0.0008867868755542418, "recordsRead": "300", "recordsWritten": "300", "shuffleOutputBytes": "2700", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778331182", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:p_promo_sk", "FROM promotion" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.002808158439255099, "writeRatioMax": 0.002808158439255099 }, { "completedParallelInputs": "1", "computeMsAvg": "53", "computeMsMax": "53", "computeRatioAvg": 0.007833284067395802, "computeRatioMax": 0.007833284067395802, "endMs": "1665778331261", "id": "29", "name": "S1D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008867868755542418, "readRatioMax": 0.0008867868755542418, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "83", "startMs": "1665778331197", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_street_number, $82:ca_street_name, $83:ca_city, $84:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014779781259237363, "writeRatioMax": 0.0014779781259237363 }, { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.006798699379249187, "computeRatioMax": 0.006798699379249187, "endMs": "1665778331265", "id": "30", "name": "S1E: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0007389890629618681, "readRatioMax": 0.0007389890629618681, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "2664408", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778331212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_street_number, $102:ca_street_name, $103:ca_city, $104:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0014779781259237363, "writeRatioMax": 0.0014779781259237363 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0010345846881466155, "computeRatioMax": 0.0010345846881466155, "endMs": "1665778331267", "id": "31", "name": "S1F: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005911912503694946, "readRatioMax": 0.0005911912503694946, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778331229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0022169671888856044, "writeRatioMax": 0.0022169671888856044 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0008867868755542418, "computeRatioMax": 0.0008867868755542418, "endMs": "1665778331281", "id": "32", "name": "S20: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005911912503694946, "readRatioMax": 0.0005911912503694946, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "180", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778331243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ib_income_band_sk", "FROM income_band" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage20_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.002512562814070352, "writeRatioMax": 0.002512562814070352 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.005172923440733077, "computeRatioMax": 0.005172923440733077, "endMs": "1665778331299", "id": "33", "inputStages": [ "5" ], "name": "S21: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17862", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665778331258", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $460, $461", "FROM __stage05_output" ] }, { "kind": "FILTER", "substeps": [ "greater($440, multiply(NUMERIC<...>, $441))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670", "$440 := SUM($460)", "$441 := SUM($461)" ] }, { "kind": "WRITE", "substeps": [ "$680", "TO __stage21_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0011823825007389892, "writeRatioMax": 0.0011823825007389892 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0013301803133313626, "computeRatioMax": 0.0013301803133313626, "endMs": "1665778331313", "id": "34", "name": "S22: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008867868755542418, "readRatioMax": 0.0008867868755542418, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778331274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year", "FROM date_dim", "WHERE equal($161, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161", "TO __stage22_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002069169376293231, "writeRatioMax": 0.002069169376293231 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.00162577593851611, "computeRatioMax": 0.00162577593851611, "endMs": "1665778331335", "id": "35", "name": "S23: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008867868755542418, "readRatioMax": 0.0008867868755542418, "recordsRead": "18000", "recordsWritten": "5", "shuffleOutputBytes": "157", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778331290", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $193:i_product_name, $191:i_current_price, $192:i_color", "FROM item", "WHERE and(in($192, 'orange', 'lace', 'lawn', 'misty', 'blush', 'pink'), between($191, NUMERIC<...>, NUMERIC<...>), ...)" ] }, { "kind": "WRITE", "substeps": [ "$190, $193", "TO __stage23_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0017735737511084836, "writeRatioMax": 0.0017735737511084836 }, { "completedParallelInputs": "1", "computeMsAvg": "148", "computeMsMax": "148", "computeRatioAvg": 0.0218740762636713, "computeRatioMax": 0.0218740762636713, "endMs": "1665778331424", "id": "36", "name": "S24: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011823825007389892, "readRatioMax": 0.0011823825007389892, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "5175252", "shuffleOutputBytesSpilled": "0", "slotMs": "143", "startMs": "1665778331305", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:sr_item_sk, $181:sr_ticket_number", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$180, $181", "TO __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.00162577593851611, "writeRatioMax": 0.00162577593851611 }, { "completedParallelInputs": "1", "computeMsAvg": "878", "computeMsMax": "878", "computeRatioAvg": 0.12976647945610406, "computeRatioMax": 0.12976647945610406, "endMs": "1665778331813", "id": "37", "name": "S25: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0011823825007389892, "readRatioMax": 0.0011823825007389892, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "558", "startMs": "1665778331320", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:cd_demo_sk, $221:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$220, $221", "TO __stage25_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "56", "writeMsMax": "56", "writeRatioAvg": 0.008276677505172924, "writeRatioMax": 0.008276677505172924 }, { "completedParallelInputs": "1", "computeMsAvg": "1521", "computeMsMax": "1521", "computeRatioAvg": 0.2248004729530003, "computeRatioMax": 0.2248004729530003, "endMs": "1665778332538", "id": "38", "name": "S26: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.0029559562518474726, "readRatioMax": 0.0029559562518474726, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "28812000", "shuffleOutputBytesSpilled": "0", "slotMs": "1671", "startMs": "1665778331337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$240:cd_demo_sk, $241:cd_marital_status", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$240, $241", "TO __stage26_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "157", "writeMsMax": "157", "writeRatioAvg": 0.02320425657700266, "writeRatioMax": 0.02320425657700266 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0011823825007389892, "computeRatioMax": 0.0011823825007389892, "endMs": "1665778331390", "id": "39", "name": "S27: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0005911912503694946, "readRatioMax": 0.0005911912503694946, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778331352", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300:hd_demo_sk, $301:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage27_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0022169671888856044, "writeRatioMax": 0.0022169671888856044 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0014779781259237363, "computeRatioMax": 0.0014779781259237363, "endMs": "1665778331406", "id": "40", "name": "S28: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0008867868755542418, "readRatioMax": 0.0008867868755542418, "recordsRead": "7200", "recordsWritten": "7200", "shuffleOutputBytes": "129600", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778331366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320:hd_demo_sk, $321:hd_income_band_sk", "FROM household_demographics" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage28_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0022169671888856044, "writeRatioMax": 0.0022169671888856044 }, { "completedParallelInputs": "1", "computeMsAvg": "89", "computeMsMax": "89", "computeRatioAvg": 0.013154005320721253, "computeRatioMax": 0.013154005320721253, "endMs": "1665778331484", "id": "41", "name": "S29: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0017735737511084836, "readRatioMax": 0.0017735737511084836, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "5289360", "shuffleOutputBytesSpilled": "0", "slotMs": "152", "startMs": "1665778331381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$360:c_customer_sk, $361:c_current_cdemo_sk, $362:c_current_hdemo_sk, $363:c_current_addr_sk, $364:c_first_shipto_date_sk, $365:c_first_sales_date_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$360, $361, $362, $363, $364, $365", "TO __stage29_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.002069169376293231, "writeRatioMax": 0.002069169376293231 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.0011823825007389892, "computeRatioMax": 0.0026603606266627253, "endMs": "1665778331464", "id": "44", "inputStages": [ "14" ], "name": "S2C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "4346", "startMs": "1665778331411", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0002955956251847473, "waitRatioMax": 0.0005911912503694946, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.0022169671888856044, "writeRatioMax": 0.003990540939994088 }, { "completedParallelInputs": "6", "computeMsAvg": "5687", "computeMsMax": "6766", "computeRatioAvg": 0.8405261602128289, "computeRatioMax": 1, "endMs": "1665778335656", "id": "45", "inputStages": [ "44", "18", "11", "12", "21", "6", "10", "19", "20", "22", "16", "8", "9", "15", "7", "13", "17" ], "name": "S2D: Join+", "parallelInputs": "6", "readMsAvg": "26", "readMsMax": "32", "readRatioAvg": 0.0038427431274017146, "readRatioMax": 0.004729530002955957, "recordsRead": "29661809", "recordsWritten": "11", "shuffleOutputBytes": "2546", "shuffleOutputBytesSpilled": "0", "slotMs": "43096", "startMs": "1665778331430", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370:ss_sold_date_sk, $371:ss_item_sk, $372:ss_customer_sk, $373:ss_cdemo_sk, $374:ss_hdemo_sk, $375:ss_addr_sk, $376:ss_store_sk, $377:ss_promo_sk, $378:ss_ticket_number, $379:ss_wholesale_cost, $380:ss_list_price, $381:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$390, $391, $392, $393, $394, $395", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$330, $331", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$310, $311", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$270, $271", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$200, $201", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$210, $213", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$1090", "FROM __stage2C_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$70", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1280 := $1273, $1281 := $1272, $1282 := $1261, $1283 := $1262, $1284 := $1263, $1285 := $1264, $1286 := $1265, $1287 := $1266, $1288 := $1267, $1289 := $1268, $1290 := $1269, $1291 := $1270, $1292 := $1271, $1293 := $1277, $1294 := $1260", "$430 := COUNT_STAR()", "$431 := SUM($1274)", "$432 := SUM($1275)", "$433 := SUM($1276)" ] }, { "kind": "JOIN", "substeps": [ "$1260 := $1257, $1261 := $1240, $1262 := $1241, $1263 := $1242, $1264 := $1243, $1265 := $1244, $1266 := $1245, $1267 := $1246, $1268 := $1247, $1269 := $1248, $1270 := $1249, $1271 := $1250, $1272 := $1251, $1273 := $1252, $1274 := $1253, $1275 := $1254", "INNER HASH JOIN EACH WITH ALL ON $1256 = $10" ] }, { "kind": "JOIN", "substeps": [ "$1240 := $1236, $1241 := $1237, $1242 := $1220, $1243 := $1221, $1244 := $1222, $1245 := $1223, $1246 := $1224, $1247 := $1225, $1248 := $1226, $1249 := $1227, $1250 := $1228, $1251 := $1229, $1252 := $1230, $1253 := $1231, $1254 := $1232, $1255 := $1233", "INNER HASH JOIN EACH WITH ALL ON $1234 = $30" ] }, { "kind": "JOIN", "substeps": [ "$1220 := $1200, $1221 := $1201, $1222 := $1202, $1223 := $1203, $1224 := $1204, $1225 := $1205, $1226 := $1206, $1227 := $1207, $1228 := $1208, $1229 := $1209, $1230 := $1210, $1231 := $1212, $1232 := $1213, $1233 := $1214, $1234 := $1215, $1235 := $1216", "INNER HASH JOIN EACH WITH ALL ON $1211 = $50" ] }, { "kind": "JOIN", "substeps": [ "$1200 := $1194, $1201 := $1195, $1202 := $1196, $1203 := $1197, $1204 := $1180, $1205 := $1181, $1206 := $1182, $1207 := $1183, $1208 := $1184, $1209 := $1185, $1210 := $1186, $1211 := $1187, $1212 := $1189, $1213 := $1190, $1214 := $1191, $1215 := $1192", "INNER HASH JOIN EACH WITH ALL ON $1188 = $70" ] }, { "kind": "JOIN", "substeps": [ "$1180 := $1171, $1181 := $1172, $1182 := $1173, $1183 := $1174, $1184 := $1160, $1185 := $1161, $1186 := $1162, $1187 := $1164, $1188 := $1165, $1189 := $1166, $1190 := $1167, $1191 := $1168, $1192 := $1169, $1193 := $1170, $1194 := $91, $1195 := $92", "INNER HASH JOIN EACH WITH ALL ON $1163 = $90" ] }, { "kind": "JOIN", "substeps": [ "$1160 := $1140, $1161 := $1141, $1162 := $1142, $1163 := $1143, $1164 := $1144, $1165 := $1145, $1166 := $1146, $1167 := $1147, $1168 := $1148, $1169 := $1150, $1170 := $1151, $1171 := $111, $1172 := $112, $1173 := $113, $1174 := $114", "INNER HASH JOIN EACH WITH ALL ON $1149 = $110" ] }, { "kind": "JOIN", "substeps": [ "$1140 := $1120, $1141 := $1121, $1142 := $1122, $1143 := $1124, $1144 := $1125, $1145 := $1126, $1146 := $1127, $1147 := $1128, $1148 := $1129, $1149 := $1130, $1150 := $1131, $1151 := $1132", "INNER HASH JOIN EACH WITH ALL ON $1123 = $130" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1100, $1121 := $1101, $1122 := $1102, $1123 := $1103, $1124 := $1105, $1125 := $1106, $1126 := $1107, $1127 := $1108, $1128 := $1109, $1129 := $1110, $1130 := $1111, $1131 := $1112, $1132 := $1113", "INNER HASH JOIN EACH WITH ALL ON $1104 = $150" ] }, { "kind": "JOIN", "substeps": [ "$1100 := $1064, $1101 := $1050, $1102 := $1051, $1103 := $1052, $1104 := $1053, $1105 := $1055, $1106 := $1056, $1107 := $1057, $1108 := $1058, $1109 := $1059, $1110 := $1060, $1111 := $1061, $1112 := $1062, $1113 := $1063", "INNER HASH JOIN EACH WITH ALL ON $1054 = $1090" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $1043, $1051 := $1044, $1052 := $1030, $1053 := $1031, $1054 := $1033, $1055 := $1034, $1056 := $1035, $1057 := $1036, $1058 := $1037, $1059 := $1038, $1060 := $1039, $1061 := $1040, $1062 := $1041, $1063 := $1042, $1064 := $171", "INNER HASH JOIN EACH WITH ALL ON $1032 = $170" ] }, { "kind": "JOIN", "substeps": [ "$1030 := $1010, $1031 := $1011, $1032 := $1012, $1033 := $1013, $1034 := $1014, $1035 := $1015, $1036 := $1016, $1037 := $1017, $1038 := $1018, $1039 := $1019, $1040 := $1020, $1041 := $1021, $1042 := $1022, $1043 := $210, $1044 := $213", "INNER HASH JOIN EACH WITH ALL ON $1013 = $210" ] }, { "kind": "JOIN", "substeps": [ "$1010 := $991, $1011 := $992, $1012 := $993, $1013 := $994, $1014 := $995, $1015 := $996, $1016 := $997, $1017 := $999, $1018 := $1000, $1019 := $1001, $1020 := $1002, $1021 := $1003, $1022 := $1004", "INNER HASH JOIN EACH WITH ALL ON $994 = $200, $998 = $201" ] }, { "kind": "FILTER", "substeps": [ "not_equal($1005, $990)" ] }, { "kind": "JOIN", "substeps": [ "$990 := $985, $991 := $970, $992 := $971, $993 := $972, $994 := $973, $995 := $975, $996 := $976, $997 := $977, $998 := $978, $999 := $979, $1000 := $980, $1001 := $981, $1002 := $982, $1003 := $983, $1004 := $984, $1005 := $231", "INNER HASH JOIN EACH WITH ALL ON $974 = $230" ] }, { "kind": "JOIN", "substeps": [ "$970 := $965, $971 := $950, $972 := $951, $973 := $952, $974 := $953, $975 := $954, $976 := $955, $977 := $956, $978 := $957, $979 := $958, $980 := $959, $981 := $960, $982 := $962, $983 := $963, $984 := $964, $985 := $271", "INNER HASH JOIN EACH WITH ALL ON $961 = $270" ] }, { "kind": "JOIN", "substeps": [ "$950 := $945, $951 := $930, $952 := $931, $953 := $932, $954 := $934, $955 := $935, $956 := $936, $957 := $937, $958 := $938, $959 := $939, $960 := $940, $961 := $941, $962 := $942, $963 := $943, $964 := $944, $965 := $311", "INNER HASH JOIN EACH WITH ALL ON $933 = $310" ] }, { "kind": "JOIN", "substeps": [ "$930 := $910, $931 := $911, $932 := $912, $933 := $913, $934 := $914, $935 := $915, $936 := $916, $937 := $917, $938 := $918, $939 := $919, $940 := $920, $941 := $921, $942 := $923, $943 := $924, $944 := $925, $945 := $331", "INNER HASH JOIN EACH WITH ALL ON $922 = $330" ] }, { "kind": "JOIN", "substeps": [ "$910 := $370, $911 := $371, $912 := $373, $913 := $374, $914 := $375, $915 := $376, $916 := $377, $917 := $378, $918 := $379, $919 := $380, $920 := $381, $921 := $391, $922 := $392, $923 := $393, $924 := $394, $925 := $395", "INNER HASH JOIN EACH WITH ALL ON $372 = $390" ] }, { "kind": "WRITE", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "TO __stage2D_output", "BY HASH($1280, $1281, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1293, $1294)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0002955956251847473, "waitRatioMax": 0.0004433934377771209, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.0010345846881466155, "writeRatioMax": 0.0011823825007389892 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.0013301803133313626, "computeRatioMax": 0.00325155187703222, "endMs": "1665778332803", "id": "47", "inputStages": [ "33" ], "name": "S2F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "17169", "recordsWritten": "17169", "shuffleOutputBytes": "154521", "shuffleOutputBytesSpilled": "0", "slotMs": "4547", "startMs": "1665778332728", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage21_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0002955956251847473, "waitRatioMax": 0.0005911912503694946, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.002069169376293231, "writeRatioMax": 0.0038427431274017146 }, { "completedParallelInputs": "6", "computeMsAvg": "4987", "computeMsMax": "6594", "computeRatioAvg": 0.7370676913981673, "computeRatioMax": 0.9745787762341117, "endMs": "1665778336464", "id": "48", "inputStages": [ "47", "31", "37", "29", "38", "40", "41", "28", "35", "32", "26", "39", "25", "30", "34", "36", "27" ], "name": "S30: Join+", "parallelInputs": "6", "readMsAvg": "25", "readMsMax": "32", "readRatioAvg": 0.0036949453148093407, "readRatioMax": 0.004729530002955957, "recordsRead": "29398184", "recordsWritten": "8", "shuffleOutputBytes": "1830", "shuffleOutputBytesSpilled": "0", "slotMs": "27915", "startMs": "1665778332746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$340:ss_sold_date_sk, $341:ss_item_sk, $342:ss_customer_sk, $343:ss_cdemo_sk, $344:ss_hdemo_sk, $345:ss_addr_sk, $346:ss_store_sk, $347:ss_promo_sk, $348:ss_ticket_number, $349:ss_wholesale_cost, $350:ss_list_price, $351:ss_coupon_amt", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$360, $361, $362, $363, $364, $365", "FROM __stage29_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage28_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage27_output" ] }, { "kind": "READ", "substeps": [ "$240, $241", "FROM __stage26_output" ] }, { "kind": "READ", "substeps": [ "$220, $221", "FROM __stage25_output" ] }, { "kind": "READ", "substeps": [ "$180, $181", "FROM __stage24_output" ] }, { "kind": "READ", "substeps": [ "$190, $193", "FROM __stage23_output" ] }, { "kind": "READ", "substeps": [ "$160, $161", "FROM __stage22_output" ] }, { "kind": "READ", "substeps": [ "$680", "FROM __stage2F_output" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84", "FROM __stage1D_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage19_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $870 := $863, $871 := $862, $872 := $851, $873 := $852, $874 := $853, $875 := $854, $876 := $855, $877 := $856, $878 := $857, $879 := $858, $880 := $859, $881 := $860, $882 := $861, $883 := $867, $884 := $850", "$420 := COUNT_STAR()", "$421 := SUM($864)", "$422 := SUM($865)", "$423 := SUM($866)" ] }, { "kind": "JOIN", "substeps": [ "$850 := $847, $851 := $830, $852 := $831, $853 := $832, $854 := $833, $855 := $834, $856 := $835, $857 := $836, $858 := $837, $859 := $838, $860 := $839, $861 := $840, $862 := $841, $863 := $842, $864 := $843, $865 := $844", "INNER HASH JOIN EACH WITH ALL ON $846 = $1" ] }, { "kind": "JOIN", "substeps": [ "$830 := $826, $831 := $827, $832 := $810, $833 := $811, $834 := $812, $835 := $813, $836 := $814, $837 := $815, $838 := $816, $839 := $817, $840 := $818, $841 := $819, $842 := $820, $843 := $821, $844 := $822, $845 := $823", "INNER HASH JOIN EACH WITH ALL ON $824 = $20" ] }, { "kind": "JOIN", "substeps": [ "$810 := $790, $811 := $791, $812 := $792, $813 := $793, $814 := $794, $815 := $795, $816 := $796, $817 := $797, $818 := $798, $819 := $799, $820 := $800, $821 := $802, $822 := $803, $823 := $804, $824 := $805, $825 := $806", "INNER HASH JOIN EACH WITH ALL ON $801 = $40" ] }, { "kind": "JOIN", "substeps": [ "$790 := $784, $791 := $785, $792 := $786, $793 := $787, $794 := $770, $795 := $771, $796 := $772, $797 := $773, $798 := $774, $799 := $775, $800 := $776, $801 := $777, $802 := $779, $803 := $780, $804 := $781, $805 := $782", "INNER HASH JOIN EACH WITH ALL ON $778 = $60" ] }, { "kind": "JOIN", "substeps": [ "$770 := $761, $771 := $762, $772 := $763, $773 := $764, $774 := $750, $775 := $751, $776 := $752, $777 := $754, $778 := $755, $779 := $756, $780 := $757, $781 := $758, $782 := $759, $783 := $760, $784 := $81, $785 := $82", "INNER HASH JOIN EACH WITH ALL ON $753 = $80" ] }, { "kind": "JOIN", "substeps": [ "$750 := $730, $751 := $731, $752 := $732, $753 := $733, $754 := $734, $755 := $735, $756 := $736, $757 := $737, $758 := $738, $759 := $740, $760 := $741, $761 := $101, $762 := $102, $763 := $103, $764 := $104", "INNER HASH JOIN EACH WITH ALL ON $739 = $100" ] }, { "kind": "JOIN", "substeps": [ "$730 := $710, $731 := $711, $732 := $712, $733 := $714, $734 := $715, $735 := $716, $736 := $717, $737 := $718, $738 := $719, $739 := $720, $740 := $721, $741 := $722", "INNER HASH JOIN EACH WITH ALL ON $713 = $120" ] }, { "kind": "JOIN", "substeps": [ "$710 := $690, $711 := $691, $712 := $692, $713 := $693, $714 := $695, $715 := $696, $716 := $697, $717 := $698, $718 := $699, $719 := $700, $720 := $701, $721 := $702, $722 := $703", "INNER HASH JOIN EACH WITH ALL ON $694 = $140" ] }, { "kind": "JOIN", "substeps": [ "$690 := $654, $691 := $640, $692 := $641, $693 := $642, $694 := $643, $695 := $645, $696 := $646, $697 := $647, $698 := $648, $699 := $649, $700 := $650, $701 := $651, $702 := $652, $703 := $653", "INNER HASH JOIN EACH WITH ALL ON $644 = $680" ] }, { "kind": "JOIN", "substeps": [ "$640 := $633, $641 := $634, $642 := $620, $643 := $621, $644 := $623, $645 := $624, $646 := $625, $647 := $626, $648 := $627, $649 := $628, $650 := $629, $651 := $630, $652 := $631, $653 := $632, $654 := $161", "INNER HASH JOIN EACH WITH ALL ON $622 = $160" ] }, { "kind": "JOIN", "substeps": [ "$620 := $600, $621 := $601, $622 := $602, $623 := $603, $624 := $604, $625 := $605, $626 := $606, $627 := $607, $628 := $608, $629 := $609, $630 := $610, $631 := $611, $632 := $612, $633 := $190, $634 := $193", "INNER HASH JOIN EACH WITH ALL ON $603 = $190" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $589, $608 := $590, $609 := $591, $610 := $592, $611 := $593, $612 := $594", "INNER HASH JOIN EACH WITH ALL ON $584 = $180, $588 = $181" ] }, { "kind": "FILTER", "substeps": [ "not_equal($595, $580)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $575, $581 := $560, $582 := $561, $583 := $562, $584 := $563, $585 := $565, $586 := $566, $587 := $567, $588 := $568, $589 := $569, $590 := $570, $591 := $571, $592 := $572, $593 := $573, $594 := $574, $595 := $221", "INNER HASH JOIN EACH WITH ALL ON $564 = $220" ] }, { "kind": "JOIN", "substeps": [ "$560 := $555, $561 := $540, $562 := $541, $563 := $542, $564 := $543, $565 := $544, $566 := $545, $567 := $546, $568 := $547, $569 := $548, $570 := $549, $571 := $550, $572 := $552, $573 := $553, $574 := $554, $575 := $241", "INNER HASH JOIN EACH WITH ALL ON $551 = $240" ] }, { "kind": "JOIN", "substeps": [ "$540 := $535, $541 := $520, $542 := $521, $543 := $522, $544 := $524, $545 := $525, $546 := $526, $547 := $527, $548 := $528, $549 := $529, $550 := $530, $551 := $531, $552 := $532, $553 := $533, $554 := $534, $555 := $301", "INNER HASH JOIN EACH WITH ALL ON $523 = $300" ] }, { "kind": "JOIN", "substeps": [ "$520 := $500, $521 := $501, $522 := $502, $523 := $503, $524 := $504, $525 := $505, $526 := $506, $527 := $507, $528 := $508, $529 := $509, $530 := $510, $531 := $511, $532 := $513, $533 := $514, $534 := $515, $535 := $321", "INNER HASH JOIN EACH WITH ALL ON $512 = $320" ] }, { "kind": "JOIN", "substeps": [ "$500 := $340, $501 := $341, $502 := $343, $503 := $344, $504 := $345, $505 := $346, $506 := $347, $507 := $348, $508 := $349, $509 := $350, $510 := $351, $511 := $361, $512 := $362, $513 := $363, $514 := $364, $515 := $365", "INNER HASH JOIN EACH WITH ALL ON $342 = $360" ] }, { "kind": "WRITE", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "TO __stage30_output", "BY HASH($870, $871, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $883, $884)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0002955956251847473, "waitRatioMax": 0.0005911912503694946, "writeMsAvg": "6", "writeMsMax": "10", "writeRatioAvg": 0.0008867868755542418, "writeRatioMax": 0.0014779781259237363 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0008867868755542418, "computeRatioMax": 0.0008867868755542418, "endMs": "1665778336747", "id": "49", "inputStages": [ "45" ], "name": "S31: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778336699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430", "FROM __stage2D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1300 := $1280, $1301 := $1281, $1302 := $1282, $1303 := $1283, $1304 := $1284, $1305 := $1285, $1306 := $1286, $1307 := $1287, $1308 := $1288, $1309 := $1289, $1310 := $1290, $1311 := $1291, $1312 := $1292, $1313 := $1293, $1314 := $1294", "$410 := SUM_OF_COUNTS($430)", "$411 := SUM($431)", "$412 := SUM($432)", "$413 := SUM($433)" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "TO __stage31_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "42", "writeMsMax": "42", "writeRatioAvg": 0.006207508128879693, "writeRatioMax": 0.006207508128879693 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.0011823825007389892, "computeRatioMax": 0.002069169376293231, "endMs": "1665778336806", "id": "51", "inputStages": [ "49" ], "name": "S33: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11", "recordsWritten": "11", "shuffleOutputBytes": "1067", "shuffleOutputBytesSpilled": "0", "slotMs": "6407", "startMs": "1665778336753", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage31_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0002955956251847473, "waitRatioMax": 0.0004433934377771209, "writeMsAvg": "22", "writeMsMax": "30", "writeRatioAvg": 0.00325155187703222, "writeRatioMax": 0.004433934377771209 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0013301803133313626, "computeRatioMax": 0.0013301803133313626, "endMs": "1665778336817", "id": "52", "inputStages": [ "51", "48" ], "name": "S34: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "19", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778336771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420", "FROM __stage30_output" ] }, { "kind": "READ", "substeps": [ "$410, $411, $412, $413, $1301, $1302, $1303, $1312", "FROM __stage33_output" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($1337, $1332)" ] }, { "kind": "JOIN", "substeps": [ "$1320 := $892, $1321 := $893, $1322 := $894, $1323 := $895, $1324 := $896, $1325 := $897, $1326 := $898, $1327 := $899, $1328 := $900, $1329 := $901, $1330 := $902, $1331 := $890, $1332 := $400, $1333 := $401, $1334 := $402, $1335 := $403", "INNER HASH JOIN EACH WITH ALL ON $891 = $1301, $892 = $1302, $893 = $1303" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $870, $891 := $871, $892 := $872, $893 := $873, $894 := $874, $895 := $875, $896 := $876, $897 := $877, $898 := $878, $899 := $879, $900 := $880, $901 := $881, $902 := $882, $903 := $883, $904 := $884", "$400 := SUM_OF_COUNTS($420)", "$401 := SUM($421)", "$402 := SUM($422)", "$403 := SUM($423)" ] }, { "kind": "WRITE", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "TO __stage34_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0002955956251847473, "writeRatioMax": 0.0002955956251847473 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0023647650014779783, "computeRatioMax": 0.0023647650014779783, "endMs": "1665778336866", "id": "53", "inputStages": [ "52" ], "name": "S35: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "2180", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778336822", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334", "FROM __stage34_output" ] }, { "kind": "SORT", "substeps": [ "$1331 ASC, $1320 ASC, $1337 ASC, $1333 ASC, $1338 ASC" ] }, { "kind": "WRITE", "substeps": [ "$1350, $1351, $1352, $1353, $1354, $1355, $1356, $1357, $1358, $1359, $1360, $1361, $1362, $1363, $1364, $1365", "TO __stage35_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00014779781259237365, "waitRatioMax": 0.00014779781259237365, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0022169671888856044, "writeRatioMax": 0.0022169671888856044 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "income_band" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "9", "elapsedMs": "688", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "4760" }, { "activeUnits": "14", "completedUnits": "144", "elapsedMs": "1782", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "17769" }, { "activeUnits": "13", "completedUnits": "246", "elapsedMs": "3160", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "48869" }, { "activeUnits": "13", "completedUnits": "247", "elapsedMs": "4614", "estimatedRunnableUnits": "1", "pendingUnits": "11", "totalSlotMs": "80074" }, { "activeUnits": "7", "completedUnits": "257", "elapsedMs": "6023", "estimatedRunnableUnits": "1", "pendingUnits": "1", "totalSlotMs": "102543" }, { "activeUnits": "2", "completedUnits": "361", "elapsedMs": "7139", "estimatedRunnableUnits": "1", "pendingUnits": "0", "totalSlotMs": "111110" } ], "totalBytesBilled": "422576128", "totalBytesProcessed": "421895625", "totalPartitionsProcessed": "0", "totalSlotMs": "111110", "transferredBytes": "0" }, "startTime": "1665778329783", "totalBytesProcessed": "421895625", "totalSlotMs": "111110" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
