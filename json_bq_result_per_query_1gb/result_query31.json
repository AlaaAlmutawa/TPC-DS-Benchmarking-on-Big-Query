{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2df63921_75f9_459d_90c0_34e4a6cd62a3" }, "priority": "INTERACTIVE", "query": "-- start query 31 in stream 0 using template query31.tpl\n\n/*\nList counties where the percentage growth in web sales is consistently higher compared to the percentage growth in store sales \nin the first three consecutive quarters for a given year.\n*/\n\nwith ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n ss1.ca_county\n ,ss1.d_year\n ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n ss ss1\n ,ss ss2\n ,ss ss3\n ,ws ws1\n ,ws ws2\n ,ws ws3\n where\n ss1.d_qoy = 1\n and ss1.d_year = 2000\n and ss1.ca_county = ss2.ca_county\n and ss2.d_qoy = 2\n and ss2.d_year = 2000\n and ss2.ca_county = ss3.ca_county\n and ss3.d_qoy = 3\n and ss3.d_year = 2000\n and ss1.ca_county = ws1.ca_county\n and ws1.d_qoy = 1\n and ws1.d_year = 2000\n and ws1.ca_county = ws2.ca_county\n and ws2.d_qoy = 2\n and ws2.d_year = 2000\n and ws1.ca_county = ws3.ca_county\n and ws3.d_qoy = 3\n and ws3.d_year =2000\n and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.ca_county; \n\n-- end query 31 in stream 0 using template query31.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Kny2QHB9XhrMPvXlBii1Nw==", "id": "test-project-364309:europe-west1.query31_1665768314", "jobReference": { "jobId": "query31_1665768314", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query31_1665768314?location=europe-west1", "statistics": { "creationTime": "1665768315140", "endTime": "1665768316650", "finalExecutionDurationMs": "1254", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113949473", "performanceInsights": { "avgPreviousExecutionMs": "959" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.10774410774410774, "computeRatioMax": 0.10774410774410774, "endMs": "1665768315363", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026936026936026935, "readRatioMax": 0.026936026936026935, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665768315302", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006734006734006734, "waitRatioMax": 0.006734006734006734, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.10101010101010101, "writeRatioMax": 0.10101010101010101 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.05387205387205387, "computeRatioMax": 0.05387205387205387, "endMs": "1665768315374", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026936026936026935, "readRatioMax": 0.026936026936026935, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665768315319", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year, $172:d_qoy", "FROM date_dim", "WHERE and(equal($172, 2), equal($171, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003367003367003367, "waitRatioMax": 0.003367003367003367, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.08080808080808081, "writeRatioMax": 0.08080808080808081 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.09090909090909091, "computeRatioMax": 0.09090909090909091, "endMs": "1665768315427", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020202020202020204, "readRatioMax": 0.020202020202020204, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "76", "startMs": "1665768315377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage03_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.030303030303030304, "waitRatioMax": 0.030303030303030304, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04040404040404041, "writeRatioMax": 0.04040404040404041 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.037037037037037035, "computeRatioMax": 0.037037037037037035, "endMs": "1665768315474", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016835016835016835, "readRatioMax": 0.016835016835016835, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665768315429", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year, $162:d_qoy", "FROM date_dim", "WHERE and(equal($162, 1), equal($161, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162", "TO __stage04_output" ] } ], "waitMsAvg": "38", "waitMsMax": "38", "waitRatioAvg": 0.12794612794612795, "waitRatioMax": 0.12794612794612795, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.06060606060606061 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.10774410774410774, "computeRatioMax": 0.10774410774410774, "endMs": "1665768315492", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030303030303030304, "readRatioMax": 0.030303030303030304, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "86", "startMs": "1665768315442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage06_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.037037037037037035, "waitRatioMax": 0.037037037037037035, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.037037037037037035, "writeRatioMax": 0.037037037037037035 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.037037037037037035, "computeRatioMax": 0.037037037037037035, "endMs": "1665768315527", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020202020202020204, "readRatioMax": 0.020202020202020204, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768315481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year, $152:d_qoy", "FROM date_dim", "WHERE and(equal($152, 3), equal($151, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152", "TO __stage07_output" ] } ], "waitMsAvg": "22", "waitMsMax": "22", "waitRatioAvg": 0.07407407407407407, "waitRatioMax": 0.07407407407407407, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.06060606060606061 }, { "completedParallelInputs": "1", "computeMsAvg": "49", "computeMsMax": "49", "computeRatioAvg": 0.16498316498316498, "computeRatioMax": 0.16498316498316498, "endMs": "1665768315558", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016835016835016835, "readRatioMax": 0.016835016835016835, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665768315506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006734006734006734, "waitRatioMax": 0.006734006734006734, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04040404040404041, "writeRatioMax": 0.04040404040404041 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04040404040404041, "computeRatioMax": 0.04040404040404041, "endMs": "1665768315601", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016835016835016835, "readRatioMax": 0.016835016835016835, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665768315531", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_year, $122:d_qoy", "FROM date_dim", "WHERE and(equal($122, 1), equal($121, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003367003367003367, "waitRatioMax": 0.003367003367003367, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.09764309764309764, "writeRatioMax": 0.09764309764309764 }, { "completedParallelInputs": "1", "computeMsAvg": "50", "computeMsMax": "50", "computeRatioAvg": 0.16835016835016836, "computeRatioMax": 0.16835016835016836, "endMs": "1665768315636", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03367003367003367, "readRatioMax": 0.03367003367003367, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665768315583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006734006734006734, "waitRatioMax": 0.006734006734006734, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04377104377104377, "writeRatioMax": 0.04377104377104377 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03367003367003367, "computeRatioMax": 0.03367003367003367, "endMs": "1665768315669", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020202020202020204, "readRatioMax": 0.020202020202020204, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665768315609", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_qoy", "FROM date_dim", "WHERE and(equal($82, 2), equal($81, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006734006734006734, "waitRatioMax": 0.006734006734006734, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.05723905723905724, "writeRatioMax": 0.05723905723905724 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.10774410774410774, "computeRatioMax": 0.10774410774410774, "endMs": "1665768315716", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030303030303030304, "readRatioMax": 0.030303030303030304, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665768315664", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.013468013468013467, "waitRatioMax": 0.013468013468013467, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.037037037037037035, "writeRatioMax": 0.037037037037037035 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03367003367003367, "computeRatioMax": 0.03367003367003367, "endMs": "1665768315758", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016835016835016835, "readRatioMax": 0.016835016835016835, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665768315701", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($32, 3), equal($31, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04713804713804714, "writeRatioMax": 0.04713804713804714 }, { "completedParallelInputs": "6", "computeMsAvg": "187", "computeMsMax": "266", "computeRatioAvg": 0.6296296296296297, "computeRatioMax": 0.8956228956228957, "endMs": "1665768315916", "id": "18", "inputStages": [ "1", "0" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "22", "readRatioAvg": 0.050505050505050504, "readRatioMax": 0.07407407407407407, "recordsRead": "3180950", "recordsWritten": "9550", "shuffleOutputBytes": "517376", "shuffleOutputBytesSpilled": "0", "slotMs": "1339", "startMs": "1665768315730", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_addr_sk, $142:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $373, $381 := $372, $382 := $371", "$300 := SUM($370)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $363, $373 := $101", "INNER HASH JOIN EACH WITH ALL ON $360 = $100" ] }, { "kind": "JOIN", "substeps": [ "$360 := $141, $361 := $142, $362 := $171, $363 := $172", "INNER HASH JOIN EACH WITH ALL ON $140 = $170" ] }, { "kind": "WRITE", "substeps": [ "$380, $382, $381, $300", "TO __stage12_output", "BY HASH($380, $381, $382)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.013468013468013467, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.016835016835016835, "writeRatioMax": 0.02356902356902357 }, { "completedParallelInputs": "6", "computeMsAvg": "202", "computeMsMax": "297", "computeRatioAvg": 0.6801346801346801, "computeRatioMax": 1, "endMs": "1665768315931", "id": "19", "inputStages": [ "3", "4" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "15", "readRatioAvg": 0.04713804713804714, "readRatioMax": 0.050505050505050504, "recordsRead": "3180950", "recordsWritten": "9770", "shuffleOutputBytes": "529269", "shuffleOutputBytesSpilled": "0", "slotMs": "1655", "startMs": "1665768315753", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ss_sold_date_sk, $131:ss_addr_sk, $132:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $323, $331 := $322, $332 := $321", "$290 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311, $321 := $312, $322 := $313, $323 := $91", "INNER HASH JOIN EACH WITH ALL ON $310 = $90" ] }, { "kind": "JOIN", "substeps": [ "$310 := $131, $311 := $132, $312 := $161, $313 := $162", "INNER HASH JOIN EACH WITH ALL ON $130 = $160" ] }, { "kind": "WRITE", "substeps": [ "$330, $332, $331, $290", "TO __stage13_output", "BY HASH($330, $331, $332)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006734006734006734, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.016835016835016835, "writeRatioMax": 0.020202020202020204 }, { "completedParallelInputs": "6", "computeMsAvg": "169", "computeMsMax": "209", "computeRatioAvg": 0.569023569023569, "computeRatioMax": 0.7037037037037037, "endMs": "1665768315926", "id": "20", "inputStages": [ "7", "6" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.04713804713804714, "readRatioMax": 0.05387205387205387, "recordsRead": "3180956", "recordsWritten": "10729", "shuffleOutputBytes": "581751", "shuffleOutputBytesSpilled": "0", "slotMs": "1304", "startMs": "1665768315794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ss_sold_date_sk, $111:ss_addr_sk, $112:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $433, $441 := $432, $442 := $431", "$280 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $61", "INNER HASH JOIN EACH WITH ALL ON $420 = $60" ] }, { "kind": "JOIN", "substeps": [ "$420 := $111, $421 := $112, $422 := $151, $423 := $152", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$440, $442, $441, $280", "TO __stage14_output", "BY HASH($440, $441, $442)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.013468013468013467, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.02356902356902357, "writeRatioMax": 0.026936026936026935 }, { "completedParallelInputs": "1", "computeMsAvg": "170", "computeMsMax": "170", "computeRatioAvg": 0.5723905723905723, "computeRatioMax": 0.5723905723905723, "endMs": "1665768315944", "id": "21", "inputStages": [ "10", "9" ], "name": "S15: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.04377104377104377, "readRatioMax": 0.04377104377104377, "recordsRead": "769475", "recordsWritten": "942", "shuffleOutputBytes": "50995", "shuffleOutputBytesSpilled": "0", "slotMs": "209", "startMs": "1665768315815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_addr_sk, $72:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $493, $501 := $492, $502 := $491", "$270 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482, $492 := $483, $493 := $41", "INNER HASH JOIN EACH WITH ALL ON $480 = $40" ] }, { "kind": "JOIN", "substeps": [ "$480 := $71, $481 := $72, $482 := $121, $483 := $122", "INNER HASH JOIN EACH WITH ALL ON $70 = $120" ] }, { "kind": "WRITE", "substeps": [ "$500, $502, $501, $270", "TO __stage15_output", "BY HASH($500, $501, $502)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003367003367003367, "waitRatioMax": 0.003367003367003367, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.020202020202020204, "writeRatioMax": 0.020202020202020204 }, { "completedParallelInputs": "1", "computeMsAvg": "196", "computeMsMax": "196", "computeRatioAvg": 0.6599326599326599, "computeRatioMax": 0.6599326599326599, "endMs": "1665768316016", "id": "22", "inputStages": [ "12", "13" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "26", "readMsMax": "26", "readRatioAvg": 0.08754208754208755, "readRatioMax": 0.08754208754208755, "recordsRead": "769475", "recordsWritten": "935", "shuffleOutputBytes": "50516", "shuffleOutputBytesSpilled": "0", "slotMs": "285", "startMs": "1665768315854", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_sold_date_sk, $51:ws_bill_addr_sk, $52:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $553, $561 := $552, $562 := $551", "$240 := SUM($550)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $543, $553 := $21", "INNER HASH JOIN EACH WITH ALL ON $540 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $51, $541 := $52, $542 := $81, $543 := $82", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$560, $562, $561, $240", "TO __stage16_output", "BY HASH($560, $561, $562)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.020202020202020204, "writeRatioMax": 0.020202020202020204 }, { "completedParallelInputs": "1", "computeMsAvg": "170", "computeMsMax": "170", "computeRatioAvg": 0.5723905723905723, "computeRatioMax": 0.5723905723905723, "endMs": "1665768316022", "id": "23", "inputStages": [ "15", "16" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.04377104377104377, "readRatioMax": 0.04377104377104377, "recordsRead": "769476", "recordsWritten": "1261", "shuffleOutputBytes": "68335", "shuffleOutputBytesSpilled": "0", "slotMs": "222", "startMs": "1665768315897", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_addr_sk, $12:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $613, $621 := $612, $622 := $611", "$210 := SUM($610)" ] }, { "kind": "JOIN", "substeps": [ "$610 := $601, $611 := $602, $612 := $603, $613 := $2", "INNER HASH JOIN EACH WITH ALL ON $600 = $1" ] }, { "kind": "JOIN", "substeps": [ "$600 := $11, $601 := $12, $602 := $31, $603 := $32", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$620, $622, $621, $210", "TO __stage17_output", "BY HASH($620, $621, $622)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006734006734006734, "waitRatioMax": 0.006734006734006734, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.020202020202020204, "writeRatioMax": 0.020202020202020204 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.037037037037037035, "computeRatioMax": 0.037037037037037035, "endMs": "1665768316137", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1261", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768316100", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $622, $621, $210", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622", "$190 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$190, $630", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006734006734006734, "waitRatioMax": 0.006734006734006734, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05387205387205387, "writeRatioMax": 0.05387205387205387 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03367003367003367, "computeRatioMax": 0.03367003367003367, "endMs": "1665768316166", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "935", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768316115", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $562, $561, $240", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$200 := SUM($240)" ] }, { "kind": "WRITE", "substeps": [ "$200, $570", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003367003367003367, "waitRatioMax": 0.003367003367003367, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.08754208754208755, "writeRatioMax": 0.08754208754208755 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03367003367003367, "computeRatioMax": 0.03367003367003367, "endMs": "1665768316194", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "942", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768316143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $502, $501, $270", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$220 := SUM($270)" ] }, { "kind": "WRITE", "substeps": [ "$220, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.013468013468013467, "waitRatioMax": 0.013468013468013467, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.09427609427609428, "writeRatioMax": 0.09427609427609428 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.04713804713804714, "computeRatioMax": 0.04713804713804714, "endMs": "1665768316208", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10729", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768316166", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $442, $441, $280", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442", "$230 := SUM($280)" ] }, { "kind": "WRITE", "substeps": [ "$230, $450", "TO __stage1B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.09427609427609428, "writeRatioMax": 0.09427609427609428 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.06397306397306397, "computeRatioMax": 0.06397306397306397, "endMs": "1665768316225", "id": "28", "inputStages": [ "18" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9550", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768316186", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $382, $381, $300", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382", "$260 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$260, $390", "TO __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.08754208754208755, "writeRatioMax": 0.08754208754208755 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.026936026936026935, "computeRatioMax": 0.05387205387205387, "endMs": "1665768316345", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1656", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "7064", "startMs": "1665768316246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "12", "waitMsMax": "20", "waitRatioAvg": 0.04040404040404041, "waitRatioMax": 0.06734006734006734, "writeMsAvg": "48", "writeMsMax": "70", "writeRatioAvg": 0.16161616161616163, "writeRatioMax": 0.2356902356902357 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.026936026936026935, "computeRatioMax": 0.06734006734006734, "endMs": "1665768316338", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1808", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "5904", "startMs": "1665768316249", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "23", "waitMsMax": "28", "waitRatioAvg": 0.07744107744107744, "waitRatioMax": 0.09427609427609428, "writeMsAvg": "28", "writeMsMax": "58", "writeRatioAvg": 0.09427609427609428, "writeRatioMax": 0.19528619528619529 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.026936026936026935, "computeRatioMax": 0.06060606060606061, "endMs": "1665768316336", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "941", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "3396", "startMs": "1665768316252", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "28", "waitMsMax": "32", "waitRatioAvg": 0.09427609427609428, "waitRatioMax": 0.10774410774410774, "writeMsAvg": "6", "writeMsMax": "66", "writeRatioAvg": 0.020202020202020204, "writeRatioMax": 0.2222222222222222 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.02356902356902357, "computeRatioMax": 0.04713804713804714, "endMs": "1665768316338", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "934", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "2282", "startMs": "1665768316248", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "36", "waitMsMax": "43", "waitRatioAvg": 0.12121212121212122, "waitRatioMax": 0.1447811447811448, "writeMsAvg": "6", "writeMsMax": "68", "writeRatioAvg": 0.020202020202020204, "writeRatioMax": 0.22895622895622897 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "19", "computeRatioAvg": 0.02356902356902357, "computeRatioMax": 0.06397306397306397, "endMs": "1665768316347", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1260", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "2343", "startMs": "1665768316252", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "41", "waitMsMax": "48", "waitRatioAvg": 0.13804713804713806, "waitRatioMax": 0.16161616161616163, "writeMsAvg": "5", "writeMsMax": "65", "writeRatioAvg": 0.016835016835016835, "writeRatioMax": 0.21885521885521886 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.11447811447811448, "computeRatioMax": 0.11447811447811448, "endMs": "1665768316402", "id": "35", "inputStages": [ "31", "33", "34", "30", "19", "32" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16369", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "92", "startMs": "1665768316306", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $332, $331, $290", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$260, $390", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$230, $450", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$220, $510", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$200, $570", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$190, $630", "FROM __stage22_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($642, $643)", "$181 := divide($646, $645)", "$182 := divide($647, $642)", "$183 := divide($644, $646)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($642, NUMERIC<...>), divide($647, $642), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$640 := $581, $641 := $582, $642 := $587, $643 := $583, $644 := $584, $645 := $585, $646 := $586, $647 := $190", "INNER HASH JOIN EACH WITH ALL ON $580 = $630" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($583, NUMERIC<...>), divide($587, $583), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $525, $581 := $520, $582 := $521, $583 := $526, $584 := $522, $585 := $523, $586 := $524, $587 := $200", "INNER HASH JOIN EACH WITH ALL ON $525 = $570" ] }, { "kind": "JOIN", "substeps": [ "$520 := $460, $521 := $461, $522 := $464, $523 := $462, $524 := $463, $525 := $510, $526 := $220", "INNER HASH JOIN EACH WITH ALL ON $460 = $510" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $404, $464 := $230", "INNER HASH JOIN EACH WITH ALL ON $403 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $340, $401 := $342, $402 := $250, $403 := $390, $404 := $260", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330, $341 := $331, $342 := $332", "$250 := SUM($290)" ] }, { "kind": "WRITE", "substeps": [ "$640, $641, $180, $181, $182, $183", "TO __stage23_output" ] } ], "waitMsAvg": "19", "waitMsMax": "19", "waitRatioAvg": 0.06397306397306397, "waitRatioMax": 0.06397306397306397, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013468013468013467, "writeRatioMax": 0.013468013468013467 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02356902356902357, "computeRatioMax": 0.02356902356902357, "endMs": "1665768316490", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768316444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$640, $641, $180, $181, $182, $183", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654, $655", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006734006734006734, "waitRatioMax": 0.006734006734006734, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.07744107744107744, "writeRatioMax": 0.07744107744107744 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "20", "completedUnits": "12", "elapsedMs": "622", "estimatedRunnableUnits": "0", "pendingUnits": "21", "totalSlotMs": "7121" }, { "activeUnits": "423", "completedUnits": "540", "elapsedMs": "1421", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "33247" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113949473", "totalPartitionsProcessed": "0", "totalSlotMs": "33247", "transferredBytes": "0" }, "startTime": "1665768315182", "totalBytesProcessed": "113949473", "totalSlotMs": "33247" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon47a4afa7_cdf4_4cec_91a9_c73abdfcb87c" }, "priority": "INTERACTIVE", "query": "-- start query 31 in stream 0 using template query31.tpl\n\n/*\nList counties where the percentage growth in web sales is consistently higher compared to the percentage growth in store sales \nin the first three consecutive quarters for a given year.\n*/\n\nwith ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n ss1.ca_county\n ,ss1.d_year\n ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n ss ss1\n ,ss ss2\n ,ss ss3\n ,ws ws1\n ,ws ws2\n ,ws ws3\n where\n ss1.d_qoy = 1\n and ss1.d_year = 2000\n and ss1.ca_county = ss2.ca_county\n and ss2.d_qoy = 2\n and ss2.d_year = 2000\n and ss2.ca_county = ss3.ca_county\n and ss3.d_qoy = 3\n and ss3.d_year = 2000\n and ss1.ca_county = ws1.ca_county\n and ws1.d_qoy = 1\n and ws1.d_year = 2000\n and ws1.ca_county = ws2.ca_county\n and ws2.d_qoy = 2\n and ws2.d_year = 2000\n and ws1.ca_county = ws3.ca_county\n and ws3.d_qoy = 3\n and ws3.d_year =2000\n and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.ca_county; \n\n-- end query 31 in stream 0 using template query31.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "N7r06rttOmazPLUEI3kyNA==", "id": "test-project-364309:europe-west1.query31_1665777262", "jobReference": { "jobId": "query31_1665777262", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query31_1665777262?location=europe-west1", "statistics": { "creationTime": "1665777263512", "endTime": "1665777264550", "finalExecutionDurationMs": "790", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113949473", "performanceInsights": { "avgPreviousExecutionMs": "1057" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.1, "computeRatioMax": 0.1, "endMs": "1665777263716", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777263684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03461538461538462, "writeRatioMax": 0.03461538461538462 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.046153846153846156, "computeRatioMax": 0.046153846153846156, "endMs": "1665777263740", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.023076923076923078, "readRatioMax": 0.023076923076923078, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777263697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year, $172:d_qoy", "FROM date_dim", "WHERE and(equal($172, 2), equal($171, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.057692307692307696, "writeRatioMax": 0.057692307692307696 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.09615384615384616, "computeRatioMax": 0.09615384615384616, "endMs": "1665777263762", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777263725", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05384615384615385, "writeRatioMax": 0.05384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.057692307692307696, "computeRatioMax": 0.057692307692307696, "endMs": "1665777263776", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03076923076923077, "readRatioMax": 0.03076923076923077, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777263740", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year, $162:d_qoy", "FROM date_dim", "WHERE and(equal($162, 1), equal($161, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03076923076923077, "writeRatioMax": 0.03076923076923077 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.12692307692307692, "computeRatioMax": 0.12692307692307692, "endMs": "1665777263807", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.015384615384615385, "readRatioMax": 0.015384615384615385, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777263766", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06153846153846154, "writeRatioMax": 0.06153846153846154 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.06923076923076923, "computeRatioMax": 0.06923076923076923, "endMs": "1665777263818", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03076923076923077, "readRatioMax": 0.03076923076923077, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777263779", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year, $152:d_qoy", "FROM date_dim", "WHERE and(equal($152, 3), equal($151, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.026923076923076925, "writeRatioMax": 0.026923076923076925 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.1076923076923077, "computeRatioMax": 0.1076923076923077, "endMs": "1665777263839", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.023076923076923078, "readRatioMax": 0.023076923076923078, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777263806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03461538461538462, "writeRatioMax": 0.03461538461538462 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03076923076923077, "computeRatioMax": 0.03076923076923077, "endMs": "1665777263848", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777263823", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_year, $122:d_qoy", "FROM date_dim", "WHERE and(equal($122, 1), equal($121, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05384615384615385, "writeRatioMax": 0.05384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.16153846153846155, "computeRatioMax": 0.16153846153846155, "endMs": "1665777263899", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.038461538461538464, "readRatioMax": 0.038461538461538464, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777263850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05384615384615385, "writeRatioMax": 0.05384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.046153846153846156, "computeRatioMax": 0.046153846153846156, "endMs": "1665777263902", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.026923076923076925, "readRatioMax": 0.026923076923076925, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777263866", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_qoy", "FROM date_dim", "WHERE and(equal($82, 2), equal($81, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03076923076923077, "writeRatioMax": 0.03076923076923077 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.1, "computeRatioMax": 0.1, "endMs": "1665777263929", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.023076923076923078, "readRatioMax": 0.023076923076923078, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777263893", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05384615384615385, "writeRatioMax": 0.05384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05, "computeRatioMax": 0.05, "endMs": "1665777263937", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.05, "readRatioMax": 0.05, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777263908", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($32, 3), equal($31, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.019230769230769232 }, { "completedParallelInputs": "6", "computeMsAvg": "183", "computeMsMax": "251", "computeRatioAvg": 0.7038461538461539, "computeRatioMax": 0.9653846153846154, "endMs": "1665777264081", "id": "18", "inputStages": [ "1", "0" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "32", "readRatioAvg": 0.06538461538461539, "readRatioMax": 0.12307692307692308, "recordsRead": "3180950", "recordsWritten": "9550", "shuffleOutputBytes": "517376", "shuffleOutputBytesSpilled": "0", "slotMs": "1011", "startMs": "1665777263925", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_addr_sk, $142:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $373, $381 := $372, $382 := $371", "$300 := SUM($370)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $363, $373 := $101", "INNER HASH JOIN EACH WITH ALL ON $360 = $100" ] }, { "kind": "JOIN", "substeps": [ "$360 := $141, $361 := $142, $362 := $171, $363 := $172", "INNER HASH JOIN EACH WITH ALL ON $140 = $170" ] }, { "kind": "WRITE", "substeps": [ "$380, $382, $381, $300", "TO __stage12_output", "BY HASH($380, $381, $382)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.015384615384615385, "writeRatioMax": 0.015384615384615385 }, { "completedParallelInputs": "6", "computeMsAvg": "157", "computeMsMax": "186", "computeRatioAvg": 0.6038461538461538, "computeRatioMax": 0.7153846153846154, "endMs": "1665777264056", "id": "19", "inputStages": [ "4", "3" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "22", "readRatioAvg": 0.05, "readRatioMax": 0.08461538461538462, "recordsRead": "3180950", "recordsWritten": "9770", "shuffleOutputBytes": "529269", "shuffleOutputBytesSpilled": "0", "slotMs": "873", "startMs": "1665777263931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ss_sold_date_sk, $131:ss_addr_sk, $132:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $323, $331 := $322, $332 := $321", "$290 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311, $321 := $312, $322 := $313, $323 := $91", "INNER HASH JOIN EACH WITH ALL ON $310 = $90" ] }, { "kind": "JOIN", "substeps": [ "$310 := $131, $311 := $132, $312 := $161, $313 := $162", "INNER HASH JOIN EACH WITH ALL ON $130 = $160" ] }, { "kind": "WRITE", "substeps": [ "$330, $332, $331, $290", "TO __stage13_output", "BY HASH($330, $331, $332)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.015384615384615385, "writeRatioMax": 0.019230769230769232 }, { "completedParallelInputs": "6", "computeMsAvg": "172", "computeMsMax": "247", "computeRatioAvg": 0.6615384615384615, "computeRatioMax": 0.95, "endMs": "1665777264093", "id": "20", "inputStages": [ "7", "6" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.046153846153846156, "readRatioMax": 0.06153846153846154, "recordsRead": "3180956", "recordsWritten": "10729", "shuffleOutputBytes": "581751", "shuffleOutputBytesSpilled": "0", "slotMs": "954", "startMs": "1665777263948", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ss_sold_date_sk, $111:ss_addr_sk, $112:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $433, $441 := $432, $442 := $431", "$280 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $61", "INNER HASH JOIN EACH WITH ALL ON $420 = $60" ] }, { "kind": "JOIN", "substeps": [ "$420 := $111, $421 := $112, $422 := $151, $423 := $152", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$440, $442, $441, $280", "TO __stage14_output", "BY HASH($440, $441, $442)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.023076923076923078, "writeRatioMax": 0.03461538461538462 }, { "completedParallelInputs": "1", "computeMsAvg": "215", "computeMsMax": "215", "computeRatioAvg": 0.8269230769230769, "computeRatioMax": 0.8269230769230769, "endMs": "1665777264100", "id": "21", "inputStages": [ "9", "10" ], "name": "S15: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.05384615384615385, "readRatioMax": 0.05384615384615385, "recordsRead": "769475", "recordsWritten": "942", "shuffleOutputBytes": "50995", "shuffleOutputBytesSpilled": "0", "slotMs": "175", "startMs": "1665777263961", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_addr_sk, $72:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $493, $501 := $492, $502 := $491", "$270 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482, $492 := $483, $493 := $41", "INNER HASH JOIN EACH WITH ALL ON $480 = $40" ] }, { "kind": "JOIN", "substeps": [ "$480 := $71, $481 := $72, $482 := $121, $483 := $122", "INNER HASH JOIN EACH WITH ALL ON $70 = $120" ] }, { "kind": "WRITE", "substeps": [ "$500, $502, $501, $270", "TO __stage15_output", "BY HASH($500, $501, $502)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.019230769230769232 }, { "completedParallelInputs": "1", "computeMsAvg": "187", "computeMsMax": "187", "computeRatioAvg": 0.7192307692307692, "computeRatioMax": 0.7192307692307692, "endMs": "1665777264150", "id": "22", "inputStages": [ "13", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.13846153846153847, "readRatioMax": 0.13846153846153847, "recordsRead": "769475", "recordsWritten": "935", "shuffleOutputBytes": "50516", "shuffleOutputBytesSpilled": "0", "slotMs": "234", "startMs": "1665777263978", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_sold_date_sk, $51:ws_bill_addr_sk, $52:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $553, $561 := $552, $562 := $551", "$240 := SUM($550)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $543, $553 := $21", "INNER HASH JOIN EACH WITH ALL ON $540 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $51, $541 := $52, $542 := $81, $543 := $82", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$560, $562, $561, $240", "TO __stage16_output", "BY HASH($560, $561, $562)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007692307692307693, "waitRatioMax": 0.007692307692307693, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03461538461538462, "writeRatioMax": 0.03461538461538462 }, { "completedParallelInputs": "1", "computeMsAvg": "260", "computeMsMax": "260", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777264111", "id": "23", "inputStages": [ "16", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.04230769230769231, "readRatioMax": 0.04230769230769231, "recordsRead": "769476", "recordsWritten": "1261", "shuffleOutputBytes": "68335", "shuffleOutputBytesSpilled": "0", "slotMs": "133", "startMs": "1665777263990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_addr_sk, $12:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $613, $621 := $612, $622 := $611", "$210 := SUM($610)" ] }, { "kind": "JOIN", "substeps": [ "$610 := $601, $611 := $602, $612 := $603, $613 := $2", "INNER HASH JOIN EACH WITH ALL ON $600 = $1" ] }, { "kind": "JOIN", "substeps": [ "$600 := $11, $601 := $12, $602 := $31, $603 := $32", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$620, $622, $621, $210", "TO __stage17_output", "BY HASH($620, $621, $622)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.019230769230769232 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.038461538461538464, "computeRatioMax": 0.038461538461538464, "endMs": "1665777264210", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1261", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777264174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $622, $621, $210", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622", "$190 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$190, $630", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05384615384615385, "writeRatioMax": 0.05384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.046153846153846156, "computeRatioMax": 0.046153846153846156, "endMs": "1665777264226", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "935", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777264188", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $562, $561, $240", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$200 := SUM($240)" ] }, { "kind": "WRITE", "substeps": [ "$200, $570", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06153846153846154, "writeRatioMax": 0.06153846153846154 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05, "computeRatioMax": 0.05, "endMs": "1665777264237", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "942", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777264202", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $502, $501, $270", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$220 := SUM($270)" ] }, { "kind": "WRITE", "substeps": [ "$220, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05384615384615385, "writeRatioMax": 0.05384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03461538461538462, "computeRatioMax": 0.03461538461538462, "endMs": "1665777264249", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10729", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777264216", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $442, $441, $280", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442", "$230 := SUM($280)" ] }, { "kind": "WRITE", "substeps": [ "$230, $450", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.09230769230769231, "writeRatioMax": 0.09230769230769231 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04230769230769231, "computeRatioMax": 0.04230769230769231, "endMs": "1665777264267", "id": "28", "inputStages": [ "18" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9550", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777264230", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $382, $381, $300", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382", "$260 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$260, $390", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038461538461538464, "waitRatioMax": 0.0038461538461538464, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05384615384615385, "writeRatioMax": 0.05384615384615385 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.03461538461538462, "computeRatioMax": 0.07692307692307693, "endMs": "1665777264346", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1656", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "3598", "startMs": "1665777264285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.015384615384615385, "waitRatioMax": 0.023076923076923078, "writeMsAvg": "19", "writeMsMax": "31", "writeRatioAvg": 0.07307692307692308, "writeRatioMax": 0.11923076923076924 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "18", "computeRatioAvg": 0.026923076923076925, "computeRatioMax": 0.06923076923076923, "endMs": "1665777264344", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1808", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "2931", "startMs": "1665777264285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.023076923076923078, "waitRatioMax": 0.03076923076923077, "writeMsAvg": "13", "writeMsMax": "30", "writeRatioAvg": 0.05, "writeRatioMax": 0.11538461538461539 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.026923076923076925, "computeRatioMax": 0.046153846153846156, "endMs": "1665777264346", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "941", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "2608", "startMs": "1665777264285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.03076923076923077, "waitRatioMax": 0.038461538461538464, "writeMsAvg": "12", "writeMsMax": "30", "writeRatioAvg": 0.046153846153846156, "writeRatioMax": 0.11538461538461539 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.026923076923076925, "computeRatioMax": 0.06153846153846154, "endMs": "1665777264346", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "934", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "2417", "startMs": "1665777264286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.03461538461538462, "waitRatioMax": 0.04230769230769231, "writeMsAvg": "5", "writeMsMax": "27", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.10384615384615385 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.03076923076923077, "computeRatioMax": 0.07307692307692308, "endMs": "1665777264354", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1260", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "2656", "startMs": "1665777264286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.038461538461538464, "waitRatioMax": 0.046153846153846156, "writeMsAvg": "5", "writeMsMax": "29", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.11153846153846154 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.09230769230769231, "computeRatioMax": 0.09230769230769231, "endMs": "1665777264387", "id": "35", "inputStages": [ "19", "30", "31", "33", "32", "34" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16369", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777264312", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $332, $331, $290", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$260, $390", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$230, $450", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$220, $510", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$200, $570", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$190, $630", "FROM __stage22_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($642, $643)", "$181 := divide($646, $645)", "$182 := divide($647, $642)", "$183 := divide($644, $646)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($642, NUMERIC<...>), divide($647, $642), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$640 := $581, $641 := $582, $642 := $587, $643 := $583, $644 := $584, $645 := $585, $646 := $586, $647 := $190", "INNER HASH JOIN EACH WITH ALL ON $580 = $630" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($583, NUMERIC<...>), divide($587, $583), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $525, $581 := $520, $582 := $521, $583 := $526, $584 := $522, $585 := $523, $586 := $524, $587 := $200", "INNER HASH JOIN EACH WITH ALL ON $525 = $570" ] }, { "kind": "JOIN", "substeps": [ "$520 := $460, $521 := $461, $522 := $464, $523 := $462, $524 := $463, $525 := $510, $526 := $220", "INNER HASH JOIN EACH WITH ALL ON $460 = $510" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $404, $464 := $230", "INNER HASH JOIN EACH WITH ALL ON $403 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $340, $401 := $342, $402 := $250, $403 := $390, $404 := $260", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330, $341 := $331, $342 := $332", "$250 := SUM($290)" ] }, { "kind": "WRITE", "substeps": [ "$640, $641, $180, $181, $182, $183", "TO __stage23_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.015384615384615385, "waitRatioMax": 0.015384615384615385, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.015384615384615385, "writeRatioMax": 0.015384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03461538461538462, "computeRatioMax": 0.03461538461538462, "endMs": "1665777264429", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777264402", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$640, $641, $180, $181, $182, $183", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654, $655", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007692307692307693, "waitRatioMax": 0.007692307692307693, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06153846153846154, "writeRatioMax": 0.06153846153846154 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "33", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "5142" }, { "activeUnits": "1", "completedUnits": "540", "elapsedMs": "917", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "19566" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113949473", "totalPartitionsProcessed": "0", "totalSlotMs": "19566", "transferredBytes": "0" }, "startTime": "1665777263574", "totalBytesProcessed": "113949473", "totalSlotMs": "19566" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3e401869_7d93_4b71_969d_7aba51b670a7" }, "priority": "INTERACTIVE", "query": "-- start query 31 in stream 0 using template query31.tpl\n\n/*\nList counties where the percentage growth in web sales is consistently higher compared to the percentage growth in store sales \nin the first three consecutive quarters for a given year.\n*/\n\nwith ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n ss1.ca_county\n ,ss1.d_year\n ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n ss ss1\n ,ss ss2\n ,ss ss3\n ,ws ws1\n ,ws ws2\n ,ws ws3\n where\n ss1.d_qoy = 1\n and ss1.d_year = 2000\n and ss1.ca_county = ss2.ca_county\n and ss2.d_qoy = 2\n and ss2.d_year = 2000\n and ss2.ca_county = ss3.ca_county\n and ss3.d_qoy = 3\n and ss3.d_year = 2000\n and ss1.ca_county = ws1.ca_county\n and ws1.d_qoy = 1\n and ws1.d_year = 2000\n and ws1.ca_county = ws2.ca_county\n and ws2.d_qoy = 2\n and ws2.d_year = 2000\n and ws1.ca_county = ws3.ca_county\n and ws3.d_qoy = 3\n and ws3.d_year =2000\n and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.ca_county; \n\n-- end query 31 in stream 0 using template query31.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "CcShfjD2nOrl4W6AM+KECQ==", "id": "test-project-364309:europe-west1.query31_1665777265", "jobReference": { "jobId": "query31_1665777265", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query31_1665777265?location=europe-west1", "statistics": { "creationTime": "1665777266175", "endTime": "1665777267452", "finalExecutionDurationMs": "1011", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113949473", "performanceInsights": { "avgPreviousExecutionMs": "991" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.09688581314878893, "computeRatioMax": 0.09688581314878893, "endMs": "1665777266403", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02422145328719723, "readRatioMax": 0.02422145328719723, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777266363", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04844290657439446, "writeRatioMax": 0.04844290657439446 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.05536332179930796, "computeRatioMax": 0.05536332179930796, "endMs": "1665777266425", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03460207612456748, "readRatioMax": 0.03460207612456748, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777266379", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year, $172:d_qoy", "FROM date_dim", "WHERE and(equal($172, 2), equal($171, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04152249134948097, "writeRatioMax": 0.04152249134948097 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.11764705882352941, "computeRatioMax": 0.11764705882352941, "endMs": "1665777266517", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020761245674740483, "readRatioMax": 0.020761245674740483, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777266481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03806228373702422, "writeRatioMax": 0.03806228373702422 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02768166089965398, "computeRatioMax": 0.02768166089965398, "endMs": "1665777266539", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01730103806228374, "readRatioMax": 0.01730103806228374, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777266499", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year, $162:d_qoy", "FROM date_dim", "WHERE and(equal($162, 1), equal($161, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04844290657439446, "writeRatioMax": 0.04844290657439446 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.11764705882352941, "computeRatioMax": 0.11764705882352941, "endMs": "1665777266571", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020761245674740483, "readRatioMax": 0.020761245674740483, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777266531", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03806228373702422, "writeRatioMax": 0.03806228373702422 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02768166089965398, "computeRatioMax": 0.02768166089965398, "endMs": "1665777266577", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020761245674740483, "readRatioMax": 0.020761245674740483, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777266547", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year, $152:d_qoy", "FROM date_dim", "WHERE and(equal($152, 3), equal($151, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05536332179930796, "writeRatioMax": 0.05536332179930796 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.1245674740484429, "computeRatioMax": 0.1245674740484429, "endMs": "1665777266617", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02768166089965398, "readRatioMax": 0.02768166089965398, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777266577", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04152249134948097, "writeRatioMax": 0.04152249134948097 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04152249134948097, "computeRatioMax": 0.04152249134948097, "endMs": "1665777266627", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01384083044982699, "readRatioMax": 0.01384083044982699, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777266592", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_year, $122:d_qoy", "FROM date_dim", "WHERE and(equal($122, 1), equal($121, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04498269896193772, "writeRatioMax": 0.04498269896193772 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.14186851211072665, "computeRatioMax": 0.14186851211072665, "endMs": "1665777266659", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02422145328719723, "readRatioMax": 0.02422145328719723, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777266621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.031141868512110725, "writeRatioMax": 0.031141868512110725 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.05190311418685121, "computeRatioMax": 0.05190311418685121, "endMs": "1665777266678", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02422145328719723, "readRatioMax": 0.02422145328719723, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777266637", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_qoy", "FROM date_dim", "WHERE and(equal($82, 2), equal($81, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04844290657439446, "writeRatioMax": 0.04844290657439446 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.12802768166089964, "computeRatioMax": 0.12802768166089964, "endMs": "1665777266712", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02768166089965398, "readRatioMax": 0.02768166089965398, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777266667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04498269896193772, "writeRatioMax": 0.04498269896193772 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04152249134948097, "computeRatioMax": 0.04152249134948097, "endMs": "1665777266728", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020761245674740483, "readRatioMax": 0.020761245674740483, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777266687", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($32, 3), equal($31, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05190311418685121, "writeRatioMax": 0.05190311418685121 }, { "completedParallelInputs": "6", "computeMsAvg": "173", "computeMsMax": "223", "computeRatioAvg": 0.5986159169550173, "computeRatioMax": 0.7716262975778547, "endMs": "1665777266885", "id": "18", "inputStages": [ "0", "1" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "26", "readRatioAvg": 0.06228373702422145, "readRatioMax": 0.08996539792387544, "recordsRead": "3180950", "recordsWritten": "9550", "shuffleOutputBytes": "517376", "shuffleOutputBytesSpilled": "0", "slotMs": "1027", "startMs": "1665777266712", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_addr_sk, $142:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $373, $381 := $372, $382 := $371", "$300 := SUM($370)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $363, $373 := $101", "INNER HASH JOIN EACH WITH ALL ON $360 = $100" ] }, { "kind": "JOIN", "substeps": [ "$360 := $141, $361 := $142, $362 := $171, $363 := $172", "INNER HASH JOIN EACH WITH ALL ON $140 = $170" ] }, { "kind": "WRITE", "substeps": [ "$380, $382, $381, $300", "TO __stage12_output", "BY HASH($380, $381, $382)" ] } ], "waitMsAvg": "9", "waitMsMax": "12", "waitRatioAvg": 0.031141868512110725, "waitRatioMax": 0.04152249134948097, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.01730103806228374, "writeRatioMax": 0.02768166089965398 }, { "completedParallelInputs": "6", "computeMsAvg": "178", "computeMsMax": "204", "computeRatioAvg": 0.615916955017301, "computeRatioMax": 0.7058823529411765, "endMs": "1665777266886", "id": "19", "inputStages": [ "3", "4" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "31", "readRatioAvg": 0.06920415224913495, "readRatioMax": 0.10726643598615918, "recordsRead": "3180950", "recordsWritten": "9770", "shuffleOutputBytes": "529269", "shuffleOutputBytesSpilled": "0", "slotMs": "1137", "startMs": "1665777266729", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ss_sold_date_sk, $131:ss_addr_sk, $132:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $323, $331 := $322, $332 := $321", "$290 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311, $321 := $312, $322 := $313, $323 := $91", "INNER HASH JOIN EACH WITH ALL ON $310 = $90" ] }, { "kind": "JOIN", "substeps": [ "$310 := $131, $311 := $132, $312 := $161, $313 := $162", "INNER HASH JOIN EACH WITH ALL ON $130 = $160" ] }, { "kind": "WRITE", "substeps": [ "$330, $332, $331, $290", "TO __stage13_output", "BY HASH($330, $331, $332)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.01384083044982699, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.01730103806228374, "writeRatioMax": 0.02422145328719723 }, { "completedParallelInputs": "6", "computeMsAvg": "208", "computeMsMax": "289", "computeRatioAvg": 0.7197231833910035, "computeRatioMax": 1, "endMs": "1665777266955", "id": "20", "inputStages": [ "7", "6" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "26", "readRatioAvg": 0.06228373702422145, "readRatioMax": 0.08996539792387544, "recordsRead": "3180956", "recordsWritten": "10729", "shuffleOutputBytes": "581751", "shuffleOutputBytesSpilled": "0", "slotMs": "1134", "startMs": "1665777266749", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ss_sold_date_sk, $111:ss_addr_sk, $112:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $433, $441 := $432, $442 := $431", "$280 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $61", "INNER HASH JOIN EACH WITH ALL ON $420 = $60" ] }, { "kind": "JOIN", "substeps": [ "$420 := $111, $421 := $112, $422 := $151, $423 := $152", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$440, $442, $441, $280", "TO __stage14_output", "BY HASH($440, $441, $442)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "8", "writeMsMax": "12", "writeRatioAvg": 0.02768166089965398, "writeRatioMax": 0.04152249134948097 }, { "completedParallelInputs": "1", "computeMsAvg": "181", "computeMsMax": "181", "computeRatioAvg": 0.6262975778546713, "computeRatioMax": 0.6262975778546713, "endMs": "1665777266914", "id": "21", "inputStages": [ "10", "9" ], "name": "S15: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.05190311418685121, "readRatioMax": 0.05190311418685121, "recordsRead": "769475", "recordsWritten": "942", "shuffleOutputBytes": "50995", "shuffleOutputBytesSpilled": "0", "slotMs": "178", "startMs": "1665777266772", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_addr_sk, $72:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $493, $501 := $492, $502 := $491", "$270 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482, $492 := $483, $493 := $41", "INNER HASH JOIN EACH WITH ALL ON $480 = $40" ] }, { "kind": "JOIN", "substeps": [ "$480 := $71, $481 := $72, $482 := $121, $483 := $122", "INNER HASH JOIN EACH WITH ALL ON $70 = $120" ] }, { "kind": "WRITE", "substeps": [ "$500, $502, $501, $270", "TO __stage15_output", "BY HASH($500, $501, $502)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02768166089965398, "writeRatioMax": 0.02768166089965398 }, { "completedParallelInputs": "1", "computeMsAvg": "169", "computeMsMax": "169", "computeRatioAvg": 0.5847750865051903, "computeRatioMax": 0.5847750865051903, "endMs": "1665777266921", "id": "22", "inputStages": [ "12", "13" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.05536332179930796, "readRatioMax": 0.05536332179930796, "recordsRead": "769475", "recordsWritten": "935", "shuffleOutputBytes": "50516", "shuffleOutputBytesSpilled": "0", "slotMs": "168", "startMs": "1665777266788", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_sold_date_sk, $51:ws_bill_addr_sk, $52:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $553, $561 := $552, $562 := $551", "$240 := SUM($550)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $543, $553 := $21", "INNER HASH JOIN EACH WITH ALL ON $540 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $51, $541 := $52, $542 := $81, $543 := $82", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$560, $562, $561, $240", "TO __stage16_output", "BY HASH($560, $561, $562)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02422145328719723, "writeRatioMax": 0.02422145328719723 }, { "completedParallelInputs": "1", "computeMsAvg": "181", "computeMsMax": "181", "computeRatioAvg": 0.6262975778546713, "computeRatioMax": 0.6262975778546713, "endMs": "1665777266958", "id": "23", "inputStages": [ "16", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.07958477508650519, "readRatioMax": 0.07958477508650519, "recordsRead": "769476", "recordsWritten": "1261", "shuffleOutputBytes": "68335", "shuffleOutputBytesSpilled": "0", "slotMs": "201", "startMs": "1665777266804", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_addr_sk, $12:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $613, $621 := $612, $622 := $611", "$210 := SUM($610)" ] }, { "kind": "JOIN", "substeps": [ "$610 := $601, $611 := $602, $612 := $603, $613 := $2", "INNER HASH JOIN EACH WITH ALL ON $600 = $1" ] }, { "kind": "JOIN", "substeps": [ "$600 := $11, $601 := $12, $602 := $31, $603 := $32", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$620, $622, $621, $210", "TO __stage17_output", "BY HASH($620, $621, $622)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.0726643598615917, "writeRatioMax": 0.0726643598615917 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03460207612456748, "computeRatioMax": 0.03460207612456748, "endMs": "1665777267056", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1261", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777267019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $622, $621, $210", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622", "$190 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$190, $630", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.09342560553633218, "writeRatioMax": 0.09342560553633218 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03460207612456748, "computeRatioMax": 0.03460207612456748, "endMs": "1665777267075", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "935", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777267035", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $562, $561, $240", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$200 := SUM($240)" ] }, { "kind": "WRITE", "substeps": [ "$200, $570", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.09342560553633218, "writeRatioMax": 0.09342560553633218 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.031141868512110725, "computeRatioMax": 0.031141868512110725, "endMs": "1665777267096", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "942", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777267061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $502, $501, $270", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$220 := SUM($270)" ] }, { "kind": "WRITE", "substeps": [ "$220, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.09342560553633218, "writeRatioMax": 0.09342560553633218 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.058823529411764705, "computeRatioMax": 0.058823529411764705, "endMs": "1665777267119", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10729", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777267082", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $442, $441, $280", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442", "$230 := SUM($280)" ] }, { "kind": "WRITE", "substeps": [ "$230, $450", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.07958477508650519, "writeRatioMax": 0.07958477508650519 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.06920415224913495, "computeRatioMax": 0.06920415224913495, "endMs": "1665777267135", "id": "28", "inputStages": [ "18" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9550", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777267101", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $382, $381, $300", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382", "$260 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$260, $390", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006920415224913495, "waitRatioMax": 0.006920415224913495, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.07612456747404844, "writeRatioMax": 0.07612456747404844 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.02768166089965398, "computeRatioMax": 0.05536332179930796, "endMs": "1665777267244", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1656", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "4104", "startMs": "1665777267147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "6", "waitMsMax": "10", "waitRatioAvg": 0.020761245674740483, "waitRatioMax": 0.03460207612456748, "writeMsAvg": "22", "writeMsMax": "55", "writeRatioAvg": 0.07612456747404844, "writeRatioMax": 0.1903114186851211 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.02768166089965398, "computeRatioMax": 0.05190311418685121, "endMs": "1665777267242", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1808", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "2987", "startMs": "1665777267147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "11", "waitMsMax": "14", "waitRatioAvg": 0.03806228373702422, "waitRatioMax": 0.04844290657439446, "writeMsAvg": "8", "writeMsMax": "32", "writeRatioAvg": 0.02768166089965398, "writeRatioMax": 0.11072664359861592 }, { "completedParallelInputs": "100", "computeMsAvg": "6", "computeMsMax": "17", "computeRatioAvg": 0.020761245674740483, "computeRatioMax": 0.058823529411764705, "endMs": "1665777267239", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "941", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "1849", "startMs": "1665777267150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "15", "waitMsMax": "19", "waitRatioAvg": 0.05190311418685121, "waitRatioMax": 0.0657439446366782, "writeMsAvg": "4", "writeMsMax": "28", "writeRatioAvg": 0.01384083044982699, "writeRatioMax": 0.09688581314878893 }, { "completedParallelInputs": "100", "computeMsAvg": "6", "computeMsMax": "20", "computeRatioAvg": 0.020761245674740483, "computeRatioMax": 0.06920415224913495, "endMs": "1665777267245", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "934", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "1642", "startMs": "1665777267151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "19", "waitMsMax": "21", "waitRatioAvg": 0.0657439446366782, "waitRatioMax": 0.0726643598615917, "writeMsAvg": "3", "writeMsMax": "27", "writeRatioAvg": 0.010380622837370242, "writeRatioMax": 0.09342560553633218 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.02422145328719723, "computeRatioMax": 0.05190311418685121, "endMs": "1665777267245", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1260", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "1675", "startMs": "1665777267159", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "20", "waitMsMax": "22", "waitRatioAvg": 0.06920415224913495, "waitRatioMax": 0.07612456747404844, "writeMsAvg": "3", "writeMsMax": "16", "writeRatioAvg": 0.010380622837370242, "writeRatioMax": 0.05536332179930796 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.09688581314878893, "computeRatioMax": 0.09688581314878893, "endMs": "1665777267257", "id": "35", "inputStages": [ "30", "31", "34", "33", "32", "19" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16369", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777267199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $332, $331, $290", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$260, $390", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$230, $450", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$220, $510", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$200, $570", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$190, $630", "FROM __stage22_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($642, $643)", "$181 := divide($646, $645)", "$182 := divide($647, $642)", "$183 := divide($644, $646)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($642, NUMERIC<...>), divide($647, $642), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$640 := $581, $641 := $582, $642 := $587, $643 := $583, $644 := $584, $645 := $585, $646 := $586, $647 := $190", "INNER HASH JOIN EACH WITH ALL ON $580 = $630" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($583, NUMERIC<...>), divide($587, $583), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $525, $581 := $520, $582 := $521, $583 := $526, $584 := $522, $585 := $523, $586 := $524, $587 := $200", "INNER HASH JOIN EACH WITH ALL ON $525 = $570" ] }, { "kind": "JOIN", "substeps": [ "$520 := $460, $521 := $461, $522 := $464, $523 := $462, $524 := $463, $525 := $510, $526 := $220", "INNER HASH JOIN EACH WITH ALL ON $460 = $510" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $404, $464 := $230", "INNER HASH JOIN EACH WITH ALL ON $403 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $340, $401 := $342, $402 := $250, $403 := $390, $404 := $260", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330, $341 := $331, $342 := $332", "$250 := SUM($290)" ] }, { "kind": "WRITE", "substeps": [ "$640, $641, $180, $181, $182, $183", "TO __stage23_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010380622837370242, "waitRatioMax": 0.010380622837370242, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01730103806228374, "writeRatioMax": 0.01730103806228374 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03460207612456748, "computeRatioMax": 0.03460207612456748, "endMs": "1665777267324", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777267275", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$640, $641, $180, $181, $182, $183", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654, $655", "TO __stage24_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010380622837370242, "waitRatioMax": 0.010380622837370242, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.08996539792387544, "writeRatioMax": 0.08996539792387544 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "15", "completedUnits": "20", "elapsedMs": "620", "estimatedRunnableUnits": "0", "pendingUnits": "13", "totalSlotMs": "4531" }, { "activeUnits": "15", "completedUnits": "540", "elapsedMs": "1151", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "19428" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113949473", "totalPartitionsProcessed": "0", "totalSlotMs": "19428", "transferredBytes": "0" }, "startTime": "1665777266245", "totalBytesProcessed": "113949473", "totalSlotMs": "19428" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3d9eaef5_5e4c_47a1_be1b_85d12559cb66" }, "priority": "INTERACTIVE", "query": "-- start query 31 in stream 0 using template query31.tpl\n\n/*\nList counties where the percentage growth in web sales is consistently higher compared to the percentage growth in store sales \nin the first three consecutive quarters for a given year.\n*/\n\nwith ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n ss1.ca_county\n ,ss1.d_year\n ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n ss ss1\n ,ss ss2\n ,ss ss3\n ,ws ws1\n ,ws ws2\n ,ws ws3\n where\n ss1.d_qoy = 1\n and ss1.d_year = 2000\n and ss1.ca_county = ss2.ca_county\n and ss2.d_qoy = 2\n and ss2.d_year = 2000\n and ss2.ca_county = ss3.ca_county\n and ss3.d_qoy = 3\n and ss3.d_year = 2000\n and ss1.ca_county = ws1.ca_county\n and ws1.d_qoy = 1\n and ws1.d_year = 2000\n and ws1.ca_county = ws2.ca_county\n and ws2.d_qoy = 2\n and ws2.d_year = 2000\n and ws1.ca_county = ws3.ca_county\n and ws3.d_qoy = 3\n and ws3.d_year =2000\n and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.ca_county; \n\n-- end query 31 in stream 0 using template query31.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ban2tkdibX2aqC3btwaWrw==", "id": "test-project-364309:europe-west1.query31_1665777268", "jobReference": { "jobId": "query31_1665777268", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query31_1665777268?location=europe-west1", "statistics": { "creationTime": "1665777269098", "endTime": "1665777270065", "finalExecutionDurationMs": "753", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113949473", "performanceInsights": { "avgPreviousExecutionMs": "995" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.10869565217391304, "computeRatioMax": 0.10869565217391304, "endMs": "1665777269286", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.018115942028985508, "readRatioMax": 0.018115942028985508, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777269250", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.036231884057971016, "writeRatioMax": 0.036231884057971016 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.050724637681159424, "computeRatioMax": 0.050724637681159424, "endMs": "1665777269304", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.025362318840579712, "readRatioMax": 0.025362318840579712, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777269265", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year, $172:d_qoy", "FROM date_dim", "WHERE and(equal($172, 2), equal($171, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.10144927536231885, "computeRatioMax": 0.10144927536231885, "endMs": "1665777269332", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.025362318840579712, "readRatioMax": 0.025362318840579712, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777269294", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.050724637681159424, "writeRatioMax": 0.050724637681159424 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.09420289855072464, "computeRatioMax": 0.09420289855072464, "endMs": "1665777269344", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.025362318840579712, "readRatioMax": 0.025362318840579712, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777269309", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year, $162:d_qoy", "FROM date_dim", "WHERE and(equal($162, 1), equal($161, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.050724637681159424, "writeRatioMax": 0.050724637681159424 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.12318840579710146, "computeRatioMax": 0.12318840579710146, "endMs": "1665777269379", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.025362318840579712, "readRatioMax": 0.025362318840579712, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777269339", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03985507246376811, "writeRatioMax": 0.03985507246376811 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.05434782608695652, "computeRatioMax": 0.05434782608695652, "endMs": "1665777269398", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03260869565217391, "readRatioMax": 0.03260869565217391, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777269357", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year, $152:d_qoy", "FROM date_dim", "WHERE and(equal($152, 3), equal($151, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03260869565217391, "writeRatioMax": 0.03260869565217391 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.13768115942028986, "computeRatioMax": 0.13768115942028986, "endMs": "1665777269432", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03260869565217391, "readRatioMax": 0.03260869565217391, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777269383", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04710144927536232, "writeRatioMax": 0.04710144927536232 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.050724637681159424, "computeRatioMax": 0.050724637681159424, "endMs": "1665777269433", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.025362318840579712, "readRatioMax": 0.025362318840579712, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777269399", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_year, $122:d_qoy", "FROM date_dim", "WHERE and(equal($122, 1), equal($121, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.028985507246376812, "writeRatioMax": 0.028985507246376812 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.13405797101449277, "computeRatioMax": 0.13405797101449277, "endMs": "1665777269461", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.021739130434782608, "readRatioMax": 0.021739130434782608, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777269425", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.036231884057971016, "writeRatioMax": 0.036231884057971016 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03260869565217391, "computeRatioMax": 0.03260869565217391, "endMs": "1665777269480", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.021739130434782608, "readRatioMax": 0.021739130434782608, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777269439", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_qoy", "FROM date_dim", "WHERE and(equal($82, 2), equal($81, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05434782608695652, "writeRatioMax": 0.05434782608695652 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.10869565217391304, "computeRatioMax": 0.10869565217391304, "endMs": "1665777269495", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.018115942028985508, "readRatioMax": 0.018115942028985508, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777269463", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.025362318840579712, "writeRatioMax": 0.025362318840579712 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.057971014492753624, "computeRatioMax": 0.057971014492753624, "endMs": "1665777269508", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.028985507246376812, "readRatioMax": 0.028985507246376812, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777269477", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($32, 3), equal($31, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04710144927536232, "writeRatioMax": 0.04710144927536232 }, { "completedParallelInputs": "6", "computeMsAvg": "182", "computeMsMax": "276", "computeRatioAvg": 0.6594202898550725, "computeRatioMax": 1, "endMs": "1665777269673", "id": "18", "inputStages": [ "0", "1" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "21", "readRatioAvg": 0.04710144927536232, "readRatioMax": 0.07608695652173914, "recordsRead": "3180950", "recordsWritten": "9550", "shuffleOutputBytes": "517376", "shuffleOutputBytesSpilled": "0", "slotMs": "994", "startMs": "1665777269492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_addr_sk, $142:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $373, $381 := $372, $382 := $371", "$300 := SUM($370)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $363, $373 := $101", "INNER HASH JOIN EACH WITH ALL ON $360 = $100" ] }, { "kind": "JOIN", "substeps": [ "$360 := $141, $361 := $142, $362 := $171, $363 := $172", "INNER HASH JOIN EACH WITH ALL ON $140 = $170" ] }, { "kind": "WRITE", "substeps": [ "$380, $382, $381, $300", "TO __stage12_output", "BY HASH($380, $381, $382)" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.018115942028985508, "writeRatioMax": 0.025362318840579712 }, { "completedParallelInputs": "6", "computeMsAvg": "181", "computeMsMax": "266", "computeRatioAvg": 0.6557971014492754, "computeRatioMax": 0.9637681159420289, "endMs": "1665777269655", "id": "19", "inputStages": [ "4", "3" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.050724637681159424, "readRatioMax": 0.06159420289855073, "recordsRead": "3180950", "recordsWritten": "9770", "shuffleOutputBytes": "529269", "shuffleOutputBytesSpilled": "0", "slotMs": "926", "startMs": "1665777269498", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ss_sold_date_sk, $131:ss_addr_sk, $132:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $323, $331 := $322, $332 := $321", "$290 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311, $321 := $312, $322 := $313, $323 := $91", "INNER HASH JOIN EACH WITH ALL ON $310 = $90" ] }, { "kind": "JOIN", "substeps": [ "$310 := $131, $311 := $132, $312 := $161, $313 := $162", "INNER HASH JOIN EACH WITH ALL ON $130 = $160" ] }, { "kind": "WRITE", "substeps": [ "$330, $332, $331, $290", "TO __stage13_output", "BY HASH($330, $331, $332)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.014492753623188406, "writeRatioMax": 0.018115942028985508 }, { "completedParallelInputs": "6", "computeMsAvg": "198", "computeMsMax": "242", "computeRatioAvg": 0.717391304347826, "computeRatioMax": 0.8768115942028986, "endMs": "1665777269667", "id": "20", "inputStages": [ "7", "6" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "20", "readRatioAvg": 0.06159420289855073, "readRatioMax": 0.07246376811594203, "recordsRead": "3180956", "recordsWritten": "10729", "shuffleOutputBytes": "581751", "shuffleOutputBytesSpilled": "0", "slotMs": "1147", "startMs": "1665777269511", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ss_sold_date_sk, $111:ss_addr_sk, $112:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $433, $441 := $432, $442 := $431", "$280 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $61", "INNER HASH JOIN EACH WITH ALL ON $420 = $60" ] }, { "kind": "JOIN", "substeps": [ "$420 := $111, $421 := $112, $422 := $151, $423 := $152", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$440, $442, $441, $280", "TO __stage14_output", "BY HASH($440, $441, $442)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "9", "writeMsMax": "14", "writeRatioAvg": 0.03260869565217391, "writeRatioMax": 0.050724637681159424 }, { "completedParallelInputs": "1", "computeMsAvg": "189", "computeMsMax": "189", "computeRatioAvg": 0.6847826086956522, "computeRatioMax": 0.6847826086956522, "endMs": "1665777269675", "id": "21", "inputStages": [ "9", "10" ], "name": "S15: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.04710144927536232, "readRatioMax": 0.04710144927536232, "recordsRead": "769475", "recordsWritten": "942", "shuffleOutputBytes": "50995", "shuffleOutputBytesSpilled": "0", "slotMs": "188", "startMs": "1665777269525", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_addr_sk, $72:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $493, $501 := $492, $502 := $491", "$270 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482, $492 := $483, $493 := $41", "INNER HASH JOIN EACH WITH ALL ON $480 = $40" ] }, { "kind": "JOIN", "substeps": [ "$480 := $71, $481 := $72, $482 := $121, $483 := $122", "INNER HASH JOIN EACH WITH ALL ON $70 = $120" ] }, { "kind": "WRITE", "substeps": [ "$500, $502, $501, $270", "TO __stage15_output", "BY HASH($500, $501, $502)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.025362318840579712, "writeRatioMax": 0.025362318840579712 }, { "completedParallelInputs": "1", "computeMsAvg": "143", "computeMsMax": "143", "computeRatioAvg": 0.5181159420289855, "computeRatioMax": 0.5181159420289855, "endMs": "1665777269654", "id": "22", "inputStages": [ "13", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "769475", "recordsWritten": "935", "shuffleOutputBytes": "50516", "shuffleOutputBytesSpilled": "0", "slotMs": "134", "startMs": "1665777269543", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_sold_date_sk, $51:ws_bill_addr_sk, $52:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $553, $561 := $552, $562 := $551", "$240 := SUM($550)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $543, $553 := $21", "INNER HASH JOIN EACH WITH ALL ON $540 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $51, $541 := $52, $542 := $81, $543 := $82", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$560, $562, $561, $240", "TO __stage16_output", "BY HASH($560, $561, $562)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.028985507246376812, "writeRatioMax": 0.028985507246376812 }, { "completedParallelInputs": "1", "computeMsAvg": "160", "computeMsMax": "160", "computeRatioAvg": 0.5797101449275363, "computeRatioMax": 0.5797101449275363, "endMs": "1665777269680", "id": "23", "inputStages": [ "16", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "769476", "recordsWritten": "1261", "shuffleOutputBytes": "68335", "shuffleOutputBytesSpilled": "0", "slotMs": "156", "startMs": "1665777269559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_addr_sk, $12:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $613, $621 := $612, $622 := $611", "$210 := SUM($610)" ] }, { "kind": "JOIN", "substeps": [ "$610 := $601, $611 := $602, $612 := $603, $613 := $2", "INNER HASH JOIN EACH WITH ALL ON $600 = $1" ] }, { "kind": "JOIN", "substeps": [ "$600 := $11, $601 := $12, $602 := $31, $603 := $32", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$620, $622, $621, $210", "TO __stage17_output", "BY HASH($620, $621, $622)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.057971014492753624, "computeRatioMax": 0.057971014492753624, "endMs": "1665777269745", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1261", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777269707", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $622, $621, $210", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622", "$190 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$190, $630", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.025362318840579712, "computeRatioMax": 0.025362318840579712, "endMs": "1665777269755", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "935", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777269720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $562, $561, $240", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$200 := SUM($240)" ] }, { "kind": "WRITE", "substeps": [ "$200, $570", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05434782608695652, "writeRatioMax": 0.05434782608695652 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03985507246376811, "computeRatioMax": 0.03985507246376811, "endMs": "1665777269771", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "942", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777269735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $502, $501, $270", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$220 := SUM($270)" ] }, { "kind": "WRITE", "substeps": [ "$220, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007246376811594203, "waitRatioMax": 0.007246376811594203, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.09420289855072464, "writeRatioMax": 0.09420289855072464 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.05434782608695652, "computeRatioMax": 0.05434782608695652, "endMs": "1665777269783", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10729", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777269749", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $442, $441, $280", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442", "$230 := SUM($280)" ] }, { "kind": "WRITE", "substeps": [ "$230, $450", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.036231884057971016, "writeRatioMax": 0.036231884057971016 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.05434782608695652, "computeRatioMax": 0.05434782608695652, "endMs": "1665777269800", "id": "28", "inputStages": [ "18" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9550", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777269763", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $382, $381, $300", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382", "$260 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$260, $390", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.050724637681159424, "writeRatioMax": 0.050724637681159424 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.028985507246376812, "computeRatioMax": 0.06159420289855073, "endMs": "1665777269869", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1656", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "3099", "startMs": "1665777269815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "10", "waitRatioAvg": 0.010869565217391304, "waitRatioMax": 0.036231884057971016, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.05434782608695652, "writeRatioMax": 0.09420289855072464 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.028985507246376812, "computeRatioMax": 0.07608695652173914, "endMs": "1665777269869", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1808", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "2610", "startMs": "1665777269816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.03260869565217391, "waitRatioMax": 0.03985507246376811, "writeMsAvg": "8", "writeMsMax": "25", "writeRatioAvg": 0.028985507246376812, "writeRatioMax": 0.09057971014492754 }, { "completedParallelInputs": "100", "computeMsAvg": "6", "computeMsMax": "20", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.07246376811594203, "endMs": "1665777269870", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "941", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "2335", "startMs": "1665777269817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.036231884057971016, "waitRatioMax": 0.043478260869565216, "writeMsAvg": "5", "writeMsMax": "19", "writeRatioAvg": 0.018115942028985508, "writeRatioMax": 0.06884057971014493 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.025362318840579712, "computeRatioMax": 0.05434782608695652, "endMs": "1665777269871", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "934", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "1894", "startMs": "1665777269817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "11", "waitMsMax": "13", "waitRatioAvg": 0.03985507246376811, "waitRatioMax": 0.04710144927536232, "writeMsAvg": "3", "writeMsMax": "15", "writeRatioAvg": 0.010869565217391304, "writeRatioMax": 0.05434782608695652 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.025362318840579712, "computeRatioMax": 0.057971014492753624, "endMs": "1665777269870", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1260", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "1652", "startMs": "1665777269817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "12", "waitMsMax": "13", "waitRatioAvg": 0.043478260869565216, "waitRatioMax": 0.04710144927536232, "writeMsAvg": "3", "writeMsMax": "17", "writeRatioAvg": 0.010869565217391304, "writeRatioMax": 0.06159420289855073 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.12318840579710146, "computeRatioMax": 0.12318840579710146, "endMs": "1665777269908", "id": "35", "inputStages": [ "30", "31", "33", "19", "34", "32" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16369", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "140", "startMs": "1665777269841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $332, $331, $290", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$260, $390", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$230, $450", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$220, $510", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$200, $570", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$190, $630", "FROM __stage22_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($642, $643)", "$181 := divide($646, $645)", "$182 := divide($647, $642)", "$183 := divide($644, $646)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($642, NUMERIC<...>), divide($647, $642), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$640 := $581, $641 := $582, $642 := $587, $643 := $583, $644 := $584, $645 := $585, $646 := $586, $647 := $190", "INNER HASH JOIN EACH WITH ALL ON $580 = $630" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($583, NUMERIC<...>), divide($587, $583), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $525, $581 := $520, $582 := $521, $583 := $526, $584 := $522, $585 := $523, $586 := $524, $587 := $200", "INNER HASH JOIN EACH WITH ALL ON $525 = $570" ] }, { "kind": "JOIN", "substeps": [ "$520 := $460, $521 := $461, $522 := $464, $523 := $462, $524 := $463, $525 := $510, $526 := $220", "INNER HASH JOIN EACH WITH ALL ON $460 = $510" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $404, $464 := $230", "INNER HASH JOIN EACH WITH ALL ON $403 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $340, $401 := $342, $402 := $250, $403 := $390, $404 := $260", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330, $341 := $331, $342 := $332", "$250 := SUM($290)" ] }, { "kind": "WRITE", "substeps": [ "$640, $641, $180, $181, $182, $183", "TO __stage23_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.014492753623188406, "waitRatioMax": 0.014492753623188406, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010869565217391304, "writeRatioMax": 0.010869565217391304 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.021739130434782608, "endMs": "1665777269958", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777269920", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$640, $641, $180, $181, $182, $183", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654, $655", "TO __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.050724637681159424, "writeRatioMax": 0.050724637681159424 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "34", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "5150" }, { "activeUnits": "3", "completedUnits": "540", "elapsedMs": "861", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "16916" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113949473", "totalPartitionsProcessed": "0", "totalSlotMs": "16916", "transferredBytes": "0" }, "startTime": "1665777269149", "totalBytesProcessed": "113949473", "totalSlotMs": "16916" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb2467bfc_c461_4c56_9eba_f66787229419" }, "priority": "INTERACTIVE", "query": "-- start query 31 in stream 0 using template query31.tpl\n\n/*\nList counties where the percentage growth in web sales is consistently higher compared to the percentage growth in store sales \nin the first three consecutive quarters for a given year.\n*/\n\nwith ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n ss1.ca_county\n ,ss1.d_year\n ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n ss ss1\n ,ss ss2\n ,ss ss3\n ,ws ws1\n ,ws ws2\n ,ws ws3\n where\n ss1.d_qoy = 1\n and ss1.d_year = 2000\n and ss1.ca_county = ss2.ca_county\n and ss2.d_qoy = 2\n and ss2.d_year = 2000\n and ss2.ca_county = ss3.ca_county\n and ss3.d_qoy = 3\n and ss3.d_year = 2000\n and ss1.ca_county = ws1.ca_county\n and ws1.d_qoy = 1\n and ws1.d_year = 2000\n and ws1.ca_county = ws2.ca_county\n and ws2.d_qoy = 2\n and ws2.d_year = 2000\n and ws1.ca_county = ws3.ca_county\n and ws3.d_qoy = 3\n and ws3.d_year =2000\n and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.ca_county; \n\n-- end query 31 in stream 0 using template query31.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "l0XEOThpsUHjgJytivKhgw==", "id": "test-project-364309:europe-west1.query31_1665777271", "jobReference": { "jobId": "query31_1665777271", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query31_1665777271?location=europe-west1", "statistics": { "creationTime": "1665777271681", "endTime": "1665777272899", "finalExecutionDurationMs": "823", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113949473", "performanceInsights": { "avgPreviousExecutionMs": "954" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.1038961038961039, "computeRatioMax": 0.1038961038961039, "endMs": "1665777271978", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.017316017316017316, "readRatioMax": 0.017316017316017316, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777271945", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05194805194805195, "writeRatioMax": 0.05194805194805195 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.025974025974025976, "computeRatioMax": 0.025974025974025976, "endMs": "1665777271987", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.021645021645021644, "readRatioMax": 0.021645021645021644, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665777271961", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year, $172:d_qoy", "FROM date_dim", "WHERE and(equal($172, 2), equal($171, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.06060606060606061 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.16883116883116883, "computeRatioMax": 0.16883116883116883, "endMs": "1665777272024", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.025974025974025976, "readRatioMax": 0.025974025974025976, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777271986", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05194805194805195, "writeRatioMax": 0.05194805194805195 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.030303030303030304, "computeRatioMax": 0.030303030303030304, "endMs": "1665777272045", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.025974025974025976, "readRatioMax": 0.025974025974025976, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777272007", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year, $162:d_qoy", "FROM date_dim", "WHERE and(equal($162, 1), equal($161, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.06060606060606061 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.19480519480519481, "computeRatioMax": 0.19480519480519481, "endMs": "1665777272064", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.017316017316017316, "readRatioMax": 0.017316017316017316, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777272032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04329004329004329, "writeRatioMax": 0.04329004329004329 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05627705627705628, "computeRatioMax": 0.05627705627705628, "endMs": "1665777272092", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04329004329004329, "readRatioMax": 0.04329004329004329, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777272048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year, $152:d_qoy", "FROM date_dim", "WHERE and(equal($152, 3), equal($151, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05194805194805195, "writeRatioMax": 0.05194805194805195 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.17316017316017315, "computeRatioMax": 0.17316017316017315, "endMs": "1665777272123", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03896103896103896, "readRatioMax": 0.03896103896103896, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777272075", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05194805194805195, "writeRatioMax": 0.05194805194805195 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.047619047619047616, "endMs": "1665777272129", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030303030303030304, "readRatioMax": 0.030303030303030304, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777272092", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_year, $122:d_qoy", "FROM date_dim", "WHERE and(equal($122, 1), equal($121, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03463203463203463, "writeRatioMax": 0.03463203463203463 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.12987012987012986, "computeRatioMax": 0.12987012987012986, "endMs": "1665777272162", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.025974025974025976, "readRatioMax": 0.025974025974025976, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777272124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04329004329004329, "writeRatioMax": 0.04329004329004329 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05194805194805195, "computeRatioMax": 0.05194805194805195, "endMs": "1665777272180", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04329004329004329, "readRatioMax": 0.04329004329004329, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777272140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_qoy", "FROM date_dim", "WHERE and(equal($82, 2), equal($81, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03463203463203463, "writeRatioMax": 0.03463203463203463 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.15584415584415584, "computeRatioMax": 0.15584415584415584, "endMs": "1665777272210", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03463203463203463, "readRatioMax": 0.03463203463203463, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777272169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05194805194805195, "writeRatioMax": 0.05194805194805195 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0735930735930736, "computeRatioMax": 0.0735930735930736, "endMs": "1665777272229", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03896103896103896, "readRatioMax": 0.03896103896103896, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777272184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($32, 3), equal($31, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage10_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05627705627705628, "writeRatioMax": 0.05627705627705628 }, { "completedParallelInputs": "6", "computeMsAvg": "137", "computeMsMax": "178", "computeRatioAvg": 0.5930735930735931, "computeRatioMax": 0.7705627705627706, "endMs": "1665777272395", "id": "18", "inputStages": [ "0", "1" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "40", "readRatioAvg": 0.0735930735930736, "readRatioMax": 0.17316017316017315, "recordsRead": "3180950", "recordsWritten": "9550", "shuffleOutputBytes": "517376", "shuffleOutputBytesSpilled": "0", "slotMs": "1164", "startMs": "1665777272208", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_addr_sk, $142:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $373, $381 := $372, $382 := $371", "$300 := SUM($370)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $363, $373 := $101", "INNER HASH JOIN EACH WITH ALL ON $360 = $100" ] }, { "kind": "JOIN", "substeps": [ "$360 := $141, $361 := $142, $362 := $171, $363 := $172", "INNER HASH JOIN EACH WITH ALL ON $140 = $170" ] }, { "kind": "WRITE", "substeps": [ "$380, $382, $381, $300", "TO __stage12_output", "BY HASH($380, $381, $382)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "5", "writeMsMax": "11", "writeRatioAvg": 0.021645021645021644, "writeRatioMax": 0.047619047619047616 }, { "completedParallelInputs": "6", "computeMsAvg": "150", "computeMsMax": "178", "computeRatioAvg": 0.6493506493506493, "computeRatioMax": 0.7705627705627706, "endMs": "1665777272335", "id": "19", "inputStages": [ "3", "4" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "12", "readRatioAvg": 0.047619047619047616, "readRatioMax": 0.05194805194805195, "recordsRead": "3180950", "recordsWritten": "9770", "shuffleOutputBytes": "529269", "shuffleOutputBytesSpilled": "0", "slotMs": "796", "startMs": "1665777272215", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ss_sold_date_sk, $131:ss_addr_sk, $132:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $323, $331 := $322, $332 := $321", "$290 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311, $321 := $312, $322 := $313, $323 := $91", "INNER HASH JOIN EACH WITH ALL ON $310 = $90" ] }, { "kind": "JOIN", "substeps": [ "$310 := $131, $311 := $132, $312 := $161, $313 := $162", "INNER HASH JOIN EACH WITH ALL ON $130 = $160" ] }, { "kind": "WRITE", "substeps": [ "$330, $332, $331, $290", "TO __stage13_output", "BY HASH($330, $331, $332)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.017316017316017316, "writeRatioMax": 0.021645021645021644 }, { "completedParallelInputs": "6", "computeMsAvg": "192", "computeMsMax": "231", "computeRatioAvg": 0.8311688311688312, "computeRatioMax": 1, "endMs": "1665777272376", "id": "20", "inputStages": [ "6", "7" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.05627705627705628, "readRatioMax": 0.06926406926406926, "recordsRead": "3180956", "recordsWritten": "10729", "shuffleOutputBytes": "581751", "shuffleOutputBytesSpilled": "0", "slotMs": "1037", "startMs": "1665777272234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ss_sold_date_sk, $111:ss_addr_sk, $112:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $433, $441 := $432, $442 := $431", "$280 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $61", "INNER HASH JOIN EACH WITH ALL ON $420 = $60" ] }, { "kind": "JOIN", "substeps": [ "$420 := $111, $421 := $112, $422 := $151, $423 := $152", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$440, $442, $441, $280", "TO __stage14_output", "BY HASH($440, $441, $442)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.025974025974025976, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "1", "computeMsAvg": "128", "computeMsMax": "128", "computeRatioAvg": 0.5541125541125541, "computeRatioMax": 0.5541125541125541, "endMs": "1665777272339", "id": "21", "inputStages": [ "10", "9" ], "name": "S15: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.047619047619047616, "readRatioMax": 0.047619047619047616, "recordsRead": "769475", "recordsWritten": "942", "shuffleOutputBytes": "50995", "shuffleOutputBytesSpilled": "0", "slotMs": "117", "startMs": "1665777272248", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_addr_sk, $72:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $493, $501 := $492, $502 := $491", "$270 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482, $492 := $483, $493 := $41", "INNER HASH JOIN EACH WITH ALL ON $480 = $40" ] }, { "kind": "JOIN", "substeps": [ "$480 := $71, $481 := $72, $482 := $121, $483 := $122", "INNER HASH JOIN EACH WITH ALL ON $70 = $120" ] }, { "kind": "WRITE", "substeps": [ "$500, $502, $501, $270", "TO __stage15_output", "BY HASH($500, $501, $502)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.021645021645021644, "writeRatioMax": 0.021645021645021644 }, { "completedParallelInputs": "1", "computeMsAvg": "209", "computeMsMax": "209", "computeRatioAvg": 0.9047619047619048, "computeRatioMax": 0.9047619047619048, "endMs": "1665777272409", "id": "22", "inputStages": [ "13", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.06493506493506493, "readRatioMax": 0.06493506493506493, "recordsRead": "769475", "recordsWritten": "935", "shuffleOutputBytes": "50516", "shuffleOutputBytesSpilled": "0", "slotMs": "180", "startMs": "1665777272265", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_sold_date_sk, $51:ws_bill_addr_sk, $52:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $553, $561 := $552, $562 := $551", "$240 := SUM($550)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $543, $553 := $21", "INNER HASH JOIN EACH WITH ALL ON $540 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $51, $541 := $52, $542 := $81, $543 := $82", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$560, $562, $561, $240", "TO __stage16_output", "BY HASH($560, $561, $562)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.025974025974025976, "writeRatioMax": 0.025974025974025976 }, { "completedParallelInputs": "1", "computeMsAvg": "207", "computeMsMax": "207", "computeRatioAvg": 0.8961038961038961, "computeRatioMax": 0.8961038961038961, "endMs": "1665777272408", "id": "23", "inputStages": [ "16", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.06060606060606061, "readRatioMax": 0.06060606060606061, "recordsRead": "769476", "recordsWritten": "1261", "shuffleOutputBytes": "68335", "shuffleOutputBytesSpilled": "0", "slotMs": "190", "startMs": "1665777272279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_addr_sk, $12:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $613, $621 := $612, $622 := $611", "$210 := SUM($610)" ] }, { "kind": "JOIN", "substeps": [ "$610 := $601, $611 := $602, $612 := $603, $613 := $2", "INNER HASH JOIN EACH WITH ALL ON $600 = $1" ] }, { "kind": "JOIN", "substeps": [ "$600 := $11, $601 := $12, $602 := $31, $603 := $32", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$620, $622, $621, $210", "TO __stage17_output", "BY HASH($620, $621, $622)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04329004329004329, "computeRatioMax": 0.04329004329004329, "endMs": "1665777272478", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1261", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777272443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $622, $621, $210", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622", "$190 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$190, $630", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.06060606060606061 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05627705627705628, "computeRatioMax": 0.05627705627705628, "endMs": "1665777272491", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "935", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777272458", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $562, $561, $240", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$200 := SUM($240)" ] }, { "kind": "WRITE", "substeps": [ "$200, $570", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.06060606060606061 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.047619047619047616, "endMs": "1665777272509", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "942", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777272471", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $502, $501, $270", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$220 := SUM($270)" ] }, { "kind": "WRITE", "substeps": [ "$220, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06493506493506493, "writeRatioMax": 0.06493506493506493 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06060606060606061, "computeRatioMax": 0.06060606060606061, "endMs": "1665777272527", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10729", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777272485", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $442, $441, $280", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442", "$230 := SUM($280)" ] }, { "kind": "WRITE", "substeps": [ "$230, $450", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07792207792207792, "writeRatioMax": 0.07792207792207792 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0735930735930736, "computeRatioMax": 0.0735930735930736, "endMs": "1665777272542", "id": "28", "inputStages": [ "18" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9550", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777272499", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $382, $381, $300", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382", "$260 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$260, $390", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06493506493506493, "writeRatioMax": 0.06493506493506493 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.030303030303030304, "computeRatioMax": 0.06060606060606061, "endMs": "1665777272615", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1656", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "3220", "startMs": "1665777272558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.012987012987012988, "waitRatioMax": 0.025974025974025976, "writeMsAvg": "16", "writeMsMax": "19", "writeRatioAvg": 0.06926406926406926, "writeRatioMax": 0.08225108225108226 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.030303030303030304, "computeRatioMax": 0.06060606060606061, "endMs": "1665777272613", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1808", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "2777", "startMs": "1665777272557", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.021645021645021644, "waitRatioMax": 0.025974025974025976, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.06060606060606061, "writeRatioMax": 0.08658008658008658 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.030303030303030304, "computeRatioMax": 0.06060606060606061, "endMs": "1665777272612", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "941", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "2659", "startMs": "1665777272558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.025974025974025976, "waitRatioMax": 0.03463203463203463, "writeMsAvg": "12", "writeMsMax": "20", "writeRatioAvg": 0.05194805194805195, "writeRatioMax": 0.08658008658008658 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.030303030303030304, "computeRatioMax": 0.06060606060606061, "endMs": "1665777272618", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "934", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "2696", "startMs": "1665777272559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.030303030303030304, "waitRatioMax": 0.03463203463203463, "writeMsAvg": "9", "writeMsMax": "26", "writeRatioAvg": 0.03896103896103896, "writeRatioMax": 0.11255411255411256 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "17", "computeRatioAvg": 0.030303030303030304, "computeRatioMax": 0.0735930735930736, "endMs": "1665777272612", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1260", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "2499", "startMs": "1665777272559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "8", "waitMsMax": "9", "waitRatioAvg": 0.03463203463203463, "waitRatioMax": 0.03896103896103896, "writeMsAvg": "5", "writeMsMax": "19", "writeRatioAvg": 0.021645021645021644, "writeRatioMax": 0.08225108225108226 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.23809523809523808, "computeRatioMax": 0.23809523809523808, "endMs": "1665777272681", "id": "35", "inputStages": [ "33", "34", "19", "32", "30", "31" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16369", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "113", "startMs": "1665777272575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $332, $331, $290", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$260, $390", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$230, $450", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$220, $510", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$200, $570", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$190, $630", "FROM __stage22_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($642, $643)", "$181 := divide($646, $645)", "$182 := divide($647, $642)", "$183 := divide($644, $646)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($642, NUMERIC<...>), divide($647, $642), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$640 := $581, $641 := $582, $642 := $587, $643 := $583, $644 := $584, $645 := $585, $646 := $586, $647 := $190", "INNER HASH JOIN EACH WITH ALL ON $580 = $630" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($583, NUMERIC<...>), divide($587, $583), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $525, $581 := $520, $582 := $521, $583 := $526, $584 := $522, $585 := $523, $586 := $524, $587 := $200", "INNER HASH JOIN EACH WITH ALL ON $525 = $570" ] }, { "kind": "JOIN", "substeps": [ "$520 := $460, $521 := $461, $522 := $464, $523 := $462, $524 := $463, $525 := $510, $526 := $220", "INNER HASH JOIN EACH WITH ALL ON $460 = $510" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $404, $464 := $230", "INNER HASH JOIN EACH WITH ALL ON $403 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $340, $401 := $342, $402 := $250, $403 := $390, $404 := $260", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330, $341 := $331, $342 := $332", "$250 := SUM($290)" ] }, { "kind": "WRITE", "substeps": [ "$640, $641, $180, $181, $182, $183", "TO __stage23_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004329004329004329, "waitRatioMax": 0.004329004329004329, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.025974025974025976, "writeRatioMax": 0.025974025974025976 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04329004329004329, "computeRatioMax": 0.04329004329004329, "endMs": "1665777272723", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777272697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$640, $641, $180, $181, $182, $183", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654, $655", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008658008658008658, "waitRatioMax": 0.008658008658008658, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05627705627705628, "writeRatioMax": 0.05627705627705628 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "33", "elapsedMs": "619", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "5429" }, { "activeUnits": "1", "completedUnits": "540", "elapsedMs": "962", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "19424" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113949473", "totalPartitionsProcessed": "0", "totalSlotMs": "19424", "transferredBytes": "0" }, "startTime": "1665777271829", "totalBytesProcessed": "113949473", "totalSlotMs": "19424" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon24750022_b0fd_4f33_8467_29fa9624d208" }, "priority": "INTERACTIVE", "query": "-- start query 31 in stream 0 using template query31.tpl\n\n/*\nList counties where the percentage growth in web sales is consistently higher compared to the percentage growth in store sales \nin the first three consecutive quarters for a given year.\n*/\n\nwith ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n ss1.ca_county\n ,ss1.d_year\n ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n ss ss1\n ,ss ss2\n ,ss ss3\n ,ws ws1\n ,ws ws2\n ,ws ws3\n where\n ss1.d_qoy = 1\n and ss1.d_year = 2000\n and ss1.ca_county = ss2.ca_county\n and ss2.d_qoy = 2\n and ss2.d_year = 2000\n and ss2.ca_county = ss3.ca_county\n and ss3.d_qoy = 3\n and ss3.d_year = 2000\n and ss1.ca_county = ws1.ca_county\n and ws1.d_qoy = 1\n and ws1.d_year = 2000\n and ws1.ca_county = ws2.ca_county\n and ws2.d_qoy = 2\n and ws2.d_year = 2000\n and ws1.ca_county = ws3.ca_county\n and ws3.d_qoy = 3\n and ws3.d_year =2000\n and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.ca_county; \n\n-- end query 31 in stream 0 using template query31.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "wrClWLZ2HX/mYEq0RQOGHQ==", "id": "test-project-364309:europe-west1.query31_1665777274", "jobReference": { "jobId": "query31_1665777274", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query31_1665777274?location=europe-west1", "statistics": { "creationTime": "1665777274551", "endTime": "1665777275513", "finalExecutionDurationMs": "754", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113949473", "performanceInsights": { "avgPreviousExecutionMs": "936" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.08896797153024912, "computeRatioMax": 0.08896797153024912, "endMs": "1665777274727", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.010676156583629894, "readRatioMax": 0.010676156583629894, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777274695", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ca_address_sk, $101:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03914590747330961, "writeRatioMax": 0.03914590747330961 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.046263345195729534, "computeRatioMax": 0.046263345195729534, "endMs": "1665777274747", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02491103202846975, "readRatioMax": 0.02491103202846975, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777274710", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year, $172:d_qoy", "FROM date_dim", "WHERE and(equal($172, 2), equal($171, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.028469750889679714, "writeRatioMax": 0.028469750889679714 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.12099644128113879, "computeRatioMax": 0.12099644128113879, "endMs": "1665777274772", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.017793594306049824, "readRatioMax": 0.017793594306049824, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777274734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ca_address_sk, $91:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0498220640569395, "writeRatioMax": 0.0498220640569395 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0498220640569395, "computeRatioMax": 0.0498220640569395, "endMs": "1665777274784", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.028469750889679714, "readRatioMax": 0.028469750889679714, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777274747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:d_date_sk, $161:d_year, $162:d_qoy", "FROM date_dim", "WHERE and(equal($162, 1), equal($161, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02491103202846975, "writeRatioMax": 0.02491103202846975 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.1103202846975089, "computeRatioMax": 0.1103202846975089, "endMs": "1665777274806", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02491103202846975, "readRatioMax": 0.02491103202846975, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777274770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.03558718861209965, "writeRatioMax": 0.03558718861209965 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.028469750889679714, "computeRatioMax": 0.028469750889679714, "endMs": "1665777274807", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.017793594306049824, "readRatioMax": 0.017793594306049824, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665777274783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year, $152:d_qoy", "FROM date_dim", "WHERE and(equal($152, 3), equal($151, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.042704626334519574, "writeRatioMax": 0.042704626334519574 }, { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.16725978647686832, "computeRatioMax": 0.16725978647686832, "endMs": "1665777274847", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.017793594306049824, "readRatioMax": 0.017793594306049824, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777274806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03914590747330961, "writeRatioMax": 0.03914590747330961 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03202846975088968, "computeRatioMax": 0.03202846975088968, "endMs": "1665777274851", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02491103202846975, "readRatioMax": 0.02491103202846975, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777274820", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_year, $122:d_qoy", "FROM date_dim", "WHERE and(equal($122, 1), equal($121, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02491103202846975, "writeRatioMax": 0.02491103202846975 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.11743772241992882, "computeRatioMax": 0.11743772241992882, "endMs": "1665777274882", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02491103202846975, "readRatioMax": 0.02491103202846975, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777274844", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03202846975088968, "writeRatioMax": 0.03202846975088968 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02491103202846975, "computeRatioMax": 0.02491103202846975, "endMs": "1665777274883", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.021352313167259787, "readRatioMax": 0.021352313167259787, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "2457", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665777274858", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_qoy", "FROM date_dim", "WHERE and(equal($82, 2), equal($81, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.042704626334519574, "writeRatioMax": 0.042704626334519574 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.12099644128113879, "computeRatioMax": 0.12099644128113879, "endMs": "1665777274920", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.028469750889679714, "readRatioMax": 0.028469750889679714, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1371713", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777274880", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_county", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03914590747330961, "writeRatioMax": 0.03914590747330961 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.046263345195729534, "computeRatioMax": 0.046263345195729534, "endMs": "1665777274924", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02491103202846975, "readRatioMax": 0.02491103202846975, "recordsRead": "73049", "recordsWritten": "92", "shuffleOutputBytes": "2484", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777274894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($32, 3), equal($31, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0498220640569395, "writeRatioMax": 0.0498220640569395 }, { "completedParallelInputs": "6", "computeMsAvg": "143", "computeMsMax": "170", "computeRatioAvg": 0.5088967971530249, "computeRatioMax": 0.604982206405694, "endMs": "1665777275039", "id": "18", "inputStages": [ "1", "0" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "25", "readRatioAvg": 0.05693950177935943, "readRatioMax": 0.08896797153024912, "recordsRead": "3180950", "recordsWritten": "9550", "shuffleOutputBytes": "517376", "shuffleOutputBytesSpilled": "0", "slotMs": "852", "startMs": "1665777274910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_addr_sk, $142:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $373, $381 := $372, $382 := $371", "$300 := SUM($370)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $361, $371 := $362, $372 := $363, $373 := $101", "INNER HASH JOIN EACH WITH ALL ON $360 = $100" ] }, { "kind": "JOIN", "substeps": [ "$360 := $141, $361 := $142, $362 := $171, $363 := $172", "INNER HASH JOIN EACH WITH ALL ON $140 = $170" ] }, { "kind": "WRITE", "substeps": [ "$380, $382, $381, $300", "TO __stage12_output", "BY HASH($380, $381, $382)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0071174377224199285, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.014234875444839857, "writeRatioMax": 0.017793594306049824 }, { "completedParallelInputs": "6", "computeMsAvg": "177", "computeMsMax": "234", "computeRatioAvg": 0.6298932384341637, "computeRatioMax": 0.8327402135231317, "endMs": "1665777275094", "id": "19", "inputStages": [ "4", "3" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "26", "readRatioAvg": 0.06405693950177936, "readRatioMax": 0.09252669039145907, "recordsRead": "3180950", "recordsWritten": "9770", "shuffleOutputBytes": "529269", "shuffleOutputBytesSpilled": "0", "slotMs": "1078", "startMs": "1665777274915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:ss_sold_date_sk, $131:ss_addr_sk, $132:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$160, $161, $162", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $323, $331 := $322, $332 := $321", "$290 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311, $321 := $312, $322 := $313, $323 := $91", "INNER HASH JOIN EACH WITH ALL ON $310 = $90" ] }, { "kind": "JOIN", "substeps": [ "$310 := $131, $311 := $132, $312 := $161, $313 := $162", "INNER HASH JOIN EACH WITH ALL ON $130 = $160" ] }, { "kind": "WRITE", "substeps": [ "$330, $332, $331, $290", "TO __stage13_output", "BY HASH($330, $331, $332)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0071174377224199285, "writeMsAvg": "6", "writeMsMax": "12", "writeRatioAvg": 0.021352313167259787, "writeRatioMax": 0.042704626334519574 }, { "completedParallelInputs": "6", "computeMsAvg": "200", "computeMsMax": "281", "computeRatioAvg": 0.7117437722419929, "computeRatioMax": 1, "endMs": "1665777275100", "id": "20", "inputStages": [ "6", "7" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "33", "readRatioAvg": 0.06405693950177936, "readRatioMax": 0.11743772241992882, "recordsRead": "3180956", "recordsWritten": "10729", "shuffleOutputBytes": "581751", "shuffleOutputBytesSpilled": "0", "slotMs": "1171", "startMs": "1665777274930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:ss_sold_date_sk, $111:ss_addr_sk, $112:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $433, $441 := $432, $442 := $431", "$280 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $423, $433 := $61", "INNER HASH JOIN EACH WITH ALL ON $420 = $60" ] }, { "kind": "JOIN", "substeps": [ "$420 := $111, $421 := $112, $422 := $151, $423 := $152", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$440, $442, $441, $280", "TO __stage14_output", "BY HASH($440, $441, $442)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.028469750889679714, "writeRatioMax": 0.03202846975088968 }, { "completedParallelInputs": "1", "computeMsAvg": "207", "computeMsMax": "207", "computeRatioAvg": 0.7366548042704626, "computeRatioMax": 0.7366548042704626, "endMs": "1665777275107", "id": "21", "inputStages": [ "10", "9" ], "name": "S15: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.0711743772241993, "readRatioMax": 0.0711743772241993, "recordsRead": "769475", "recordsWritten": "942", "shuffleOutputBytes": "50995", "shuffleOutputBytesSpilled": "0", "slotMs": "213", "startMs": "1665777274946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_addr_sk, $72:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $500 := $493, $501 := $492, $502 := $491", "$270 := SUM($490)" ] }, { "kind": "JOIN", "substeps": [ "$490 := $481, $491 := $482, $492 := $483, $493 := $41", "INNER HASH JOIN EACH WITH ALL ON $480 = $40" ] }, { "kind": "JOIN", "substeps": [ "$480 := $71, $481 := $72, $482 := $121, $483 := $122", "INNER HASH JOIN EACH WITH ALL ON $70 = $120" ] }, { "kind": "WRITE", "substeps": [ "$500, $502, $501, $270", "TO __stage15_output", "BY HASH($500, $501, $502)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03202846975088968, "writeRatioMax": 0.03202846975088968 }, { "completedParallelInputs": "1", "computeMsAvg": "178", "computeMsMax": "178", "computeRatioAvg": 0.6334519572953736, "computeRatioMax": 0.6334519572953736, "endMs": "1665777275086", "id": "22", "inputStages": [ "13", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.06405693950177936, "readRatioMax": 0.06405693950177936, "recordsRead": "769475", "recordsWritten": "935", "shuffleOutputBytes": "50516", "shuffleOutputBytesSpilled": "0", "slotMs": "173", "startMs": "1665777274960", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_sold_date_sk, $51:ws_bill_addr_sk, $52:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $553, $561 := $552, $562 := $551", "$240 := SUM($550)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $543, $553 := $21", "INNER HASH JOIN EACH WITH ALL ON $540 = $20" ] }, { "kind": "JOIN", "substeps": [ "$540 := $51, $541 := $52, $542 := $81, $543 := $82", "INNER HASH JOIN EACH WITH ALL ON $50 = $80" ] }, { "kind": "WRITE", "substeps": [ "$560, $562, $561, $240", "TO __stage16_output", "BY HASH($560, $561, $562)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.028469750889679714, "writeRatioMax": 0.028469750889679714 }, { "completedParallelInputs": "1", "computeMsAvg": "264", "computeMsMax": "264", "computeRatioAvg": 0.9395017793594306, "computeRatioMax": 0.9395017793594306, "endMs": "1665777275127", "id": "23", "inputStages": [ "16", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.042704626334519574, "readRatioMax": 0.042704626334519574, "recordsRead": "769476", "recordsWritten": "1261", "shuffleOutputBytes": "68335", "shuffleOutputBytesSpilled": "0", "slotMs": "220", "startMs": "1665777274975", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_addr_sk, $12:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $620 := $613, $621 := $612, $622 := $611", "$210 := SUM($610)" ] }, { "kind": "JOIN", "substeps": [ "$610 := $601, $611 := $602, $612 := $603, $613 := $2", "INNER HASH JOIN EACH WITH ALL ON $600 = $1" ] }, { "kind": "JOIN", "substeps": [ "$600 := $11, $601 := $12, $602 := $31, $603 := $32", "INNER HASH JOIN EACH WITH ALL ON $10 = $30" ] }, { "kind": "WRITE", "substeps": [ "$620, $622, $621, $210", "TO __stage17_output", "BY HASH($620, $621, $622)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02491103202846975, "writeRatioMax": 0.02491103202846975 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.06405693950177936, "computeRatioMax": 0.06405693950177936, "endMs": "1665777275197", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1261", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777275172", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $622, $621, $210", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $620, $631 := $621, $632 := $622", "$190 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$190, $630", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.046263345195729534, "writeRatioMax": 0.046263345195729534 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.046263345195729534, "computeRatioMax": 0.046263345195729534, "endMs": "1665777275208", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "935", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665777275185", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$560, $562, $561, $240", "FROM __stage16_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560, $571 := $561, $572 := $562", "$200 := SUM($240)" ] }, { "kind": "WRITE", "substeps": [ "$200, $570", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.046263345195729534, "writeRatioMax": 0.046263345195729534 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0498220640569395, "computeRatioMax": 0.0498220640569395, "endMs": "1665777275230", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "942", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777275197", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$500, $502, $501, $270", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$220 := SUM($270)" ] }, { "kind": "WRITE", "substeps": [ "$220, $510", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05338078291814947, "writeRatioMax": 0.05338078291814947 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.046263345195729534, "computeRatioMax": 0.046263345195729534, "endMs": "1665777275232", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10729", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665777275209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $442, $441, $280", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442", "$230 := SUM($280)" ] }, { "kind": "WRITE", "substeps": [ "$230, $450", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.042704626334519574, "writeRatioMax": 0.042704626334519574 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.06405693950177936, "computeRatioMax": 0.06405693950177936, "endMs": "1665777275261", "id": "28", "inputStages": [ "18" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9550", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777275224", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $382, $381, $300", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382", "$260 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$260, $390", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.03558718861209965, "writeRatioMax": 0.03558718861209965 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.028469750889679714, "computeRatioMax": 0.060498220640569395, "endMs": "1665777275336", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1656", "recordsWritten": "1656", "shuffleOutputBytes": "59983", "shuffleOutputBytesSpilled": "0", "slotMs": "3729", "startMs": "1665777275271", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "8", "waitRatioAvg": 0.0071174377224199285, "waitRatioMax": 0.028469750889679714, "writeMsAvg": "27", "writeMsMax": "54", "writeRatioAvg": 0.09608540925266904, "writeRatioMax": 0.19217081850533807 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "18", "computeRatioAvg": 0.02491103202846975, "computeRatioMax": 0.06405693950177936, "endMs": "1665777275321", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1808", "recordsWritten": "1808", "shuffleOutputBytes": "65523", "shuffleOutputBytesSpilled": "0", "slotMs": "2780", "startMs": "1665777275272", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.028469750889679714, "waitRatioMax": 0.03558718861209965, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.0498220640569395, "writeRatioMax": 0.06761565836298933 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.02491103202846975, "computeRatioMax": 0.05693950177935943, "endMs": "1665777275322", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "941", "recordsWritten": "941", "shuffleOutputBytes": "34021", "shuffleOutputBytesSpilled": "0", "slotMs": "2380", "startMs": "1665777275273", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.03202846975088968, "waitRatioMax": 0.03558718861209965, "writeMsAvg": "7", "writeMsMax": "18", "writeRatioAvg": 0.02491103202846975, "writeRatioMax": 0.06405693950177936 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.02491103202846975, "computeRatioMax": 0.0498220640569395, "endMs": "1665777275322", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "934", "recordsWritten": "934", "shuffleOutputBytes": "33668", "shuffleOutputBytesSpilled": "0", "slotMs": "2318", "startMs": "1665777275274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "10", "waitMsMax": "11", "waitRatioAvg": 0.03558718861209965, "waitRatioMax": 0.03914590747330961, "writeMsAvg": "4", "writeMsMax": "20", "writeRatioAvg": 0.014234875444839857, "writeRatioMax": 0.0711743772241993 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.028469750889679714, "computeRatioMax": 0.0711743772241993, "endMs": "1665777275324", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1260", "recordsWritten": "1260", "shuffleOutputBytes": "45619", "shuffleOutputBytesSpilled": "0", "slotMs": "2545", "startMs": "1665777275274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.03558718861209965, "waitRatioMax": 0.042704626334519574, "writeMsAvg": "6", "writeMsMax": "17", "writeRatioAvg": 0.021352313167259787, "writeRatioMax": 0.060498220640569395 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.09252669039145907, "computeRatioMax": 0.09252669039145907, "endMs": "1665777275362", "id": "35", "inputStages": [ "32", "34", "33", "19", "31", "30" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "16369", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777275289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330, $332, $331, $290", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$260, $390", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$230, $450", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$220, $510", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$200, $570", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$190, $630", "FROM __stage22_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := divide($642, $643)", "$181 := divide($646, $645)", "$182 := divide($647, $642)", "$183 := divide($644, $646)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($642, NUMERIC<...>), divide($647, $642), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$640 := $581, $641 := $582, $642 := $587, $643 := $583, $644 := $584, $645 := $585, $646 := $586, $647 := $190", "INNER HASH JOIN EACH WITH ALL ON $580 = $630" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($583, NUMERIC<...>), divide($587, $583), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $525, $581 := $520, $582 := $521, $583 := $526, $584 := $522, $585 := $523, $586 := $524, $587 := $200", "INNER HASH JOIN EACH WITH ALL ON $525 = $570" ] }, { "kind": "JOIN", "substeps": [ "$520 := $460, $521 := $461, $522 := $464, $523 := $462, $524 := $463, $525 := $510, $526 := $220", "INNER HASH JOIN EACH WITH ALL ON $460 = $510" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $404, $464 := $230", "INNER HASH JOIN EACH WITH ALL ON $403 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $340, $401 := $342, $402 := $250, $403 := $390, $404 := $260", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $340 := $330, $341 := $331, $342 := $332", "$250 := SUM($290)" ] }, { "kind": "WRITE", "substeps": [ "$640, $641, $180, $181, $182, $183", "TO __stage23_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.021352313167259787, "waitRatioMax": 0.021352313167259787, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010676156583629894, "writeRatioMax": 0.010676156583629894 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03914590747330961, "computeRatioMax": 0.03914590747330961, "endMs": "1665777275418", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "4870", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777275380", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$640, $641, $180, $181, $182, $183", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654, $655", "TO __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035587188612099642, "waitRatioMax": 0.0035587188612099642, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05338078291814947, "writeRatioMax": 0.05338078291814947 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "33", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "4342" }, { "activeUnits": "2", "completedUnits": "540", "elapsedMs": "856", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "18045" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113949473", "totalPartitionsProcessed": "0", "totalSlotMs": "18045", "transferredBytes": "0" }, "startTime": "1665777274602", "totalBytesProcessed": "113949473", "totalSlotMs": "18045" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
