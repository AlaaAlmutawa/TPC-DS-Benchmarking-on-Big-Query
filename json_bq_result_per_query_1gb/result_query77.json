{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7157396b_caf1_4e25_be18_23065a43f75e" }, "priority": "INTERACTIVE", "query": "with ss as\r\n (select s_store_sk,\r\n sum(ss_ext_sales_price) as sales,\r\n sum(ss_net_profit) as profit\r\n from store_sales,\r\n date_dim,\r\n store\r\n where ss_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date) \r\n and (cast('2000-09-22' as date)) \r\n and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n sum(sr_return_amt) as returns,\r\n sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n date_dim,\r\n store\r\n where sr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n sum(cs_ext_sales_price) as sales,\r\n sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n sum(cr_return_amount) as returns,\r\n sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n sum(ws_ext_sales_price) as sales,\r\n sum(ws_net_profit) as profit\r\n from web_sales,\r\n date_dim,\r\n web_page\r\n where ws_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n sum(wr_return_amt) as returns,\r\n sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n date_dim,\r\n web_page\r\n where wr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select channel\r\n , id\r\n , sum(sales) as sales\r\n , sum(returns) as returns\r\n , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n , ss.s_store_sk as id\r\n , sales\r\n , coalesce(returns, 0) as returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ss left join sr\r\n on ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n , cs_call_center_sk as id\r\n , sales\r\n , returns\r\n , (profit - profit_loss) as profit\r\n from cs\r\n , cr\r\n union all\r\n select 'web channel' as channel\r\n , ws.wp_web_page_sk as id\r\n , sales\r\n , coalesce(returns, 0) returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ws left join wr\r\n on ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n ,id\r\n limit 100\r\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "LzfLoJoT+8wdpT/jj5McXw==", "id": "test-project-364309:europe-west1.query77_1665768471", "jobReference": { "jobId": "query77_1665768471", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query77_1665768471?location=europe-west1", "statistics": { "creationTime": "1665768471835", "endTime": "1665768473062", "finalExecutionDurationMs": "914", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "260079328", "performanceInsights": { "avgPreviousExecutionMs": "767" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.035398230088495575, "computeRatioMax": 0.035398230088495575, "endMs": "1665768472139", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.061946902654867256, "readRatioMax": 0.061946902654867256, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768472098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0752212389380531, "writeRatioMax": 0.0752212389380531 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.084070796460177, "computeRatioMax": 0.084070796460177, "endMs": "1665768472177", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04424778761061947, "readRatioMax": 0.04424778761061947, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768472122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_date", "FROM date_dim", "WHERE between($151, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage01_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.09734513274336283, "writeRatioMax": 0.09734513274336283 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.035398230088495575, "computeRatioMax": 0.035398230088495575, "endMs": "1665768472213", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.035398230088495575, "readRatioMax": 0.035398230088495575, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768472178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.08849557522123894, "writeRatioMax": 0.08849557522123894 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.07079646017699115, "computeRatioMax": 0.07079646017699115, "endMs": "1665768472243", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030973451327433628, "readRatioMax": 0.030973451327433628, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768472201", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage04_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.10619469026548672, "writeRatioMax": 0.10619469026548672 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0752212389380531, "computeRatioMax": 0.0752212389380531, "endMs": "1665768472297", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030973451327433628, "readRatioMax": 0.030973451327433628, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768472243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_date", "FROM date_dim", "WHERE between($91, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0752212389380531, "writeRatioMax": 0.0752212389380531 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.07079646017699115, "computeRatioMax": 0.07079646017699115, "endMs": "1665768472327", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030973451327433628, "readRatioMax": 0.030973451327433628, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768472289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date", "FROM date_dim", "WHERE between($81, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.035398230088495575, "writeRatioMax": 0.035398230088495575 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.048672566371681415, "computeRatioMax": 0.048672566371681415, "endMs": "1665768472377", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.017699115044247787, "readRatioMax": 0.017699115044247787, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768472324", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.12831858407079647, "writeRatioMax": 0.12831858407079647 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.07079646017699115, "computeRatioMax": 0.07079646017699115, "endMs": "1665768472398", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.035398230088495575, "readRatioMax": 0.035398230088495575, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768472352", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_date", "FROM date_dim", "WHERE between($131, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0B_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.048672566371681415, "waitRatioMax": 0.048672566371681415, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.10619469026548672, "writeRatioMax": 0.10619469026548672 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.030973451327433628, "computeRatioMax": 0.030973451327433628, "endMs": "1665768472425", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.01327433628318584, "readRatioMax": 0.01327433628318584, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768472385", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07079646017699115, "writeRatioMax": 0.07079646017699115 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.06637168141592921, "computeRatioMax": 0.06637168141592921, "endMs": "1665768472450", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.030973451327433628, "readRatioMax": 0.030973451327433628, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768472408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_date", "FROM date_dim", "WHERE between($121, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05752212389380531, "writeRatioMax": 0.05752212389380531 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.16371681415929204, "computeRatioMax": 0.16371681415929204, "endMs": "1665768472488", "id": "16", "inputStages": [ "1", "0" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.05309734513274336, "readRatioMax": 0.05309734513274336, "recordsRead": "71854", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768472445", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $592", "$370 := SUM($590)", "$371 := SUM($591)" ] }, { "kind": "JOIN", "substeps": [ "$590 := $581, $591 := $582, $592 := $50", "INNER HASH JOIN EACH WITH ALL ON $580 = $50" ] }, { "kind": "JOIN", "substeps": [ "$580 := $111, $581 := $112, $582 := $113", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$600, $370, $371", "TO __stage10_output", "BY HASH($600)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02654867256637168, "writeRatioMax": 0.02654867256637168 }, { "completedParallelInputs": "1", "computeMsAvg": "223", "computeMsMax": "223", "computeRatioAvg": 0.9867256637168141, "computeRatioMax": 0.9867256637168141, "endMs": "1665768472641", "id": "17", "inputStages": [ "4", "3" ], "name": "S11: Join+", "parallelInputs": "1", "readMsAvg": "34", "readMsMax": "34", "readRatioAvg": 0.1504424778761062, "readRatioMax": 0.1504424778761062, "recordsRead": "719475", "recordsWritten": "30", "shuffleOutputBytes": "1290", "shuffleOutputBytesSpilled": "0", "slotMs": "214", "startMs": "1665768472464", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $552", "$360 := SUM($550)", "$361 := SUM($551)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $40", "INNER HASH JOIN EACH WITH ALL ON $540 = $40" ] }, { "kind": "JOIN", "substeps": [ "$540 := $101, $541 := $102, $542 := $103", "INNER HASH JOIN EACH WITH ALL ON $100 = $140" ] }, { "kind": "WRITE", "substeps": [ "$560, $360, $361", "TO __stage11_output", "BY HASH($560)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02654867256637168, "writeRatioMax": 0.02654867256637168 }, { "completedParallelInputs": "1", "computeMsAvg": "50", "computeMsMax": "50", "computeRatioAvg": 0.22123893805309736, "computeRatioMax": 0.22123893805309736, "endMs": "1665768472538", "id": "18", "inputStages": [ "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.07079646017699115, "readRatioMax": 0.07079646017699115, "recordsRead": "144098", "recordsWritten": "5", "shuffleOutputBytes": "207", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665768472479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500", "$350 := SUM($501)", "$351 := SUM($502)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $31, $501 := $32, $502 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $90" ] }, { "kind": "WRITE", "substeps": [ "$510, $350, $351", "TO __stage12_output", "BY HASH($510)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02654867256637168, "writeRatioMax": 0.02654867256637168 }, { "completedParallelInputs": "5", "computeMsAvg": "114", "computeMsMax": "150", "computeRatioAvg": 0.504424778761062, "computeRatioMax": 0.6637168141592921, "endMs": "1665768472606", "id": "19", "inputStages": [ "8" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "18", "readMsMax": "30", "readRatioAvg": 0.07964601769911504, "readRatioMax": 0.13274336283185842, "recordsRead": "1441703", "recordsWritten": "20", "shuffleOutputBytes": "820", "shuffleOutputBytesSpilled": "0", "slotMs": "580", "startMs": "1665768472498", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$340 := SUM($471)", "$341 := SUM($472)" ] }, { "kind": "JOIN", "substeps": [ "$470 := $21, $471 := $22, $472 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $80" ] }, { "kind": "WRITE", "substeps": [ "$480, $340, $341", "TO __stage13_output", "BY HASH($480)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.030973451327433628, "writeRatioMax": 0.035398230088495575 }, { "completedParallelInputs": "1", "computeMsAvg": "114", "computeMsMax": "114", "computeRatioAvg": 0.504424778761062, "computeRatioMax": 0.504424778761062, "endMs": "1665768472596", "id": "20", "inputStages": [ "11", "10" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03982300884955752, "readRatioMax": 0.03982300884955752, "recordsRead": "287557", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "112", "startMs": "1665768472507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $432", "$330 := SUM($430)", "$331 := SUM($431)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $10", "INNER HASH JOIN EACH WITH ALL ON $420 = $10" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72, $422 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $130" ] }, { "kind": "WRITE", "substeps": [ "$440, $330, $331", "TO __stage14_output", "BY HASH($440)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.017699115044247787, "writeRatioMax": 0.017699115044247787 }, { "completedParallelInputs": "6", "computeMsAvg": "177", "computeMsMax": "226", "computeRatioAvg": 0.7831858407079646, "computeRatioMax": 1, "endMs": "1665768472669", "id": "21", "inputStages": [ "14", "13" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "21", "readRatioAvg": 0.07964601769911504, "readRatioMax": 0.09292035398230089, "recordsRead": "2880662", "recordsWritten": "36", "shuffleOutputBytes": "1548", "shuffleOutputBytesSpilled": "0", "slotMs": "977", "startMs": "1665768472517", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $392", "$320 := SUM($390)", "$321 := SUM($391)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $382, $392 := $1", "INNER HASH JOIN EACH WITH ALL ON $380 = $1" ] }, { "kind": "JOIN", "substeps": [ "$380 := $61, $381 := $62, $382 := $63", "INNER HASH JOIN EACH WITH ALL ON $60 = $120" ] }, { "kind": "WRITE", "substeps": [ "$400, $320, $321", "TO __stage15_output", "BY HASH($400)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.022123893805309734, "writeRatioMax": 0.030973451327433628 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.048672566371681415, "computeRatioMax": 0.048672566371681415, "endMs": "1665768472753", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768472702", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $370, $371", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600", "$310 := SUM($370)", "$311 := SUM($371)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $610", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "40", "writeMsMax": "40", "writeRatioAvg": 0.17699115044247787, "writeRatioMax": 0.17699115044247787 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03982300884955752, "computeRatioMax": 0.03982300884955752, "endMs": "1665768472779", "id": "23", "inputStages": [ "18" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "170", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768472720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$510, $350, $351", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510", "$290 := SUM($350)", "$291 := SUM($351)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.061946902654867256, "writeRatioMax": 0.061946902654867256 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.035398230088495575, "computeRatioMax": 0.035398230088495575, "endMs": "1665768472779", "id": "24", "inputStages": [ "19" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665768472736", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $340, $341", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $490", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06637168141592921, "writeRatioMax": 0.06637168141592921 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05309734513274336, "computeRatioMax": 0.05309734513274336, "endMs": "1665768472799", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768472750", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $330, $331", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $450", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004424778761061947, "waitRatioMax": 0.004424778761061947, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05309734513274336, "writeRatioMax": 0.05309734513274336 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.035398230088495575, "computeRatioMax": 0.061946902654867256, "endMs": "1665768472843", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "5587", "startMs": "1665768472757", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "4", "waitMsMax": "28", "waitRatioAvg": 0.017699115044247787, "waitRatioMax": 0.12389380530973451, "writeMsAvg": "49", "writeMsMax": "61", "writeRatioAvg": 0.2168141592920354, "writeRatioMax": 0.26991150442477874 }, { "completedParallelInputs": "40", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.035398230088495575, "computeRatioMax": 0.061946902654867256, "endMs": "1665768472841", "id": "27", "inputStages": [ "24" ], "name": "S1B: Coalesce", "parallelInputs": "40", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "1328", "startMs": "1665768472786", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.02654867256637168, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.06637168141592921, "writeRatioMax": 0.11946902654867257 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.035398230088495575, "computeRatioMax": 0.07964601769911504, "endMs": "1665768472872", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "2982", "startMs": "1665768472818", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.017699115044247787, "waitRatioMax": 0.02654867256637168, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.06637168141592921, "writeRatioMax": 0.11946902654867257 }, { "completedParallelInputs": "42", "computeMsAvg": "11", "computeMsMax": "20", "computeRatioAvg": 0.048672566371681415, "computeRatioMax": 0.08849557522123894, "endMs": "1665768472881", "id": "29", "inputStages": [ "23", "17", "28", "21", "26", "27" ], "name": "S1D: Join+", "parallelInputs": "42", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "137", "recordsWritten": "70", "shuffleOutputBytes": "5807", "shuffleOutputBytesSpilled": "0", "slotMs": "1427", "startMs": "1665768472835", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $450", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$280, $281, $490", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$560, $360, $361", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$310, $311, $610", "FROM __stage1A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $180, $631 := $181, $632 := $200", "$170 := SUM($212)", "$171 := SUM($213)", "$172 := SUM($214)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(equal(bitwise_and($220, 1), 0), NULL, $210)", "$181 := if(equal(bitwise_and($220, 2), 0), NULL, $211)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := 'store channel'", "$231 := coalesce($463, NUMERIC<...>)", "$232 := subtract($462, coalesce($464, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$460 := $410, $461 := $260, $462 := $261, $463 := $270, $464 := $271", "LEFT OUTER HASH JOIN EACH WITH ALL ON $410 = $450" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$260 := SUM($320)", "$261 := SUM($321)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'catalog channel'", "$241 := subtract($532, $534)" ] }, { "kind": "JOIN", "substeps": [ "$530 := $490, $531 := $280, $532 := $281, $533 := $290, $534 := $291", "CROSS EACH WITH EACH " ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'web channel'", "$251 := coalesce($623, NUMERIC<...>)", "$252 := subtract($622, coalesce($624, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$620 := $570, $621 := $300, $622 := $301, $623 := $310, $624 := $311", "LEFT OUTER HASH JOIN EACH WITH ALL ON $570 = $610" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := subtract($221, 1)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $630, $631, $632", "TO __stage1D_output", "BY HASH($630, $631, $632)" ] } ], "waitMsAvg": "4", "waitMsMax": "7", "waitRatioAvg": 0.017699115044247787, "waitRatioMax": 0.030973451327433628, "writeMsAvg": "13", "writeMsMax": "21", "writeRatioAvg": 0.05752212389380531, "writeRatioMax": 0.09292035398230089 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.030973451327433628, "computeRatioMax": 0.030973451327433628, "endMs": "1665768472928", "id": "30", "inputStages": [ "29" ], "name": "S1E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "70", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768472889", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $630, $631, $632", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC, $641 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $630, $641 := $631, $642 := $632", "$160 := SUM($170)", "$161 := SUM($171)", "$162 := SUM($172)" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654", "TO __stage1E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.11946902654867257, "writeRatioMax": 0.11946902654867257 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.048672566371681415, "computeRatioMax": 0.048672566371681415, "endMs": "1665768472958", "id": "31", "inputStages": [ "30" ], "name": "S1F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "44", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768472921", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $651, $652, $653, $654", "FROM __stage1E_output" ] }, { "kind": "SORT", "substeps": [ "$653 ASC, $654 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664", "TO __stage1F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01327433628318584, "waitRatioMax": 0.01327433628318584, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06637168141592921, "writeRatioMax": 0.06637168141592921 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "11", "completedUnits": "16", "elapsedMs": "700", "estimatedRunnableUnits": "0", "pendingUnits": "9", "totalSlotMs": "1435" }, { "activeUnits": "9", "completedUnits": "313", "elapsedMs": "1113", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14129" } ], "totalBytesBilled": "261095424", "totalBytesProcessed": "260079328", "totalPartitionsProcessed": "0", "totalSlotMs": "14129", "transferredBytes": "0" }, "startTime": "1665768471901", "totalBytesProcessed": "260079328", "totalSlotMs": "14129" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf3b9c8ac_0cd3_4e63_877a_d3cb8518d2bd" }, "priority": "INTERACTIVE", "query": "with ss as\r\n (select s_store_sk,\r\n sum(ss_ext_sales_price) as sales,\r\n sum(ss_net_profit) as profit\r\n from store_sales,\r\n date_dim,\r\n store\r\n where ss_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date) \r\n and (cast('2000-09-22' as date)) \r\n and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n sum(sr_return_amt) as returns,\r\n sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n date_dim,\r\n store\r\n where sr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n sum(cs_ext_sales_price) as sales,\r\n sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n sum(cr_return_amount) as returns,\r\n sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n sum(ws_ext_sales_price) as sales,\r\n sum(ws_net_profit) as profit\r\n from web_sales,\r\n date_dim,\r\n web_page\r\n where ws_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n sum(wr_return_amt) as returns,\r\n sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n date_dim,\r\n web_page\r\n where wr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select channel\r\n , id\r\n , sum(sales) as sales\r\n , sum(returns) as returns\r\n , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n , ss.s_store_sk as id\r\n , sales\r\n , coalesce(returns, 0) as returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ss left join sr\r\n on ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n , cs_call_center_sk as id\r\n , sales\r\n , returns\r\n , (profit - profit_loss) as profit\r\n from cs\r\n , cr\r\n union all\r\n select 'web channel' as channel\r\n , ws.wp_web_page_sk as id\r\n , sales\r\n , coalesce(returns, 0) returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ws left join wr\r\n on ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n ,id\r\n limit 100\r\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "qOqk1ebVTQTgESY9C/qpqw==", "id": "test-project-364309:europe-west1.query77_1665778576", "jobReference": { "jobId": "query77_1665778576", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query77_1665778576?location=europe-west1", "statistics": { "creationTime": "1665778576955", "endTime": "1665778578019", "finalExecutionDurationMs": "760", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "260079328", "performanceInsights": { "avgPreviousExecutionMs": "803" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03065134099616858, "computeRatioMax": 0.03065134099616858, "endMs": "1665778577246", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.08045977011494253, "readRatioMax": 0.08045977011494253, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778577213", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.019157088122605363, "writeRatioMax": 0.019157088122605363 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665778577265", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02681992337164751, "readRatioMax": 0.02681992337164751, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778577226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_date", "FROM date_dim", "WHERE between($151, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.034482758620689655, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665778577312", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02681992337164751, "readRatioMax": 0.02681992337164751, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778577265", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "12", "waitMsMax": "12", "waitRatioAvg": 0.04597701149425287, "waitRatioMax": 0.04597701149425287, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.06896551724137931, "writeRatioMax": 0.06896551724137931 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.06513409961685823, "computeRatioMax": 0.06513409961685823, "endMs": "1665778577322", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0421455938697318, "readRatioMax": 0.0421455938697318, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778577286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage04_output" ] } ], "waitMsAvg": "19", "waitMsMax": "19", "waitRatioAvg": 0.07279693486590039, "waitRatioMax": 0.07279693486590039, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.05363984674329502, "computeRatioMax": 0.05363984674329502, "endMs": "1665778577334", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.034482758620689655, "readRatioMax": 0.034482758620689655, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778577303", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_date", "FROM date_dim", "WHERE between($91, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04980842911877394, "computeRatioMax": 0.04980842911877394, "endMs": "1665778577370", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.022988505747126436, "readRatioMax": 0.022988505747126436, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778577331", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date", "FROM date_dim", "WHERE between($81, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02681992337164751, "computeRatioMax": 0.02681992337164751, "endMs": "1665778577387", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01532567049808429, "readRatioMax": 0.01532567049808429, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778577359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06513409961685823, "writeRatioMax": 0.06513409961685823 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665778577410", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019157088122605363, "readRatioMax": 0.019157088122605363, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778577372", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_date", "FROM date_dim", "WHERE between($131, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0B_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.019157088122605363, "computeRatioMax": 0.019157088122605363, "endMs": "1665778577437", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01532567049808429, "readRatioMax": 0.01532567049808429, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778577399", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06130268199233716, "writeRatioMax": 0.06130268199233716 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04980842911877394, "computeRatioMax": 0.04980842911877394, "endMs": "1665778577448", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.022988505747126436, "readRatioMax": 0.022988505747126436, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778577410", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_date", "FROM date_dim", "WHERE between($121, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.12260536398467432, "computeRatioMax": 0.12260536398467432, "endMs": "1665778577478", "id": "16", "inputStages": [ "1", "0" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.034482758620689655, "readRatioMax": 0.034482758620689655, "recordsRead": "71854", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778577436", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $592", "$370 := SUM($590)", "$371 := SUM($591)" ] }, { "kind": "JOIN", "substeps": [ "$590 := $581, $591 := $582, $592 := $50", "INNER HASH JOIN EACH WITH ALL ON $580 = $50" ] }, { "kind": "JOIN", "substeps": [ "$580 := $111, $581 := $112, $582 := $113", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$600, $370, $371", "TO __stage10_output", "BY HASH($600)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.022988505747126436, "writeRatioMax": 0.022988505747126436 }, { "completedParallelInputs": "1", "computeMsAvg": "261", "computeMsMax": "261", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778577635", "id": "17", "inputStages": [ "4", "3" ], "name": "S11: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.0842911877394636, "readRatioMax": 0.0842911877394636, "recordsRead": "719475", "recordsWritten": "30", "shuffleOutputBytes": "1290", "shuffleOutputBytesSpilled": "0", "slotMs": "259", "startMs": "1665778577453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $552", "$360 := SUM($550)", "$361 := SUM($551)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $40", "INNER HASH JOIN EACH WITH ALL ON $540 = $40" ] }, { "kind": "JOIN", "substeps": [ "$540 := $101, $541 := $102, $542 := $103", "INNER HASH JOIN EACH WITH ALL ON $100 = $140" ] }, { "kind": "WRITE", "substeps": [ "$560, $360, $361", "TO __stage11_output", "BY HASH($560)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02681992337164751, "writeRatioMax": 0.02681992337164751 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.1685823754789272, "computeRatioMax": 0.1685823754789272, "endMs": "1665778577513", "id": "18", "inputStages": [ "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.034482758620689655, "readRatioMax": 0.034482758620689655, "recordsRead": "144098", "recordsWritten": "5", "shuffleOutputBytes": "207", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778577468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500", "$350 := SUM($501)", "$351 := SUM($502)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $31, $501 := $32, $502 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $90" ] }, { "kind": "WRITE", "substeps": [ "$510, $350, $351", "TO __stage12_output", "BY HASH($510)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.019157088122605363, "writeRatioMax": 0.019157088122605363 }, { "completedParallelInputs": "5", "computeMsAvg": "117", "computeMsMax": "149", "computeRatioAvg": 0.4482758620689655, "computeRatioMax": 0.5708812260536399, "endMs": "1665778577582", "id": "19", "inputStages": [ "8" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "17", "readMsMax": "23", "readRatioAvg": 0.06513409961685823, "readRatioMax": 0.08812260536398467, "recordsRead": "1441703", "recordsWritten": "20", "shuffleOutputBytes": "820", "shuffleOutputBytesSpilled": "0", "slotMs": "615", "startMs": "1665778577483", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$340 := SUM($471)", "$341 := SUM($472)" ] }, { "kind": "JOIN", "substeps": [ "$470 := $21, $471 := $22, $472 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $80" ] }, { "kind": "WRITE", "substeps": [ "$480, $340, $341", "TO __stage13_output", "BY HASH($480)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02681992337164751, "writeRatioMax": 0.02681992337164751 }, { "completedParallelInputs": "1", "computeMsAvg": "179", "computeMsMax": "179", "computeRatioAvg": 0.685823754789272, "computeRatioMax": 0.685823754789272, "endMs": "1665778577599", "id": "20", "inputStages": [ "11", "10" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.04980842911877394, "readRatioMax": 0.04980842911877394, "recordsRead": "287557", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "161", "startMs": "1665778577490", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $432", "$330 := SUM($430)", "$331 := SUM($431)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $10", "INNER HASH JOIN EACH WITH ALL ON $420 = $10" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72, $422 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $130" ] }, { "kind": "WRITE", "substeps": [ "$440, $330, $331", "TO __stage14_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01532567049808429, "writeRatioMax": 0.01532567049808429 }, { "completedParallelInputs": "6", "computeMsAvg": "172", "computeMsMax": "216", "computeRatioAvg": 0.6590038314176245, "computeRatioMax": 0.8275862068965517, "endMs": "1665778577631", "id": "21", "inputStages": [ "14", "13" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "23", "readRatioAvg": 0.06513409961685823, "readRatioMax": 0.08812260536398467, "recordsRead": "2880662", "recordsWritten": "36", "shuffleOutputBytes": "1548", "shuffleOutputBytesSpilled": "0", "slotMs": "915", "startMs": "1665778577494", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $392", "$320 := SUM($390)", "$321 := SUM($391)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $382, $392 := $1", "INNER HASH JOIN EACH WITH ALL ON $380 = $1" ] }, { "kind": "JOIN", "substeps": [ "$380 := $61, $381 := $62, $382 := $63", "INNER HASH JOIN EACH WITH ALL ON $60 = $120" ] }, { "kind": "WRITE", "substeps": [ "$400, $320, $321", "TO __stage15_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.019157088122605363, "writeRatioMax": 0.022988505747126436 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665778577718", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665778577661", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $370, $371", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600", "$310 := SUM($370)", "$311 := SUM($371)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $610", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.10344827586206896, "writeRatioMax": 0.10344827586206896 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665778577713", "id": "23", "inputStages": [ "18" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "170", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778577678", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$510, $350, $351", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510", "$290 := SUM($350)", "$291 := SUM($351)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05363984674329502, "writeRatioMax": 0.05363984674329502 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.034482758620689655, "computeRatioMax": 0.034482758620689655, "endMs": "1665778577726", "id": "24", "inputStages": [ "19" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778577694", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $340, $341", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $490", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.09578544061302682, "writeRatioMax": 0.09578544061302682 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665778577750", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778577712", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $330, $331", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $450", "TO __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06130268199233716, "writeRatioMax": 0.06130268199233716 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.03065134099616858, "computeRatioMax": 0.07662835249042145, "endMs": "1665778577786", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "3481", "startMs": "1665778577732", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.01532567049808429, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.05363984674329502, "writeRatioMax": 0.0842911877394636 }, { "completedParallelInputs": "40", "computeMsAvg": "8", "computeMsMax": "12", "computeRatioAvg": 0.03065134099616858, "computeRatioMax": 0.04597701149425287, "endMs": "1665778577776", "id": "27", "inputStages": [ "24" ], "name": "S1B: Coalesce", "parallelInputs": "40", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "1354", "startMs": "1665778577733", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.01532567049808429, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.05363984674329502, "writeRatioMax": 0.09578544061302682 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.03065134099616858, "computeRatioMax": 0.08045977011494253, "endMs": "1665778577822", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "4026", "startMs": "1665778577759", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "18", "writeMsMax": "49", "writeRatioAvg": 0.06896551724137931, "writeRatioMax": 0.18773946360153257 }, { "completedParallelInputs": "42", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.038314176245210725, "computeRatioMax": 0.07662835249042145, "endMs": "1665778577832", "id": "29", "inputStages": [ "28", "23", "27", "26", "17", "21" ], "name": "S1D: Join+", "parallelInputs": "42", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "137", "recordsWritten": "70", "shuffleOutputBytes": "5807", "shuffleOutputBytesSpilled": "0", "slotMs": "1597", "startMs": "1665778577781", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $450", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$280, $281, $490", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$560, $360, $361", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$310, $311, $610", "FROM __stage1A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $180, $631 := $181, $632 := $200", "$170 := SUM($212)", "$171 := SUM($213)", "$172 := SUM($214)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(equal(bitwise_and($220, 1), 0), NULL, $210)", "$181 := if(equal(bitwise_and($220, 2), 0), NULL, $211)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := 'store channel'", "$231 := coalesce($463, NUMERIC<...>)", "$232 := subtract($462, coalesce($464, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$460 := $410, $461 := $260, $462 := $261, $463 := $270, $464 := $271", "LEFT OUTER HASH JOIN EACH WITH ALL ON $410 = $450" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$260 := SUM($320)", "$261 := SUM($321)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'catalog channel'", "$241 := subtract($532, $534)" ] }, { "kind": "JOIN", "substeps": [ "$530 := $490, $531 := $280, $532 := $281, $533 := $290, $534 := $291", "CROSS EACH WITH EACH " ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'web channel'", "$251 := coalesce($623, NUMERIC<...>)", "$252 := subtract($622, coalesce($624, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$620 := $570, $621 := $300, $622 := $301, $623 := $310, $624 := $311", "LEFT OUTER HASH JOIN EACH WITH ALL ON $570 = $610" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := subtract($221, 1)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $630, $631, $632", "TO __stage1D_output", "BY HASH($630, $631, $632)" ] } ], "waitMsAvg": "4", "waitMsMax": "9", "waitRatioAvg": 0.01532567049808429, "waitRatioMax": 0.034482758620689655, "writeMsAvg": "13", "writeMsMax": "24", "writeRatioAvg": 0.04980842911877394, "writeRatioMax": 0.09195402298850575 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.022988505747126436, "computeRatioMax": 0.022988505747126436, "endMs": "1665778577877", "id": "30", "inputStages": [ "29" ], "name": "S1E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "70", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778577839", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $630, $631, $632", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC, $641 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $630, $641 := $631, $642 := $632", "$160 := SUM($170)", "$161 := SUM($171)", "$162 := SUM($172)" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06513409961685823, "writeRatioMax": 0.06513409961685823 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04980842911877394, "computeRatioMax": 0.04980842911877394, "endMs": "1665778577900", "id": "31", "inputStages": [ "30" ], "name": "S1F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "44", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778577854", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $651, $652, $653, $654", "FROM __stage1E_output" ] }, { "kind": "SORT", "substeps": [ "$653 ASC, $654 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02681992337164751, "writeRatioMax": 0.02681992337164751 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "26", "elapsedMs": "694", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "2943" }, { "activeUnits": "3", "completedUnits": "313", "elapsedMs": "933", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13585" } ], "totalBytesBilled": "261095424", "totalBytesProcessed": "260079328", "totalPartitionsProcessed": "0", "totalSlotMs": "13585", "transferredBytes": "0" }, "startTime": "1665778577022", "totalBytesProcessed": "260079328", "totalSlotMs": "13585" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon89e7f895_a36a_4308_bca2_11e5d4c31a28" }, "priority": "INTERACTIVE", "query": "with ss as\r\n (select s_store_sk,\r\n sum(ss_ext_sales_price) as sales,\r\n sum(ss_net_profit) as profit\r\n from store_sales,\r\n date_dim,\r\n store\r\n where ss_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date) \r\n and (cast('2000-09-22' as date)) \r\n and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n sum(sr_return_amt) as returns,\r\n sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n date_dim,\r\n store\r\n where sr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n sum(cs_ext_sales_price) as sales,\r\n sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n sum(cr_return_amount) as returns,\r\n sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n sum(ws_ext_sales_price) as sales,\r\n sum(ws_net_profit) as profit\r\n from web_sales,\r\n date_dim,\r\n web_page\r\n where ws_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n sum(wr_return_amt) as returns,\r\n sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n date_dim,\r\n web_page\r\n where wr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select channel\r\n , id\r\n , sum(sales) as sales\r\n , sum(returns) as returns\r\n , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n , ss.s_store_sk as id\r\n , sales\r\n , coalesce(returns, 0) as returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ss left join sr\r\n on ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n , cs_call_center_sk as id\r\n , sales\r\n , returns\r\n , (profit - profit_loss) as profit\r\n from cs\r\n , cr\r\n union all\r\n select 'web channel' as channel\r\n , ws.wp_web_page_sk as id\r\n , sales\r\n , coalesce(returns, 0) returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ws left join wr\r\n on ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n ,id\r\n limit 100\r\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "OehRUU7hGGqLh6El2oeURA==", "id": "test-project-364309:europe-west1.query77_1665778579", "jobReference": { "jobId": "query77_1665778579", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query77_1665778579?location=europe-west1", "statistics": { "creationTime": "1665778579665", "endTime": "1665778580776", "finalExecutionDurationMs": "842", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "260079328", "performanceInsights": { "avgPreviousExecutionMs": "795" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.028225806451612902, "computeRatioMax": 0.028225806451612902, "endMs": "1665778579917", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.016129032258064516, "readRatioMax": 0.016129032258064516, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778579879", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06854838709677419, "writeRatioMax": 0.06854838709677419 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04838709677419355, "computeRatioMax": 0.04838709677419355, "endMs": "1665778579931", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028225806451612902, "readRatioMax": 0.028225806451612902, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778579895", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_date", "FROM date_dim", "WHERE between($151, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.07661290322580645, "writeRatioMax": 0.07661290322580645 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04032258064516129, "computeRatioMax": 0.04032258064516129, "endMs": "1665778579959", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.020161290322580645, "readRatioMax": 0.020161290322580645, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778579925", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.07661290322580645, "writeRatioMax": 0.07661290322580645 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.06854838709677419, "computeRatioMax": 0.06854838709677419, "endMs": "1665778579986", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03225806451612903, "readRatioMax": 0.03225806451612903, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778579940", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.04435483870967742, "writeRatioMax": 0.04435483870967742 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05241935483870968, "computeRatioMax": 0.05241935483870968, "endMs": "1665778580016", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028225806451612902, "readRatioMax": 0.028225806451612902, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778579970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_date", "FROM date_dim", "WHERE between($91, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06048387096774194, "writeRatioMax": 0.06048387096774194 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04435483870967742, "computeRatioMax": 0.04435483870967742, "endMs": "1665778580037", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.020161290322580645, "readRatioMax": 0.020161290322580645, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778579998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date", "FROM date_dim", "WHERE between($81, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05241935483870968, "writeRatioMax": 0.05241935483870968 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.036290322580645164, "computeRatioMax": 0.036290322580645164, "endMs": "1665778580068", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.016129032258064516, "readRatioMax": 0.016129032258064516, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778580027", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.0846774193548387, "writeRatioMax": 0.0846774193548387 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05241935483870968, "computeRatioMax": 0.05241935483870968, "endMs": "1665778580082", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.020161290322580645, "readRatioMax": 0.020161290322580645, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778580044", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_date", "FROM date_dim", "WHERE between($131, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.056451612903225805, "writeRatioMax": 0.056451612903225805 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03225806451612903, "computeRatioMax": 0.03225806451612903, "endMs": "1665778580114", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.016129032258064516, "readRatioMax": 0.016129032258064516, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778580071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07258064516129033, "writeRatioMax": 0.07258064516129033 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04032258064516129, "computeRatioMax": 0.04032258064516129, "endMs": "1665778580118", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.020161290322580645, "readRatioMax": 0.020161290322580645, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778580086", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_date", "FROM date_dim", "WHERE between($121, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.08064516129032258, "writeRatioMax": 0.08064516129032258 }, { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.22580645161290322, "computeRatioMax": 0.22580645161290322, "endMs": "1665778580175", "id": "16", "inputStages": [ "1", "0" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.04838709677419355, "readRatioMax": 0.04838709677419355, "recordsRead": "71854", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "88", "startMs": "1665778580117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $592", "$370 := SUM($590)", "$371 := SUM($591)" ] }, { "kind": "JOIN", "substeps": [ "$590 := $581, $591 := $582, $592 := $50", "INNER HASH JOIN EACH WITH ALL ON $580 = $50" ] }, { "kind": "JOIN", "substeps": [ "$580 := $111, $581 := $112, $582 := $113", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$600, $370, $371", "TO __stage10_output", "BY HASH($600)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "1", "computeMsAvg": "248", "computeMsMax": "248", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778580288", "id": "17", "inputStages": [ "4", "3" ], "name": "S11: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.07661290322580645, "readRatioMax": 0.07661290322580645, "recordsRead": "719475", "recordsWritten": "30", "shuffleOutputBytes": "1290", "shuffleOutputBytesSpilled": "0", "slotMs": "231", "startMs": "1665778580133", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $552", "$360 := SUM($550)", "$361 := SUM($551)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $40", "INNER HASH JOIN EACH WITH ALL ON $540 = $40" ] }, { "kind": "JOIN", "substeps": [ "$540 := $101, $541 := $102, $542 := $103", "INNER HASH JOIN EACH WITH ALL ON $100 = $140" ] }, { "kind": "WRITE", "substeps": [ "$560, $360, $361", "TO __stage11_output", "BY HASH($560)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.024193548387096774, "writeRatioMax": 0.024193548387096774 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.23387096774193547, "computeRatioMax": 0.23387096774193547, "endMs": "1665778580216", "id": "18", "inputStages": [ "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.07661290322580645, "readRatioMax": 0.07661290322580645, "recordsRead": "144098", "recordsWritten": "5", "shuffleOutputBytes": "207", "shuffleOutputBytesSpilled": "0", "slotMs": "86", "startMs": "1665778580147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500", "$350 := SUM($501)", "$351 := SUM($502)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $31, $501 := $32, $502 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $90" ] }, { "kind": "WRITE", "substeps": [ "$510, $350, $351", "TO __stage12_output", "BY HASH($510)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.036290322580645164, "writeRatioMax": 0.036290322580645164 }, { "completedParallelInputs": "5", "computeMsAvg": "105", "computeMsMax": "148", "computeRatioAvg": 0.42338709677419356, "computeRatioMax": 0.5967741935483871, "endMs": "1665778580268", "id": "19", "inputStages": [ "8" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.06451612903225806, "readRatioMax": 0.07661290322580645, "recordsRead": "1441703", "recordsWritten": "20", "shuffleOutputBytes": "820", "shuffleOutputBytesSpilled": "0", "slotMs": "578", "startMs": "1665778580162", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$340 := SUM($471)", "$341 := SUM($472)" ] }, { "kind": "JOIN", "substeps": [ "$470 := $21, $471 := $22, $472 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $80" ] }, { "kind": "WRITE", "substeps": [ "$480, $340, $341", "TO __stage13_output", "BY HASH($480)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008064516129032258, "waitRatioMax": 0.012096774193548387, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.028225806451612902, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "1", "computeMsAvg": "146", "computeMsMax": "146", "computeRatioAvg": 0.5887096774193549, "computeRatioMax": 0.5887096774193549, "endMs": "1665778580257", "id": "20", "inputStages": [ "11", "10" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.04838709677419355, "readRatioMax": 0.04838709677419355, "recordsRead": "287557", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "146", "startMs": "1665778580164", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $432", "$330 := SUM($430)", "$331 := SUM($431)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $10", "INNER HASH JOIN EACH WITH ALL ON $420 = $10" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72, $422 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $130" ] }, { "kind": "WRITE", "substeps": [ "$440, $330, $331", "TO __stage14_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.016129032258064516, "writeRatioMax": 0.016129032258064516 }, { "completedParallelInputs": "6", "computeMsAvg": "198", "computeMsMax": "234", "computeRatioAvg": 0.7983870967741935, "computeRatioMax": 0.9435483870967742, "endMs": "1665778580320", "id": "21", "inputStages": [ "14", "13" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "21", "readRatioAvg": 0.06854838709677419, "readRatioMax": 0.0846774193548387, "recordsRead": "2880662", "recordsWritten": "36", "shuffleOutputBytes": "1548", "shuffleOutputBytesSpilled": "0", "slotMs": "1143", "startMs": "1665778580169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $392", "$320 := SUM($390)", "$321 := SUM($391)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $382, $392 := $1", "INNER HASH JOIN EACH WITH ALL ON $380 = $1" ] }, { "kind": "JOIN", "substeps": [ "$380 := $61, $381 := $62, $382 := $63", "INNER HASH JOIN EACH WITH ALL ON $60 = $120" ] }, { "kind": "WRITE", "substeps": [ "$400, $320, $321", "TO __stage15_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.008064516129032258, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.020161290322580645, "writeRatioMax": 0.024193548387096774 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04838709677419355, "computeRatioMax": 0.04838709677419355, "endMs": "1665778580392", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778580346", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $370, $371", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600", "$310 := SUM($370)", "$311 := SUM($371)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $610", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.10080645161290322, "writeRatioMax": 0.10080645161290322 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04435483870967742, "computeRatioMax": 0.04435483870967742, "endMs": "1665778580386", "id": "23", "inputStages": [ "18" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "170", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778580360", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$510, $350, $351", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510", "$290 := SUM($350)", "$291 := SUM($351)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.06451612903225806 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.036290322580645164, "computeRatioMax": 0.036290322580645164, "endMs": "1665778580410", "id": "24", "inputStages": [ "19" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778580372", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $340, $341", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $490", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06048387096774194, "writeRatioMax": 0.06048387096774194 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04032258064516129, "computeRatioMax": 0.04032258064516129, "endMs": "1665778580420", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778580385", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $330, $331", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $450", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.056451612903225805, "writeRatioMax": 0.056451612903225805 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.03225806451612903, "computeRatioMax": 0.056451612903225805, "endMs": "1665778580464", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "3794", "startMs": "1665778580406", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.008064516129032258, "waitRatioMax": 0.024193548387096774, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.11693548387096774 }, { "completedParallelInputs": "40", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.036290322580645164, "computeRatioMax": 0.06854838709677419, "endMs": "1665778580471", "id": "27", "inputStages": [ "24" ], "name": "S1B: Coalesce", "parallelInputs": "40", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "1515", "startMs": "1665778580422", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008064516129032258, "waitRatioMax": 0.012096774193548387, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.06048387096774194, "writeRatioMax": 0.11290322580645161 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.03225806451612903, "computeRatioMax": 0.056451612903225805, "endMs": "1665778580484", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "3452", "startMs": "1665778580431", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008064516129032258, "waitRatioMax": 0.012096774193548387, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.056451612903225805, "writeRatioMax": 0.08064516129032258 }, { "completedParallelInputs": "42", "computeMsAvg": "10", "computeMsMax": "18", "computeRatioAvg": 0.04032258064516129, "computeRatioMax": 0.07258064516129033, "endMs": "1665778580495", "id": "29", "inputStages": [ "26", "17", "27", "28", "23", "21" ], "name": "S1D: Join+", "parallelInputs": "42", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "137", "recordsWritten": "70", "shuffleOutputBytes": "5807", "shuffleOutputBytesSpilled": "0", "slotMs": "1602", "startMs": "1665778580444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $450", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$280, $281, $490", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$560, $360, $361", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$310, $311, $610", "FROM __stage1A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $180, $631 := $181, $632 := $200", "$170 := SUM($212)", "$171 := SUM($213)", "$172 := SUM($214)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(equal(bitwise_and($220, 1), 0), NULL, $210)", "$181 := if(equal(bitwise_and($220, 2), 0), NULL, $211)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := 'store channel'", "$231 := coalesce($463, NUMERIC<...>)", "$232 := subtract($462, coalesce($464, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$460 := $410, $461 := $260, $462 := $261, $463 := $270, $464 := $271", "LEFT OUTER HASH JOIN EACH WITH ALL ON $410 = $450" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$260 := SUM($320)", "$261 := SUM($321)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'catalog channel'", "$241 := subtract($532, $534)" ] }, { "kind": "JOIN", "substeps": [ "$530 := $490, $531 := $280, $532 := $281, $533 := $290, $534 := $291", "CROSS EACH WITH EACH " ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'web channel'", "$251 := coalesce($623, NUMERIC<...>)", "$252 := subtract($622, coalesce($624, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$620 := $570, $621 := $300, $622 := $301, $623 := $310, $624 := $311", "LEFT OUTER HASH JOIN EACH WITH ALL ON $570 = $610" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := subtract($221, 1)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $630, $631, $632", "TO __stage1D_output", "BY HASH($630, $631, $632)" ] } ], "waitMsAvg": "1", "waitMsMax": "9", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.036290322580645164, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.05241935483870968, "writeRatioMax": 0.07661290322580645 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04032258064516129, "computeRatioMax": 0.04032258064516129, "endMs": "1665778580661", "id": "30", "inputStages": [ "29" ], "name": "S1E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "70", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778580624", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $630, $631, $632", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC, $641 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $630, $641 := $631, $642 := $632", "$160 := SUM($170)", "$161 := SUM($171)", "$162 := SUM($172)" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05241935483870968, "writeRatioMax": 0.05241935483870968 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04838709677419355, "computeRatioMax": 0.04838709677419355, "endMs": "1665778580687", "id": "31", "inputStages": [ "30" ], "name": "S1F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "44", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778580640", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $651, $652, $653, $654", "FROM __stage1E_output" ] }, { "kind": "SORT", "substeps": [ "$653 ASC, $654 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004032258064516129, "waitRatioMax": 0.004032258064516129, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.07661290322580645, "writeRatioMax": 0.07661290322580645 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "25", "elapsedMs": "654", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "3005" }, { "activeUnits": "3", "completedUnits": "313", "elapsedMs": "1001", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13520" } ], "totalBytesBilled": "261095424", "totalBytesProcessed": "260079328", "totalPartitionsProcessed": "0", "totalSlotMs": "13520", "transferredBytes": "0" }, "startTime": "1665778579728", "totalBytesProcessed": "260079328", "totalSlotMs": "13520" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3b0afa86_59c1_4630_9874_4970425a8bfb" }, "priority": "INTERACTIVE", "query": "with ss as\r\n (select s_store_sk,\r\n sum(ss_ext_sales_price) as sales,\r\n sum(ss_net_profit) as profit\r\n from store_sales,\r\n date_dim,\r\n store\r\n where ss_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date) \r\n and (cast('2000-09-22' as date)) \r\n and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n sum(sr_return_amt) as returns,\r\n sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n date_dim,\r\n store\r\n where sr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n sum(cs_ext_sales_price) as sales,\r\n sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n sum(cr_return_amount) as returns,\r\n sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n sum(ws_ext_sales_price) as sales,\r\n sum(ws_net_profit) as profit\r\n from web_sales,\r\n date_dim,\r\n web_page\r\n where ws_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n sum(wr_return_amt) as returns,\r\n sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n date_dim,\r\n web_page\r\n where wr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select channel\r\n , id\r\n , sum(sales) as sales\r\n , sum(returns) as returns\r\n , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n , ss.s_store_sk as id\r\n , sales\r\n , coalesce(returns, 0) as returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ss left join sr\r\n on ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n , cs_call_center_sk as id\r\n , sales\r\n , returns\r\n , (profit - profit_loss) as profit\r\n from cs\r\n , cr\r\n union all\r\n select 'web channel' as channel\r\n , ws.wp_web_page_sk as id\r\n , sales\r\n , coalesce(returns, 0) returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ws left join wr\r\n on ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n ,id\r\n limit 100\r\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "w+zdY6QVMbXtZ8zn4chmPA==", "id": "test-project-364309:europe-west1.query77_1665778581", "jobReference": { "jobId": "query77_1665778581", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query77_1665778581?location=europe-west1", "statistics": { "creationTime": "1665778582519", "endTime": "1665778583820", "finalExecutionDurationMs": "986", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "260079328", "performanceInsights": { "avgPreviousExecutionMs": "803" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05333333333333334, "computeRatioMax": 0.05333333333333334, "endMs": "1665778582788", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.04, "readRatioMax": 0.04, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778582748", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04, "writeRatioMax": 0.04 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.057777777777777775, "computeRatioMax": 0.057777777777777775, "endMs": "1665778582810", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.044444444444444446, "readRatioMax": 0.044444444444444446, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778582765", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_date", "FROM date_dim", "WHERE between($151, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.035555555555555556, "writeRatioMax": 0.035555555555555556 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.022222222222222223, "endMs": "1665778582838", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.013333333333333334, "readRatioMax": 0.013333333333333334, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778582801", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.017777777777777778, "waitRatioMax": 0.017777777777777778, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07111111111111111, "writeRatioMax": 0.07111111111111111 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.07555555555555556, "computeRatioMax": 0.07555555555555556, "endMs": "1665778582860", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.035555555555555556, "readRatioMax": 0.035555555555555556, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778582820", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.044444444444444446, "writeRatioMax": 0.044444444444444446 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04, "computeRatioMax": 0.04, "endMs": "1665778582890", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.017777777777777778, "readRatioMax": 0.017777777777777778, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778582853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_date", "FROM date_dim", "WHERE between($91, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05333333333333334, "writeRatioMax": 0.05333333333333334 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.07555555555555556, "computeRatioMax": 0.07555555555555556, "endMs": "1665778582930", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.05333333333333334, "readRatioMax": 0.05333333333333334, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "76", "startMs": "1665778582885", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date", "FROM date_dim", "WHERE between($81, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03111111111111111, "writeRatioMax": 0.03111111111111111 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.035555555555555556, "computeRatioMax": 0.035555555555555556, "endMs": "1665778582960", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.022222222222222223, "readRatioMax": 0.022222222222222223, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778582918", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.07555555555555556, "writeRatioMax": 0.07555555555555556 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.08, "computeRatioMax": 0.08, "endMs": "1665778582979", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.05333333333333334, "readRatioMax": 0.05333333333333334, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778582943", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_date", "FROM date_dim", "WHERE between($131, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.035555555555555556, "writeRatioMax": 0.035555555555555556 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03111111111111111, "computeRatioMax": 0.03111111111111111, "endMs": "1665778583020", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.022222222222222223, "readRatioMax": 0.022222222222222223, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778582978", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.022222222222222223, "waitRatioMax": 0.022222222222222223, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.08, "writeRatioMax": 0.08 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06222222222222222, "computeRatioMax": 0.06222222222222222, "endMs": "1665778583039", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03111111111111111, "readRatioMax": 0.03111111111111111, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778583002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_date", "FROM date_dim", "WHERE between($121, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02666666666666667, "writeRatioMax": 0.02666666666666667 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.18222222222222223, "computeRatioMax": 0.18222222222222223, "endMs": "1665778583104", "id": "16", "inputStages": [ "0", "1" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.035555555555555556, "readRatioMax": 0.035555555555555556, "recordsRead": "71854", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778583061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $592", "$370 := SUM($590)", "$371 := SUM($591)" ] }, { "kind": "JOIN", "substeps": [ "$590 := $581, $591 := $582, $592 := $50", "INNER HASH JOIN EACH WITH ALL ON $580 = $50" ] }, { "kind": "JOIN", "substeps": [ "$580 := $111, $581 := $112, $582 := $113", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$600, $370, $371", "TO __stage10_output", "BY HASH($600)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.035555555555555556, "writeRatioMax": 0.035555555555555556 }, { "completedParallelInputs": "1", "computeMsAvg": "199", "computeMsMax": "199", "computeRatioAvg": 0.8844444444444445, "computeRatioMax": 0.8844444444444445, "endMs": "1665778583324", "id": "17", "inputStages": [ "3", "4" ], "name": "S11: Join+", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.09333333333333334, "readRatioMax": 0.09333333333333334, "recordsRead": "719475", "recordsWritten": "30", "shuffleOutputBytes": "1290", "shuffleOutputBytesSpilled": "0", "slotMs": "220", "startMs": "1665778583103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $552", "$360 := SUM($550)", "$361 := SUM($551)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $40", "INNER HASH JOIN EACH WITH ALL ON $540 = $40" ] }, { "kind": "JOIN", "substeps": [ "$540 := $101, $541 := $102, $542 := $103", "INNER HASH JOIN EACH WITH ALL ON $100 = $140" ] }, { "kind": "WRITE", "substeps": [ "$560, $360, $361", "TO __stage11_output", "BY HASH($560)" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.035555555555555556, "waitRatioMax": 0.035555555555555556, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.035555555555555556, "writeRatioMax": 0.035555555555555556 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.2577777777777778, "computeRatioMax": 0.2577777777777778, "endMs": "1665778583187", "id": "18", "inputStages": [ "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.06222222222222222, "readRatioMax": 0.06222222222222222, "recordsRead": "144098", "recordsWritten": "5", "shuffleOutputBytes": "207", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665778583125", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500", "$350 := SUM($501)", "$351 := SUM($502)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $31, $501 := $32, $502 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $90" ] }, { "kind": "WRITE", "substeps": [ "$510, $350, $351", "TO __stage12_output", "BY HASH($510)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.017777777777777778, "waitRatioMax": 0.017777777777777778, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.035555555555555556, "writeRatioMax": 0.035555555555555556 }, { "completedParallelInputs": "5", "computeMsAvg": "103", "computeMsMax": "114", "computeRatioAvg": 0.4577777777777778, "computeRatioMax": 0.5066666666666667, "endMs": "1665778583287", "id": "19", "inputStages": [ "8" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.07111111111111111, "readRatioMax": 0.08888888888888889, "recordsRead": "1441703", "recordsWritten": "20", "shuffleOutputBytes": "820", "shuffleOutputBytesSpilled": "0", "slotMs": "605", "startMs": "1665778583157", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$340 := SUM($471)", "$341 := SUM($472)" ] }, { "kind": "JOIN", "substeps": [ "$470 := $21, $471 := $22, $472 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $80" ] }, { "kind": "WRITE", "substeps": [ "$480, $340, $341", "TO __stage13_output", "BY HASH($480)" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.013333333333333334, "waitRatioMax": 0.022222222222222223, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.02666666666666667, "writeRatioMax": 0.03111111111111111 }, { "completedParallelInputs": "1", "computeMsAvg": "114", "computeMsMax": "114", "computeRatioAvg": 0.5066666666666667, "computeRatioMax": 0.5066666666666667, "endMs": "1665778583284", "id": "20", "inputStages": [ "11", "10" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.044444444444444446, "readRatioMax": 0.044444444444444446, "recordsRead": "287557", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "130", "startMs": "1665778583164", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $432", "$330 := SUM($430)", "$331 := SUM($431)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $10", "INNER HASH JOIN EACH WITH ALL ON $420 = $10" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72, $422 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $130" ] }, { "kind": "WRITE", "substeps": [ "$440, $330, $331", "TO __stage14_output", "BY HASH($440)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.017777777777777778, "writeRatioMax": 0.017777777777777778 }, { "completedParallelInputs": "6", "computeMsAvg": "181", "computeMsMax": "225", "computeRatioAvg": 0.8044444444444444, "computeRatioMax": 1, "endMs": "1665778583313", "id": "21", "inputStages": [ "14", "13" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "21", "readRatioAvg": 0.07555555555555556, "readRatioMax": 0.09333333333333334, "recordsRead": "2880662", "recordsWritten": "36", "shuffleOutputBytes": "1548", "shuffleOutputBytesSpilled": "0", "slotMs": "1086", "startMs": "1665778583175", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $392", "$320 := SUM($390)", "$321 := SUM($391)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $382, $392 := $1", "INNER HASH JOIN EACH WITH ALL ON $380 = $1" ] }, { "kind": "JOIN", "substeps": [ "$380 := $61, $381 := $62, $382 := $63", "INNER HASH JOIN EACH WITH ALL ON $60 = $120" ] }, { "kind": "WRITE", "substeps": [ "$400, $320, $321", "TO __stage15_output", "BY HASH($400)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.013333333333333334, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.017777777777777778, "writeRatioMax": 0.022222222222222223 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.08444444444444445, "computeRatioMax": 0.08444444444444445, "endMs": "1665778583491", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665778583435", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $370, $371", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600", "$310 := SUM($370)", "$311 := SUM($371)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $610", "TO __stage16_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.022222222222222223, "waitRatioMax": 0.022222222222222223, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.12, "writeRatioMax": 0.12 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.044444444444444446, "computeRatioMax": 0.044444444444444446, "endMs": "1665778583487", "id": "23", "inputStages": [ "18" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "170", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778583453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$510, $350, $351", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510", "$290 := SUM($350)", "$291 := SUM($351)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage17_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.013333333333333334, "waitRatioMax": 0.013333333333333334, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.11555555555555555, "writeRatioMax": 0.11555555555555555 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.044444444444444446, "computeRatioMax": 0.044444444444444446, "endMs": "1665778583503", "id": "24", "inputStages": [ "19" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778583468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $340, $341", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $490", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06222222222222222, "writeRatioMax": 0.06222222222222222 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.035555555555555556, "computeRatioMax": 0.035555555555555556, "endMs": "1665778583525", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778583488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $330, $331", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $450", "TO __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06666666666666667, "writeRatioMax": 0.06666666666666667 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.04, "computeRatioMax": 0.08888888888888889, "endMs": "1665778583596", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "4132", "startMs": "1665778583513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.013333333333333334, "waitRatioMax": 0.022222222222222223, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.06222222222222222, "writeRatioMax": 0.12444444444444444 }, { "completedParallelInputs": "40", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.04, "computeRatioMax": 0.08, "endMs": "1665778583577", "id": "27", "inputStages": [ "24" ], "name": "S1B: Coalesce", "parallelInputs": "40", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "1540", "startMs": "1665778583521", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.022222222222222223, "waitRatioMax": 0.02666666666666667, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.07111111111111111, "writeRatioMax": 0.12444444444444444 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.035555555555555556, "computeRatioMax": 0.08, "endMs": "1665778583610", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "5541", "startMs": "1665778583538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.013333333333333334, "waitRatioMax": 0.022222222222222223, "writeMsAvg": "32", "writeMsMax": "57", "writeRatioAvg": 0.14222222222222222, "writeRatioMax": 0.25333333333333335 }, { "completedParallelInputs": "42", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.044444444444444446, "computeRatioMax": 0.08888888888888889, "endMs": "1665778583629", "id": "29", "inputStages": [ "28", "27", "23", "26", "17", "21" ], "name": "S1D: Join+", "parallelInputs": "42", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "137", "recordsWritten": "70", "shuffleOutputBytes": "5807", "shuffleOutputBytesSpilled": "0", "slotMs": "1770", "startMs": "1665778583559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $450", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$280, $281, $490", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$560, $360, $361", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$310, $311, $610", "FROM __stage1A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $180, $631 := $181, $632 := $200", "$170 := SUM($212)", "$171 := SUM($213)", "$172 := SUM($214)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(equal(bitwise_and($220, 1), 0), NULL, $210)", "$181 := if(equal(bitwise_and($220, 2), 0), NULL, $211)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := 'store channel'", "$231 := coalesce($463, NUMERIC<...>)", "$232 := subtract($462, coalesce($464, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$460 := $410, $461 := $260, $462 := $261, $463 := $270, $464 := $271", "LEFT OUTER HASH JOIN EACH WITH ALL ON $410 = $450" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$260 := SUM($320)", "$261 := SUM($321)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'catalog channel'", "$241 := subtract($532, $534)" ] }, { "kind": "JOIN", "substeps": [ "$530 := $490, $531 := $280, $532 := $281, $533 := $290, $534 := $291", "CROSS EACH WITH EACH " ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'web channel'", "$251 := coalesce($623, NUMERIC<...>)", "$252 := subtract($622, coalesce($624, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$620 := $570, $621 := $300, $622 := $301, $623 := $310, $624 := $311", "LEFT OUTER HASH JOIN EACH WITH ALL ON $570 = $610" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := subtract($221, 1)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $630, $631, $632", "TO __stage1D_output", "BY HASH($630, $631, $632)" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.022222222222222223, "writeMsAvg": "12", "writeMsMax": "22", "writeRatioAvg": 0.05333333333333334, "writeRatioMax": 0.09777777777777778 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.044444444444444446, "computeRatioMax": 0.044444444444444446, "endMs": "1665778583682", "id": "30", "inputStages": [ "29" ], "name": "S1E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "70", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778583643", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $630, $631, $632", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC, $641 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $630, $641 := $631, $642 := $632", "$160 := SUM($170)", "$161 := SUM($171)", "$162 := SUM($172)" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654", "TO __stage1E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.04888888888888889, "writeRatioMax": 0.04888888888888889 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.044444444444444446, "computeRatioMax": 0.044444444444444446, "endMs": "1665778583689", "id": "31", "inputStages": [ "30" ], "name": "S1F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "44", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778583659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $651, $652, $653, $654", "FROM __stage1E_output" ] }, { "kind": "SORT", "substeps": [ "$653 ASC, $654 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.022222222222222223, "writeRatioMax": 0.022222222222222223 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "11", "completedUnits": "15", "elapsedMs": "697", "estimatedRunnableUnits": "0", "pendingUnits": "10", "totalSlotMs": "2308" }, { "activeUnits": "5", "completedUnits": "313", "elapsedMs": "1170", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "16982" } ], "totalBytesBilled": "261095424", "totalBytesProcessed": "260079328", "totalPartitionsProcessed": "0", "totalSlotMs": "16982", "transferredBytes": "0" }, "startTime": "1665778582592", "totalBytesProcessed": "260079328", "totalSlotMs": "16982" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon31061a36_0079_4907_8db0_79a875754fab" }, "priority": "INTERACTIVE", "query": "with ss as\r\n (select s_store_sk,\r\n sum(ss_ext_sales_price) as sales,\r\n sum(ss_net_profit) as profit\r\n from store_sales,\r\n date_dim,\r\n store\r\n where ss_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date) \r\n and (cast('2000-09-22' as date)) \r\n and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n sum(sr_return_amt) as returns,\r\n sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n date_dim,\r\n store\r\n where sr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n sum(cs_ext_sales_price) as sales,\r\n sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n sum(cr_return_amount) as returns,\r\n sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n sum(ws_ext_sales_price) as sales,\r\n sum(ws_net_profit) as profit\r\n from web_sales,\r\n date_dim,\r\n web_page\r\n where ws_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n sum(wr_return_amt) as returns,\r\n sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n date_dim,\r\n web_page\r\n where wr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select channel\r\n , id\r\n , sum(sales) as sales\r\n , sum(returns) as returns\r\n , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n , ss.s_store_sk as id\r\n , sales\r\n , coalesce(returns, 0) as returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ss left join sr\r\n on ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n , cs_call_center_sk as id\r\n , sales\r\n , returns\r\n , (profit - profit_loss) as profit\r\n from cs\r\n , cr\r\n union all\r\n select 'web channel' as channel\r\n , ws.wp_web_page_sk as id\r\n , sales\r\n , coalesce(returns, 0) returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ws left join wr\r\n on ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n ,id\r\n limit 100\r\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "P2o1sx3NmEx0n6UBkOnSmQ==", "id": "test-project-364309:europe-west1.query77_1665778584", "jobReference": { "jobId": "query77_1665778584", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query77_1665778584?location=europe-west1", "statistics": { "creationTime": "1665778585519", "endTime": "1665778586696", "finalExecutionDurationMs": "901", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "260079328", "performanceInsights": { "avgPreviousExecutionMs": "829" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.019933554817275746, "computeRatioMax": 0.019933554817275746, "endMs": "1665778585770", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.019933554817275746, "readRatioMax": 0.019933554817275746, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778585725", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.06312292358803986, "writeRatioMax": 0.06312292358803986 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.053156146179401995, "computeRatioMax": 0.053156146179401995, "endMs": "1665778585790", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.029900332225913623, "readRatioMax": 0.029900332225913623, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778585746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_date", "FROM date_dim", "WHERE between($151, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033222591362126247, "waitRatioMax": 0.0033222591362126247, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.026578073089700997, "writeRatioMax": 0.026578073089700997 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.029900332225913623, "computeRatioMax": 0.029900332225913623, "endMs": "1665778585834", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016611295681063124, "readRatioMax": 0.016611295681063124, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778585790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.046511627906976744, "waitRatioMax": 0.046511627906976744, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04983388704318937, "writeRatioMax": 0.04983388704318937 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04318936877076412, "computeRatioMax": 0.04318936877076412, "endMs": "1665778585851", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.029900332225913623, "readRatioMax": 0.029900332225913623, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778585809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage04_output" ] } ], "waitMsAvg": "12", "waitMsMax": "12", "waitRatioAvg": 0.03986710963455149, "waitRatioMax": 0.03986710963455149, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.029900332225913623, "writeRatioMax": 0.029900332225913623 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.04983388704318937, "computeRatioMax": 0.04983388704318937, "endMs": "1665778585880", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.019933554817275746, "readRatioMax": 0.019933554817275746, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778585835", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_date", "FROM date_dim", "WHERE between($91, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033222591362126247, "waitRatioMax": 0.0033222591362126247, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.053156146179401995, "writeRatioMax": 0.053156146179401995 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.036544850498338874, "computeRatioMax": 0.036544850498338874, "endMs": "1665778585919", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016611295681063124, "readRatioMax": 0.016611295681063124, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778585878", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date", "FROM date_dim", "WHERE between($81, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.046511627906976744, "writeRatioMax": 0.046511627906976744 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03322259136212625, "computeRatioMax": 0.03322259136212625, "endMs": "1665778585953", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.013289036544850499, "readRatioMax": 0.013289036544850499, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778585912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.059800664451827246, "writeRatioMax": 0.059800664451827246 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.053156146179401995, "computeRatioMax": 0.053156146179401995, "endMs": "1665778585972", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.023255813953488372, "readRatioMax": 0.023255813953488372, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778585933", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_date", "FROM date_dim", "WHERE between($131, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03986710963455149, "writeRatioMax": 0.03986710963455149 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.026578073089700997, "computeRatioMax": 0.026578073089700997, "endMs": "1665778586008", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.009966777408637873, "readRatioMax": 0.009966777408637873, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778585980", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.016611295681063124, "waitRatioMax": 0.016611295681063124, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.059800664451827246, "writeRatioMax": 0.059800664451827246 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04318936877076412, "computeRatioMax": 0.04318936877076412, "endMs": "1665778586037", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.019933554817275746, "readRatioMax": 0.019933554817275746, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778585995", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_date", "FROM date_dim", "WHERE between($121, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.046511627906976744, "writeRatioMax": 0.046511627906976744 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.12956810631229235, "computeRatioMax": 0.12956810631229235, "endMs": "1665778586080", "id": "16", "inputStages": [ "1", "0" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026578073089700997, "readRatioMax": 0.026578073089700997, "recordsRead": "71854", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778586039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $592", "$370 := SUM($590)", "$371 := SUM($591)" ] }, { "kind": "JOIN", "substeps": [ "$590 := $581, $591 := $582, $592 := $50", "INNER HASH JOIN EACH WITH ALL ON $580 = $50" ] }, { "kind": "JOIN", "substeps": [ "$580 := $111, $581 := $112, $582 := $113", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$600, $370, $371", "TO __stage10_output", "BY HASH($600)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013289036544850499, "writeRatioMax": 0.013289036544850499 }, { "completedParallelInputs": "1", "computeMsAvg": "301", "computeMsMax": "301", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778586213", "id": "17", "inputStages": [ "3", "4" ], "name": "S11: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.0664451827242525, "readRatioMax": 0.0664451827242525, "recordsRead": "719475", "recordsWritten": "30", "shuffleOutputBytes": "1290", "shuffleOutputBytesSpilled": "0", "slotMs": "307", "startMs": "1665778586060", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $552", "$360 := SUM($550)", "$361 := SUM($551)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $40", "INNER HASH JOIN EACH WITH ALL ON $540 = $40" ] }, { "kind": "JOIN", "substeps": [ "$540 := $101, $541 := $102, $542 := $103", "INNER HASH JOIN EACH WITH ALL ON $100 = $140" ] }, { "kind": "WRITE", "substeps": [ "$560, $360, $361", "TO __stage11_output", "BY HASH($560)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009966777408637873, "waitRatioMax": 0.009966777408637873, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.019933554817275746, "writeRatioMax": 0.019933554817275746 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.14950166112956811, "computeRatioMax": 0.14950166112956811, "endMs": "1665778586130", "id": "18", "inputStages": [ "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.04983388704318937, "readRatioMax": 0.04983388704318937, "recordsRead": "144098", "recordsWritten": "5", "shuffleOutputBytes": "207", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665778586078", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500", "$350 := SUM($501)", "$351 := SUM($502)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $31, $501 := $32, $502 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $90" ] }, { "kind": "WRITE", "substeps": [ "$510, $350, $351", "TO __stage12_output", "BY HASH($510)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.016611295681063124, "writeRatioMax": 0.016611295681063124 }, { "completedParallelInputs": "5", "computeMsAvg": "107", "computeMsMax": "131", "computeRatioAvg": 0.3554817275747508, "computeRatioMax": 0.43521594684385384, "endMs": "1665778586202", "id": "19", "inputStages": [ "8" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "21", "readMsMax": "25", "readRatioAvg": 0.06976744186046512, "readRatioMax": 0.08305647840531562, "recordsRead": "1441703", "recordsWritten": "20", "shuffleOutputBytes": "820", "shuffleOutputBytesSpilled": "0", "slotMs": "630", "startMs": "1665778586098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$340 := SUM($471)", "$341 := SUM($472)" ] }, { "kind": "JOIN", "substeps": [ "$470 := $21, $471 := $22, $472 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $80" ] }, { "kind": "WRITE", "substeps": [ "$480, $340, $341", "TO __stage13_output", "BY HASH($480)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.009966777408637873, "writeMsAvg": "10", "writeMsMax": "17", "writeRatioAvg": 0.03322259136212625, "writeRatioMax": 0.05647840531561462 }, { "completedParallelInputs": "1", "computeMsAvg": "140", "computeMsMax": "140", "computeRatioAvg": 0.46511627906976744, "computeRatioMax": 0.46511627906976744, "endMs": "1665778586194", "id": "20", "inputStages": [ "11", "10" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.03986710963455149, "readRatioMax": 0.03986710963455149, "recordsRead": "287557", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "143", "startMs": "1665778586105", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $432", "$330 := SUM($430)", "$331 := SUM($431)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $10", "INNER HASH JOIN EACH WITH ALL ON $420 = $10" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72, $422 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $130" ] }, { "kind": "WRITE", "substeps": [ "$440, $330, $331", "TO __stage14_output", "BY HASH($440)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013289036544850499, "writeRatioMax": 0.013289036544850499 }, { "completedParallelInputs": "6", "computeMsAvg": "167", "computeMsMax": "188", "computeRatioAvg": 0.5548172757475083, "computeRatioMax": 0.6245847176079734, "endMs": "1665778586256", "id": "21", "inputStages": [ "14", "13" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "32", "readRatioAvg": 0.0664451827242525, "readRatioMax": 0.10631229235880399, "recordsRead": "2880662", "recordsWritten": "36", "shuffleOutputBytes": "1548", "shuffleOutputBytesSpilled": "0", "slotMs": "1041", "startMs": "1665778586115", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $392", "$320 := SUM($390)", "$321 := SUM($391)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $382, $392 := $1", "INNER HASH JOIN EACH WITH ALL ON $380 = $1" ] }, { "kind": "JOIN", "substeps": [ "$380 := $61, $381 := $62, $382 := $63", "INNER HASH JOIN EACH WITH ALL ON $60 = $120" ] }, { "kind": "WRITE", "substeps": [ "$400, $320, $321", "TO __stage15_output", "BY HASH($400)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.016611295681063124, "waitRatioMax": 0.016611295681063124, "writeMsAvg": "5", "writeMsMax": "9", "writeRatioAvg": 0.016611295681063124, "writeRatioMax": 0.029900332225913623 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03986710963455149, "computeRatioMax": 0.03986710963455149, "endMs": "1665778586336", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665778586284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $370, $371", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600", "$310 := SUM($370)", "$311 := SUM($371)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $610", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.09634551495016612, "writeRatioMax": 0.09634551495016612 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.029900332225913623, "computeRatioMax": 0.029900332225913623, "endMs": "1665778586343", "id": "23", "inputStages": [ "18" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "170", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778586309", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$510, $350, $351", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510", "$290 := SUM($350)", "$291 := SUM($351)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage17_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009966777408637873, "waitRatioMax": 0.009966777408637873, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.053156146179401995, "writeRatioMax": 0.053156146179401995 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03322259136212625, "computeRatioMax": 0.03322259136212625, "endMs": "1665778586360", "id": "24", "inputStages": [ "19" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778586325", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $340, $341", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $490", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.07973421926910298, "writeRatioMax": 0.07973421926910298 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03986710963455149, "computeRatioMax": 0.03986710963455149, "endMs": "1665778586379", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778586342", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $330, $331", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $450", "TO __stage19_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009966777408637873, "waitRatioMax": 0.009966777408637873, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.053156146179401995, "writeRatioMax": 0.053156146179401995 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.026578073089700997, "computeRatioMax": 0.04318936877076412, "endMs": "1665778586416", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "3478", "startMs": "1665778586351", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.013289036544850499, "waitRatioMax": 0.019933554817275746, "writeMsAvg": "11", "writeMsMax": "17", "writeRatioAvg": 0.036544850498338874, "writeRatioMax": 0.05647840531561462 }, { "completedParallelInputs": "40", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.026578073089700997, "computeRatioMax": 0.04318936877076412, "endMs": "1665778586415", "id": "27", "inputStages": [ "24" ], "name": "S1B: Coalesce", "parallelInputs": "40", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "1266", "startMs": "1665778586363", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.016611295681063124, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.046511627906976744, "writeRatioMax": 0.059800664451827246 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.026578073089700997, "computeRatioMax": 0.053156146179401995, "endMs": "1665778586472", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "4690", "startMs": "1665778586397", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "8", "waitMsMax": "15", "waitRatioAvg": 0.026578073089700997, "waitRatioMax": 0.04983388704318937, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.04983388704318937, "writeRatioMax": 0.09966777408637874 }, { "completedParallelInputs": "42", "computeMsAvg": "10", "computeMsMax": "23", "computeRatioAvg": 0.03322259136212625, "computeRatioMax": 0.07641196013289037, "endMs": "1665778586488", "id": "29", "inputStages": [ "27", "23", "21", "26", "28", "17" ], "name": "S1D: Join+", "parallelInputs": "42", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "137", "recordsWritten": "70", "shuffleOutputBytes": "5807", "shuffleOutputBytesSpilled": "0", "slotMs": "1671", "startMs": "1665778586422", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $450", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$280, $281, $490", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$560, $360, $361", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$310, $311, $610", "FROM __stage1A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $180, $631 := $181, $632 := $200", "$170 := SUM($212)", "$171 := SUM($213)", "$172 := SUM($214)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(equal(bitwise_and($220, 1), 0), NULL, $210)", "$181 := if(equal(bitwise_and($220, 2), 0), NULL, $211)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := 'store channel'", "$231 := coalesce($463, NUMERIC<...>)", "$232 := subtract($462, coalesce($464, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$460 := $410, $461 := $260, $462 := $261, $463 := $270, $464 := $271", "LEFT OUTER HASH JOIN EACH WITH ALL ON $410 = $450" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$260 := SUM($320)", "$261 := SUM($321)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'catalog channel'", "$241 := subtract($532, $534)" ] }, { "kind": "JOIN", "substeps": [ "$530 := $490, $531 := $280, $532 := $281, $533 := $290, $534 := $291", "CROSS EACH WITH EACH " ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'web channel'", "$251 := coalesce($623, NUMERIC<...>)", "$252 := subtract($622, coalesce($624, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$620 := $570, $621 := $300, $622 := $301, $623 := $310, $624 := $311", "LEFT OUTER HASH JOIN EACH WITH ALL ON $570 = $610" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := subtract($221, 1)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $630, $631, $632", "TO __stage1D_output", "BY HASH($630, $631, $632)" ] } ], "waitMsAvg": "7", "waitMsMax": "13", "waitRatioAvg": 0.023255813953488372, "waitRatioMax": 0.04318936877076412, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.046511627906976744, "writeRatioMax": 0.06312292358803986 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03322259136212625, "computeRatioMax": 0.03322259136212625, "endMs": "1665778586550", "id": "30", "inputStages": [ "29" ], "name": "S1E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "70", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778586511", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $630, $631, $632", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC, $641 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $630, $641 := $631, $642 := $632", "$160 := SUM($170)", "$161 := SUM($171)", "$162 := SUM($172)" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654", "TO __stage1E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009966777408637873, "waitRatioMax": 0.009966777408637873, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.08637873754152824, "writeRatioMax": 0.08637873754152824 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.023255813953488372, "computeRatioMax": 0.023255813953488372, "endMs": "1665778586575", "id": "31", "inputStages": [ "30" ], "name": "S1F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "44", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778586538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $651, $652, $653, $654", "FROM __stage1E_output" ] }, { "kind": "SORT", "substeps": [ "$653 ASC, $654 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.06312292358803986, "writeRatioMax": 0.06312292358803986 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "20", "elapsedMs": "646", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "2691" }, { "activeUnits": "5", "completedUnits": "313", "elapsedMs": "1054", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14744" } ], "totalBytesBilled": "261095424", "totalBytesProcessed": "260079328", "totalPartitionsProcessed": "0", "totalSlotMs": "14744", "transferredBytes": "0" }, "startTime": "1665778585582", "totalBytesProcessed": "260079328", "totalSlotMs": "14744" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0607c349_976d_448a_bd8f_49480b39d8fc" }, "priority": "INTERACTIVE", "query": "with ss as\r\n (select s_store_sk,\r\n sum(ss_ext_sales_price) as sales,\r\n sum(ss_net_profit) as profit\r\n from store_sales,\r\n date_dim,\r\n store\r\n where ss_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date) \r\n and (cast('2000-09-22' as date)) \r\n and ss_store_sk = s_store_sk\r\n group by s_store_sk)\r\n ,\r\n sr as\r\n (select s_store_sk,\r\n sum(sr_return_amt) as returns,\r\n sum(sr_net_loss) as profit_loss\r\n from store_returns,\r\n date_dim,\r\n store\r\n where sr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and sr_store_sk = s_store_sk\r\n group by s_store_sk), \r\n cs as\r\n (select cs_call_center_sk,\r\n sum(cs_ext_sales_price) as sales,\r\n sum(cs_net_profit) as profit\r\n from catalog_sales,\r\n date_dim\r\n where cs_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cs_call_center_sk \r\n ), \r\n cr as\r\n (select cr_call_center_sk,\r\n sum(cr_return_amount) as returns,\r\n sum(cr_net_loss) as profit_loss\r\n from catalog_returns,\r\n date_dim\r\n where cr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n group by cr_call_center_sk\r\n ), \r\n ws as\r\n ( select wp_web_page_sk,\r\n sum(ws_ext_sales_price) as sales,\r\n sum(ws_net_profit) as profit\r\n from web_sales,\r\n date_dim,\r\n web_page\r\n where ws_sold_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and ws_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk), \r\n wr as\r\n (select wp_web_page_sk,\r\n sum(wr_return_amt) as returns,\r\n sum(wr_net_loss) as profit_loss\r\n from web_returns,\r\n date_dim,\r\n web_page\r\n where wr_returned_date_sk = d_date_sk\r\n and d_date between cast('2000-08-23' as date)\r\n and (cast('2000-09-22' as date))\r\n and wr_web_page_sk = wp_web_page_sk\r\n group by wp_web_page_sk)\r\n select channel\r\n , id\r\n , sum(sales) as sales\r\n , sum(returns) as returns\r\n , sum(profit) as profit\r\n from \r\n (select 'store channel' as channel\r\n , ss.s_store_sk as id\r\n , sales\r\n , coalesce(returns, 0) as returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ss left join sr\r\n on ss.s_store_sk = sr.s_store_sk\r\n union all\r\n select 'catalog channel' as channel\r\n , cs_call_center_sk as id\r\n , sales\r\n , returns\r\n , (profit - profit_loss) as profit\r\n from cs\r\n , cr\r\n union all\r\n select 'web channel' as channel\r\n , ws.wp_web_page_sk as id\r\n , sales\r\n , coalesce(returns, 0) returns\r\n , (profit - coalesce(profit_loss,0)) as profit\r\n from ws left join wr\r\n on ws.wp_web_page_sk = wr.wp_web_page_sk\r\n ) x\r\n group by rollup (channel, id)\r\n order by channel\r\n ,id\r\n limit 100\r\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "tIJ9zpLRbpZ7+K+BeXi1YA==", "id": "test-project-364309:europe-west1.query77_1665778587", "jobReference": { "jobId": "query77_1665778587", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query77_1665778587?location=europe-west1", "statistics": { "creationTime": "1665778588570", "endTime": "1665778589768", "finalExecutionDurationMs": "888", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "260079328", "performanceInsights": { "avgPreviousExecutionMs": "838" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665778588836", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01532567049808429, "readRatioMax": 0.01532567049808429, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778588794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.06896551724137931, "writeRatioMax": 0.06896551724137931 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.05747126436781609, "computeRatioMax": 0.05747126436781609, "endMs": "1665778588842", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.022988505747126436, "readRatioMax": 0.022988505747126436, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778588809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_date", "FROM date_dim", "WHERE between($151, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05747126436781609, "writeRatioMax": 0.05747126436781609 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.022988505747126436, "computeRatioMax": 0.022988505747126436, "endMs": "1665778588882", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019157088122605363, "readRatioMax": 0.019157088122605363, "recordsRead": "60", "recordsWritten": "60", "shuffleOutputBytes": "540", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778588842", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:wp_web_page_sk", "FROM web_page" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06130268199233716, "writeRatioMax": 0.06130268199233716 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665778588896", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019157088122605363, "readRatioMax": 0.019157088122605363, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778588860", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_date", "FROM date_dim", "WHERE between($141, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage04_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.019157088122605363, "waitRatioMax": 0.019157088122605363, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.05363984674329502, "computeRatioMax": 0.05363984674329502, "endMs": "1665778588993", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019157088122605363, "readRatioMax": 0.019157088122605363, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "123", "startMs": "1665778588883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_date", "FROM date_dim", "WHERE between($91, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$90", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.10344827586206896, "writeRatioMax": 0.10344827586206896 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.05363984674329502, "computeRatioMax": 0.05363984674329502, "endMs": "1665778589019", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0421455938697318, "readRatioMax": 0.0421455938697318, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "128", "startMs": "1665778588911", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_date", "FROM date_dim", "WHERE between($81, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "75", "writeMsMax": "75", "writeRatioAvg": 0.28735632183908044, "writeRatioMax": 0.28735632183908044 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02681992337164751, "computeRatioMax": 0.02681992337164751, "endMs": "1665778589055", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01532567049808429, "readRatioMax": 0.01532567049808429, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778589018", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06130268199233716, "writeRatioMax": 0.06130268199233716 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.06130268199233716, "computeRatioMax": 0.06130268199233716, "endMs": "1665778589066", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03065134099616858, "readRatioMax": 0.03065134099616858, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778589033", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_date", "FROM date_dim", "WHERE between($131, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$130", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04980842911877394, "writeRatioMax": 0.04980842911877394 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.022988505747126436, "computeRatioMax": 0.022988505747126436, "endMs": "1665778589090", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01532567049808429, "readRatioMax": 0.01532567049808429, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778589063", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06130268199233716, "writeRatioMax": 0.06130268199233716 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.034482758620689655, "computeRatioMax": 0.034482758620689655, "endMs": "1665778589107", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.022988505747126436, "readRatioMax": 0.022988505747126436, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778589080", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:d_date_sk, $121:d_date", "FROM date_dim", "WHERE between($121, 11192, 11222)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04980842911877394, "writeRatioMax": 0.04980842911877394 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.14559386973180077, "computeRatioMax": 0.14559386973180077, "endMs": "1665778589153", "id": "16", "inputStages": [ "0", "1" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.038314176245210725, "readRatioMax": 0.038314176245210725, "recordsRead": "71854", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778589107", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $592", "$370 := SUM($590)", "$371 := SUM($591)" ] }, { "kind": "JOIN", "substeps": [ "$590 := $581, $591 := $582, $592 := $50", "INNER HASH JOIN EACH WITH ALL ON $580 = $50" ] }, { "kind": "JOIN", "substeps": [ "$580 := $111, $581 := $112, $582 := $113", "INNER HASH JOIN EACH WITH ALL ON $110 = $150" ] }, { "kind": "WRITE", "substeps": [ "$600, $370, $371", "TO __stage10_output", "BY HASH($600)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02681992337164751, "writeRatioMax": 0.02681992337164751 }, { "completedParallelInputs": "1", "computeMsAvg": "261", "computeMsMax": "261", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778589286", "id": "17", "inputStages": [ "3", "4" ], "name": "S11: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.06896551724137931, "readRatioMax": 0.06896551724137931, "recordsRead": "719475", "recordsWritten": "30", "shuffleOutputBytes": "1290", "shuffleOutputBytesSpilled": "0", "slotMs": "268", "startMs": "1665778589121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$140", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $560 := $552", "$360 := SUM($550)", "$361 := SUM($551)" ] }, { "kind": "JOIN", "substeps": [ "$550 := $541, $551 := $542, $552 := $40", "INNER HASH JOIN EACH WITH ALL ON $540 = $40" ] }, { "kind": "JOIN", "substeps": [ "$540 := $101, $541 := $102, $542 := $103", "INNER HASH JOIN EACH WITH ALL ON $100 = $140" ] }, { "kind": "WRITE", "substeps": [ "$560, $360, $361", "TO __stage11_output", "BY HASH($560)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.019157088122605363, "writeRatioMax": 0.019157088122605363 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.1532567049808429, "computeRatioMax": 0.1532567049808429, "endMs": "1665778589178", "id": "18", "inputStages": [ "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0421455938697318, "readRatioMax": 0.0421455938697318, "recordsRead": "144098", "recordsWritten": "5", "shuffleOutputBytes": "207", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778589135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500", "$350 := SUM($501)", "$351 := SUM($502)" ] }, { "kind": "JOIN", "substeps": [ "$500 := $31, $501 := $32, $502 := $33", "INNER HASH JOIN EACH WITH ALL ON $30 = $90" ] }, { "kind": "WRITE", "substeps": [ "$510, $350, $351", "TO __stage12_output", "BY HASH($510)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.022988505747126436, "writeRatioMax": 0.022988505747126436 }, { "completedParallelInputs": "5", "computeMsAvg": "106", "computeMsMax": "121", "computeRatioAvg": 0.4061302681992337, "computeRatioMax": 0.46360153256704983, "endMs": "1665778589239", "id": "19", "inputStages": [ "8" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.05363984674329502, "readRatioMax": 0.06130268199233716, "recordsRead": "1441703", "recordsWritten": "20", "shuffleOutputBytes": "820", "shuffleOutputBytesSpilled": "0", "slotMs": "584", "startMs": "1665778589150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470", "$340 := SUM($471)", "$341 := SUM($472)" ] }, { "kind": "JOIN", "substeps": [ "$470 := $21, $471 := $22, $472 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $80" ] }, { "kind": "WRITE", "substeps": [ "$480, $340, $341", "TO __stage13_output", "BY HASH($480)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "8", "writeMsMax": "16", "writeRatioAvg": 0.03065134099616858, "writeRatioMax": 0.06130268199233716 }, { "completedParallelInputs": "1", "computeMsAvg": "115", "computeMsMax": "115", "computeRatioAvg": 0.44061302681992337, "computeRatioMax": 0.44061302681992337, "endMs": "1665778589244", "id": "20", "inputStages": [ "11", "10" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.05363984674329502, "readRatioMax": 0.05363984674329502, "recordsRead": "287557", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "130", "startMs": "1665778589154", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$130", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $432", "$330 := SUM($430)", "$331 := SUM($431)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421, $431 := $422, $432 := $10", "INNER HASH JOIN EACH WITH ALL ON $420 = $10" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72, $422 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $130" ] }, { "kind": "WRITE", "substeps": [ "$440, $330, $331", "TO __stage14_output", "BY HASH($440)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.011494252873563218, "writeRatioMax": 0.011494252873563218 }, { "completedParallelInputs": "6", "computeMsAvg": "162", "computeMsMax": "200", "computeRatioAvg": 0.6206896551724138, "computeRatioMax": 0.7662835249042146, "endMs": "1665778589298", "id": "21", "inputStages": [ "14", "13" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "22", "readRatioAvg": 0.06130268199233716, "readRatioMax": 0.0842911877394636, "recordsRead": "2880662", "recordsWritten": "36", "shuffleOutputBytes": "1548", "shuffleOutputBytesSpilled": "0", "slotMs": "1024", "startMs": "1665778589160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $392", "$320 := SUM($390)", "$321 := SUM($391)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $382, $392 := $1", "INNER HASH JOIN EACH WITH ALL ON $380 = $1" ] }, { "kind": "JOIN", "substeps": [ "$380 := $61, $381 := $62, $382 := $63", "INNER HASH JOIN EACH WITH ALL ON $60 = $120" ] }, { "kind": "WRITE", "substeps": [ "$400, $320, $321", "TO __stage15_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.019157088122605363, "writeRatioMax": 0.022988505747126436 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.022988505747126436, "computeRatioMax": 0.022988505747126436, "endMs": "1665778589376", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778589331", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $370, $371", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600", "$310 := SUM($370)", "$311 := SUM($371)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $610", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.10344827586206896, "writeRatioMax": 0.10344827586206896 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.10344827586206896, "computeRatioMax": 0.10344827586206896, "endMs": "1665778589376", "id": "23", "inputStages": [ "18" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "170", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778589344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$510, $350, $351", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510", "$290 := SUM($350)", "$291 := SUM($351)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06130268199233716, "writeRatioMax": 0.06130268199233716 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.034482758620689655, "computeRatioMax": 0.034482758620689655, "endMs": "1665778589391", "id": "24", "inputStages": [ "19" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778589358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$480, $340, $341", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $490 := $480", "$280 := SUM($340)", "$281 := SUM($341)" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $490", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05747126436781609, "writeRatioMax": 0.05747126436781609 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0421455938697318, "computeRatioMax": 0.0421455938697318, "endMs": "1665778589411", "id": "25", "inputStages": [ "20" ], "name": "S19: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778589374", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $330, $331", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440", "$270 := SUM($330)", "$271 := SUM($331)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $450", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05747126436781609, "writeRatioMax": 0.05747126436781609 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.03065134099616858, "computeRatioMax": 0.05747126436781609, "endMs": "1665778589442", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "40", "recordsWritten": "40", "shuffleOutputBytes": "1720", "shuffleOutputBytesSpilled": "0", "slotMs": "3854", "startMs": "1665778589382", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.01532567049808429, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.05363984674329502, "writeRatioMax": 0.08045977011494253 }, { "completedParallelInputs": "40", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.03065134099616858, "computeRatioMax": 0.05747126436781609, "endMs": "1665778589446", "id": "27", "inputStages": [ "24" ], "name": "S1B: Coalesce", "parallelInputs": "40", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4", "recordsWritten": "4", "shuffleOutputBytes": "164", "shuffleOutputBytesSpilled": "0", "slotMs": "1465", "startMs": "1665778589407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.007662835249042145, "writeMsAvg": "15", "writeMsMax": "17", "writeRatioAvg": 0.05747126436781609, "writeRatioMax": 0.06513409961685823 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.03065134099616858, "computeRatioMax": 0.04980842911877394, "endMs": "1665778589482", "id": "28", "inputStages": [ "25" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "258", "shuffleOutputBytesSpilled": "0", "slotMs": "3807", "startMs": "1665778589419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.007662835249042145, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.05747126436781609, "writeRatioMax": 0.1111111111111111 }, { "completedParallelInputs": "42", "computeMsAvg": "10", "computeMsMax": "17", "computeRatioAvg": 0.038314176245210725, "computeRatioMax": 0.06513409961685823, "endMs": "1665778589498", "id": "29", "inputStages": [ "27", "23", "26", "17", "28", "21" ], "name": "S1D: Join+", "parallelInputs": "42", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "137", "recordsWritten": "70", "shuffleOutputBytes": "5807", "shuffleOutputBytesSpilled": "0", "slotMs": "1549", "startMs": "1665778589438", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $320, $321", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $450", "FROM __stage1C_output" ] }, { "kind": "READ", "substeps": [ "$280, $281, $490", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage17_output" ] }, { "kind": "READ", "substeps": [ "$560, $360, $361", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$310, $311, $610", "FROM __stage1A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $630 := $180, $631 := $181, $632 := $200", "$170 := SUM($212)", "$171 := SUM($213)", "$172 := SUM($214)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(equal(bitwise_and($220, 1), 0), NULL, $210)", "$181 := if(equal(bitwise_and($220, 2), 0), NULL, $211)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := ARRAY<...>" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := 'store channel'", "$231 := coalesce($463, NUMERIC<...>)", "$232 := subtract($462, coalesce($464, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$460 := $410, $461 := $260, $462 := $261, $463 := $270, $464 := $271", "LEFT OUTER HASH JOIN EACH WITH ALL ON $410 = $450" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$260 := SUM($320)", "$261 := SUM($321)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := 'catalog channel'", "$241 := subtract($532, $534)" ] }, { "kind": "JOIN", "substeps": [ "$530 := $490, $531 := $280, $532 := $281, $533 := $290, $534 := $291", "CROSS EACH WITH EACH " ] }, { "kind": "COMPUTE", "substeps": [ "$250 := 'web channel'", "$251 := coalesce($623, NUMERIC<...>)", "$252 := subtract($622, coalesce($624, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$620 := $570, $621 := $300, $622 := $301, $623 := $310, $624 := $311", "LEFT OUTER HASH JOIN EACH WITH ALL ON $570 = $610" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $570 := $560", "$300 := SUM($360)", "$301 := SUM($361)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := subtract($221, 1)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $630, $631, $632", "TO __stage1D_output", "BY HASH($630, $631, $632)" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.011494252873563218, "waitRatioMax": 0.02681992337164751, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.05363984674329502, "writeRatioMax": 0.09578544061302682 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665778589626", "id": "30", "inputStages": [ "29" ], "name": "S1E: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "70", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778589589", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $630, $631, $632", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$640 ASC, $641 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $640 := $630, $641 := $631, $642 := $632", "$160 := SUM($170)", "$161 := SUM($171)", "$162 := SUM($172)" ] }, { "kind": "WRITE", "substeps": [ "$650, $651, $652, $653, $654", "TO __stage1E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05363984674329502, "writeRatioMax": 0.05363984674329502 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.038314176245210725, "computeRatioMax": 0.038314176245210725, "endMs": "1665778589643", "id": "31", "inputStages": [ "30" ], "name": "S1F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "44", "recordsWritten": "44", "shuffleOutputBytes": "3323", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778589602", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$650, $651, $652, $653, $654", "FROM __stage1E_output" ] }, { "kind": "SORT", "substeps": [ "$653 ASC, $654 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$660, $661, $662, $663, $664", "TO __stage1F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0038314176245210726, "waitRatioMax": 0.0038314176245210726, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.022988505747126436, "writeRatioMax": 0.022988505747126436 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_page" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "24", "elapsedMs": "652", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3009" }, { "activeUnits": "2", "completedUnits": "313", "elapsedMs": "1056", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14048" } ], "totalBytesBilled": "261095424", "totalBytesProcessed": "260079328", "totalPartitionsProcessed": "0", "totalSlotMs": "14048", "transferredBytes": "0" }, "startTime": "1665778588644", "totalBytesProcessed": "260079328", "totalSlotMs": "14048" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
