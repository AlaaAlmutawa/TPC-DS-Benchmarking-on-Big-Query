{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon57b7cdbd_b94e_4d24_a0fa_a1a47b82672e" }, "priority": "INTERACTIVE", "query": "select channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\n SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\n FROM store_sales, item, date_dim\n WHERE ss_customer_sk IS NULL\n AND ss_sold_date_sk=d_date_sk\n AND ss_item_sk=i_item_sk\n UNION ALL\n SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\n FROM web_sales, item, date_dim\n WHERE ws_promo_sk IS NULL\n AND ws_sold_date_sk=d_date_sk\n AND ws_item_sk=i_item_sk\n UNION ALL\n SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\n FROM catalog_sales, item, date_dim\n WHERE cs_bill_customer_sk IS NULL\n AND cs_sold_date_sk=d_date_sk\n AND cs_item_sk=i_item_sk) foo\nGROUP BY channel, col_name, d_year, d_qoy, i_category\nORDER BY channel, col_name, d_year, d_qoy, i_category\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2EpCSt8HIQMOOad29dPPaw==", "id": "test-project-364309:europe-west1.query76_1665768468", "jobReference": { "jobId": "query76_1665768468", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query76_1665768468?location=europe-west1", "statistics": { "creationTime": "1665768469456", "endTime": "1665768470134", "finalExecutionDurationMs": "447", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "199293507", "performanceInsights": { "avgPreviousExecutionMs": "411" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.2, "computeRatioMax": 0.2, "endMs": "1665768469668", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03, "readRatioMax": 0.03, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768469630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.05, "writeRatioMax": 0.05 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.08, "computeRatioMax": 0.08, "endMs": "1665768469671", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03, "readRatioMax": 0.03, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665768469644", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.055, "writeRatioMax": 0.055 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.215, "computeRatioMax": 0.215, "endMs": "1665768469718", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.035, "readRatioMax": 0.035, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768469679", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.045, "writeRatioMax": 0.045 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.08, "computeRatioMax": 0.08, "endMs": "1665768469723", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03, "readRatioMax": 0.03, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768469693", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.065, "writeRatioMax": 0.065 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.185, "computeRatioMax": 0.185, "endMs": "1665768469773", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.035, "readRatioMax": 0.035, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768469735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.05, "writeRatioMax": 0.05 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.075, "computeRatioMax": 0.075, "endMs": "1665768469797", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.025, "readRatioMax": 0.025, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768469749", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.085, "writeRatioMax": 0.085 }, { "completedParallelInputs": "12", "computeMsAvg": "129", "computeMsMax": "200", "computeRatioAvg": 0.645, "computeRatioMax": 1, "endMs": "1665768469968", "id": "9", "inputStages": [ "6", "0", "3", "7", "4", "1" ], "name": "S09: Join+", "parallelInputs": "12", "readMsAvg": "18", "readMsMax": "25", "readRatioAvg": 0.09, "readRatioMax": 0.125, "recordsRead": "6133924", "recordsWritten": "2356", "shuffleOutputBytes": "199011", "shuffleOutputBytesSpilled": "0", "slotMs": "1502", "startMs": "1665768469819", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_customer_sk", "FROM store_sales", "WHERE is_null($62)" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_promo_sk", "FROM web_sales", "WHERE is_null($72)" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_bill_customer_sk", "FROM catalog_sales", "WHERE is_null($81)" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114", "$100 := COUNT_STAR()", "$101 := SUM($115)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'", "$121 := 'ss_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $151, $162 := $2, $163 := $3", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $60, $151 := $63, $152 := $31", "INNER HASH JOIN EACH WITH ALL ON $61 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := 'web'", "$131 := 'ws_promo_sk'" ] }, { "kind": "JOIN", "substeps": [ "$180 := $172, $181 := $171, $182 := $11, $183 := $12", "INNER HASH JOIN EACH WITH ALL ON $170 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $70, $171 := $73, $172 := $41", "INNER HASH JOIN EACH WITH ALL ON $71 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 'catalog'", "$141 := 'cs_bill_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $191, $202 := $21, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $80, $191 := $83, $192 := $51", "INNER HASH JOIN EACH WITH ALL ON $82 = $50" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "TO __stage09_output", "BY HASH($210, $211, $212, $213, $214)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.02, "writeRatioMax": 0.03 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.025, "computeRatioMax": 0.025, "endMs": "1665768469993", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2356", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665768469982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214", "$90 := SUM_OF_COUNTS($100)", "$91 := SUM($101)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.005, "writeRatioMax": 0.005 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.035, "computeRatioMax": 0.035, "endMs": "1665768470034", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768469998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245, $246", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.08, "writeRatioMax": 0.08 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "20", "elapsedMs": "563", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2055" } ], "totalBytesBilled": "200278016", "totalBytesProcessed": "199293507", "totalPartitionsProcessed": "0", "totalSlotMs": "2055", "transferredBytes": "0" }, "startTime": "1665768469518", "totalBytesProcessed": "199293507", "totalSlotMs": "2055" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonccadc01a_053d_425c_a100_a0dcfd61d5fa" }, "priority": "INTERACTIVE", "query": "select channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\n SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\n FROM store_sales, item, date_dim\n WHERE ss_customer_sk IS NULL\n AND ss_sold_date_sk=d_date_sk\n AND ss_item_sk=i_item_sk\n UNION ALL\n SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\n FROM web_sales, item, date_dim\n WHERE ws_promo_sk IS NULL\n AND ws_sold_date_sk=d_date_sk\n AND ws_item_sk=i_item_sk\n UNION ALL\n SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\n FROM catalog_sales, item, date_dim\n WHERE cs_bill_customer_sk IS NULL\n AND cs_sold_date_sk=d_date_sk\n AND cs_item_sk=i_item_sk) foo\nGROUP BY channel, col_name, d_year, d_qoy, i_category\nORDER BY channel, col_name, d_year, d_qoy, i_category\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "xCLNUr9MyN0Ya41Dgbr5lw==", "id": "test-project-364309:europe-west1.query76_1665778565", "jobReference": { "jobId": "query76_1665778565", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query76_1665778565?location=europe-west1", "statistics": { "creationTime": "1665778565604", "endTime": "1665778566273", "finalExecutionDurationMs": "453", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "199293507", "performanceInsights": { "avgPreviousExecutionMs": "418" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.1694915254237288, "computeRatioMax": 0.1694915254237288, "endMs": "1665778565807", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04519774011299435, "readRatioMax": 0.04519774011299435, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778565769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.05649717514124294, "writeRatioMax": 0.05649717514124294 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.11299435028248588, "computeRatioMax": 0.11299435028248588, "endMs": "1665778565834", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04519774011299435, "readRatioMax": 0.04519774011299435, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778565790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.07344632768361582, "writeRatioMax": 0.07344632768361582 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.23728813559322035, "computeRatioMax": 0.23728813559322035, "endMs": "1665778565876", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.062146892655367235, "readRatioMax": 0.062146892655367235, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665778565835", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05084745762711865, "writeRatioMax": 0.05084745762711865 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.096045197740113, "computeRatioMax": 0.096045197740113, "endMs": "1665778565903", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02824858757062147, "readRatioMax": 0.02824858757062147, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778565858", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07909604519774012, "writeRatioMax": 0.07909604519774012 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.288135593220339, "computeRatioMax": 0.288135593220339, "endMs": "1665778565953", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03389830508474576, "readRatioMax": 0.03389830508474576, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665778565899", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0903954802259887, "writeRatioMax": 0.0903954802259887 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.15254237288135594, "computeRatioMax": 0.15254237288135594, "endMs": "1665778565970", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.06779661016949153, "readRatioMax": 0.06779661016949153, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665778565926", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.07344632768361582, "writeRatioMax": 0.07344632768361582 }, { "completedParallelInputs": "12", "computeMsAvg": "131", "computeMsMax": "177", "computeRatioAvg": 0.7401129943502824, "computeRatioMax": 1, "endMs": "1665778566112", "id": "9", "inputStages": [ "6", "1", "4", "7", "3", "0" ], "name": "S09: Join+", "parallelInputs": "12", "readMsAvg": "18", "readMsMax": "20", "readRatioAvg": 0.1016949152542373, "readRatioMax": 0.11299435028248588, "recordsRead": "6133924", "recordsWritten": "2356", "shuffleOutputBytes": "199011", "shuffleOutputBytesSpilled": "0", "slotMs": "1763", "startMs": "1665778565983", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_customer_sk", "FROM store_sales", "WHERE is_null($62)" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_promo_sk", "FROM web_sales", "WHERE is_null($72)" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_bill_customer_sk", "FROM catalog_sales", "WHERE is_null($81)" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114", "$100 := COUNT_STAR()", "$101 := SUM($115)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'", "$121 := 'ss_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $151, $162 := $2, $163 := $3", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $60, $151 := $63, $152 := $31", "INNER HASH JOIN EACH WITH ALL ON $61 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := 'web'", "$131 := 'ws_promo_sk'" ] }, { "kind": "JOIN", "substeps": [ "$180 := $172, $181 := $171, $182 := $11, $183 := $12", "INNER HASH JOIN EACH WITH ALL ON $170 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $70, $171 := $73, $172 := $41", "INNER HASH JOIN EACH WITH ALL ON $71 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 'catalog'", "$141 := 'cs_bill_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $191, $202 := $21, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $80, $191 := $83, $192 := $51", "INNER HASH JOIN EACH WITH ALL ON $82 = $50" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "TO __stage09_output", "BY HASH($210, $211, $212, $213, $214)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "5", "writeMsMax": "10", "writeRatioAvg": 0.02824858757062147, "writeRatioMax": 0.05649717514124294 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.096045197740113, "computeRatioMax": 0.096045197740113, "endMs": "1665778566145", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2356", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778566122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214", "$90 := SUM_OF_COUNTS($100)", "$91 := SUM($101)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.022598870056497175, "writeRatioMax": 0.022598870056497175 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05649717514124294, "computeRatioMax": 0.05649717514124294, "endMs": "1665778566179", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778566141", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245, $246", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.096045197740113, "writeRatioMax": 0.096045197740113 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "20", "elapsedMs": "563", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2752" } ], "totalBytesBilled": "200278016", "totalBytesProcessed": "199293507", "totalPartitionsProcessed": "0", "totalSlotMs": "2752", "transferredBytes": "0" }, "startTime": "1665778565656", "totalBytesProcessed": "199293507", "totalSlotMs": "2752" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone2d3f258_395b_4775_bf4b_dacde3467f80" }, "priority": "INTERACTIVE", "query": "select channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\n SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\n FROM store_sales, item, date_dim\n WHERE ss_customer_sk IS NULL\n AND ss_sold_date_sk=d_date_sk\n AND ss_item_sk=i_item_sk\n UNION ALL\n SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\n FROM web_sales, item, date_dim\n WHERE ws_promo_sk IS NULL\n AND ws_sold_date_sk=d_date_sk\n AND ws_item_sk=i_item_sk\n UNION ALL\n SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\n FROM catalog_sales, item, date_dim\n WHERE cs_bill_customer_sk IS NULL\n AND cs_sold_date_sk=d_date_sk\n AND cs_item_sk=i_item_sk) foo\nGROUP BY channel, col_name, d_year, d_qoy, i_category\nORDER BY channel, col_name, d_year, d_qoy, i_category\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/mqqsaF9BT4hwdgway0Xdg==", "id": "test-project-364309:europe-west1.query76_1665778567", "jobReference": { "jobId": "query76_1665778567", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query76_1665778567?location=europe-west1", "statistics": { "creationTime": "1665778567893", "endTime": "1665778568480", "finalExecutionDurationMs": "389", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "199293507", "performanceInsights": { "avgPreviousExecutionMs": "424" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.19318181818181818, "computeRatioMax": 0.19318181818181818, "endMs": "1665778568075", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.045454545454545456, "readRatioMax": 0.045454545454545456, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778568039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005681818181818182, "waitRatioMax": 0.005681818181818182, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05113636363636364, "writeRatioMax": 0.05113636363636364 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.07386363636363637, "computeRatioMax": 0.07386363636363637, "endMs": "1665778568078", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.022727272727272728, "readRatioMax": 0.022727272727272728, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778568051", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005681818181818182, "waitRatioMax": 0.005681818181818182, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.06818181818181818, "writeRatioMax": 0.06818181818181818 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.16477272727272727, "computeRatioMax": 0.16477272727272727, "endMs": "1665778568113", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.056818181818181816, "readRatioMax": 0.056818181818181816, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778568077", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005681818181818182, "waitRatioMax": 0.005681818181818182, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.045454545454545456, "writeRatioMax": 0.045454545454545456 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.07954545454545454, "computeRatioMax": 0.07954545454545454, "endMs": "1665778568144", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.028409090909090908, "readRatioMax": 0.028409090909090908, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778568113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage04_output" ] } ], "waitMsAvg": "22", "waitMsMax": "22", "waitRatioAvg": 0.125, "waitRatioMax": 0.125, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.09090909090909091, "writeRatioMax": 0.09090909090909091 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.17045454545454544, "computeRatioMax": 0.17045454545454544, "endMs": "1665778568157", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03409090909090909, "readRatioMax": 0.03409090909090909, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778568123", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.03409090909090909, "waitRatioMax": 0.03409090909090909, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.045454545454545456, "writeRatioMax": 0.045454545454545456 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.07954545454545454, "computeRatioMax": 0.07954545454545454, "endMs": "1665778568173", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.028409090909090908, "readRatioMax": 0.028409090909090908, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778568144", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.07386363636363637, "waitRatioMax": 0.07386363636363637, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.08522727272727272, "writeRatioMax": 0.08522727272727272 }, { "completedParallelInputs": "12", "computeMsAvg": "124", "computeMsMax": "176", "computeRatioAvg": 0.7045454545454546, "computeRatioMax": 1, "endMs": "1665778568331", "id": "9", "inputStages": [ "7", "3", "0", "6", "1", "4" ], "name": "S09: Join+", "parallelInputs": "12", "readMsAvg": "19", "readMsMax": "25", "readRatioAvg": 0.10795454545454546, "readRatioMax": 0.14204545454545456, "recordsRead": "6133924", "recordsWritten": "2356", "shuffleOutputBytes": "199011", "shuffleOutputBytesSpilled": "0", "slotMs": "1548", "startMs": "1665778568184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_customer_sk", "FROM store_sales", "WHERE is_null($62)" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_promo_sk", "FROM web_sales", "WHERE is_null($72)" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_bill_customer_sk", "FROM catalog_sales", "WHERE is_null($81)" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114", "$100 := COUNT_STAR()", "$101 := SUM($115)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'", "$121 := 'ss_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $151, $162 := $2, $163 := $3", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $60, $151 := $63, $152 := $31", "INNER HASH JOIN EACH WITH ALL ON $61 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := 'web'", "$131 := 'ws_promo_sk'" ] }, { "kind": "JOIN", "substeps": [ "$180 := $172, $181 := $171, $182 := $11, $183 := $12", "INNER HASH JOIN EACH WITH ALL ON $170 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $70, $171 := $73, $172 := $41", "INNER HASH JOIN EACH WITH ALL ON $71 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 'catalog'", "$141 := 'cs_bill_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $191, $202 := $21, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $80, $191 := $83, $192 := $51", "INNER HASH JOIN EACH WITH ALL ON $82 = $50" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "TO __stage09_output", "BY HASH($210, $211, $212, $213, $214)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011363636363636364, "waitRatioMax": 0.011363636363636364, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.028409090909090908, "writeRatioMax": 0.03409090909090909 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03409090909090909, "computeRatioMax": 0.03409090909090909, "endMs": "1665778568347", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2356", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665778568338", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214", "$90 := SUM_OF_COUNTS($100)", "$91 := SUM($101)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011363636363636364, "waitRatioMax": 0.011363636363636364, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.005681818181818182, "writeRatioMax": 0.005681818181818182 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03977272727272727, "computeRatioMax": 0.03977272727272727, "endMs": "1665778568392", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778568356", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245, $246", "TO __stage0B_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.028409090909090908, "waitRatioMax": 0.028409090909090908, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.07386363636363637, "writeRatioMax": 0.07386363636363637 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "20", "elapsedMs": "482", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2101" } ], "totalBytesBilled": "200278016", "totalBytesProcessed": "199293507", "totalPartitionsProcessed": "0", "totalSlotMs": "2101", "transferredBytes": "0" }, "startTime": "1665778567953", "totalBytesProcessed": "199293507", "totalSlotMs": "2101" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0a9d8514_7bd5_40d7_843d_ed511004dd54" }, "priority": "INTERACTIVE", "query": "select channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\n SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\n FROM store_sales, item, date_dim\n WHERE ss_customer_sk IS NULL\n AND ss_sold_date_sk=d_date_sk\n AND ss_item_sk=i_item_sk\n UNION ALL\n SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\n FROM web_sales, item, date_dim\n WHERE ws_promo_sk IS NULL\n AND ws_sold_date_sk=d_date_sk\n AND ws_item_sk=i_item_sk\n UNION ALL\n SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\n FROM catalog_sales, item, date_dim\n WHERE cs_bill_customer_sk IS NULL\n AND cs_sold_date_sk=d_date_sk\n AND cs_item_sk=i_item_sk) foo\nGROUP BY channel, col_name, d_year, d_qoy, i_category\nORDER BY channel, col_name, d_year, d_qoy, i_category\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "7tq2t32U/AcW6PiyC0APYg==", "id": "test-project-364309:europe-west1.query76_1665778569", "jobReference": { "jobId": "query76_1665778569", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query76_1665778569?location=europe-west1", "statistics": { "creationTime": "1665778570031", "endTime": "1665778570610", "finalExecutionDurationMs": "382", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "199293507", "performanceInsights": { "avgPreviousExecutionMs": "419" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.2974683544303797, "computeRatioMax": 0.2974683544303797, "endMs": "1665778570245", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.12025316455696203, "readRatioMax": 0.12025316455696203, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665778570176", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.13924050632911392, "writeRatioMax": 0.13924050632911392 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.12658227848101267, "computeRatioMax": 0.12658227848101267, "endMs": "1665778570223", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04430379746835443, "readRatioMax": 0.04430379746835443, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778570192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.06329113924050633, "writeRatioMax": 0.06329113924050633 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.3037974683544304, "computeRatioMax": 0.3037974683544304, "endMs": "1665778570264", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05063291139240506, "readRatioMax": 0.05063291139240506, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778570221", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.06962025316455696, "writeRatioMax": 0.06962025316455696 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.17088607594936708, "computeRatioMax": 0.17088607594936708, "endMs": "1665778570290", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.08860759493670886, "readRatioMax": 0.08860759493670886, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665778570245", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage04_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.056962025316455694, "waitRatioMax": 0.056962025316455694, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08860759493670886, "writeRatioMax": 0.08860759493670886 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.34810126582278483, "computeRatioMax": 0.34810126582278483, "endMs": "1665778570305", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03164556962025317, "readRatioMax": 0.03164556962025317, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778570264", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.04430379746835443, "writeRatioMax": 0.04430379746835443 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.10759493670886076, "computeRatioMax": 0.10759493670886076, "endMs": "1665778570324", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.056962025316455694, "readRatioMax": 0.056962025316455694, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778570286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.06329113924050633, "waitRatioMax": 0.06329113924050633, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.10759493670886076, "writeRatioMax": 0.10759493670886076 }, { "completedParallelInputs": "12", "computeMsAvg": "126", "computeMsMax": "158", "computeRatioAvg": 0.7974683544303798, "computeRatioMax": 1, "endMs": "1665778570468", "id": "10", "inputStages": [ "6", "1", "7", "0", "4", "3" ], "name": "S0A: Join+", "parallelInputs": "12", "readMsAvg": "17", "readMsMax": "23", "readRatioAvg": 0.10759493670886076, "readRatioMax": 0.14556962025316456, "recordsRead": "6133924", "recordsWritten": "2356", "shuffleOutputBytes": "199011", "shuffleOutputBytesSpilled": "0", "slotMs": "1702", "startMs": "1665778570332", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_customer_sk", "FROM store_sales", "WHERE is_null($62)" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_promo_sk", "FROM web_sales", "WHERE is_null($72)" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_bill_customer_sk", "FROM catalog_sales", "WHERE is_null($81)" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114", "$100 := COUNT_STAR()", "$101 := SUM($115)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'", "$121 := 'ss_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $151, $162 := $2, $163 := $3", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $60, $151 := $63, $152 := $31", "INNER HASH JOIN EACH WITH ALL ON $61 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := 'web'", "$131 := 'ws_promo_sk'" ] }, { "kind": "JOIN", "substeps": [ "$180 := $172, $181 := $171, $182 := $11, $183 := $12", "INNER HASH JOIN EACH WITH ALL ON $170 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $70, $171 := $73, $172 := $41", "INNER HASH JOIN EACH WITH ALL ON $71 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 'catalog'", "$141 := 'cs_bill_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $191, $202 := $21, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $80, $191 := $83, $192 := $51", "INNER HASH JOIN EACH WITH ALL ON $82 = $50" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "TO __stage0A_output", "BY HASH($210, $211, $212, $213, $214)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.03164556962025317, "writeRatioMax": 0.0379746835443038 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.05063291139240506, "endMs": "1665778570487", "id": "11", "inputStages": [ "10" ], "name": "S0B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2356", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665778570476", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214", "$90 := SUM_OF_COUNTS($100)", "$91 := SUM($101)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.006329113924050633, "writeRatioMax": 0.006329113924050633 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.05063291139240506, "endMs": "1665778570525", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778570490", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245, $246", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006329113924050633, "waitRatioMax": 0.006329113924050633, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.16455696202531644, "writeRatioMax": 0.16455696202531644 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "20", "elapsedMs": "477", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2500" } ], "totalBytesBilled": "200278016", "totalBytesProcessed": "199293507", "totalPartitionsProcessed": "0", "totalSlotMs": "2500", "transferredBytes": "0" }, "startTime": "1665778570081", "totalBytesProcessed": "199293507", "totalSlotMs": "2500" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon64c9eb07_cf30_44a0_8309_b7b71544c347" }, "priority": "INTERACTIVE", "query": "select channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\n SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\n FROM store_sales, item, date_dim\n WHERE ss_customer_sk IS NULL\n AND ss_sold_date_sk=d_date_sk\n AND ss_item_sk=i_item_sk\n UNION ALL\n SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\n FROM web_sales, item, date_dim\n WHERE ws_promo_sk IS NULL\n AND ws_sold_date_sk=d_date_sk\n AND ws_item_sk=i_item_sk\n UNION ALL\n SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\n FROM catalog_sales, item, date_dim\n WHERE cs_bill_customer_sk IS NULL\n AND cs_sold_date_sk=d_date_sk\n AND cs_item_sk=i_item_sk) foo\nGROUP BY channel, col_name, d_year, d_qoy, i_category\nORDER BY channel, col_name, d_year, d_qoy, i_category\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "olEhxisnpObqoFU156XaOg==", "id": "test-project-364309:europe-west1.query76_1665778571", "jobReference": { "jobId": "query76_1665778571", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query76_1665778571?location=europe-west1", "statistics": { "creationTime": "1665778572312", "endTime": "1665778572938", "finalExecutionDurationMs": "415", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "199293507", "performanceInsights": { "avgPreviousExecutionMs": "414" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.23958333333333334, "computeRatioMax": 0.23958333333333334, "endMs": "1665778572508", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.052083333333333336, "readRatioMax": 0.052083333333333336, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665778572461", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.06770833333333333, "computeRatioMax": 0.06770833333333333, "endMs": "1665778572517", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.026041666666666668, "readRatioMax": 0.026041666666666668, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778572478", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.13020833333333334, "writeRatioMax": 0.13020833333333334 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.16666666666666666, "computeRatioMax": 0.16666666666666666, "endMs": "1665778572553", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778572518", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.041666666666666664, "waitRatioMax": 0.041666666666666664, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.046875, "writeRatioMax": 0.046875 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.08854166666666667, "computeRatioMax": 0.08854166666666667, "endMs": "1665778572575", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.026041666666666668, "readRatioMax": 0.026041666666666668, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778572547", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage04_output" ] } ], "waitMsAvg": "23", "waitMsMax": "23", "waitRatioAvg": 0.11979166666666667, "waitRatioMax": 0.11979166666666667, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06770833333333333, "writeRatioMax": 0.06770833333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.21875, "computeRatioMax": 0.21875, "endMs": "1665778572592", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665778572558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.015625, "waitRatioMax": 0.015625, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.057291666666666664, "writeRatioMax": 0.057291666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.10416666666666667, "computeRatioMax": 0.10416666666666667, "endMs": "1665778572612", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.041666666666666664, "readRatioMax": 0.041666666666666664, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778572572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "12", "computeMsAvg": "132", "computeMsMax": "192", "computeRatioAvg": 0.6875, "computeRatioMax": 1, "endMs": "1665778572768", "id": "9", "inputStages": [ "3", "7", "6", "0", "1", "4" ], "name": "S09: Join+", "parallelInputs": "12", "readMsAvg": "19", "readMsMax": "22", "readRatioAvg": 0.09895833333333333, "readRatioMax": 0.11458333333333333, "recordsRead": "6133924", "recordsWritten": "2356", "shuffleOutputBytes": "199011", "shuffleOutputBytesSpilled": "0", "slotMs": "1727", "startMs": "1665778572627", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_customer_sk", "FROM store_sales", "WHERE is_null($62)" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_promo_sk", "FROM web_sales", "WHERE is_null($72)" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_bill_customer_sk", "FROM catalog_sales", "WHERE is_null($81)" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114", "$100 := COUNT_STAR()", "$101 := SUM($115)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'", "$121 := 'ss_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $151, $162 := $2, $163 := $3", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $60, $151 := $63, $152 := $31", "INNER HASH JOIN EACH WITH ALL ON $61 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := 'web'", "$131 := 'ws_promo_sk'" ] }, { "kind": "JOIN", "substeps": [ "$180 := $172, $181 := $171, $182 := $11, $183 := $12", "INNER HASH JOIN EACH WITH ALL ON $170 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $70, $171 := $73, $172 := $41", "INNER HASH JOIN EACH WITH ALL ON $71 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 'catalog'", "$141 := 'cs_bill_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $191, $202 := $21, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $80, $191 := $83, $192 := $51", "INNER HASH JOIN EACH WITH ALL ON $82 = $50" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "TO __stage09_output", "BY HASH($210, $211, $212, $213, $214)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.026041666666666668, "writeRatioMax": 0.026041666666666668 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.052083333333333336, "computeRatioMax": 0.052083333333333336, "endMs": "1665778572790", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2356", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665778572774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214", "$90 := SUM_OF_COUNTS($100)", "$91 := SUM($101)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.005208333333333333, "writeRatioMax": 0.005208333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.08854166666666667, "computeRatioMax": 0.08854166666666667, "endMs": "1665778572842", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665778572791", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245, $246", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005208333333333333, "waitRatioMax": 0.005208333333333333, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.14583333333333334, "writeRatioMax": 0.14583333333333334 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "20", "elapsedMs": "516", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2521" } ], "totalBytesBilled": "200278016", "totalBytesProcessed": "199293507", "totalPartitionsProcessed": "0", "totalSlotMs": "2521", "transferredBytes": "0" }, "startTime": "1665778572358", "totalBytesProcessed": "199293507", "totalSlotMs": "2521" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon50fa7aeb_2f20_4a1f_a6d3_3cea7dd0a5e6" }, "priority": "INTERACTIVE", "query": "select channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\n SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\n FROM store_sales, item, date_dim\n WHERE ss_customer_sk IS NULL\n AND ss_sold_date_sk=d_date_sk\n AND ss_item_sk=i_item_sk\n UNION ALL\n SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\n FROM web_sales, item, date_dim\n WHERE ws_promo_sk IS NULL\n AND ws_sold_date_sk=d_date_sk\n AND ws_item_sk=i_item_sk\n UNION ALL\n SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\n FROM catalog_sales, item, date_dim\n WHERE cs_bill_customer_sk IS NULL\n AND cs_sold_date_sk=d_date_sk\n AND cs_item_sk=i_item_sk) foo\nGROUP BY channel, col_name, d_year, d_qoy, i_category\nORDER BY channel, col_name, d_year, d_qoy, i_category\nlimit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "AIWWD4z/n9NFvVhKnuC3jg==", "id": "test-project-364309:europe-west1.query76_1665778574", "jobReference": { "jobId": "query76_1665778574", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query76_1665778574?location=europe-west1", "statistics": { "creationTime": "1665778574597", "endTime": "1665778575269", "finalExecutionDurationMs": "458", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "199293507", "performanceInsights": { "avgPreviousExecutionMs": "414" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.25742574257425743, "computeRatioMax": 0.25742574257425743, "endMs": "1665778574792", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.034653465346534656, "readRatioMax": 0.034653465346534656, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665778574749", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0049504950495049506, "waitRatioMax": 0.0049504950495049506, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04950495049504951, "writeRatioMax": 0.04950495049504951 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.07920792079207921, "endMs": "1665778574812", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.024752475247524754, "readRatioMax": 0.024752475247524754, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778574770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:i_item_sk, $51:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0049504950495049506, "waitRatioMax": 0.0049504950495049506, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06930693069306931, "writeRatioMax": 0.06930693069306931 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.19306930693069307, "computeRatioMax": 0.19306930693069307, "endMs": "1665778574860", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.034653465346534656, "readRatioMax": 0.034653465346534656, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665778574813", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage03_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.034653465346534656, "waitRatioMax": 0.034653465346534656, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.039603960396039604, "writeRatioMax": 0.039603960396039604 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.07920792079207921, "computeRatioMax": 0.07920792079207921, "endMs": "1665778574882", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.019801980198019802, "readRatioMax": 0.019801980198019802, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778574842", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage04_output" ] } ], "waitMsAvg": "17", "waitMsMax": "17", "waitRatioAvg": 0.08415841584158416, "waitRatioMax": 0.08415841584158416, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06930693069306931, "writeRatioMax": 0.06930693069306931 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.25742574257425743, "computeRatioMax": 0.25742574257425743, "endMs": "1665778574935", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0594059405940594, "readRatioMax": 0.0594059405940594, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1972323", "shuffleOutputBytesSpilled": "0", "slotMs": "88", "startMs": "1665778574863", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.09900990099009901, "writeRatioMax": 0.09900990099009901 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.09900990099009901, "computeRatioMax": 0.09900990099009901, "endMs": "1665778574924", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.034653465346534656, "readRatioMax": 0.034653465346534656, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778574882", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0049504950495049506, "waitRatioMax": 0.0049504950495049506, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.09900990099009901, "writeRatioMax": 0.09900990099009901 }, { "completedParallelInputs": "12", "computeMsAvg": "124", "computeMsMax": "202", "computeRatioAvg": 0.6138613861386139, "computeRatioMax": 1, "endMs": "1665778575108", "id": "10", "inputStages": [ "1", "4", "3", "0", "7", "6" ], "name": "S0A: Join+", "parallelInputs": "12", "readMsAvg": "17", "readMsMax": "26", "readRatioAvg": 0.08415841584158416, "readRatioMax": 0.12871287128712872, "recordsRead": "6133924", "recordsWritten": "2356", "shuffleOutputBytes": "199011", "shuffleOutputBytesSpilled": "0", "slotMs": "1829", "startMs": "1665778574959", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_customer_sk", "FROM store_sales", "WHERE is_null($62)" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_promo_sk", "FROM web_sales", "WHERE is_null($72)" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_bill_customer_sk", "FROM catalog_sales", "WHERE is_null($81)" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114", "$100 := COUNT_STAR()", "$101 := SUM($115)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := 'store'", "$121 := 'ss_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$160 := $152, $161 := $151, $162 := $2, $163 := $3", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $60, $151 := $63, $152 := $31", "INNER HASH JOIN EACH WITH ALL ON $61 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := 'web'", "$131 := 'ws_promo_sk'" ] }, { "kind": "JOIN", "substeps": [ "$180 := $172, $181 := $171, $182 := $11, $183 := $12", "INNER HASH JOIN EACH WITH ALL ON $170 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $70, $171 := $73, $172 := $41", "INNER HASH JOIN EACH WITH ALL ON $71 = $40" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 'catalog'", "$141 := 'cs_bill_customer_sk'" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $191, $202 := $21, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $80, $191 := $83, $192 := $51", "INNER HASH JOIN EACH WITH ALL ON $82 = $50" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "TO __stage0A_output", "BY HASH($210, $211, $212, $213, $214)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.01485148514851485, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.024752475247524754, "writeRatioMax": 0.034653465346534656 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.034653465346534656, "computeRatioMax": 0.034653465346534656, "endMs": "1665778575134", "id": "11", "inputStages": [ "10" ], "name": "S0B: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2356", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665778575124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $210, $211, $212, $213, $214", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214", "$90 := SUM_OF_COUNTS($100)", "$91 := SUM($101)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.019801980198019802, "waitRatioMax": 0.019801980198019802, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04455445544554455, "computeRatioMax": 0.04455445544554455, "endMs": "1665778575174", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9046", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778575139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245, $246", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0049504950495049506, "waitRatioMax": 0.0049504950495049506, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07425742574257425, "writeRatioMax": 0.07425742574257425 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "20", "elapsedMs": "565", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2703" } ], "totalBytesBilled": "200278016", "totalBytesProcessed": "199293507", "totalPartitionsProcessed": "0", "totalSlotMs": "2703", "transferredBytes": "0" }, "startTime": "1665778574647", "totalBytesProcessed": "199293507", "totalSlotMs": "2703" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
