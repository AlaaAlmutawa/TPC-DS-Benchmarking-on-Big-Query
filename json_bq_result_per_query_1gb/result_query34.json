{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbe4ed6ff_6d6e_43c6_907a_ab74c95aab0e" }, "priority": "INTERACTIVE", "query": "-- start query 34 in stream 0 using template query34.tpl\nselect c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag\n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and (case when household_demographics.hd_vehicle_count > 0 \n\tthen (household_demographics.hd_dep_count*1.000)/ household_demographics.hd_vehicle_count \n\telse null \n\tend) > 1.2\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County','Williamson County','Williamson County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dn,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 15 and 20\n order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\n\n-- end query 34 in stream 0 using template query34.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "TwxNIcA4t4kc7fNjU/sIYQ==", "id": "test-project-364309:europe-west1.query34_1665768323", "jobReference": { "jobId": "query34_1665768323", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query34_1665768323?location=europe-west1", "statistics": { "creationTime": "1665768323695", "endTime": "1665768324397", "finalExecutionDurationMs": "499", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "522" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.07643312101910828, "computeRatioMax": 0.07643312101910828, "endMs": "1665768323893", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03821656050955414, "readRatioMax": 0.03821656050955414, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768323850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012738853503184714, "waitRatioMax": 0.012738853503184714, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.10828025477707007, "writeRatioMax": 0.10828025477707007 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05732484076433121, "computeRatioMax": 0.05732484076433121, "endMs": "1665768323909", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.025477707006369428, "readRatioMax": 0.025477707006369428, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768323867", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.10828025477707007, "writeRatioMax": 0.10828025477707007 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.09554140127388536, "computeRatioMax": 0.09554140127388536, "endMs": "1665768323925", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.08280254777070063, "readRatioMax": 0.08280254777070063, "recordsRead": "73049", "recordsWritten": "252", "shuffleOutputBytes": "2268", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768323886", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07006369426751592, "writeRatioMax": 0.07006369426751592 }, { "completedParallelInputs": "6", "computeMsAvg": "128", "computeMsMax": "157", "computeRatioAvg": 0.8152866242038217, "computeRatioMax": 1, "endMs": "1665768324072", "id": "4", "inputStages": [ "2", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "27", "readRatioAvg": 0.10828025477707007, "readRatioMax": 0.17197452229299362, "recordsRead": "2888228", "recordsWritten": "24680", "shuffleOutputBytes": "663896", "shuffleOutputBytesSpilled": "0", "slotMs": "830", "startMs": "1665768323939", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.012738853503184714, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.03184713375796178, "writeRatioMax": 0.03821656050955414 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.1464968152866242, "computeRatioMax": 0.1464968152866242, "endMs": "1665768324164", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24680", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768324116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 15, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.12738853503184713, "writeRatioMax": 0.12738853503184713 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.050955414012738856, "computeRatioMax": 0.08280254777070063, "endMs": "1665768324239", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "3867", "startMs": "1665768324173", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012738853503184714, "waitRatioMax": 0.01910828025477707, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.11464968152866242, "writeRatioMax": 0.18471337579617833 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.19745222929936307, "computeRatioMax": 0.19745222929936307, "endMs": "1665768324263", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.050955414012738856, "readRatioMax": 0.050955414012738856, "recordsRead": "100451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768324180", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01910828025477707, "waitRatioMax": 0.01910828025477707, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03184713375796178, "writeRatioMax": 0.03184713375796178 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.07643312101910828, "computeRatioMax": 0.07643312101910828, "endMs": "1665768324317", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768324276", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$124 ASC, $123 ASC, $122 ASC, $125 DESC, $120 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006369426751592357, "waitRatioMax": 0.006369426751592357, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.10828025477707007, "writeRatioMax": 0.10828025477707007 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "601", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4960" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "4960", "transferredBytes": "0" }, "startTime": "1665768323744", "totalBytesProcessed": "116189683", "totalSlotMs": "4960" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond5436016_e49f_49d5_88e7_1ff5c60cd032" }, "priority": "INTERACTIVE", "query": "-- start query 34 in stream 0 using template query34.tpl\nselect c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag\n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and (case when household_demographics.hd_vehicle_count > 0 \n\tthen (household_demographics.hd_dep_count*1.000)/ household_demographics.hd_vehicle_count \n\telse null \n\tend) > 1.2\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County','Williamson County','Williamson County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dn,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 15 and 20\n order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\n\n-- end query 34 in stream 0 using template query34.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "HJnCTuyn7YbaOeKYOMRI9Q==", "id": "test-project-364309:europe-west1.query34_1665777299", "jobReference": { "jobId": "query34_1665777299", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query34_1665777299?location=europe-west1", "statistics": { "creationTime": "1665777300084", "endTime": "1665777300905", "finalExecutionDurationMs": "597", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "518" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.09433962264150944, "computeRatioMax": 0.09433962264150944, "endMs": "1665777300289", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.031446540880503145, "readRatioMax": 0.031446540880503145, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777300256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012578616352201259, "waitRatioMax": 0.012578616352201259, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.050314465408805034, "writeRatioMax": 0.050314465408805034 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.09433962264150944, "computeRatioMax": 0.09433962264150944, "endMs": "1665777300335", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03773584905660377, "readRatioMax": 0.03773584905660377, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777300298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.018867924528301886, "waitRatioMax": 0.018867924528301886, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05660377358490566, "writeRatioMax": 0.05660377358490566 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.10062893081761007, "computeRatioMax": 0.10062893081761007, "endMs": "1665777300350", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.050314465408805034, "readRatioMax": 0.050314465408805034, "recordsRead": "73049", "recordsWritten": "252", "shuffleOutputBytes": "2268", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777300314", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012578616352201259, "waitRatioMax": 0.012578616352201259, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.050314465408805034, "writeRatioMax": 0.050314465408805034 }, { "completedParallelInputs": "6", "computeMsAvg": "129", "computeMsMax": "159", "computeRatioAvg": 0.8113207547169812, "computeRatioMax": 1, "endMs": "1665777300557", "id": "4", "inputStages": [ "0", "1", "2" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "28", "readRatioAvg": 0.10062893081761007, "readRatioMax": 0.1761006289308176, "recordsRead": "2888228", "recordsWritten": "24680", "shuffleOutputBytes": "663896", "shuffleOutputBytesSpilled": "0", "slotMs": "893", "startMs": "1665777300366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "5", "writeMsMax": "9", "writeRatioAvg": 0.031446540880503145, "writeRatioMax": 0.05660377358490566 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.12578616352201258, "computeRatioMax": 0.12578616352201258, "endMs": "1665777300642", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24680", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777300607", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 15, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.06289308176100629, "writeRatioMax": 0.06289308176100629 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.050314465408805034, "computeRatioMax": 0.0880503144654088, "endMs": "1665777300717", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "3579", "startMs": "1665777300659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012578616352201259, "waitRatioMax": 0.018867924528301886, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.09433962264150944, "writeRatioMax": 0.11320754716981132 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.2138364779874214, "computeRatioMax": 0.2138364779874214, "endMs": "1665777300763", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.13836477987421383, "readRatioMax": 0.13836477987421383, "recordsRead": "100451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777300663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.025157232704402517, "waitRatioMax": 0.025157232704402517, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0440251572327044, "writeRatioMax": 0.0440251572327044 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05660377358490566, "computeRatioMax": 0.05660377358490566, "endMs": "1665777300806", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777300770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$124 ASC, $123 ASC, $122 ASC, $125 DESC, $120 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.15723270440251572, "writeRatioMax": 0.15723270440251572 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "110", "elapsedMs": "609", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4620" }, { "activeUnits": "1", "completedUnits": "112", "elapsedMs": "700", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4711" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "4711", "transferredBytes": "0" }, "startTime": "1665777300148", "totalBytesProcessed": "116189683", "totalSlotMs": "4711" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon261b7e1f_1316_4fb7_b5ea_8817e2124253" }, "priority": "INTERACTIVE", "query": "-- start query 34 in stream 0 using template query34.tpl\nselect c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag\n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and (case when household_demographics.hd_vehicle_count > 0 \n\tthen (household_demographics.hd_dep_count*1.000)/ household_demographics.hd_vehicle_count \n\telse null \n\tend) > 1.2\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County','Williamson County','Williamson County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dn,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 15 and 20\n order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\n\n-- end query 34 in stream 0 using template query34.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ZeRfEt9dDXcjZfy0kjWAkQ==", "id": "test-project-364309:europe-west1.query34_1665777302", "jobReference": { "jobId": "query34_1665777302", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query34_1665777302?location=europe-west1", "statistics": { "creationTime": "1665777302642", "endTime": "1665777303389", "finalExecutionDurationMs": "570", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "529" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04020100502512563, "computeRatioMax": 0.04020100502512563, "endMs": "1665777302816", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.01507537688442211, "readRatioMax": 0.01507537688442211, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777302778", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.09045226130653267, "writeRatioMax": 0.09045226130653267 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05025125628140704, "computeRatioMax": 0.05025125628140704, "endMs": "1665777302853", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04020100502512563, "readRatioMax": 0.04020100502512563, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777302798", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.10050251256281408, "writeRatioMax": 0.10050251256281408 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05527638190954774, "computeRatioMax": 0.05527638190954774, "endMs": "1665777302860", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04020100502512563, "readRatioMax": 0.04020100502512563, "recordsRead": "73049", "recordsWritten": "252", "shuffleOutputBytes": "2268", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777302817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07537688442211055, "writeRatioMax": 0.07537688442211055 }, { "completedParallelInputs": "6", "computeMsAvg": "150", "computeMsMax": "199", "computeRatioAvg": 0.7537688442211056, "computeRatioMax": 1, "endMs": "1665777303012", "id": "4", "inputStages": [ "1", "0", "2" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "19", "readRatioAvg": 0.07537688442211055, "readRatioMax": 0.09547738693467336, "recordsRead": "2888228", "recordsWritten": "24680", "shuffleOutputBytes": "663896", "shuffleOutputBytesSpilled": "0", "slotMs": "929", "startMs": "1665777302870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.02512562814070352, "writeRatioMax": 0.035175879396984924 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.10552763819095477, "computeRatioMax": 0.10552763819095477, "endMs": "1665777303122", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24680", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777303061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 15, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "46", "writeMsMax": "46", "writeRatioAvg": 0.23115577889447236, "writeRatioMax": 0.23115577889447236 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.04522613065326633, "computeRatioMax": 0.09045226130653267, "endMs": "1665777303204", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "5301", "startMs": "1665777303130", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.010050251256281407, "writeMsAvg": "26", "writeMsMax": "32", "writeRatioAvg": 0.1306532663316583, "writeRatioMax": 0.16080402010050251 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.19597989949748743, "computeRatioMax": 0.19597989949748743, "endMs": "1665777303237", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.05025125628140704, "readRatioMax": 0.05025125628140704, "recordsRead": "100451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777303134", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01507537688442211, "waitRatioMax": 0.01507537688442211, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.01507537688442211, "writeRatioMax": 0.01507537688442211 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06030150753768844, "computeRatioMax": 0.06030150753768844, "endMs": "1665777303314", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777303260", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$124 ASC, $123 ASC, $122 ASC, $125 DESC, $120 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.1507537688442211, "writeRatioMax": 0.1507537688442211 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "111", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6508" }, { "activeUnits": "1", "completedUnits": "112", "elapsedMs": "653", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6557" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "6557", "transferredBytes": "0" }, "startTime": "1665777302685", "totalBytesProcessed": "116189683", "totalSlotMs": "6557" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf9229fd9_9283_4a3b_841f_944b04bb3a9a" }, "priority": "INTERACTIVE", "query": "-- start query 34 in stream 0 using template query34.tpl\nselect c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag\n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and (case when household_demographics.hd_vehicle_count > 0 \n\tthen (household_demographics.hd_dep_count*1.000)/ household_demographics.hd_vehicle_count \n\telse null \n\tend) > 1.2\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County','Williamson County','Williamson County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dn,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 15 and 20\n order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\n\n-- end query 34 in stream 0 using template query34.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "r9TwxbaWfkpj7MsvVGvh3Q==", "id": "test-project-364309:europe-west1.query34_1665777304", "jobReference": { "jobId": "query34_1665777304", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query34_1665777304?location=europe-west1", "statistics": { "creationTime": "1665777304885", "endTime": "1665777305596", "finalExecutionDurationMs": "515", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "534" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03305785123966942, "computeRatioMax": 0.03305785123966942, "endMs": "1665777305075", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.012396694214876033, "readRatioMax": 0.012396694214876033, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777305038", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.004132231404958678, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06611570247933884, "writeRatioMax": 0.06611570247933884 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.049586776859504134, "computeRatioMax": 0.049586776859504134, "endMs": "1665777305081", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0371900826446281, "readRatioMax": 0.0371900826446281, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777305050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.004132231404958678, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.045454545454545456, "writeRatioMax": 0.045454545454545456 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.045454545454545456, "computeRatioMax": 0.045454545454545456, "endMs": "1665777305086", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04132231404958678, "readRatioMax": 0.04132231404958678, "recordsRead": "73049", "recordsWritten": "252", "shuffleOutputBytes": "2268", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777305063", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.004132231404958678, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.024793388429752067, "writeRatioMax": 0.024793388429752067 }, { "completedParallelInputs": "6", "computeMsAvg": "169", "computeMsMax": "242", "computeRatioAvg": 0.6983471074380165, "computeRatioMax": 1, "endMs": "1665777305303", "id": "4", "inputStages": [ "0", "1", "2" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "33", "readRatioAvg": 0.0743801652892562, "readRatioMax": 0.13636363636363635, "recordsRead": "2888228", "recordsWritten": "24680", "shuffleOutputBytes": "663896", "shuffleOutputBytesSpilled": "0", "slotMs": "1089", "startMs": "1665777305094", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.004132231404958678, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.024793388429752067, "writeRatioMax": 0.0371900826446281 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.0743801652892562, "computeRatioMax": 0.0743801652892562, "endMs": "1665777305384", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24680", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777305348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 15, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.004132231404958678, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04132231404958678, "writeRatioMax": 0.04132231404958678 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.0371900826446281, "computeRatioMax": 0.06611570247933884, "endMs": "1665777305445", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "2419", "startMs": "1665777305394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.012396694214876033, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.06198347107438017, "writeRatioMax": 0.08264462809917356 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.15289256198347106, "computeRatioMax": 0.15289256198347106, "endMs": "1665777305480", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.05371900826446281, "readRatioMax": 0.05371900826446281, "recordsRead": "100451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777305398", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.012396694214876033, "waitRatioMax": 0.012396694214876033, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01652892561983471, "writeRatioMax": 0.01652892561983471 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0371900826446281, "computeRatioMax": 0.0371900826446281, "endMs": "1665777305525", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777305492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$124 ASC, $123 ASC, $122 ASC, $125 DESC, $120 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.004132231404958678, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05371900826446281, "writeRatioMax": 0.05371900826446281 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3680" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "3680", "transferredBytes": "0" }, "startTime": "1665777304938", "totalBytesProcessed": "116189683", "totalSlotMs": "3680" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbe8b63a4_5a21_4437_bedb_f96372f591be" }, "priority": "INTERACTIVE", "query": "-- start query 34 in stream 0 using template query34.tpl\nselect c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag\n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and (case when household_demographics.hd_vehicle_count > 0 \n\tthen (household_demographics.hd_dep_count*1.000)/ household_demographics.hd_vehicle_count \n\telse null \n\tend) > 1.2\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County','Williamson County','Williamson County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dn,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 15 and 20\n order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\n\n-- end query 34 in stream 0 using template query34.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2ia9tq8xxIGmAEHRv3dudA==", "id": "test-project-364309:europe-west1.query34_1665777306", "jobReference": { "jobId": "query34_1665777306", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query34_1665777306?location=europe-west1", "statistics": { "creationTime": "1665777307207", "endTime": "1665777307877", "finalExecutionDurationMs": "452", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "532" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.055248618784530384, "computeRatioMax": 0.055248618784530384, "endMs": "1665777307400", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.022099447513812154, "readRatioMax": 0.022099447513812154, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777307361", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.08287292817679558, "writeRatioMax": 0.08287292817679558 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.049723756906077346, "computeRatioMax": 0.049723756906077346, "endMs": "1665777307417", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.027624309392265192, "readRatioMax": 0.027624309392265192, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777307374", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.09944751381215469, "writeRatioMax": 0.09944751381215469 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.08287292817679558, "computeRatioMax": 0.08287292817679558, "endMs": "1665777307430", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04419889502762431, "readRatioMax": 0.04419889502762431, "recordsRead": "73049", "recordsWritten": "252", "shuffleOutputBytes": "2268", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777307390", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.06077348066298342, "writeRatioMax": 0.06077348066298342 }, { "completedParallelInputs": "6", "computeMsAvg": "124", "computeMsMax": "181", "computeRatioAvg": 0.6850828729281768, "computeRatioMax": 1, "endMs": "1665777307572", "id": "4", "inputStages": [ "1", "0", "2" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "19", "readRatioAvg": 0.0718232044198895, "readRatioMax": 0.10497237569060773, "recordsRead": "2888228", "recordsWritten": "24680", "shuffleOutputBytes": "663896", "shuffleOutputBytesSpilled": "0", "slotMs": "768", "startMs": "1665777307440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.011049723756906077, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.027624309392265192, "writeRatioMax": 0.027624309392265192 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.09392265193370165, "computeRatioMax": 0.09392265193370165, "endMs": "1665777307640", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24680", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777307603", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 15, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.06077348066298342, "writeRatioMax": 0.06077348066298342 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.04419889502762431, "computeRatioMax": 0.08287292817679558, "endMs": "1665777307699", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "4031", "startMs": "1665777307647", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "6", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.03314917127071823, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.07734806629834254, "writeRatioMax": 0.13259668508287292 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.14917127071823205, "computeRatioMax": 0.14917127071823205, "endMs": "1665777307723", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03867403314917127, "readRatioMax": 0.03867403314917127, "recordsRead": "100451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777307653", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.027624309392265192, "waitRatioMax": 0.027624309392265192, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.016574585635359115, "writeRatioMax": 0.016574585635359115 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03867403314917127, "computeRatioMax": 0.03867403314917127, "endMs": "1665777307779", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665777307745", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$124 ASC, $123 ASC, $122 ASC, $125 DESC, $120 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07734806629834254, "writeRatioMax": 0.07734806629834254 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "542", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5002" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "5002", "transferredBytes": "0" }, "startTime": "1665777307271", "totalBytesProcessed": "116189683", "totalSlotMs": "5002" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6188846a_df1b_4b4d_a23b_11348dc25842" }, "priority": "INTERACTIVE", "query": "-- start query 34 in stream 0 using template query34.tpl\nselect c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag\n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and (case when household_demographics.hd_vehicle_count > 0 \n\tthen (household_demographics.hd_dep_count*1.000)/ household_demographics.hd_vehicle_count \n\telse null \n\tend) > 1.2\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County','Williamson County','Williamson County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dn,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 15 and 20\n order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;\n\n-- end query 34 in stream 0 using template query34.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "M4Bqi4m89jqKGTTWF5VmBQ==", "id": "test-project-364309:europe-west1.query34_1665777308", "jobReference": { "jobId": "query34_1665777308", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query34_1665777308?location=europe-west1", "statistics": { "creationTime": "1665777309450", "endTime": "1665777310160", "finalExecutionDurationMs": "504", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "524" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05027932960893855, "computeRatioMax": 0.05027932960893855, "endMs": "1665777309652", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0223463687150838, "readRatioMax": 0.0223463687150838, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777309620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.10614525139664804, "writeRatioMax": 0.10614525139664804 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03910614525139665, "computeRatioMax": 0.03910614525139665, "endMs": "1665777309683", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0223463687150838, "readRatioMax": 0.0223463687150838, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777309640", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0111731843575419, "waitRatioMax": 0.0111731843575419, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.1005586592178771, "writeRatioMax": 0.1005586592178771 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.061452513966480445, "computeRatioMax": 0.061452513966480445, "endMs": "1665777309710", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0446927374301676, "readRatioMax": 0.0446927374301676, "recordsRead": "73049", "recordsWritten": "252", "shuffleOutputBytes": "2268", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777309655", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0111731843575419, "waitRatioMax": 0.0111731843575419, "writeMsAvg": "36", "writeMsMax": "36", "writeRatioAvg": 0.2011173184357542, "writeRatioMax": 0.2011173184357542 }, { "completedParallelInputs": "6", "computeMsAvg": "155", "computeMsMax": "179", "computeRatioAvg": 0.8659217877094972, "computeRatioMax": 1, "endMs": "1665777309849", "id": "4", "inputStages": [ "0", "1", "2" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "15", "readRatioAvg": 0.07262569832402235, "readRatioMax": 0.08379888268156424, "recordsRead": "2888228", "recordsWritten": "24680", "shuffleOutputBytes": "663896", "shuffleOutputBytesSpilled": "0", "slotMs": "924", "startMs": "1665777309726", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.0111731843575419, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.027932960893854747, "writeRatioMax": 0.027932960893854747 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.10614525139664804, "computeRatioMax": 0.10614525139664804, "endMs": "1665777309929", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24680", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777309892", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 15, 20)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0111731843575419, "waitRatioMax": 0.0111731843575419, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.055865921787709494, "writeRatioMax": 0.055865921787709494 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.0446927374301676, "computeRatioMax": 0.0782122905027933, "endMs": "1665777310005", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "12177", "shuffleOutputBytesSpilled": "0", "slotMs": "3905", "startMs": "1665777309944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.01675977653631285, "waitRatioMax": 0.027932960893854747, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.08379888268156424, "writeRatioMax": 0.16201117318435754 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.20670391061452514, "computeRatioMax": 0.20670391061452514, "endMs": "1665777310043", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.07262569832402235, "readRatioMax": 0.07262569832402235, "recordsRead": "100451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777309952", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0223463687150838, "waitRatioMax": 0.0223463687150838, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.027932960893854747, "writeRatioMax": 0.027932960893854747 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.055865921787709494, "computeRatioMax": 0.055865921787709494, "endMs": "1665777310086", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "451", "recordsWritten": "451", "shuffleOutputBytes": "23900", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777310059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$124 ASC, $123 ASC, $122 ASC, $125 DESC, $120 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0111731843575419, "waitRatioMax": 0.0111731843575419, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0670391061452514, "writeRatioMax": 0.0670391061452514 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5084" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "5084", "transferredBytes": "0" }, "startTime": "1665777309498", "totalBytesProcessed": "116189683", "totalSlotMs": "5084" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
