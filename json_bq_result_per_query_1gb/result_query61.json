{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonacc7bca7_6e7b_4ec8_8bc2_e07f4eb2f52b" }, "priority": "INTERACTIVE", "query": "select promotions,total,promotions/total*100\nfrom\n (select sum(ss_ext_sales_price) promotions\n from store_sales\n ,store\n ,promotion\n ,date_dim\n ,customer\n ,customer_address \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_promo_sk = p_promo_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk \n and ca_gmt_offset = -5\n and i_category = 'Jewelery'\n and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\n and s_gmt_offset = -5\n and d_year = 1998\n and d_moy = 11) promotional_sales,\n (select sum(ss_ext_sales_price) total\n from store_sales\n ,store\n ,date_dim\n ,customer\n ,customer_address\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk\n and ca_gmt_offset = -7\n and i_category = 'Jewelery'\n and s_gmt_offset = -7\n and d_year = 1998\n and d_moy = 11) all_sales\norder by promotions, total\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "s0aPbZpLhjPeAPd1tvfEsg==", "id": "test-project-364309:europe-west1.query61_1665768406", "jobReference": { "jobId": "query61_1665768406", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query61_1665768406?location=europe-west1", "statistics": { "creationTime": "1665768406887", "endTime": "1665768407593", "finalExecutionDurationMs": "446", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "159881871", "performanceInsights": { "avgPreviousExecutionMs": "430" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.08695652173913043, "computeRatioMax": 0.08695652173913043, "endMs": "1665768407143", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.05217391304347826, "readRatioMax": 0.05217391304347826, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768407109", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item", "WHERE equal($11, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.17391304347826086, "writeRatioMax": 0.17391304347826086 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.12173913043478261, "computeRatioMax": 0.12173913043478261, "endMs": "1665768407159", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.034782608695652174, "readRatioMax": 0.034782608695652174, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768407124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ca_address_sk, $51:ca_gmt_offset", "FROM customer_address", "WHERE equal($51, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.11304347826086956, "writeRatioMax": 0.11304347826086956 }, { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.48695652173913045, "computeRatioMax": 0.48695652173913045, "endMs": "1665768407193", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06956521739130435, "readRatioMax": 0.06956521739130435, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665768407141", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:c_customer_sk, $41:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.13043478260869565, "writeRatioMax": 0.13043478260869565 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.13043478260869565, "computeRatioMax": 0.13043478260869565, "endMs": "1665768407201", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.06086956521739131, "readRatioMax": 0.06086956521739131, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768407158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_moy", "FROM date_dim", "WHERE and(equal($81, 1998), equal($82, 11))" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.12173913043478261, "writeRatioMax": 0.12173913043478261 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.09565217391304348, "computeRatioMax": 0.09565217391304348, "endMs": "1665768407207", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665768407173", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:s_store_sk, $111:s_gmt_offset", "FROM store", "WHERE equal($111, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1391304347826087, "writeRatioMax": 0.1391304347826087 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.05217391304347826, "computeRatioMax": 0.05217391304347826, "endMs": "1665768407237", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768407205", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_category", "FROM item", "WHERE equal($2, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.17391304347826086, "writeRatioMax": 0.17391304347826086 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.21739130434782608, "computeRatioMax": 0.21739130434782608, "endMs": "1665768407255", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.06086956521739131, "readRatioMax": 0.06086956521739131, "recordsRead": "50000", "recordsWritten": "18246", "shuffleOutputBytes": "164214", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768407219", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.12173913043478261, "writeRatioMax": 0.12173913043478261 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.41739130434782606, "computeRatioMax": 0.41739130434782606, "endMs": "1665768407300", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.26956521739130435, "readRatioMax": 0.26956521739130435, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665768407235", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.06956521739130435, "writeRatioMax": 0.06956521739130435 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.10434782608695652, "computeRatioMax": 0.10434782608695652, "endMs": "1665768407292", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.06086956521739131, "readRatioMax": 0.06086956521739131, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768407251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.12173913043478261, "writeRatioMax": 0.12173913043478261 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0782608695652174, "computeRatioMax": 0.0782608695652174, "endMs": "1665768407313", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.06086956521739131, "readRatioMax": 0.06086956521739131, "recordsRead": "300", "recordsWritten": "158", "shuffleOutputBytes": "1422", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768407276", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:p_promo_sk, $101:p_channel_dmail, $102:p_channel_email, $103:p_channel_tv", "FROM promotion", "WHERE or(equal($101, 'Y'), equal($102, 'Y'), equal($103, 'Y'))" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.017391304347826087, "waitRatioMax": 0.017391304347826087, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.1826086956521739, "writeRatioMax": 0.1826086956521739 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.13043478260869565, "computeRatioMax": 0.13043478260869565, "endMs": "1665768407336", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768407295", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:s_store_sk, $121:s_gmt_offset", "FROM store", "WHERE equal($121, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.13043478260869565, "writeRatioMax": 0.13043478260869565 }, { "completedParallelInputs": "6", "computeMsAvg": "14", "computeMsMax": "17", "computeRatioAvg": 0.12173913043478261, "computeRatioMax": 0.14782608695652175, "endMs": "1665768407350", "id": "13", "inputStages": [ "3", "1", "0", "2", "4" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "20", "readRatioAvg": 0.1565217391304348, "readRatioMax": 0.17391304347826086, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "183", "startMs": "1665768407313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_customer_sk, $73:ss_store_sk, $74:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$170 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311", "INNER HASH JOIN EACH WITH ALL ON $310 = $10" ] }, { "kind": "JOIN", "substeps": [ "$310 := $300, $311 := $301", "INNER HASH JOIN EACH WITH ALL ON $302 = $50" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $292, $302 := $41", "INNER HASH JOIN EACH WITH ALL ON $291 = $40" ] }, { "kind": "JOIN", "substeps": [ "$290 := $271, $291 := $272, $292 := $273", "INNER HASH JOIN EACH WITH ALL ON $270 = $80" ] }, { "kind": "JOIN", "substeps": [ "$270 := $70, $271 := $71, $272 := $72, $273 := $74", "INNER HASH JOIN EACH WITH ALL ON $73 = $110" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage0D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.008695652173913044, "writeRatioMax": 0.008695652173913044 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.05217391304347826, "computeRatioMax": 0.05217391304347826, "endMs": "1665768407352", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665768407316", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.017391304347826087, "waitRatioMax": 0.017391304347826087, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.008695652173913044, "writeRatioMax": 0.008695652173913044 }, { "completedParallelInputs": "6", "computeMsAvg": "92", "computeMsMax": "115", "computeRatioAvg": 0.8, "computeRatioMax": 1, "endMs": "1665768407457", "id": "15", "inputStages": [ "11", "7", "6", "9", "10", "8" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "25", "readRatioAvg": 0.1826086956521739, "readRatioMax": 0.21739130434782608, "recordsRead": "3591080", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "615", "startMs": "1665768407345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_customer_sk, $93:ss_store_sk, $94:ss_promo_sk, $95:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$160 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $241", "INNER HASH JOIN EACH WITH ALL ON $240 = $1" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $231", "INNER HASH JOIN EACH WITH ALL ON $232 = $30" ] }, { "kind": "JOIN", "substeps": [ "$230 := $220, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $221 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $201, $221 := $202, $222 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $60" ] }, { "kind": "JOIN", "substeps": [ "$200 := $180, $201 := $181, $202 := $182, $203 := $184", "INNER HASH JOIN EACH WITH ALL ON $183 = $100" ] }, { "kind": "JOIN", "substeps": [ "$180 := $90, $181 := $91, $182 := $92, $183 := $94, $184 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $120" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.017391304347826087, "waitRatioMax": 0.02608695652173913, "writeMsAvg": "1", "writeMsMax": "2", "writeRatioAvg": 0.008695652173913044, "writeRatioMax": 0.017391304347826087 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.05217391304347826, "computeRatioMax": 0.05217391304347826, "endMs": "1665768407468", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768407350", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.034782608695652174, "waitRatioMax": 0.034782608695652174, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.008695652173913044, "writeRatioMax": 0.008695652173913044 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.1391304347826087, "computeRatioMax": 0.1391304347826087, "endMs": "1665768407525", "id": "17", "inputStages": [ "14", "16" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "3", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768407488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$330 ASC, $331 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := multiply(divide($330, $331), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $140, $331 := $150", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.2, "writeRatioMax": 0.2 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "26", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1334" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "159881871", "totalPartitionsProcessed": "0", "totalSlotMs": "1334", "transferredBytes": "0" }, "startTime": "1665768406960", "totalBytesProcessed": "159881871", "totalSlotMs": "1334" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncf2da910_12fa_4ab4_8fc2_74af46710001" }, "priority": "INTERACTIVE", "query": "select promotions,total,promotions/total*100\nfrom\n (select sum(ss_ext_sales_price) promotions\n from store_sales\n ,store\n ,promotion\n ,date_dim\n ,customer\n ,customer_address \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_promo_sk = p_promo_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk \n and ca_gmt_offset = -5\n and i_category = 'Jewelery'\n and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\n and s_gmt_offset = -5\n and d_year = 1998\n and d_moy = 11) promotional_sales,\n (select sum(ss_ext_sales_price) total\n from store_sales\n ,store\n ,date_dim\n ,customer\n ,customer_address\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk\n and ca_gmt_offset = -7\n and i_category = 'Jewelery'\n and s_gmt_offset = -7\n and d_year = 1998\n and d_moy = 11) all_sales\norder by promotions, total\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "0hwOR/rn89qAx2dn+i/cQw==", "id": "test-project-364309:europe-west1.query61_1665777880", "jobReference": { "jobId": "query61_1665777880", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query61_1665777880?location=europe-west1", "statistics": { "creationTime": "1665777880561", "endTime": "1665777881292", "finalExecutionDurationMs": "427", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "159881871", "performanceInsights": { "avgPreviousExecutionMs": "432" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06293706293706294, "computeRatioMax": 0.06293706293706294, "endMs": "1665777880819", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.055944055944055944, "readRatioMax": 0.055944055944055944, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777880785", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item", "WHERE equal($11, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.055944055944055944, "writeRatioMax": 0.055944055944055944 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08391608391608392, "computeRatioMax": 0.08391608391608392, "endMs": "1665777880826", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04195804195804196, "readRatioMax": 0.04195804195804196, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777880797", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ca_address_sk, $51:ca_gmt_offset", "FROM customer_address", "WHERE equal($51, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1048951048951049, "writeRatioMax": 0.1048951048951049 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.2727272727272727, "computeRatioMax": 0.2727272727272727, "endMs": "1665777880848", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03496503496503497, "readRatioMax": 0.03496503496503497, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777880809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:c_customer_sk, $41:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06293706293706294, "writeRatioMax": 0.06293706293706294 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06993006993006994, "computeRatioMax": 0.06993006993006994, "endMs": "1665777880856", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04895104895104895, "readRatioMax": 0.04895104895104895, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777880823", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_moy", "FROM date_dim", "WHERE and(equal($81, 1998), equal($82, 11))" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.04895104895104895, "writeRatioMax": 0.04895104895104895 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.04195804195804196, "computeRatioMax": 0.04195804195804196, "endMs": "1665777880859", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665777880838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:s_store_sk, $111:s_gmt_offset", "FROM store", "WHERE equal($111, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.11888111888111888, "writeRatioMax": 0.11888111888111888 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06293706293706294, "computeRatioMax": 0.06293706293706294, "endMs": "1665777880892", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04195804195804196, "readRatioMax": 0.04195804195804196, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777880862", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_category", "FROM item", "WHERE equal($2, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1048951048951049, "writeRatioMax": 0.1048951048951049 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.16083916083916083, "computeRatioMax": 0.16083916083916083, "endMs": "1665777880921", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.06293706293706294, "readRatioMax": 0.06293706293706294, "recordsRead": "50000", "recordsWritten": "18246", "shuffleOutputBytes": "164214", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777880875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.06993006993006994, "writeRatioMax": 0.06993006993006994 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.35664335664335667, "computeRatioMax": 0.35664335664335667, "endMs": "1665777880937", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.06293706293706294, "readRatioMax": 0.06293706293706294, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665777880886", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0979020979020979, "writeRatioMax": 0.0979020979020979 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.07692307692307693, "endMs": "1665777880943", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04195804195804196, "readRatioMax": 0.04195804195804196, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777880908", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.09090909090909091, "writeRatioMax": 0.09090909090909091 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.055944055944055944, "computeRatioMax": 0.055944055944055944, "endMs": "1665777880953", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03496503496503497, "readRatioMax": 0.03496503496503497, "recordsRead": "300", "recordsWritten": "158", "shuffleOutputBytes": "1422", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777880922", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:p_promo_sk, $101:p_channel_dmail, $102:p_channel_email, $103:p_channel_tv", "FROM promotion", "WHERE or(equal($101, 'Y'), equal($102, 'Y'), equal($103, 'Y'))" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage0A_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.1258741258741259, "writeRatioMax": 0.1258741258741259 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06293706293706294, "computeRatioMax": 0.06293706293706294, "endMs": "1665777880978", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.027972027972027972, "readRatioMax": 0.027972027972027972, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777880936", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:s_store_sk, $121:s_gmt_offset", "FROM store", "WHERE equal($121, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.11188811188811189, "writeRatioMax": 0.11188811188811189 }, { "completedParallelInputs": "6", "computeMsAvg": "15", "computeMsMax": "19", "computeRatioAvg": 0.1048951048951049, "computeRatioMax": 0.13286713286713286, "endMs": "1665777880998", "id": "13", "inputStages": [ "4", "2", "0", "3", "1" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "27", "readRatioAvg": 0.13286713286713286, "readRatioMax": 0.1888111888111888, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "212", "startMs": "1665777880951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_customer_sk, $73:ss_store_sk, $74:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$170 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311", "INNER HASH JOIN EACH WITH ALL ON $310 = $10" ] }, { "kind": "JOIN", "substeps": [ "$310 := $300, $311 := $301", "INNER HASH JOIN EACH WITH ALL ON $302 = $50" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $292, $302 := $41", "INNER HASH JOIN EACH WITH ALL ON $291 = $40" ] }, { "kind": "JOIN", "substeps": [ "$290 := $271, $291 := $272, $292 := $273", "INNER HASH JOIN EACH WITH ALL ON $270 = $80" ] }, { "kind": "JOIN", "substeps": [ "$270 := $70, $271 := $71, $272 := $72, $273 := $74", "INNER HASH JOIN EACH WITH ALL ON $73 = $110" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.013986013986013986, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.006993006993006993 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.04195804195804196, "computeRatioMax": 0.04195804195804196, "endMs": "1665777881009", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665777880953", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013986013986013986, "waitRatioMax": 0.013986013986013986, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.006993006993006993 }, { "completedParallelInputs": "6", "computeMsAvg": "105", "computeMsMax": "143", "computeRatioAvg": 0.7342657342657343, "computeRatioMax": 1, "endMs": "1665777881105", "id": "15", "inputStages": [ "6", "9", "11", "7", "10", "8" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "24", "readRatioAvg": 0.13986013986013987, "readRatioMax": 0.16783216783216784, "recordsRead": "3591080", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "673", "startMs": "1665777880987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_customer_sk, $93:ss_store_sk, $94:ss_promo_sk, $95:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$160 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $241", "INNER HASH JOIN EACH WITH ALL ON $240 = $1" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $231", "INNER HASH JOIN EACH WITH ALL ON $232 = $30" ] }, { "kind": "JOIN", "substeps": [ "$230 := $220, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $221 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $201, $221 := $202, $222 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $60" ] }, { "kind": "JOIN", "substeps": [ "$200 := $180, $201 := $181, $202 := $182, $203 := $184", "INNER HASH JOIN EACH WITH ALL ON $183 = $100" ] }, { "kind": "JOIN", "substeps": [ "$180 := $90, $181 := $91, $182 := $92, $183 := $94, $184 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $120" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.006993006993006993 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.055944055944055944, "computeRatioMax": 0.055944055944055944, "endMs": "1665777881108", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665777880990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.02097902097902098, "waitRatioMax": 0.02097902097902098, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.006993006993006993 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06993006993006994, "computeRatioMax": 0.06993006993006994, "endMs": "1665777881182", "id": "17", "inputStages": [ "14", "16" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "3", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777881150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$330 ASC, $331 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := multiply(divide($330, $331), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $140, $331 := $150", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07692307692307693, "writeRatioMax": 0.07692307692307693 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "26", "elapsedMs": "574", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1396" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "159881871", "totalPartitionsProcessed": "0", "totalSlotMs": "1396", "transferredBytes": "0" }, "startTime": "1665777880643", "totalBytesProcessed": "159881871", "totalSlotMs": "1396" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonacfeba6a_de84_4760_904f_d06d9d1a6d11" }, "priority": "INTERACTIVE", "query": "select promotions,total,promotions/total*100\nfrom\n (select sum(ss_ext_sales_price) promotions\n from store_sales\n ,store\n ,promotion\n ,date_dim\n ,customer\n ,customer_address \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_promo_sk = p_promo_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk \n and ca_gmt_offset = -5\n and i_category = 'Jewelery'\n and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\n and s_gmt_offset = -5\n and d_year = 1998\n and d_moy = 11) promotional_sales,\n (select sum(ss_ext_sales_price) total\n from store_sales\n ,store\n ,date_dim\n ,customer\n ,customer_address\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk\n and ca_gmt_offset = -7\n and i_category = 'Jewelery'\n and s_gmt_offset = -7\n and d_year = 1998\n and d_moy = 11) all_sales\norder by promotions, total\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "uSOlfsNiZjoiPv5asssOSw==", "id": "test-project-364309:europe-west1.query61_1665777882", "jobReference": { "jobId": "query61_1665777882", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query61_1665777882?location=europe-west1", "statistics": { "creationTime": "1665777882966", "endTime": "1665777883676", "finalExecutionDurationMs": "419", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "159881871", "performanceInsights": { "avgPreviousExecutionMs": "431" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.035211267605633804, "computeRatioMax": 0.035211267605633804, "endMs": "1665777883205", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.028169014084507043, "readRatioMax": 0.028169014084507043, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777883178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item", "WHERE equal($11, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.11971830985915492, "writeRatioMax": 0.11971830985915492 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.09859154929577464, "computeRatioMax": 0.09859154929577464, "endMs": "1665777883233", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04929577464788732, "readRatioMax": 0.04929577464788732, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777883192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ca_address_sk, $51:ca_gmt_offset", "FROM customer_address", "WHERE equal($51, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.08450704225352113, "writeRatioMax": 0.08450704225352113 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.44366197183098594, "computeRatioMax": 0.44366197183098594, "endMs": "1665777883253", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04225352112676056, "readRatioMax": 0.04225352112676056, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777883204", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:c_customer_sk, $41:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.07042253521126761, "writeRatioMax": 0.07042253521126761 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.04225352112676056, "computeRatioMax": 0.04225352112676056, "endMs": "1665777883249", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04225352112676056, "readRatioMax": 0.04225352112676056, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777883219", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_moy", "FROM date_dim", "WHERE and(equal($81, 1998), equal($82, 11))" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04225352112676056, "writeRatioMax": 0.04225352112676056 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.04225352112676056, "computeRatioMax": 0.04225352112676056, "endMs": "1665777883262", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777883231", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:s_store_sk, $111:s_gmt_offset", "FROM store", "WHERE equal($111, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1056338028169014, "writeRatioMax": 0.1056338028169014 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06338028169014084, "computeRatioMax": 0.06338028169014084, "endMs": "1665777883293", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04225352112676056, "readRatioMax": 0.04225352112676056, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777883261", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_category", "FROM item", "WHERE equal($2, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.14084507042253522, "writeRatioMax": 0.14084507042253522 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.13380281690140844, "computeRatioMax": 0.13380281690140844, "endMs": "1665777883306", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04929577464788732, "readRatioMax": 0.04929577464788732, "recordsRead": "50000", "recordsWritten": "18246", "shuffleOutputBytes": "164214", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777883273", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.09859154929577464, "writeRatioMax": 0.09859154929577464 }, { "completedParallelInputs": "1", "computeMsAvg": "76", "computeMsMax": "76", "computeRatioAvg": 0.5352112676056338, "computeRatioMax": 0.5352112676056338, "endMs": "1665777883343", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04929577464788732, "readRatioMax": 0.04929577464788732, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777883285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014084507042253521, "waitRatioMax": 0.014084507042253521, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.08450704225352113, "writeRatioMax": 0.08450704225352113 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07746478873239436, "computeRatioMax": 0.07746478873239436, "endMs": "1665777883333", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04929577464788732, "readRatioMax": 0.04929577464788732, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777883298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.04929577464788732, "writeRatioMax": 0.04929577464788732 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06338028169014084, "computeRatioMax": 0.06338028169014084, "endMs": "1665777883348", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04929577464788732, "readRatioMax": 0.04929577464788732, "recordsRead": "300", "recordsWritten": "158", "shuffleOutputBytes": "1422", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777883314", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:p_promo_sk, $101:p_channel_dmail, $102:p_channel_email, $103:p_channel_tv", "FROM promotion", "WHERE or(equal($101, 'Y'), equal($102, 'Y'), equal($103, 'Y'))" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.14084507042253522, "writeRatioMax": 0.14084507042253522 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07746478873239436, "computeRatioMax": 0.07746478873239436, "endMs": "1665777883360", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.035211267605633804, "readRatioMax": 0.035211267605633804, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777883328", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:s_store_sk, $121:s_gmt_offset", "FROM store", "WHERE equal($121, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.14084507042253522, "writeRatioMax": 0.14084507042253522 }, { "completedParallelInputs": "6", "computeMsAvg": "16", "computeMsMax": "19", "computeRatioAvg": 0.11267605633802817, "computeRatioMax": 0.13380281690140844, "endMs": "1665777883390", "id": "13", "inputStages": [ "0", "3", "4", "2", "1" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "25", "readRatioAvg": 0.13380281690140844, "readRatioMax": 0.176056338028169, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "204", "startMs": "1665777883346", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_customer_sk, $73:ss_store_sk, $74:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$170 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311", "INNER HASH JOIN EACH WITH ALL ON $310 = $10" ] }, { "kind": "JOIN", "substeps": [ "$310 := $300, $311 := $301", "INNER HASH JOIN EACH WITH ALL ON $302 = $50" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $292, $302 := $41", "INNER HASH JOIN EACH WITH ALL ON $291 = $40" ] }, { "kind": "JOIN", "substeps": [ "$290 := $271, $291 := $272, $292 := $273", "INNER HASH JOIN EACH WITH ALL ON $270 = $80" ] }, { "kind": "JOIN", "substeps": [ "$270 := $70, $271 := $71, $272 := $72, $273 := $74", "INNER HASH JOIN EACH WITH ALL ON $73 = $110" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014084507042253521, "waitRatioMax": 0.014084507042253521, "writeMsAvg": "1", "writeMsMax": "2", "writeRatioAvg": 0.007042253521126761, "writeRatioMax": 0.014084507042253521 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.028169014084507043, "endMs": "1665777883402", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665777883349", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014084507042253521, "waitRatioMax": 0.014084507042253521, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "6", "computeMsAvg": "101", "computeMsMax": "142", "computeRatioAvg": 0.7112676056338029, "computeRatioMax": 1, "endMs": "1665777883490", "id": "15", "inputStages": [ "11", "9", "7", "10", "8", "6" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "31", "readRatioAvg": 0.16901408450704225, "readRatioMax": 0.21830985915492956, "recordsRead": "3591080", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "680", "startMs": "1665777883373", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_customer_sk, $93:ss_store_sk, $94:ss_promo_sk, $95:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$160 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $241", "INNER HASH JOIN EACH WITH ALL ON $240 = $1" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $231", "INNER HASH JOIN EACH WITH ALL ON $232 = $30" ] }, { "kind": "JOIN", "substeps": [ "$230 := $220, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $221 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $201, $221 := $202, $222 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $60" ] }, { "kind": "JOIN", "substeps": [ "$200 := $180, $201 := $181, $202 := $182, $203 := $184", "INNER HASH JOIN EACH WITH ALL ON $183 = $100" ] }, { "kind": "JOIN", "substeps": [ "$180 := $90, $181 := $91, $182 := $92, $183 := $94, $184 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $120" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.007042253521126761, "writeRatioMax": 0.007042253521126761 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08450704225352113, "computeRatioMax": 0.08450704225352113, "endMs": "1665777883494", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665777883376", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.02112676056338028, "waitRatioMax": 0.02112676056338028, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.007042253521126761, "writeRatioMax": 0.007042253521126761 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.14084507042253522, "computeRatioMax": 0.14084507042253522, "endMs": "1665777883565", "id": "17", "inputStages": [ "16", "14" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "3", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777883523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$330 ASC, $331 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := multiply(divide($330, $331), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $140, $331 := $150", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07746478873239436, "writeRatioMax": 0.07746478873239436 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "26", "elapsedMs": "565", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1483" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "159881871", "totalPartitionsProcessed": "0", "totalSlotMs": "1483", "transferredBytes": "0" }, "startTime": "1665777883036", "totalBytesProcessed": "159881871", "totalSlotMs": "1483" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8560cdb9_1c0f_49b3_9cad_50c6173131ae" }, "priority": "INTERACTIVE", "query": "select promotions,total,promotions/total*100\nfrom\n (select sum(ss_ext_sales_price) promotions\n from store_sales\n ,store\n ,promotion\n ,date_dim\n ,customer\n ,customer_address \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_promo_sk = p_promo_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk \n and ca_gmt_offset = -5\n and i_category = 'Jewelery'\n and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\n and s_gmt_offset = -5\n and d_year = 1998\n and d_moy = 11) promotional_sales,\n (select sum(ss_ext_sales_price) total\n from store_sales\n ,store\n ,date_dim\n ,customer\n ,customer_address\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk\n and ca_gmt_offset = -7\n and i_category = 'Jewelery'\n and s_gmt_offset = -7\n and d_year = 1998\n and d_moy = 11) all_sales\norder by promotions, total\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/SlLp/E1gJ5QzsDNmv3tPg==", "id": "test-project-364309:europe-west1.query61_1665777884", "jobReference": { "jobId": "query61_1665777884", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query61_1665777884?location=europe-west1", "statistics": { "creationTime": "1665777885391", "endTime": "1665777886081", "finalExecutionDurationMs": "416", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "159881871", "performanceInsights": { "avgPreviousExecutionMs": "430" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0782608695652174, "computeRatioMax": 0.0782608695652174, "endMs": "1665777885633", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777885594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item", "WHERE equal($11, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.11304347826086956, "writeRatioMax": 0.11304347826086956 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.10434782608695652, "computeRatioMax": 0.10434782608695652, "endMs": "1665777885660", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06956521739130435, "readRatioMax": 0.06956521739130435, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777885611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ca_address_sk, $51:ca_gmt_offset", "FROM customer_address", "WHERE equal($51, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.24347826086956523, "writeRatioMax": 0.24347826086956523 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.45217391304347826, "computeRatioMax": 0.45217391304347826, "endMs": "1665777885681", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06956521739130435, "readRatioMax": 0.06956521739130435, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777885626", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:c_customer_sk, $41:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.13043478260869565, "writeRatioMax": 0.13043478260869565 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.10434782608695652, "computeRatioMax": 0.10434782608695652, "endMs": "1665777885686", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06956521739130435, "readRatioMax": 0.06956521739130435, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777885651", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_moy", "FROM date_dim", "WHERE and(equal($81, 1998), equal($82, 11))" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.09565217391304348, "waitRatioMax": 0.09565217391304348, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.06956521739130435, "writeRatioMax": 0.06956521739130435 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.13043478260869565, "computeRatioMax": 0.13043478260869565, "endMs": "1665777885699", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777885654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:s_store_sk, $111:s_gmt_offset", "FROM store", "WHERE equal($111, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.20869565217391303, "writeRatioMax": 0.20869565217391303 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0782608695652174, "computeRatioMax": 0.0782608695652174, "endMs": "1665777885714", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777885684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_category", "FROM item", "WHERE equal($2, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.17391304347826086, "writeRatioMax": 0.17391304347826086 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.12173913043478261, "computeRatioMax": 0.12173913043478261, "endMs": "1665777885735", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "50000", "recordsWritten": "18246", "shuffleOutputBytes": "164214", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777885696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.12173913043478261, "writeRatioMax": 0.12173913043478261 }, { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.4, "computeRatioMax": 0.4, "endMs": "1665777885756", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06956521739130435, "readRatioMax": 0.06956521739130435, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665777885708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.09565217391304348, "writeRatioMax": 0.09565217391304348 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.06956521739130435, "computeRatioMax": 0.06956521739130435, "endMs": "1665777885763", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.05217391304347826, "readRatioMax": 0.05217391304347826, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777885725", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.10434782608695652, "writeRatioMax": 0.10434782608695652 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0782608695652174, "computeRatioMax": 0.0782608695652174, "endMs": "1665777885773", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "300", "recordsWritten": "158", "shuffleOutputBytes": "1422", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777885740", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:p_promo_sk, $101:p_channel_dmail, $102:p_channel_email, $103:p_channel_tv", "FROM promotion", "WHERE or(equal($101, 'Y'), equal($102, 'Y'), equal($103, 'Y'))" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.1826086956521739, "writeRatioMax": 0.1826086956521739 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06086956521739131, "computeRatioMax": 0.06086956521739131, "endMs": "1665777885794", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777885755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:s_store_sk, $121:s_gmt_offset", "FROM store", "WHERE equal($121, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1391304347826087, "writeRatioMax": 0.1391304347826087 }, { "completedParallelInputs": "6", "computeMsAvg": "15", "computeMsMax": "21", "computeRatioAvg": 0.13043478260869565, "computeRatioMax": 0.1826086956521739, "endMs": "1665777885817", "id": "13", "inputStages": [ "2", "1", "0", "4", "3" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "28", "readRatioAvg": 0.1565217391304348, "readRatioMax": 0.24347826086956523, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "204", "startMs": "1665777885771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_customer_sk, $73:ss_store_sk, $74:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$170 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311", "INNER HASH JOIN EACH WITH ALL ON $310 = $10" ] }, { "kind": "JOIN", "substeps": [ "$310 := $300, $311 := $301", "INNER HASH JOIN EACH WITH ALL ON $302 = $50" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $292, $302 := $41", "INNER HASH JOIN EACH WITH ALL ON $291 = $40" ] }, { "kind": "JOIN", "substeps": [ "$290 := $271, $291 := $272, $292 := $273", "INNER HASH JOIN EACH WITH ALL ON $270 = $80" ] }, { "kind": "JOIN", "substeps": [ "$270 := $70, $271 := $71, $272 := $72, $273 := $74", "INNER HASH JOIN EACH WITH ALL ON $73 = $110" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.017391304347826087, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.008695652173913044, "writeRatioMax": 0.008695652173913044 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.05217391304347826, "computeRatioMax": 0.05217391304347826, "endMs": "1665777885826", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665777885775", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0E_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.034782608695652174, "waitRatioMax": 0.034782608695652174, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.008695652173913044, "writeRatioMax": 0.008695652173913044 }, { "completedParallelInputs": "6", "computeMsAvg": "90", "computeMsMax": "115", "computeRatioAvg": 0.782608695652174, "computeRatioMax": 1, "endMs": "1665777885909", "id": "15", "inputStages": [ "9", "8", "11", "10", "6", "7" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "22", "readRatioAvg": 0.1565217391304348, "readRatioMax": 0.19130434782608696, "recordsRead": "3591080", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "600", "startMs": "1665777885805", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_customer_sk, $93:ss_store_sk, $94:ss_promo_sk, $95:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$160 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $241", "INNER HASH JOIN EACH WITH ALL ON $240 = $1" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $231", "INNER HASH JOIN EACH WITH ALL ON $232 = $30" ] }, { "kind": "JOIN", "substeps": [ "$230 := $220, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $221 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $201, $221 := $202, $222 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $60" ] }, { "kind": "JOIN", "substeps": [ "$200 := $180, $201 := $181, $202 := $182, $203 := $184", "INNER HASH JOIN EACH WITH ALL ON $183 = $100" ] }, { "kind": "JOIN", "substeps": [ "$180 := $90, $181 := $91, $182 := $92, $183 := $94, $184 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $120" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.017391304347826087, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.008695652173913044, "writeRatioMax": 0.008695652173913044 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06086956521739131, "computeRatioMax": 0.06086956521739131, "endMs": "1665777885917", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777885809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.034782608695652174, "waitRatioMax": 0.034782608695652174, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.008695652173913044, "writeRatioMax": 0.008695652173913044 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.11304347826086956, "computeRatioMax": 0.11304347826086956, "endMs": "1665777885978", "id": "17", "inputStages": [ "16", "14" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "3", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777885941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$330 ASC, $331 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := multiply(divide($330, $331), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $140, $331 := $150", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.008695652173913044, "waitRatioMax": 0.008695652173913044, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.20869565217391303, "writeRatioMax": 0.20869565217391303 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "26", "elapsedMs": "563", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1497" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "159881871", "totalPartitionsProcessed": "0", "totalSlotMs": "1497", "transferredBytes": "0" }, "startTime": "1665777885448", "totalBytesProcessed": "159881871", "totalSlotMs": "1497" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon27d95a08_faca_440c_859a_adea694f4bef" }, "priority": "INTERACTIVE", "query": "select promotions,total,promotions/total*100\nfrom\n (select sum(ss_ext_sales_price) promotions\n from store_sales\n ,store\n ,promotion\n ,date_dim\n ,customer\n ,customer_address \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_promo_sk = p_promo_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk \n and ca_gmt_offset = -5\n and i_category = 'Jewelery'\n and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\n and s_gmt_offset = -5\n and d_year = 1998\n and d_moy = 11) promotional_sales,\n (select sum(ss_ext_sales_price) total\n from store_sales\n ,store\n ,date_dim\n ,customer\n ,customer_address\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk\n and ca_gmt_offset = -7\n and i_category = 'Jewelery'\n and s_gmt_offset = -7\n and d_year = 1998\n and d_moy = 11) all_sales\norder by promotions, total\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "dYV6fJd/XxXWeGh8f1iwuw==", "id": "test-project-364309:europe-west1.query61_1665777887", "jobReference": { "jobId": "query61_1665777887", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query61_1665777887?location=europe-west1", "statistics": { "creationTime": "1665777887760", "endTime": "1665777888485", "finalExecutionDurationMs": "490", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "159881871", "performanceInsights": { "avgPreviousExecutionMs": "429" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.045112781954887216, "computeRatioMax": 0.045112781954887216, "endMs": "1665777887980", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.045112781954887216, "readRatioMax": 0.045112781954887216, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777887939", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item", "WHERE equal($11, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.11278195488721804, "writeRatioMax": 0.11278195488721804 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.09774436090225563, "computeRatioMax": 0.09774436090225563, "endMs": "1665777887982", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.06766917293233082, "readRatioMax": 0.06766917293233082, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777887953", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ca_address_sk, $51:ca_gmt_offset", "FROM customer_address", "WHERE equal($51, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06766917293233082, "writeRatioMax": 0.06766917293233082 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.43609022556390975, "computeRatioMax": 0.43609022556390975, "endMs": "1665777888012", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.045112781954887216, "readRatioMax": 0.045112781954887216, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777887965", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:c_customer_sk, $41:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.08270676691729323, "writeRatioMax": 0.08270676691729323 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06766917293233082, "computeRatioMax": 0.06766917293233082, "endMs": "1665777888029", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06015037593984962, "readRatioMax": 0.06015037593984962, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777887988", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_moy", "FROM date_dim", "WHERE and(equal($81, 1998), equal($82, 11))" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10526315789473684, "writeRatioMax": 0.10526315789473684 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.06015037593984962, "computeRatioMax": 0.06015037593984962, "endMs": "1665777888037", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777888004", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:s_store_sk, $111:s_gmt_offset", "FROM store", "WHERE equal($111, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.13533834586466165, "writeRatioMax": 0.13533834586466165 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07518796992481203, "computeRatioMax": 0.07518796992481203, "endMs": "1665777888081", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06015037593984962, "readRatioMax": 0.06015037593984962, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777888032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_category", "FROM item", "WHERE equal($2, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.15037593984962405, "writeRatioMax": 0.15037593984962405 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.17293233082706766, "computeRatioMax": 0.17293233082706766, "endMs": "1665777888084", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06015037593984962, "readRatioMax": 0.06015037593984962, "recordsRead": "50000", "recordsWritten": "18246", "shuffleOutputBytes": "164214", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777888048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10526315789473684, "writeRatioMax": 0.10526315789473684 }, { "completedParallelInputs": "1", "computeMsAvg": "49", "computeMsMax": "49", "computeRatioAvg": 0.3684210526315789, "computeRatioMax": 0.3684210526315789, "endMs": "1665777888117", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.09774436090225563, "readRatioMax": 0.09774436090225563, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665777888063", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10526315789473684, "writeRatioMax": 0.10526315789473684 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.08270676691729323, "computeRatioMax": 0.08270676691729323, "endMs": "1665777888120", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06015037593984962, "readRatioMax": 0.06015037593984962, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777888076", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10526315789473684, "writeRatioMax": 0.10526315789473684 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07518796992481203, "computeRatioMax": 0.07518796992481203, "endMs": "1665777888121", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03759398496240601, "readRatioMax": 0.03759398496240601, "recordsRead": "300", "recordsWritten": "158", "shuffleOutputBytes": "1422", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777888091", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:p_promo_sk, $101:p_channel_dmail, $102:p_channel_email, $103:p_channel_tv", "FROM promotion", "WHERE or(equal($101, 'Y'), equal($102, 'Y'), equal($103, 'Y'))" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.12030075187969924, "writeRatioMax": 0.12030075187969924 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06766917293233082, "computeRatioMax": 0.06766917293233082, "endMs": "1665777888134", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.03007518796992481, "readRatioMax": 0.03007518796992481, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777888107", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:s_store_sk, $121:s_gmt_offset", "FROM store", "WHERE equal($121, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.12781954887218044, "writeRatioMax": 0.12781954887218044 }, { "completedParallelInputs": "6", "computeMsAvg": "18", "computeMsMax": "27", "computeRatioAvg": 0.13533834586466165, "computeRatioMax": 0.20300751879699247, "endMs": "1665777888190", "id": "13", "inputStages": [ "1", "4", "2", "3", "0" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "36", "readRatioAvg": 0.16541353383458646, "readRatioMax": 0.2706766917293233, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "241", "startMs": "1665777888121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_customer_sk, $73:ss_store_sk, $74:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$170 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311", "INNER HASH JOIN EACH WITH ALL ON $310 = $10" ] }, { "kind": "JOIN", "substeps": [ "$310 := $300, $311 := $301", "INNER HASH JOIN EACH WITH ALL ON $302 = $50" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $292, $302 := $41", "INNER HASH JOIN EACH WITH ALL ON $291 = $40" ] }, { "kind": "JOIN", "substeps": [ "$290 := $271, $291 := $272, $292 := $273", "INNER HASH JOIN EACH WITH ALL ON $270 = $80" ] }, { "kind": "JOIN", "substeps": [ "$270 := $70, $271 := $71, $272 := $72, $273 := $74", "INNER HASH JOIN EACH WITH ALL ON $73 = $110" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.015037593984962405, "writeMsAvg": "2", "writeMsMax": "11", "writeRatioAvg": 0.015037593984962405, "writeRatioMax": 0.08270676691729323 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07518796992481203, "computeRatioMax": 0.07518796992481203, "endMs": "1665777888185", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777888125", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.022556390977443608, "waitRatioMax": 0.022556390977443608, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.007518796992481203, "writeRatioMax": 0.007518796992481203 }, { "completedParallelInputs": "6", "computeMsAvg": "115", "computeMsMax": "133", "computeRatioAvg": 0.8646616541353384, "computeRatioMax": 1, "endMs": "1665777888286", "id": "15", "inputStages": [ "11", "8", "6", "9", "10", "7" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "25", "readMsMax": "32", "readRatioAvg": 0.18796992481203006, "readRatioMax": 0.24060150375939848, "recordsRead": "3591080", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "788", "startMs": "1665777888139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_customer_sk, $93:ss_store_sk, $94:ss_promo_sk, $95:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$160 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $241", "INNER HASH JOIN EACH WITH ALL ON $240 = $1" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $231", "INNER HASH JOIN EACH WITH ALL ON $232 = $30" ] }, { "kind": "JOIN", "substeps": [ "$230 := $220, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $221 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $201, $221 := $202, $222 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $60" ] }, { "kind": "JOIN", "substeps": [ "$200 := $180, $201 := $181, $202 := $182, $203 := $184", "INNER HASH JOIN EACH WITH ALL ON $183 = $100" ] }, { "kind": "JOIN", "substeps": [ "$180 := $90, $181 := $91, $182 := $92, $183 := $94, $184 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $120" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "1", "writeMsMax": "2", "writeRatioAvg": 0.007518796992481203, "writeRatioMax": 0.015037593984962405 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.045112781954887216, "computeRatioMax": 0.045112781954887216, "endMs": "1665777888295", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777888143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.022556390977443608, "waitRatioMax": 0.022556390977443608, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.007518796992481203, "writeRatioMax": 0.007518796992481203 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.08270676691729323, "computeRatioMax": 0.08270676691729323, "endMs": "1665777888389", "id": "17", "inputStages": [ "16", "14" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "3", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777888353", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$330 ASC, $331 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := multiply(divide($330, $331), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $140, $331 := $150", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.09774436090225563, "writeRatioMax": 0.09774436090225563 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "26", "elapsedMs": "614", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1707" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "159881871", "totalPartitionsProcessed": "0", "totalSlotMs": "1707", "transferredBytes": "0" }, "startTime": "1665777887820", "totalBytesProcessed": "159881871", "totalSlotMs": "1707" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf93afb06_2795_45ce_823d_65ec9de8c794" }, "priority": "INTERACTIVE", "query": "select promotions,total,promotions/total*100\nfrom\n (select sum(ss_ext_sales_price) promotions\n from store_sales\n ,store\n ,promotion\n ,date_dim\n ,customer\n ,customer_address \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_promo_sk = p_promo_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk \n and ca_gmt_offset = -5\n and i_category = 'Jewelery'\n and (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\n and s_gmt_offset = -5\n and d_year = 1998\n and d_moy = 11) promotional_sales,\n (select sum(ss_ext_sales_price) total\n from store_sales\n ,store\n ,date_dim\n ,customer\n ,customer_address\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and ss_customer_sk= c_customer_sk\n and ca_address_sk = c_current_addr_sk\n and ss_item_sk = i_item_sk\n and ca_gmt_offset = -7\n and i_category = 'Jewelery'\n and s_gmt_offset = -7\n and d_year = 1998\n and d_moy = 11) all_sales\norder by promotions, total\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "SLSaACC/jU560cOjTZ9DBg==", "id": "test-project-364309:europe-west1.query61_1665777889", "jobReference": { "jobId": "query61_1665777889", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query61_1665777889?location=europe-west1", "statistics": { "creationTime": "1665777890098", "endTime": "1665777890831", "finalExecutionDurationMs": "468", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "159881871", "performanceInsights": { "avgPreviousExecutionMs": "434" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.04827586206896552, "computeRatioMax": 0.04827586206896552, "endMs": "1665777890336", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.07586206896551724, "readRatioMax": 0.07586206896551724, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777890298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item", "WHERE equal($11, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013793103448275862, "waitRatioMax": 0.013793103448275862, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.041379310344827586, "writeRatioMax": 0.041379310344827586 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.15862068965517243, "computeRatioMax": 0.15862068965517243, "endMs": "1665777890348", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.08275862068965517, "readRatioMax": 0.08275862068965517, "recordsRead": "50000", "recordsWritten": "5449", "shuffleOutputBytes": "49041", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777890310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ca_address_sk, $51:ca_gmt_offset", "FROM customer_address", "WHERE equal($51, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.06896551724137931, "writeRatioMax": 0.06896551724137931 }, { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.38620689655172413, "computeRatioMax": 0.38620689655172413, "endMs": "1665777890363", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.034482758620689655, "readRatioMax": 0.034482758620689655, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777890329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:c_customer_sk, $41:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05517241379310345, "writeRatioMax": 0.05517241379310345 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06896551724137931, "computeRatioMax": 0.06896551724137931, "endMs": "1665777890380", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.041379310344827586, "readRatioMax": 0.041379310344827586, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777890343", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year, $82:d_moy", "FROM date_dim", "WHERE and(equal($81, 1998), equal($82, 11))" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07586206896551724, "writeRatioMax": 0.07586206896551724 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06206896551724138, "computeRatioMax": 0.06206896551724138, "endMs": "1665777890393", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777890359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:s_store_sk, $111:s_gmt_offset", "FROM store", "WHERE equal($111, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$110", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013793103448275862, "waitRatioMax": 0.013793103448275862, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1103448275862069, "writeRatioMax": 0.1103448275862069 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06896551724137931, "computeRatioMax": 0.06896551724137931, "endMs": "1665777890422", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05517241379310345, "readRatioMax": 0.05517241379310345, "recordsRead": "18000", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777890385", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_category", "FROM item", "WHERE equal($2, 'Jewelery')" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.041379310344827586, "writeRatioMax": 0.041379310344827586 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.12413793103448276, "computeRatioMax": 0.12413793103448276, "endMs": "1665777890439", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.06896551724137931, "readRatioMax": 0.06896551724137931, "recordsRead": "50000", "recordsWritten": "18246", "shuffleOutputBytes": "164214", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777890404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_gmt_offset", "FROM customer_address", "WHERE equal($31, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05517241379310345, "writeRatioMax": 0.05517241379310345 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.3103448275862069, "computeRatioMax": 0.3103448275862069, "endMs": "1665777890466", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05517241379310345, "readRatioMax": 0.05517241379310345, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777890417", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.09655172413793103, "writeRatioMax": 0.09655172413793103 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.09655172413793103, "computeRatioMax": 0.09655172413793103, "endMs": "1665777890469", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.06206896551724138, "readRatioMax": 0.06206896551724138, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777890431", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 1998), equal($62, 11))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06206896551724138, "writeRatioMax": 0.06206896551724138 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07586206896551724, "computeRatioMax": 0.07586206896551724, "endMs": "1665777890487", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.034482758620689655, "readRatioMax": 0.034482758620689655, "recordsRead": "300", "recordsWritten": "158", "shuffleOutputBytes": "1422", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777890456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:p_promo_sk, $101:p_channel_dmail, $102:p_channel_email, $103:p_channel_tv", "FROM promotion", "WHERE or(equal($101, 'Y'), equal($102, 'Y'), equal($103, 'Y'))" ] }, { "kind": "WRITE", "substeps": [ "$100", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013793103448275862, "waitRatioMax": 0.013793103448275862, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.12413793103448276, "writeRatioMax": 0.12413793103448276 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0896551724137931, "computeRatioMax": 0.0896551724137931, "endMs": "1665777890515", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.041379310344827586, "readRatioMax": 0.041379310344827586, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777890469", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:s_store_sk, $121:s_gmt_offset", "FROM store", "WHERE equal($121, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$120", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1103448275862069, "writeRatioMax": 0.1103448275862069 }, { "completedParallelInputs": "6", "computeMsAvg": "16", "computeMsMax": "22", "computeRatioAvg": 0.1103448275862069, "computeRatioMax": 0.15172413793103448, "endMs": "1665777890543", "id": "13", "inputStages": [ "0", "1", "4", "2", "3" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "30", "readRatioAvg": 0.1310344827586207, "readRatioMax": 0.20689655172413793, "recordsRead": "2880404", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "204", "startMs": "1665777890488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_customer_sk, $73:ss_store_sk, $74:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$110", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$170 := SUM($320)" ] }, { "kind": "JOIN", "substeps": [ "$320 := $311", "INNER HASH JOIN EACH WITH ALL ON $310 = $10" ] }, { "kind": "JOIN", "substeps": [ "$310 := $300, $311 := $301", "INNER HASH JOIN EACH WITH ALL ON $302 = $50" ] }, { "kind": "JOIN", "substeps": [ "$300 := $290, $301 := $292, $302 := $41", "INNER HASH JOIN EACH WITH ALL ON $291 = $40" ] }, { "kind": "JOIN", "substeps": [ "$290 := $271, $291 := $272, $292 := $273", "INNER HASH JOIN EACH WITH ALL ON $270 = $80" ] }, { "kind": "JOIN", "substeps": [ "$270 := $70, $271 := $71, $272 := $72, $273 := $74", "INNER HASH JOIN EACH WITH ALL ON $73 = $110" ] }, { "kind": "WRITE", "substeps": [ "$170", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.013793103448275862, "waitRatioMax": 0.020689655172413793, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.006896551724137931, "writeRatioMax": 0.006896551724137931 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.034482758620689655, "computeRatioMax": 0.034482758620689655, "endMs": "1665777890545", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665777890491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := SUM($170)" ] }, { "kind": "WRITE", "substeps": [ "$150", "TO __stage0E_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.027586206896551724, "waitRatioMax": 0.027586206896551724, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.013793103448275862, "writeRatioMax": 0.013793103448275862 }, { "completedParallelInputs": "6", "computeMsAvg": "115", "computeMsMax": "145", "computeRatioAvg": 0.7931034482758621, "computeRatioMax": 1, "endMs": "1665777890635", "id": "15", "inputStages": [ "10", "6", "9", "8", "7", "11" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "24", "readRatioAvg": 0.13793103448275862, "readRatioMax": 0.16551724137931034, "recordsRead": "3591080", "recordsWritten": "6", "shuffleOutputBytes": "6", "shuffleOutputBytesSpilled": "0", "slotMs": "752", "startMs": "1665777890520", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_customer_sk, $93:ss_store_sk, $94:ss_promo_sk, $95:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$120", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$160 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $241", "INNER HASH JOIN EACH WITH ALL ON $240 = $1" ] }, { "kind": "JOIN", "substeps": [ "$240 := $230, $241 := $231", "INNER HASH JOIN EACH WITH ALL ON $232 = $30" ] }, { "kind": "JOIN", "substeps": [ "$230 := $220, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $221 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $201, $221 := $202, $222 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $60" ] }, { "kind": "JOIN", "substeps": [ "$200 := $180, $201 := $181, $202 := $182, $203 := $184", "INNER HASH JOIN EACH WITH ALL ON $183 = $100" ] }, { "kind": "JOIN", "substeps": [ "$180 := $90, $181 := $91, $182 := $92, $183 := $94, $184 := $95", "INNER HASH JOIN EACH WITH ALL ON $93 = $120" ] }, { "kind": "WRITE", "substeps": [ "$160", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.013793103448275862, "waitRatioMax": 0.020689655172413793, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.006896551724137931, "writeRatioMax": 0.006896551724137931 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.027586206896551724, "computeRatioMax": 0.027586206896551724, "endMs": "1665777890642", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "1", "shuffleOutputBytes": "1", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665777890524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$140", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.027586206896551724, "waitRatioMax": 0.027586206896551724, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06896551724137931, "computeRatioMax": 0.06896551724137931, "endMs": "1665777890731", "id": "17", "inputStages": [ "16", "14" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "3", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777890692", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$150", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$330 ASC, $331 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := multiply(divide($330, $331), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $140, $331 := $150", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006896551724137931, "waitRatioMax": 0.006896551724137931, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.09655172413793103, "writeRatioMax": 0.09655172413793103 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "promotion" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "26", "elapsedMs": "606", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1486" } ], "totalBytesBilled": "160432128", "totalBytesProcessed": "159881871", "totalPartitionsProcessed": "0", "totalSlotMs": "1486", "transferredBytes": "0" }, "startTime": "1665777890164", "totalBytesProcessed": "159881871", "totalSlotMs": "1486" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
