{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4be5c2d8_add0_4576_a9b5_f97789a008b9" }, "priority": "INTERACTIVE", "query": "-- start query 83 in stream 0 using template query83.tpl\n\n/*\nRetrieve the items with the highest number of returns where the number of returns was approximately equivalent \nacross all store, catalog and web channels (within a tolerance of +/- 10%), \nwithin the week ending a given date.\n*/\n\nwith sr_items as\n (select i_item_id item_id,\n sum(sr_return_quantity) sr_item_qty\n from store_returns,\n item,\n date_dim\n where sr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and sr_returned_date_sk = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n item,\n date_dim\n where cr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and cr_returned_date_sk = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n sum(wr_return_quantity) wr_item_qty\n from web_returns,\n item,\n date_dim\n where wr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and wr_returned_date_sk = d_date_sk\n group by i_item_id)\nselect sr_items.item_id\n ,sr_item_qty\n ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 sr_dev\n ,cr_item_qty\n ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cr_dev\n ,wr_item_qty\n ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 wr_dev\n ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n ,cr_items\n ,wr_items\n where sr_items.item_id=cr_items.item_id\n and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n ,sr_item_qty\n limit 100\n ;\n\n-- end query 83 in stream 0 using template query83.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2mfkZz1Q6TO8n/m+Sp8tCg==", "id": "test-project-364309:europe-west1.query83_1665768491", "jobReference": { "jobId": "query83_1665768491", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query83_1665768491?location=europe-west1", "statistics": { "creationTime": "1665768491779", "endTime": "1665768492711", "finalExecutionDurationMs": "675", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14067480", "performanceInsights": { "avgPreviousExecutionMs": "661" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.09836065573770492, "computeRatioMax": 0.09836065573770492, "endMs": "1665768492001", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0546448087431694, "readRatioMax": 0.0546448087431694, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768491962", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$141:d_week_seq, $140:d_date", "FROM date_dim", "WHERE in($140, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$141", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.060109289617486336, "writeRatioMax": 0.060109289617486336 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.18032786885245902, "computeRatioMax": 0.18032786885245902, "endMs": "1665768492020", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04371584699453552, "readRatioMax": 0.04371584699453552, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768491976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07650273224043716, "writeRatioMax": 0.07650273224043716 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.1092896174863388, "computeRatioMax": 0.1092896174863388, "endMs": "1665768492037", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03825136612021858, "readRatioMax": 0.03825136612021858, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768491991", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:i_item_sk, $131:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01092896174863388, "waitRatioMax": 0.01092896174863388, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.12568306010928962, "writeRatioMax": 0.12568306010928962 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.07103825136612021, "computeRatioMax": 0.07103825136612021, "endMs": "1665768492058", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03278688524590164, "readRatioMax": 0.03278688524590164, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768492022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$111:d_week_seq, $110:d_date", "FROM date_dim", "WHERE in($110, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04918032786885246, "writeRatioMax": 0.04918032786885246 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.2786885245901639, "computeRatioMax": 0.2786885245901639, "endMs": "1665768492079", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03825136612021858, "readRatioMax": 0.03825136612021858, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768492036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0546448087431694, "writeRatioMax": 0.0546448087431694 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.10382513661202186, "computeRatioMax": 0.10382513661202186, "endMs": "1665768492110", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.04918032786885246, "readRatioMax": 0.04918032786885246, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768492053", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:i_item_sk, $101:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.11475409836065574, "writeRatioMax": 0.11475409836065574 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.08196721311475409, "computeRatioMax": 0.08196721311475409, "endMs": "1665768492125", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03825136612021858, "readRatioMax": 0.03825136612021858, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768492086", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81:d_week_seq, $80:d_date", "FROM date_dim", "WHERE in($80, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$81", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0273224043715847, "writeRatioMax": 0.0273224043715847 }, { "completedParallelInputs": "1", "computeMsAvg": "54", "computeMsMax": "54", "computeRatioAvg": 0.29508196721311475, "computeRatioMax": 0.29508196721311475, "endMs": "1665768492153", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0546448087431694, "readRatioMax": 0.0546448087431694, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665768492103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01092896174863388, "waitRatioMax": 0.01092896174863388, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.07103825136612021, "writeRatioMax": 0.07103825136612021 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.09836065573770492, "computeRatioMax": 0.09836065573770492, "endMs": "1665768492167", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04371584699453552, "readRatioMax": 0.04371584699453552, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768492118", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:i_item_sk, $71:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.14207650273224043, "writeRatioMax": 0.14207650273224043 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.12021857923497267, "computeRatioMax": 0.12021857923497267, "endMs": "1665768492188", "id": "12", "inputStages": [ "0" ], "name": "S0C: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03278688524590164, "readRatioMax": 0.03278688524590164, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768492147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date, $51:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$141", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $50", "SEMI HASH JOIN EACH WITH ALL ON $51 = $141" ] }, { "kind": "WRITE", "substeps": [ "$300", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.10382513661202186, "writeRatioMax": 0.10382513661202186 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.16393442622950818, "computeRatioMax": 0.16393442622950818, "endMs": "1665768492231", "id": "13", "inputStages": [ "4" ], "name": "S0D: Join", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.06557377049180328, "readRatioMax": 0.06557377049180328, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665768492164", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$111", "FROM __stage04_output" ] }, { "kind": "JOIN", "substeps": [ "$240 := $30", "SEMI HASH JOIN EACH WITH ALL ON $31 = $111" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01092896174863388, "waitRatioMax": 0.01092896174863388, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.16393442622950818, "writeRatioMax": 0.16393442622950818 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.09836065573770492, "computeRatioMax": 0.09836065573770492, "endMs": "1665768492216", "id": "14", "inputStages": [ "8" ], "name": "S0E: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03278688524590164, "readRatioMax": 0.03278688524590164, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768492177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$81", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $10", "SEMI HASH JOIN EACH WITH ALL ON $11 = $81" ] }, { "kind": "WRITE", "substeps": [ "$370", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.08743169398907104, "writeRatioMax": 0.08743169398907104 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.04371584699453552, "computeRatioMax": 0.07650273224043716, "endMs": "1665768492248", "id": "15", "inputStages": [ "12" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "2986", "startMs": "1665768492196", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.01092896174863388, "waitRatioMax": 0.01639344262295082, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.08196721311475409, "writeRatioMax": 0.15300546448087432 }, { "completedParallelInputs": "1", "computeMsAvg": "182", "computeMsMax": "182", "computeRatioAvg": 0.994535519125683, "computeRatioMax": 0.994535519125683, "endMs": "1665768492359", "id": "16", "inputStages": [ "15", "2", "1" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04371584699453552, "readRatioMax": 0.04371584699453552, "recordsRead": "235137", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "156", "startMs": "1665768492201", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cr_returned_date_sk, $121:cr_item_sk, $122:cr_return_quantity", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$300", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $311", "$210 := SUM($310)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291", "SEMI HASH JOIN EACH WITH ALL ON $292 = $300" ] }, { "kind": "JOIN", "substeps": [ "$290 := $281, $291 := $282, $292 := $41", "INNER HASH JOIN EACH WITH ALL ON $280 = $40" ] }, { "kind": "JOIN", "substeps": [ "$280 := $120, $281 := $122, $282 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$320, $210", "TO __stage10_output", "BY HASH($320)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01092896174863388, "waitRatioMax": 0.01092896174863388, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02185792349726776, "writeRatioMax": 0.02185792349726776 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.04371584699453552, "computeRatioMax": 0.11475409836065574, "endMs": "1665768492285", "id": "17", "inputStages": [ "14" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3715", "startMs": "1665768492226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.01092896174863388, "waitRatioMax": 0.01639344262295082, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.08196721311475409, "writeRatioMax": 0.1092896174863388 }, { "completedParallelInputs": "1", "computeMsAvg": "134", "computeMsMax": "134", "computeRatioAvg": 0.73224043715847, "computeRatioMax": 0.73224043715847, "endMs": "1665768492369", "id": "18", "inputStages": [ "9", "10", "17" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03825136612021858, "readRatioMax": 0.03825136612021858, "recordsRead": "162833", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665768492238", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_returned_date_sk, $61:wr_item_sk, $62:wr_return_quantity", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361", "SEMI HASH JOIN EACH WITH ALL ON $362 = $370" ] }, { "kind": "JOIN", "substeps": [ "$360 := $351, $361 := $352, $362 := $2", "INNER HASH JOIN EACH WITH ALL ON $350 = $1" ] }, { "kind": "JOIN", "substeps": [ "$350 := $60, $351 := $62, $352 := $71", "INNER HASH JOIN EACH WITH ALL ON $61 = $70" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage12_output", "BY HASH($390)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0273224043715847, "writeRatioMax": 0.0273224043715847 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.04371584699453552, "computeRatioMax": 0.09289617486338798, "endMs": "1665768492306", "id": "19", "inputStages": [ "13" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3351", "startMs": "1665768492240", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.01092896174863388, "waitRatioMax": 0.01639344262295082, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.07650273224043716, "writeRatioMax": 0.12021857923497267 }, { "completedParallelInputs": "1", "computeMsAvg": "183", "computeMsMax": "183", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768492421", "id": "20", "inputStages": [ "5", "19", "6" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.06557377049180328, "readRatioMax": 0.06557377049180328, "recordsRead": "378584", "recordsWritten": "2276", "shuffleOutputBytes": "68032", "shuffleOutputBytesSpilled": "0", "slotMs": "145", "startMs": "1665768492245", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:sr_returned_date_sk, $91:sr_item_sk, $92:sr_return_quantity", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$240", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $251", "$200 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $230, $251 := $231", "SEMI HASH JOIN EACH WITH ALL ON $232 = $240" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $220 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $90, $221 := $92, $222 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$260, $200", "TO __stage14_output", "BY HASH($260)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02185792349726776, "writeRatioMax": 0.02185792349726776 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.08196721311475409, "computeRatioMax": 0.08196721311475409, "endMs": "1665768492482", "id": "21", "inputStages": [ "18" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768492444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.06557377049180328, "writeRatioMax": 0.06557377049180328 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.060109289617486336, "computeRatioMax": 0.060109289617486336, "endMs": "1665768492484", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665768492460", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $210", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $330", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.00546448087431694, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07650273224043716, "writeRatioMax": 0.07650273224043716 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.04371584699453552, "computeRatioMax": 0.10382513661202186, "endMs": "1665768492558", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "4046", "startMs": "1665768492492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.00546448087431694, "waitRatioMax": 0.01639344262295082, "writeMsAvg": "24", "writeMsMax": "54", "writeRatioAvg": 0.13114754098360656, "writeRatioMax": 0.29508196721311475 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.04371584699453552, "computeRatioMax": 0.08743169398907104, "endMs": "1665768492545", "id": "25", "inputStages": [ "21" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "2821", "startMs": "1665768492492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.01639344262295082, "waitRatioMax": 0.0273224043715847, "writeMsAvg": "9", "writeMsMax": "18", "writeRatioAvg": 0.04918032786885246, "writeRatioMax": 0.09836065573770492 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.09836065573770492, "computeRatioMax": 0.09836065573770492, "endMs": "1665768492585", "id": "26", "inputStages": [ "24", "20", "25" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4250", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665768492504", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $200", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$180, $330", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide(divide(CAST($422 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$151 := multiply(divide(divide(CAST($423 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$152 := multiply(divide(divide(CAST($421 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$153 := divide(CAST(add(add($422, $423), $421) AS DOUBLE), 3)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$410 := $340, $411 := $341, $412 := $342, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $340 = $400" ] }, { "kind": "JOIN", "substeps": [ "$340 := $270, $341 := $170, $342 := $180", "INNER HASH JOIN EACH WITH ALL ON $270 = $330" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1A_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.03278688524590164, "waitRatioMax": 0.03278688524590164, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.01639344262295082, "writeRatioMax": 0.01639344262295082 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04918032786885246, "computeRatioMax": 0.04918032786885246, "endMs": "1665768492594", "id": "27", "inputStages": [ "26" ], "name": "S1B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768492508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1A_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1B_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.03278688524590164, "waitRatioMax": 0.03278688524590164, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03278688524590164, "writeRatioMax": 0.03278688524590164 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "315", "elapsedMs": "630", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "10962" }, { "activeUnits": "2", "completedUnits": "519", "elapsedMs": "814", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "17900" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "14067480", "totalPartitionsProcessed": "0", "totalSlotMs": "17900", "transferredBytes": "0" }, "startTime": "1665768491834", "totalBytesProcessed": "14067480", "totalSlotMs": "17900" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anondcd95838_c8e2_4cdc_9e40_a6140e1cfc36" }, "priority": "INTERACTIVE", "query": "-- start query 83 in stream 0 using template query83.tpl\n\n/*\nRetrieve the items with the highest number of returns where the number of returns was approximately equivalent \nacross all store, catalog and web channels (within a tolerance of +/- 10%), \nwithin the week ending a given date.\n*/\n\nwith sr_items as\n (select i_item_id item_id,\n sum(sr_return_quantity) sr_item_qty\n from store_returns,\n item,\n date_dim\n where sr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and sr_returned_date_sk = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n item,\n date_dim\n where cr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and cr_returned_date_sk = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n sum(wr_return_quantity) wr_item_qty\n from web_returns,\n item,\n date_dim\n where wr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and wr_returned_date_sk = d_date_sk\n group by i_item_id)\nselect sr_items.item_id\n ,sr_item_qty\n ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 sr_dev\n ,cr_item_qty\n ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cr_dev\n ,wr_item_qty\n ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 wr_dev\n ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n ,cr_items\n ,wr_items\n where sr_items.item_id=cr_items.item_id\n and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n ,sr_item_qty\n limit 100\n ;\n\n-- end query 83 in stream 0 using template query83.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "+X2aFZ0Ya+Gr984uoqOSqA==", "id": "test-project-364309:europe-west1.query83_1665778681", "jobReference": { "jobId": "query83_1665778681", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query83_1665778681?location=europe-west1", "statistics": { "creationTime": "1665778682005", "endTime": "1665778682940", "finalExecutionDurationMs": "734", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14067480", "performanceInsights": { "avgPreviousExecutionMs": "664" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.042483660130718956, "computeRatioMax": 0.042483660130718956, "endMs": "1665778682204", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016339869281045753, "readRatioMax": 0.016339869281045753, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778682151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$141:d_week_seq, $140:d_date", "FROM date_dim", "WHERE in($140, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$141", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.042483660130718956, "writeRatioMax": 0.042483660130718956 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.10457516339869281, "computeRatioMax": 0.10457516339869281, "endMs": "1665778682202", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026143790849673203, "readRatioMax": 0.026143790849673203, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778682165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.05228758169934641, "computeRatioMax": 0.05228758169934641, "endMs": "1665778682234", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0196078431372549, "readRatioMax": 0.0196078431372549, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778682179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:i_item_sk, $131:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.08823529411764706, "writeRatioMax": 0.08823529411764706 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.05228758169934641, "computeRatioMax": 0.05228758169934641, "endMs": "1665778682256", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02287581699346405, "readRatioMax": 0.02287581699346405, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778682211", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$111:d_week_seq, $110:d_date", "FROM date_dim", "WHERE in($110, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0457516339869281, "writeRatioMax": 0.0457516339869281 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.11764705882352941, "computeRatioMax": 0.11764705882352941, "endMs": "1665778682265", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016339869281045753, "readRatioMax": 0.016339869281045753, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778682227", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03594771241830065, "writeRatioMax": 0.03594771241830065 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.08496732026143791, "computeRatioMax": 0.08496732026143791, "endMs": "1665778682293", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026143790849673203, "readRatioMax": 0.026143790849673203, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665778682246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:i_item_sk, $101:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.08169934640522876, "writeRatioMax": 0.08169934640522876 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03594771241830065, "computeRatioMax": 0.03594771241830065, "endMs": "1665778682313", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016339869281045753, "readRatioMax": 0.016339869281045753, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778682277", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81:d_week_seq, $80:d_date", "FROM date_dim", "WHERE in($80, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$81", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0196078431372549, "writeRatioMax": 0.0196078431372549 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.1437908496732026, "computeRatioMax": 0.1437908496732026, "endMs": "1665778682386", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03594771241830065, "readRatioMax": 0.03594771241830065, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665778682291", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "56", "writeMsMax": "56", "writeRatioAvg": 0.1830065359477124, "writeRatioMax": 0.1830065359477124 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.08823529411764706, "computeRatioMax": 0.08823529411764706, "endMs": "1665778682350", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0196078431372549, "readRatioMax": 0.0196078431372549, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778682306", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:i_item_sk, $71:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.07516339869281045, "writeRatioMax": 0.07516339869281045 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.06535947712418301, "computeRatioMax": 0.06535947712418301, "endMs": "1665778682400", "id": "12", "inputStages": [ "0" ], "name": "S0C: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0196078431372549, "readRatioMax": 0.0196078431372549, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778682341", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date, $51:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$141", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $50", "SEMI HASH JOIN EACH WITH ALL ON $51 = $141" ] }, { "kind": "WRITE", "substeps": [ "$300", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.0718954248366013, "writeRatioMax": 0.0718954248366013 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.0784313725490196, "computeRatioMax": 0.0784313725490196, "endMs": "1665778682401", "id": "13", "inputStages": [ "4" ], "name": "S0D: Join", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026143790849673203, "readRatioMax": 0.026143790849673203, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778682358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$111", "FROM __stage04_output" ] }, { "kind": "JOIN", "substeps": [ "$240 := $30", "SEMI HASH JOIN EACH WITH ALL ON $31 = $111" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.06535947712418301, "writeRatioMax": 0.06535947712418301 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.06535947712418301, "computeRatioMax": 0.06535947712418301, "endMs": "1665778682418", "id": "14", "inputStages": [ "8" ], "name": "S0E: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0196078431372549, "readRatioMax": 0.0196078431372549, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778682375", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$81", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $10", "SEMI HASH JOIN EACH WITH ALL ON $11 = $81" ] }, { "kind": "WRITE", "substeps": [ "$370", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006535947712418301, "waitRatioMax": 0.006535947712418301, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.06535947712418301, "writeRatioMax": 0.06535947712418301 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.026143790849673203, "computeRatioMax": 0.05228758169934641, "endMs": "1665778682469", "id": "16", "inputStages": [ "12" ], "name": "S10: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3383", "startMs": "1665778682403", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006535947712418301, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.0457516339869281, "writeRatioMax": 0.06535947712418301 }, { "completedParallelInputs": "1", "computeMsAvg": "103", "computeMsMax": "103", "computeRatioAvg": 0.3366013071895425, "computeRatioMax": 0.3366013071895425, "endMs": "1665778682557", "id": "17", "inputStages": [ "1", "2", "16" ], "name": "S11: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03594771241830065, "readRatioMax": 0.03594771241830065, "recordsRead": "235137", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "121", "startMs": "1665778682409", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cr_returned_date_sk, $121:cr_item_sk, $122:cr_return_quantity", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$300", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $311", "$210 := SUM($310)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291", "SEMI HASH JOIN EACH WITH ALL ON $292 = $300" ] }, { "kind": "JOIN", "substeps": [ "$290 := $281, $291 := $282, $292 := $41", "INNER HASH JOIN EACH WITH ALL ON $280 = $40" ] }, { "kind": "JOIN", "substeps": [ "$280 := $120, $281 := $122, $282 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$320, $210", "TO __stage11_output", "BY HASH($320)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006535947712418301, "waitRatioMax": 0.006535947712418301, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.00980392156862745, "writeRatioMax": 0.00980392156862745 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.026143790849673203, "computeRatioMax": 0.058823529411764705, "endMs": "1665778682471", "id": "18", "inputStages": [ "13" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3170", "startMs": "1665778682411", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.006535947712418301, "waitRatioMax": 0.013071895424836602, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.0457516339869281, "writeRatioMax": 0.08496732026143791 }, { "completedParallelInputs": "1", "computeMsAvg": "306", "computeMsMax": "306", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778682644", "id": "19", "inputStages": [ "5", "18", "6" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.032679738562091505, "readRatioMax": 0.032679738562091505, "recordsRead": "378584", "recordsWritten": "2276", "shuffleOutputBytes": "68032", "shuffleOutputBytesSpilled": "0", "slotMs": "203", "startMs": "1665778682417", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:sr_returned_date_sk, $91:sr_item_sk, $92:sr_return_quantity", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$240", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $251", "$200 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $230, $251 := $231", "SEMI HASH JOIN EACH WITH ALL ON $232 = $240" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $220 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $90, $221 := $92, $222 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$260, $200", "TO __stage13_output", "BY HASH($260)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02287581699346405, "writeRatioMax": 0.02287581699346405 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.026143790849673203, "computeRatioMax": 0.05555555555555555, "endMs": "1665778682485", "id": "20", "inputStages": [ "14" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3692", "startMs": "1665778682427", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006535947712418301, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "25", "writeMsMax": "31", "writeRatioAvg": 0.08169934640522876, "writeRatioMax": 0.10130718954248366 }, { "completedParallelInputs": "1", "computeMsAvg": "96", "computeMsMax": "96", "computeRatioAvg": 0.3137254901960784, "computeRatioMax": 0.3137254901960784, "endMs": "1665778682564", "id": "21", "inputStages": [ "10", "9", "20" ], "name": "S15: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.032679738562091505, "readRatioMax": 0.032679738562091505, "recordsRead": "162833", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "104", "startMs": "1665778682440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_returned_date_sk, $61:wr_item_sk, $62:wr_return_quantity", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361", "SEMI HASH JOIN EACH WITH ALL ON $362 = $370" ] }, { "kind": "JOIN", "substeps": [ "$360 := $351, $361 := $352, $362 := $2", "INNER HASH JOIN EACH WITH ALL ON $350 = $1" ] }, { "kind": "JOIN", "substeps": [ "$350 := $60, $351 := $62, $352 := $71", "INNER HASH JOIN EACH WITH ALL ON $61 = $70" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage15_output", "BY HASH($390)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02287581699346405, "writeRatioMax": 0.02287581699346405 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.05555555555555555, "endMs": "1665778682721", "id": "22", "inputStages": [ "21" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778682682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.042483660130718956, "writeRatioMax": 0.042483660130718956 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.049019607843137254, "computeRatioMax": 0.049019607843137254, "endMs": "1665778682733", "id": "23", "inputStages": [ "17" ], "name": "S17: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778682697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $210", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $330", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032679738562091504, "waitRatioMax": 0.0032679738562091504, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.049019607843137254, "writeRatioMax": 0.049019607843137254 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.07516339869281045, "endMs": "1665778682803", "id": "25", "inputStages": [ "23" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "3434", "startMs": "1665778682748", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "8", "waitRatioAvg": 0.006535947712418301, "waitRatioMax": 0.026143790849673203, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.05228758169934641, "writeRatioMax": 0.09803921568627451 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.026143790849673203, "computeRatioMax": 0.06535947712418301, "endMs": "1665778682813", "id": "26", "inputStages": [ "22" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "2957", "startMs": "1665778682748", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.02287581699346405, "waitRatioMax": 0.029411764705882353, "writeMsAvg": "13", "writeMsMax": "21", "writeRatioAvg": 0.042483660130718956, "writeRatioMax": 0.06862745098039216 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.029411764705882353, "endMs": "1665778682824", "id": "27", "inputStages": [ "25", "26", "19" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4250", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778682760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $200", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$180, $330", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage1A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide(divide(CAST($422 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$151 := multiply(divide(divide(CAST($423 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$152 := multiply(divide(divide(CAST($421 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$153 := divide(CAST(add(add($422, $423), $421) AS DOUBLE), 3)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$410 := $340, $411 := $341, $412 := $342, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $340 = $400" ] }, { "kind": "JOIN", "substeps": [ "$340 := $270, $341 := $170, $342 := $180", "INNER HASH JOIN EACH WITH ALL ON $270 = $330" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1B_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.026143790849673203, "waitRatioMax": 0.026143790849673203, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0032679738562091504, "writeRatioMax": 0.0032679738562091504 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.032679738562091505, "computeRatioMax": 0.032679738562091505, "endMs": "1665778682839", "id": "28", "inputStages": [ "27" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778682766", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1B_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1C_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.013071895424836602, "waitRatioMax": 0.013071895424836602, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.016339869281045753, "writeRatioMax": 0.016339869281045753 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "315", "elapsedMs": "602", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11287" }, { "activeUnits": "0", "completedUnits": "519", "elapsedMs": "845", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "17823" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "14067480", "totalPartitionsProcessed": "0", "totalSlotMs": "17823", "transferredBytes": "0" }, "startTime": "1665778682050", "totalBytesProcessed": "14067480", "totalSlotMs": "17823" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon63314d61_d30f_4081_b686_bc94d74629ce" }, "priority": "INTERACTIVE", "query": "-- start query 83 in stream 0 using template query83.tpl\n\n/*\nRetrieve the items with the highest number of returns where the number of returns was approximately equivalent \nacross all store, catalog and web channels (within a tolerance of +/- 10%), \nwithin the week ending a given date.\n*/\n\nwith sr_items as\n (select i_item_id item_id,\n sum(sr_return_quantity) sr_item_qty\n from store_returns,\n item,\n date_dim\n where sr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and sr_returned_date_sk = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n item,\n date_dim\n where cr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and cr_returned_date_sk = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n sum(wr_return_quantity) wr_item_qty\n from web_returns,\n item,\n date_dim\n where wr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and wr_returned_date_sk = d_date_sk\n group by i_item_id)\nselect sr_items.item_id\n ,sr_item_qty\n ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 sr_dev\n ,cr_item_qty\n ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cr_dev\n ,wr_item_qty\n ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 wr_dev\n ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n ,cr_items\n ,wr_items\n where sr_items.item_id=cr_items.item_id\n and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n ,sr_item_qty\n limit 100\n ;\n\n-- end query 83 in stream 0 using template query83.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "jHfTECJhIwSHUY/YQHE0yA==", "id": "test-project-364309:europe-west1.query83_1665778683", "jobReference": { "jobId": "query83_1665778683", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query83_1665778683?location=europe-west1", "statistics": { "creationTime": "1665778684553", "endTime": "1665778685676", "finalExecutionDurationMs": "863", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14067480", "performanceInsights": { "avgPreviousExecutionMs": "676" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.07317073170731707, "computeRatioMax": 0.07317073170731707, "endMs": "1665778684774", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028455284552845527, "readRatioMax": 0.028455284552845527, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778684734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$141:d_week_seq, $140:d_date", "FROM date_dim", "WHERE in($140, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$141", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04065040650406504, "writeRatioMax": 0.04065040650406504 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.14634146341463414, "computeRatioMax": 0.14634146341463414, "endMs": "1665778684821", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028455284552845527, "readRatioMax": 0.028455284552845527, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665778684752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.036585365853658534, "writeRatioMax": 0.036585365853658534 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.06910569105691057, "computeRatioMax": 0.06910569105691057, "endMs": "1665778684859", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02032520325203252, "readRatioMax": 0.02032520325203252, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665778684770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:i_item_sk, $131:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "70", "writeMsMax": "70", "writeRatioAvg": 0.2845528455284553, "writeRatioMax": 0.2845528455284553 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.08943089430894309, "computeRatioMax": 0.08943089430894309, "endMs": "1665778684872", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028455284552845527, "readRatioMax": 0.028455284552845527, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778684829", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$111:d_week_seq, $110:d_date", "FROM date_dim", "WHERE in($110, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04878048780487805, "writeRatioMax": 0.04878048780487805 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.16260162601626016, "computeRatioMax": 0.16260162601626016, "endMs": "1665778684899", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.024390243902439025, "readRatioMax": 0.024390243902439025, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778684850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008130081300813009, "waitRatioMax": 0.008130081300813009, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.044715447154471545, "writeRatioMax": 0.044715447154471545 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.11382113821138211, "computeRatioMax": 0.11382113821138211, "endMs": "1665778684912", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028455284552845527, "readRatioMax": 0.028455284552845527, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778684867", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:i_item_sk, $101:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008130081300813009, "waitRatioMax": 0.008130081300813009, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.08943089430894309, "writeRatioMax": 0.08943089430894309 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.06910569105691057, "computeRatioMax": 0.06910569105691057, "endMs": "1665778684942", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028455284552845527, "readRatioMax": 0.028455284552845527, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778684902", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81:d_week_seq, $80:d_date", "FROM date_dim", "WHERE in($80, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$81", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.032520325203252036, "writeRatioMax": 0.032520325203252036 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.13821138211382114, "computeRatioMax": 0.13821138211382114, "endMs": "1665778684964", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02032520325203252, "readRatioMax": 0.02032520325203252, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778684918", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.032520325203252036, "writeRatioMax": 0.032520325203252036 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.08130081300813008, "computeRatioMax": 0.08130081300813008, "endMs": "1665778684992", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028455284552845527, "readRatioMax": 0.028455284552845527, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778684932", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:i_item_sk, $71:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.0975609756097561, "writeRatioMax": 0.0975609756097561 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.08536585365853659, "computeRatioMax": 0.08536585365853659, "endMs": "1665778685035", "id": "12", "inputStages": [ "0" ], "name": "S0C: Join", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.04878048780487805, "readRatioMax": 0.04878048780487805, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778684987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date, $51:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$141", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $50", "SEMI HASH JOIN EACH WITH ALL ON $51 = $141" ] }, { "kind": "WRITE", "substeps": [ "$300", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.08130081300813008, "writeRatioMax": 0.08130081300813008 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.06097560975609756, "computeRatioMax": 0.06097560975609756, "endMs": "1665778685047", "id": "13", "inputStages": [ "4" ], "name": "S0D: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.024390243902439025, "readRatioMax": 0.024390243902439025, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778685007", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$111", "FROM __stage04_output" ] }, { "kind": "JOIN", "substeps": [ "$240 := $30", "SEMI HASH JOIN EACH WITH ALL ON $31 = $111" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.08130081300813008, "writeRatioMax": 0.08130081300813008 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.12601626016260162, "computeRatioMax": 0.12601626016260162, "endMs": "1665778685100", "id": "14", "inputStages": [ "8" ], "name": "S0E: Join", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.044715447154471545, "readRatioMax": 0.044715447154471545, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665778685027", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$81", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $10", "SEMI HASH JOIN EACH WITH ALL ON $11 = $81" ] }, { "kind": "WRITE", "substeps": [ "$370", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.1016260162601626, "writeRatioMax": 0.1016260162601626 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.036585365853658534, "computeRatioMax": 0.06504065040650407, "endMs": "1665778685115", "id": "15", "inputStages": [ "12" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3778", "startMs": "1665778685045", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "5", "waitMsMax": "8", "waitRatioAvg": 0.02032520325203252, "waitRatioMax": 0.032520325203252036, "writeMsAvg": "19", "writeMsMax": "45", "writeRatioAvg": 0.07723577235772358, "writeRatioMax": 0.18292682926829268 }, { "completedParallelInputs": "1", "computeMsAvg": "194", "computeMsMax": "194", "computeRatioAvg": 0.7886178861788617, "computeRatioMax": 0.7886178861788617, "endMs": "1665778685202", "id": "16", "inputStages": [ "2", "1", "15" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.028455284552845527, "readRatioMax": 0.028455284552845527, "recordsRead": "235137", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "167", "startMs": "1665778685055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cr_returned_date_sk, $121:cr_item_sk, $122:cr_return_quantity", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$300", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $311", "$210 := SUM($310)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291", "SEMI HASH JOIN EACH WITH ALL ON $292 = $300" ] }, { "kind": "JOIN", "substeps": [ "$290 := $281, $291 := $282, $292 := $41", "INNER HASH JOIN EACH WITH ALL ON $280 = $40" ] }, { "kind": "JOIN", "substeps": [ "$280 := $120, $281 := $122, $282 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$320, $210", "TO __stage10_output", "BY HASH($320)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008130081300813009, "waitRatioMax": 0.008130081300813009, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.012195121951219513, "writeRatioMax": 0.012195121951219513 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.032520325203252036, "computeRatioMax": 0.06910569105691057, "endMs": "1665778685115", "id": "17", "inputStages": [ "13" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3318", "startMs": "1665778685055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.012195121951219513, "waitRatioMax": 0.016260162601626018, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.056910569105691054, "writeRatioMax": 0.08536585365853659 }, { "completedParallelInputs": "1", "computeMsAvg": "246", "computeMsMax": "246", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778685307", "id": "18", "inputStages": [ "5", "17", "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.04878048780487805, "readRatioMax": 0.04878048780487805, "recordsRead": "378584", "recordsWritten": "2276", "shuffleOutputBytes": "68032", "shuffleOutputBytesSpilled": "0", "slotMs": "244", "startMs": "1665778685061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:sr_returned_date_sk, $91:sr_item_sk, $92:sr_return_quantity", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$240", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $251", "$200 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $230, $251 := $231", "SEMI HASH JOIN EACH WITH ALL ON $232 = $240" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $220 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $90, $221 := $92, $222 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$260, $200", "TO __stage12_output", "BY HASH($260)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.012195121951219513, "waitRatioMax": 0.012195121951219513, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.024390243902439025, "writeRatioMax": 0.024390243902439025 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.032520325203252036, "computeRatioMax": 0.07723577235772358, "endMs": "1665778685167", "id": "19", "inputStages": [ "14" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3383", "startMs": "1665778685104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "8", "waitRatioAvg": 0.012195121951219513, "waitRatioMax": 0.032520325203252036, "writeMsAvg": "10", "writeMsMax": "22", "writeRatioAvg": 0.04065040650406504, "writeRatioMax": 0.08943089430894309 }, { "completedParallelInputs": "1", "computeMsAvg": "111", "computeMsMax": "111", "computeRatioAvg": 0.45121951219512196, "computeRatioMax": 0.45121951219512196, "endMs": "1665778685255", "id": "20", "inputStages": [ "10", "9", "19" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.044715447154471545, "readRatioMax": 0.044715447154471545, "recordsRead": "162833", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665778685120", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_returned_date_sk, $61:wr_item_sk, $62:wr_return_quantity", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361", "SEMI HASH JOIN EACH WITH ALL ON $362 = $370" ] }, { "kind": "JOIN", "substeps": [ "$360 := $351, $361 := $352, $362 := $2", "INNER HASH JOIN EACH WITH ALL ON $350 = $1" ] }, { "kind": "JOIN", "substeps": [ "$350 := $60, $351 := $62, $352 := $71", "INNER HASH JOIN EACH WITH ALL ON $61 = $70" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage14_output", "BY HASH($390)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.016260162601626018, "writeRatioMax": 0.016260162601626018 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.06097560975609756, "computeRatioMax": 0.06097560975609756, "endMs": "1665778685397", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778685359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.056910569105691054, "writeRatioMax": 0.056910569105691054 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.052845528455284556, "computeRatioMax": 0.052845528455284556, "endMs": "1665778685419", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778685379", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $210", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $330", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008130081300813009, "waitRatioMax": 0.008130081300813009, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06910569105691057, "writeRatioMax": 0.06910569105691057 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.032520325203252036, "computeRatioMax": 0.06097560975609756, "endMs": "1665778685504", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "3228", "startMs": "1665778685436", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.008130081300813009, "waitRatioMax": 0.02032520325203252, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.056910569105691054, "writeRatioMax": 0.07317073170731707 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.032520325203252036, "computeRatioMax": 0.07317073170731707, "endMs": "1665778685509", "id": "25", "inputStages": [ "21" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "3037", "startMs": "1665778685435", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.024390243902439025, "waitRatioMax": 0.032520325203252036, "writeMsAvg": "11", "writeMsMax": "30", "writeRatioAvg": 0.044715447154471545, "writeRatioMax": 0.12195121951219512 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04878048780487805, "computeRatioMax": 0.04878048780487805, "endMs": "1665778685517", "id": "26", "inputStages": [ "25", "18", "24" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4250", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778685452", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $200", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$180, $330", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide(divide(CAST($422 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$151 := multiply(divide(divide(CAST($423 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$152 := multiply(divide(divide(CAST($421 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$153 := divide(CAST(add(add($422, $423), $421) AS DOUBLE), 3)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$410 := $340, $411 := $341, $412 := $342, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $340 = $400" ] }, { "kind": "JOIN", "substeps": [ "$340 := $270, $341 := $170, $342 := $180", "INNER HASH JOIN EACH WITH ALL ON $270 = $330" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1A_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.036585365853658534, "waitRatioMax": 0.036585365853658534, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.036585365853658534, "computeRatioMax": 0.036585365853658534, "endMs": "1665778685528", "id": "27", "inputStages": [ "26" ], "name": "S1B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778685458", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1A_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1B_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.02032520325203252, "waitRatioMax": 0.02032520325203252, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.012195121951219513, "writeRatioMax": 0.012195121951219513 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "313", "elapsedMs": "619", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "11413" }, { "activeUnits": "2", "completedUnits": "519", "elapsedMs": "994", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "18140" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "14067480", "totalPartitionsProcessed": "0", "totalSlotMs": "18140", "transferredBytes": "0" }, "startTime": "1665778684616", "totalBytesProcessed": "14067480", "totalSlotMs": "18140" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc424c9d2_9f83_42fd_b8e4_55b52aa1775a" }, "priority": "INTERACTIVE", "query": "-- start query 83 in stream 0 using template query83.tpl\n\n/*\nRetrieve the items with the highest number of returns where the number of returns was approximately equivalent \nacross all store, catalog and web channels (within a tolerance of +/- 10%), \nwithin the week ending a given date.\n*/\n\nwith sr_items as\n (select i_item_id item_id,\n sum(sr_return_quantity) sr_item_qty\n from store_returns,\n item,\n date_dim\n where sr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and sr_returned_date_sk = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n item,\n date_dim\n where cr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and cr_returned_date_sk = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n sum(wr_return_quantity) wr_item_qty\n from web_returns,\n item,\n date_dim\n where wr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and wr_returned_date_sk = d_date_sk\n group by i_item_id)\nselect sr_items.item_id\n ,sr_item_qty\n ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 sr_dev\n ,cr_item_qty\n ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cr_dev\n ,wr_item_qty\n ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 wr_dev\n ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n ,cr_items\n ,wr_items\n where sr_items.item_id=cr_items.item_id\n and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n ,sr_item_qty\n limit 100\n ;\n\n-- end query 83 in stream 0 using template query83.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Z/LXJfEPeS72ZMNKIa3JUw==", "id": "test-project-364309:europe-west1.query83_1665778686", "jobReference": { "jobId": "query83_1665778686", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query83_1665778686?location=europe-west1", "statistics": { "creationTime": "1665778687384", "endTime": "1665778688812", "finalExecutionDurationMs": "1212", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14067480", "performanceInsights": { "avgPreviousExecutionMs": "703" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.05063291139240506, "endMs": "1665778687605", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02278481012658228, "readRatioMax": 0.02278481012658228, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778687561", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$141:d_week_seq, $140:d_date", "FROM date_dim", "WHERE in($140, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$141", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02278481012658228, "writeRatioMax": 0.02278481012658228 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.10379746835443038, "computeRatioMax": 0.10379746835443038, "endMs": "1665778687645", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020253164556962026, "readRatioMax": 0.020253164556962026, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665778687579", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03291139240506329, "writeRatioMax": 0.03291139240506329 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.06329113924050633, "computeRatioMax": 0.06329113924050633, "endMs": "1665778687702", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02278481012658228, "readRatioMax": 0.02278481012658228, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "89", "startMs": "1665778687612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:i_item_sk, $131:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.13670886075949368, "writeRatioMax": 0.13670886075949368 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04050632911392405, "computeRatioMax": 0.04050632911392405, "endMs": "1665778687779", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015189873417721518, "readRatioMax": 0.015189873417721518, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665778687706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$111:d_week_seq, $110:d_date", "FROM date_dim", "WHERE in($110, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "52", "writeMsMax": "52", "writeRatioAvg": 0.13164556962025317, "writeRatioMax": 0.13164556962025317 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.08354430379746836, "computeRatioMax": 0.08354430379746836, "endMs": "1665778687789", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015189873417721518, "readRatioMax": 0.015189873417721518, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778687752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005063291139240506, "waitRatioMax": 0.005063291139240506, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02531645569620253, "writeRatioMax": 0.02531645569620253 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.05822784810126582, "computeRatioMax": 0.05822784810126582, "endMs": "1665778687856", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017721518987341773, "readRatioMax": 0.017721518987341773, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665778687778", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:i_item_sk, $101:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007594936708860759, "waitRatioMax": 0.007594936708860759, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.13670886075949368, "writeRatioMax": 0.13670886075949368 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04556962025316456, "computeRatioMax": 0.04556962025316456, "endMs": "1665778687910", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020253164556962026, "readRatioMax": 0.020253164556962026, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665778687840", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81:d_week_seq, $80:d_date", "FROM date_dim", "WHERE in($80, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$81", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "49", "writeMsMax": "49", "writeRatioAvg": 0.1240506329113924, "writeRatioMax": 0.1240506329113924 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.09620253164556962, "computeRatioMax": 0.09620253164556962, "endMs": "1665778687949", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017721518987341773, "readRatioMax": 0.017721518987341773, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665778687881", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "37", "writeMsMax": "37", "writeRatioAvg": 0.09367088607594937, "writeRatioMax": 0.09367088607594937 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.0810126582278481, "computeRatioMax": 0.0810126582278481, "endMs": "1665778688022", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017721518987341773, "readRatioMax": 0.017721518987341773, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "138", "startMs": "1665778687930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:i_item_sk, $71:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005063291139240506, "waitRatioMax": 0.005063291139240506, "writeMsAvg": "62", "writeMsMax": "62", "writeRatioAvg": 0.1569620253164557, "writeRatioMax": 0.1569620253164557 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.05063291139240506, "endMs": "1665778688081", "id": "12", "inputStages": [ "0" ], "name": "S0C: Join", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665778688011", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date, $51:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$141", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $50", "SEMI HASH JOIN EACH WITH ALL ON $51 = $141" ] }, { "kind": "WRITE", "substeps": [ "$300", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "48", "writeMsMax": "48", "writeRatioAvg": 0.12151898734177215, "writeRatioMax": 0.12151898734177215 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.060759493670886074, "computeRatioMax": 0.060759493670886074, "endMs": "1665778688129", "id": "13", "inputStages": [ "4" ], "name": "S0D: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015189873417721518, "readRatioMax": 0.015189873417721518, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "92", "startMs": "1665778688064", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$111", "FROM __stage04_output" ] }, { "kind": "JOIN", "substeps": [ "$240 := $30", "SEMI HASH JOIN EACH WITH ALL ON $31 = $111" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "34", "writeMsMax": "34", "writeRatioAvg": 0.08607594936708861, "writeRatioMax": 0.08607594936708861 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04050632911392405, "computeRatioMax": 0.04050632911392405, "endMs": "1665778688219", "id": "14", "inputStages": [ "8" ], "name": "S0E: Join", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020253164556962026, "readRatioMax": 0.020253164556962026, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665778688121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$81", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $10", "SEMI HASH JOIN EACH WITH ALL ON $11 = $81" ] }, { "kind": "WRITE", "substeps": [ "$370", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005063291139240506, "waitRatioMax": 0.005063291139240506, "writeMsAvg": "76", "writeMsMax": "76", "writeRatioAvg": 0.19240506329113924, "writeRatioMax": 0.19240506329113924 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.02278481012658228, "computeRatioMax": 0.053164556962025315, "endMs": "1665778688216", "id": "15", "inputStages": [ "12" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "6222", "startMs": "1665778688125", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "8", "waitMsMax": "11", "waitRatioAvg": 0.020253164556962026, "waitRatioMax": 0.027848101265822784, "writeMsAvg": "44", "writeMsMax": "69", "writeRatioAvg": 0.11139240506329114, "writeRatioMax": 0.17468354430379746 }, { "completedParallelInputs": "1", "computeMsAvg": "135", "computeMsMax": "135", "computeRatioAvg": 0.34177215189873417, "computeRatioMax": 0.34177215189873417, "endMs": "1665778688302", "id": "16", "inputStages": [ "15", "2", "1" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.027848101265822784, "readRatioMax": 0.027848101265822784, "recordsRead": "235137", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "102", "startMs": "1665778688140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cr_returned_date_sk, $121:cr_item_sk, $122:cr_return_quantity", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$300", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $311", "$210 := SUM($310)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291", "SEMI HASH JOIN EACH WITH ALL ON $292 = $300" ] }, { "kind": "JOIN", "substeps": [ "$290 := $281, $291 := $282, $292 := $41", "INNER HASH JOIN EACH WITH ALL ON $280 = $40" ] }, { "kind": "JOIN", "substeps": [ "$280 := $120, $281 := $122, $282 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$320, $210", "TO __stage10_output", "BY HASH($320)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.012658227848101266, "waitRatioMax": 0.012658227848101266, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007594936708860759, "writeRatioMax": 0.007594936708860759 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.02278481012658228, "computeRatioMax": 0.053164556962025315, "endMs": "1665778688223", "id": "17", "inputStages": [ "13" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3874", "startMs": "1665778688155", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "7", "waitRatioAvg": 0.005063291139240506, "waitRatioMax": 0.017721518987341773, "writeMsAvg": "18", "writeMsMax": "33", "writeRatioAvg": 0.04556962025316456, "writeRatioMax": 0.08354430379746836 }, { "completedParallelInputs": "1", "computeMsAvg": "395", "computeMsMax": "395", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778688479", "id": "18", "inputStages": [ "6", "5", "17" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.05063291139240506, "readRatioMax": 0.05063291139240506, "recordsRead": "378584", "recordsWritten": "2276", "shuffleOutputBytes": "68032", "shuffleOutputBytesSpilled": "0", "slotMs": "347", "startMs": "1665778688166", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:sr_returned_date_sk, $91:sr_item_sk, $92:sr_return_quantity", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$240", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $251", "$200 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $230, $251 := $231", "SEMI HASH JOIN EACH WITH ALL ON $232 = $240" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $220 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $90, $221 := $92, $222 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$260, $200", "TO __stage12_output", "BY HASH($260)" ] } ], "waitMsAvg": "15", "waitMsMax": "15", "waitRatioAvg": 0.0379746835443038, "waitRatioMax": 0.0379746835443038, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02278481012658228, "writeRatioMax": 0.02278481012658228 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.020253164556962026, "computeRatioMax": 0.0379746835443038, "endMs": "1665778688282", "id": "19", "inputStages": [ "14" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3350", "startMs": "1665778688225", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005063291139240506, "waitRatioMax": 0.007594936708860759, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.04050632911392405, "writeRatioMax": 0.07341772151898734 }, { "completedParallelInputs": "1", "computeMsAvg": "101", "computeMsMax": "101", "computeRatioAvg": 0.25569620253164554, "computeRatioMax": 0.25569620253164554, "endMs": "1665778688348", "id": "20", "inputStages": [ "9", "19", "10" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017721518987341773, "readRatioMax": 0.017721518987341773, "recordsRead": "162833", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "104", "startMs": "1665778688244", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_returned_date_sk, $61:wr_item_sk, $62:wr_return_quantity", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361", "SEMI HASH JOIN EACH WITH ALL ON $362 = $370" ] }, { "kind": "JOIN", "substeps": [ "$360 := $351, $361 := $352, $362 := $2", "INNER HASH JOIN EACH WITH ALL ON $350 = $1" ] }, { "kind": "JOIN", "substeps": [ "$350 := $60, $351 := $62, $352 := $71", "INNER HASH JOIN EACH WITH ALL ON $61 = $70" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage14_output", "BY HASH($390)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.010126582278481013, "waitRatioMax": 0.010126582278481013, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010126582278481013, "writeRatioMax": 0.010126582278481013 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0379746835443038, "computeRatioMax": 0.0379746835443038, "endMs": "1665778688566", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778688500", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "55", "writeMsMax": "55", "writeRatioAvg": 0.13924050632911392, "writeRatioMax": 0.13924050632911392 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.027848101265822784, "computeRatioMax": 0.027848101265822784, "endMs": "1665778688574", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778688519", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $210", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $330", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.002531645569620253, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.0759493670886076, "writeRatioMax": 0.0759493670886076 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.02278481012658228, "computeRatioMax": 0.053164556962025315, "endMs": "1665778688656", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "4021", "startMs": "1665778688593", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005063291139240506, "waitRatioMax": 0.010126582278481013, "writeMsAvg": "27", "writeMsMax": "33", "writeRatioAvg": 0.06835443037974684, "writeRatioMax": 0.08354430379746836 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.02278481012658228, "computeRatioMax": 0.053164556962025315, "endMs": "1665778688656", "id": "25", "inputStages": [ "21" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "3737", "startMs": "1665778688594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.007594936708860759, "waitRatioMax": 0.012658227848101266, "writeMsAvg": "20", "writeMsMax": "30", "writeRatioAvg": 0.05063291139240506, "writeRatioMax": 0.0759493670886076 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0379746835443038, "computeRatioMax": 0.0379746835443038, "endMs": "1665778688689", "id": "26", "inputStages": [ "25", "24", "18" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4250", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778688601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $200", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$180, $330", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide(divide(CAST($422 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$151 := multiply(divide(divide(CAST($423 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$152 := multiply(divide(divide(CAST($421 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$153 := divide(CAST(add(add($422, $423), $421) AS DOUBLE), 3)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$410 := $340, $411 := $341, $412 := $342, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $340 = $400" ] }, { "kind": "JOIN", "substeps": [ "$340 := $270, $341 := $170, $342 := $180", "INNER HASH JOIN EACH WITH ALL ON $270 = $330" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.010126582278481013, "waitRatioMax": 0.010126582278481013, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002531645569620253, "writeRatioMax": 0.002531645569620253 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02531645569620253, "computeRatioMax": 0.02531645569620253, "endMs": "1665778688705", "id": "27", "inputStages": [ "26" ], "name": "S1B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778688621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1A_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005063291139240506, "waitRatioMax": 0.005063291139240506, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010126582278481013, "writeRatioMax": 0.010126582278481013 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "11", "elapsedMs": "630", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "998" }, { "activeUnits": "3", "completedUnits": "519", "elapsedMs": "1335", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "23120" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "14067480", "totalPartitionsProcessed": "0", "totalSlotMs": "23120", "transferredBytes": "0" }, "startTime": "1665778687432", "totalBytesProcessed": "14067480", "totalSlotMs": "23120" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncb67a703_f12d_41ef_a280_09d3ea2b9682" }, "priority": "INTERACTIVE", "query": "-- start query 83 in stream 0 using template query83.tpl\n\n/*\nRetrieve the items with the highest number of returns where the number of returns was approximately equivalent \nacross all store, catalog and web channels (within a tolerance of +/- 10%), \nwithin the week ending a given date.\n*/\n\nwith sr_items as\n (select i_item_id item_id,\n sum(sr_return_quantity) sr_item_qty\n from store_returns,\n item,\n date_dim\n where sr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and sr_returned_date_sk = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n item,\n date_dim\n where cr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and cr_returned_date_sk = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n sum(wr_return_quantity) wr_item_qty\n from web_returns,\n item,\n date_dim\n where wr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and wr_returned_date_sk = d_date_sk\n group by i_item_id)\nselect sr_items.item_id\n ,sr_item_qty\n ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 sr_dev\n ,cr_item_qty\n ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cr_dev\n ,wr_item_qty\n ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 wr_dev\n ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n ,cr_items\n ,wr_items\n where sr_items.item_id=cr_items.item_id\n and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n ,sr_item_qty\n limit 100\n ;\n\n-- end query 83 in stream 0 using template query83.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2pHAvSm9YUTec0f92WE0Kw==", "id": "test-project-364309:europe-west1.query83_1665778690", "jobReference": { "jobId": "query83_1665778690", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query83_1665778690?location=europe-west1", "statistics": { "creationTime": "1665778691296", "endTime": "1665778692539", "finalExecutionDurationMs": "994", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14067480", "performanceInsights": { "avgPreviousExecutionMs": "766" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.035, "computeRatioMax": 0.035, "endMs": "1665778691508", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0175, "readRatioMax": 0.0175, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778691468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$141:d_week_seq, $140:d_date", "FROM date_dim", "WHERE in($140, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$141", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.055, "writeRatioMax": 0.055 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.0925, "computeRatioMax": 0.0925, "endMs": "1665778691526", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02, "readRatioMax": 0.02, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778691487", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0225, "writeRatioMax": 0.0225 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.045, "computeRatioMax": 0.045, "endMs": "1665778691556", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015, "readRatioMax": 0.015, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778691504", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:i_item_sk, $131:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.06, "writeRatioMax": 0.06 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04, "computeRatioMax": 0.04, "endMs": "1665778691585", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0175, "readRatioMax": 0.0175, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778691544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$111:d_week_seq, $110:d_date", "FROM date_dim", "WHERE in($110, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.06, "writeRatioMax": 0.06 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.1075, "computeRatioMax": 0.1075, "endMs": "1665778691600", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02, "readRatioMax": 0.02, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778691564", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0225, "writeRatioMax": 0.0225 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04, "computeRatioMax": 0.04, "endMs": "1665778691637", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015, "readRatioMax": 0.015, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778691582", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:i_item_sk, $101:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.0675, "writeRatioMax": 0.0675 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.0475, "computeRatioMax": 0.0475, "endMs": "1665778691668", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015, "readRatioMax": 0.015, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778691626", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81:d_week_seq, $80:d_date", "FROM date_dim", "WHERE in($80, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$81", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0375, "writeRatioMax": 0.0375 }, { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.1175, "computeRatioMax": 0.1175, "endMs": "1665778691703", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0275, "readRatioMax": 0.0275, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665778691646", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0375, "writeRatioMax": 0.0375 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.055, "computeRatioMax": 0.055, "endMs": "1665778691723", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.03, "readRatioMax": 0.03, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665778691664", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:i_item_sk, $71:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.055, "writeRatioMax": 0.055 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.055, "computeRatioMax": 0.055, "endMs": "1665778691778", "id": "12", "inputStages": [ "0" ], "name": "S0C: Join", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0225, "readRatioMax": 0.0225, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665778691713", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date, $51:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$141", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $50", "SEMI HASH JOIN EACH WITH ALL ON $51 = $141" ] }, { "kind": "WRITE", "substeps": [ "$300", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.0575, "writeRatioMax": 0.0575 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.0475, "computeRatioMax": 0.0475, "endMs": "1665778691789", "id": "13", "inputStages": [ "4" ], "name": "S0D: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015, "readRatioMax": 0.015, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778691734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$111", "FROM __stage04_output" ] }, { "kind": "JOIN", "substeps": [ "$240 := $30", "SEMI HASH JOIN EACH WITH ALL ON $31 = $111" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.055, "writeRatioMax": 0.055 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.06, "computeRatioMax": 0.06, "endMs": "1665778691812", "id": "14", "inputStages": [ "8" ], "name": "S0E: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0175, "readRatioMax": 0.0175, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778691752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$81", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $10", "SEMI HASH JOIN EACH WITH ALL ON $11 = $81" ] }, { "kind": "WRITE", "substeps": [ "$370", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.0575, "writeRatioMax": 0.0575 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.0225, "computeRatioMax": 0.0475, "endMs": "1665778691860", "id": "15", "inputStages": [ "12" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "4419", "startMs": "1665778691783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005, "waitRatioMax": 0.01, "writeMsAvg": "23", "writeMsMax": "31", "writeRatioAvg": 0.0575, "writeRatioMax": 0.0775 }, { "completedParallelInputs": "1", "computeMsAvg": "187", "computeMsMax": "187", "computeRatioAvg": 0.4675, "computeRatioMax": 0.4675, "endMs": "1665778691991", "id": "16", "inputStages": [ "1", "2", "15" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0325, "readRatioMax": 0.0325, "recordsRead": "235137", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "197", "startMs": "1665778691791", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cr_returned_date_sk, $121:cr_item_sk, $122:cr_return_quantity", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$300", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $311", "$210 := SUM($310)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291", "SEMI HASH JOIN EACH WITH ALL ON $292 = $300" ] }, { "kind": "JOIN", "substeps": [ "$290 := $281, $291 := $282, $292 := $41", "INNER HASH JOIN EACH WITH ALL ON $280 = $40" ] }, { "kind": "JOIN", "substeps": [ "$280 := $120, $281 := $122, $282 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$320, $210", "TO __stage10_output", "BY HASH($320)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0125, "writeRatioMax": 0.0125 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.0225, "computeRatioMax": 0.045, "endMs": "1665778691866", "id": "17", "inputStages": [ "13" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "4277", "startMs": "1665778691806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005, "waitRatioMax": 0.0075, "writeMsAvg": "27", "writeMsMax": "33", "writeRatioAvg": 0.0675, "writeRatioMax": 0.0825 }, { "completedParallelInputs": "1", "computeMsAvg": "400", "computeMsMax": "400", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778692165", "id": "18", "inputStages": [ "5", "17", "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0325, "readRatioMax": 0.0325, "recordsRead": "378584", "recordsWritten": "2276", "shuffleOutputBytes": "68032", "shuffleOutputBytesSpilled": "0", "slotMs": "421", "startMs": "1665778691815", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:sr_returned_date_sk, $91:sr_item_sk, $92:sr_return_quantity", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$240", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $251", "$200 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $230, $251 := $231", "SEMI HASH JOIN EACH WITH ALL ON $232 = $240" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $220 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $90, $221 := $92, $222 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$260, $200", "TO __stage12_output", "BY HASH($260)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.0725, "writeRatioMax": 0.0725 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.0225, "computeRatioMax": 0.055, "endMs": "1665778691882", "id": "19", "inputStages": [ "14" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "4175", "startMs": "1665778691825", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "4", "waitMsMax": "9", "waitRatioAvg": 0.01, "waitRatioMax": 0.0225, "writeMsAvg": "25", "writeMsMax": "31", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0775 }, { "completedParallelInputs": "1", "computeMsAvg": "86", "computeMsMax": "86", "computeRatioAvg": 0.215, "computeRatioMax": 0.215, "endMs": "1665778691960", "id": "20", "inputStages": [ "10", "9", "19" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0225, "readRatioMax": 0.0225, "recordsRead": "162833", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "98", "startMs": "1665778691843", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_returned_date_sk, $61:wr_item_sk, $62:wr_return_quantity", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361", "SEMI HASH JOIN EACH WITH ALL ON $362 = $370" ] }, { "kind": "JOIN", "substeps": [ "$360 := $351, $361 := $352, $362 := $2", "INNER HASH JOIN EACH WITH ALL ON $350 = $1" ] }, { "kind": "JOIN", "substeps": [ "$350 := $60, $351 := $62, $352 := $71", "INNER HASH JOIN EACH WITH ALL ON $61 = $70" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage14_output", "BY HASH($390)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01, "writeRatioMax": 0.01 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015, "computeRatioMax": 0.015, "endMs": "1665778692302", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778692239", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.135, "writeRatioMax": 0.135 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0325, "computeRatioMax": 0.0325, "endMs": "1665778692292", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778692257", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $210", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $330", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0025, "waitRatioMax": 0.0025, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.0225, "computeRatioMax": 0.0575, "endMs": "1665778692360", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "3639", "startMs": "1665778692297", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005, "waitRatioMax": 0.01, "writeMsAvg": "18", "writeMsMax": "31", "writeRatioAvg": 0.045, "writeRatioMax": 0.0775 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.02, "computeRatioMax": 0.0375, "endMs": "1665778692380", "id": "26", "inputStages": [ "21" ], "name": "S1A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "3528", "startMs": "1665778692319", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0075, "waitRatioMax": 0.01, "writeMsAvg": "16", "writeMsMax": "21", "writeRatioAvg": 0.04, "writeRatioMax": 0.0525 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04, "computeRatioMax": 0.04, "endMs": "1665778692396", "id": "27", "inputStages": [ "24", "18", "26" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4250", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665778692325", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $200", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$180, $330", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage1A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide(divide(CAST($422 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$151 := multiply(divide(divide(CAST($423 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$152 := multiply(divide(divide(CAST($421 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$153 := divide(CAST(add(add($422, $423), $421) AS DOUBLE), 3)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$410 := $340, $411 := $341, $412 := $342, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $340 = $400" ] }, { "kind": "JOIN", "substeps": [ "$340 := $270, $341 := $170, $342 := $180", "INNER HASH JOIN EACH WITH ALL ON $270 = $330" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0075, "writeRatioMax": 0.0075 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0525, "computeRatioMax": 0.0525, "endMs": "1665778692426", "id": "28", "inputStages": [ "27" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778692342", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1B_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0075, "waitRatioMax": 0.0075, "writeMsAvg": "34", "writeMsMax": "34", "writeRatioAvg": 0.085, "writeRatioMax": 0.085 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "313", "elapsedMs": "619", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "14043" }, { "activeUnits": "2", "completedUnits": "519", "elapsedMs": "1117", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "21856" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "14067480", "totalPartitionsProcessed": "0", "totalSlotMs": "21856", "transferredBytes": "0" }, "startTime": "1665778691351", "totalBytesProcessed": "14067480", "totalSlotMs": "21856" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4974f49f_a53a_479b_bb12_945a78a6e294" }, "priority": "INTERACTIVE", "query": "-- start query 83 in stream 0 using template query83.tpl\n\n/*\nRetrieve the items with the highest number of returns where the number of returns was approximately equivalent \nacross all store, catalog and web channels (within a tolerance of +/- 10%), \nwithin the week ending a given date.\n*/\n\nwith sr_items as\n (select i_item_id item_id,\n sum(sr_return_quantity) sr_item_qty\n from store_returns,\n item,\n date_dim\n where sr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and sr_returned_date_sk = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n item,\n date_dim\n where cr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t where d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and cr_returned_date_sk = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n sum(wr_return_quantity) wr_item_qty\n from web_returns,\n item,\n date_dim\n where wr_item_sk = i_item_sk\n and d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('2000-11-17','2000-09-27','2000-06-30')))\n and wr_returned_date_sk = d_date_sk\n group by i_item_id)\nselect sr_items.item_id\n ,sr_item_qty\n ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 sr_dev\n ,cr_item_qty\n ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 cr_dev\n ,wr_item_qty\n ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp 100 wr_dev\n ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n ,cr_items\n ,wr_items\n where sr_items.item_id=cr_items.item_id\n and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n ,sr_item_qty\n limit 100\n ;\n\n-- end query 83 in stream 0 using template query83.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "7ZlpLd+4lqsmp3A8n2UAig==", "id": "test-project-364309:europe-west1.query83_1665778693", "jobReference": { "jobId": "query83_1665778693", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query83_1665778693?location=europe-west1", "statistics": { "creationTime": "1665778694323", "endTime": "1665778695283", "finalExecutionDurationMs": "725", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14067480", "performanceInsights": { "avgPreviousExecutionMs": "792" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05188679245283019, "computeRatioMax": 0.05188679245283019, "endMs": "1665778694543", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02830188679245283, "readRatioMax": 0.02830188679245283, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778694501", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$141:d_week_seq, $140:d_date", "FROM date_dim", "WHERE in($140, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$141", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05660377358490566, "writeRatioMax": 0.05660377358490566 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.14622641509433962, "computeRatioMax": 0.14622641509433962, "endMs": "1665778694554", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0330188679245283, "readRatioMax": 0.0330188679245283, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778694517", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05188679245283019, "writeRatioMax": 0.05188679245283019 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.08018867924528301, "computeRatioMax": 0.08018867924528301, "endMs": "1665778694579", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0330188679245283, "readRatioMax": 0.0330188679245283, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778694534", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:i_item_sk, $131:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.12264150943396226, "writeRatioMax": 0.12264150943396226 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05188679245283019, "computeRatioMax": 0.05188679245283019, "endMs": "1665778694609", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02830188679245283, "readRatioMax": 0.02830188679245283, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778694572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$111:d_week_seq, $110:d_date", "FROM date_dim", "WHERE in($110, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$111", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03773584905660377, "writeRatioMax": 0.03773584905660377 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.21226415094339623, "computeRatioMax": 0.21226415094339623, "endMs": "1665778694632", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0330188679245283, "readRatioMax": 0.0330188679245283, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778694587", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05660377358490566, "writeRatioMax": 0.05660377358490566 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.1320754716981132, "computeRatioMax": 0.1320754716981132, "endMs": "1665778694654", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02830188679245283, "readRatioMax": 0.02830188679245283, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778694604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:i_item_sk, $101:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.12264150943396226, "writeRatioMax": 0.12264150943396226 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.08490566037735849, "computeRatioMax": 0.08490566037735849, "endMs": "1665778694690", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04716981132075472, "readRatioMax": 0.04716981132075472, "recordsRead": "73049", "recordsWritten": "3", "shuffleOutputBytes": "27", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778694642", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$81:d_week_seq, $80:d_date", "FROM date_dim", "WHERE in($80, 11278, 11227, 11138)" ] }, { "kind": "WRITE", "substeps": [ "$81", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03773584905660377, "writeRatioMax": 0.03773584905660377 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.1509433962264151, "computeRatioMax": 0.1509433962264151, "endMs": "1665778694695", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0330188679245283, "readRatioMax": 0.0330188679245283, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "1022686", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778694658", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_date", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04716981132075472, "writeRatioMax": 0.04716981132075472 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.1179245283018868, "computeRatioMax": 0.1179245283018868, "endMs": "1665778694742", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0330188679245283, "readRatioMax": 0.0330188679245283, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778694682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:i_item_sk, $71:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "37", "writeMsMax": "37", "writeRatioAvg": 0.17452830188679244, "writeRatioMax": 0.17452830188679244 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.07075471698113207, "computeRatioMax": 0.07075471698113207, "endMs": "1665778694785", "id": "12", "inputStages": [ "0" ], "name": "S0C: Join", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.05188679245283019, "readRatioMax": 0.05188679245283019, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778694737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date, $51:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$141", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $50", "SEMI HASH JOIN EACH WITH ALL ON $51 = $141" ] }, { "kind": "WRITE", "substeps": [ "$300", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.09905660377358491, "writeRatioMax": 0.09905660377358491 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.07075471698113207, "computeRatioMax": 0.07075471698113207, "endMs": "1665778694807", "id": "13", "inputStages": [ "4" ], "name": "S0D: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02830188679245283, "readRatioMax": 0.02830188679245283, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778694758", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date, $31:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$111", "FROM __stage04_output" ] }, { "kind": "JOIN", "substeps": [ "$240 := $30", "SEMI HASH JOIN EACH WITH ALL ON $31 = $111" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.10849056603773585, "writeRatioMax": 0.10849056603773585 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.1179245283018868, "computeRatioMax": 0.1179245283018868, "endMs": "1665778694824", "id": "14", "inputStages": [ "8" ], "name": "S0E: Join", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.04245283018867924, "readRatioMax": 0.04245283018867924, "recordsRead": "73052", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778694774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date, $11:d_week_seq", "FROM date_dim" ] }, { "kind": "READ", "substeps": [ "$81", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $10", "SEMI HASH JOIN EACH WITH ALL ON $11 = $81" ] }, { "kind": "WRITE", "substeps": [ "$370", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.10849056603773585, "writeRatioMax": 0.10849056603773585 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.03773584905660377, "computeRatioMax": 0.08018867924528301, "endMs": "1665778694872", "id": "15", "inputStages": [ "12" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3410", "startMs": "1665778694800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.02358490566037736, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.07075471698113207, "writeRatioMax": 0.14622641509433962 }, { "completedParallelInputs": "1", "computeMsAvg": "80", "computeMsMax": "80", "computeRatioAvg": 0.37735849056603776, "computeRatioMax": 0.37735849056603776, "endMs": "1665778694942", "id": "16", "inputStages": [ "1", "2", "15" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0330188679245283, "readRatioMax": 0.0330188679245283, "recordsRead": "235137", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665778694807", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cr_returned_date_sk, $121:cr_item_sk, $122:cr_return_quantity", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$300", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $311", "$210 := SUM($310)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291", "SEMI HASH JOIN EACH WITH ALL ON $292 = $300" ] }, { "kind": "JOIN", "substeps": [ "$290 := $281, $291 := $282, $292 := $41", "INNER HASH JOIN EACH WITH ALL ON $280 = $40" ] }, { "kind": "JOIN", "substeps": [ "$280 := $120, $281 := $122, $282 := $131", "INNER HASH JOIN EACH WITH ALL ON $121 = $130" ] }, { "kind": "WRITE", "substeps": [ "$320, $210", "TO __stage10_output", "BY HASH($320)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.014150943396226415, "waitRatioMax": 0.014150943396226415, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.018867924528301886, "writeRatioMax": 0.018867924528301886 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.03773584905660377, "computeRatioMax": 0.08018867924528301, "endMs": "1665778694873", "id": "17", "inputStages": [ "13" ], "name": "S11: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3284", "startMs": "1665778694812", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.014150943396226415, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.0660377358490566, "writeRatioMax": 0.09433962264150944 }, { "completedParallelInputs": "1", "computeMsAvg": "212", "computeMsMax": "212", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778694953", "id": "18", "inputStages": [ "5", "17", "6" ], "name": "S12: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.04245283018867924, "readRatioMax": 0.04245283018867924, "recordsRead": "378584", "recordsWritten": "2276", "shuffleOutputBytes": "68032", "shuffleOutputBytesSpilled": "0", "slotMs": "203", "startMs": "1665778694816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:sr_returned_date_sk, $91:sr_item_sk, $92:sr_return_quantity", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$240", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $251", "$200 := SUM($250)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $230, $251 := $231", "SEMI HASH JOIN EACH WITH ALL ON $232 = $240" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $222, $232 := $21", "INNER HASH JOIN EACH WITH ALL ON $220 = $20" ] }, { "kind": "JOIN", "substeps": [ "$220 := $90, $221 := $92, $222 := $101", "INNER HASH JOIN EACH WITH ALL ON $91 = $100" ] }, { "kind": "WRITE", "substeps": [ "$260, $200", "TO __stage12_output", "BY HASH($260)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.02358490566037736, "writeRatioMax": 0.02358490566037736 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.03773584905660377, "computeRatioMax": 0.08018867924528301, "endMs": "1665778694911", "id": "19", "inputStages": [ "14" ], "name": "S13: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "3616", "startMs": "1665778694846", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.014150943396226415, "waitRatioMax": 0.02830188679245283, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.07075471698113207, "writeRatioMax": 0.1320754716981132 }, { "completedParallelInputs": "1", "computeMsAvg": "99", "computeMsMax": "99", "computeRatioAvg": 0.4669811320754717, "computeRatioMax": 0.4669811320754717, "endMs": "1665778694996", "id": "20", "inputStages": [ "19", "9", "10" ], "name": "S14: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03773584905660377, "readRatioMax": 0.03773584905660377, "recordsRead": "162833", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665778694861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:wr_returned_date_sk, $61:wr_item_sk, $62:wr_return_quantity", "FROM web_returns" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $381", "$190 := SUM($380)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361", "SEMI HASH JOIN EACH WITH ALL ON $362 = $370" ] }, { "kind": "JOIN", "substeps": [ "$360 := $351, $361 := $352, $362 := $2", "INNER HASH JOIN EACH WITH ALL ON $350 = $1" ] }, { "kind": "JOIN", "substeps": [ "$350 := $60, $351 := $62, $352 := $71", "INNER HASH JOIN EACH WITH ALL ON $61 = $70" ] }, { "kind": "WRITE", "substeps": [ "$390, $190", "TO __stage14_output", "BY HASH($390)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.014150943396226415, "waitRatioMax": 0.014150943396226415, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0330188679245283, "writeRatioMax": 0.0330188679245283 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05188679245283019, "computeRatioMax": 0.05188679245283019, "endMs": "1665778695059", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778695022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$390, $190", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $390", "$160 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$160, $400", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07547169811320754, "writeRatioMax": 0.07547169811320754 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03773584905660377, "computeRatioMax": 0.03773584905660377, "endMs": "1665778695074", "id": "22", "inputStages": [ "16" ], "name": "S16: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778695039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $210", "FROM __stage10_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$180 := SUM($210)" ] }, { "kind": "WRITE", "substeps": [ "$180, $330", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009433962264150943, "waitRatioMax": 0.009433962264150943, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.12264150943396226, "writeRatioMax": 0.12264150943396226 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.03773584905660377, "computeRatioMax": 0.07075471698113207, "endMs": "1665778695140", "id": "24", "inputStages": [ "22" ], "name": "S18: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1292", "recordsWritten": "1292", "shuffleOutputBytes": "38560", "shuffleOutputBytesSpilled": "0", "slotMs": "3412", "startMs": "1665778695082", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage16_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.014150943396226415, "waitRatioMax": 0.0330188679245283, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.07075471698113207, "writeRatioMax": 0.08962264150943396 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.03773584905660377, "computeRatioMax": 0.08962264150943396, "endMs": "1665778695142", "id": "25", "inputStages": [ "21" ], "name": "S19: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "682", "recordsWritten": "682", "shuffleOutputBytes": "20324", "shuffleOutputBytesSpilled": "0", "slotMs": "3346", "startMs": "1665778695082", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage15_output" ] } ], "waitMsAvg": "7", "waitMsMax": "10", "waitRatioAvg": 0.0330188679245283, "waitRatioMax": 0.04716981132075472, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.07075471698113207, "writeRatioMax": 0.14150943396226415 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0330188679245283, "computeRatioMax": 0.0330188679245283, "endMs": "1665778695163", "id": "26", "inputStages": [ "25", "24", "18" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4250", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665778695095", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $200", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$180, $330", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$160, $400", "FROM __stage19_output" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := multiply(divide(divide(CAST($422 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$151 := multiply(divide(divide(CAST($423 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$152 := multiply(divide(divide(CAST($421 AS DOUBLE), CAST(add(add($422, $423), $421) AS DOUBLE)), 3), 100)", "$153 := divide(CAST(add(add($422, $423), $421) AS DOUBLE), 3)" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$410 := $340, $411 := $341, $412 := $342, $413 := $160", "INNER HASH JOIN EACH WITH ALL ON $340 = $400" ] }, { "kind": "JOIN", "substeps": [ "$340 := $270, $341 := $170, $342 := $180", "INNER HASH JOIN EACH WITH ALL ON $270 = $330" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "TO __stage1A_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.05188679245283019, "waitRatioMax": 0.05188679245283019, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0047169811320754715, "writeRatioMax": 0.0047169811320754715 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04245283018867924, "computeRatioMax": 0.04245283018867924, "endMs": "1665778695172", "id": "27", "inputStages": [ "26" ], "name": "S1B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21", "recordsWritten": "21", "shuffleOutputBytes": "1764", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778695102", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$420, $150, $151, $152, $153, $421, $422, $423", "FROM __stage1A_output" ] }, { "kind": "SORT", "substeps": [ "$420 ASC, $422 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432, $433, $434, $435, $436, $437", "TO __stage1B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.018867924528301886, "waitRatioMax": 0.018867924528301886, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02830188679245283, "writeRatioMax": 0.02830188679245283 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "315", "elapsedMs": "631", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11296" }, { "activeUnits": "0", "completedUnits": "519", "elapsedMs": "865", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "18135" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "14067480", "totalPartitionsProcessed": "0", "totalSlotMs": "18135", "transferredBytes": "0" }, "startTime": "1665778694371", "totalBytesProcessed": "14067480", "totalSlotMs": "18135" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
