{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon99cc0b6a_bec1_4011_b331_718115d86391" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_quantity) as store_sales_quantity\n ,sum(sr_return_quantity) as store_returns_quantity\n ,sum(cs_quantity) as catalog_sales_quantity\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 9 \n and d1.d_year = 1999\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 9 and 9 + 3 \n and d2.d_year = 1999\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk \n and d3.d_year in (1999,1999+1,1999+2)\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id \n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "jn3zqe9EsbOsweGSwXnOug==", "id": "test-project-364309:europe-west1.query29_1665768307", "jobReference": { "jobId": "query29_1665768307", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query29_1665768307?location=europe-west1", "statistics": { "creationTime": "1665768307687", "endTime": "1665768310113", "finalExecutionDurationMs": "2170", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "195379527", "performanceInsights": { "avgPreviousExecutionMs": "1962" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "87", "computeMsMax": "87", "computeRatioAvg": 0.03851261620185923, "computeRatioMax": 0.03851261620185923, "endMs": "1665768307952", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.005312084993359893, "readRatioMax": 0.005312084993359893, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665768307876", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008853474988933156, "waitRatioMax": 0.0008853474988933156, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.005312084993359893, "writeRatioMax": 0.005312084993359893 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.00619743249225321, "computeRatioMax": 0.00619743249225321, "endMs": "1665768307937", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0026560424966799467, "readRatioMax": 0.0026560424966799467, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768307891", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008853474988933156, "waitRatioMax": 0.0008853474988933156, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.007525453740593183, "writeRatioMax": 0.007525453740593183 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.004869411243913236, "computeRatioMax": 0.004869411243913236, "endMs": "1665768307951", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.00619743249225321, "readRatioMax": 0.00619743249225321, "recordsRead": "73049", "recordsWritten": "1096", "shuffleOutputBytes": "9864", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768307906", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE in($21, 1999, 2000, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004426737494466578, "waitRatioMax": 0.0004426737494466578, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.009738822487826471, "writeRatioMax": 0.009738822487826471 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.00619743249225321, "computeRatioMax": 0.00619743249225321, "endMs": "1665768307961", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0026560424966799467, "readRatioMax": 0.0026560424966799467, "recordsRead": "73049", "recordsWritten": "122", "shuffleOutputBytes": "1098", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768307922", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 9, 12), equal($31, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004426737494466578, "waitRatioMax": 0.0004426737494466578, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.005312084993359893, "writeRatioMax": 0.005312084993359893 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.013280212483399735, "computeRatioMax": 0.013280212483399735, "endMs": "1665768308031", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.00619743249225321, "readRatioMax": 0.00619743249225321, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "121", "startMs": "1665768307938", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 9), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004426737494466578, "waitRatioMax": 0.0004426737494466578, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.02390438247011952, "writeRatioMax": 0.02390438247011952 }, { "completedParallelInputs": "5", "computeMsAvg": "259", "computeMsMax": "348", "computeRatioAvg": 0.11465250110668437, "computeRatioMax": 0.15405046480743692, "endMs": "1665768308150", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "18", "readMsMax": "23", "readRatioAvg": 0.00796812749003984, "readRatioMax": 0.01018149623727313, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1326", "startMs": "1665768307951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0004426737494466578, "waitRatioMax": 0.0008853474988933156, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.00619743249225321, "writeRatioMax": 0.007525453740593183 }, { "completedParallelInputs": "1", "computeMsAvg": "538", "computeMsMax": "538", "computeRatioAvg": 0.2381584772023019, "computeRatioMax": 0.2381584772023019, "endMs": "1665768308476", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "43", "readMsMax": "43", "readRatioAvg": 0.019034971226206288, "readRatioMax": 0.019034971226206288, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "853", "startMs": "1665768307966", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008853474988933156, "waitRatioMax": 0.0008853474988933156, "writeMsAvg": "55", "writeMsMax": "55", "writeRatioAvg": 0.02434705621956618, "writeRatioMax": 0.02434705621956618 }, { "completedParallelInputs": "6", "computeMsAvg": "1998", "computeMsMax": "2259", "computeRatioAvg": 0.8844621513944223, "computeRatioMax": 1, "endMs": "1665768309946", "id": "8", "inputStages": [ "6", "3", "1", "4", "0", "5", "2" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.006640106241699867, "readRatioMax": 0.00796812749003984, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "10660", "startMs": "1665768308508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $185, $191 := $186, $192 := $180, $193 := $181", "$90 := SUM($183)", "$91 := SUM($184)", "$92 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $174, $181 := $175, $182 := $170, $183 := $172, $184 := $173, $185 := $2, $186 := $3", "INNER HASH JOIN EACH WITH ALL ON $171 = $1" ] }, { "kind": "JOIN", "substeps": [ "$170 := $160, $171 := $161, $172 := $163, $173 := $164, $174 := $11, $175 := $12", "INNER HASH JOIN EACH WITH ALL ON $162 = $10" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $153, $163 := $154, $164 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008853474988933156, "waitRatioMax": 0.0008853474988933156, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0017706949977866313, "writeRatioMax": 0.0017706949977866313 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.002213368747233289, "computeRatioMax": 0.002213368747233289, "endMs": "1665768309964", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665768309955", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$200 ASC, $201 ASC, $202 ASC, $203 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008853474988933156, "waitRatioMax": 0.0008853474988933156, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.00398406374501992, "computeRatioMax": 0.00398406374501992, "endMs": "1665768310004", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768309970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004426737494466578, "waitRatioMax": 0.0004426737494466578, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.011066843736166445, "writeRatioMax": 0.011066843736166445 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "14", "elapsedMs": "632", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "4293" }, { "activeUnits": "6", "completedUnits": "16", "elapsedMs": "2086", "estimatedRunnableUnits": "6", "pendingUnits": "1", "totalSlotMs": "15975" }, { "activeUnits": "2", "completedUnits": "19", "elapsedMs": "2300", "estimatedRunnableUnits": "6", "pendingUnits": "0", "totalSlotMs": "16308" } ], "totalBytesBilled": "196083712", "totalBytesProcessed": "195379527", "totalPartitionsProcessed": "0", "totalSlotMs": "16308", "transferredBytes": "0" }, "startTime": "1665768307745", "totalBytesProcessed": "195379527", "totalSlotMs": "16308" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone16b1d14_f3ec_424d_8b1a_68077c1624c0" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_quantity) as store_sales_quantity\n ,sum(sr_return_quantity) as store_returns_quantity\n ,sum(cs_quantity) as catalog_sales_quantity\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 9 \n and d1.d_year = 1999\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 9 and 9 + 3 \n and d2.d_year = 1999\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk \n and d3.d_year in (1999,1999+1,1999+2)\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id \n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NPK9A/gghx7T6MYZdiBUAw==", "id": "test-project-364309:europe-west1.query29_1665777229", "jobReference": { "jobId": "query29_1665777229", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query29_1665777229?location=europe-west1", "statistics": { "creationTime": "1665777230184", "endTime": "1665777232665", "finalExecutionDurationMs": "2234", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "195379527", "performanceInsights": { "avgPreviousExecutionMs": "2031" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "73", "computeMsMax": "73", "computeRatioAvg": 0.02923508209851822, "computeRatioMax": 0.02923508209851822, "endMs": "1665777230467", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0032038446135362435, "readRatioMax": 0.0032038446135362435, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "99", "startMs": "1665777230381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.004405286343612335, "writeRatioMax": 0.004405286343612335 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.004004805766920304, "computeRatioMax": 0.004004805766920304, "endMs": "1665777230437", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0024028834601521826, "readRatioMax": 0.0024028834601521826, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777230398", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.006007208650380457, "writeRatioMax": 0.006007208650380457 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.004004805766920304, "computeRatioMax": 0.004004805766920304, "endMs": "1665777230457", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0024028834601521826, "readRatioMax": 0.0024028834601521826, "recordsRead": "73049", "recordsWritten": "1096", "shuffleOutputBytes": "9864", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777230414", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE in($21, 1999, 2000, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.006407689227072487, "writeRatioMax": 0.006407689227072487 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.004805766920304365, "computeRatioMax": 0.004805766920304365, "endMs": "1665777230467", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0032038446135362435, "readRatioMax": 0.0032038446135362435, "recordsRead": "73049", "recordsWritten": "122", "shuffleOutputBytes": "1098", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777230428", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 9, 12), equal($31, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.003604325190228274, "writeRatioMax": 0.003604325190228274 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.004004805766920304, "computeRatioMax": 0.004004805766920304, "endMs": "1665777230487", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002803364036844213, "readRatioMax": 0.002803364036844213, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777230444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 9), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.006007208650380457, "writeRatioMax": 0.006007208650380457 }, { "completedParallelInputs": "5", "computeMsAvg": "224", "computeMsMax": "241", "computeRatioAvg": 0.08970764917901482, "computeRatioMax": 0.09651581898277933, "endMs": "1665777230643", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "18", "readMsMax": "24", "readRatioAvg": 0.007208650380456548, "readRatioMax": 0.00961153384060873, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1085", "startMs": "1665777230458", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.005606728073688426, "writeRatioMax": 0.007208650380456548 }, { "completedParallelInputs": "1", "computeMsAvg": "213", "computeMsMax": "213", "computeRatioAvg": 0.08530236283540249, "computeRatioMax": 0.08530236283540249, "endMs": "1665777230672", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.005206247496996396, "readRatioMax": 0.005206247496996396, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665777230473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.006808169803764518, "writeRatioMax": 0.006808169803764518 }, { "completedParallelInputs": "6", "computeMsAvg": "2016", "computeMsMax": "2497", "computeRatioAvg": 0.8073688426111334, "computeRatioMax": 1, "endMs": "1665777232521", "id": "8", "inputStages": [ "4", "6", "3", "1", "5", "2", "0" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "26", "readRatioAvg": 0.006808169803764518, "readRatioMax": 0.010412494993992792, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "12855", "startMs": "1665777230678", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $185, $191 := $186, $192 := $180, $193 := $181", "$90 := SUM($183)", "$91 := SUM($184)", "$92 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $174, $181 := $175, $182 := $170, $183 := $172, $184 := $173, $185 := $2, $186 := $3", "INNER HASH JOIN EACH WITH ALL ON $171 = $1" ] }, { "kind": "JOIN", "substeps": [ "$170 := $160, $171 := $161, $172 := $163, $173 := $164, $174 := $11, $175 := $12", "INNER HASH JOIN EACH WITH ALL ON $162 = $10" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $153, $163 := $154, $164 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.002002402883460152, "writeRatioMax": 0.0024028834601521826 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0032038446135362435, "computeRatioMax": 0.0032038446135362435, "endMs": "1665777232537", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665777232526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$200 ASC, $201 ASC, $202 ASC, $203 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00040048057669203043, "writeRatioMax": 0.00040048057669203043 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.004805766920304365, "computeRatioMax": 0.004805766920304365, "endMs": "1665777232577", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777232540", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00040048057669203043, "waitRatioMax": 0.00040048057669203043, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.006007208650380457, "writeRatioMax": 0.006007208650380457 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "637", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2010" }, { "activeUnits": "2", "completedUnits": "19", "elapsedMs": "2365", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14456" } ], "totalBytesBilled": "196083712", "totalBytesProcessed": "195379527", "totalPartitionsProcessed": "0", "totalSlotMs": "14456", "transferredBytes": "0" }, "startTime": "1665777230245", "totalBytesProcessed": "195379527", "totalSlotMs": "14456" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon37891abe_2cf9_437c_a95d_55e58c88d29c" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_quantity) as store_sales_quantity\n ,sum(sr_return_quantity) as store_returns_quantity\n ,sum(cs_quantity) as catalog_sales_quantity\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 9 \n and d1.d_year = 1999\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 9 and 9 + 3 \n and d2.d_year = 1999\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk \n and d3.d_year in (1999,1999+1,1999+2)\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id \n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Q5WFiEmGfVYzgO24Wf0ZqQ==", "id": "test-project-364309:europe-west1.query29_1665777234", "jobReference": { "jobId": "query29_1665777234", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query29_1665777234?location=europe-west1", "statistics": { "creationTime": "1665777235334", "endTime": "1665777237709", "finalExecutionDurationMs": "2129", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "195379527", "performanceInsights": { "avgPreviousExecutionMs": "2082" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "53", "computeMsMax": "53", "computeRatioAvg": 0.019258720930232558, "computeRatioMax": 0.019258720930232558, "endMs": "1665777235577", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0032703488372093025, "readRatioMax": 0.0032703488372093025, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665777235518", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0003633720930232558, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.003997093023255814, "writeRatioMax": 0.003997093023255814 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.001816860465116279, "computeRatioMax": 0.001816860465116279, "endMs": "1665777235570", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0010901162790697674, "readRatioMax": 0.0010901162790697674, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777235532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0003633720930232558, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.006540697674418605, "writeRatioMax": 0.006540697674418605 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.003633720930232558, "computeRatioMax": 0.003633720930232558, "endMs": "1665777235575", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002180232558139535, "readRatioMax": 0.002180232558139535, "recordsRead": "73049", "recordsWritten": "1096", "shuffleOutputBytes": "9864", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777235546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE in($21, 1999, 2000, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0003633720930232558, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005087209302325582, "writeRatioMax": 0.005087209302325582 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0032703488372093025, "computeRatioMax": 0.0032703488372093025, "endMs": "1665777235590", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002180232558139535, "readRatioMax": 0.002180232558139535, "recordsRead": "73049", "recordsWritten": "122", "shuffleOutputBytes": "1098", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777235559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 9, 12), equal($31, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0003633720930232558, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.005813953488372093, "writeRatioMax": 0.005813953488372093 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.003633720930232558, "computeRatioMax": 0.003633720930232558, "endMs": "1665777235616", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002180232558139535, "readRatioMax": 0.002180232558139535, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777235573", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 9), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0003633720930232558, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.005450581395348837, "writeRatioMax": 0.005450581395348837 }, { "completedParallelInputs": "5", "computeMsAvg": "287", "computeMsMax": "347", "computeRatioAvg": 0.10428779069767442, "computeRatioMax": 0.12609011627906977, "endMs": "1665777235797", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.005813953488372093, "readRatioMax": 0.007267441860465116, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1189", "startMs": "1665777235587", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.005450581395348837, "writeRatioMax": 0.007630813953488372 }, { "completedParallelInputs": "1", "computeMsAvg": "275", "computeMsMax": "275", "computeRatioAvg": 0.09992732558139535, "computeRatioMax": 0.09992732558139535, "endMs": "1665777235818", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.005813953488372093, "readRatioMax": 0.005813953488372093, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "301", "startMs": "1665777235603", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0003633720930232558, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.007630813953488372, "writeRatioMax": 0.007630813953488372 }, { "completedParallelInputs": "6", "computeMsAvg": "2456", "computeMsMax": "2752", "computeRatioAvg": 0.8924418604651163, "computeRatioMax": 1, "endMs": "1665777237538", "id": "8", "inputStages": [ "3", "5", "4", "2", "1", "0", "6" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "28", "readRatioAvg": 0.007267441860465116, "readRatioMax": 0.010174418604651164, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "12094", "startMs": "1665777235870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $185, $191 := $186, $192 := $180, $193 := $181", "$90 := SUM($183)", "$91 := SUM($184)", "$92 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $174, $181 := $175, $182 := $170, $183 := $172, $184 := $173, $185 := $2, $186 := $3", "INNER HASH JOIN EACH WITH ALL ON $171 = $1" ] }, { "kind": "JOIN", "substeps": [ "$170 := $160, $171 := $161, $172 := $163, $173 := $164, $174 := $11, $175 := $12", "INNER HASH JOIN EACH WITH ALL ON $162 = $10" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $153, $163 := $154, $164 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.002180232558139535, "writeRatioMax": 0.0032703488372093025 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.001816860465116279, "computeRatioMax": 0.001816860465116279, "endMs": "1665777237569", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665777237560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$200 ASC, $201 ASC, $202 ASC, $203 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003633720930232558, "waitRatioMax": 0.0003633720930232558, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.00436046511627907, "computeRatioMax": 0.00436046511627907, "endMs": "1665777237614", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777237577", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.005450581395348837, "writeRatioMax": 0.005450581395348837 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "629", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2390" }, { "activeUnits": "6", "completedUnits": "19", "elapsedMs": "2261", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14447" } ], "totalBytesBilled": "196083712", "totalBytesProcessed": "195379527", "totalPartitionsProcessed": "0", "totalSlotMs": "14447", "transferredBytes": "0" }, "startTime": "1665777235391", "totalBytesProcessed": "195379527", "totalSlotMs": "14447" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon64f78862_acbb_4601_9ba9_fea523081296" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_quantity) as store_sales_quantity\n ,sum(sr_return_quantity) as store_returns_quantity\n ,sum(cs_quantity) as catalog_sales_quantity\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 9 \n and d1.d_year = 1999\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 9 and 9 + 3 \n and d2.d_year = 1999\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk \n and d3.d_year in (1999,1999+1,1999+2)\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id \n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "c8G681A7UvnDBIbyScRaJg==", "id": "test-project-364309:europe-west1.query29_1665777238", "jobReference": { "jobId": "query29_1665777238", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query29_1665777238?location=europe-west1", "statistics": { "creationTime": "1665777239267", "endTime": "1665777241511", "finalExecutionDurationMs": "2011", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "195379527", "performanceInsights": { "avgPreviousExecutionMs": "2091" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "59", "computeMsMax": "59", "computeRatioAvg": 0.02301989855637924, "computeRatioMax": 0.02301989855637924, "endMs": "1665777239540", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.006242684354272337, "readRatioMax": 0.006242684354272337, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "89", "startMs": "1665777239450", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.004291845493562232, "writeRatioMax": 0.004291845493562232 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0027311744049941474, "computeRatioMax": 0.0027311744049941474, "endMs": "1665777239503", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0011705033164260631, "readRatioMax": 0.0011705033164260631, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777239462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.006632852126414358, "writeRatioMax": 0.006632852126414358 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.00351150994927819, "computeRatioMax": 0.00351150994927819, "endMs": "1665777239516", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0023410066328521262, "readRatioMax": 0.0023410066328521262, "recordsRead": "73049", "recordsWritten": "1096", "shuffleOutputBytes": "9864", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777239478", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE in($21, 1999, 2000, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.00351150994927819, "writeRatioMax": 0.00351150994927819 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.004291845493562232, "computeRatioMax": 0.004291845493562232, "endMs": "1665777239534", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0031213421771361686, "readRatioMax": 0.0031213421771361686, "recordsRead": "73049", "recordsWritten": "122", "shuffleOutputBytes": "1098", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777239492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 9, 12), equal($31, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005462348809988295, "writeRatioMax": 0.005462348809988295 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0046820132657042525, "computeRatioMax": 0.0046820132657042525, "endMs": "1665777239564", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0023410066328521262, "readRatioMax": 0.0023410066328521262, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777239510", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 9), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.010144362075692548, "writeRatioMax": 0.010144362075692548 }, { "completedParallelInputs": "5", "computeMsAvg": "224", "computeMsMax": "302", "computeRatioAvg": 0.08739758095981272, "computeRatioMax": 0.11783066718689036, "endMs": "1665777239702", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.005462348809988295, "readRatioMax": 0.00702301989855638, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1010", "startMs": "1665777239526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "14", "writeMsMax": "16", "writeRatioAvg": 0.005462348809988295, "writeRatioMax": 0.006242684354272337 }, { "completedParallelInputs": "1", "computeMsAvg": "297", "computeMsMax": "297", "computeRatioAvg": 0.11587982832618025, "computeRatioMax": 0.11587982832618025, "endMs": "1665777239756", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.005072181037846274, "readRatioMax": 0.005072181037846274, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "270", "startMs": "1665777239543", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.005852516582130316, "writeRatioMax": 0.005852516582130316 }, { "completedParallelInputs": "6", "computeMsAvg": "2153", "computeMsMax": "2563", "computeRatioAvg": 0.8400312134217713, "computeRatioMax": 1, "endMs": "1665777241364", "id": "8", "inputStages": [ "6", "5", "0", "2", "1", "4", "3" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.006242684354272337, "readRatioMax": 0.007803355442840421, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "10677", "startMs": "1665777239806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $185, $191 := $186, $192 := $180, $193 := $181", "$90 := SUM($183)", "$91 := SUM($184)", "$92 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $174, $181 := $175, $182 := $170, $183 := $172, $184 := $173, $185 := $2, $186 := $3", "INNER HASH JOIN EACH WITH ALL ON $171 = $1" ] }, { "kind": "JOIN", "substeps": [ "$170 := $160, $171 := $161, $172 := $163, $173 := $164, $174 := $11, $175 := $12", "INNER HASH JOIN EACH WITH ALL ON $162 = $10" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $153, $163 := $154, $164 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0015606710885680843, "writeRatioMax": 0.0019508388607101053 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0019508388607101053, "computeRatioMax": 0.0019508388607101053, "endMs": "1665777241381", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665777241370", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$200 ASC, $201 ASC, $202 ASC, $203 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003901677721420211, "waitRatioMax": 0.0003901677721420211, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0003901677721420211, "writeRatioMax": 0.0003901677721420211 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.0074131876706984, "computeRatioMax": 0.0074131876706984, "endMs": "1665777241432", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777241384", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007803355442840422, "waitRatioMax": 0.0007803355442840422, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.010534529847834569, "writeRatioMax": 0.010534529847834569 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "631", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2088" }, { "activeUnits": "6", "completedUnits": "19", "elapsedMs": "2142", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12494" } ], "totalBytesBilled": "196083712", "totalBytesProcessed": "195379527", "totalPartitionsProcessed": "0", "totalSlotMs": "12494", "transferredBytes": "0" }, "startTime": "1665777239320", "totalBytesProcessed": "195379527", "totalSlotMs": "12494" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2871f091_62f0_421b_8703_63f187d3f875" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_quantity) as store_sales_quantity\n ,sum(sr_return_quantity) as store_returns_quantity\n ,sum(cs_quantity) as catalog_sales_quantity\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 9 \n and d1.d_year = 1999\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 9 and 9 + 3 \n and d2.d_year = 1999\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk \n and d3.d_year in (1999,1999+1,1999+2)\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id \n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "mISgCe+50rT+yP2supv0FQ==", "id": "test-project-364309:europe-west1.query29_1665777242", "jobReference": { "jobId": "query29_1665777242", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query29_1665777242?location=europe-west1", "statistics": { "creationTime": "1665777243219", "endTime": "1665777245468", "finalExecutionDurationMs": "1994", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "195379527", "performanceInsights": { "avgPreviousExecutionMs": "2078" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "69", "computeMsMax": "69", "computeRatioAvg": 0.024945770065075923, "computeRatioMax": 0.024945770065075923, "endMs": "1665777243493", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.004338394793926247, "readRatioMax": 0.004338394793926247, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "86", "startMs": "1665777243419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036153289949385393, "waitRatioMax": 0.00036153289949385393, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005061460592913955, "writeRatioMax": 0.005061460592913955 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0021691973969631237, "computeRatioMax": 0.0021691973969631237, "endMs": "1665777243473", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0014461315979754157, "readRatioMax": 0.0014461315979754157, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777243435", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036153289949385393, "waitRatioMax": 0.00036153289949385393, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.006507592190889371, "writeRatioMax": 0.006507592190889371 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0028922631959508315, "computeRatioMax": 0.0028922631959508315, "endMs": "1665777243493", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0028922631959508315, "readRatioMax": 0.0028922631959508315, "recordsRead": "73049", "recordsWritten": "1096", "shuffleOutputBytes": "9864", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777243454", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE in($21, 1999, 2000, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036153289949385393, "waitRatioMax": 0.00036153289949385393, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.004699927693420101, "writeRatioMax": 0.004699927693420101 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0036153289949385392, "computeRatioMax": 0.0036153289949385392, "endMs": "1665777243514", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0018076644974692696, "readRatioMax": 0.0018076644974692696, "recordsRead": "73049", "recordsWritten": "122", "shuffleOutputBytes": "1098", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777243473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 9, 12), equal($31, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007230657989877079, "waitRatioMax": 0.0007230657989877079, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.006146059291395517, "writeRatioMax": 0.006146059291395517 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0025307302964569776, "computeRatioMax": 0.0025307302964569776, "endMs": "1665777243527", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0021691973969631237, "readRatioMax": 0.0021691973969631237, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777243490", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 9), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036153289949385393, "waitRatioMax": 0.00036153289949385393, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005061460592913955, "writeRatioMax": 0.005061460592913955 }, { "completedParallelInputs": "5", "computeMsAvg": "216", "computeMsMax": "279", "computeRatioAvg": 0.07809110629067245, "computeRatioMax": 0.10086767895878525, "endMs": "1665777243673", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.004699927693420101, "readRatioMax": 0.006146059291395517, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "960", "startMs": "1665777243505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036153289949385393, "waitRatioMax": 0.00036153289949385393, "writeMsAvg": "13", "writeMsMax": "15", "writeRatioAvg": 0.004699927693420101, "writeRatioMax": 0.005422993492407809 }, { "completedParallelInputs": "1", "computeMsAvg": "361", "computeMsMax": "361", "computeRatioAvg": 0.13051337671728128, "computeRatioMax": 0.13051337671728128, "endMs": "1665777243765", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.005061460592913955, "readRatioMax": 0.005061460592913955, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "324", "startMs": "1665777243521", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036153289949385393, "waitRatioMax": 0.00036153289949385393, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.009761388286334056, "writeRatioMax": 0.009761388286334056 }, { "completedParallelInputs": "6", "computeMsAvg": "2363", "computeMsMax": "2766", "computeRatioAvg": 0.8543022415039768, "computeRatioMax": 1, "endMs": "1665777245321", "id": "8", "inputStages": [ "0", "3", "4", "6", "5", "2", "1" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "21", "readRatioAvg": 0.006507592190889371, "readRatioMax": 0.007592190889370932, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "11290", "startMs": "1665777243826", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $185, $191 := $186, $192 := $180, $193 := $181", "$90 := SUM($183)", "$91 := SUM($184)", "$92 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $174, $181 := $175, $182 := $170, $183 := $172, $184 := $173, $185 := $2, $186 := $3", "INNER HASH JOIN EACH WITH ALL ON $171 = $1" ] }, { "kind": "JOIN", "substeps": [ "$170 := $160, $171 := $161, $172 := $163, $173 := $164, $174 := $11, $175 := $12", "INNER HASH JOIN EACH WITH ALL ON $162 = $10" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $153, $163 := $154, $164 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "TO __stage08_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0007230657989877079, "waitRatioMax": 0.0010845986984815619, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0014461315979754157, "writeRatioMax": 0.0018076644974692696 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0036153289949385392, "computeRatioMax": 0.0036153289949385392, "endMs": "1665777245336", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665777245326", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$200 ASC, $201 ASC, $202 ASC, $203 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036153289949385393, "waitRatioMax": 0.00036153289949385393, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0036153289949385392, "computeRatioMax": 0.0036153289949385392, "endMs": "1665777245377", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777245342", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036153289949385393, "waitRatioMax": 0.00036153289949385393, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.005422993492407809, "writeRatioMax": 0.005422993492407809 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "642", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2794" }, { "activeUnits": "5", "completedUnits": "19", "elapsedMs": "2136", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13984" } ], "totalBytesBilled": "196083712", "totalBytesProcessed": "195379527", "totalPartitionsProcessed": "0", "totalSlotMs": "13984", "transferredBytes": "0" }, "startTime": "1665777243279", "totalBytesProcessed": "195379527", "totalSlotMs": "13984" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon542eb49f_a0dd_41cf_a6e9_60e9c5f2c5ae" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_quantity) as store_sales_quantity\n ,sum(sr_return_quantity) as store_returns_quantity\n ,sum(cs_quantity) as catalog_sales_quantity\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 9 \n and d1.d_year = 1999\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 9 and 9 + 3 \n and d2.d_year = 1999\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk \n and d3.d_year in (1999,1999+1,1999+2)\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id \n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "6FqFQCNKlnzv2c0J9oZ+eQ==", "id": "test-project-364309:europe-west1.query29_1665777246", "jobReference": { "jobId": "query29_1665777246", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query29_1665777246?location=europe-west1", "statistics": { "creationTime": "1665777247222", "endTime": "1665777249495", "finalExecutionDurationMs": "2051", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "195379527", "performanceInsights": { "avgPreviousExecutionMs": "2066" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "62", "computeMsMax": "62", "computeRatioAvg": 0.0194601381042059, "computeRatioMax": 0.0194601381042059, "endMs": "1665777247484", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.002824858757062147, "readRatioMax": 0.002824858757062147, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665777247410", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.003766478342749529, "writeRatioMax": 0.003766478342749529 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.002197112366603892, "computeRatioMax": 0.002197112366603892, "endMs": "1665777247465", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0012554927809165098, "readRatioMax": 0.0012554927809165098, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777247425", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0053358443188951665, "writeRatioMax": 0.0053358443188951665 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.004394224733207784, "computeRatioMax": 0.004394224733207784, "endMs": "1665777247469", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0025109855618330196, "readRatioMax": 0.0025109855618330196, "recordsRead": "73049", "recordsWritten": "1096", "shuffleOutputBytes": "9864", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777247440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE in($21, 1999, 2000, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.002824858757062147, "writeRatioMax": 0.002824858757062147 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.002824858757062147, "computeRatioMax": 0.002824858757062147, "endMs": "1665777247482", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0018832391713747645, "readRatioMax": 0.0018832391713747645, "recordsRead": "73049", "recordsWritten": "122", "shuffleOutputBytes": "1098", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777247454", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 9, 12), equal($31, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.004708097928436911, "writeRatioMax": 0.004708097928436911 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.003452605147520402, "computeRatioMax": 0.003452605147520402, "endMs": "1665777247494", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0025109855618330196, "readRatioMax": 0.0025109855618330196, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777247469", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 9), equal($51, 1999))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0025109855618330196, "writeRatioMax": 0.0025109855618330196 }, { "completedParallelInputs": "5", "computeMsAvg": "336", "computeMsMax": "401", "computeRatioAvg": 0.10546139359698682, "computeRatioMax": 0.1258631512868801, "endMs": "1665777247704", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "21", "readRatioAvg": 0.005021971123666039, "readRatioMax": 0.006591337099811676, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "51585484", "shuffleOutputBytesSpilled": "0", "slotMs": "1459", "startMs": "1665777247480", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.004394224733207784, "writeRatioMax": 0.0053358443188951665 }, { "completedParallelInputs": "1", "computeMsAvg": "212", "computeMsMax": "212", "computeRatioAvg": 0.06654111738857502, "computeRatioMax": 0.06654111738857502, "endMs": "1665777247681", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.004394224733207784, "readRatioMax": 0.004394224733207784, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "12407322", "shuffleOutputBytesSpilled": "0", "slotMs": "220", "startMs": "1665777247493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.005021971123666039, "writeRatioMax": 0.005021971123666039 }, { "completedParallelInputs": "6", "computeMsAvg": "2301", "computeMsMax": "3186", "computeRatioAvg": 0.7222222222222222, "computeRatioMax": 1, "endMs": "1665777249324", "id": "9", "inputStages": [ "2", "1", "3", "0", "5", "4", "6" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "22", "readRatioAvg": 0.005963590709353421, "readRatioMax": 0.006905210295040804, "recordsRead": "13173256", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "11089", "startMs": "1665777247738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $185, $191 := $186, $192 := $180, $193 := $181", "$90 := SUM($183)", "$91 := SUM($184)", "$92 := SUM($182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $174, $181 := $175, $182 := $170, $183 := $172, $184 := $173, $185 := $2, $186 := $3", "INNER HASH JOIN EACH WITH ALL ON $171 = $1" ] }, { "kind": "JOIN", "substeps": [ "$170 := $160, $171 := $161, $172 := $163, $173 := $164, $174 := $11, $175 := $12", "INNER HASH JOIN EACH WITH ALL ON $162 = $10" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $153, $163 := $154, $164 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "TO __stage09_output", "BY HASH($190, $191, $192, $193)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.0012554927809165098, "writeRatioMax": 0.0018832391713747645 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0018832391713747645, "computeRatioMax": 0.0018832391713747645, "endMs": "1665777249388", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665777249377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $90, $91, $92", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$200 ASC, $201 ASC, $202 ASC, $203 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00031387319522912746, "writeRatioMax": 0.00031387319522912746 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.003766478342749529, "computeRatioMax": 0.003766478342749529, "endMs": "1665777249426", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "234", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777249392", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $214, $215, $216", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031387319522912746, "waitRatioMax": 0.00031387319522912746, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.003766478342749529, "writeRatioMax": 0.003766478342749529 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "635", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2303" }, { "activeUnits": "4", "completedUnits": "19", "elapsedMs": "2183", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13266" } ], "totalBytesBilled": "196083712", "totalBytesProcessed": "195379527", "totalPartitionsProcessed": "0", "totalSlotMs": "13266", "transferredBytes": "0" }, "startTime": "1665777247277", "totalBytesProcessed": "195379527", "totalSlotMs": "13266" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
