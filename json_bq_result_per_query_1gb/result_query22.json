{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon363d92c6_a319_4337_bc85_682a433b92af" }, "priority": "INTERACTIVE", "query": "-- start query 22 in stream 0 using template query22.tpl\nselect i_product_name\n ,i_brand\n ,i_class\n ,i_category\n ,avg(inv_quantity_on_hand) qoh\n from inventory\n ,date_dim\n ,item\n where inv_date_sk=d_date_sk\n and inv_item_sk=i_item_sk\n and d_month_seq between 1200 and 1200 + 11\n group by rollup(i_product_name\n ,i_brand\n ,i_class\n ,i_category)\norder by qoh, i_product_name, i_brand, i_class, i_category\nlimit 100\n;\n\n-- end query 22 in stream 0 using template query22.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "0VUyqW3llz5do4Y10A1Ylg==", "id": "test-project-364309:europe-west1.query22_1665768268", "jobReference": { "jobId": "query22_1665768268", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query22_1665768268?location=europe-west1", "statistics": { "creationTime": "1665768269176", "endTime": "1665768276463", "finalExecutionDurationMs": "7088", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "279501606", "performanceInsights": { "avgPreviousExecutionMs": "7779" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0015190972222222222, "computeRatioMax": 0.0015190972222222222, "endMs": "1665768269377", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0005063657407407407, "readRatioMax": 0.0005063657407407407, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "1381802", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768269330", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_brand, $3:i_class, $4:i_category, $5:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.233796296296296e-05, "waitRatioMax": 7.233796296296296e-05, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0009403935185185185, "writeRatioMax": 0.0009403935185185185 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0007957175925925925, "computeRatioMax": 0.0007957175925925925, "endMs": "1665768269390", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0005063657407407407, "readRatioMax": 0.0005063657407407407, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768269345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.233796296296296e-05, "waitRatioMax": 7.233796296296296e-05, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0011574074074074073, "writeRatioMax": 0.0011574074074074073 }, { "completedParallelInputs": "1", "computeMsAvg": "13824", "computeMsMax": "13824", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768275928", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "28", "readMsMax": "28", "readRatioAvg": 0.002025462962962963, "readRatioMax": 0.002025462962962963, "recordsRead": "11763366", "recordsWritten": "35968", "shuffleOutputBytes": "2717294", "shuffleOutputBytesSpilled": "0", "slotMs": "10903", "startMs": "1665768269404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:inv_date_sk, $11:inv_item_sk, $12:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $50, $111 := $51, $112 := $52, $113 := $53, $114 := $70", "$40 := SHARD_AVG($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := if(equal(bitwise_and($80, 1), 0), NULL, $104)", "$51 := if(equal(bitwise_and($80, 2), 0), NULL, $101)", "$52 := if(equal(bitwise_and($80, 4), 0), NULL, $102)", "$53 := if(equal(bitwise_and($80, 8), 0), NULL, $103)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $2, $102 := $3, $103 := $4, $104 := $5", "INNER HASH JOIN EACH WITH ALL ON $90 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $11, $91 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := subtract($81, 1)" ] }, { "kind": "WRITE", "substeps": [ "$40, $110, $111, $112, $113, $114", "TO __stage03_output", "BY HASH($110, $111, $112, $113, $114)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.233796296296296e-05, "waitRatioMax": 7.233796296296296e-05, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0009403935185185185, "writeRatioMax": 0.0009403935185185185 }, { "completedParallelInputs": "1", "computeMsAvg": "54", "computeMsMax": "54", "computeRatioAvg": 0.00390625, "computeRatioMax": 0.00390625, "endMs": "1665768276370", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "35968", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665768276328", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40, $110, $111, $112, $113, $114", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $120 ASC, $121 ASC, $122 ASC, $123 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114", "$30 := ROOT_AVG($40)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.233796296296296e-05, "waitRatioMax": 7.233796296296296e-05, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.00014467592592592592, "writeRatioMax": 0.00014467592592592592 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0005787037037037037, "computeRatioMax": 0.0005787037037037037, "endMs": "1665768276384", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768276340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC, $133 ASC, $134 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.233796296296296e-05, "waitRatioMax": 7.233796296296296e-05, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0013020833333333333, "writeRatioMax": 0.0013020833333333333 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "606", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "300" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "1587", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1924" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "2588", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3552" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "4588", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6917" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "6588", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "10369" }, { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "7182", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11100" } ], "totalBytesBilled": "279969792", "totalBytesProcessed": "279501606", "totalPartitionsProcessed": "0", "totalSlotMs": "11100", "transferredBytes": "0" }, "startTime": "1665768269226", "totalBytesProcessed": "279501606", "totalSlotMs": "11100" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8fbb2ddc_744b_4be7_b22c_b7acc45abea8" }, "priority": "INTERACTIVE", "query": "-- start query 22 in stream 0 using template query22.tpl\nselect i_product_name\n ,i_brand\n ,i_class\n ,i_category\n ,avg(inv_quantity_on_hand) qoh\n from inventory\n ,date_dim\n ,item\n where inv_date_sk=d_date_sk\n and inv_item_sk=i_item_sk\n and d_month_seq between 1200 and 1200 + 11\n group by rollup(i_product_name\n ,i_brand\n ,i_class\n ,i_category)\norder by qoh, i_product_name, i_brand, i_class, i_category\nlimit 100\n;\n\n-- end query 22 in stream 0 using template query22.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "pegoE8bSl8Xo7xUexzffkg==", "id": "test-project-364309:europe-west1.query22_1665777024", "jobReference": { "jobId": "query22_1665777024", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query22_1665777024?location=europe-west1", "statistics": { "creationTime": "1665777025336", "endTime": "1665777035864", "finalExecutionDurationMs": "10357", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "279501606", "performanceInsights": { "avgPreviousExecutionMs": "7693" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.0013334879406307978, "computeRatioMax": 0.0013334879406307978, "endMs": "1665777025503", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0003478664192949907, "readRatioMax": 0.0003478664192949907, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "1381802", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777025458", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_brand, $3:i_class, $4:i_category, $5:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 5.797773654916512e-05, "waitRatioMax": 5.797773654916512e-05, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0007537105751391466, "writeRatioMax": 0.0007537105751391466 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.00046382189239332097, "computeRatioMax": 0.00046382189239332097, "endMs": "1665777025503", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0002898886827458256, "readRatioMax": 0.0002898886827458256, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665777025477", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 5.797773654916512e-05, "waitRatioMax": 5.797773654916512e-05, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0008696660482374768, "writeRatioMax": 0.0008696660482374768 }, { "completedParallelInputs": "1", "computeMsAvg": "17248", "computeMsMax": "17248", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777034447", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "30", "readMsMax": "30", "readRatioAvg": 0.0017393320964749536, "readRatioMax": 0.0017393320964749536, "recordsRead": "11763366", "recordsWritten": "35968", "shuffleOutputBytes": "2717294", "shuffleOutputBytesSpilled": "0", "slotMs": "13779", "startMs": "1665777025518", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:inv_date_sk, $11:inv_item_sk, $12:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $50, $111 := $51, $112 := $52, $113 := $53, $114 := $70", "$40 := SHARD_AVG($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := if(equal(bitwise_and($80, 1), 0), NULL, $104)", "$51 := if(equal(bitwise_and($80, 2), 0), NULL, $101)", "$52 := if(equal(bitwise_and($80, 4), 0), NULL, $102)", "$53 := if(equal(bitwise_and($80, 8), 0), NULL, $103)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $2, $102 := $3, $103 := $4, $104 := $5", "INNER HASH JOIN EACH WITH ALL ON $90 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $11, $91 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := subtract($81, 1)" ] }, { "kind": "WRITE", "substeps": [ "$40, $110, $111, $112, $113, $114", "TO __stage03_output", "BY HASH($110, $111, $112, $113, $114)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 5.797773654916512e-05, "waitRatioMax": 5.797773654916512e-05, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0003478664192949907, "writeRatioMax": 0.0003478664192949907 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.0020871985157699443, "computeRatioMax": 0.0020871985157699443, "endMs": "1665777035749", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "35968", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777035724", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40, $110, $111, $112, $113, $114", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $120 ASC, $121 ASC, $122 ASC, $123 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114", "$30 := ROOT_AVG($40)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 5.797773654916512e-05, "waitRatioMax": 5.797773654916512e-05, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 5.797773654916512e-05, "writeRatioMax": 5.797773654916512e-05 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0006377551020408163, "computeRatioMax": 0.0006377551020408163, "endMs": "1665777035779", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777035738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC, $133 ASC, $134 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 5.797773654916512e-05, "waitRatioMax": 5.797773654916512e-05, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.0012175324675324675, "writeRatioMax": 0.0012175324675324675 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "576", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "66" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "1562", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1516" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "3563", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4591" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "4563", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6124" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "5563", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7669" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "6563", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "9220" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "7563", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "10784" }, { "activeUnits": "1", "completedUnits": "3", "elapsedMs": "9564", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13845" }, { "activeUnits": "0", "completedUnits": "5", "elapsedMs": "10431", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13916" } ], "totalBytesBilled": "279969792", "totalBytesProcessed": "279501606", "totalPartitionsProcessed": "0", "totalSlotMs": "13916", "transferredBytes": "0" }, "startTime": "1665777025383", "totalBytesProcessed": "279501606", "totalSlotMs": "13916" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncf3288f4_973e_455a_a8fb_5450aeba58d5" }, "priority": "INTERACTIVE", "query": "-- start query 22 in stream 0 using template query22.tpl\nselect i_product_name\n ,i_brand\n ,i_class\n ,i_category\n ,avg(inv_quantity_on_hand) qoh\n from inventory\n ,date_dim\n ,item\n where inv_date_sk=d_date_sk\n and inv_item_sk=i_item_sk\n and d_month_seq between 1200 and 1200 + 11\n group by rollup(i_product_name\n ,i_brand\n ,i_class\n ,i_category)\norder by qoh, i_product_name, i_brand, i_class, i_category\nlimit 100\n;\n\n-- end query 22 in stream 0 using template query22.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "0nsbapH+oJIZNj1/hLJsUQ==", "id": "test-project-364309:europe-west1.query22_1665777038", "jobReference": { "jobId": "query22_1665777038", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query22_1665777038?location=europe-west1", "statistics": { "creationTime": "1665777038806", "endTime": "1665777045606", "finalExecutionDurationMs": "6624", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "279501606", "performanceInsights": { "avgPreviousExecutionMs": "7989" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.002194865922320832, "computeRatioMax": 0.002194865922320832, "endMs": "1665777038970", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.000572573718866304, "readRatioMax": 0.000572573718866304, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "1381802", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777038938", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_brand, $3:i_class, $4:i_category, $5:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 9.542895314438401e-05, "waitRatioMax": 9.542895314438401e-05, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.001049718484588224, "writeRatioMax": 0.001049718484588224 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0009542895314438401, "computeRatioMax": 0.0009542895314438401, "endMs": "1665777038988", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0006680026720106881, "readRatioMax": 0.0006680026720106881, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777038953", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 9.542895314438401e-05, "waitRatioMax": 9.542895314438401e-05, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0006680026720106881, "writeRatioMax": 0.0006680026720106881 }, { "completedParallelInputs": "1", "computeMsAvg": "10479", "computeMsMax": "10479", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777045215", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "26", "readMsMax": "26", "readRatioAvg": 0.002481152781753984, "readRatioMax": 0.002481152781753984, "recordsRead": "11763366", "recordsWritten": "35968", "shuffleOutputBytes": "2717294", "shuffleOutputBytesSpilled": "0", "slotMs": "8645", "startMs": "1665777038997", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:inv_date_sk, $11:inv_item_sk, $12:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $50, $111 := $51, $112 := $52, $113 := $53, $114 := $70", "$40 := SHARD_AVG($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := if(equal(bitwise_and($80, 1), 0), NULL, $104)", "$51 := if(equal(bitwise_and($80, 2), 0), NULL, $101)", "$52 := if(equal(bitwise_and($80, 4), 0), NULL, $102)", "$53 := if(equal(bitwise_and($80, 8), 0), NULL, $103)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $2, $102 := $3, $103 := $4, $104 := $5", "INNER HASH JOIN EACH WITH ALL ON $90 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $11, $91 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := subtract($81, 1)" ] }, { "kind": "WRITE", "substeps": [ "$40, $110, $111, $112, $113, $114", "TO __stage03_output", "BY HASH($110, $111, $112, $113, $114)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 9.542895314438401e-05, "waitRatioMax": 9.542895314438401e-05, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.000572573718866304, "writeRatioMax": 0.000572573718866304 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.0034354423131978244, "computeRatioMax": 0.0034354423131978244, "endMs": "1665777045505", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "35968", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777045476", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40, $110, $111, $112, $113, $114", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $120 ASC, $121 ASC, $122 ASC, $123 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114", "$30 := ROOT_AVG($40)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 9.542895314438401e-05, "waitRatioMax": 9.542895314438401e-05, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 9.542895314438401e-05, "writeRatioMax": 9.542895314438401e-05 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0013360053440213762, "computeRatioMax": 0.0013360053440213762, "endMs": "1665777045530", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777045489", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC, $133 ASC, $134 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 9.542895314438401e-05, "waitRatioMax": 9.542895314438401e-05, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0007634316251550721, "writeRatioMax": 0.0007634316251550721 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "585", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "290" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "1570", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1677" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "2570", "estimatedRunnableUnits": "1", "pendingUnits": "1", "totalSlotMs": "3069" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "3570", "estimatedRunnableUnits": "1", "pendingUnits": "1", "totalSlotMs": "4466" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "4570", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "5885" }, { "activeUnits": "1", "completedUnits": "3", "elapsedMs": "6571", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8711" }, { "activeUnits": "0", "completedUnits": "5", "elapsedMs": "6703", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8788" } ], "totalBytesBilled": "279969792", "totalBytesProcessed": "279501606", "totalPartitionsProcessed": "0", "totalSlotMs": "8788", "transferredBytes": "0" }, "startTime": "1665777038854", "totalBytesProcessed": "279501606", "totalSlotMs": "8788" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond1fdb5a0_80f2_4ebd_a7b8_f24ad8e7439f" }, "priority": "INTERACTIVE", "query": "-- start query 22 in stream 0 using template query22.tpl\nselect i_product_name\n ,i_brand\n ,i_class\n ,i_category\n ,avg(inv_quantity_on_hand) qoh\n from inventory\n ,date_dim\n ,item\n where inv_date_sk=d_date_sk\n and inv_item_sk=i_item_sk\n and d_month_seq between 1200 and 1200 + 11\n group by rollup(i_product_name\n ,i_brand\n ,i_class\n ,i_category)\norder by qoh, i_product_name, i_brand, i_class, i_category\nlimit 100\n;\n\n-- end query 22 in stream 0 using template query22.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ZDdvCD+MVVzjhhnS9a9JCg==", "id": "test-project-364309:europe-west1.query22_1665777047", "jobReference": { "jobId": "query22_1665777047", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query22_1665777047?location=europe-west1", "statistics": { "creationTime": "1665777048077", "endTime": "1665777056013", "finalExecutionDurationMs": "7740", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "279501606", "performanceInsights": { "avgPreviousExecutionMs": "7853" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.001943407960199005, "computeRatioMax": 0.001943407960199005, "endMs": "1665777048275", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.000388681592039801, "readRatioMax": 0.000388681592039801, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "1381802", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777048232", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_brand, $3:i_class, $4:i_category, $5:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.77363184079602e-05, "waitRatioMax": 7.77363184079602e-05, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0006996268656716418, "writeRatioMax": 0.0006996268656716418 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0011660447761194029, "computeRatioMax": 0.0011660447761194029, "endMs": "1665777048285", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0005441542288557214, "readRatioMax": 0.0005441542288557214, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777048246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.77363184079602e-05, "waitRatioMax": 7.77363184079602e-05, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0008550995024875622, "writeRatioMax": 0.0008550995024875622 }, { "completedParallelInputs": "1", "computeMsAvg": "12864", "computeMsMax": "12864", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777054786", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "26", "readMsMax": "26", "readRatioAvg": 0.002021144278606965, "readRatioMax": 0.002021144278606965, "recordsRead": "11763366", "recordsWritten": "35968", "shuffleOutputBytes": "2717294", "shuffleOutputBytesSpilled": "0", "slotMs": "9605", "startMs": "1665777048302", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:inv_date_sk, $11:inv_item_sk, $12:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $50, $111 := $51, $112 := $52, $113 := $53, $114 := $70", "$40 := SHARD_AVG($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := if(equal(bitwise_and($80, 1), 0), NULL, $104)", "$51 := if(equal(bitwise_and($80, 2), 0), NULL, $101)", "$52 := if(equal(bitwise_and($80, 4), 0), NULL, $102)", "$53 := if(equal(bitwise_and($80, 8), 0), NULL, $103)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $2, $102 := $3, $103 := $4, $104 := $5", "INNER HASH JOIN EACH WITH ALL ON $90 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $11, $91 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := subtract($81, 1)" ] }, { "kind": "WRITE", "substeps": [ "$40, $110, $111, $112, $113, $114", "TO __stage03_output", "BY HASH($110, $111, $112, $113, $114)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.77363184079602e-05, "waitRatioMax": 7.77363184079602e-05, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0003109452736318408, "writeRatioMax": 0.0003109452736318408 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.0033426616915422885, "computeRatioMax": 0.0033426616915422885, "endMs": "1665777055934", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "35968", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777055902", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40, $110, $111, $112, $113, $114", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $120 ASC, $121 ASC, $122 ASC, $123 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114", "$30 := ROOT_AVG($40)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.77363184079602e-05, "waitRatioMax": 7.77363184079602e-05, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 7.77363184079602e-05, "writeRatioMax": 7.77363184079602e-05 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0009328358208955224, "computeRatioMax": 0.0009328358208955224, "endMs": "1665777055943", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777055916", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC, $133 ASC, $134 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.77363184079602e-05, "waitRatioMax": 7.77363184079602e-05, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0004664179104477612, "writeRatioMax": 0.0004664179104477612 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "328" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "1578", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1798" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "2578", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3275" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "3578", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4759" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "4579", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6246" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "6579", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "9238" }, { "activeUnits": "0", "completedUnits": "5", "elapsedMs": "7828", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9748" } ], "totalBytesBilled": "279969792", "totalBytesProcessed": "279501606", "totalPartitionsProcessed": "0", "totalSlotMs": "9748", "transferredBytes": "0" }, "startTime": "1665777048139", "totalBytesProcessed": "279501606", "totalSlotMs": "9748" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0d996bc1_686a_473f_821e_29e20e6cac6b" }, "priority": "INTERACTIVE", "query": "-- start query 22 in stream 0 using template query22.tpl\nselect i_product_name\n ,i_brand\n ,i_class\n ,i_category\n ,avg(inv_quantity_on_hand) qoh\n from inventory\n ,date_dim\n ,item\n where inv_date_sk=d_date_sk\n and inv_item_sk=i_item_sk\n and d_month_seq between 1200 and 1200 + 11\n group by rollup(i_product_name\n ,i_brand\n ,i_class\n ,i_category)\norder by qoh, i_product_name, i_brand, i_class, i_category\nlimit 100\n;\n\n-- end query 22 in stream 0 using template query22.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "QGKA9m0nFCc1BOFUqtjb1Q==", "id": "test-project-364309:europe-west1.query22_1665777057", "jobReference": { "jobId": "query22_1665777057", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query22_1665777057?location=europe-west1", "statistics": { "creationTime": "1665777058512", "endTime": "1665777065262", "finalExecutionDurationMs": "6574", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "279501606", "performanceInsights": { "avgPreviousExecutionMs": "7842" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.0021899088997897687, "computeRatioMax": 0.0021899088997897687, "endMs": "1665777058690", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0013139453398738612, "readRatioMax": 0.0013139453398738612, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "1381802", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777058647", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_brand, $3:i_class, $4:i_category, $5:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 8.759635599159075e-05, "waitRatioMax": 8.759635599159075e-05, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0008759635599159075, "writeRatioMax": 0.0008759635599159075 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.001051156271899089, "computeRatioMax": 0.001051156271899089, "endMs": "1665777058704", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.000700770847932726, "readRatioMax": 0.000700770847932726, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777058667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0001751927119831815, "waitRatioMax": 0.0001751927119831815, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0007883672039243168, "writeRatioMax": 0.0007883672039243168 }, { "completedParallelInputs": "1", "computeMsAvg": "11416", "computeMsMax": "11416", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777064749", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "35", "readMsMax": "35", "readRatioAvg": 0.003065872459705676, "readRatioMax": 0.003065872459705676, "recordsRead": "11763366", "recordsWritten": "35968", "shuffleOutputBytes": "2717294", "shuffleOutputBytesSpilled": "0", "slotMs": "7301", "startMs": "1665777058715", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:inv_date_sk, $11:inv_item_sk, $12:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $50, $111 := $51, $112 := $52, $113 := $53, $114 := $70", "$40 := SHARD_AVG($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := if(equal(bitwise_and($80, 1), 0), NULL, $104)", "$51 := if(equal(bitwise_and($80, 2), 0), NULL, $101)", "$52 := if(equal(bitwise_and($80, 4), 0), NULL, $102)", "$53 := if(equal(bitwise_and($80, 8), 0), NULL, $103)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $2, $102 := $3, $103 := $4, $104 := $5", "INNER HASH JOIN EACH WITH ALL ON $90 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $11, $91 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := subtract($81, 1)" ] }, { "kind": "WRITE", "substeps": [ "$40, $110, $111, $112, $113, $114", "TO __stage03_output", "BY HASH($110, $111, $112, $113, $114)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 8.759635599159075e-05, "waitRatioMax": 8.759635599159075e-05, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.00043798177995795374, "writeRatioMax": 0.00043798177995795374 }, { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.004905395935529082, "computeRatioMax": 0.004905395935529082, "endMs": "1665777065170", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "35968", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777065133", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40, $110, $111, $112, $113, $114", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $120 ASC, $121 ASC, $122 ASC, $123 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114", "$30 := ROOT_AVG($40)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 8.759635599159075e-05, "waitRatioMax": 8.759635599159075e-05, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0001751927119831815, "writeRatioMax": 0.0001751927119831815 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0005255781359495446, "computeRatioMax": 0.0005255781359495446, "endMs": "1665777065191", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777065148", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC, $133 ASC, $134 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 8.759635599159075e-05, "waitRatioMax": 8.759635599159075e-05, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.00043798177995795374, "writeRatioMax": 0.00043798177995795374 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "595", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "495" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "1580", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1701" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "3580", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4123" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "5580", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6564" }, { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "6662", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7464" } ], "totalBytesBilled": "279969792", "totalBytesProcessed": "279501606", "totalPartitionsProcessed": "0", "totalSlotMs": "7464", "transferredBytes": "0" }, "startTime": "1665777058554", "totalBytesProcessed": "279501606", "totalSlotMs": "7464" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon90554318_b5c8_4d63_8f4b_2938ff88e524" }, "priority": "INTERACTIVE", "query": "-- start query 22 in stream 0 using template query22.tpl\nselect i_product_name\n ,i_brand\n ,i_class\n ,i_category\n ,avg(inv_quantity_on_hand) qoh\n from inventory\n ,date_dim\n ,item\n where inv_date_sk=d_date_sk\n and inv_item_sk=i_item_sk\n and d_month_seq between 1200 and 1200 + 11\n group by rollup(i_product_name\n ,i_brand\n ,i_class\n ,i_category)\norder by qoh, i_product_name, i_brand, i_class, i_category\nlimit 100\n;\n\n-- end query 22 in stream 0 using template query22.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "83B+yXeIw10zZCbvM+GLkQ==", "id": "test-project-364309:europe-west1.query22_1665777067", "jobReference": { "jobId": "query22_1665777067", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query22_1665777067?location=europe-west1", "statistics": { "creationTime": "1665777067707", "endTime": "1665777075676", "finalExecutionDurationMs": "7761", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "279501606", "performanceInsights": { "avgPreviousExecutionMs": "7737" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.0035460992907801418, "computeRatioMax": 0.0035460992907801418, "endMs": "1665777067890", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0005396238051187173, "readRatioMax": 0.0005396238051187173, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "1381802", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777067849", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_brand, $3:i_class, $4:i_category, $5:i_product_name", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.70891150169596e-05, "waitRatioMax": 7.70891150169596e-05, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0006938020351526364, "writeRatioMax": 0.0006938020351526364 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.000770891150169596, "computeRatioMax": 0.000770891150169596, "endMs": "1665777067905", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00046253469010175765, "readRatioMax": 0.00046253469010175765, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777067865", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_month_seq", "FROM date_dim", "WHERE between($21, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.70891150169596e-05, "waitRatioMax": 7.70891150169596e-05, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0012334258402713536, "writeRatioMax": 0.0012334258402713536 }, { "completedParallelInputs": "1", "computeMsAvg": "12972", "computeMsMax": "12972", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777074822", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "27", "readMsMax": "27", "readRatioAvg": 0.0020814061054579094, "readRatioMax": 0.0020814061054579094, "recordsRead": "11763366", "recordsWritten": "35968", "shuffleOutputBytes": "2717294", "shuffleOutputBytesSpilled": "0", "slotMs": "10444", "startMs": "1665777067926", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:inv_date_sk, $11:inv_item_sk, $12:inv_quantity_on_hand", "FROM inventory" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $50, $111 := $51, $112 := $52, $113 := $53, $114 := $70", "$40 := SHARD_AVG($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := if(equal(bitwise_and($80, 1), 0), NULL, $104)", "$51 := if(equal(bitwise_and($80, 2), 0), NULL, $101)", "$52 := if(equal(bitwise_and($80, 4), 0), NULL, $102)", "$53 := if(equal(bitwise_and($80, 8), 0), NULL, $103)" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $2, $102 := $3, $103 := $4, $104 := $5", "INNER HASH JOIN EACH WITH ALL ON $90 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $11, $91 := $12", "INNER HASH JOIN EACH WITH ALL ON $10 = $20" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := subtract($81, 1)" ] }, { "kind": "WRITE", "substeps": [ "$40, $110, $111, $112, $113, $114", "TO __stage03_output", "BY HASH($110, $111, $112, $113, $114)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.70891150169596e-05, "waitRatioMax": 7.70891150169596e-05, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0005396238051187173, "writeRatioMax": 0.0005396238051187173 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.004239901325932778, "computeRatioMax": 0.004239901325932778, "endMs": "1665777075546", "id": "4", "inputStages": [ "3" ], "name": "S04: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "35968", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777075513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40, $110, $111, $112, $113, $114", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $120 ASC, $121 ASC, $122 ASC, $123 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114", "$30 := ROOT_AVG($40)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.70891150169596e-05, "waitRatioMax": 7.70891150169596e-05, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 7.70891150169596e-05, "writeRatioMax": 7.70891150169596e-05 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0009250693802035153, "computeRatioMax": 0.0009250693802035153, "endMs": "1665777075578", "id": "5", "inputStages": [ "4" ], "name": "S05: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5827", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777075528", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC, $133 ASC, $134 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 7.70891150169596e-05, "waitRatioMax": 7.70891150169596e-05, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0014646931853222326, "writeRatioMax": 0.0014646931853222326 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "inventory" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "591", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "163" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "1575", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1663" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "2575", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3173" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "3576", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4686" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "4576", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6209" }, { "activeUnits": "1", "completedUnits": "2", "elapsedMs": "6576", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "9264" }, { "activeUnits": "0", "completedUnits": "5", "elapsedMs": "7846", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10604" } ], "totalBytesBilled": "279969792", "totalBytesProcessed": "279501606", "totalPartitionsProcessed": "0", "totalSlotMs": "10604", "transferredBytes": "0" }, "startTime": "1665777067759", "totalBytesProcessed": "279501606", "totalSlotMs": "10604" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
