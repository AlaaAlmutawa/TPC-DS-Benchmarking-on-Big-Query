{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbdc8c52d_df37_4052_9161_1e39d765a5dd" }, "priority": "INTERACTIVE", "query": "-- start query 46 in stream 0 using template query46.tpl\nselect c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,amt,profit \n from\n (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_coupon_amt) amt\n ,sum(ss_net_profit) profit\n from store_sales,date_dim,store,household_demographics,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and (household_demographics.hd_dep_count = 4 or\n household_demographics.hd_vehicle_count= 3)\n and date_dim.d_dow in (6,0)\n and date_dim.d_year in (1999,1999+1,1999+2) \n and store.s_city in ('Fairview','Fairview','Fairview','Midway','Fairview') \n group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n limit 100\n ;\n\n-- end query 46 in stream 0 using template query46.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "vAvSyuZWz9zyvM7skX46Cw==", "id": "test-project-364309:europe-west1.query46_1665768361", "jobReference": { "jobId": "query46_1665768361", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query46_1665768361?location=europe-west1", "statistics": { "creationTime": "1665768362381", "endTime": "1665768363445", "finalExecutionDurationMs": "797", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "227070372", "performanceInsights": { "avgPreviousExecutionMs": "754" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.05150976909413854, "computeRatioMax": 0.05150976909413854, "endMs": "1665768362637", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.015985790408525755, "readRatioMax": 0.015985790408525755, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768362592", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003552397868561279, "waitRatioMax": 0.003552397868561279, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.02664298401420959, "writeRatioMax": 0.02664298401420959 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.017761989342806393, "computeRatioMax": 0.017761989342806393, "endMs": "1665768362651", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008880994671403197, "readRatioMax": 0.008880994671403197, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768362611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 4), equal($32, 3))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017761989342806395, "waitRatioMax": 0.0017761989342806395, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.02486678507992895, "writeRatioMax": 0.02486678507992895 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.014209591474245116, "computeRatioMax": 0.014209591474245116, "endMs": "1665768362675", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010657193605683837, "readRatioMax": 0.010657193605683837, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768362640", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003552397868561279, "waitRatioMax": 0.003552397868561279, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.035523978685612786, "writeRatioMax": 0.035523978685612786 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.019538188277087035, "computeRatioMax": 0.019538188277087035, "endMs": "1665768362693", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010657193605683837, "readRatioMax": 0.010657193605683837, "recordsRead": "73049", "recordsWritten": "314", "shuffleOutputBytes": "2826", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768362657", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dow", "FROM date_dim", "WHERE and(in($62, 6, 0), in($61, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017761989342806395, "waitRatioMax": 0.0017761989342806395, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.014209591474245116, "writeRatioMax": 0.014209591474245116 }, { "completedParallelInputs": "6", "computeMsAvg": "445", "computeMsMax": "563", "computeRatioAvg": 0.7904085257548845, "computeRatioMax": 1, "endMs": "1665768363058", "id": "5", "inputStages": [ "3", "2", "0", "1" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "43", "readRatioAvg": 0.0497335701598579, "readRatioMax": 0.0763765541740675, "recordsRead": "3193160", "recordsWritten": "53261", "shuffleOutputBytes": "3962064", "shuffleOutputBytesSpilled": "0", "slotMs": "2817", "startMs": "1665768362714", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145", "$80 := SUM($143)", "$81 := SUM($144)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003552397868561279, "waitRatioMax": 0.003552397868561279, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.010657193605683837, "writeRatioMax": 0.012433392539964476 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.06927175843694494, "computeRatioMax": 0.06927175843694494, "endMs": "1665768363173", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.015985790408525755, "readRatioMax": 0.015985790408525755, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "103", "startMs": "1665768363094", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003552397868561279, "waitRatioMax": 0.003552397868561279, "writeMsAvg": "49", "writeMsMax": "49", "writeRatioAvg": 0.08703374777975133, "writeRatioMax": 0.08703374777975133 }, { "completedParallelInputs": "1", "computeMsAvg": "60", "computeMsMax": "60", "computeRatioAvg": 0.10657193605683836, "computeRatioMax": 0.10657193605683836, "endMs": "1665768363204", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53261", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "88", "startMs": "1665768363143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017761989342806395, "waitRatioMax": 0.0017761989342806395, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.03907637655417407, "writeRatioMax": 0.03907637655417407 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.015985790408525755, "computeRatioMax": 0.03374777975133215, "endMs": "1665768363275", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10384", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "4243", "startMs": "1665768363211", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0053285968028419185, "waitRatioMax": 0.007104795737122558, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.02664298401420959, "writeRatioMax": 0.035523978685612786 }, { "completedParallelInputs": "1", "computeMsAvg": "94", "computeMsMax": "94", "computeRatioAvg": 0.1669626998223801, "computeRatioMax": 0.1669626998223801, "endMs": "1665768363337", "id": "10", "inputStages": [ "9", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.021314387211367674, "readRatioMax": 0.021314387211367674, "recordsRead": "160384", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "163", "startMs": "1665768363218", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($186, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $175, $181 := $176, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $2", "INNER HASH JOIN EACH WITH ALL ON $174 = $1" ] }, { "kind": "JOIN", "substeps": [ "$174 := $11, $175 := $12, $176 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "TO __stage0A_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.008880994671403197, "waitRatioMax": 0.008880994671403197, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0017761989342806395, "writeRatioMax": 0.0017761989342806395 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.015985790408525755, "computeRatioMax": 0.015985790408525755, "endMs": "1665768363342", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665768363231", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206", "TO __stage0B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.007104795737122558, "waitRatioMax": 0.007104795737122558, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007104795737122558, "writeRatioMax": 0.007104795737122558 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "10", "elapsedMs": "652", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3014" }, { "activeUnits": "0", "completedUnits": "114", "elapsedMs": "942", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7697" } ], "totalBytesBilled": "227540992", "totalBytesProcessed": "227070372", "totalPartitionsProcessed": "0", "totalSlotMs": "7697", "transferredBytes": "0" }, "startTime": "1665768362442", "totalBytesProcessed": "227070372", "totalSlotMs": "7697" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon80527d0b_54ee_4d24_8642_ddd6f52a89ac" }, "priority": "INTERACTIVE", "query": "-- start query 46 in stream 0 using template query46.tpl\nselect c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,amt,profit \n from\n (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_coupon_amt) amt\n ,sum(ss_net_profit) profit\n from store_sales,date_dim,store,household_demographics,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and (household_demographics.hd_dep_count = 4 or\n household_demographics.hd_vehicle_count= 3)\n and date_dim.d_dow in (6,0)\n and date_dim.d_year in (1999,1999+1,1999+2) \n and store.s_city in ('Fairview','Fairview','Fairview','Midway','Fairview') \n group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n limit 100\n ;\n\n-- end query 46 in stream 0 using template query46.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "N/ffMp2ko+eu8jKwHCpAuA==", "id": "test-project-364309:europe-west1.query46_1665777502", "jobReference": { "jobId": "query46_1665777502", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query46_1665777502?location=europe-west1", "statistics": { "creationTime": "1665777503684", "endTime": "1665777504698", "finalExecutionDurationMs": "741", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "227070372", "performanceInsights": { "avgPreviousExecutionMs": "759" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.052734375, "computeRatioMax": 0.052734375, "endMs": "1665777503939", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009765625, "readRatioMax": 0.009765625, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777503908", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001953125, "waitRatioMax": 0.001953125, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01953125, "writeRatioMax": 0.01953125 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0234375, "computeRatioMax": 0.0234375, "endMs": "1665777503962", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0078125, "readRatioMax": 0.0078125, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777503924", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 4), equal($32, 3))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001953125, "waitRatioMax": 0.001953125, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.02734375, "writeRatioMax": 0.02734375 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015625, "computeRatioMax": 0.015625, "endMs": "1665777503978", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0078125, "readRatioMax": 0.0078125, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777503940", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001953125, "waitRatioMax": 0.001953125, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03515625, "writeRatioMax": 0.03515625 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.02734375, "computeRatioMax": 0.02734375, "endMs": "1665777504000", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.013671875, "readRatioMax": 0.013671875, "recordsRead": "73049", "recordsWritten": "314", "shuffleOutputBytes": "2826", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777503957", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dow", "FROM date_dim", "WHERE and(in($62, 6, 0), in($61, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001953125, "waitRatioMax": 0.001953125, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.02734375, "writeRatioMax": 0.02734375 }, { "completedParallelInputs": "6", "computeMsAvg": "451", "computeMsMax": "512", "computeRatioAvg": 0.880859375, "computeRatioMax": 1, "endMs": "1665777504337", "id": "5", "inputStages": [ "0", "1", "3", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "29", "readRatioAvg": 0.046875, "readRatioMax": 0.056640625, "recordsRead": "3193160", "recordsWritten": "53261", "shuffleOutputBytes": "3962064", "shuffleOutputBytesSpilled": "0", "slotMs": "2409", "startMs": "1665777504015", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145", "$80 := SUM($143)", "$81 := SUM($144)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.005859375, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.009765625, "writeRatioMax": 0.015625 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.072265625, "computeRatioMax": 0.072265625, "endMs": "1665777504411", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0234375, "readRatioMax": 0.0234375, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777504367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001953125, "waitRatioMax": 0.001953125, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.021484375, "writeRatioMax": 0.021484375 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.111328125, "computeRatioMax": 0.111328125, "endMs": "1665777504463", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53261", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "76", "startMs": "1665777504401", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001953125, "waitRatioMax": 0.001953125, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.041015625, "writeRatioMax": 0.041015625 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.017578125, "computeRatioMax": 0.033203125, "endMs": "1665777504540", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10384", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "4240", "startMs": "1665777504468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.005859375, "writeMsAvg": "30", "writeMsMax": "64", "writeRatioAvg": 0.05859375, "writeRatioMax": 0.125 }, { "completedParallelInputs": "1", "computeMsAvg": "69", "computeMsMax": "69", "computeRatioAvg": 0.134765625, "computeRatioMax": 0.134765625, "endMs": "1665777504579", "id": "10", "inputStages": [ "6", "9" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01171875, "readRatioMax": 0.01171875, "recordsRead": "160384", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665777504473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($186, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $175, $181 := $176, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $2", "INNER HASH JOIN EACH WITH ALL ON $174 = $1" ] }, { "kind": "JOIN", "substeps": [ "$174 := $11, $175 := $12, $176 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005859375, "waitRatioMax": 0.005859375, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001953125, "writeRatioMax": 0.001953125 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.0078125, "computeRatioMax": 0.0078125, "endMs": "1665777504603", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665777504484", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.005859375, "writeRatioMax": 0.005859375 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "10", "elapsedMs": "644", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "2579" }, { "activeUnits": "3", "completedUnits": "114", "elapsedMs": "869", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7149" } ], "totalBytesBilled": "227540992", "totalBytesProcessed": "227070372", "totalPartitionsProcessed": "0", "totalSlotMs": "7149", "transferredBytes": "0" }, "startTime": "1665777503766", "totalBytesProcessed": "227070372", "totalSlotMs": "7149" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncf1972a6_5c15_45a0_9f5d_27133ab33b02" }, "priority": "INTERACTIVE", "query": "-- start query 46 in stream 0 using template query46.tpl\nselect c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,amt,profit \n from\n (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_coupon_amt) amt\n ,sum(ss_net_profit) profit\n from store_sales,date_dim,store,household_demographics,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and (household_demographics.hd_dep_count = 4 or\n household_demographics.hd_vehicle_count= 3)\n and date_dim.d_dow in (6,0)\n and date_dim.d_year in (1999,1999+1,1999+2) \n and store.s_city in ('Fairview','Fairview','Fairview','Midway','Fairview') \n group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n limit 100\n ;\n\n-- end query 46 in stream 0 using template query46.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "hfaKLClGWdsjdRywDKASLg==", "id": "test-project-364309:europe-west1.query46_1665777505", "jobReference": { "jobId": "query46_1665777505", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query46_1665777505?location=europe-west1", "statistics": { "creationTime": "1665777506675", "endTime": "1665777507550", "finalExecutionDurationMs": "633", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "227070372", "performanceInsights": { "avgPreviousExecutionMs": "757" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.05918367346938776, "computeRatioMax": 0.05918367346938776, "endMs": "1665777506894", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012244897959183673, "readRatioMax": 0.012244897959183673, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777506859", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020408163265306124, "waitRatioMax": 0.0020408163265306124, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.018367346938775512, "writeRatioMax": 0.018367346938775512 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.02857142857142857, "computeRatioMax": 0.02857142857142857, "endMs": "1665777506911", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.014285714285714285, "readRatioMax": 0.014285714285714285, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777506874", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 4), equal($32, 3))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020408163265306124, "waitRatioMax": 0.0020408163265306124, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.014285714285714285, "writeRatioMax": 0.014285714285714285 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.022448979591836733, "computeRatioMax": 0.022448979591836733, "endMs": "1665777506927", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0163265306122449, "readRatioMax": 0.0163265306122449, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777506888", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.04081632653061224, "writeRatioMax": 0.04081632653061224 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.030612244897959183, "computeRatioMax": 0.030612244897959183, "endMs": "1665777506942", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0163265306122449, "readRatioMax": 0.0163265306122449, "recordsRead": "73049", "recordsWritten": "314", "shuffleOutputBytes": "2826", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777506902", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dow", "FROM date_dim", "WHERE and(in($62, 6, 0), in($61, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020408163265306124, "waitRatioMax": 0.0020408163265306124, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.014285714285714285, "writeRatioMax": 0.014285714285714285 }, { "completedParallelInputs": "6", "computeMsAvg": "442", "computeMsMax": "490", "computeRatioAvg": 0.9020408163265307, "computeRatioMax": 1, "endMs": "1665777507267", "id": "5", "inputStages": [ "3", "2", "0", "1" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "35", "readRatioAvg": 0.04897959183673469, "readRatioMax": 0.07142857142857142, "recordsRead": "3193160", "recordsWritten": "53261", "shuffleOutputBytes": "3962064", "shuffleOutputBytesSpilled": "0", "slotMs": "2191", "startMs": "1665777506950", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145", "$80 := SUM($143)", "$81 := SUM($144)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.01020408163265306, "writeRatioMax": 0.014285714285714285 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.053061224489795916, "computeRatioMax": 0.053061224489795916, "endMs": "1665777507322", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012244897959183673, "readRatioMax": 0.012244897959183673, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777507290", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020408163265306124, "waitRatioMax": 0.0020408163265306124, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.014285714285714285, "writeRatioMax": 0.014285714285714285 }, { "completedParallelInputs": "1", "computeMsAvg": "83", "computeMsMax": "83", "computeRatioAvg": 0.16938775510204082, "computeRatioMax": 0.16938775510204082, "endMs": "1665777507354", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53261", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665777507313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0020408163265306124, "waitRatioMax": 0.0020408163265306124, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.00816326530612245, "writeRatioMax": 0.00816326530612245 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.014285714285714285, "computeRatioMax": 0.026530612244897958, "endMs": "1665777507405", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10384", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "2665", "startMs": "1665777507363", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.006122448979591836, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.02857142857142857, "writeRatioMax": 0.036734693877551024 }, { "completedParallelInputs": "1", "computeMsAvg": "64", "computeMsMax": "64", "computeRatioAvg": 0.1306122448979592, "computeRatioMax": 0.1306122448979592, "endMs": "1665777507450", "id": "10", "inputStages": [ "9", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0163265306122449, "readRatioMax": 0.0163265306122449, "recordsRead": "160384", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "86", "startMs": "1665777507366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($186, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $175, $181 := $176, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $2", "INNER HASH JOIN EACH WITH ALL ON $174 = $1" ] }, { "kind": "JOIN", "substeps": [ "$174 := $11, $175 := $12, $176 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006122448979591836, "waitRatioMax": 0.006122448979591836, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0020408163265306124, "writeRatioMax": 0.0020408163265306124 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.018367346938775512, "computeRatioMax": 0.018367346938775512, "endMs": "1665777507461", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777507377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.012244897959183673, "writeRatioMax": 0.012244897959183673 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "12", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2524" }, { "activeUnits": "0", "completedUnits": "114", "elapsedMs": "758", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5248" } ], "totalBytesBilled": "227540992", "totalBytesProcessed": "227070372", "totalPartitionsProcessed": "0", "totalSlotMs": "5248", "transferredBytes": "0" }, "startTime": "1665777506735", "totalBytesProcessed": "227070372", "totalSlotMs": "5248" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
BigQuery error in show operation: Not found: Job test-project-364309:europe- west1.query46_1665777509
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf50380f8_712b_4d52_a203_67ca1d170d23" }, "priority": "INTERACTIVE", "query": "-- start query 46 in stream 0 using template query46.tpl\nselect c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,amt,profit \n from\n (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_coupon_amt) amt\n ,sum(ss_net_profit) profit\n from store_sales,date_dim,store,household_demographics,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and (household_demographics.hd_dep_count = 4 or\n household_demographics.hd_vehicle_count= 3)\n and date_dim.d_dow in (6,0)\n and date_dim.d_year in (1999,1999+1,1999+2) \n and store.s_city in ('Fairview','Fairview','Fairview','Midway','Fairview') \n group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n limit 100\n ;\n\n-- end query 46 in stream 0 using template query46.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "i7Dgu36w9voA8Qa6nbumIA==", "id": "test-project-364309:europe-west1.query46_1665777657", "jobReference": { "jobId": "query46_1665777657", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query46_1665777657?location=europe-west1", "statistics": { "creationTime": "1665777657602", "endTime": "1665777658473", "finalExecutionDurationMs": "656", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "227070372", "performanceInsights": { "avgPreviousExecutionMs": "745" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.040145985401459854, "computeRatioMax": 0.040145985401459854, "endMs": "1665777657809", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.020072992700729927, "readRatioMax": 0.020072992700729927, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777657775", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.016423357664233577, "writeRatioMax": 0.016423357664233577 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.020072992700729927, "computeRatioMax": 0.020072992700729927, "endMs": "1665777657820", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0072992700729927005, "readRatioMax": 0.0072992700729927005, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777657790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 4), equal($32, 3))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.03102189781021898, "writeRatioMax": 0.03102189781021898 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.016423357664233577, "computeRatioMax": 0.016423357664233577, "endMs": "1665777657843", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0072992700729927005, "readRatioMax": 0.0072992700729927005, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777657803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.029197080291970802, "writeRatioMax": 0.029197080291970802 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.0364963503649635, "computeRatioMax": 0.0364963503649635, "endMs": "1665777657852", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.023722627737226276, "readRatioMax": 0.023722627737226276, "recordsRead": "73049", "recordsWritten": "314", "shuffleOutputBytes": "2826", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777657817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dow", "FROM date_dim", "WHERE and(in($62, 6, 0), in($61, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.016423357664233577, "writeRatioMax": 0.016423357664233577 }, { "completedParallelInputs": "6", "computeMsAvg": "479", "computeMsMax": "548", "computeRatioAvg": 0.8740875912408759, "computeRatioMax": 1, "endMs": "1665777658192", "id": "5", "inputStages": [ "3", "2", "1", "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "39", "readRatioAvg": 0.051094890510948905, "readRatioMax": 0.07116788321167883, "recordsRead": "3193160", "recordsWritten": "53261", "shuffleOutputBytes": "3962064", "shuffleOutputBytesSpilled": "0", "slotMs": "2387", "startMs": "1665777657865", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145", "$80 := SUM($143)", "$81 := SUM($144)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.012773722627737226, "writeRatioMax": 0.014598540145985401 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.04927007299270073, "computeRatioMax": 0.04927007299270073, "endMs": "1665777658248", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010948905109489052, "readRatioMax": 0.010948905109489052, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777658215", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01824817518248175, "writeRatioMax": 0.01824817518248175 }, { "completedParallelInputs": "1", "computeMsAvg": "50", "computeMsMax": "50", "computeRatioAvg": 0.09124087591240876, "computeRatioMax": 0.09124087591240876, "endMs": "1665777658293", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53261", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665777658242", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.0364963503649635, "writeRatioMax": 0.0364963503649635 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.014598540145985401, "computeRatioMax": 0.025547445255474453, "endMs": "1665777658350", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10384", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "3343", "startMs": "1665777658304", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.02737226277372263, "writeRatioMax": 0.03832116788321168 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.08029197080291971, "computeRatioMax": 0.08029197080291971, "endMs": "1665777658375", "id": "10", "inputStages": [ "9", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010948905109489052, "readRatioMax": 0.010948905109489052, "recordsRead": "160384", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777658307", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($186, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $175, $181 := $176, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $2", "INNER HASH JOIN EACH WITH ALL ON $174 = $1" ] }, { "kind": "JOIN", "substeps": [ "$174 := $11, $175 := $12, $176 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0018248175182481751, "writeRatioMax": 0.0018248175182481751 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.010948905109489052, "computeRatioMax": 0.010948905109489052, "endMs": "1665777658386", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777658319", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0072992700729927005, "writeRatioMax": 0.0072992700729927005 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "11", "elapsedMs": "614", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "2558" }, { "activeUnits": "2", "completedUnits": "114", "elapsedMs": "765", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5996" } ], "totalBytesBilled": "227540992", "totalBytesProcessed": "227070372", "totalPartitionsProcessed": "0", "totalSlotMs": "5996", "transferredBytes": "0" }, "startTime": "1665777657663", "totalBytesProcessed": "227070372", "totalSlotMs": "5996" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf9afe396_675a_48c8_a099_006882c8a9db" }, "priority": "INTERACTIVE", "query": "-- start query 46 in stream 0 using template query46.tpl\nselect c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,amt,profit \n from\n (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_coupon_amt) amt\n ,sum(ss_net_profit) profit\n from store_sales,date_dim,store,household_demographics,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and (household_demographics.hd_dep_count = 4 or\n household_demographics.hd_vehicle_count= 3)\n and date_dim.d_dow in (6,0)\n and date_dim.d_year in (1999,1999+1,1999+2) \n and store.s_city in ('Fairview','Fairview','Fairview','Midway','Fairview') \n group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n limit 100\n ;\n\n-- end query 46 in stream 0 using template query46.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8Gla571tidP3+SIZSTmqhQ==", "id": "test-project-364309:europe-west1.query46_1665777659", "jobReference": { "jobId": "query46_1665777659", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query46_1665777659?location=europe-west1", "statistics": { "creationTime": "1665777660034", "endTime": "1665777661183", "finalExecutionDurationMs": "919", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "227070372", "performanceInsights": { "avgPreviousExecutionMs": "737" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.040106951871657755, "computeRatioMax": 0.040106951871657755, "endMs": "1665777660271", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008021390374331552, "readRatioMax": 0.008021390374331552, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777660221", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.014705882352941176, "writeRatioMax": 0.014705882352941176 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012032085561497326, "computeRatioMax": 0.012032085561497326, "endMs": "1665777660281", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0053475935828877, "readRatioMax": 0.0053475935828877, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777660240", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 4), equal($32, 3))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.022727272727272728, "writeRatioMax": 0.022727272727272728 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009358288770053475, "computeRatioMax": 0.009358288770053475, "endMs": "1665777660297", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.004010695187165776, "readRatioMax": 0.004010695187165776, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777660258", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.022727272727272728, "writeRatioMax": 0.022727272727272728 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013368983957219251, "computeRatioMax": 0.013368983957219251, "endMs": "1665777660323", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.012032085561497326, "readRatioMax": 0.012032085561497326, "recordsRead": "73049", "recordsWritten": "314", "shuffleOutputBytes": "2826", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777660278", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dow", "FROM date_dim", "WHERE and(in($62, 6, 0), in($61, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.020053475935828877, "writeRatioMax": 0.020053475935828877 }, { "completedParallelInputs": "6", "computeMsAvg": "518", "computeMsMax": "748", "computeRatioAvg": 0.6925133689839572, "computeRatioMax": 1, "endMs": "1665777660829", "id": "5", "inputStages": [ "2", "0", "1", "3" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "43", "readRatioAvg": 0.0374331550802139, "readRatioMax": 0.05748663101604278, "recordsRead": "3193160", "recordsWritten": "53261", "shuffleOutputBytes": "3962064", "shuffleOutputBytesSpilled": "0", "slotMs": "2688", "startMs": "1665777660333", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145", "$80 := SUM($143)", "$81 := SUM($144)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "7", "writeMsMax": "12", "writeRatioAvg": 0.009358288770053475, "writeRatioMax": 0.016042780748663103 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.029411764705882353, "computeRatioMax": 0.029411764705882353, "endMs": "1665777660887", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0066844919786096255, "readRatioMax": 0.0066844919786096255, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777660855", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.017379679144385027, "writeRatioMax": 0.017379679144385027 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.07754010695187166, "computeRatioMax": 0.07754010695187166, "endMs": "1665777660942", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53261", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777660886", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001336898395721925, "waitRatioMax": 0.001336898395721925, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.026737967914438502, "writeRatioMax": 0.026737967914438502 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.012032085561497326, "computeRatioMax": 0.02406417112299465, "endMs": "1665777661002", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10384", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "3345", "startMs": "1665777660948", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00267379679144385, "waitRatioMax": 0.004010695187165776, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.020053475935828877, "writeRatioMax": 0.02540106951871658 }, { "completedParallelInputs": "1", "computeMsAvg": "116", "computeMsMax": "116", "computeRatioAvg": 0.15508021390374332, "computeRatioMax": 0.15508021390374332, "endMs": "1665777661069", "id": "10", "inputStages": [ "9", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.012032085561497326, "readRatioMax": 0.012032085561497326, "recordsRead": "160384", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "146", "startMs": "1665777660951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($186, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $175, $181 := $176, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $2", "INNER HASH JOIN EACH WITH ALL ON $174 = $1" ] }, { "kind": "JOIN", "substeps": [ "$174 := $11, $175 := $12, $176 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "TO __stage0A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0053475935828877, "waitRatioMax": 0.0053475935828877, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.00267379679144385, "writeRatioMax": 0.00267379679144385 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0066844919786096255, "computeRatioMax": 0.0066844919786096255, "endMs": "1665777661093", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665777660965", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004010695187165776, "waitRatioMax": 0.004010695187165776, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0053475935828877, "writeRatioMax": 0.0053475935828877 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "9", "elapsedMs": "630", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2684" }, { "activeUnits": "2", "completedUnits": "114", "elapsedMs": "1045", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6478" } ], "totalBytesBilled": "227540992", "totalBytesProcessed": "227070372", "totalPartitionsProcessed": "0", "totalSlotMs": "6478", "transferredBytes": "0" }, "startTime": "1665777660093", "totalBytesProcessed": "227070372", "totalSlotMs": "6478" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon12a2ded5_c895_4f97_968a_57ce3e6845cf" }, "priority": "INTERACTIVE", "query": "-- start query 46 in stream 0 using template query46.tpl\nselect c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,amt,profit \n from\n (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_coupon_amt) amt\n ,sum(ss_net_profit) profit\n from store_sales,date_dim,store,household_demographics,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and (household_demographics.hd_dep_count = 4 or\n household_demographics.hd_vehicle_count= 3)\n and date_dim.d_dow in (6,0)\n and date_dim.d_year in (1999,1999+1,1999+2) \n and store.s_city in ('Fairview','Fairview','Fairview','Midway','Fairview') \n group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n limit 100\n ;\n\n-- end query 46 in stream 0 using template query46.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "vJAle5NKgOJoBQtCb8Gl0w==", "id": "test-project-364309:europe-west1.query46_1665777662", "jobReference": { "jobId": "query46_1665777662", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query46_1665777662?location=europe-west1", "statistics": { "creationTime": "1665777662759", "endTime": "1665777663826", "finalExecutionDurationMs": "825", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "227070372", "performanceInsights": { "avgPreviousExecutionMs": "752" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.060263653483992465, "computeRatioMax": 0.060263653483992465, "endMs": "1665777662982", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011299435028248588, "readRatioMax": 0.011299435028248588, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777662944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018832391713747645, "waitRatioMax": 0.0018832391713747645, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.022598870056497175, "writeRatioMax": 0.022598870056497175 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.026365348399246705, "computeRatioMax": 0.026365348399246705, "endMs": "1665777662998", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007532956685499058, "readRatioMax": 0.007532956685499058, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777662959", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 4), equal($32, 3))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018832391713747645, "waitRatioMax": 0.0018832391713747645, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.030131826741996232, "writeRatioMax": 0.030131826741996232 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.018832391713747645, "computeRatioMax": 0.018832391713747645, "endMs": "1665777663034", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009416195856873822, "readRatioMax": 0.009416195856873822, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777662976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018832391713747645, "waitRatioMax": 0.0018832391713747645, "writeMsAvg": "33", "writeMsMax": "33", "writeRatioAvg": 0.062146892655367235, "writeRatioMax": 0.062146892655367235 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.018832391713747645, "computeRatioMax": 0.018832391713747645, "endMs": "1665777663048", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009416195856873822, "readRatioMax": 0.009416195856873822, "recordsRead": "73049", "recordsWritten": "314", "shuffleOutputBytes": "2826", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777662984", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dow", "FROM date_dim", "WHERE and(in($62, 6, 0), in($61, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018832391713747645, "waitRatioMax": 0.0018832391713747645, "writeMsAvg": "51", "writeMsMax": "51", "writeRatioAvg": 0.096045197740113, "writeRatioMax": 0.096045197740113 }, { "completedParallelInputs": "6", "computeMsAvg": "412", "computeMsMax": "531", "computeRatioAvg": 0.775894538606403, "computeRatioMax": 1, "endMs": "1665777663450", "id": "5", "inputStages": [ "1", "2", "3", "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "27", "readMsMax": "40", "readRatioAvg": 0.05084745762711865, "readRatioMax": 0.07532956685499058, "recordsRead": "3193160", "recordsWritten": "53261", "shuffleOutputBytes": "3962064", "shuffleOutputBytesSpilled": "0", "slotMs": "2430", "startMs": "1665777663069", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145", "$80 := SUM($143)", "$81 := SUM($144)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018832391713747645, "waitRatioMax": 0.0018832391713747645, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.011299435028248588, "writeRatioMax": 0.013182674199623353 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.047080979284369114, "computeRatioMax": 0.047080979284369114, "endMs": "1665777663504", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009416195856873822, "readRatioMax": 0.009416195856873822, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777663473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018832391713747645, "waitRatioMax": 0.0018832391713747645, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.11864406779661017, "computeRatioMax": 0.11864406779661017, "endMs": "1665777663575", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53261", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665777663507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018832391713747645, "waitRatioMax": 0.0018832391713747645, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.03954802259887006, "writeRatioMax": 0.03954802259887006 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.01694915254237288, "computeRatioMax": 0.035781544256120526, "endMs": "1665777663649", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10384", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "4547", "startMs": "1665777663579", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003766478342749529, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "28", "writeMsMax": "33", "writeRatioAvg": 0.05273069679849341, "writeRatioMax": 0.062146892655367235 }, { "completedParallelInputs": "1", "computeMsAvg": "86", "computeMsMax": "86", "computeRatioAvg": 0.16195856873822975, "computeRatioMax": 0.16195856873822975, "endMs": "1665777663703", "id": "10", "inputStages": [ "9", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.01694915254237288, "readRatioMax": 0.01694915254237288, "recordsRead": "160384", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "134", "startMs": "1665777663584", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($186, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $175, $181 := $176, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $2", "INNER HASH JOIN EACH WITH ALL ON $174 = $1" ] }, { "kind": "JOIN", "substeps": [ "$174 := $11, $175 := $12, $176 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0018832391713747645, "writeRatioMax": 0.0018832391713747645 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.011299435028248588, "computeRatioMax": 0.011299435028248588, "endMs": "1665777663719", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665777663612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003766478342749529, "waitRatioMax": 0.003766478342749529, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007532956685499058, "writeRatioMax": 0.007532956685499058 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "9", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2524" }, { "activeUnits": "2", "completedUnits": "114", "elapsedMs": "948", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7497" } ], "totalBytesBilled": "227540992", "totalBytesProcessed": "227070372", "totalPartitionsProcessed": "0", "totalSlotMs": "7497", "transferredBytes": "0" }, "startTime": "1665777662819", "totalBytesProcessed": "227070372", "totalSlotMs": "7497" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6473209a_0dfc_4c53_bf76_d70294a2af13" }, "priority": "INTERACTIVE", "query": "-- start query 46 in stream 0 using template query46.tpl\nselect c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,amt,profit \n from\n (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_coupon_amt) amt\n ,sum(ss_net_profit) profit\n from store_sales,date_dim,store,household_demographics,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and (household_demographics.hd_dep_count = 4 or\n household_demographics.hd_vehicle_count= 3)\n and date_dim.d_dow in (6,0)\n and date_dim.d_year in (1999,1999+1,1999+2) \n and store.s_city in ('Fairview','Fairview','Fairview','Midway','Fairview') \n group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n limit 100\n ;\n\n-- end query 46 in stream 0 using template query46.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "vyAN3x9udM79cxO6rYqIyQ==", "id": "test-project-364309:europe-west1.query46_1665777664", "jobReference": { "jobId": "query46_1665777664", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query46_1665777664?location=europe-west1", "statistics": { "creationTime": "1665777665412", "endTime": "1665777666388", "finalExecutionDurationMs": "729", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "227070372", "performanceInsights": { "avgPreviousExecutionMs": "757" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.04990403071017274, "computeRatioMax": 0.04990403071017274, "endMs": "1665777665631", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011516314779270634, "readRatioMax": 0.011516314779270634, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777665596", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019193857965451055, "waitRatioMax": 0.0019193857965451055, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02111324376199616, "writeRatioMax": 0.02111324376199616 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.013435700575815739, "computeRatioMax": 0.013435700575815739, "endMs": "1665777665651", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009596928982725527, "readRatioMax": 0.009596928982725527, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777665612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 4), equal($32, 3))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019193857965451055, "waitRatioMax": 0.0019193857965451055, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.030710172744721688, "writeRatioMax": 0.030710172744721688 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02111324376199616, "computeRatioMax": 0.02111324376199616, "endMs": "1665777665667", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009596928982725527, "readRatioMax": 0.009596928982725527, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777665626", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019193857965451055, "waitRatioMax": 0.0019193857965451055, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0345489443378119, "writeRatioMax": 0.0345489443378119 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.026871401151631478, "computeRatioMax": 0.026871401151631478, "endMs": "1665777665680", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.015355086372360844, "readRatioMax": 0.015355086372360844, "recordsRead": "73049", "recordsWritten": "314", "shuffleOutputBytes": "2826", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777665643", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dow", "FROM date_dim", "WHERE and(in($62, 6, 0), in($61, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019193857965451055, "waitRatioMax": 0.0019193857965451055, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02111324376199616, "writeRatioMax": 0.02111324376199616 }, { "completedParallelInputs": "6", "computeMsAvg": "409", "computeMsMax": "521", "computeRatioAvg": 0.7850287907869482, "computeRatioMax": 1, "endMs": "1665777666050", "id": "5", "inputStages": [ "0", "2", "1", "3" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "28", "readRatioAvg": 0.04222648752399232, "readRatioMax": 0.053742802303262956, "recordsRead": "3193160", "recordsWritten": "53261", "shuffleOutputBytes": "3962064", "shuffleOutputBytesSpilled": "0", "slotMs": "2241", "startMs": "1665777665698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145", "$80 := SUM($143)", "$81 := SUM($144)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019193857965451055, "waitRatioMax": 0.0019193857965451055, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.009596928982725527, "writeRatioMax": 0.013435700575815739 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.04990403071017274, "computeRatioMax": 0.04990403071017274, "endMs": "1665777666129", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011516314779270634, "readRatioMax": 0.011516314779270634, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777666093", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0019193857965451055, "waitRatioMax": 0.0019193857965451055, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02111324376199616, "writeRatioMax": 0.02111324376199616 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.10940499040307101, "computeRatioMax": 0.10940499040307101, "endMs": "1665777666184", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53261", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777666124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003838771593090211, "waitRatioMax": 0.003838771593090211, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.036468330134357005, "writeRatioMax": 0.036468330134357005 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.01727447216890595, "computeRatioMax": 0.03262955854126679, "endMs": "1665777666240", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10384", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "3327", "startMs": "1665777666191", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "5", "waitRatioAvg": 0.0019193857965451055, "waitRatioMax": 0.009596928982725527, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.028790786948176585, "writeRatioMax": 0.03838771593090211 }, { "completedParallelInputs": "1", "computeMsAvg": "64", "computeMsMax": "64", "computeRatioAvg": 0.12284069097888675, "computeRatioMax": 0.12284069097888675, "endMs": "1665777666286", "id": "10", "inputStages": [ "9", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.013435700575815739, "readRatioMax": 0.013435700575815739, "recordsRead": "160384", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "98", "startMs": "1665777666197", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($186, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $175, $181 := $176, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $2", "INNER HASH JOIN EACH WITH ALL ON $174 = $1" ] }, { "kind": "JOIN", "substeps": [ "$174 := $11, $175 := $12, $176 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "TO __stage0A_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.011516314779270634, "waitRatioMax": 0.011516314779270634, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0019193857965451055, "writeRatioMax": 0.0019193857965451055 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.019193857965451054, "computeRatioMax": 0.019193857965451054, "endMs": "1665777666292", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777666207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005758157389635317, "waitRatioMax": 0.005758157389635317, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007677543186180422, "writeRatioMax": 0.007677543186180422 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "622", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "2395" }, { "activeUnits": "1", "completedUnits": "114", "elapsedMs": "850", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5968" } ], "totalBytesBilled": "227540992", "totalBytesProcessed": "227070372", "totalPartitionsProcessed": "0", "totalSlotMs": "5968", "transferredBytes": "0" }, "startTime": "1665777665475", "totalBytesProcessed": "227070372", "totalSlotMs": "5968" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc8368d86_6eb0_469d_b0db_ffe69dfc5b87" }, "priority": "INTERACTIVE", "query": "-- start query 46 in stream 0 using template query46.tpl\nselect c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,amt,profit \n from\n (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_coupon_amt) amt\n ,sum(ss_net_profit) profit\n from store_sales,date_dim,store,household_demographics,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and (household_demographics.hd_dep_count = 4 or\n household_demographics.hd_vehicle_count= 3)\n and date_dim.d_dow in (6,0)\n and date_dim.d_year in (1999,1999+1,1999+2) \n and store.s_city in ('Fairview','Fairview','Fairview','Midway','Fairview') \n group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n limit 100\n ;\n\n-- end query 46 in stream 0 using template query46.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "QoxFnbcvfX5Fp+6Vwv975w==", "id": "test-project-364309:europe-west1.query46_1665777667", "jobReference": { "jobId": "query46_1665777667", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query46_1665777667?location=europe-west1", "statistics": { "creationTime": "1665777667936", "endTime": "1665777669073", "finalExecutionDurationMs": "828", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "227070372", "performanceInsights": { "avgPreviousExecutionMs": "755" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.03966942148760331, "computeRatioMax": 0.03966942148760331, "endMs": "1665777668222", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009917355371900827, "readRatioMax": 0.009917355371900827, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777668185", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.023140495867768594, "writeRatioMax": 0.023140495867768594 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01652892561983471, "computeRatioMax": 0.01652892561983471, "endMs": "1665777668244", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006611570247933884, "readRatioMax": 0.006611570247933884, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777668204", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 4), equal($32, 3))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.026446280991735537, "writeRatioMax": 0.026446280991735537 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.013223140495867768, "computeRatioMax": 0.013223140495867768, "endMs": "1665777668267", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006611570247933884, "readRatioMax": 0.006611570247933884, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777668227", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003305785123966942, "waitRatioMax": 0.003305785123966942, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.03140495867768595, "writeRatioMax": 0.03140495867768595 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.021487603305785124, "computeRatioMax": 0.021487603305785124, "endMs": "1665777668287", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011570247933884297, "readRatioMax": 0.011570247933884297, "recordsRead": "73049", "recordsWritten": "314", "shuffleOutputBytes": "2826", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777668242", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dow", "FROM date_dim", "WHERE and(in($62, 6, 0), in($61, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.024793388429752067, "writeRatioMax": 0.024793388429752067 }, { "completedParallelInputs": "6", "computeMsAvg": "424", "computeMsMax": "605", "computeRatioAvg": 0.7008264462809918, "computeRatioMax": 1, "endMs": "1665777668693", "id": "5", "inputStages": [ "0", "2", "3", "1" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "30", "readRatioAvg": 0.03636363636363636, "readRatioMax": 0.049586776859504134, "recordsRead": "3193160", "recordsWritten": "53261", "shuffleOutputBytes": "3962064", "shuffleOutputBytesSpilled": "0", "slotMs": "2618", "startMs": "1665777668298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145", "$80 := SUM($143)", "$81 := SUM($144)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0049586776859504135, "waitRatioMax": 0.006611570247933884, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.009917355371900827, "writeRatioMax": 0.011570247933884297 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.0512396694214876, "computeRatioMax": 0.0512396694214876, "endMs": "1665777668764", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009917355371900827, "readRatioMax": 0.009917355371900827, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777668729", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013223140495867768, "writeRatioMax": 0.013223140495867768 }, { "completedParallelInputs": "1", "computeMsAvg": "88", "computeMsMax": "88", "computeRatioAvg": 0.14545454545454545, "computeRatioMax": 0.14545454545454545, "endMs": "1665777668847", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53261", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "108", "startMs": "1665777668761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003305785123966942, "waitRatioMax": 0.003305785123966942, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03966942148760331, "writeRatioMax": 0.03966942148760331 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.01487603305785124, "computeRatioMax": 0.024793388429752067, "endMs": "1665777668905", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10384", "recordsWritten": "10384", "shuffleOutputBytes": "680788", "shuffleOutputBytesSpilled": "0", "slotMs": "3370", "startMs": "1665777668851", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003305785123966942, "waitRatioMax": 0.0049586776859504135, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.024793388429752067, "writeRatioMax": 0.03305785123966942 }, { "completedParallelInputs": "1", "computeMsAvg": "88", "computeMsMax": "88", "computeRatioAvg": 0.14545454545454545, "computeRatioMax": 0.14545454545454545, "endMs": "1665777668967", "id": "10", "inputStages": [ "9", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.01818181818181818, "readRatioMax": 0.01818181818181818, "recordsRead": "160384", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "92", "startMs": "1665777668855", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($186, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $175, $181 := $176, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $2", "INNER HASH JOIN EACH WITH ALL ON $174 = $1" ] }, { "kind": "JOIN", "substeps": [ "$174 := $11, $175 := $12, $176 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "TO __stage0A_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.008264462809917356, "waitRatioMax": 0.008264462809917356, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001652892561983471, "writeRatioMax": 0.001652892561983471 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.009917355371900827, "computeRatioMax": 0.009917355371900827, "endMs": "1665777668975", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7249", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777668869", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206", "TO __stage0B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.006611570247933884, "waitRatioMax": 0.006611570247933884, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.006611570247933884, "writeRatioMax": 0.006611570247933884 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "9", "elapsedMs": "647", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2348" }, { "activeUnits": "2", "completedUnits": "114", "elapsedMs": "977", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6609" } ], "totalBytesBilled": "227540992", "totalBytesProcessed": "227070372", "totalPartitionsProcessed": "0", "totalSlotMs": "6609", "transferredBytes": "0" }, "startTime": "1665777668040", "totalBytesProcessed": "227070372", "totalSlotMs": "6609" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
