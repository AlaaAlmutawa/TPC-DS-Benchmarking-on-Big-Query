{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2783c080_4346_4723_b239_49a797c85c59" }, "priority": "INTERACTIVE", "query": "select\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_state in ('KY','GA','NM') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n (not exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n not exists (select benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "qYQH8Z3+V+RuMQphw7maYQ==", "id": "test-project-364309:europe-west1.query69_1665768436", "jobReference": { "jobId": "query69_1665768436", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query69_1665768436?location=europe-west1", "statistics": { "creationTime": "1665768436841", "endTime": "1665768438282", "finalExecutionDurationMs": "1203", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "164955192", "performanceInsights": { "avgPreviousExecutionMs": "1222" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.038781163434903045, "computeRatioMax": 0.038781163434903045, "endMs": "1665768437071", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.024930747922437674, "readRatioMax": 0.024930747922437674, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768437032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), between($62, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0221606648199446, "writeRatioMax": 0.0221606648199446 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0221606648199446, "computeRatioMax": 0.0221606648199446, "endMs": "1665768437110", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01662049861495845, "readRatioMax": 0.01662049861495845, "recordsRead": "50000", "recordsWritten": "4891", "shuffleOutputBytes": "44019", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665768437083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address", "WHERE in($81, 'KY', 'GA', 'NM')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04155124653739612, "writeRatioMax": 0.04155124653739612 }, { "completedParallelInputs": "6", "computeMsAvg": "85", "computeMsMax": "116", "computeRatioAvg": 0.23545706371191136, "computeRatioMax": 0.32132963988919666, "endMs": "1665768437213", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "19", "readRatioAvg": 0.030470914127423823, "readRatioMax": 0.05263157894736842, "recordsRead": "2880950", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "556", "startMs": "1665768437113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.00554016620498615, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.0221606648199446, "writeRatioMax": 0.027700831024930747 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.09695290858725762, "computeRatioMax": 0.09695290858725762, "endMs": "1665768437181", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.027700831024930747, "readRatioMax": 0.027700831024930747, "recordsRead": "104891", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665768437130", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.036011080332409975, "writeRatioMax": 0.036011080332409975 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.024930747922437674, "computeRatioMax": 0.05817174515235457, "endMs": "1665768437248", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9460", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "3809", "startMs": "1665768437192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.00554016620498615, "waitRatioMax": 0.0110803324099723, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.04155124653739612, "writeRatioMax": 0.055401662049861494 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.0221606648199446, "computeRatioMax": 0.04709141274238227, "endMs": "1665768437283", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "77485", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "3217", "startMs": "1665768437226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00554016620498615, "waitRatioMax": 0.008310249307479225, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.04155124653739612, "writeRatioMax": 0.07479224376731301 }, { "completedParallelInputs": "1", "computeMsAvg": "361", "computeMsMax": "361", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768437501", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.04709141274238227, "readRatioMax": 0.04709141274238227, "recordsRead": "2007745", "recordsWritten": "9460", "shuffleOutputBytes": "956095", "shuffleOutputBytesSpilled": "0", "slotMs": "317", "startMs": "1665768437234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $276", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($275)", "$202 := ANY_VALUE($274)", "$203 := ANY_VALUE($273)", "$204 := ANY_VALUE($272)", "$205 := ANY_VALUE($271)", "$206 := ANY_VALUE($270)", "$207 := SUM($277)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $241, $271 := $242, $272 := $243, $273 := $244, $274 := $245, $275 := $240, $276 := $210, $277 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$241 := $41, $242 := $42, $243 := $43, $244 := $44, $245 := $45, $240 := $230", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0110803324099723, "waitRatioMax": 0.0110803324099723, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01662049861495845, "writeRatioMax": 0.01662049861495845 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0221606648199446, "computeRatioMax": 0.0221606648199446, "endMs": "1665768437592", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013850415512465374, "readRatioMax": 0.013850415512465374, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768437553", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2001), between($32, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0443213296398892, "writeRatioMax": 0.0443213296398892 }, { "completedParallelInputs": "1", "computeMsAvg": "90", "computeMsMax": "90", "computeRatioAvg": 0.24930747922437674, "computeRatioMax": 0.24930747922437674, "endMs": "1665768437704", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.024930747922437674, "readRatioMax": 0.024930747922437674, "recordsRead": "719475", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "208", "startMs": "1665768437621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.038781163434903045, "writeRatioMax": 0.038781163434903045 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.0221606648199446, "computeRatioMax": 0.04709141274238227, "endMs": "1665768437783", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21438", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "3167", "startMs": "1665768437726", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.008310249307479225, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.04155124653739612, "writeRatioMax": 0.07756232686980609 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.10249307479224377, "computeRatioMax": 0.10249307479224377, "endMs": "1665768437803", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30898", "recordsWritten": "625", "shuffleOutputBytes": "62335", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768437730", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($316)", "$162 := ANY_VALUE($315)", "$163 := ANY_VALUE($314)", "$164 := ANY_VALUE($313)", "$165 := ANY_VALUE($312)", "$166 := ANY_VALUE($311)", "$167 := SUM($317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $191 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($197), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := SUM($207)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0110803324099723, "waitRatioMax": 0.0110803324099723, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0110803324099723, "writeRatioMax": 0.0110803324099723 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.030470914127423823, "computeRatioMax": 0.030470914127423823, "endMs": "1665768437871", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0221606648199446, "readRatioMax": 0.0221606648199446, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665768437841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), between($12, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.036011080332409975, "writeRatioMax": 0.036011080332409975 }, { "completedParallelInputs": "5", "computeMsAvg": "73", "computeMsMax": "89", "computeRatioAvg": 0.20221606648199447, "computeRatioMax": 0.24653739612188366, "endMs": "1665768437967", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.036011080332409975, "readRatioMax": 0.0443213296398892, "recordsRead": "1442003", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "428", "startMs": "1665768437891", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $140", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.00554016620498615, "writeMsAvg": "10", "writeMsMax": "13", "writeRatioAvg": 0.027700831024930747, "writeRatioMax": 0.036011080332409975 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.024930747922437674, "computeRatioMax": 0.038781163434903045, "endMs": "1665768438025", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41280", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "3261", "startMs": "1665768437978", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00554016620498615, "waitRatioMax": 0.00554016620498615, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.04155124653739612, "writeRatioMax": 0.05817174515235457 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.10803324099722991, "computeRatioMax": 0.10803324099722991, "endMs": "1665768438056", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41905", "recordsWritten": "611", "shuffleOutputBytes": "55591", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768437992", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($355)", "$122 := ANY_VALUE($354)", "$123 := ANY_VALUE($353)", "$124 := ANY_VALUE($352)", "$125 := ANY_VALUE($351)", "$126 := SUM($356)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $151, $352 := $152, $353 := $153, $354 := $154, $355 := $155, $356 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $156 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($157), 0, $150), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$150 := SUM_OF_COUNTS($160)", "$151 := ANY_VALUE($161)", "$152 := ANY_VALUE($162)", "$153 := ANY_VALUE($163)", "$154 := ANY_VALUE($164)", "$155 := ANY_VALUE($165)", "$156 := ANY_VALUE($166)", "$157 := SUM($167)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.013850415512465374, "writeRatioMax": 0.013850415512465374 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.019390581717451522, "computeRatioMax": 0.019390581717451522, "endMs": "1665768438123", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "611", "recordsWritten": "550", "shuffleOutputBytes": "31205", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665768438088", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $115, $381 := $114, $382 := $113, $383 := $112, $384 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($116), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$100, $384, $383, $382, $381, $380", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07479224376731301, "writeRatioMax": 0.07479224376731301 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.024930747922437674, "computeRatioMax": 0.024930747922437674, "endMs": "1665768438166", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "550", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665768438129", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $384, $383, $382, $381, $380", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.038781163434903045, "writeRatioMax": 0.038781163434903045 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.036011080332409975, "computeRatioMax": 0.036011080332409975, "endMs": "1665768438195", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768438146", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$405 ASC, $404 ASC, $403 ASC, $402 ASC, $401 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002770083102493075, "waitRatioMax": 0.002770083102493075, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.030470914127423823, "writeRatioMax": 0.030470914127423823 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "210", "elapsedMs": "643", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7990" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1347", "estimatedRunnableUnits": "8", "pendingUnits": "0", "totalSlotMs": "15347" } ], "totalBytesBilled": "165675008", "totalBytesProcessed": "164955192", "totalPartitionsProcessed": "0", "totalSlotMs": "15347", "transferredBytes": "0" }, "startTime": "1665768436890", "totalBytesProcessed": "164955192", "totalSlotMs": "15347" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3ded06ae_cdde_4765_8d08_61b95bff25cc" }, "priority": "INTERACTIVE", "query": "select\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_state in ('KY','GA','NM') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n (not exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n not exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "YrVycyShT/L05tHnMmkNGg==", "id": "test-project-364309:europe-west1.query69_1665778412", "jobReference": { "jobId": "query69_1665778412", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query69_1665778412?location=europe-west1", "statistics": { "creationTime": "1665778412725", "endTime": "1665778414012", "finalExecutionDurationMs": "1027", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "164955192", "performanceInsights": { "avgPreviousExecutionMs": "1215" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.06593406593406594, "computeRatioMax": 0.06593406593406594, "endMs": "1665778412969", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.04395604395604396, "readRatioMax": 0.04395604395604396, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778412931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), between($62, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.003663003663003663, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05128205128205128, "writeRatioMax": 0.05128205128205128 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.029304029304029304, "computeRatioMax": 0.029304029304029304, "endMs": "1665778413025", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02197802197802198, "readRatioMax": 0.02197802197802198, "recordsRead": "50000", "recordsWritten": "4891", "shuffleOutputBytes": "44019", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778412995", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address", "WHERE in($81, 'KY', 'GA', 'NM')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "19", "waitMsMax": "19", "waitRatioAvg": 0.0695970695970696, "waitRatioMax": 0.0695970695970696, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05860805860805861, "writeRatioMax": 0.05860805860805861 }, { "completedParallelInputs": "6", "computeMsAvg": "102", "computeMsMax": "128", "computeRatioAvg": 0.37362637362637363, "computeRatioMax": 0.46886446886446886, "endMs": "1665778413106", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.047619047619047616, "readRatioMax": 0.06227106227106227, "recordsRead": "2880950", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "729", "startMs": "1665778413009", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.007326007326007326, "writeMsAvg": "11", "writeMsMax": "13", "writeRatioAvg": 0.040293040293040296, "writeRatioMax": 0.047619047619047616 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.10989010989010989, "computeRatioMax": 0.10989010989010989, "endMs": "1665778413097", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.04395604395604396, "readRatioMax": 0.04395604395604396, "recordsRead": "104891", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778413047", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007326007326007326, "waitRatioMax": 0.007326007326007326, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04395604395604396, "writeRatioMax": 0.04395604395604396 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.029304029304029304, "computeRatioMax": 0.06227106227106227, "endMs": "1665778413162", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9460", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "3541", "startMs": "1665778413111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.007326007326007326, "waitRatioMax": 0.01098901098901099, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.054945054945054944, "writeRatioMax": 0.10622710622710622 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.029304029304029304, "computeRatioMax": 0.06227106227106227, "endMs": "1665778413168", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "77485", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "3402", "startMs": "1665778413117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.007326007326007326, "waitRatioMax": 0.014652014652014652, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.05128205128205128, "writeRatioMax": 0.0695970695970696 }, { "completedParallelInputs": "1", "computeMsAvg": "273", "computeMsMax": "273", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778413346", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03663003663003663, "readRatioMax": 0.03663003663003663, "recordsRead": "2007745", "recordsWritten": "9460", "shuffleOutputBytes": "956095", "shuffleOutputBytesSpilled": "0", "slotMs": "259", "startMs": "1665778413121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $276", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($275)", "$202 := ANY_VALUE($274)", "$203 := ANY_VALUE($273)", "$204 := ANY_VALUE($272)", "$205 := ANY_VALUE($271)", "$206 := ANY_VALUE($270)", "$207 := SUM($277)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $241, $271 := $242, $272 := $243, $273 := $244, $274 := $245, $275 := $240, $276 := $210, $277 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$241 := $41, $242 := $42, $243 := $43, $244 := $44, $245 := $45, $240 := $230", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.003663003663003663, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02197802197802198, "writeRatioMax": 0.02197802197802198 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.054945054945054944, "computeRatioMax": 0.054945054945054944, "endMs": "1665778413405", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.05128205128205128, "readRatioMax": 0.05128205128205128, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778413367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2001), between($32, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007326007326007326, "waitRatioMax": 0.007326007326007326, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.040293040293040296, "writeRatioMax": 0.040293040293040296 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.358974358974359, "computeRatioMax": 0.358974358974359, "endMs": "1665778413493", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03296703296703297, "readRatioMax": 0.03296703296703297, "recordsRead": "719475", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "99", "startMs": "1665778413424", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.003663003663003663, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.029304029304029304, "writeRatioMax": 0.029304029304029304 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.029304029304029304, "computeRatioMax": 0.054945054945054944, "endMs": "1665778413566", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21438", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "3257", "startMs": "1665778413513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.007326007326007326, "writeMsAvg": "15", "writeMsMax": "23", "writeRatioAvg": 0.054945054945054944, "writeRatioMax": 0.08424908424908426 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.11721611721611722, "computeRatioMax": 0.11721611721611722, "endMs": "1665778413588", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30898", "recordsWritten": "625", "shuffleOutputBytes": "62335", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778413517", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($316)", "$162 := ANY_VALUE($315)", "$163 := ANY_VALUE($314)", "$164 := ANY_VALUE($313)", "$165 := ANY_VALUE($312)", "$166 := ANY_VALUE($311)", "$167 := SUM($317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $191 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($197), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := SUM($207)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01098901098901099, "waitRatioMax": 0.01098901098901099, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.014652014652014652, "writeRatioMax": 0.014652014652014652 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04395604395604396, "computeRatioMax": 0.04395604395604396, "endMs": "1665778413642", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.040293040293040296, "readRatioMax": 0.040293040293040296, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778413611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), between($12, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.003663003663003663, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.03663003663003663, "writeRatioMax": 0.03663003663003663 }, { "completedParallelInputs": "5", "computeMsAvg": "65", "computeMsMax": "96", "computeRatioAvg": 0.23809523809523808, "computeRatioMax": 0.3516483516483517, "endMs": "1665778413734", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "15", "readRatioAvg": 0.03663003663003663, "readRatioMax": 0.054945054945054944, "recordsRead": "1442003", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "400", "startMs": "1665778413659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $140", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.003663003663003663, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.029304029304029304, "writeRatioMax": 0.03663003663003663 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.029304029304029304, "computeRatioMax": 0.06593406593406594, "endMs": "1665778413794", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41280", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "3656", "startMs": "1665778413737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.007326007326007326, "waitRatioMax": 0.01098901098901099, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.054945054945054944, "writeRatioMax": 0.09157509157509157 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.08791208791208792, "computeRatioMax": 0.08791208791208792, "endMs": "1665778413812", "id": "19", "inputStages": [ "14", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41905", "recordsWritten": "611", "shuffleOutputBytes": "55591", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778413752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($355)", "$122 := ANY_VALUE($354)", "$123 := ANY_VALUE($353)", "$124 := ANY_VALUE($352)", "$125 := ANY_VALUE($351)", "$126 := SUM($356)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $151, $352 := $152, $353 := $153, $354 := $154, $355 := $155, $356 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $156 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($157), 0, $150), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$150 := SUM_OF_COUNTS($160)", "$151 := ANY_VALUE($161)", "$152 := ANY_VALUE($162)", "$153 := ANY_VALUE($163)", "$154 := ANY_VALUE($164)", "$155 := ANY_VALUE($165)", "$156 := ANY_VALUE($166)", "$157 := SUM($167)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.014652014652014652, "waitRatioMax": 0.014652014652014652, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.018315018315018316, "writeRatioMax": 0.018315018315018316 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03663003663003663, "computeRatioMax": 0.03663003663003663, "endMs": "1665778413868", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "611", "recordsWritten": "550", "shuffleOutputBytes": "31205", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778413830", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $115, $381 := $114, $382 := $113, $383 := $112, $384 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($116), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$100, $384, $383, $382, $381, $380", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.003663003663003663, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05860805860805861, "writeRatioMax": 0.05860805860805861 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.029304029304029304, "computeRatioMax": 0.029304029304029304, "endMs": "1665778413916", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "550", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778413881", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $384, $383, $382, $381, $380", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.003663003663003663, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.05128205128205128, "writeRatioMax": 0.05128205128205128 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03663003663003663, "computeRatioMax": 0.03663003663003663, "endMs": "1665778413927", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778413896", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$405 ASC, $404 ASC, $403 ASC, $402 ASC, $401 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003663003663003663, "waitRatioMax": 0.003663003663003663, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.029304029304029304, "writeRatioMax": 0.029304029304029304 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "626", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "8079" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1157", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15717" } ], "totalBytesBilled": "165675008", "totalBytesProcessed": "164955192", "totalPartitionsProcessed": "0", "totalSlotMs": "15717", "transferredBytes": "0" }, "startTime": "1665778412806", "totalBytesProcessed": "164955192", "totalSlotMs": "15717" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6fa49b1d_21ab_4767_986f_596cf478833b" }, "priority": "INTERACTIVE", "query": "select\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_state in ('KY','GA','NM') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n (not exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n not exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "RJRj8NsYQ3EztGP/UoBu+A==", "id": "test-project-364309:europe-west1.query69_1665778415", "jobReference": { "jobId": "query69_1665778415", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query69_1665778415?location=europe-west1", "statistics": { "creationTime": "1665778415692", "endTime": "1665778417080", "finalExecutionDurationMs": "1097", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "164955192", "performanceInsights": { "avgPreviousExecutionMs": "1168" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03076923076923077, "computeRatioMax": 0.03076923076923077, "endMs": "1665778415948", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.024615384615384615, "readRatioMax": 0.024615384615384615, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "86", "startMs": "1665778415907", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), between($62, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.07384615384615385, "writeRatioMax": 0.07384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.033846153846153845, "computeRatioMax": 0.033846153846153845, "endMs": "1665778415983", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.021538461538461538, "readRatioMax": 0.021538461538461538, "recordsRead": "50000", "recordsWritten": "4891", "shuffleOutputBytes": "44019", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665778415949", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address", "WHERE in($81, 'KY', 'GA', 'NM')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.015384615384615385, "writeRatioMax": 0.015384615384615385 }, { "completedParallelInputs": "6", "computeMsAvg": "86", "computeMsMax": "125", "computeRatioAvg": 0.26461538461538464, "computeRatioMax": 0.38461538461538464, "endMs": "1665778416097", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "19", "readRatioAvg": 0.03076923076923077, "readRatioMax": 0.05846153846153846, "recordsRead": "2880950", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "1113", "startMs": "1665778415979", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "8", "writeMsMax": "15", "writeRatioAvg": 0.024615384615384615, "writeRatioMax": 0.046153846153846156 }, { "completedParallelInputs": "1", "computeMsAvg": "53", "computeMsMax": "53", "computeRatioAvg": 0.16307692307692306, "computeRatioMax": 0.16307692307692306, "endMs": "1665778416056", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.021538461538461538, "readRatioMax": 0.021538461538461538, "recordsRead": "104891", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665778416008", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.024615384615384615, "writeRatioMax": 0.024615384615384615 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.021538461538461538, "computeRatioMax": 0.043076923076923075, "endMs": "1665778416132", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9460", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "3701", "startMs": "1665778416076", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006153846153846154, "waitRatioMax": 0.009230769230769232, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.043076923076923075, "writeRatioMax": 0.052307692307692305 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.024615384615384615, "computeRatioMax": 0.05846153846153846, "endMs": "1665778416159", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "77485", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "3630", "startMs": "1665778416102", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.006153846153846154, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.046153846153846156, "writeRatioMax": 0.06153846153846154 }, { "completedParallelInputs": "1", "computeMsAvg": "325", "computeMsMax": "325", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778416370", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.04, "readRatioMax": 0.04, "recordsRead": "2007745", "recordsWritten": "9460", "shuffleOutputBytes": "956095", "shuffleOutputBytesSpilled": "0", "slotMs": "345", "startMs": "1665778416105", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $276", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($275)", "$202 := ANY_VALUE($274)", "$203 := ANY_VALUE($273)", "$204 := ANY_VALUE($272)", "$205 := ANY_VALUE($271)", "$206 := ANY_VALUE($270)", "$207 := SUM($277)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $241, $271 := $242, $272 := $243, $273 := $244, $274 := $245, $275 := $240, $276 := $210, $277 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$241 := $41, $242 := $42, $243 := $43, $244 := $44, $245 := $45, $240 := $230", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.018461538461538463, "waitRatioMax": 0.018461538461538463, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012307692307692308, "writeRatioMax": 0.012307692307692308 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.043076923076923075, "computeRatioMax": 0.043076923076923075, "endMs": "1665778416465", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.03076923076923077, "readRatioMax": 0.03076923076923077, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778416432", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2001), between($32, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009230769230769232, "waitRatioMax": 0.009230769230769232, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.033846153846153845, "writeRatioMax": 0.033846153846153845 }, { "completedParallelInputs": "1", "computeMsAvg": "61", "computeMsMax": "61", "computeRatioAvg": 0.18769230769230769, "computeRatioMax": 0.18769230769230769, "endMs": "1665778416546", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.021538461538461538, "readRatioMax": 0.021538461538461538, "recordsRead": "719475", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665778416483", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.052307692307692305, "writeRatioMax": 0.052307692307692305 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.024615384615384615, "computeRatioMax": 0.05846153846153846, "endMs": "1665778416623", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21438", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "3359", "startMs": "1665778416565", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.009230769230769232, "writeMsAvg": "13", "writeMsMax": "45", "writeRatioAvg": 0.04, "writeRatioMax": 0.13846153846153847 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.10461538461538461, "computeRatioMax": 0.10461538461538461, "endMs": "1665778416638", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30898", "recordsWritten": "625", "shuffleOutputBytes": "62335", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778416568", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($316)", "$162 := ANY_VALUE($315)", "$163 := ANY_VALUE($314)", "$164 := ANY_VALUE($313)", "$165 := ANY_VALUE($312)", "$166 := ANY_VALUE($311)", "$167 := SUM($317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $191 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($197), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := SUM($207)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009230769230769232, "waitRatioMax": 0.009230769230769232, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012307692307692308, "writeRatioMax": 0.012307692307692308 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.046153846153846156, "computeRatioMax": 0.046153846153846156, "endMs": "1665778416700", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.027692307692307693, "readRatioMax": 0.027692307692307693, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778416655", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), between($12, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04, "writeRatioMax": 0.04 }, { "completedParallelInputs": "5", "computeMsAvg": "56", "computeMsMax": "66", "computeRatioAvg": 0.1723076923076923, "computeRatioMax": 0.20307692307692307, "endMs": "1665778416786", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.033846153846153845, "readRatioMax": 0.046153846153846156, "recordsRead": "1442003", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "356", "startMs": "1665778416722", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $140", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.024615384615384615, "writeRatioMax": 0.027692307692307693 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.024615384615384615, "computeRatioMax": 0.043076923076923075, "endMs": "1665778416842", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41280", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "3294", "startMs": "1665778416790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.006153846153846154, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.043076923076923075, "writeRatioMax": 0.05846153846153846 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.055384615384615386, "computeRatioMax": 0.055384615384615386, "endMs": "1665778416856", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41905", "recordsWritten": "611", "shuffleOutputBytes": "55591", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778416802", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($355)", "$122 := ANY_VALUE($354)", "$123 := ANY_VALUE($353)", "$124 := ANY_VALUE($352)", "$125 := ANY_VALUE($351)", "$126 := SUM($356)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $151, $352 := $152, $353 := $153, $354 := $154, $355 := $155, $356 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $156 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($157), 0, $150), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$150 := SUM_OF_COUNTS($160)", "$151 := ANY_VALUE($161)", "$152 := ANY_VALUE($162)", "$153 := ANY_VALUE($163)", "$154 := ANY_VALUE($164)", "$155 := ANY_VALUE($165)", "$156 := ANY_VALUE($166)", "$157 := SUM($167)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006153846153846154, "waitRatioMax": 0.006153846153846154, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.009230769230769232, "writeRatioMax": 0.009230769230769232 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.024615384615384615, "computeRatioMax": 0.024615384615384615, "endMs": "1665778416920", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "611", "recordsWritten": "550", "shuffleOutputBytes": "31205", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778416885", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $115, $381 := $114, $382 := $113, $383 := $112, $384 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($116), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$100, $384, $383, $382, $381, $380", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.046153846153846156, "writeRatioMax": 0.046153846153846156 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.024615384615384615, "computeRatioMax": 0.024615384615384615, "endMs": "1665778416963", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "550", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778416931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $384, $383, $382, $381, $380", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.043076923076923075, "writeRatioMax": 0.043076923076923075 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.021538461538461538, "computeRatioMax": 0.021538461538461538, "endMs": "1665778416974", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778416946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$405 ASC, $404 ASC, $403 ASC, $402 ASC, $401 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.018461538461538463, "writeRatioMax": 0.018461538461538463 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "210", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9023" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1233", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "16335" } ], "totalBytesBilled": "165675008", "totalBytesProcessed": "164955192", "totalPartitionsProcessed": "0", "totalSlotMs": "16335", "transferredBytes": "0" }, "startTime": "1665778415775", "totalBytesProcessed": "164955192", "totalSlotMs": "16335" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4b0cbe28_6940_4452_a448_f8453894a4f0" }, "priority": "INTERACTIVE", "query": "select\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_state in ('KY','GA','NM') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n (not exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n not exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "FRoTcOddv1N9Uk5w0RF3Qw==", "id": "test-project-364309:europe-west1.query69_1665778418", "jobReference": { "jobId": "query69_1665778418", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query69_1665778418?location=europe-west1", "statistics": { "creationTime": "1665778418894", "endTime": "1665778420445", "finalExecutionDurationMs": "1302", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "164955192", "performanceInsights": { "avgPreviousExecutionMs": "1154" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02346041055718475, "computeRatioMax": 0.02346041055718475, "endMs": "1665778419126", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.020527859237536656, "readRatioMax": 0.020527859237536656, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778419085", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), between($62, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005865102639296188, "waitRatioMax": 0.005865102639296188, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04398826979472141, "writeRatioMax": 0.04398826979472141 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.026392961876832845, "computeRatioMax": 0.026392961876832845, "endMs": "1665778419186", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.026392961876832845, "readRatioMax": 0.026392961876832845, "recordsRead": "50000", "recordsWritten": "4891", "shuffleOutputBytes": "44019", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778419150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address", "WHERE in($81, 'KY', 'GA', 'NM')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "18", "waitMsMax": "18", "waitRatioAvg": 0.05278592375366569, "waitRatioMax": 0.05278592375366569, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.026392961876832845, "writeRatioMax": 0.026392961876832845 }, { "completedParallelInputs": "6", "computeMsAvg": "95", "computeMsMax": "153", "computeRatioAvg": 0.2785923753665689, "computeRatioMax": 0.44868035190615835, "endMs": "1665778419267", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "14", "readRatioAvg": 0.02932551319648094, "readRatioMax": 0.04105571847507331, "recordsRead": "2880950", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "517", "startMs": "1665778419167", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005865102639296188, "waitRatioMax": 0.005865102639296188, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.020527859237536656, "writeRatioMax": 0.02346041055718475 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.11436950146627566, "computeRatioMax": 0.11436950146627566, "endMs": "1665778419284", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.017595307917888565, "readRatioMax": 0.017595307917888565, "recordsRead": "104891", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665778419215", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002932551319648094, "waitRatioMax": 0.002932551319648094, "writeMsAvg": "39", "writeMsMax": "39", "writeRatioAvg": 0.11436950146627566, "writeRatioMax": 0.11436950146627566 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.02346041055718475, "computeRatioMax": 0.04398826979472141, "endMs": "1665778419372", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9460", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "4827", "startMs": "1665778419302", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "4", "waitMsMax": "10", "waitRatioAvg": 0.011730205278592375, "waitRatioMax": 0.02932551319648094, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.04105571847507331, "writeRatioMax": 0.06744868035190615 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.020527859237536656, "computeRatioMax": 0.04105571847507331, "endMs": "1665778419356", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "77485", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "3075", "startMs": "1665778419302", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "8", "waitMsMax": "12", "waitRatioAvg": 0.02346041055718475, "waitRatioMax": 0.03519061583577713, "writeMsAvg": "10", "writeMsMax": "19", "writeRatioAvg": 0.02932551319648094, "writeRatioMax": 0.05571847507331378 }, { "completedParallelInputs": "1", "computeMsAvg": "341", "computeMsMax": "341", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778419614", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02932551319648094, "readRatioMax": 0.02932551319648094, "recordsRead": "2007745", "recordsWritten": "9460", "shuffleOutputBytes": "956095", "shuffleOutputBytesSpilled": "0", "slotMs": "357", "startMs": "1665778419315", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $276", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($275)", "$202 := ANY_VALUE($274)", "$203 := ANY_VALUE($273)", "$204 := ANY_VALUE($272)", "$205 := ANY_VALUE($271)", "$206 := ANY_VALUE($270)", "$207 := SUM($277)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $241, $271 := $242, $272 := $243, $273 := $244, $274 := $245, $275 := $240, $276 := $210, $277 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$241 := $41, $242 := $42, $243 := $43, $244 := $44, $245 := $45, $240 := $230", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.02346041055718475, "waitRatioMax": 0.02346041055718475, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02346041055718475, "writeRatioMax": 0.02346041055718475 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.04105571847507331, "computeRatioMax": 0.04105571847507331, "endMs": "1665778419743", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.026392961876832845, "readRatioMax": 0.026392961876832845, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778419695", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2001), between($32, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005865102639296188, "waitRatioMax": 0.005865102639296188, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04105571847507331, "writeRatioMax": 0.04105571847507331 }, { "completedParallelInputs": "1", "computeMsAvg": "111", "computeMsMax": "111", "computeRatioAvg": 0.3255131964809384, "computeRatioMax": 0.3255131964809384, "endMs": "1665778419847", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.020527859237536656, "readRatioMax": 0.020527859237536656, "recordsRead": "719475", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "119", "startMs": "1665778419771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002932551319648094, "waitRatioMax": 0.002932551319648094, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.026392961876832845, "writeRatioMax": 0.026392961876832845 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.026392961876832845, "computeRatioMax": 0.05865102639296188, "endMs": "1665778419921", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21438", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "4752", "startMs": "1665778419868", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.008797653958944282, "waitRatioMax": 0.017595307917888565, "writeMsAvg": "19", "writeMsMax": "29", "writeRatioAvg": 0.05571847507331378, "writeRatioMax": 0.08504398826979472 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.08797653958944282, "computeRatioMax": 0.08797653958944282, "endMs": "1665778419945", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30898", "recordsWritten": "625", "shuffleOutputBytes": "62335", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778419872", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($316)", "$162 := ANY_VALUE($315)", "$163 := ANY_VALUE($314)", "$164 := ANY_VALUE($313)", "$165 := ANY_VALUE($312)", "$166 := ANY_VALUE($311)", "$167 := SUM($317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $191 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($197), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := SUM($207)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008797653958944282, "waitRatioMax": 0.008797653958944282, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.008797653958944282, "writeRatioMax": 0.008797653958944282 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03225806451612903, "computeRatioMax": 0.03225806451612903, "endMs": "1665778420041", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.0469208211143695, "readRatioMax": 0.0469208211143695, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778419999", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), between($12, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005865102639296188, "waitRatioMax": 0.005865102639296188, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.017595307917888565, "writeRatioMax": 0.017595307917888565 }, { "completedParallelInputs": "5", "computeMsAvg": "55", "computeMsMax": "77", "computeRatioAvg": 0.16129032258064516, "computeRatioMax": 0.22580645161290322, "endMs": "1665778420119", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "8", "readMsMax": "9", "readRatioAvg": 0.02346041055718475, "readRatioMax": 0.026392961876832845, "recordsRead": "1442003", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "294", "startMs": "1665778420063", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $140", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002932551319648094, "waitRatioMax": 0.002932551319648094, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.017595307917888565, "writeRatioMax": 0.020527859237536656 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.02346041055718475, "computeRatioMax": 0.04398826979472141, "endMs": "1665778420187", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41280", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "3718", "startMs": "1665778420125", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005865102639296188, "waitRatioMax": 0.008797653958944282, "writeMsAvg": "15", "writeMsMax": "22", "writeRatioAvg": 0.04398826979472141, "writeRatioMax": 0.06451612903225806 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.06158357771260997, "computeRatioMax": 0.06158357771260997, "endMs": "1665778420201", "id": "19", "inputStages": [ "14", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41905", "recordsWritten": "611", "shuffleOutputBytes": "55591", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778420143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($355)", "$122 := ANY_VALUE($354)", "$123 := ANY_VALUE($353)", "$124 := ANY_VALUE($352)", "$125 := ANY_VALUE($351)", "$126 := SUM($356)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $151, $352 := $152, $353 := $153, $354 := $154, $355 := $155, $356 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $156 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($157), 0, $150), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$150 := SUM_OF_COUNTS($160)", "$151 := ANY_VALUE($161)", "$152 := ANY_VALUE($162)", "$153 := ANY_VALUE($163)", "$154 := ANY_VALUE($164)", "$155 := ANY_VALUE($165)", "$156 := ANY_VALUE($166)", "$157 := SUM($167)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.01466275659824047, "waitRatioMax": 0.01466275659824047, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.011730205278592375, "writeRatioMax": 0.011730205278592375 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03519061583577713, "computeRatioMax": 0.03519061583577713, "endMs": "1665778420270", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "611", "recordsWritten": "550", "shuffleOutputBytes": "31205", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778420231", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $115, $381 := $114, $382 := $113, $383 := $112, $384 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($116), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$100, $384, $383, $382, $381, $380", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005865102639296188, "waitRatioMax": 0.005865102639296188, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0469208211143695, "writeRatioMax": 0.0469208211143695 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02346041055718475, "computeRatioMax": 0.02346041055718475, "endMs": "1665778420329", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "550", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778420290", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $384, $383, $382, $381, $380", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405", "TO __stage15_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.017595307917888565, "waitRatioMax": 0.017595307917888565, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.04985337243401759, "writeRatioMax": 0.04985337243401759 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.017595307917888565, "computeRatioMax": 0.017595307917888565, "endMs": "1665778420350", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778420306", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$405 ASC, $404 ASC, $403 ASC, $402 ASC, $401 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415", "TO __stage16_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.011730205278592375, "waitRatioMax": 0.011730205278592375, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.020527859237536656, "writeRatioMax": 0.020527859237536656 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "8712" }, { "activeUnits": "6", "completedUnits": "423", "elapsedMs": "1449", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "17855" } ], "totalBytesBilled": "165675008", "totalBytesProcessed": "164955192", "totalPartitionsProcessed": "0", "totalSlotMs": "17855", "transferredBytes": "0" }, "startTime": "1665778418953", "totalBytesProcessed": "164955192", "totalSlotMs": "17855" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5dfeb797_d8bb_426b_9124_ea60b4ee3344" }, "priority": "INTERACTIVE", "query": "select\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_state in ('KY','GA','NM') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n (not exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n not exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "pUbdL91QbKHX81yltpchNw==", "id": "test-project-364309:europe-west1.query69_1665778422", "jobReference": { "jobId": "query69_1665778422", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query69_1665778422?location=europe-west1", "statistics": { "creationTime": "1665778423026", "endTime": "1665778424455", "finalExecutionDurationMs": "1174", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "164955192", "performanceInsights": { "avgPreviousExecutionMs": "1179" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.045317220543806644, "computeRatioMax": 0.045317220543806644, "endMs": "1665778423256", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.04833836858006042, "readRatioMax": 0.04833836858006042, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778423223", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), between($62, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.021148036253776436, "writeRatioMax": 0.021148036253776436 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02416918429003021, "computeRatioMax": 0.02416918429003021, "endMs": "1665778423332", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01812688821752266, "readRatioMax": 0.01812688821752266, "recordsRead": "50000", "recordsWritten": "4891", "shuffleOutputBytes": "44019", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778423292", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address", "WHERE in($81, 'KY', 'GA', 'NM')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "23", "waitMsMax": "23", "waitRatioAvg": 0.06948640483383686, "waitRatioMax": 0.06948640483383686, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.045317220543806644, "writeRatioMax": 0.045317220543806644 }, { "completedParallelInputs": "6", "computeMsAvg": "74", "computeMsMax": "98", "computeRatioAvg": 0.22356495468277945, "computeRatioMax": 0.29607250755287007, "endMs": "1665778423388", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "13", "readRatioAvg": 0.027190332326283987, "readRatioMax": 0.03927492447129909, "recordsRead": "2880950", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "429", "startMs": "1665778423313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.021148036253776436, "writeRatioMax": 0.02416918429003021 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.09667673716012085, "computeRatioMax": 0.09667673716012085, "endMs": "1665778423406", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01812688821752266, "readRatioMax": 0.01812688821752266, "recordsRead": "104891", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778423360", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.027190332326283987, "writeRatioMax": 0.027190332326283987 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.02416918429003021, "computeRatioMax": 0.03927492447129909, "endMs": "1665778423474", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9460", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "3228", "startMs": "1665778423418", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.00906344410876133, "waitRatioMax": 0.015105740181268883, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.045317220543806644, "writeRatioMax": 0.08761329305135952 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.02416918429003021, "computeRatioMax": 0.045317220543806644, "endMs": "1665778423475", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "77485", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "3228", "startMs": "1665778423417", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.015105740181268883, "waitRatioMax": 0.021148036253776436, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.045317220543806644, "writeRatioMax": 0.09063444108761329 }, { "completedParallelInputs": "1", "computeMsAvg": "331", "computeMsMax": "331", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778423686", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03323262839879154, "readRatioMax": 0.03323262839879154, "recordsRead": "2007745", "recordsWritten": "9460", "shuffleOutputBytes": "956095", "shuffleOutputBytesSpilled": "0", "slotMs": "343", "startMs": "1665778423430", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $276", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($275)", "$202 := ANY_VALUE($274)", "$203 := ANY_VALUE($273)", "$204 := ANY_VALUE($272)", "$205 := ANY_VALUE($271)", "$206 := ANY_VALUE($270)", "$207 := SUM($277)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $241, $271 := $242, $272 := $243, $273 := $244, $274 := $245, $275 := $240, $276 := $210, $277 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$241 := $41, $242 := $42, $243 := $43, $244 := $44, $245 := $45, $240 := $230", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00906344410876133, "waitRatioMax": 0.00906344410876133, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07854984894259819, "writeRatioMax": 0.07854984894259819 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03323262839879154, "computeRatioMax": 0.03323262839879154, "endMs": "1665778423780", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01812688821752266, "readRatioMax": 0.01812688821752266, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778423740", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2001), between($32, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.045317220543806644, "writeRatioMax": 0.045317220543806644 }, { "completedParallelInputs": "1", "computeMsAvg": "93", "computeMsMax": "93", "computeRatioAvg": 0.2809667673716012, "computeRatioMax": 0.2809667673716012, "endMs": "1665778423891", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.03625377643504532, "readRatioMax": 0.03625377643504532, "recordsRead": "719475", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665778423801", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.04833836858006042, "writeRatioMax": 0.04833836858006042 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.02416918429003021, "computeRatioMax": 0.054380664652567974, "endMs": "1665778423944", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21438", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "3390", "startMs": "1665778423894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006042296072507553, "waitRatioMax": 0.00906344410876133, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.045317220543806644, "writeRatioMax": 0.0755287009063444 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.09969788519637462, "computeRatioMax": 0.09969788519637462, "endMs": "1665778423972", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30898", "recordsWritten": "625", "shuffleOutputBytes": "62335", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778423900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($316)", "$162 := ANY_VALUE($315)", "$163 := ANY_VALUE($314)", "$164 := ANY_VALUE($313)", "$165 := ANY_VALUE($312)", "$166 := ANY_VALUE($311)", "$167 := SUM($317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $191 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($197), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := SUM($207)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00906344410876133, "waitRatioMax": 0.00906344410876133, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012084592145015106, "writeRatioMax": 0.012084592145015106 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027190332326283987, "computeRatioMax": 0.027190332326283987, "endMs": "1665778424050", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01812688821752266, "readRatioMax": 0.01812688821752266, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778424010", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), between($12, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04229607250755287, "writeRatioMax": 0.04229607250755287 }, { "completedParallelInputs": "5", "computeMsAvg": "61", "computeMsMax": "79", "computeRatioAvg": 0.18429003021148035, "computeRatioMax": 0.23867069486404835, "endMs": "1665778424151", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "14", "readRatioAvg": 0.030211480362537766, "readRatioMax": 0.04229607250755287, "recordsRead": "1442003", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "368", "startMs": "1665778424071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $140", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "10", "writeMsMax": "21", "writeRatioAvg": 0.030211480362537766, "writeRatioMax": 0.0634441087613293 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.02416918429003021, "computeRatioMax": 0.04833836858006042, "endMs": "1665778424218", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41280", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "3526", "startMs": "1665778424160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006042296072507553, "waitRatioMax": 0.00906344410876133, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.045317220543806644, "writeRatioMax": 0.08459214501510574 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.08157099697885196, "computeRatioMax": 0.08157099697885196, "endMs": "1665778424240", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41905", "recordsWritten": "611", "shuffleOutputBytes": "55591", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778424173", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($355)", "$122 := ANY_VALUE($354)", "$123 := ANY_VALUE($353)", "$124 := ANY_VALUE($352)", "$125 := ANY_VALUE($351)", "$126 := SUM($356)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $151, $352 := $152, $353 := $153, $354 := $154, $355 := $155, $356 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $156 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($157), 0, $150), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$150 := SUM_OF_COUNTS($160)", "$151 := ANY_VALUE($161)", "$152 := ANY_VALUE($162)", "$153 := ANY_VALUE($163)", "$154 := ANY_VALUE($164)", "$155 := ANY_VALUE($165)", "$156 := ANY_VALUE($166)", "$157 := SUM($167)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.012084592145015106, "waitRatioMax": 0.012084592145015106, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012084592145015106, "writeRatioMax": 0.012084592145015106 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.030211480362537766, "computeRatioMax": 0.030211480362537766, "endMs": "1665778424297", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "611", "recordsWritten": "550", "shuffleOutputBytes": "31205", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778424262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $115, $381 := $114, $382 := $113, $383 := $112, $384 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($116), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$100, $384, $383, $382, $381, $380", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04229607250755287, "writeRatioMax": 0.04229607250755287 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.027190332326283987, "computeRatioMax": 0.027190332326283987, "endMs": "1665778424347", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "550", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778424311", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $384, $383, $382, $381, $380", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04229607250755287, "writeRatioMax": 0.04229607250755287 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.030211480362537766, "computeRatioMax": 0.030211480362537766, "endMs": "1665778424364", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778424323", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$405 ASC, $404 ASC, $403 ASC, $402 ASC, $401 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.015105740181268883, "writeRatioMax": 0.015105740181268883 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "210", "elapsedMs": "644", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7439" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1323", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15119" } ], "totalBytesBilled": "165675008", "totalBytesProcessed": "164955192", "totalPartitionsProcessed": "0", "totalSlotMs": "15119", "transferredBytes": "0" }, "startTime": "1665778423080", "totalBytesProcessed": "164955192", "totalSlotMs": "15119" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon34c7682e_88be_4444_93b3_feaf143def48" }, "priority": "INTERACTIVE", "query": "select\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_state in ('KY','GA','NM') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n (not exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2) and\n not exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2001 and\n d_moy between 4 and 4+2))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "us+YfnEnZNpPpjWhCGsoag==", "id": "test-project-364309:europe-west1.query69_1665778426", "jobReference": { "jobId": "query69_1665778426", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query69_1665778426?location=europe-west1", "statistics": { "creationTime": "1665778427065", "endTime": "1665778428285", "finalExecutionDurationMs": "969", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "164955192", "performanceInsights": { "avgPreviousExecutionMs": "1178" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.04296875, "computeRatioMax": 0.04296875, "endMs": "1665778427300", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0234375, "readRatioMax": 0.0234375, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778427258", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2001), between($62, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0625, "writeRatioMax": 0.0625 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.05859375, "computeRatioMax": 0.05859375, "endMs": "1665778427331", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02734375, "readRatioMax": 0.02734375, "recordsRead": "50000", "recordsWritten": "4891", "shuffleOutputBytes": "44019", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778427301", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address", "WHERE in($81, 'KY', 'GA', 'NM')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05078125, "writeRatioMax": 0.05078125 }, { "completedParallelInputs": "6", "computeMsAvg": "76", "computeMsMax": "100", "computeRatioAvg": 0.296875, "computeRatioMax": 0.390625, "endMs": "1665778427398", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "8", "readMsMax": "9", "readRatioAvg": 0.03125, "readRatioMax": 0.03515625, "recordsRead": "2880950", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "467", "startMs": "1665778427330", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.02734375, "writeRatioMax": 0.03125 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.08984375, "computeRatioMax": 0.08984375, "endMs": "1665778427388", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01953125, "readRatioMax": 0.01953125, "recordsRead": "104891", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778427345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02734375, "writeRatioMax": 0.02734375 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.03125, "computeRatioMax": 0.0625, "endMs": "1665778427461", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9460", "recordsWritten": "9460", "shuffleOutputBytes": "170280", "shuffleOutputBytesSpilled": "0", "slotMs": "3711", "startMs": "1665778427401", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.01171875, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.05859375, "writeRatioMax": 0.0703125 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.03125, "computeRatioMax": 0.0703125, "endMs": "1665778427457", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "77485", "recordsWritten": "77485", "shuffleOutputBytes": "1394730", "shuffleOutputBytesSpilled": "0", "slotMs": "3410", "startMs": "1665778427407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.01171875, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.05859375, "writeRatioMax": 0.07421875 }, { "completedParallelInputs": "1", "computeMsAvg": "256", "computeMsMax": "256", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778427629", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02734375, "readRatioMax": 0.02734375, "recordsRead": "2007745", "recordsWritten": "9460", "shuffleOutputBytes": "956095", "shuffleOutputBytesSpilled": "0", "slotMs": "226", "startMs": "1665778427412", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $276", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($275)", "$202 := ANY_VALUE($274)", "$203 := ANY_VALUE($273)", "$204 := ANY_VALUE($272)", "$205 := ANY_VALUE($271)", "$206 := ANY_VALUE($270)", "$207 := SUM($277)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $241, $271 := $242, $272 := $243, $273 := $244, $274 := $245, $275 := $240, $276 := $210, $277 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$241 := $41, $242 := $42, $243 := $43, $244 := $44, $245 := $45, $240 := $230", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01171875, "waitRatioMax": 0.01171875, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.015625, "writeRatioMax": 0.015625 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0390625, "computeRatioMax": 0.0390625, "endMs": "1665778427705", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778427670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2001), between($32, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02734375, "writeRatioMax": 0.02734375 }, { "completedParallelInputs": "1", "computeMsAvg": "74", "computeMsMax": "74", "computeRatioAvg": 0.2890625, "computeRatioMax": 0.2890625, "endMs": "1665778427788", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "719475", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665778427728", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03125, "writeRatioMax": 0.03125 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.02734375, "computeRatioMax": 0.046875, "endMs": "1665778427847", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21438", "recordsWritten": "21438", "shuffleOutputBytes": "385884", "shuffleOutputBytesSpilled": "0", "slotMs": "3312", "startMs": "1665778427794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.0078125, "writeMsAvg": "16", "writeMsMax": "27", "writeRatioAvg": 0.0625, "writeRatioMax": 0.10546875 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.125, "computeRatioMax": 0.125, "endMs": "1665778427860", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "30898", "recordsWritten": "625", "shuffleOutputBytes": "62335", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778427799", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($316)", "$162 := ANY_VALUE($315)", "$163 := ANY_VALUE($314)", "$164 := ANY_VALUE($313)", "$165 := ANY_VALUE($312)", "$166 := ANY_VALUE($311)", "$167 := SUM($317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $191 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($197), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := SUM($207)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.015625, "writeRatioMax": 0.015625 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02734375, "computeRatioMax": 0.02734375, "endMs": "1665778427916", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03515625, "readRatioMax": 0.03515625, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778427885", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2001), between($12, 4, 6))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0234375, "writeRatioMax": 0.0234375 }, { "completedParallelInputs": "5", "computeMsAvg": "65", "computeMsMax": "102", "computeRatioAvg": 0.25390625, "computeRatioMax": 0.3984375, "endMs": "1665778428013", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.04296875, "readRatioMax": 0.05859375, "recordsRead": "1442003", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "387", "startMs": "1665778427941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $140", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$140 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.0078125, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.02734375, "writeRatioMax": 0.03125 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.03125, "computeRatioMax": 0.0703125, "endMs": "1665778428063", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41280", "recordsWritten": "41280", "shuffleOutputBytes": "743040", "shuffleOutputBytesSpilled": "0", "slotMs": "3146", "startMs": "1665778428016", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.01171875, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.05859375, "writeRatioMax": 0.0703125 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.07421875, "computeRatioMax": 0.07421875, "endMs": "1665778428086", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "41905", "recordsWritten": "611", "shuffleOutputBytes": "55591", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778428030", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($355)", "$122 := ANY_VALUE($354)", "$123 := ANY_VALUE($353)", "$124 := ANY_VALUE($352)", "$125 := ANY_VALUE($351)", "$126 := SUM($356)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $151, $352 := $152, $353 := $153, $354 := $154, $355 := $155, $356 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $156 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($157), 0, $150), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$150 := SUM_OF_COUNTS($160)", "$151 := ANY_VALUE($161)", "$152 := ANY_VALUE($162)", "$153 := ANY_VALUE($163)", "$154 := ANY_VALUE($164)", "$155 := ANY_VALUE($165)", "$156 := ANY_VALUE($166)", "$157 := SUM($167)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01171875, "waitRatioMax": 0.01171875, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.015625, "writeRatioMax": 0.015625 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03125, "computeRatioMax": 0.03125, "endMs": "1665778428147", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "611", "recordsWritten": "550", "shuffleOutputBytes": "31205", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778428108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $115, $381 := $114, $382 := $113, $383 := $112, $384 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "not(greater(if(is_null($116), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$100, $384, $383, $382, $381, $380", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06640625, "writeRatioMax": 0.06640625 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0234375, "computeRatioMax": 0.0234375, "endMs": "1665778428187", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "550", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778428153", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $384, $383, $382, $381, $380", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05078125, "writeRatioMax": 0.05078125 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.05859375, "computeRatioMax": 0.05859375, "endMs": "1665778428199", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "5718", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778428167", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$405 ASC, $404 ASC, $403 ASC, $402 ASC, $401 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$410, $411, $412, $413, $414, $415", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0234375, "writeRatioMax": 0.0234375 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "637", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7863" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1112", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14984" } ], "totalBytesBilled": "165675008", "totalBytesProcessed": "164955192", "totalPartitionsProcessed": "0", "totalSlotMs": "14984", "transferredBytes": "0" }, "startTime": "1665778427122", "totalBytesProcessed": "164955192", "totalSlotMs": "14984" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
