{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8e7050fb_590e_47cf_8ae8_f85a09393eb0" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_net_profit) as store_sales_profit\n ,sum(sr_net_loss) as store_returns_loss\n ,sum(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 4\n and d1.d_year = 2001\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 4 and 10\n and d2.d_year = 2001\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy between 4 and 10 \n and d3.d_year = 2001\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "qOk8nTJNTPIKz7X99ME+6g==", "id": "test-project-364309:europe-west1.query25_1665768296", "jobReference": { "jobId": "query25_1665768296", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query25_1665768296?location=europe-west1", "statistics": { "creationTime": "1665768296627", "endTime": "1665768298902", "finalExecutionDurationMs": "2012", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "231188615", "performanceInsights": { "avgPreviousExecutionMs": "1921" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "80", "computeMsMax": "80", "computeRatioAvg": 0.028070175438596492, "computeRatioMax": 0.028070175438596492, "endMs": "1665768296906", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0035087719298245615, "readRatioMax": 0.0035087719298245615, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "94", "startMs": "1665768296833", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003508771929824561, "waitRatioMax": 0.0003508771929824561, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.003157894736842105, "writeRatioMax": 0.003157894736842105 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.004210526315789474, "computeRatioMax": 0.004210526315789474, "endMs": "1665768296889", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0014035087719298245, "readRatioMax": 0.0014035087719298245, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768296848", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003508771929824561, "waitRatioMax": 0.0003508771929824561, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.00631578947368421, "writeRatioMax": 0.00631578947368421 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.004912280701754386, "computeRatioMax": 0.004912280701754386, "endMs": "1665768296932", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002456140350877193, "readRatioMax": 0.002456140350877193, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768296870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(between($22, 4, 10), equal($21, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003508771929824561, "waitRatioMax": 0.0003508771929824561, "writeMsAvg": "46", "writeMsMax": "46", "writeRatioAvg": 0.016140350877192983, "writeRatioMax": 0.016140350877192983 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.004561403508771929, "computeRatioMax": 0.004561403508771929, "endMs": "1665768296932", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.002807017543859649, "readRatioMax": 0.002807017543859649, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768296887", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 4, 10), equal($31, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007017543859649122, "waitRatioMax": 0.0007017543859649122, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.005263157894736842, "writeRatioMax": 0.005263157894736842 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0038596491228070177, "computeRatioMax": 0.0038596491228070177, "endMs": "1665768296943", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002456140350877193, "readRatioMax": 0.002456140350877193, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665768296902", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 4), equal($51, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003508771929824561, "waitRatioMax": 0.0003508771929824561, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.004912280701754386, "writeRatioMax": 0.004912280701754386 }, { "completedParallelInputs": "5", "computeMsAvg": "314", "computeMsMax": "402", "computeRatioAvg": 0.11017543859649123, "computeRatioMax": 0.14105263157894737, "endMs": "1665768297227", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "23", "readMsMax": "36", "readRatioAvg": 0.008070175438596491, "readRatioMax": 0.01263157894736842, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "63090196", "shuffleOutputBytesSpilled": "0", "slotMs": "1586", "startMs": "1665768296919", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003508771929824561, "waitRatioMax": 0.0003508771929824561, "writeMsAvg": "20", "writeMsMax": "26", "writeRatioAvg": 0.007017543859649123, "writeRatioMax": 0.009122807017543859 }, { "completedParallelInputs": "1", "computeMsAvg": "455", "computeMsMax": "455", "computeRatioAvg": 0.15964912280701754, "computeRatioMax": 0.15964912280701754, "endMs": "1665768297264", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.00631578947368421, "readRatioMax": 0.00631578947368421, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "14588218", "shuffleOutputBytesSpilled": "0", "slotMs": "408", "startMs": "1665768296935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003508771929824561, "waitRatioMax": 0.0003508771929824561, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.00631578947368421, "writeRatioMax": 0.00631578947368421 }, { "completedParallelInputs": "6", "computeMsAvg": "2127", "computeMsMax": "2850", "computeRatioAvg": 0.7463157894736843, "computeRatioMax": 1, "endMs": "1665768298750", "id": "8", "inputStages": [ "6", "4", "5", "3", "2", "1", "0" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "25", "readRatioAvg": 0.007017543859649123, "readRatioMax": 0.008771929824561403, "recordsRead": "13171554", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "10545", "startMs": "1665768297317", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $195, $201 := $196, $202 := $190, $203 := $191", "$90 := SUM($193)", "$91 := SUM($194)", "$92 := SUM($192)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $184, $191 := $185, $192 := $180, $193 := $182, $194 := $183, $195 := $2, $196 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $173, $183 := $174, $184 := $11, $185 := $12", "INNER HASH JOIN EACH WITH ALL ON $172 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $151, $171 := $152, $172 := $153, $173 := $154, $174 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "TO __stage08_output", "BY HASH($200, $201, $202, $203)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0003508771929824561, "waitRatioMax": 0.0007017543859649122, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.0014035087719298245, "writeRatioMax": 0.002105263157894737 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.0014035087719298245, "computeRatioMax": 0.0014035087719298245, "endMs": "1665768298766", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665768298757", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003508771929824561, "waitRatioMax": 0.0003508771929824561, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.002456140350877193, "computeRatioMax": 0.002456140350877193, "endMs": "1665768298811", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768298774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007017543859649122, "waitRatioMax": 0.0007017543859649122, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.009122807017543859, "writeRatioMax": 0.009122807017543859 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "646", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "3670" }, { "activeUnits": "5", "completedUnits": "19", "elapsedMs": "2157", "estimatedRunnableUnits": "1", "pendingUnits": "0", "totalSlotMs": "14257" } ], "totalBytesBilled": "231735296", "totalBytesProcessed": "231188615", "totalPartitionsProcessed": "0", "totalSlotMs": "14257", "transferredBytes": "0" }, "startTime": "1665768296689", "totalBytesProcessed": "231188615", "totalSlotMs": "14257" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon13e5fa98_d525_4604_a88a_3a6131f68c80" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_net_profit) as store_sales_profit\n ,sum(sr_net_loss) as store_returns_loss\n ,sum(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 4\n and d1.d_year = 2001\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 4 and 10\n and d2.d_year = 2001\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy between 4 and 10 \n and d3.d_year = 2001\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "e6Y9d/YtM0/RIPkrRo7LCA==", "id": "test-project-364309:europe-west1.query25_1665777164", "jobReference": { "jobId": "query25_1665777164", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query25_1665777164?location=europe-west1", "statistics": { "creationTime": "1665777165125", "endTime": "1665777167886", "finalExecutionDurationMs": "2467", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "231188615", "performanceInsights": { "avgPreviousExecutionMs": "1951" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "75", "computeMsMax": "75", "computeRatioAvg": 0.02512562814070352, "computeRatioMax": 0.02512562814070352, "endMs": "1665777165412", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0033500837520938024, "readRatioMax": 0.0033500837520938024, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665777165342", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0006700167504187605, "waitRatioMax": 0.0006700167504187605, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0036850921273031824, "writeRatioMax": 0.0036850921273031824 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0033500837520938024, "computeRatioMax": 0.0033500837520938024, "endMs": "1665777165396", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0016750418760469012, "readRatioMax": 0.0016750418760469012, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777165354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00033500837520938025, "waitRatioMax": 0.00033500837520938025, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.004690117252931323, "writeRatioMax": 0.004690117252931323 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.004355108877721943, "computeRatioMax": 0.004355108877721943, "endMs": "1665777165396", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0033500837520938024, "readRatioMax": 0.0033500837520938024, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777165366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(between($22, 4, 10), equal($21, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00033500837520938025, "waitRatioMax": 0.00033500837520938025, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.003015075376884422, "writeRatioMax": 0.003015075376884422 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.004355108877721943, "computeRatioMax": 0.004355108877721943, "endMs": "1665777165417", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0023450586264656616, "readRatioMax": 0.0023450586264656616, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777165380", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 4, 10), equal($31, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00033500837520938025, "waitRatioMax": 0.00033500837520938025, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.002680067001675042, "writeRatioMax": 0.002680067001675042 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.004355108877721943, "computeRatioMax": 0.004355108877721943, "endMs": "1665777165434", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0023450586264656616, "readRatioMax": 0.0023450586264656616, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777165392", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 4), equal($51, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00033500837520938025, "waitRatioMax": 0.00033500837520938025, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.004355108877721943, "writeRatioMax": 0.004355108877721943 }, { "completedParallelInputs": "5", "computeMsAvg": "310", "computeMsMax": "438", "computeRatioAvg": 0.10385259631490787, "computeRatioMax": 0.14673366834170853, "endMs": "1665777165655", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "18", "readMsMax": "22", "readRatioAvg": 0.006030150753768844, "readRatioMax": 0.007370184254606365, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "63090196", "shuffleOutputBytesSpilled": "0", "slotMs": "1441", "startMs": "1665777165407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00033500837520938025, "waitRatioMax": 0.0006700167504187605, "writeMsAvg": "15", "writeMsMax": "17", "writeRatioAvg": 0.005025125628140704, "writeRatioMax": 0.005695142378559464 }, { "completedParallelInputs": "1", "computeMsAvg": "465", "computeMsMax": "465", "computeRatioAvg": 0.15577889447236182, "computeRatioMax": 0.15577889447236182, "endMs": "1665777165728", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.005695142378559464, "readRatioMax": 0.005695142378559464, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "14588218", "shuffleOutputBytesSpilled": "0", "slotMs": "334", "startMs": "1665777165421", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00033500837520938025, "waitRatioMax": 0.00033500837520938025, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.006030150753768844, "writeRatioMax": 0.006030150753768844 }, { "completedParallelInputs": "6", "computeMsAvg": "2469", "computeMsMax": "2985", "computeRatioAvg": 0.8271356783919598, "computeRatioMax": 1, "endMs": "1665777167712", "id": "8", "inputStages": [ "2", "0", "5", "3", "1", "6", "4" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "42", "readRatioAvg": 0.008040201005025126, "readRatioMax": 0.01407035175879397, "recordsRead": "13171554", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "13383", "startMs": "1665777165830", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $195, $201 := $196, $202 := $190, $203 := $191", "$90 := SUM($193)", "$91 := SUM($194)", "$92 := SUM($192)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $184, $191 := $185, $192 := $180, $193 := $182, $194 := $183, $195 := $2, $196 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $173, $183 := $174, $184 := $11, $185 := $12", "INNER HASH JOIN EACH WITH ALL ON $172 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $151, $171 := $152, $172 := $153, $173 := $154, $174 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "TO __stage08_output", "BY HASH($200, $201, $202, $203)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00033500837520938025, "waitRatioMax": 0.0006700167504187605, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.0016750418760469012, "writeRatioMax": 0.002680067001675042 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.001340033500837521, "computeRatioMax": 0.001340033500837521, "endMs": "1665777167730", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "8", "startMs": "1665777167720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0006700167504187605, "waitRatioMax": 0.0006700167504187605, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00033500837520938025, "writeRatioMax": 0.00033500837520938025 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0033500837520938024, "computeRatioMax": 0.0033500837520938024, "endMs": "1665777167769", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777167735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00033500837520938025, "waitRatioMax": 0.00033500837520938025, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.004690117252931323, "writeRatioMax": 0.004690117252931323 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "636", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "4511" }, { "activeUnits": "6", "completedUnits": "19", "elapsedMs": "2598", "estimatedRunnableUnits": "1", "pendingUnits": "0", "totalSlotMs": "17937" } ], "totalBytesBilled": "231735296", "totalBytesProcessed": "231188615", "totalPartitionsProcessed": "0", "totalSlotMs": "17937", "transferredBytes": "0" }, "startTime": "1665777165208", "totalBytesProcessed": "231188615", "totalSlotMs": "17937" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1eff25bb_1fa1_48c6_9475_545a69bf9d5c" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_net_profit) as store_sales_profit\n ,sum(sr_net_loss) as store_returns_loss\n ,sum(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 4\n and d1.d_year = 2001\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 4 and 10\n and d2.d_year = 2001\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy between 4 and 10 \n and d3.d_year = 2001\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "hkRHt1rpn2Bm3PfrS8rmig==", "id": "test-project-364309:europe-west1.query25_1665777169", "jobReference": { "jobId": "query25_1665777169", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query25_1665777169?location=europe-west1", "statistics": { "creationTime": "1665777170360", "endTime": "1665777172815", "finalExecutionDurationMs": "2212", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "231188615", "performanceInsights": { "avgPreviousExecutionMs": "2080" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "91", "computeMsMax": "91", "computeRatioAvg": 0.03259312320916905, "computeRatioMax": 0.03259312320916905, "endMs": "1665777170637", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0035816618911174787, "readRatioMax": 0.0035816618911174787, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665777170551", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007163323782234957, "waitRatioMax": 0.0007163323782234957, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.004297994269340974, "writeRatioMax": 0.004297994269340974 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0028653295128939827, "computeRatioMax": 0.0028653295128939827, "endMs": "1665777170604", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0017908309455587394, "readRatioMax": 0.0017908309455587394, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777170566", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007163323782234957, "waitRatioMax": 0.0007163323782234957, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0057306590257879654, "writeRatioMax": 0.0057306590257879654 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0032234957020057307, "computeRatioMax": 0.0032234957020057307, "endMs": "1665777170626", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002507163323782235, "readRatioMax": 0.002507163323782235, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777170584", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(between($22, 4, 10), equal($21, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007163323782234957, "waitRatioMax": 0.0007163323782234957, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.00501432664756447, "writeRatioMax": 0.00501432664756447 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0032234957020057307, "computeRatioMax": 0.0032234957020057307, "endMs": "1665777170649", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002148997134670487, "readRatioMax": 0.002148997134670487, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777170600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 4, 10), equal($31, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035816618911174784, "waitRatioMax": 0.00035816618911174784, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.008595988538681949, "writeRatioMax": 0.008595988538681949 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.003939828080229226, "computeRatioMax": 0.003939828080229226, "endMs": "1665777170653", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002507163323782235, "readRatioMax": 0.002507163323782235, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777170617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 4), equal($51, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035816618911174784, "waitRatioMax": 0.00035816618911174784, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.0071633237822349575, "writeRatioMax": 0.0071633237822349575 }, { "completedParallelInputs": "5", "computeMsAvg": "291", "computeMsMax": "393", "computeRatioAvg": 0.10422636103151862, "computeRatioMax": 0.1407593123209169, "endMs": "1665777170888", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "18", "readMsMax": "22", "readRatioAvg": 0.0064469914040114614, "readRatioMax": 0.007879656160458453, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "63090196", "shuffleOutputBytesSpilled": "0", "slotMs": "1426", "startMs": "1665777170630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035816618911174784, "waitRatioMax": 0.00035816618911174784, "writeMsAvg": "16", "writeMsMax": "20", "writeRatioAvg": 0.0057306590257879654, "writeRatioMax": 0.0071633237822349575 }, { "completedParallelInputs": "1", "computeMsAvg": "315", "computeMsMax": "315", "computeRatioAvg": 0.11282234957020057, "computeRatioMax": 0.11282234957020057, "endMs": "1665777170904", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0053724928366762174, "readRatioMax": 0.0053724928366762174, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "14588218", "shuffleOutputBytesSpilled": "0", "slotMs": "320", "startMs": "1665777170647", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035816618911174784, "waitRatioMax": 0.00035816618911174784, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0057306590257879654, "writeRatioMax": 0.0057306590257879654 }, { "completedParallelInputs": "6", "computeMsAvg": "2476", "computeMsMax": "2792", "computeRatioAvg": 0.8868194842406877, "computeRatioMax": 1, "endMs": "1665777172668", "id": "8", "inputStages": [ "1", "0", "6", "4", "3", "5", "2" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "34", "readRatioAvg": 0.007521489971346705, "readRatioMax": 0.012177650429799427, "recordsRead": "13171554", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "12608", "startMs": "1665777170938", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $195, $201 := $196, $202 := $190, $203 := $191", "$90 := SUM($193)", "$91 := SUM($194)", "$92 := SUM($192)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $184, $191 := $185, $192 := $180, $193 := $182, $194 := $183, $195 := $2, $196 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $173, $183 := $174, $184 := $11, $185 := $12", "INNER HASH JOIN EACH WITH ALL ON $172 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $151, $171 := $152, $172 := $153, $173 := $154, $174 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "TO __stage08_output", "BY HASH($200, $201, $202, $203)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007163323782234957, "waitRatioMax": 0.0007163323782234957, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.0017908309455587394, "writeRatioMax": 0.002507163323782235 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0017908309455587394, "computeRatioMax": 0.0017908309455587394, "endMs": "1665777172684", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665777172676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035816618911174784, "waitRatioMax": 0.00035816618911174784, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0035816618911174787, "computeRatioMax": 0.0035816618911174787, "endMs": "1665777172728", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777172691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00035816618911174784, "waitRatioMax": 0.00035816618911174784, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.010386819484240688, "writeRatioMax": 0.010386819484240688 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "633", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2903" }, { "activeUnits": "6", "completedUnits": "19", "elapsedMs": "2341", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15561" } ], "totalBytesBilled": "231735296", "totalBytesProcessed": "231188615", "totalPartitionsProcessed": "0", "totalSlotMs": "15561", "transferredBytes": "0" }, "startTime": "1665777170420", "totalBytesProcessed": "231188615", "totalSlotMs": "15561" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5f9a7225_9340_45d6_8063_036f5710113d" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_net_profit) as store_sales_profit\n ,sum(sr_net_loss) as store_returns_loss\n ,sum(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 4\n and d1.d_year = 2001\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 4 and 10\n and d2.d_year = 2001\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy between 4 and 10 \n and d3.d_year = 2001\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2qSEr4iqNayC7RqjZYkiaA==", "id": "test-project-364309:europe-west1.query25_1665777173", "jobReference": { "jobId": "query25_1665777173", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query25_1665777173?location=europe-west1", "statistics": { "creationTime": "1665777174372", "endTime": "1665777177321", "finalExecutionDurationMs": "2749", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "231188615", "performanceInsights": { "avgPreviousExecutionMs": "2107" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.01569634703196347, "computeRatioMax": 0.01569634703196347, "endMs": "1665777174604", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.003139269406392694, "readRatioMax": 0.003139269406392694, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665777174535", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0037100456621004564, "writeRatioMax": 0.0037100456621004564 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.001997716894977169, "computeRatioMax": 0.001997716894977169, "endMs": "1665777174577", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0008561643835616438, "readRatioMax": 0.0008561643835616438, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665777174549", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.005422374429223744, "writeRatioMax": 0.005422374429223744 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.003995433789954338, "computeRatioMax": 0.003995433789954338, "endMs": "1665777174603", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.00228310502283105, "readRatioMax": 0.00228310502283105, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777174565", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(between($22, 4, 10), equal($21, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0025684931506849314, "writeRatioMax": 0.0025684931506849314 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.003139269406392694, "computeRatioMax": 0.003139269406392694, "endMs": "1665777174625", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0017123287671232876, "readRatioMax": 0.0017123287671232876, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777174580", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 4, 10), equal($31, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0048515981735159815, "writeRatioMax": 0.0048515981735159815 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.003995433789954338, "computeRatioMax": 0.003995433789954338, "endMs": "1665777174634", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.00228310502283105, "readRatioMax": 0.00228310502283105, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777174595", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 4), equal($51, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.003424657534246575, "writeRatioMax": 0.003424657534246575 }, { "completedParallelInputs": "5", "computeMsAvg": "249", "computeMsMax": "299", "computeRatioAvg": 0.07106164383561644, "computeRatioMax": 0.0853310502283105, "endMs": "1665777174818", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "17", "readRatioAvg": 0.0045662100456621, "readRatioMax": 0.0048515981735159815, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "63090196", "shuffleOutputBytesSpilled": "0", "slotMs": "1186", "startMs": "1665777174610", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "17", "writeMsMax": "22", "writeRatioAvg": 0.0048515981735159815, "writeRatioMax": 0.006278538812785388 }, { "completedParallelInputs": "1", "computeMsAvg": "438", "computeMsMax": "438", "computeRatioAvg": 0.125, "computeRatioMax": 0.125, "endMs": "1665777174886", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.004280821917808219, "readRatioMax": 0.004280821917808219, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "14588218", "shuffleOutputBytesSpilled": "0", "slotMs": "345", "startMs": "1665777174624", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.004280821917808219, "writeRatioMax": 0.004280821917808219 }, { "completedParallelInputs": "6", "computeMsAvg": "2464", "computeMsMax": "3504", "computeRatioAvg": 0.7031963470319634, "computeRatioMax": 1, "endMs": "1665777177188", "id": "8", "inputStages": [ "2", "5", "0", "4", "3", "6", "1" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "31", "readRatioAvg": 0.0059931506849315065, "readRatioMax": 0.00884703196347032, "recordsRead": "13171554", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "12823", "startMs": "1665777174958", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $195, $201 := $196, $202 := $190, $203 := $191", "$90 := SUM($193)", "$91 := SUM($194)", "$92 := SUM($192)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $184, $191 := $185, $192 := $180, $193 := $182, $194 := $183, $195 := $2, $196 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $173, $183 := $174, $184 := $11, $185 := $12", "INNER HASH JOIN EACH WITH ALL ON $172 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $151, $171 := $152, $172 := $153, $173 := $154, $174 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "TO __stage08_output", "BY HASH($200, $201, $202, $203)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "3", "writeMsMax": "4", "writeRatioAvg": 0.0008561643835616438, "writeRatioMax": 0.001141552511415525 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0014269406392694063, "computeRatioMax": 0.0014269406392694063, "endMs": "1665777177204", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665777177194", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00028538812785388126, "writeRatioMax": 0.00028538812785388126 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0017123287671232876, "computeRatioMax": 0.0017123287671232876, "endMs": "1665777177243", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777177208", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00028538812785388126, "waitRatioMax": 0.00028538812785388126, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.004280821917808219, "writeRatioMax": 0.004280821917808219 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "617", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2933" }, { "activeUnits": "5", "completedUnits": "16", "elapsedMs": "2111", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "13292" }, { "activeUnits": "2", "completedUnits": "19", "elapsedMs": "2861", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15771" } ], "totalBytesBilled": "231735296", "totalBytesProcessed": "231188615", "totalPartitionsProcessed": "0", "totalSlotMs": "15771", "transferredBytes": "0" }, "startTime": "1665777174419", "totalBytesProcessed": "231188615", "totalSlotMs": "15771" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon56d52dbb_4413_463a_bfd1_be4e65ff0806" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_net_profit) as store_sales_profit\n ,sum(sr_net_loss) as store_returns_loss\n ,sum(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 4\n and d1.d_year = 2001\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 4 and 10\n and d2.d_year = 2001\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy between 4 and 10 \n and d3.d_year = 2001\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "c7rs6AeujRbiOdXgKwE40A==", "id": "test-project-364309:europe-west1.query25_1665777178", "jobReference": { "jobId": "query25_1665777178", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query25_1665777178?location=europe-west1", "statistics": { "creationTime": "1665777179308", "endTime": "1665777181881", "finalExecutionDurationMs": "2305", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "231188615", "performanceInsights": { "avgPreviousExecutionMs": "2214" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.011072445428661816, "computeRatioMax": 0.011072445428661816, "endMs": "1665777179540", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002214489085732363, "readRatioMax": 0.002214489085732363, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777179493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0031635558367605187, "writeRatioMax": 0.0031635558367605187 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0037962670041126224, "computeRatioMax": 0.0037962670041126224, "endMs": "1665777179545", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.002530844669408415, "readRatioMax": 0.002530844669408415, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777179506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0031635558367605187, "writeRatioMax": 0.0031635558367605187 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.002847200253084467, "computeRatioMax": 0.002847200253084467, "endMs": "1665777179561", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002214489085732363, "readRatioMax": 0.002214489085732363, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777179519", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(between($22, 4, 10), equal($21, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.004428978171464726, "writeRatioMax": 0.004428978171464726 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0031635558367605187, "computeRatioMax": 0.0031635558367605187, "endMs": "1665777179569", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.002530844669408415, "readRatioMax": 0.002530844669408415, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777179533", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 4, 10), equal($31, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.002530844669408415, "writeRatioMax": 0.002530844669408415 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0031635558367605187, "computeRatioMax": 0.0031635558367605187, "endMs": "1665777179573", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0034799114204365706, "readRatioMax": 0.0034799114204365706, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777179546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 4), equal($51, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.002214489085732363, "writeRatioMax": 0.002214489085732363 }, { "completedParallelInputs": "5", "computeMsAvg": "371", "computeMsMax": "499", "computeRatioAvg": 0.11736792154381524, "computeRatioMax": 0.1578614362543499, "endMs": "1665777179831", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "22", "readMsMax": "28", "readRatioAvg": 0.006959822840873141, "readRatioMax": 0.008857956342929452, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "63090196", "shuffleOutputBytesSpilled": "0", "slotMs": "1565", "startMs": "1665777179558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "23", "writeMsMax": "41", "writeRatioAvg": 0.007276178424549193, "writeRatioMax": 0.012970578930718128 }, { "completedParallelInputs": "1", "computeMsAvg": "441", "computeMsMax": "441", "computeRatioAvg": 0.13951281240113889, "computeRatioMax": 0.13951281240113889, "endMs": "1665777179822", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "25", "readMsMax": "25", "readRatioAvg": 0.007908889591901298, "readRatioMax": 0.007908889591901298, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "14588218", "shuffleOutputBytesSpilled": "0", "slotMs": "415", "startMs": "1665777179572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0037962670041126224, "writeRatioMax": 0.0037962670041126224 }, { "completedParallelInputs": "6", "computeMsAvg": "2321", "computeMsMax": "3161", "computeRatioAvg": 0.7342613097121165, "computeRatioMax": 1, "endMs": "1665777181712", "id": "9", "inputStages": [ "1", "0", "6", "4", "2", "5", "3" ], "name": "S09: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "29", "readRatioAvg": 0.006643467257197089, "readRatioMax": 0.009174311926605505, "recordsRead": "13171554", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "12209", "startMs": "1665777179899", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $195, $201 := $196, $202 := $190, $203 := $191", "$90 := SUM($193)", "$91 := SUM($194)", "$92 := SUM($192)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $184, $191 := $185, $192 := $180, $193 := $182, $194 := $183, $195 := $2, $196 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $173, $183 := $174, $184 := $11, $185 := $12", "INNER HASH JOIN EACH WITH ALL ON $172 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $151, $171 := $152, $172 := $153, $173 := $154, $174 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "TO __stage09_output", "BY HASH($200, $201, $202, $203)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "6", "writeMsMax": "13", "writeRatioAvg": 0.0018981335020563112, "writeRatioMax": 0.004112622587788674 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.0012654223347042075, "computeRatioMax": 0.0012654223347042075, "endMs": "1665777181727", "id": "10", "inputStages": [ "9" ], "name": "S0A: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665777181719", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.002847200253084467, "computeRatioMax": 0.002847200253084467, "endMs": "1665777181772", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777181734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031635558367605187, "waitRatioMax": 0.00031635558367605187, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.009174311926605505, "writeRatioMax": 0.009174311926605505 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "632", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2739" }, { "activeUnits": "5", "completedUnits": "19", "elapsedMs": "2431", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14939" } ], "totalBytesBilled": "231735296", "totalBytesProcessed": "231188615", "totalPartitionsProcessed": "0", "totalSlotMs": "14939", "transferredBytes": "0" }, "startTime": "1665777179364", "totalBytesProcessed": "231188615", "totalSlotMs": "14939" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona2b1d1f4_24ac_4e06_a12e_8f21450745ee" }, "priority": "INTERACTIVE", "query": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,sum(ss_net_profit) as store_sales_profit\n ,sum(sr_net_loss) as store_returns_loss\n ,sum(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 4\n and d1.d_year = 2001\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy between 4 and 10\n and d2.d_year = 2001\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy between 4 and 10 \n and d3.d_year = 2001\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "x2PPkZPXbXSre03QO7PBqg==", "id": "test-project-364309:europe-west1.query25_1665777184", "jobReference": { "jobId": "query25_1665777184", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query25_1665777184?location=europe-west1", "statistics": { "creationTime": "1665777185311", "endTime": "1665777187968", "finalExecutionDurationMs": "2441", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "231188615", "performanceInsights": { "avgPreviousExecutionMs": "2227" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "66", "computeMsMax": "66", "computeRatioAvg": 0.020872865275142316, "computeRatioMax": 0.020872865275142316, "endMs": "1665777185578", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.004427577482605946, "readRatioMax": 0.004427577482605946, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "2432502", "shuffleOutputBytesSpilled": "0", "slotMs": "109", "startMs": "1665777185482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_id, $3:i_item_desc", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.00031625553447185326, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.003795066413662239, "writeRatioMax": 0.003795066413662239 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0031625553447185324, "computeRatioMax": 0.0031625553447185324, "endMs": "1665777185520", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.002530044275774826, "readRatioMax": 0.002530044275774826, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665777185495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_id, $12:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.00031625553447185326, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.002530044275774826, "writeRatioMax": 0.002530044275774826 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.003478810879190386, "computeRatioMax": 0.003478810879190386, "endMs": "1665777185539", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.002530044275774826, "readRatioMax": 0.002530044275774826, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777185509", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year, $22:d_moy", "FROM date_dim", "WHERE and(between($22, 4, 10), equal($21, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.00031625553447185326, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.004427577482605946, "writeRatioMax": 0.004427577482605946 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.004743833017077799, "computeRatioMax": 0.004743833017077799, "endMs": "1665777185560", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0031625553447185324, "readRatioMax": 0.0031625553447185324, "recordsRead": "73049", "recordsWritten": "214", "shuffleOutputBytes": "1926", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777185520", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(between($32, 4, 10), equal($31, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage03_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.002530044275774826, "writeRatioMax": 0.002530044275774826 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0031625553447185324, "computeRatioMax": 0.0031625553447185324, "endMs": "1665777185560", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0018975332068311196, "readRatioMax": 0.0018975332068311196, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777185533", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 4), equal($51, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.00031625553447185326, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.004111321948134092, "writeRatioMax": 0.004111321948134092 }, { "completedParallelInputs": "5", "computeMsAvg": "292", "computeMsMax": "423", "computeRatioAvg": 0.09234661606578115, "computeRatioMax": 0.13377609108159394, "endMs": "1665777185779", "id": "5", "name": "S05: Input", "parallelInputs": "5", "readMsAvg": "31", "readMsMax": "74", "readRatioAvg": 0.00980392156862745, "readRatioMax": 0.02340290955091714, "recordsRead": "1441548", "recordsWritten": "1434519", "shuffleOutputBytes": "63090196", "shuffleOutputBytesSpilled": "0", "slotMs": "1412", "startMs": "1665777185546", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.00031625553447185326, "writeMsAvg": "16", "writeMsMax": "21", "writeRatioAvg": 0.005060088551549652, "writeRatioMax": 0.006641366223908918 }, { "completedParallelInputs": "1", "computeMsAvg": "444", "computeMsMax": "444", "computeRatioAvg": 0.14041745730550284, "computeRatioMax": 0.14041745730550284, "endMs": "1665777185838", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.006008855154965212, "readRatioMax": 0.006008855154965212, "recordsRead": "287514", "recordsWritten": "277498", "shuffleOutputBytes": "14588218", "shuffleOutputBytesSpilled": "0", "slotMs": "387", "startMs": "1665777185557", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_net_loss", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $73, $74", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.00031625553447185326, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.005060088551549652, "writeRatioMax": 0.005060088551549652 }, { "completedParallelInputs": "6", "computeMsAvg": "2669", "computeMsMax": "3162", "computeRatioAvg": 0.8440860215053764, "computeRatioMax": 1, "endMs": "1665777187833", "id": "8", "inputStages": [ "0", "5", "4", "6", "3", "2", "1" ], "name": "S08: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "38", "readRatioAvg": 0.008855154965211892, "readRatioMax": 0.012017710309930424, "recordsRead": "13171554", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "18153", "startMs": "1665777185877", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_net_profit", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $73, $74", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $195, $201 := $196, $202 := $190, $203 := $191", "$90 := SUM($193)", "$91 := SUM($194)", "$92 := SUM($192)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $184, $191 := $185, $192 := $180, $193 := $182, $194 := $183, $195 := $2, $196 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $171, $182 := $173, $183 := $174, $184 := $11, $185 := $12", "INNER HASH JOIN EACH WITH ALL ON $172 = $10" ] }, { "kind": "JOIN", "substeps": [ "$170 := $151, $171 := $152, $172 := $153, $173 := $154, $174 := $155", "INNER HASH JOIN EACH WITH ALL ON $150 = $20" ] }, { "kind": "JOIN", "substeps": [ "$150 := $130, $151 := $131, $152 := $132, $153 := $133, $154 := $134, $155 := $136", "INNER HASH JOIN EACH WITH ALL ON $135 = $30" ] }, { "kind": "JOIN", "substeps": [ "$130 := $116, $131 := $117, $132 := $111, $133 := $112, $134 := $113, $135 := $114, $136 := $115", "INNER HASH JOIN EACH WITH ALL ON $110 = $50" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $107, $116 := $40, $117 := $43", "INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42" ] }, { "kind": "JOIN", "substeps": [ "$100 := $60, $101 := $61, $102 := $63, $103 := $65, $104 := $70, $105 := $71, $106 := $72, $107 := $74", "INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "TO __stage08_output", "BY HASH($200, $201, $202, $203)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.0006325110689437065, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.0015812776723592662, "writeRatioMax": 0.0018975332068311196 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0015812776723592662, "computeRatioMax": 0.0015812776723592662, "endMs": "1665777187856", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665777187839", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $90, $91, $92", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$210 ASC, $211 ASC, $212 ASC, $213 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203", "$80 := SUM($90)", "$81 := SUM($91)", "$82 := SUM($92)" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.00031625553447185326, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00031625553447185326, "writeRatioMax": 0.00031625553447185326 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0028462998102466793, "computeRatioMax": 0.0028462998102466793, "endMs": "1665777187893", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "296", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777187853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $224, $225, $226", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $221 ASC, $222 ASC, $223 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235, $236", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031625553447185326, "waitRatioMax": 0.00031625553447185326, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.004427577482605946, "writeRatioMax": 0.004427577482605946 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "11", "elapsedMs": "622", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "2704" }, { "activeUnits": "6", "completedUnits": "19", "elapsedMs": "2561", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "20657" } ], "totalBytesBilled": "231735296", "totalBytesProcessed": "231188615", "totalPartitionsProcessed": "0", "totalSlotMs": "20657", "transferredBytes": "0" }, "startTime": "1665777185361", "totalBytesProcessed": "231188615", "totalSlotMs": "20657" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
