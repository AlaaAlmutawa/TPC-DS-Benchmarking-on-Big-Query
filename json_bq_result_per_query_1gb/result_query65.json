{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon620d5817_0efd_4867_b42c_645d9f2417bf" }, "priority": "INTERACTIVE", "query": "select\n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t (select ss_store_sk, ss_item_sk, \n \t\t sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n sc.revenue <= 0.1 benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp sb.ave and\n s_store_sk = sc.ss_store_sk and\n i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "gJwckiraoUwpn59UhJ8zQA==", "id": "test-project-364309:europe-west1.query65_1665768422", "jobReference": { "jobId": "query65_1665768422", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query65_1665768422?location=europe-west1", "statistics": { "creationTime": "1665768423514", "endTime": "1665768424377", "finalExecutionDurationMs": "685", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "115113404", "performanceInsights": { "avgPreviousExecutionMs": "660" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.07518796992481203, "computeRatioMax": 0.07518796992481203, "endMs": "1665768423689", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.041353383458646614, "readRatioMax": 0.041353383458646614, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768423649", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007518796992481203, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05639097744360902, "writeRatioMax": 0.05639097744360902 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.041353383458646614, "computeRatioMax": 0.041353383458646614, "endMs": "1665768423713", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.018796992481203006, "readRatioMax": 0.018796992481203006, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768423676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0037593984962406013, "waitRatioMax": 0.0037593984962406013, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04887218045112782, "writeRatioMax": 0.04887218045112782 }, { "completedParallelInputs": "6", "computeMsAvg": "184", "computeMsMax": "218", "computeRatioAvg": 0.6917293233082706, "computeRatioMax": 0.8195488721804511, "endMs": "1665768423854", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.041353383458646614, "readRatioMax": 0.05263157894736842, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1148", "startMs": "1665768423696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $151, $161 := $150", "$110 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $41, $151 := $42, $152 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$161, $160, $110", "TO __stage04_output", "BY HASH($160, $161)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0037593984962406013, "waitRatioMax": 0.0037593984962406013, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.03007518796992481 }, { "completedParallelInputs": "6", "computeMsAvg": "185", "computeMsMax": "230", "computeRatioAvg": 0.6954887218045113, "computeRatioMax": 0.8646616541353384, "endMs": "1665768423885", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.041353383458646614, "readRatioMax": 0.05263157894736842, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1042", "startMs": "1665768423731", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $121, $131 := $120", "$80 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $80", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0037593984962406013, "waitRatioMax": 0.0037593984962406013, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.03383458646616541 }, { "completedParallelInputs": "1", "computeMsAvg": "186", "computeMsMax": "186", "computeRatioAvg": 0.6992481203007519, "computeRatioMax": 0.6992481203007519, "endMs": "1665768423983", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "273730", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "160", "startMs": "1665768423871", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$161, $160, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170", "$90 := SHARD_AVG($100)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161", "$100 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$180, $90", "TO __stage06_output", "BY HASH($180)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.018796992481203006, "writeRatioMax": 0.018796992481203006 }, { "completedParallelInputs": "1", "computeMsAvg": "78", "computeMsMax": "78", "computeRatioAvg": 0.2932330827067669, "computeRatioMax": 0.2932330827067669, "endMs": "1665768424092", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.04887218045112782, "readRatioMax": 0.04887218045112782, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "3045779", "shuffleOutputBytesSpilled": "0", "slotMs": "110", "startMs": "1665768424000", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0037593984962406013, "waitRatioMax": 0.0037593984962406013, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.07894736842105263, "writeRatioMax": 0.07894736842105263 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03383458646616541, "computeRatioMax": 0.03383458646616541, "endMs": "1665768424047", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.022556390977443608, "readRatioMax": 0.022556390977443608, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "219", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768424015", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0037593984962406013, "waitRatioMax": 0.0037593984962406013, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03383458646616541, "writeRatioMax": 0.03383458646616541 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03759398496240601, "computeRatioMax": 0.03759398496240601, "endMs": "1665768424057", "id": "9", "inputStages": [ "6" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768424030", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$70 := ROOT_AVG($90)" ] }, { "kind": "WRITE", "substeps": [ "$70, $190", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0037593984962406013, "waitRatioMax": 0.0037593984962406013, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06390977443609022, "writeRatioMax": 0.06390977443609022 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.03007518796992481, "computeRatioMax": 0.06390977443609022, "endMs": "1665768424117", "id": "11", "inputStages": [ "9" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "3565", "startMs": "1665768424061", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0037593984962406013, "waitRatioMax": 0.007518796992481203, "writeMsAvg": "22", "writeMsMax": "30", "writeRatioAvg": 0.08270676691729323, "writeRatioMax": 0.11278195488721804 }, { "completedParallelInputs": "1", "computeMsAvg": "266", "computeMsMax": "266", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768424257", "id": "13", "inputStages": [ "5", "7", "11", "8" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "291748", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "167", "startMs": "1665768424113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $190", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$220 := $212, $221 := $211, $222 := $2, $223 := $3, $224 := $4, $225 := $5", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $202, $212 := $11", "INNER HASH JOIN EACH WITH ALL ON $201 = $10" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($202, multiply(NUMERIC<...>, $203))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $141, $201 := $140, $202 := $60, $203 := $70", "INNER HASH JOIN EACH WITH ALL ON $140 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$60 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235", "TO __stage0D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.007518796992481203, "writeRatioMax": 0.007518796992481203 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.041353383458646614, "computeRatioMax": 0.041353383458646614, "endMs": "1665768424277", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "126", "startMs": "1665768424129", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0037593984962406013, "waitRatioMax": 0.0037593984962406013, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.022556390977443608, "writeRatioMax": 0.022556390977443608 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "118", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "6198" }, { "activeUnits": "2", "completedUnits": "120", "elapsedMs": "770", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6492" } ], "totalBytesBilled": "115343360", "totalBytesProcessed": "115113404", "totalPartitionsProcessed": "0", "totalSlotMs": "6492", "transferredBytes": "0" }, "startTime": "1665768423561", "totalBytesProcessed": "115113404", "totalSlotMs": "6492" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb72aaee8_e06e_4846_93c5_304fba9d4dba" }, "priority": "INTERACTIVE", "query": "select\n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t (select ss_store_sk, ss_item_sk, \n \t\t sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n sc.revenue <= 0.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp sb.ave and\n s_store_sk = sc.ss_store_sk and\n i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "qXbTwogB8/gU3z4DOuPCrw==", "id": "test-project-364309:europe-west1.query65_1665778338", "jobReference": { "jobId": "query65_1665778338", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query65_1665778338?location=europe-west1", "statistics": { "creationTime": "1665778339346", "endTime": "1665778340235", "finalExecutionDurationMs": "690", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "115113404", "performanceInsights": { "avgPreviousExecutionMs": "668" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.034210526315789476, "computeRatioMax": 0.034210526315789476, "endMs": "1665778339526", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02631578947368421, "readRatioMax": 0.02631578947368421, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778339483", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002631578947368421, "waitRatioMax": 0.002631578947368421, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.021052631578947368, "writeRatioMax": 0.021052631578947368 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.015789473684210527, "computeRatioMax": 0.015789473684210527, "endMs": "1665778339549", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013157894736842105, "readRatioMax": 0.013157894736842105, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778339514", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002631578947368421, "waitRatioMax": 0.002631578947368421, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.060526315789473685, "writeRatioMax": 0.060526315789473685 }, { "completedParallelInputs": "6", "computeMsAvg": "173", "computeMsMax": "220", "computeRatioAvg": 0.45526315789473687, "computeRatioMax": 0.5789473684210527, "endMs": "1665778339677", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "19", "readRatioAvg": 0.02631578947368421, "readRatioMax": 0.05, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "954", "startMs": "1665778339536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $151, $161 := $150", "$110 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $41, $151 := $42, $152 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$161, $160, $110", "TO __stage04_output", "BY HASH($160, $161)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002631578947368421, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.018421052631578946, "writeRatioMax": 0.02631578947368421 }, { "completedParallelInputs": "6", "computeMsAvg": "220", "computeMsMax": "380", "computeRatioAvg": 0.5789473684210527, "computeRatioMax": 1, "endMs": "1665778339799", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.031578947368421054, "readRatioMax": 0.042105263157894736, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1206", "startMs": "1665778339574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $121, $131 := $120", "$80 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $80", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.005263157894736842, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.018421052631578946, "writeRatioMax": 0.02368421052631579 }, { "completedParallelInputs": "1", "computeMsAvg": "149", "computeMsMax": "149", "computeRatioAvg": 0.39210526315789473, "computeRatioMax": 0.39210526315789473, "endMs": "1665778339813", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "273730", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "148", "startMs": "1665778339712", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$161, $160, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170", "$90 := SHARD_AVG($100)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161", "$100 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$180, $90", "TO __stage06_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002631578947368421, "waitRatioMax": 0.002631578947368421, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.018421052631578946, "writeRatioMax": 0.018421052631578946 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.16578947368421051, "computeRatioMax": 0.16578947368421051, "endMs": "1665778339926", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02368421052631579, "readRatioMax": 0.02368421052631579, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "3045779", "shuffleOutputBytesSpilled": "0", "slotMs": "111", "startMs": "1665778339842", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002631578947368421, "waitRatioMax": 0.002631578947368421, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02894736842105263, "writeRatioMax": 0.02894736842105263 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.010526315789473684, "computeRatioMax": 0.010526315789473684, "endMs": "1665778339893", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "2", "readMsMax": "2", "readRatioAvg": 0.005263157894736842, "readRatioMax": 0.005263157894736842, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "219", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778339857", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002631578947368421, "waitRatioMax": 0.002631578947368421, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.07368421052631578, "writeRatioMax": 0.07368421052631578 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02368421052631579, "computeRatioMax": 0.02368421052631579, "endMs": "1665778339903", "id": "9", "inputStages": [ "6" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778339872", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$70 := ROOT_AVG($90)" ] }, { "kind": "WRITE", "substeps": [ "$70, $190", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002631578947368421, "waitRatioMax": 0.002631578947368421, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.034210526315789476, "writeRatioMax": 0.034210526315789476 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.021052631578947368, "computeRatioMax": 0.04736842105263158, "endMs": "1665778339979", "id": "11", "inputStages": [ "9" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4669", "startMs": "1665778339919", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.005263157894736842, "waitRatioMax": 0.013157894736842105, "writeMsAvg": "22", "writeMsMax": "31", "writeRatioAvg": 0.05789473684210526, "writeRatioMax": 0.08157894736842106 }, { "completedParallelInputs": "1", "computeMsAvg": "280", "computeMsMax": "280", "computeRatioAvg": 0.7368421052631579, "computeRatioMax": 0.7368421052631579, "endMs": "1665778340099", "id": "13", "inputStages": [ "7", "5", "8", "11" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "291748", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "286", "startMs": "1665778339935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $190", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$220 := $212, $221 := $211, $222 := $2, $223 := $3, $224 := $4, $225 := $5", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $202, $212 := $11", "INNER HASH JOIN EACH WITH ALL ON $201 = $10" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($202, multiply(NUMERIC<...>, $203))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $141, $201 := $140, $202 := $60, $203 := $70", "INNER HASH JOIN EACH WITH ALL ON $140 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$60 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235", "TO __stage0D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007894736842105263, "writeRatioMax": 0.007894736842105263 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.031578947368421054, "computeRatioMax": 0.031578947368421054, "endMs": "1665778340120", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "160", "startMs": "1665778339952", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245", "TO __stage0E_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "118", "elapsedMs": "590", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "7229" }, { "activeUnits": "2", "completedUnits": "120", "elapsedMs": "780", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7686" } ], "totalBytesBilled": "115343360", "totalBytesProcessed": "115113404", "totalPartitionsProcessed": "0", "totalSlotMs": "7686", "transferredBytes": "0" }, "startTime": "1665778339394", "totalBytesProcessed": "115113404", "totalSlotMs": "7686" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond441cb1e_a239_4120_8aa8_195a2fbdd14a" }, "priority": "INTERACTIVE", "query": "select\n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t (select ss_store_sk, ss_item_sk, \n \t\t sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n sc.revenue <= 0.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp sb.ave and\n s_store_sk = sc.ss_store_sk and\n i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "vMCb0Po6CRE15YlSMa2hSg==", "id": "test-project-364309:europe-west1.query65_1665778342", "jobReference": { "jobId": "query65_1665778342", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query65_1665778342?location=europe-west1", "statistics": { "creationTime": "1665778343406", "endTime": "1665778344340", "finalExecutionDurationMs": "772", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "115113404", "performanceInsights": { "avgPreviousExecutionMs": "674" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.023728813559322035, "computeRatioMax": 0.023728813559322035, "endMs": "1665778343554", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01694915254237288, "readRatioMax": 0.01694915254237288, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665778343530", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04067796610169491, "writeRatioMax": 0.04067796610169491 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04067796610169491, "computeRatioMax": 0.04067796610169491, "endMs": "1665778343602", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020338983050847456, "readRatioMax": 0.020338983050847456, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778343572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.04406779661016949, "waitRatioMax": 0.04406779661016949, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05084745762711865, "writeRatioMax": 0.05084745762711865 }, { "completedParallelInputs": "6", "computeMsAvg": "198", "computeMsMax": "234", "computeRatioAvg": 0.6711864406779661, "computeRatioMax": 0.7932203389830509, "endMs": "1665778343711", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "11", "readRatioAvg": 0.030508474576271188, "readRatioMax": 0.03728813559322034, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1089", "startMs": "1665778343575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $151, $161 := $150", "$110 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $41, $151 := $42, $152 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$161, $160, $110", "TO __stage04_output", "BY HASH($160, $161)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.020338983050847456, "writeRatioMax": 0.023728813559322035 }, { "completedParallelInputs": "6", "computeMsAvg": "189", "computeMsMax": "241", "computeRatioAvg": 0.6406779661016949, "computeRatioMax": 0.8169491525423729, "endMs": "1665778343748", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.04406779661016949, "readRatioMax": 0.061016949152542375, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1067", "startMs": "1665778343607", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $121, $131 := $120", "$80 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $80", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "7", "writeMsMax": "12", "writeRatioAvg": 0.023728813559322035, "writeRatioMax": 0.04067796610169491 }, { "completedParallelInputs": "1", "computeMsAvg": "221", "computeMsMax": "221", "computeRatioAvg": 0.7491525423728813, "computeRatioMax": 0.7491525423728813, "endMs": "1665778343885", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "273730", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "245", "startMs": "1665778343727", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$161, $160, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170", "$90 := SHARD_AVG($100)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161", "$100 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$180, $90", "TO __stage06_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02711864406779661, "writeRatioMax": 0.02711864406779661 }, { "completedParallelInputs": "1", "computeMsAvg": "53", "computeMsMax": "53", "computeRatioAvg": 0.17966101694915254, "computeRatioMax": 0.17966101694915254, "endMs": "1665778343995", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02711864406779661, "readRatioMax": 0.02711864406779661, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "3045779", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665778343935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.030508474576271188, "writeRatioMax": 0.030508474576271188 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.023728813559322035, "computeRatioMax": 0.023728813559322035, "endMs": "1665778343975", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.013559322033898305, "readRatioMax": 0.013559322033898305, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "219", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778343946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.061016949152542375, "writeRatioMax": 0.061016949152542375 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02711864406779661, "computeRatioMax": 0.02711864406779661, "endMs": "1665778343995", "id": "9", "inputStages": [ "6" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778343959", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$70 := ROOT_AVG($90)" ] }, { "kind": "WRITE", "substeps": [ "$70, $190", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.003389830508474576, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05423728813559322, "writeRatioMax": 0.05423728813559322 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.02711864406779661, "computeRatioMax": 0.05423728813559322, "endMs": "1665778344062", "id": "11", "inputStages": [ "9" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "3584", "startMs": "1665778344007", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.006779661016949152, "waitRatioMax": 0.013559322033898305, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.061016949152542375, "writeRatioMax": 0.09830508474576272 }, { "completedParallelInputs": "1", "computeMsAvg": "295", "computeMsMax": "295", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778344226", "id": "13", "inputStages": [ "11", "8", "7", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "291748", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "312", "startMs": "1665778344019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $190", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$220 := $212, $221 := $211, $222 := $2, $223 := $3, $224 := $4, $225 := $5", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $202, $212 := $11", "INNER HASH JOIN EACH WITH ALL ON $201 = $10" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($202, multiply(NUMERIC<...>, $203))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $141, $201 := $140, $202 := $60, $203 := $70", "INNER HASH JOIN EACH WITH ALL ON $140 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$60 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235", "TO __stage0D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013559322033898305, "writeRatioMax": 0.013559322033898305 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.020338983050847456, "computeRatioMax": 0.020338983050847456, "endMs": "1665778344235", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "188", "startMs": "1665778344033", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006779661016949152, "waitRatioMax": 0.006779661016949152, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010169491525423728, "writeRatioMax": 0.010169491525423728 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "101", "completedUnits": "18", "elapsedMs": "576", "estimatedRunnableUnits": "0", "pendingUnits": "102", "totalSlotMs": "2631" }, { "activeUnits": "101", "completedUnits": "120", "elapsedMs": "843", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6673" } ], "totalBytesBilled": "115343360", "totalBytesProcessed": "115113404", "totalPartitionsProcessed": "0", "totalSlotMs": "6673", "transferredBytes": "0" }, "startTime": "1665778343455", "totalBytesProcessed": "115113404", "totalSlotMs": "6673" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbed631b2_cb17_44aa_b57f_f140c8a7d59a" }, "priority": "INTERACTIVE", "query": "select\n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t (select ss_store_sk, ss_item_sk, \n \t\t sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n sc.revenue <= 0.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp sb.ave and\n s_store_sk = sc.ss_store_sk and\n i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "XJyKby1J0ezHnhUpizwnRw==", "id": "test-project-364309:europe-west1.query65_1665778345", "jobReference": { "jobId": "query65_1665778345", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query65_1665778345?location=europe-west1", "statistics": { "creationTime": "1665778346370", "endTime": "1665778347175", "finalExecutionDurationMs": "643", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "115113404", "performanceInsights": { "avgPreviousExecutionMs": "693" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.047058823529411764, "computeRatioMax": 0.047058823529411764, "endMs": "1665778346528", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.027450980392156862, "readRatioMax": 0.027450980392156862, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778346493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03137254901960784, "writeRatioMax": 0.03137254901960784 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.047058823529411764, "computeRatioMax": 0.047058823529411764, "endMs": "1665778346558", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03529411764705882, "readRatioMax": 0.03529411764705882, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778346521", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.027450980392156862, "writeRatioMax": 0.027450980392156862 }, { "completedParallelInputs": "6", "computeMsAvg": "193", "computeMsMax": "250", "computeRatioAvg": 0.7568627450980392, "computeRatioMax": 0.9803921568627451, "endMs": "1665778346702", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.043137254901960784, "readRatioMax": 0.058823529411764705, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1217", "startMs": "1665778346545", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $151, $161 := $150", "$110 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $41, $151 := $42, $152 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$161, $160, $110", "TO __stage04_output", "BY HASH($160, $161)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.027450980392156862, "writeRatioMax": 0.0392156862745098 }, { "completedParallelInputs": "6", "computeMsAvg": "215", "computeMsMax": "255", "computeRatioAvg": 0.8431372549019608, "computeRatioMax": 1, "endMs": "1665778346730", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.0392156862745098, "readRatioMax": 0.050980392156862744, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1167", "startMs": "1665778346575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $121, $131 := $120", "$80 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $80", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "8", "writeMsMax": "11", "writeRatioAvg": 0.03137254901960784, "writeRatioMax": 0.043137254901960784 }, { "completedParallelInputs": "1", "computeMsAvg": "136", "computeMsMax": "136", "computeRatioAvg": 0.5333333333333333, "computeRatioMax": 0.5333333333333333, "endMs": "1665778346805", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "273730", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "137", "startMs": "1665778346720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$161, $160, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170", "$90 := SHARD_AVG($100)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161", "$100 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$180, $90", "TO __stage06_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.027450980392156862, "writeRatioMax": 0.027450980392156862 }, { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.1843137254901961, "computeRatioMax": 0.1843137254901961, "endMs": "1665778346899", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.027450980392156862, "readRatioMax": 0.027450980392156862, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "3045779", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665778346828", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03137254901960784, "writeRatioMax": 0.03137254901960784 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.047058823529411764, "computeRatioMax": 0.047058823529411764, "endMs": "1665778346888", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01568627450980392, "readRatioMax": 0.01568627450980392, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "219", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665778346847", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00784313725490196, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07058823529411765, "writeRatioMax": 0.07058823529411765 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03529411764705882, "computeRatioMax": 0.03529411764705882, "endMs": "1665778346898", "id": "9", "inputStages": [ "6" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778346861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$70 := ROOT_AVG($90)" ] }, { "kind": "WRITE", "substeps": [ "$70, $190", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00392156862745098, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.03137254901960784, "computeRatioMax": 0.06666666666666667, "endMs": "1665778346957", "id": "11", "inputStages": [ "9" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4086", "startMs": "1665778346906", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00392156862745098, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.10588235294117647 }, { "completedParallelInputs": "1", "computeMsAvg": "229", "computeMsMax": "229", "computeRatioAvg": 0.8980392156862745, "computeRatioMax": 0.8980392156862745, "endMs": "1665778347081", "id": "13", "inputStages": [ "11", "8", "5", "7" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "291748", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "256", "startMs": "1665778346918", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $190", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$220 := $212, $221 := $211, $222 := $2, $223 := $3, $224 := $4, $225 := $5", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $202, $212 := $11", "INNER HASH JOIN EACH WITH ALL ON $201 = $10" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($202, multiply(NUMERIC<...>, $203))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $141, $201 := $140, $202 := $60, $203 := $70", "INNER HASH JOIN EACH WITH ALL ON $140 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$60 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235", "TO __stage0D_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.011764705882352941, "writeRatioMax": 0.011764705882352941 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0392156862745098, "computeRatioMax": 0.0392156862745098, "endMs": "1665778347098", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "168", "startMs": "1665778346934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00784313725490196, "waitRatioMax": 0.00784313725490196, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0196078431372549, "writeRatioMax": 0.0196078431372549 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "118", "elapsedMs": "584", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "6902" }, { "activeUnits": "2", "completedUnits": "120", "elapsedMs": "721", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7289" } ], "totalBytesBilled": "115343360", "totalBytesProcessed": "115113404", "totalPartitionsProcessed": "0", "totalSlotMs": "7289", "transferredBytes": "0" }, "startTime": "1665778346410", "totalBytesProcessed": "115113404", "totalSlotMs": "7289" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon132a470b_9dbe_48c0_9a99_b7d1174b339f" }, "priority": "INTERACTIVE", "query": "select\n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t (select ss_store_sk, ss_item_sk, \n \t\t sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n sc.revenue <= 0.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp sb.ave and\n s_store_sk = sc.ss_store_sk and\n i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "KFMUxgSGTiLJafyOORb1Dw==", "id": "test-project-364309:europe-west1.query65_1665778348", "jobReference": { "jobId": "query65_1665778348", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query65_1665778348?location=europe-west1", "statistics": { "creationTime": "1665778349044", "endTime": "1665778350083", "finalExecutionDurationMs": "844", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "115113404", "performanceInsights": { "avgPreviousExecutionMs": "685" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03169014084507042, "computeRatioMax": 0.03169014084507042, "endMs": "1665778349242", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02112676056338028, "readRatioMax": 0.02112676056338028, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778349202", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035211267605633804, "waitRatioMax": 0.0035211267605633804, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.045774647887323945, "writeRatioMax": 0.045774647887323945 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.045774647887323945, "computeRatioMax": 0.045774647887323945, "endMs": "1665778349283", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03169014084507042, "readRatioMax": 0.03169014084507042, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778349240", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04225352112676056, "writeRatioMax": 0.04225352112676056 }, { "completedParallelInputs": "6", "computeMsAvg": "181", "computeMsMax": "284", "computeRatioAvg": 0.6373239436619719, "computeRatioMax": 1, "endMs": "1665778349471", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "23", "readRatioAvg": 0.04929577464788732, "readRatioMax": 0.08098591549295775, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1202", "startMs": "1665778349270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $151, $161 := $150", "$110 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $41, $151 := $42, $152 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$161, $160, $110", "TO __stage04_output", "BY HASH($160, $161)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.02464788732394366, "writeRatioMax": 0.03169014084507042 }, { "completedParallelInputs": "6", "computeMsAvg": "165", "computeMsMax": "220", "computeRatioAvg": 0.5809859154929577, "computeRatioMax": 0.7746478873239436, "endMs": "1665778349473", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.045774647887323945, "readRatioMax": 0.06338028169014084, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1074", "startMs": "1665778349303", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $121, $131 := $120", "$80 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $80", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0035211267605633804, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.02464788732394366, "writeRatioMax": 0.03169014084507042 }, { "completedParallelInputs": "1", "computeMsAvg": "183", "computeMsMax": "183", "computeRatioAvg": 0.6443661971830986, "computeRatioMax": 0.6443661971830986, "endMs": "1665778349628", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "273730", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "201", "startMs": "1665778349509", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$161, $160, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170", "$90 := SHARD_AVG($100)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161", "$100 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$180, $90", "TO __stage06_output", "BY HASH($180)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.007042253521126761, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02112676056338028, "writeRatioMax": 0.02112676056338028 }, { "completedParallelInputs": "1", "computeMsAvg": "59", "computeMsMax": "59", "computeRatioAvg": 0.20774647887323944, "computeRatioMax": 0.20774647887323944, "endMs": "1665778349747", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03873239436619718, "readRatioMax": 0.03873239436619718, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "3045779", "shuffleOutputBytesSpilled": "0", "slotMs": "96", "startMs": "1665778349679", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035211267605633804, "waitRatioMax": 0.0035211267605633804, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04225352112676056, "writeRatioMax": 0.04225352112676056 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.028169014084507043, "endMs": "1665778349736", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.017605633802816902, "readRatioMax": 0.017605633802816902, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "219", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778349696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035211267605633804, "waitRatioMax": 0.0035211267605633804, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.09507042253521127, "writeRatioMax": 0.09507042253521127 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.028169014084507043, "endMs": "1665778349755", "id": "9", "inputStages": [ "6" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778349717", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$70 := ROOT_AVG($90)" ] }, { "kind": "WRITE", "substeps": [ "$70, $190", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035211267605633804, "waitRatioMax": 0.0035211267605633804, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.06338028169014084, "writeRatioMax": 0.06338028169014084 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.028169014084507043, "computeRatioMax": 0.0528169014084507, "endMs": "1665778349827", "id": "11", "inputStages": [ "9" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4322", "startMs": "1665778349767", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.007042253521126761, "waitRatioMax": 0.01056338028169014, "writeMsAvg": "18", "writeMsMax": "31", "writeRatioAvg": 0.06338028169014084, "writeRatioMax": 0.10915492957746478 }, { "completedParallelInputs": "1", "computeMsAvg": "156", "computeMsMax": "156", "computeRatioAvg": 0.5492957746478874, "computeRatioMax": 0.5492957746478874, "endMs": "1665778349955", "id": "12", "inputStages": [ "11", "8", "7", "5" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "291748", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "220", "startMs": "1665778349773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $190", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$220 := $212, $221 := $211, $222 := $2, $223 := $3, $224 := $4, $225 := $5", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $202, $212 := $11", "INNER HASH JOIN EACH WITH ALL ON $201 = $10" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($202, multiply(NUMERIC<...>, $203))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $141, $201 := $140, $202 := $60, $203 := $70", "INNER HASH JOIN EACH WITH ALL ON $140 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$60 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235", "TO __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01056338028169014, "waitRatioMax": 0.01056338028169014, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.01056338028169014, "writeRatioMax": 0.01056338028169014 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.035211267605633804, "computeRatioMax": 0.035211267605633804, "endMs": "1665778349962", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "144", "startMs": "1665778349793", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.014084507042253521, "waitRatioMax": 0.014084507042253521, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.017605633802816902, "writeRatioMax": 0.017605633802816902 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "15", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "2580" }, { "activeUnits": "2", "completedUnits": "120", "elapsedMs": "941", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7444" } ], "totalBytesBilled": "115343360", "totalBytesProcessed": "115113404", "totalPartitionsProcessed": "0", "totalSlotMs": "7444", "transferredBytes": "0" }, "startTime": "1665778349094", "totalBytesProcessed": "115113404", "totalSlotMs": "7444" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon16616272_34d0_4081_bd44_b7d1a8ec4824" }, "priority": "INTERACTIVE", "query": "select\n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t (select ss_store_sk, ss_item_sk, \n \t\t sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1176 and 1176+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n sc.revenue <= 0.1 benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp sb.ave and\n s_store_sk = sc.ss_store_sk and\n i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Yh66TDVtH9Plupdyouh0vA==", "id": "test-project-364309:europe-west1.query65_1665778351", "jobReference": { "jobId": "query65_1665778351", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query65_1665778351?location=europe-west1", "statistics": { "creationTime": "1665778351743", "endTime": "1665778352658", "finalExecutionDurationMs": "716", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "115113404", "performanceInsights": { "avgPreviousExecutionMs": "708" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.036734693877551024, "computeRatioMax": 0.036734693877551024, "endMs": "1665778351936", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.024489795918367346, "readRatioMax": 0.024489795918367346, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778351897", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.061224489795918366, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.036734693877551024, "computeRatioMax": 0.036734693877551024, "endMs": "1665778351967", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.024489795918367346, "readRatioMax": 0.024489795918367346, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778351929", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_month_seq", "FROM date_dim", "WHERE between($31, 1176, 1187)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.053061224489795916, "writeRatioMax": 0.053061224489795916 }, { "completedParallelInputs": "6", "computeMsAvg": "184", "computeMsMax": "214", "computeRatioAvg": 0.7510204081632653, "computeRatioMax": 0.8734693877551021, "endMs": "1665778352087", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "20", "readRatioAvg": 0.04897959183673469, "readRatioMax": 0.08163265306122448, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1163", "startMs": "1665778351948", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $151, $161 := $150", "$110 := SUM($152)" ] }, { "kind": "JOIN", "substeps": [ "$150 := $41, $151 := $42, $152 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$161, $160, $110", "TO __stage04_output", "BY HASH($160, $161)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.02857142857142857, "writeRatioMax": 0.0326530612244898 }, { "completedParallelInputs": "6", "computeMsAvg": "187", "computeMsMax": "234", "computeRatioAvg": 0.763265306122449, "computeRatioMax": 0.9551020408163265, "endMs": "1665778352167", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "24", "readRatioAvg": 0.0653061224489796, "readRatioMax": 0.09795918367346938, "recordsRead": "2882594", "recordsWritten": "273730", "shuffleOutputBytes": "9380022", "shuffleOutputBytesSpilled": "0", "slotMs": "1325", "startMs": "1665778351983", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $121, $131 := $120", "$80 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $80", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "9", "writeMsMax": "15", "writeRatioAvg": 0.036734693877551024, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "1", "computeMsAvg": "150", "computeMsMax": "150", "computeRatioAvg": 0.6122448979591837, "computeRatioMax": 0.6122448979591837, "endMs": "1665778352205", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "273730", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "161", "startMs": "1665778352105", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$161, $160, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170", "$90 := SHARD_AVG($100)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $160, $171 := $161", "$100 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$180, $90", "TO __stage06_output", "BY HASH($180)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02857142857142857, "writeRatioMax": 0.02857142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "100", "computeMsMax": "100", "computeRatioAvg": 0.40816326530612246, "computeRatioMax": 0.40816326530612246, "endMs": "1665778352360", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04081632653061224, "readRatioMax": 0.04081632653061224, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "3045779", "shuffleOutputBytesSpilled": "0", "slotMs": "171", "startMs": "1665778352237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.061224489795918366, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.024489795918367346, "computeRatioMax": 0.024489795918367346, "endMs": "1665778352286", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0163265306122449, "readRatioMax": 0.0163265306122449, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "219", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778352249", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.061224489795918366, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.044897959183673466, "computeRatioMax": 0.044897959183673466, "endMs": "1665778352299", "id": "9", "inputStages": [ "6" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778352262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $90", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180", "$70 := ROOT_AVG($90)" ] }, { "kind": "WRITE", "substeps": [ "$70, $190", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07346938775510205, "writeRatioMax": 0.07346938775510205 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.0326530612244898, "computeRatioMax": 0.08571428571428572, "endMs": "1665778352356", "id": "11", "inputStages": [ "9" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "3861", "startMs": "1665778352307", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.00816326530612245, "writeMsAvg": "14", "writeMsMax": "31", "writeRatioAvg": 0.05714285714285714, "writeRatioMax": 0.12653061224489795 }, { "completedParallelInputs": "1", "computeMsAvg": "245", "computeMsMax": "245", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778352548", "id": "13", "inputStages": [ "5", "11", "8", "7" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "291748", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "263", "startMs": "1665778352381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$70, $190", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC, $222 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$220 := $212, $221 := $211, $222 := $2, $223 := $3, $224 := $4, $225 := $5", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $202, $212 := $11", "INNER HASH JOIN EACH WITH ALL ON $201 = $10" ] }, { "kind": "FILTER", "substeps": [ "less_or_equal($202, multiply(NUMERIC<...>, $203))" ] }, { "kind": "JOIN", "substeps": [ "$200 := $141, $201 := $140, $202 := $60, $203 := $70", "INNER HASH JOIN EACH WITH ALL ON $140 = $190" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$60 := SUM($80)" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $234, $235", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0163265306122449, "writeRatioMax": 0.0163265306122449 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02857142857142857, "computeRatioMax": 0.02857142857142857, "endMs": "1665778352578", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "18300", "shuffleOutputBytesSpilled": "0", "slotMs": "202", "startMs": "1665778352397", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $234, $235", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$234 ASC, $230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240, $241, $242, $243, $244, $245", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004081632653061225, "waitRatioMax": 0.004081632653061225, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.024489795918367346, "writeRatioMax": 0.024489795918367346 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "118", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "6811" }, { "activeUnits": "2", "completedUnits": "120", "elapsedMs": "818", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7277" } ], "totalBytesBilled": "115343360", "totalBytesProcessed": "115113404", "totalPartitionsProcessed": "0", "totalSlotMs": "7277", "transferredBytes": "0" }, "startTime": "1665778351791", "totalBytesProcessed": "115113404", "totalSlotMs": "7277" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
