{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6b099da4_2261_4fcb_87e3_d3b8fe70920b" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(cs_ext_sales_price) as itemrevenue \n ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n (partition by i_class) as revenueratio\n from\tcatalog_sales\n ,item \n ,date_dim\n where cs_item_sk = i_item_sk \n and i_category in ('Sports', 'Books', 'Home')\n and cs_sold_date_sk = d_date_sk\n and d_date between cast('1999-02-22' as date) \n \t\t\t\tand (cast('1999-02-22' + 30 as date))\n group by i_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\n order by i_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "TqYCOKmJIl7/RzYiFjTr+Q==", "id": "test-project-364309:europe-west1.query20_1665768262", "jobReference": { "jobId": "query20_1665768262", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query20_1665768262?location=europe-west1", "statistics": { "creationTime": "1665768263091", "endTime": "1665768263651", "finalExecutionDurationMs": "382", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50036771", "performanceInsights": { "avgPreviousExecutionMs": "481" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.09302325581395349, "computeRatioMax": 0.09302325581395349, "endMs": "1665768263259", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.046511627906976744, "readRatioMax": 0.046511627906976744, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665768263226", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0872093023255814, "writeRatioMax": 0.0872093023255814 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.19186046511627908, "computeRatioMax": 0.19186046511627908, "endMs": "1665768263277", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.05232558139534884, "readRatioMax": 0.05232558139534884, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768263240", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05232558139534884, "writeRatioMax": 0.05232558139534884 }, { "completedParallelInputs": "5", "computeMsAvg": "134", "computeMsMax": "172", "computeRatioAvg": 0.7790697674418605, "computeRatioMax": 1, "endMs": "1665768263399", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "20", "readRatioAvg": 0.0872093023255814, "readRatioMax": 0.11627906976744186, "recordsRead": "1468318", "recordsWritten": "3526", "shuffleOutputBytes": "646385", "shuffleOutputBytesSpilled": "0", "slotMs": "686", "startMs": "1665768263284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.03488372093023256, "writeRatioMax": 0.046511627906976744 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.11627906976744186, "computeRatioMax": 0.11627906976744186, "endMs": "1665768263436", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3526", "recordsWritten": "2103", "shuffleOutputBytes": "385311", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768263413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011627906976744186, "waitRatioMax": 0.011627906976744186, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.040697674418604654, "writeRatioMax": 0.040697674418604654 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.046511627906976744, "computeRatioMax": 0.046511627906976744, "endMs": "1665768263494", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768263458", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.11627906976744186, "writeRatioMax": 0.11627906976744186 }, { "completedParallelInputs": "86", "computeMsAvg": "8", "computeMsMax": "12", "computeRatioAvg": 0.046511627906976744, "computeRatioMax": 0.06976744186046512, "endMs": "1665768263555", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3414", "startMs": "1665768263505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.011627906976744186, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.09883720930232558, "writeRatioMax": 0.1744186046511628 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.05232558139534884, "computeRatioMax": 0.09883720930232558, "endMs": "1665768263554", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2103", "recordsWritten": "2077", "shuffleOutputBytes": "416172", "shuffleOutputBytesSpilled": "0", "slotMs": "2792", "startMs": "1665768263510", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.01744186046511628, "waitRatioMax": 0.023255813953488372, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.0755813953488372, "writeRatioMax": 0.11046511627906977 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.046511627906976744, "computeRatioMax": 0.046511627906976744, "endMs": "1665768263567", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2077", "recordsWritten": "100", "shuffleOutputBytes": "19977", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665768263520", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.023255813953488372, "waitRatioMax": 0.023255813953488372, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.01744186046511628, "writeRatioMax": 0.01744186046511628 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "197", "elapsedMs": "468", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "7047" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50036771", "totalPartitionsProcessed": "0", "totalSlotMs": "7047", "transferredBytes": "0" }, "startTime": "1665768263133", "totalBytesProcessed": "50036771", "totalSlotMs": "7047" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf3949b80_8948_4c02_b018_16b8a09bbd34" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(cs_ext_sales_price) as itemrevenue \n ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n (partition by i_class) as revenueratio\n from\tcatalog_sales\n ,item \n ,date_dim\n where cs_item_sk = i_item_sk \n and i_category in ('Sports', 'Books', 'Home')\n and cs_sold_date_sk = d_date_sk\n and d_date between cast('1999-02-22' as date) \n \t\t\t\tand (cast('1999-02-22' + 30 as date))\n group by i_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\n order by i_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "QjpnAHXx9zU85idJ0lSmEw==", "id": "test-project-364309:europe-west1.query20_1665776993", "jobReference": { "jobId": "query20_1665776993", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query20_1665776993?location=europe-west1", "statistics": { "creationTime": "1665776994182", "endTime": "1665776994830", "finalExecutionDurationMs": "422", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50036771", "performanceInsights": { "avgPreviousExecutionMs": "467" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.10126582278481013, "computeRatioMax": 0.10126582278481013, "endMs": "1665776994380", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04219409282700422, "readRatioMax": 0.04219409282700422, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776994333", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05485232067510549, "writeRatioMax": 0.05485232067510549 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.13924050632911392, "computeRatioMax": 0.13924050632911392, "endMs": "1665776994392", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.06329113924050633, "readRatioMax": 0.06329113924050633, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776994347", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0379746835443038, "writeRatioMax": 0.0379746835443038 }, { "completedParallelInputs": "5", "computeMsAvg": "153", "computeMsMax": "237", "computeRatioAvg": 0.6455696202531646, "computeRatioMax": 1, "endMs": "1665776994557", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "5", "readMsAvg": "21", "readMsMax": "28", "readRatioAvg": 0.08860759493670886, "readRatioMax": 0.11814345991561181, "recordsRead": "1468318", "recordsWritten": "3526", "shuffleOutputBytes": "646385", "shuffleOutputBytesSpilled": "0", "slotMs": "779", "startMs": "1665776994399", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.008438818565400843, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.02531645569620253, "writeRatioMax": 0.03375527426160337 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.08438818565400844, "computeRatioMax": 0.08438818565400844, "endMs": "1665776994595", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3526", "recordsWritten": "2103", "shuffleOutputBytes": "385311", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776994572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02531645569620253, "writeRatioMax": 0.02531645569620253 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03375527426160337, "computeRatioMax": 0.03375527426160337, "endMs": "1665776994659", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776994621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.1350210970464135, "writeRatioMax": 0.1350210970464135 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.03375527426160337, "computeRatioMax": 0.08438818565400844, "endMs": "1665776994708", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2844", "startMs": "1665776994663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.008438818565400843, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.05485232067510549, "writeRatioMax": 0.08016877637130802 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.03375527426160337, "computeRatioMax": 0.05485232067510549, "endMs": "1665776994708", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2103", "recordsWritten": "2077", "shuffleOutputBytes": "416172", "shuffleOutputBytesSpilled": "0", "slotMs": "2830", "startMs": "1665776994669", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "8", "waitRatioAvg": 0.012658227848101266, "waitRatioMax": 0.03375527426160337, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.05907172995780591, "writeRatioMax": 0.07172995780590717 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0379746835443038, "computeRatioMax": 0.0379746835443038, "endMs": "1665776994721", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2077", "recordsWritten": "100", "shuffleOutputBytes": "19977", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665776994677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008438818565400843, "waitRatioMax": 0.008438818565400843, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.016877637130801686, "writeRatioMax": 0.016877637130801686 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "211", "elapsedMs": "513", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6665" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50036771", "totalPartitionsProcessed": "0", "totalSlotMs": "6665", "transferredBytes": "0" }, "startTime": "1665776994239", "totalBytesProcessed": "50036771", "totalSlotMs": "6665" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon229b45ec_ded7_42ef_a9f7_46f75104e1b9" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(cs_ext_sales_price) as itemrevenue \n ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n (partition by i_class) as revenueratio\n from\tcatalog_sales\n ,item \n ,date_dim\n where cs_item_sk = i_item_sk \n and i_category in ('Sports', 'Books', 'Home')\n and cs_sold_date_sk = d_date_sk\n and d_date between cast('1999-02-22' as date) \n \t\t\t\tand (cast('1999-02-22' + 30 as date))\n group by i_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\n order by i_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "YaT29wgkyN+PBIxt0iYQsg==", "id": "test-project-364309:europe-west1.query20_1665776995", "jobReference": { "jobId": "query20_1665776995", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query20_1665776995?location=europe-west1", "statistics": { "creationTime": "1665776996554", "endTime": "1665776997265", "finalExecutionDurationMs": "441", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50036771", "performanceInsights": { "avgPreviousExecutionMs": "461" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06422018348623854, "computeRatioMax": 0.06422018348623854, "endMs": "1665776996783", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.027522935779816515, "readRatioMax": 0.027522935779816515, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776996741", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.009174311926605505, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05504587155963303, "writeRatioMax": 0.05504587155963303 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.14678899082568808, "computeRatioMax": 0.14678899082568808, "endMs": "1665776996801", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.04128440366972477, "readRatioMax": 0.04128440366972477, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776996759", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.045871559633027525 }, { "completedParallelInputs": "5", "computeMsAvg": "130", "computeMsMax": "218", "computeRatioAvg": 0.5963302752293578, "computeRatioMax": 1, "endMs": "1665776996973", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "5", "readMsAvg": "17", "readMsMax": "30", "readRatioAvg": 0.0779816513761468, "readRatioMax": 0.13761467889908258, "recordsRead": "1468318", "recordsWritten": "3526", "shuffleOutputBytes": "646385", "shuffleOutputBytesSpilled": "0", "slotMs": "795", "startMs": "1665776996810", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.027522935779816515, "writeRatioMax": 0.04128440366972477 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.08256880733944955, "computeRatioMax": 0.08256880733944955, "endMs": "1665776997007", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3526", "recordsWritten": "2103", "shuffleOutputBytes": "385311", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776996985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.027522935779816515, "writeRatioMax": 0.027522935779816515 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03211009174311927, "computeRatioMax": 0.03211009174311927, "endMs": "1665776997070", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776997035", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.13302752293577982, "writeRatioMax": 0.13302752293577982 }, { "completedParallelInputs": "83", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.03669724770642202, "computeRatioMax": 0.0871559633027523, "endMs": "1665776997132", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3301", "startMs": "1665776997078", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.009174311926605505, "waitRatioMax": 0.013761467889908258, "writeMsAvg": "25", "writeMsMax": "30", "writeRatioAvg": 0.11467889908256881, "writeRatioMax": 0.13761467889908258 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.04128440366972477, "computeRatioMax": 0.06422018348623854, "endMs": "1665776997131", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2103", "recordsWritten": "2077", "shuffleOutputBytes": "416172", "shuffleOutputBytesSpilled": "0", "slotMs": "3098", "startMs": "1665776997083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.01834862385321101, "waitRatioMax": 0.027522935779816515, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.06422018348623854, "writeRatioMax": 0.11467889908256881 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05504587155963303, "computeRatioMax": 0.05504587155963303, "endMs": "1665776997143", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2077", "recordsWritten": "100", "shuffleOutputBytes": "19977", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776997097", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03669724770642202, "writeRatioMax": 0.03669724770642202 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "194", "elapsedMs": "556", "estimatedRunnableUnits": "0", "pendingUnits": "17", "totalSlotMs": "7377" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50036771", "totalPartitionsProcessed": "0", "totalSlotMs": "7377", "transferredBytes": "0" }, "startTime": "1665776996624", "totalBytesProcessed": "50036771", "totalSlotMs": "7377" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1509d436_491f_47ec_8251_b094372cd7d5" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(cs_ext_sales_price) as itemrevenue \n ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n (partition by i_class) as revenueratio\n from\tcatalog_sales\n ,item \n ,date_dim\n where cs_item_sk = i_item_sk \n and i_category in ('Sports', 'Books', 'Home')\n and cs_sold_date_sk = d_date_sk\n and d_date between cast('1999-02-22' as date) \n \t\t\t\tand (cast('1999-02-22' + 30 as date))\n group by i_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\n order by i_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "zoUAmf1ZHiUUXwO7LmxGLg==", "id": "test-project-364309:europe-west1.query20_1665776998", "jobReference": { "jobId": "query20_1665776998", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query20_1665776998?location=europe-west1", "statistics": { "creationTime": "1665776998840", "endTime": "1665776999502", "finalExecutionDurationMs": "433", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50036771", "performanceInsights": { "avgPreviousExecutionMs": "459" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665776999041", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.040229885057471264, "readRatioMax": 0.040229885057471264, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776998998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08045977011494253, "writeRatioMax": 0.08045977011494253 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.20689655172413793, "computeRatioMax": 0.20689655172413793, "endMs": "1665776999055", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.05172413793103448, "readRatioMax": 0.05172413793103448, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776999017", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.04597701149425287, "writeRatioMax": 0.04597701149425287 }, { "completedParallelInputs": "5", "computeMsAvg": "124", "computeMsMax": "174", "computeRatioAvg": 0.7126436781609196, "computeRatioMax": 1, "endMs": "1665776999177", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.06896551724137931, "readRatioMax": 0.08620689655172414, "recordsRead": "1468318", "recordsWritten": "3526", "shuffleOutputBytes": "646385", "shuffleOutputBytesSpilled": "0", "slotMs": "638", "startMs": "1665776999071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.028735632183908046, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.10344827586206896, "computeRatioMax": 0.10344827586206896, "endMs": "1665776999201", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3526", "recordsWritten": "2103", "shuffleOutputBytes": "385311", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665776999185", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.028735632183908046, "writeRatioMax": 0.028735632183908046 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05172413793103448, "computeRatioMax": 0.05172413793103448, "endMs": "1665776999273", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776999224", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.1839080459770115, "writeRatioMax": 0.1839080459770115 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.10344827586206896, "endMs": "1665776999349", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4142", "startMs": "1665776999280", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "21", "writeMsMax": "31", "writeRatioAvg": 0.1206896551724138, "writeRatioMax": 0.1781609195402299 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "21", "computeRatioAvg": 0.05747126436781609, "computeRatioMax": 0.1206896551724138, "endMs": "1665776999364", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2103", "recordsWritten": "2077", "shuffleOutputBytes": "416172", "shuffleOutputBytesSpilled": "0", "slotMs": "4136", "startMs": "1665776999286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.017241379310344827, "waitRatioMax": 0.022988505747126436, "writeMsAvg": "26", "writeMsMax": "49", "writeRatioAvg": 0.14942528735632185, "writeRatioMax": 0.28160919540229884 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.034482758620689655, "computeRatioMax": 0.034482758620689655, "endMs": "1665776999386", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2077", "recordsWritten": "100", "shuffleOutputBytes": "19977", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776999305", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.017241379310344827, "waitRatioMax": 0.017241379310344827, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.017241379310344827, "writeRatioMax": 0.017241379310344827 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "211", "elapsedMs": "539", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8965" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50036771", "totalPartitionsProcessed": "0", "totalSlotMs": "8965", "transferredBytes": "0" }, "startTime": "1665776998891", "totalBytesProcessed": "50036771", "totalSlotMs": "8965" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6f8798f0_a336_4674_ab84_5664a8ae90f6" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(cs_ext_sales_price) as itemrevenue \n ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n (partition by i_class) as revenueratio\n from\tcatalog_sales\n ,item \n ,date_dim\n where cs_item_sk = i_item_sk \n and i_category in ('Sports', 'Books', 'Home')\n and cs_sold_date_sk = d_date_sk\n and d_date between cast('1999-02-22' as date) \n \t\t\t\tand (cast('1999-02-22' + 30 as date))\n group by i_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\n order by i_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Kcc+E/PamBmHUNYeThwAGQ==", "id": "test-project-364309:europe-west1.query20_1665777000", "jobReference": { "jobId": "query20_1665777000", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query20_1665777000?location=europe-west1", "statistics": { "creationTime": "1665777001130", "endTime": "1665777001702", "finalExecutionDurationMs": "390", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50036771", "performanceInsights": { "avgPreviousExecutionMs": "456" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06763285024154589, "computeRatioMax": 0.06763285024154589, "endMs": "1665777001299", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.033816425120772944, "readRatioMax": 0.033816425120772944, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777001265", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06280193236714976, "writeRatioMax": 0.06280193236714976 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.17391304347826086, "computeRatioMax": 0.17391304347826086, "endMs": "1665777001319", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777001279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04830917874396135, "writeRatioMax": 0.04830917874396135 }, { "completedParallelInputs": "5", "computeMsAvg": "141", "computeMsMax": "207", "computeRatioAvg": 0.6811594202898551, "computeRatioMax": 1, "endMs": "1665777001465", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "5", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.07729468599033816, "readRatioMax": 0.09178743961352658, "recordsRead": "1468318", "recordsWritten": "3526", "shuffleOutputBytes": "646385", "shuffleOutputBytesSpilled": "0", "slotMs": "750", "startMs": "1665777001333", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.028985507246376812, "writeRatioMax": 0.03864734299516908 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05314009661835749, "computeRatioMax": 0.05314009661835749, "endMs": "1665777001487", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3526", "recordsWritten": "2103", "shuffleOutputBytes": "385311", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665777001473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01932367149758454, "writeRatioMax": 0.01932367149758454 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03864734299516908, "computeRatioMax": 0.03864734299516908, "endMs": "1665777001539", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777001505", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.004830917874396135, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.08695652173913043, "writeRatioMax": 0.08695652173913043 }, { "completedParallelInputs": "99", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.03864734299516908, "computeRatioMax": 0.08695652173913043, "endMs": "1665777001603", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3634", "startMs": "1665777001554", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.004830917874396135, "waitRatioMax": 0.014492753623188406, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.07246376811594203, "writeRatioMax": 0.13043478260869565 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.03864734299516908, "computeRatioMax": 0.06763285024154589, "endMs": "1665777001603", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2103", "recordsWritten": "2077", "shuffleOutputBytes": "416172", "shuffleOutputBytesSpilled": "0", "slotMs": "3064", "startMs": "1665777001559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.01932367149758454, "waitRatioMax": 0.024154589371980676, "writeMsAvg": "13", "writeMsMax": "21", "writeRatioAvg": 0.06280193236714976, "writeRatioMax": 0.10144927536231885 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.07246376811594203, "computeRatioMax": 0.07246376811594203, "endMs": "1665777001624", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2077", "recordsWritten": "100", "shuffleOutputBytes": "19977", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665777001570", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00966183574879227, "waitRatioMax": 0.00966183574879227, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01932367149758454, "writeRatioMax": 0.01932367149758454 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "210", "elapsedMs": "475", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7693" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50036771", "totalPartitionsProcessed": "0", "totalSlotMs": "7693", "transferredBytes": "0" }, "startTime": "1665777001177", "totalBytesProcessed": "50036771", "totalSlotMs": "7693" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonee3317a2_9568_47e3_88ae_7496b3504019" }, "priority": "INTERACTIVE", "query": "select i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(cs_ext_sales_price) as itemrevenue \n ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n (partition by i_class) as revenueratio\n from\tcatalog_sales\n ,item \n ,date_dim\n where cs_item_sk = i_item_sk \n and i_category in ('Sports', 'Books', 'Home')\n and cs_sold_date_sk = d_date_sk\n and d_date between cast('1999-02-22' as date) \n \t\t\t\tand (cast('1999-02-22' + 30 as date))\n group by i_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\n order by i_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "lf4f+NYCJSwFCyH15RHREQ==", "id": "test-project-364309:europe-west1.query20_1665777002", "jobReference": { "jobId": "query20_1665777002", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query20_1665777002?location=europe-west1", "statistics": { "creationTime": "1665777003333", "endTime": "1665777003913", "finalExecutionDurationMs": "384", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50036771", "performanceInsights": { "avgPreviousExecutionMs": "450" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05527638190954774, "computeRatioMax": 0.05527638190954774, "endMs": "1665777003506", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.035175879396984924, "readRatioMax": 0.035175879396984924, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777003474", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03015075376884422, "writeRatioMax": 0.03015075376884422 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.1507537688442211, "computeRatioMax": 0.1507537688442211, "endMs": "1665777003523", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04020100502512563, "readRatioMax": 0.04020100502512563, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777003486", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04522613065326633, "writeRatioMax": 0.04522613065326633 }, { "completedParallelInputs": "5", "computeMsAvg": "138", "computeMsMax": "199", "computeRatioAvg": 0.6934673366834171, "computeRatioMax": 1, "endMs": "1665777003667", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "5", "readMsAvg": "15", "readMsMax": "22", "readRatioAvg": 0.07537688442211055, "readRatioMax": 0.11055276381909548, "recordsRead": "1468318", "recordsWritten": "3526", "shuffleOutputBytes": "646385", "shuffleOutputBytesSpilled": "0", "slotMs": "775", "startMs": "1665777003535", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "3", "writeMsMax": "4", "writeRatioAvg": 0.01507537688442211, "writeRatioMax": 0.020100502512562814 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.08542713567839195, "computeRatioMax": 0.08542713567839195, "endMs": "1665777003693", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "3526", "recordsWritten": "2103", "shuffleOutputBytes": "385311", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665777003676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.020100502512562814, "writeRatioMax": 0.020100502512562814 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04020100502512563, "computeRatioMax": 0.04020100502512563, "endMs": "1665777003757", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777003719", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.005025125628140704, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.10050251256281408, "writeRatioMax": 0.10050251256281408 }, { "completedParallelInputs": "94", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.04020100502512563, "computeRatioMax": 0.06532663316582915, "endMs": "1665777003809", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2872", "startMs": "1665777003764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005025125628140704, "waitRatioMax": 0.010050251256281407, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.07537688442211055, "writeRatioMax": 0.15577889447236182 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.04020100502512563, "computeRatioMax": 0.07035175879396985, "endMs": "1665777003808", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2103", "recordsWritten": "2077", "shuffleOutputBytes": "416172", "shuffleOutputBytesSpilled": "0", "slotMs": "2507", "startMs": "1665777003769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.01507537688442211, "waitRatioMax": 0.020100502512562814, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.06532663316582915, "writeRatioMax": 0.09045226130653267 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06030150753768844, "computeRatioMax": 0.06030150753768844, "endMs": "1665777003823", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2077", "recordsWritten": "100", "shuffleOutputBytes": "19977", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665777003778", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.01507537688442211, "waitRatioMax": 0.01507537688442211, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.020100502512562814, "writeRatioMax": 0.020100502512562814 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "205", "elapsedMs": "472", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "6315" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50036771", "totalPartitionsProcessed": "0", "totalSlotMs": "6315", "transferredBytes": "0" }, "startTime": "1665777003386", "totalBytesProcessed": "50036771", "totalSlotMs": "6315" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
