{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond824f5c6_c6f3_40ea_ae2b_0c7dd70f5296" }, "priority": "INTERACTIVE", "query": "-- start query 75 in stream 0 using template query75.tpl\n\n/*\nFor two consecutive years track the sales of items by brand, class and category.\n*/\n\nWITH all_sales AS (\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,SUM(sales_cnt) AS sales_cnt\n ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n JOIN date_dim ON d_date_sk=cs_sold_date_sk\n LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n AND cs_item_sk=cr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n JOIN date_dim ON d_date_sk=ss_sold_date_sk\n LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n AND ss_item_sk=sr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n JOIN date_dim ON d_date_sk=ws_sold_date_sk\n LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n AND ws_item_sk=wr_item_sk)\n WHERE i_category='Books') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT prev_yr.d_year AS prev_year\n ,curr_yr.d_year AS year\n ,curr_yr.i_brand_id\n ,curr_yr.i_class_id\n ,curr_yr.i_category_id\n ,curr_yr.i_manufact_id\n ,prev_yr.sales_cnt AS prev_yr_cnt\n ,curr_yr.sales_cnt AS curr_yr_cnt\n ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n AND curr_yr.i_class_id=prev_yr.i_class_id\n AND curr_yr.i_category_id=prev_yr.i_category_id\n AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n AND curr_yr.d_year=2002\n AND prev_yr.d_year=2002-1\n AND (curr_yr.sales_cnt)/(prev_yr.sales_cnt)<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n LIMIT 100\n ;\n\n-- end query 75 in stream 0 using template query75.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "T3uL5mLc4OCfb3dnPwod/w==", "id": "test-project-364309:europe-west1.query75_1665768464", "jobReference": { "jobId": "query75_1665768464", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query75_1665768464?location=europe-west1", "statistics": { "creationTime": "1665768465164", "endTime": "1665768466653", "finalExecutionDurationMs": "1166", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "259359179", "performanceInsights": { "avgPreviousExecutionMs": "1139" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "97", "computeMsMax": "97", "computeRatioAvg": 0.14456035767511177, "computeRatioMax": 0.14456035767511177, "endMs": "1665768465506", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.020864381520119227, "readRatioMax": 0.020864381520119227, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "117", "startMs": "1665768465410", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.014903129657228018, "writeRatioMax": 0.014903129657228018 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.019374068554396422, "computeRatioMax": 0.019374068554396422, "endMs": "1665768465461", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010432190760059613, "readRatioMax": 0.010432190760059613, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768465424", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.011922503725782414, "writeRatioMax": 0.011922503725782414 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.019374068554396422, "computeRatioMax": 0.019374068554396422, "endMs": "1665768465487", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007451564828614009, "readRatioMax": 0.007451564828614009, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768465443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category", "FROM item", "WHERE equal($234, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $235", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.02533532041728763, "writeRatioMax": 0.02533532041728763 }, { "completedParallelInputs": "1", "computeMsAvg": "446", "computeMsMax": "446", "computeRatioAvg": 0.6646795827123696, "computeRatioMax": 0.6646795827123696, "endMs": "1665768465769", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.02533532041728763, "readRatioMax": 0.02533532041728763, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "312", "startMs": "1665768465468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.022354694485842028, "writeRatioMax": 0.022354694485842028 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01639344262295082, "computeRatioMax": 0.01639344262295082, "endMs": "1665768465510", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010432190760059613, "readRatioMax": 0.010432190760059613, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665768465483", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year", "FROM date_dim", "WHERE equal($151, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.01788375558867362, "writeRatioMax": 0.01788375558867362 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.022354694485842028, "computeRatioMax": 0.022354694485842028, "endMs": "1665768465532", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00894187779433681, "readRatioMax": 0.00894187779433681, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768465498", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category", "FROM item", "WHERE equal($224, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $225", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.010432190760059613, "writeRatioMax": 0.010432190760059613 }, { "completedParallelInputs": "1", "computeMsAvg": "167", "computeMsMax": "167", "computeRatioAvg": 0.2488822652757079, "computeRatioMax": 0.2488822652757079, "endMs": "1665768465652", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.019374068554396422, "readRatioMax": 0.019374068554396422, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "165", "startMs": "1665768465523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01639344262295082, "writeRatioMax": 0.01639344262295082 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.020864381520119227, "computeRatioMax": 0.020864381520119227, "endMs": "1665768465579", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010432190760059613, "readRatioMax": 0.010432190760059613, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768465540", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_year", "FROM date_dim", "WHERE equal($131, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.01788375558867362, "writeRatioMax": 0.01788375558867362 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.02533532041728763, "computeRatioMax": 0.02533532041728763, "endMs": "1665768465605", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007451564828614009, "readRatioMax": 0.007451564828614009, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665768465560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category", "FROM item", "WHERE equal($214, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $215", "TO __stage0A_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.00894187779433681, "waitRatioMax": 0.00894187779433681, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.026825633383010434, "writeRatioMax": 0.026825633383010434 }, { "completedParallelInputs": "1", "computeMsAvg": "117", "computeMsMax": "117", "computeRatioAvg": 0.17436661698956782, "computeRatioMax": 0.17436661698956782, "endMs": "1665768465689", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.014903129657228018, "readRatioMax": 0.014903129657228018, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "130", "startMs": "1665768465581", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.014903129657228018, "writeRatioMax": 0.014903129657228018 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.019374068554396422, "computeRatioMax": 0.019374068554396422, "endMs": "1665768465628", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.01788375558867362, "readRatioMax": 0.01788375558867362, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768465595", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01639344262295082, "writeRatioMax": 0.01639344262295082 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.020864381520119227, "computeRatioMax": 0.020864381520119227, "endMs": "1665768465639", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010432190760059613, "readRatioMax": 0.010432190760059613, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768465609", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category", "FROM item", "WHERE equal($204, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $205", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.019374068554396422, "writeRatioMax": 0.019374068554396422 }, { "completedParallelInputs": "1", "computeMsAvg": "418", "computeMsMax": "418", "computeRatioAvg": 0.6229508196721312, "computeRatioMax": 0.6229508196721312, "endMs": "1665768465940", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.022354694485842028, "readRatioMax": 0.022354694485842028, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "391", "startMs": "1665768465639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.020864381520119227, "writeRatioMax": 0.020864381520119227 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.022354694485842028, "computeRatioMax": 0.022354694485842028, "endMs": "1665768465731", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00894187779433681, "readRatioMax": 0.00894187779433681, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665768465654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02384500745156483, "writeRatioMax": 0.02384500745156483 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.01788375558867362, "computeRatioMax": 0.01788375558867362, "endMs": "1665768465727", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007451564828614009, "readRatioMax": 0.007451564828614009, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665768465667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category", "FROM item", "WHERE equal($194, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $195", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "46", "writeMsMax": "46", "writeRatioAvg": 0.06855439642324888, "writeRatioMax": 0.06855439642324888 }, { "completedParallelInputs": "1", "computeMsAvg": "138", "computeMsMax": "138", "computeRatioAvg": 0.20566318926974664, "computeRatioMax": 0.20566318926974664, "endMs": "1665768465836", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.014903129657228018, "readRatioMax": 0.014903129657228018, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665768465695", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.028315946348733235, "writeRatioMax": 0.028315946348733235 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01639344262295082, "computeRatioMax": 0.01639344262295082, "endMs": "1665768465745", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010432190760059613, "readRatioMax": 0.010432190760059613, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768465709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year", "FROM date_dim", "WHERE equal($71, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.01788375558867362, "writeRatioMax": 0.01788375558867362 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.019374068554396422, "computeRatioMax": 0.019374068554396422, "endMs": "1665768465762", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007451564828614009, "readRatioMax": 0.007451564828614009, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768465724", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category", "FROM item", "WHERE equal($184, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $185", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.020864381520119227, "writeRatioMax": 0.020864381520119227 }, { "completedParallelInputs": "12", "computeMsAvg": "434", "computeMsMax": "671", "computeRatioAvg": 0.646795827123696, "computeRatioMax": 1, "endMs": "1665768466239", "id": "25", "inputStages": [ "2", "5", "6", "8", "1", "0", "9", "10", "4" ], "name": "S19: Join+", "parallelInputs": "12", "readMsAvg": "23", "readMsMax": "29", "readRatioAvg": 0.03427719821162444, "readRatioMax": 0.043219076005961254, "recordsRead": "7583694", "recordsWritten": "10588", "shuffleOutputBytes": "751356", "shuffleOutputBytesSpilled": "0", "slotMs": "4365", "startMs": "1665768465783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $215", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $225", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$150, $151", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $235", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304", "$280 := SUM($305)", "$281 := SUM($306)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := subtract($560, coalesce($567, 0))", "$341 := subtract($561, coalesce($568, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$560 := $552, $561 := $553, $562 := $558, $563 := $554, $564 := $555, $565 := $556, $566 := $557, $567 := $32, $568 := $33", "LEFT OUTER HASH JOIN EACH WITH ALL ON $551 = $31, $550 = $30" ] }, { "kind": "JOIN", "substeps": [ "$550 := $531, $551 := $532, $552 := $533, $553 := $534, $554 := $535, $555 := $536, $556 := $537, $557 := $538, $558 := $131", "INNER HASH JOIN EACH WITH ALL ON $530 = $130" ] }, { "kind": "JOIN", "substeps": [ "$530 := $120, $531 := $121, $532 := $122, $533 := $123, $534 := $124, $535 := $211, $536 := $212, $537 := $213, $538 := $215", "INNER HASH JOIN EACH WITH ALL ON $121 = $210" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := subtract($610, coalesce($617, 0))", "$351 := subtract($611, coalesce($618, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$610 := $602, $611 := $603, $612 := $608, $613 := $604, $614 := $605, $615 := $606, $616 := $607, $617 := $42, $618 := $43", "LEFT OUTER HASH JOIN EACH WITH ALL ON $601 = $41, $600 = $40" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $151", "INNER HASH JOIN EACH WITH ALL ON $580 = $150" ] }, { "kind": "JOIN", "substeps": [ "$580 := $140, $581 := $141, $582 := $142, $583 := $143, $584 := $144, $585 := $221, $586 := $222, $587 := $223, $588 := $225", "INNER HASH JOIN EACH WITH ALL ON $141 = $220" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := subtract($660, coalesce($667, 0))", "$361 := subtract($661, coalesce($668, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$660 := $652, $661 := $653, $662 := $658, $663 := $654, $664 := $655, $665 := $656, $666 := $657, $667 := $52, $668 := $53", "LEFT OUTER HASH JOIN EACH WITH ALL ON $651 = $51, $650 = $50" ] }, { "kind": "JOIN", "substeps": [ "$650 := $631, $651 := $632, $652 := $633, $653 := $634, $654 := $635, $655 := $636, $656 := $637, $657 := $638, $658 := $171", "INNER HASH JOIN EACH WITH ALL ON $630 = $170" ] }, { "kind": "JOIN", "substeps": [ "$630 := $160, $631 := $161, $632 := $162, $633 := $163, $634 := $164, $635 := $231, $636 := $232, $637 := $233, $638 := $235", "INNER HASH JOIN EACH WITH ALL ON $161 = $230" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "TO __stage19_output", "BY HASH($670, $671, $672, $673, $674)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "5", "writeMsMax": "10", "writeRatioAvg": 0.007451564828614009, "writeRatioMax": 0.014903129657228018 }, { "completedParallelInputs": "12", "computeMsAvg": "394", "computeMsMax": "631", "computeRatioAvg": 0.587183308494784, "computeRatioMax": 0.940387481371088, "endMs": "1665768466378", "id": "26", "inputStages": [ "18", "14", "13", "21", "16", "22", "12", "17", "20" ], "name": "S1A: Join+", "parallelInputs": "12", "readMsAvg": "25", "readMsMax": "38", "readRatioAvg": 0.037257824143070044, "readRatioMax": 0.05663189269746647, "recordsRead": "7583694", "recordsWritten": "10287", "shuffleOutputBytes": "730185", "shuffleOutputBytesSpilled": "0", "slotMs": "4777", "startMs": "1665768465956", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $185", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $195", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $205", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294", "$270 := SUM($295)", "$271 := SUM($296)" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := subtract($400, coalesce($407, 0))", "$311 := subtract($401, coalesce($408, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$400 := $392, $401 := $393, $402 := $398, $403 := $394, $404 := $395, $405 := $396, $406 := $397, $407 := $3, $408 := $4", "LEFT OUTER HASH JOIN EACH WITH ALL ON $391 = $2, $390 = $1" ] }, { "kind": "JOIN", "substeps": [ "$390 := $371, $391 := $372, $392 := $373, $393 := $374, $394 := $375, $395 := $376, $396 := $377, $397 := $378, $398 := $71", "INNER HASH JOIN EACH WITH ALL ON $370 = $70" ] }, { "kind": "JOIN", "substeps": [ "$370 := $60, $371 := $61, $372 := $62, $373 := $63, $374 := $64, $375 := $181, $376 := $182, $377 := $183, $378 := $185", "INNER HASH JOIN EACH WITH ALL ON $61 = $180" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := subtract($450, coalesce($457, 0))", "$321 := subtract($451, coalesce($458, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$450 := $442, $451 := $443, $452 := $448, $453 := $444, $454 := $445, $455 := $446, $456 := $447, $457 := $12, $458 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $441 = $11, $440 = $10" ] }, { "kind": "JOIN", "substeps": [ "$440 := $421, $441 := $422, $442 := $423, $443 := $424, $444 := $425, $445 := $426, $446 := $427, $447 := $428, $448 := $91", "INNER HASH JOIN EACH WITH ALL ON $420 = $90" ] }, { "kind": "JOIN", "substeps": [ "$420 := $80, $421 := $81, $422 := $82, $423 := $83, $424 := $84, $425 := $191, $426 := $192, $427 := $193, $428 := $195", "INNER HASH JOIN EACH WITH ALL ON $81 = $190" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := subtract($500, coalesce($507, 0))", "$331 := subtract($501, coalesce($508, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$500 := $492, $501 := $493, $502 := $498, $503 := $494, $504 := $495, $505 := $496, $506 := $497, $507 := $22, $508 := $23", "LEFT OUTER HASH JOIN EACH WITH ALL ON $491 = $21, $490 = $20" ] }, { "kind": "JOIN", "substeps": [ "$490 := $471, $491 := $472, $492 := $473, $493 := $474, $494 := $475, $495 := $476, $496 := $477, $497 := $478, $498 := $111", "INNER HASH JOIN EACH WITH ALL ON $470 = $110" ] }, { "kind": "JOIN", "substeps": [ "$470 := $100, $471 := $101, $472 := $102, $473 := $103, $474 := $104, $475 := $201, $476 := $202, $477 := $203, $478 := $205", "INNER HASH JOIN EACH WITH ALL ON $101 = $200" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "TO __stage1A_output", "BY HASH($510, $511, $512, $513, $514)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.00894187779433681, "writeRatioMax": 0.011922503725782414 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.026825633383010434, "computeRatioMax": 0.026825633383010434, "endMs": "1665768466445", "id": "27", "inputStages": [ "25" ], "name": "S1B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10588", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768466408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "FROM __stage19_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674", "$260 := SUM($280)", "$261 := SUM($281)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0014903129657228018, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.014903129657228018, "writeRatioMax": 0.014903129657228018 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.013412816691505217, "computeRatioMax": 0.03278688524590164, "endMs": "1665768466524", "id": "29", "inputStages": [ "27" ], "name": "S1D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "881", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "4301", "startMs": "1665768466457", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0014903129657228018, "waitRatioMax": 0.0029806259314456036, "writeMsAvg": "33", "writeMsMax": "56", "writeRatioAvg": 0.04918032786885246, "writeRatioMax": 0.08345752608047691 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.026825633383010434, "computeRatioMax": 0.026825633383010434, "endMs": "1665768466535", "id": "30", "inputStages": [ "29", "26" ], "name": "S1E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11168", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665768466460", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$240 ASC, $241 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := subtract($690, $697)", "$241 := subtract($691, $698)" ] }, { "kind": "FILTER", "substeps": [ "less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)" ] }, { "kind": "JOIN", "substeps": [ "$690 := $250, $691 := $251, $692 := $520, $693 := $521, $694 := $522, $695 := $523, $696 := $524, $697 := $260, $698 := $261, $699 := $680", "INNER HASH JOIN EACH WITH ALL ON $521 = $681, $522 = $682, $523 = $683, $524 = $684" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514", "$250 := SUM($270)", "$251 := SUM($271)" ] }, { "kind": "WRITE", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "TO __stage1E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0029806259314456036, "waitRatioMax": 0.0029806259314456036, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.005961251862891207, "writeRatioMax": 0.005961251862891207 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.010432190760059613, "computeRatioMax": 0.010432190760059613, "endMs": "1665768466545", "id": "31", "inputStages": [ "30" ], "name": "S1F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665768466486", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "FROM __stage1E_output" ] }, { "kind": "SORT", "substeps": [ "$700 ASC, $701 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719", "TO __stage1F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0029806259314456036, "waitRatioMax": 0.0029806259314456036, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.005961251862891207, "writeRatioMax": 0.005961251862891207 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "13", "completedUnits": "17", "elapsedMs": "682", "estimatedRunnableUnits": "0", "pendingUnits": "13", "totalSlotMs": "2540" }, { "activeUnits": "2", "completedUnits": "145", "elapsedMs": "1361", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15993" } ], "totalBytesBilled": "260046848", "totalBytesProcessed": "259359179", "totalPartitionsProcessed": "0", "totalSlotMs": "15993", "transferredBytes": "0" }, "startTime": "1665768465230", "totalBytesProcessed": "259359179", "totalSlotMs": "15993" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb2066956_40d9_4049_9fc7_9c1816da6594" }, "priority": "INTERACTIVE", "query": "-- start query 75 in stream 0 using template query75.tpl\n\n/*\nFor two consecutive years track the sales of items by brand, class and category.\n*/\n\nWITH all_sales AS (\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,SUM(sales_cnt) AS sales_cnt\n ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n JOIN date_dim ON d_date_sk=cs_sold_date_sk\n LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n AND cs_item_sk=cr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n JOIN date_dim ON d_date_sk=ss_sold_date_sk\n LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n AND ss_item_sk=sr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n JOIN date_dim ON d_date_sk=ws_sold_date_sk\n LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n AND ws_item_sk=wr_item_sk)\n WHERE i_category='Books') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT prev_yr.d_year AS prev_year\n ,curr_yr.d_year AS year\n ,curr_yr.i_brand_id\n ,curr_yr.i_class_id\n ,curr_yr.i_category_id\n ,curr_yr.i_manufact_id\n ,prev_yr.sales_cnt AS prev_yr_cnt\n ,curr_yr.sales_cnt AS curr_yr_cnt\n ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n AND curr_yr.i_class_id=prev_yr.i_class_id\n AND curr_yr.i_category_id=prev_yr.i_category_id\n AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n AND curr_yr.d_year=2002\n AND prev_yr.d_year=2002-1\n AND (curr_yr.sales_cnt)/(prev_yr.sales_cnt)<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n LIMIT 100\n ;\n\n-- end query 75 in stream 0 using template query75.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "JRN09ruPRvxt6tKCYw098A==", "id": "test-project-364309:europe-west1.query75_1665778548", "jobReference": { "jobId": "query75_1665778548", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query75_1665778548?location=europe-west1", "statistics": { "creationTime": "1665778549476", "endTime": "1665778550904", "finalExecutionDurationMs": "1102", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "259359179", "performanceInsights": { "avgPreviousExecutionMs": "1145" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "116", "computeMsMax": "116", "computeRatioAvg": 0.17261904761904762, "computeRatioMax": 0.17261904761904762, "endMs": "1665778549829", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.019345238095238096, "readRatioMax": 0.019345238095238096, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "127", "startMs": "1665778549726", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01636904761904762, "writeRatioMax": 0.01636904761904762 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01488095238095238, "computeRatioMax": 0.01488095238095238, "endMs": "1665778549784", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.01636904761904762, "readRatioMax": 0.01636904761904762, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778549745", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.011904761904761904, "writeRatioMax": 0.011904761904761904 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.022321428571428572, "computeRatioMax": 0.022321428571428572, "endMs": "1665778549811", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010416666666666666, "readRatioMax": 0.010416666666666666, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778549765", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category", "FROM item", "WHERE equal($234, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $235", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.023809523809523808 }, { "completedParallelInputs": "1", "computeMsAvg": "229", "computeMsMax": "229", "computeRatioAvg": 0.34077380952380953, "computeRatioMax": 0.34077380952380953, "endMs": "1665778549998", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.023809523809523808, "readRatioMax": 0.023809523809523808, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "248", "startMs": "1665778549803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.019345238095238096, "writeRatioMax": 0.019345238095238096 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01636904761904762, "computeRatioMax": 0.01636904761904762, "endMs": "1665778549868", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01488095238095238, "readRatioMax": 0.01488095238095238, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778549822", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year", "FROM date_dim", "WHERE equal($151, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.022321428571428572, "writeRatioMax": 0.022321428571428572 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.019345238095238096, "computeRatioMax": 0.019345238095238096, "endMs": "1665778549879", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008928571428571428, "readRatioMax": 0.008928571428571428, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778549840", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category", "FROM item", "WHERE equal($224, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $225", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.019345238095238096, "writeRatioMax": 0.019345238095238096 }, { "completedParallelInputs": "1", "computeMsAvg": "141", "computeMsMax": "141", "computeRatioAvg": 0.20982142857142858, "computeRatioMax": 0.20982142857142858, "endMs": "1665778550015", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.020833333333333332, "readRatioMax": 0.020833333333333332, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "180", "startMs": "1665778549875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001488095238095238, "waitRatioMax": 0.001488095238095238, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.023809523809523808 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.013392857142857142, "computeRatioMax": 0.013392857142857142, "endMs": "1665778549937", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008928571428571428, "readRatioMax": 0.008928571428571428, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778549897", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_year", "FROM date_dim", "WHERE equal($131, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001488095238095238, "waitRatioMax": 0.001488095238095238, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.020833333333333332, "writeRatioMax": 0.020833333333333332 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.022321428571428572, "computeRatioMax": 0.022321428571428572, "endMs": "1665778549966", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008928571428571428, "readRatioMax": 0.008928571428571428, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778549916", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category", "FROM item", "WHERE equal($214, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $215", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004464285714285714, "waitRatioMax": 0.004464285714285714, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.028273809523809524, "writeRatioMax": 0.028273809523809524 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.07589285714285714, "computeRatioMax": 0.07589285714285714, "endMs": "1665778550003", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010416666666666666, "readRatioMax": 0.010416666666666666, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665778549950", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.010416666666666666, "writeRatioMax": 0.010416666666666666 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.019345238095238096, "computeRatioMax": 0.019345238095238096, "endMs": "1665778550025", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011904761904761904, "readRatioMax": 0.011904761904761904, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778549980", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.01636904761904762, "waitRatioMax": 0.01636904761904762, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.020833333333333332, "writeRatioMax": 0.020833333333333332 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.017857142857142856, "endMs": "1665778550025", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005952380952380952, "readRatioMax": 0.005952380952380952, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778549988", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category", "FROM item", "WHERE equal($204, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $205", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.03720238095238095, "writeRatioMax": 0.03720238095238095 }, { "completedParallelInputs": "1", "computeMsAvg": "185", "computeMsMax": "185", "computeRatioAvg": 0.27529761904761907, "computeRatioMax": 0.27529761904761907, "endMs": "1665778550191", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.01636904761904762, "readRatioMax": 0.01636904761904762, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "224", "startMs": "1665778550029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.022321428571428572, "writeRatioMax": 0.022321428571428572 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.013392857142857142, "computeRatioMax": 0.013392857142857142, "endMs": "1665778550089", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008928571428571428, "readRatioMax": 0.008928571428571428, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778550050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004464285714285714, "waitRatioMax": 0.004464285714285714, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.019345238095238096, "writeRatioMax": 0.019345238095238096 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.017857142857142856, "endMs": "1665778550111", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008928571428571428, "readRatioMax": 0.008928571428571428, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778550071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category", "FROM item", "WHERE equal($194, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $195", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.020833333333333332, "writeRatioMax": 0.020833333333333332 }, { "completedParallelInputs": "1", "computeMsAvg": "127", "computeMsMax": "127", "computeRatioAvg": 0.18898809523809523, "computeRatioMax": 0.18898809523809523, "endMs": "1665778550226", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.020833333333333332, "readRatioMax": 0.020833333333333332, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "192", "startMs": "1665778550100", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage14_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.023809523809523808 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.013392857142857142, "computeRatioMax": 0.013392857142857142, "endMs": "1665778550169", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01488095238095238, "readRatioMax": 0.01488095238095238, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778550121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year", "FROM date_dim", "WHERE equal($71, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.028273809523809524, "writeRatioMax": 0.028273809523809524 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017857142857142856, "computeRatioMax": 0.017857142857142856, "endMs": "1665778550185", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011904761904761904, "readRatioMax": 0.011904761904761904, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778550147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category", "FROM item", "WHERE equal($184, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $185", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001488095238095238, "waitRatioMax": 0.001488095238095238, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.028273809523809524, "writeRatioMax": 0.028273809523809524 }, { "completedParallelInputs": "12", "computeMsAvg": "361", "computeMsMax": "583", "computeRatioAvg": 0.5372023809523809, "computeRatioMax": 0.8675595238095238, "endMs": "1665778550580", "id": "24", "inputStages": [ "8", "6", "5", "0", "4", "2", "1", "9", "10" ], "name": "S18: Join+", "parallelInputs": "12", "readMsAvg": "21", "readMsMax": "28", "readRatioAvg": 0.03125, "readRatioMax": 0.041666666666666664, "recordsRead": "7583694", "recordsWritten": "10588", "shuffleOutputBytes": "751356", "shuffleOutputBytesSpilled": "0", "slotMs": "4476", "startMs": "1665778550182", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $215", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $225", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$150, $151", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $235", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304", "$280 := SUM($305)", "$281 := SUM($306)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := subtract($560, coalesce($567, 0))", "$341 := subtract($561, coalesce($568, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$560 := $552, $561 := $553, $562 := $558, $563 := $554, $564 := $555, $565 := $556, $566 := $557, $567 := $32, $568 := $33", "LEFT OUTER HASH JOIN EACH WITH ALL ON $551 = $31, $550 = $30" ] }, { "kind": "JOIN", "substeps": [ "$550 := $531, $551 := $532, $552 := $533, $553 := $534, $554 := $535, $555 := $536, $556 := $537, $557 := $538, $558 := $131", "INNER HASH JOIN EACH WITH ALL ON $530 = $130" ] }, { "kind": "JOIN", "substeps": [ "$530 := $120, $531 := $121, $532 := $122, $533 := $123, $534 := $124, $535 := $211, $536 := $212, $537 := $213, $538 := $215", "INNER HASH JOIN EACH WITH ALL ON $121 = $210" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := subtract($610, coalesce($617, 0))", "$351 := subtract($611, coalesce($618, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$610 := $602, $611 := $603, $612 := $608, $613 := $604, $614 := $605, $615 := $606, $616 := $607, $617 := $42, $618 := $43", "LEFT OUTER HASH JOIN EACH WITH ALL ON $601 = $41, $600 = $40" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $151", "INNER HASH JOIN EACH WITH ALL ON $580 = $150" ] }, { "kind": "JOIN", "substeps": [ "$580 := $140, $581 := $141, $582 := $142, $583 := $143, $584 := $144, $585 := $221, $586 := $222, $587 := $223, $588 := $225", "INNER HASH JOIN EACH WITH ALL ON $141 = $220" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := subtract($660, coalesce($667, 0))", "$361 := subtract($661, coalesce($668, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$660 := $652, $661 := $653, $662 := $658, $663 := $654, $664 := $655, $665 := $656, $666 := $657, $667 := $52, $668 := $53", "LEFT OUTER HASH JOIN EACH WITH ALL ON $651 = $51, $650 = $50" ] }, { "kind": "JOIN", "substeps": [ "$650 := $631, $651 := $632, $652 := $633, $653 := $634, $654 := $635, $655 := $636, $656 := $637, $657 := $638, $658 := $171", "INNER HASH JOIN EACH WITH ALL ON $630 = $170" ] }, { "kind": "JOIN", "substeps": [ "$630 := $160, $631 := $161, $632 := $162, $633 := $163, $634 := $164, $635 := $231, $636 := $232, $637 := $233, $638 := $235", "INNER HASH JOIN EACH WITH ALL ON $161 = $230" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "TO __stage18_output", "BY HASH($670, $671, $672, $673, $674)" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.004464285714285714, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.00744047619047619, "writeRatioMax": 0.008928571428571428 }, { "completedParallelInputs": "12", "computeMsAvg": "340", "computeMsMax": "672", "computeRatioAvg": 0.5059523809523809, "computeRatioMax": 1, "endMs": "1665778550618", "id": "25", "inputStages": [ "18", "20", "12", "17", "21", "14", "22", "16", "13" ], "name": "S19: Join+", "parallelInputs": "12", "readMsAvg": "18", "readMsMax": "23", "readRatioAvg": 0.026785714285714284, "readRatioMax": 0.03422619047619048, "recordsRead": "7583694", "recordsWritten": "10287", "shuffleOutputBytes": "730185", "shuffleOutputBytesSpilled": "0", "slotMs": "4232", "startMs": "1665778550253", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $185", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $195", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $205", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294", "$270 := SUM($295)", "$271 := SUM($296)" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := subtract($400, coalesce($407, 0))", "$311 := subtract($401, coalesce($408, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$400 := $392, $401 := $393, $402 := $398, $403 := $394, $404 := $395, $405 := $396, $406 := $397, $407 := $3, $408 := $4", "LEFT OUTER HASH JOIN EACH WITH ALL ON $391 = $2, $390 = $1" ] }, { "kind": "JOIN", "substeps": [ "$390 := $371, $391 := $372, $392 := $373, $393 := $374, $394 := $375, $395 := $376, $396 := $377, $397 := $378, $398 := $71", "INNER HASH JOIN EACH WITH ALL ON $370 = $70" ] }, { "kind": "JOIN", "substeps": [ "$370 := $60, $371 := $61, $372 := $62, $373 := $63, $374 := $64, $375 := $181, $376 := $182, $377 := $183, $378 := $185", "INNER HASH JOIN EACH WITH ALL ON $61 = $180" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := subtract($450, coalesce($457, 0))", "$321 := subtract($451, coalesce($458, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$450 := $442, $451 := $443, $452 := $448, $453 := $444, $454 := $445, $455 := $446, $456 := $447, $457 := $12, $458 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $441 = $11, $440 = $10" ] }, { "kind": "JOIN", "substeps": [ "$440 := $421, $441 := $422, $442 := $423, $443 := $424, $444 := $425, $445 := $426, $446 := $427, $447 := $428, $448 := $91", "INNER HASH JOIN EACH WITH ALL ON $420 = $90" ] }, { "kind": "JOIN", "substeps": [ "$420 := $80, $421 := $81, $422 := $82, $423 := $83, $424 := $84, $425 := $191, $426 := $192, $427 := $193, $428 := $195", "INNER HASH JOIN EACH WITH ALL ON $81 = $190" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := subtract($500, coalesce($507, 0))", "$331 := subtract($501, coalesce($508, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$500 := $492, $501 := $493, $502 := $498, $503 := $494, $504 := $495, $505 := $496, $506 := $497, $507 := $22, $508 := $23", "LEFT OUTER HASH JOIN EACH WITH ALL ON $491 = $21, $490 = $20" ] }, { "kind": "JOIN", "substeps": [ "$490 := $471, $491 := $472, $492 := $473, $493 := $474, $494 := $475, $495 := $476, $496 := $477, $497 := $478, $498 := $111", "INNER HASH JOIN EACH WITH ALL ON $470 = $110" ] }, { "kind": "JOIN", "substeps": [ "$470 := $100, $471 := $101, $472 := $102, $473 := $103, $474 := $104, $475 := $201, $476 := $202, $477 := $203, $478 := $205", "INNER HASH JOIN EACH WITH ALL ON $101 = $200" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "TO __stage19_output", "BY HASH($510, $511, $512, $513, $514)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.004464285714285714, "writeMsAvg": "5", "writeMsMax": "10", "writeRatioAvg": 0.00744047619047619, "writeRatioMax": 0.01488095238095238 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01636904761904762, "computeRatioMax": 0.01636904761904762, "endMs": "1665778550684", "id": "26", "inputStages": [ "24" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10588", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778550648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674", "$260 := SUM($280)", "$261 := SUM($281)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "TO __stage1A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004464285714285714, "waitRatioMax": 0.004464285714285714, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.011904761904761904, "computeRatioMax": 0.022321428571428572, "endMs": "1665778550765", "id": "28", "inputStages": [ "26" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "881", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "4097", "startMs": "1665778550702", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004464285714285714, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "19", "writeMsMax": "30", "writeRatioAvg": 0.028273809523809524, "writeRatioMax": 0.044642857142857144 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.028273809523809524, "computeRatioMax": 0.028273809523809524, "endMs": "1665778550772", "id": "29", "inputStages": [ "28", "25" ], "name": "S1D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11168", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665778550709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "FROM __stage1C_output" ] }, { "kind": "SORT", "substeps": [ "$240 ASC, $241 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := subtract($690, $697)", "$241 := subtract($691, $698)" ] }, { "kind": "FILTER", "substeps": [ "less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)" ] }, { "kind": "JOIN", "substeps": [ "$690 := $250, $691 := $251, $692 := $520, $693 := $521, $694 := $522, $695 := $523, $696 := $524, $697 := $260, $698 := $261, $699 := $680", "INNER HASH JOIN EACH WITH ALL ON $521 = $681, $522 = $682, $523 = $683, $524 = $684" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514", "$250 := SUM($270)", "$251 := SUM($271)" ] }, { "kind": "WRITE", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "TO __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.005952380952380952, "writeRatioMax": 0.005952380952380952 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01488095238095238, "computeRatioMax": 0.01488095238095238, "endMs": "1665778550777", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665778550721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$700 ASC, $701 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719", "TO __stage1E_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.00744047619047619, "waitRatioMax": 0.00744047619047619, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.00744047619047619, "writeRatioMax": 0.00744047619047619 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "12", "completedUnits": "18", "elapsedMs": "674", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "5250" }, { "activeUnits": "21", "completedUnits": "145", "elapsedMs": "1302", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "18104" } ], "totalBytesBilled": "260046848", "totalBytesProcessed": "259359179", "totalPartitionsProcessed": "0", "totalSlotMs": "18104", "transferredBytes": "0" }, "startTime": "1665778549556", "totalBytesProcessed": "259359179", "totalSlotMs": "18104" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0611a807_b84f_4a74_ae10_b32f69153574" }, "priority": "INTERACTIVE", "query": "-- start query 75 in stream 0 using template query75.tpl\n\n/*\nFor two consecutive years track the sales of items by brand, class and category.\n*/\n\nWITH all_sales AS (\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,SUM(sales_cnt) AS sales_cnt\n ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n JOIN date_dim ON d_date_sk=cs_sold_date_sk\n LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n AND cs_item_sk=cr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n JOIN date_dim ON d_date_sk=ss_sold_date_sk\n LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n AND ss_item_sk=sr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n JOIN date_dim ON d_date_sk=ws_sold_date_sk\n LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n AND ws_item_sk=wr_item_sk)\n WHERE i_category='Books') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT prev_yr.d_year AS prev_year\n ,curr_yr.d_year AS year\n ,curr_yr.i_brand_id\n ,curr_yr.i_class_id\n ,curr_yr.i_category_id\n ,curr_yr.i_manufact_id\n ,prev_yr.sales_cnt AS prev_yr_cnt\n ,curr_yr.sales_cnt AS curr_yr_cnt\n ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n AND curr_yr.i_class_id=prev_yr.i_class_id\n AND curr_yr.i_category_id=prev_yr.i_category_id\n AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n AND curr_yr.d_year=2002\n AND prev_yr.d_year=2002-1\n AND (curr_yr.sales_cnt)/(prev_yr.sales_cnt)<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n LIMIT 100\n ;\n\n-- end query 75 in stream 0 using template query75.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/tAom7spM9Xqr+XlfwO/ZQ==", "id": "test-project-364309:europe-west1.query75_1665778552", "jobReference": { "jobId": "query75_1665778552", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query75_1665778552?location=europe-west1", "statistics": { "creationTime": "1665778553516", "endTime": "1665778554883", "finalExecutionDurationMs": "1069", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "259359179", "performanceInsights": { "avgPreviousExecutionMs": "1137" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "82", "computeMsMax": "82", "computeRatioAvg": 0.10211706102117062, "computeRatioMax": 0.10211706102117062, "endMs": "1665778553817", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.014943960149439602, "readRatioMax": 0.014943960149439602, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "112", "startMs": "1665778553730", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0136986301369863, "writeRatioMax": 0.0136986301369863 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0161892901618929, "computeRatioMax": 0.0161892901618929, "endMs": "1665778553789", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008717310087173101, "readRatioMax": 0.008717310087173101, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778553746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0186799501867995, "writeRatioMax": 0.0186799501867995 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0186799501867995, "computeRatioMax": 0.0186799501867995, "endMs": "1665778553805", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009962640099626401, "readRatioMax": 0.009962640099626401, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778553764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category", "FROM item", "WHERE equal($234, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $235", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.012453300124533, "writeRatioMax": 0.012453300124533 }, { "completedParallelInputs": "1", "computeMsAvg": "328", "computeMsMax": "328", "computeRatioAvg": 0.40846824408468246, "computeRatioMax": 0.40846824408468246, "endMs": "1665778554080", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.021170610211706103, "readRatioMax": 0.021170610211706103, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "372", "startMs": "1665778553806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage04_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.0161892901618929, "waitRatioMax": 0.0161892901618929, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0224159402241594, "writeRatioMax": 0.0224159402241594 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0112079701120797, "computeRatioMax": 0.0112079701120797, "endMs": "1665778553858", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007471980074719801, "readRatioMax": 0.007471980074719801, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778553817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year", "FROM date_dim", "WHERE equal($151, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151", "TO __stage05_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.008717310087173101, "waitRatioMax": 0.008717310087173101, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0186799501867995, "writeRatioMax": 0.0186799501867995 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009962640099626401, "computeRatioMax": 0.009962640099626401, "endMs": "1665778553858", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0062266500622665, "readRatioMax": 0.0062266500622665, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778553827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category", "FROM item", "WHERE equal($224, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $225", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.021170610211706103, "writeRatioMax": 0.021170610211706103 }, { "completedParallelInputs": "1", "computeMsAvg": "128", "computeMsMax": "128", "computeRatioAvg": 0.15940224159402241, "computeRatioMax": 0.15940224159402241, "endMs": "1665778553995", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.012453300124533, "readRatioMax": 0.012453300124533, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "163", "startMs": "1665778553861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0161892901618929, "writeRatioMax": 0.0161892901618929 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0136986301369863, "computeRatioMax": 0.0136986301369863, "endMs": "1665778553915", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009962640099626401, "readRatioMax": 0.009962640099626401, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778553877", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_year", "FROM date_dim", "WHERE equal($131, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.009962640099626401, "writeRatioMax": 0.009962640099626401 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0161892901618929, "computeRatioMax": 0.0161892901618929, "endMs": "1665778553931", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007471980074719801, "readRatioMax": 0.007471980074719801, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778553891", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category", "FROM item", "WHERE equal($214, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $215", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.012453300124533, "writeRatioMax": 0.012453300124533 }, { "completedParallelInputs": "1", "computeMsAvg": "61", "computeMsMax": "61", "computeRatioAvg": 0.0759651307596513, "computeRatioMax": 0.0759651307596513, "endMs": "1665778554009", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0112079701120797, "readRatioMax": 0.0112079701120797, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "93", "startMs": "1665778553925", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0161892901618929, "writeRatioMax": 0.0161892901618929 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012453300124533, "computeRatioMax": 0.012453300124533, "endMs": "1665778553977", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009962640099626401, "readRatioMax": 0.009962640099626401, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778553940", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.012453300124533, "writeRatioMax": 0.012453300124533 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.014943960149439602, "computeRatioMax": 0.014943960149439602, "endMs": "1665778553998", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007471980074719801, "readRatioMax": 0.007471980074719801, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778553957", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category", "FROM item", "WHERE equal($204, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $205", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0186799501867995, "writeRatioMax": 0.0186799501867995 }, { "completedParallelInputs": "1", "computeMsAvg": "232", "computeMsMax": "232", "computeRatioAvg": 0.2889165628891656, "computeRatioMax": 0.2889165628891656, "endMs": "1665778554190", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.019925280199252802, "readRatioMax": 0.019925280199252802, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "211", "startMs": "1665778553989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0186799501867995, "writeRatioMax": 0.0186799501867995 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012453300124533, "computeRatioMax": 0.012453300124533, "endMs": "1665778554047", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008717310087173101, "readRatioMax": 0.008717310087173101, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778554005", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0186799501867995, "writeRatioMax": 0.0186799501867995 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.014943960149439602, "computeRatioMax": 0.014943960149439602, "endMs": "1665778554052", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0062266500622665, "readRatioMax": 0.0062266500622665, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778554020", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category", "FROM item", "WHERE equal($194, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $195", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.019925280199252802, "writeRatioMax": 0.019925280199252802 }, { "completedParallelInputs": "1", "computeMsAvg": "174", "computeMsMax": "174", "computeRatioAvg": 0.21668742216687423, "computeRatioMax": 0.21668742216687423, "endMs": "1665778554185", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0136986301369863, "readRatioMax": 0.0136986301369863, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "194", "startMs": "1665778554050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.014943960149439602, "writeRatioMax": 0.014943960149439602 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0112079701120797, "computeRatioMax": 0.0112079701120797, "endMs": "1665778554103", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009962640099626401, "readRatioMax": 0.009962640099626401, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778554068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year", "FROM date_dim", "WHERE equal($71, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.024906600249066, "writeRatioMax": 0.024906600249066 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0186799501867995, "computeRatioMax": 0.0186799501867995, "endMs": "1665778554123", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009962640099626401, "readRatioMax": 0.009962640099626401, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778554087", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category", "FROM item", "WHERE equal($184, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $185", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.009962640099626401, "writeRatioMax": 0.009962640099626401 }, { "completedParallelInputs": "12", "computeMsAvg": "397", "computeMsMax": "803", "computeRatioAvg": 0.4943960149439601, "computeRatioMax": 1, "endMs": "1665778554565", "id": "24", "inputStages": [ "2", "5", "1", "4", "8", "6", "9", "10", "0" ], "name": "S18: Join+", "parallelInputs": "12", "readMsAvg": "19", "readMsMax": "28", "readRatioAvg": 0.023661270236612703, "readRatioMax": 0.034869240348692404, "recordsRead": "7583694", "recordsWritten": "10588", "shuffleOutputBytes": "751356", "shuffleOutputBytesSpilled": "0", "slotMs": "4867", "startMs": "1665778554136", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $215", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $225", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$150, $151", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $235", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304", "$280 := SUM($305)", "$281 := SUM($306)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := subtract($560, coalesce($567, 0))", "$341 := subtract($561, coalesce($568, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$560 := $552, $561 := $553, $562 := $558, $563 := $554, $564 := $555, $565 := $556, $566 := $557, $567 := $32, $568 := $33", "LEFT OUTER HASH JOIN EACH WITH ALL ON $551 = $31, $550 = $30" ] }, { "kind": "JOIN", "substeps": [ "$550 := $531, $551 := $532, $552 := $533, $553 := $534, $554 := $535, $555 := $536, $556 := $537, $557 := $538, $558 := $131", "INNER HASH JOIN EACH WITH ALL ON $530 = $130" ] }, { "kind": "JOIN", "substeps": [ "$530 := $120, $531 := $121, $532 := $122, $533 := $123, $534 := $124, $535 := $211, $536 := $212, $537 := $213, $538 := $215", "INNER HASH JOIN EACH WITH ALL ON $121 = $210" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := subtract($610, coalesce($617, 0))", "$351 := subtract($611, coalesce($618, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$610 := $602, $611 := $603, $612 := $608, $613 := $604, $614 := $605, $615 := $606, $616 := $607, $617 := $42, $618 := $43", "LEFT OUTER HASH JOIN EACH WITH ALL ON $601 = $41, $600 = $40" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $151", "INNER HASH JOIN EACH WITH ALL ON $580 = $150" ] }, { "kind": "JOIN", "substeps": [ "$580 := $140, $581 := $141, $582 := $142, $583 := $143, $584 := $144, $585 := $221, $586 := $222, $587 := $223, $588 := $225", "INNER HASH JOIN EACH WITH ALL ON $141 = $220" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := subtract($660, coalesce($667, 0))", "$361 := subtract($661, coalesce($668, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$660 := $652, $661 := $653, $662 := $658, $663 := $654, $664 := $655, $665 := $656, $666 := $657, $667 := $52, $668 := $53", "LEFT OUTER HASH JOIN EACH WITH ALL ON $651 = $51, $650 = $50" ] }, { "kind": "JOIN", "substeps": [ "$650 := $631, $651 := $632, $652 := $633, $653 := $634, $654 := $635, $655 := $636, $656 := $637, $657 := $638, $658 := $171", "INNER HASH JOIN EACH WITH ALL ON $630 = $170" ] }, { "kind": "JOIN", "substeps": [ "$630 := $160, $631 := $161, $632 := $162, $633 := $163, $634 := $164, $635 := $231, $636 := $232, $637 := $233, $638 := $235", "INNER HASH JOIN EACH WITH ALL ON $161 = $230" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "TO __stage18_output", "BY HASH($670, $671, $672, $673, $674)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.0062266500622665, "writeRatioMax": 0.008717310087173101 }, { "completedParallelInputs": "12", "computeMsAvg": "315", "computeMsMax": "445", "computeRatioAvg": 0.39227895392278955, "computeRatioMax": 0.5541718555417185, "endMs": "1665778554526", "id": "25", "inputStages": [ "14", "13", "17", "12", "22", "21", "16", "20", "18" ], "name": "S19: Join+", "parallelInputs": "12", "readMsAvg": "18", "readMsMax": "23", "readRatioAvg": 0.0224159402241594, "readRatioMax": 0.028642590286425903, "recordsRead": "7583694", "recordsWritten": "10287", "shuffleOutputBytes": "730185", "shuffleOutputBytesSpilled": "0", "slotMs": "3552", "startMs": "1665778554234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $185", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $195", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $205", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294", "$270 := SUM($295)", "$271 := SUM($296)" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := subtract($400, coalesce($407, 0))", "$311 := subtract($401, coalesce($408, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$400 := $392, $401 := $393, $402 := $398, $403 := $394, $404 := $395, $405 := $396, $406 := $397, $407 := $3, $408 := $4", "LEFT OUTER HASH JOIN EACH WITH ALL ON $391 = $2, $390 = $1" ] }, { "kind": "JOIN", "substeps": [ "$390 := $371, $391 := $372, $392 := $373, $393 := $374, $394 := $375, $395 := $376, $396 := $377, $397 := $378, $398 := $71", "INNER HASH JOIN EACH WITH ALL ON $370 = $70" ] }, { "kind": "JOIN", "substeps": [ "$370 := $60, $371 := $61, $372 := $62, $373 := $63, $374 := $64, $375 := $181, $376 := $182, $377 := $183, $378 := $185", "INNER HASH JOIN EACH WITH ALL ON $61 = $180" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := subtract($450, coalesce($457, 0))", "$321 := subtract($451, coalesce($458, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$450 := $442, $451 := $443, $452 := $448, $453 := $444, $454 := $445, $455 := $446, $456 := $447, $457 := $12, $458 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $441 = $11, $440 = $10" ] }, { "kind": "JOIN", "substeps": [ "$440 := $421, $441 := $422, $442 := $423, $443 := $424, $444 := $425, $445 := $426, $446 := $427, $447 := $428, $448 := $91", "INNER HASH JOIN EACH WITH ALL ON $420 = $90" ] }, { "kind": "JOIN", "substeps": [ "$420 := $80, $421 := $81, $422 := $82, $423 := $83, $424 := $84, $425 := $191, $426 := $192, $427 := $193, $428 := $195", "INNER HASH JOIN EACH WITH ALL ON $81 = $190" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := subtract($500, coalesce($507, 0))", "$331 := subtract($501, coalesce($508, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$500 := $492, $501 := $493, $502 := $498, $503 := $494, $504 := $495, $505 := $496, $506 := $497, $507 := $22, $508 := $23", "LEFT OUTER HASH JOIN EACH WITH ALL ON $491 = $21, $490 = $20" ] }, { "kind": "JOIN", "substeps": [ "$490 := $471, $491 := $472, $492 := $473, $493 := $474, $494 := $475, $495 := $476, $496 := $477, $497 := $478, $498 := $111", "INNER HASH JOIN EACH WITH ALL ON $470 = $110" ] }, { "kind": "JOIN", "substeps": [ "$470 := $100, $471 := $101, $472 := $102, $473 := $103, $474 := $104, $475 := $201, $476 := $202, $477 := $203, $478 := $205", "INNER HASH JOIN EACH WITH ALL ON $101 = $200" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "TO __stage19_output", "BY HASH($510, $511, $512, $513, $514)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0037359900373599006, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0049813200498132005, "writeRatioMax": 0.0062266500622665 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.0273972602739726, "computeRatioMax": 0.0273972602739726, "endMs": "1665778554657", "id": "26", "inputStages": [ "24" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10588", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778554619", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674", "$260 := SUM($280)", "$261 := SUM($281)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0024906600249066002, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0136986301369863, "writeRatioMax": 0.0136986301369863 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.008717310087173101, "computeRatioMax": 0.0186799501867995, "endMs": "1665778554728", "id": "28", "inputStages": [ "26" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "881", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "3494", "startMs": "1665778554670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.0049813200498132005, "waitRatioMax": 0.0062266500622665, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.0161892901618929, "writeRatioMax": 0.0224159402241594 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0136986301369863, "computeRatioMax": 0.0136986301369863, "endMs": "1665778554735", "id": "29", "inputStages": [ "28", "25" ], "name": "S1D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11168", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665778554680", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "FROM __stage1C_output" ] }, { "kind": "SORT", "substeps": [ "$240 ASC, $241 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := subtract($690, $697)", "$241 := subtract($691, $698)" ] }, { "kind": "FILTER", "substeps": [ "less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)" ] }, { "kind": "JOIN", "substeps": [ "$690 := $250, $691 := $251, $692 := $520, $693 := $521, $694 := $522, $695 := $523, $696 := $524, $697 := $260, $698 := $261, $699 := $680", "INNER HASH JOIN EACH WITH ALL ON $521 = $681, $522 = $682, $523 = $683, $524 = $684" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514", "$250 := SUM($270)", "$251 := SUM($271)" ] }, { "kind": "WRITE", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "TO __stage1D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.0062266500622665, "waitRatioMax": 0.0062266500622665, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0012453300124533001, "writeRatioMax": 0.0012453300124533001 }, { "completedParallelInputs": "1", "computeMsAvg": "3", "computeMsMax": "3", "computeRatioAvg": 0.0037359900373599006, "computeRatioMax": 0.0037359900373599006, "endMs": "1665778554742", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665778554691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$700 ASC, $701 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719", "TO __stage1E_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.0062266500622665, "waitRatioMax": 0.0062266500622665, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0049813200498132005, "writeRatioMax": 0.0049813200498132005 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "12", "completedUnits": "18", "elapsedMs": "663", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "2614" }, { "activeUnits": "2", "completedUnits": "145", "elapsedMs": "1252", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14591" } ], "totalBytesBilled": "260046848", "totalBytesProcessed": "259359179", "totalPartitionsProcessed": "0", "totalSlotMs": "14591", "transferredBytes": "0" }, "startTime": "1665778553572", "totalBytesProcessed": "259359179", "totalSlotMs": "14591" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon689d5682_45fa_4fc9_8083_ab7afe19a15d" }, "priority": "INTERACTIVE", "query": "-- start query 75 in stream 0 using template query75.tpl\n\n/*\nFor two consecutive years track the sales of items by brand, class and category.\n*/\n\nWITH all_sales AS (\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,SUM(sales_cnt) AS sales_cnt\n ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n JOIN date_dim ON d_date_sk=cs_sold_date_sk\n LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n AND cs_item_sk=cr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n JOIN date_dim ON d_date_sk=ss_sold_date_sk\n LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n AND ss_item_sk=sr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n JOIN date_dim ON d_date_sk=ws_sold_date_sk\n LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n AND ws_item_sk=wr_item_sk)\n WHERE i_category='Books') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT prev_yr.d_year AS prev_year\n ,curr_yr.d_year AS year\n ,curr_yr.i_brand_id\n ,curr_yr.i_class_id\n ,curr_yr.i_category_id\n ,curr_yr.i_manufact_id\n ,prev_yr.sales_cnt AS prev_yr_cnt\n ,curr_yr.sales_cnt AS curr_yr_cnt\n ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n AND curr_yr.i_class_id=prev_yr.i_class_id\n AND curr_yr.i_category_id=prev_yr.i_category_id\n AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n AND curr_yr.d_year=2002\n AND prev_yr.d_year=2002-1\n AND (curr_yr.sales_cnt)/(prev_yr.sales_cnt)<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n LIMIT 100\n ;\n\n-- end query 75 in stream 0 using template query75.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "9E9AL3nm74L4RpsyapH/bw==", "id": "test-project-364309:europe-west1.query75_1665778555", "jobReference": { "jobId": "query75_1665778555", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query75_1665778555?location=europe-west1", "statistics": { "creationTime": "1665778556477", "endTime": "1665778557842", "finalExecutionDurationMs": "1070", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "259359179", "performanceInsights": { "avgPreviousExecutionMs": "1125" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.09615384615384616, "computeRatioMax": 0.09615384615384616, "endMs": "1665778556752", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012237762237762238, "readRatioMax": 0.012237762237762238, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665778556689", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013986013986013986, "writeRatioMax": 0.013986013986013986 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.015734265734265736, "computeRatioMax": 0.015734265734265736, "endMs": "1665778556736", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01048951048951049, "readRatioMax": 0.01048951048951049, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778556706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.027972027972027972, "writeRatioMax": 0.027972027972027972 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.022727272727272728, "computeRatioMax": 0.022727272727272728, "endMs": "1665778556757", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.017482517482517484, "readRatioMax": 0.017482517482517484, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778556723", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category", "FROM item", "WHERE equal($234, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $235", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.026223776223776224, "writeRatioMax": 0.026223776223776224 }, { "completedParallelInputs": "1", "computeMsAvg": "224", "computeMsMax": "224", "computeRatioAvg": 0.3916083916083916, "computeRatioMax": 0.3916083916083916, "endMs": "1665778556981", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.02097902097902098, "readRatioMax": 0.02097902097902098, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "295", "startMs": "1665778556753", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.027972027972027972, "writeRatioMax": 0.027972027972027972 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.017482517482517484, "computeRatioMax": 0.017482517482517484, "endMs": "1665778556807", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01048951048951049, "readRatioMax": 0.01048951048951049, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778556769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year", "FROM date_dim", "WHERE equal($151, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.024475524475524476, "writeRatioMax": 0.024475524475524476 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.019230769230769232, "computeRatioMax": 0.019230769230769232, "endMs": "1665778556827", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.015734265734265736, "readRatioMax": 0.015734265734265736, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778556782", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category", "FROM item", "WHERE equal($224, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $225", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.024475524475524476, "writeRatioMax": 0.024475524475524476 }, { "completedParallelInputs": "1", "computeMsAvg": "162", "computeMsMax": "162", "computeRatioAvg": 0.28321678321678323, "computeRatioMax": 0.28321678321678323, "endMs": "1665778556950", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "191", "startMs": "1665778556817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.022727272727272728, "writeRatioMax": 0.022727272727272728 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.019230769230769232, "computeRatioMax": 0.019230769230769232, "endMs": "1665778556875", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01048951048951049, "readRatioMax": 0.01048951048951049, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778556836", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_year", "FROM date_dim", "WHERE equal($131, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.022727272727272728, "writeRatioMax": 0.022727272727272728 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.024475524475524476, "computeRatioMax": 0.024475524475524476, "endMs": "1665778556892", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008741258741258742, "readRatioMax": 0.008741258741258742, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778556850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category", "FROM item", "WHERE equal($214, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $215", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.024475524475524476, "writeRatioMax": 0.024475524475524476 }, { "completedParallelInputs": "1", "computeMsAvg": "62", "computeMsMax": "62", "computeRatioAvg": 0.10839160839160839, "computeRatioMax": 0.10839160839160839, "endMs": "1665778556951", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.015734265734265736, "readRatioMax": 0.015734265734265736, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "83", "startMs": "1665778556881", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.017482517482517484, "writeRatioMax": 0.017482517482517484 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.015734265734265736, "computeRatioMax": 0.015734265734265736, "endMs": "1665778556932", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01048951048951049, "readRatioMax": 0.01048951048951049, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778556898", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013986013986013986, "writeRatioMax": 0.013986013986013986 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.019230769230769232, "computeRatioMax": 0.019230769230769232, "endMs": "1665778556954", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.005244755244755245, "readRatioMax": 0.005244755244755245, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778556915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category", "FROM item", "WHERE equal($204, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $205", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.05244755244755245, "writeRatioMax": 0.05244755244755245 }, { "completedParallelInputs": "1", "computeMsAvg": "329", "computeMsMax": "329", "computeRatioAvg": 0.5751748251748252, "computeRatioMax": 0.5751748251748252, "endMs": "1665778557162", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "364", "startMs": "1665778556951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage10_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.024475524475524476, "writeRatioMax": 0.024475524475524476 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.015734265734265736, "computeRatioMax": 0.015734265734265736, "endMs": "1665778556998", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01048951048951049, "readRatioMax": 0.01048951048951049, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778556966", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01048951048951049, "writeRatioMax": 0.01048951048951049 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02097902097902098, "computeRatioMax": 0.02097902097902098, "endMs": "1665778557011", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008741258741258742, "readRatioMax": 0.008741258741258742, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778556982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category", "FROM item", "WHERE equal($194, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $195", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.026223776223776224, "writeRatioMax": 0.026223776223776224 }, { "completedParallelInputs": "1", "computeMsAvg": "199", "computeMsMax": "199", "computeRatioAvg": 0.3479020979020979, "computeRatioMax": 0.3479020979020979, "endMs": "1665778557172", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.017482517482517484, "readRatioMax": 0.017482517482517484, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "231", "startMs": "1665778557011", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.019230769230769232, "writeRatioMax": 0.019230769230769232 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02097902097902098, "computeRatioMax": 0.02097902097902098, "endMs": "1665778557068", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.015734265734265736, "readRatioMax": 0.015734265734265736, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778557030", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year", "FROM date_dim", "WHERE equal($71, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013986013986013986, "writeRatioMax": 0.013986013986013986 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.015734265734265736, "computeRatioMax": 0.015734265734265736, "endMs": "1665778557091", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006993006993006993, "readRatioMax": 0.006993006993006993, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778557052", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category", "FROM item", "WHERE equal($184, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $185", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.024475524475524476, "writeRatioMax": 0.024475524475524476 }, { "completedParallelInputs": "12", "computeMsAvg": "341", "computeMsMax": "416", "computeRatioAvg": 0.5961538461538461, "computeRatioMax": 0.7272727272727273, "endMs": "1665778557350", "id": "24", "inputStages": [ "5", "1", "0", "8", "9", "4", "6", "10", "2" ], "name": "S18: Join+", "parallelInputs": "12", "readMsAvg": "19", "readMsMax": "27", "readRatioAvg": 0.033216783216783216, "readRatioMax": 0.0472027972027972, "recordsRead": "7583694", "recordsWritten": "10588", "shuffleOutputBytes": "751356", "shuffleOutputBytesSpilled": "0", "slotMs": "3994", "startMs": "1665778557077", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $215", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $225", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$150, $151", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $235", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304", "$280 := SUM($305)", "$281 := SUM($306)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := subtract($560, coalesce($567, 0))", "$341 := subtract($561, coalesce($568, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$560 := $552, $561 := $553, $562 := $558, $563 := $554, $564 := $555, $565 := $556, $566 := $557, $567 := $32, $568 := $33", "LEFT OUTER HASH JOIN EACH WITH ALL ON $551 = $31, $550 = $30" ] }, { "kind": "JOIN", "substeps": [ "$550 := $531, $551 := $532, $552 := $533, $553 := $534, $554 := $535, $555 := $536, $556 := $537, $557 := $538, $558 := $131", "INNER HASH JOIN EACH WITH ALL ON $530 = $130" ] }, { "kind": "JOIN", "substeps": [ "$530 := $120, $531 := $121, $532 := $122, $533 := $123, $534 := $124, $535 := $211, $536 := $212, $537 := $213, $538 := $215", "INNER HASH JOIN EACH WITH ALL ON $121 = $210" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := subtract($610, coalesce($617, 0))", "$351 := subtract($611, coalesce($618, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$610 := $602, $611 := $603, $612 := $608, $613 := $604, $614 := $605, $615 := $606, $616 := $607, $617 := $42, $618 := $43", "LEFT OUTER HASH JOIN EACH WITH ALL ON $601 = $41, $600 = $40" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $151", "INNER HASH JOIN EACH WITH ALL ON $580 = $150" ] }, { "kind": "JOIN", "substeps": [ "$580 := $140, $581 := $141, $582 := $142, $583 := $143, $584 := $144, $585 := $221, $586 := $222, $587 := $223, $588 := $225", "INNER HASH JOIN EACH WITH ALL ON $141 = $220" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := subtract($660, coalesce($667, 0))", "$361 := subtract($661, coalesce($668, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$660 := $652, $661 := $653, $662 := $658, $663 := $654, $664 := $655, $665 := $656, $666 := $657, $667 := $52, $668 := $53", "LEFT OUTER HASH JOIN EACH WITH ALL ON $651 = $51, $650 = $50" ] }, { "kind": "JOIN", "substeps": [ "$650 := $631, $651 := $632, $652 := $633, $653 := $634, $654 := $635, $655 := $636, $656 := $637, $657 := $638, $658 := $171", "INNER HASH JOIN EACH WITH ALL ON $630 = $170" ] }, { "kind": "JOIN", "substeps": [ "$630 := $160, $631 := $161, $632 := $162, $633 := $163, $634 := $164, $635 := $231, $636 := $232, $637 := $233, $638 := $235", "INNER HASH JOIN EACH WITH ALL ON $161 = $230" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "TO __stage18_output", "BY HASH($670, $671, $672, $673, $674)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.01048951048951049 }, { "completedParallelInputs": "12", "computeMsAvg": "392", "computeMsMax": "572", "computeRatioAvg": 0.6853146853146853, "computeRatioMax": 1, "endMs": "1665778557583", "id": "25", "inputStages": [ "12", "22", "18", "21", "20", "16", "17", "14", "13" ], "name": "S19: Join+", "parallelInputs": "12", "readMsAvg": "21", "readMsMax": "30", "readRatioAvg": 0.03671328671328671, "readRatioMax": 0.05244755244755245, "recordsRead": "7583694", "recordsWritten": "10287", "shuffleOutputBytes": "730185", "shuffleOutputBytesSpilled": "0", "slotMs": "4688", "startMs": "1665778557211", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $185", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $195", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $205", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294", "$270 := SUM($295)", "$271 := SUM($296)" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := subtract($400, coalesce($407, 0))", "$311 := subtract($401, coalesce($408, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$400 := $392, $401 := $393, $402 := $398, $403 := $394, $404 := $395, $405 := $396, $406 := $397, $407 := $3, $408 := $4", "LEFT OUTER HASH JOIN EACH WITH ALL ON $391 = $2, $390 = $1" ] }, { "kind": "JOIN", "substeps": [ "$390 := $371, $391 := $372, $392 := $373, $393 := $374, $394 := $375, $395 := $376, $396 := $377, $397 := $378, $398 := $71", "INNER HASH JOIN EACH WITH ALL ON $370 = $70" ] }, { "kind": "JOIN", "substeps": [ "$370 := $60, $371 := $61, $372 := $62, $373 := $63, $374 := $64, $375 := $181, $376 := $182, $377 := $183, $378 := $185", "INNER HASH JOIN EACH WITH ALL ON $61 = $180" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := subtract($450, coalesce($457, 0))", "$321 := subtract($451, coalesce($458, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$450 := $442, $451 := $443, $452 := $448, $453 := $444, $454 := $445, $455 := $446, $456 := $447, $457 := $12, $458 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $441 = $11, $440 = $10" ] }, { "kind": "JOIN", "substeps": [ "$440 := $421, $441 := $422, $442 := $423, $443 := $424, $444 := $425, $445 := $426, $446 := $427, $447 := $428, $448 := $91", "INNER HASH JOIN EACH WITH ALL ON $420 = $90" ] }, { "kind": "JOIN", "substeps": [ "$420 := $80, $421 := $81, $422 := $82, $423 := $83, $424 := $84, $425 := $191, $426 := $192, $427 := $193, $428 := $195", "INNER HASH JOIN EACH WITH ALL ON $81 = $190" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := subtract($500, coalesce($507, 0))", "$331 := subtract($501, coalesce($508, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$500 := $492, $501 := $493, $502 := $498, $503 := $494, $504 := $495, $505 := $496, $506 := $497, $507 := $22, $508 := $23", "LEFT OUTER HASH JOIN EACH WITH ALL ON $491 = $21, $490 = $20" ] }, { "kind": "JOIN", "substeps": [ "$490 := $471, $491 := $472, $492 := $473, $493 := $474, $494 := $475, $495 := $476, $496 := $477, $497 := $478, $498 := $111", "INNER HASH JOIN EACH WITH ALL ON $470 = $110" ] }, { "kind": "JOIN", "substeps": [ "$470 := $100, $471 := $101, $472 := $102, $473 := $103, $474 := $104, $475 := $201, $476 := $202, $477 := $203, $478 := $205", "INNER HASH JOIN EACH WITH ALL ON $101 = $200" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "TO __stage19_output", "BY HASH($510, $511, $512, $513, $514)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.01048951048951049 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.02972027972027972, "computeRatioMax": 0.02972027972027972, "endMs": "1665778557645", "id": "26", "inputStages": [ "24" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10588", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778557608", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674", "$260 := SUM($280)", "$261 := SUM($281)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017482517482517483, "waitRatioMax": 0.0017482517482517483, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02097902097902098, "writeRatioMax": 0.02097902097902098 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.013986013986013986, "computeRatioMax": 0.024475524475524476, "endMs": "1665778557701", "id": "28", "inputStages": [ "26" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "881", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "3630", "startMs": "1665778557653", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.005244755244755245, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.024475524475524476, "writeRatioMax": 0.03671328671328671 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.024475524475524476, "computeRatioMax": 0.024475524475524476, "endMs": "1665778557709", "id": "29", "inputStages": [ "28", "25" ], "name": "S1D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11168", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778557657", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "FROM __stage1C_output" ] }, { "kind": "SORT", "substeps": [ "$240 ASC, $241 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := subtract($690, $697)", "$241 := subtract($691, $698)" ] }, { "kind": "FILTER", "substeps": [ "less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)" ] }, { "kind": "JOIN", "substeps": [ "$690 := $250, $691 := $251, $692 := $520, $693 := $521, $694 := $522, $695 := $523, $696 := $524, $697 := $260, $698 := $261, $699 := $680", "INNER HASH JOIN EACH WITH ALL ON $521 = $681, $522 = $682, $523 = $683, $524 = $684" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514", "$250 := SUM($270)", "$251 := SUM($271)" ] }, { "kind": "WRITE", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "TO __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0034965034965034965, "writeRatioMax": 0.0034965034965034965 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.01048951048951049, "computeRatioMax": 0.01048951048951049, "endMs": "1665778557718", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778557673", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$700 ASC, $701 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719", "TO __stage1E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034965034965034965, "waitRatioMax": 0.0034965034965034965, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.006993006993006993 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "12", "completedUnits": "18", "elapsedMs": "641", "estimatedRunnableUnits": "0", "pendingUnits": "12", "totalSlotMs": "3233" }, { "activeUnits": "1", "completedUnits": "145", "elapsedMs": "1229", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15403" } ], "totalBytesBilled": "260046848", "totalBytesProcessed": "259359179", "totalPartitionsProcessed": "0", "totalSlotMs": "15403", "transferredBytes": "0" }, "startTime": "1665778556551", "totalBytesProcessed": "259359179", "totalSlotMs": "15403" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0fe44315_c8ce_4341_9f2a_13bc5ff56722" }, "priority": "INTERACTIVE", "query": "-- start query 75 in stream 0 using template query75.tpl\n\n/*\nFor two consecutive years track the sales of items by brand, class and category.\n*/\n\nWITH all_sales AS (\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,SUM(sales_cnt) AS sales_cnt\n ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n JOIN date_dim ON d_date_sk=cs_sold_date_sk\n LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n AND cs_item_sk=cr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n JOIN date_dim ON d_date_sk=ss_sold_date_sk\n LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n AND ss_item_sk=sr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n JOIN date_dim ON d_date_sk=ws_sold_date_sk\n LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n AND ws_item_sk=wr_item_sk)\n WHERE i_category='Books') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT prev_yr.d_year AS prev_year\n ,curr_yr.d_year AS year\n ,curr_yr.i_brand_id\n ,curr_yr.i_class_id\n ,curr_yr.i_category_id\n ,curr_yr.i_manufact_id\n ,prev_yr.sales_cnt AS prev_yr_cnt\n ,curr_yr.sales_cnt AS curr_yr_cnt\n ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n AND curr_yr.i_class_id=prev_yr.i_class_id\n AND curr_yr.i_category_id=prev_yr.i_category_id\n AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n AND curr_yr.d_year=2002\n AND prev_yr.d_year=2002-1\n AND (curr_yr.sales_cnt)/(prev_yr.sales_cnt)<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n LIMIT 100\n ;\n\n-- end query 75 in stream 0 using template query75.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "XOY4jy7OTy0dz0vdZHgXcA==", "id": "test-project-364309:europe-west1.query75_1665778558", "jobReference": { "jobId": "query75_1665778558", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query75_1665778558?location=europe-west1", "statistics": { "creationTime": "1665778559471", "endTime": "1665778560824", "finalExecutionDurationMs": "1070", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "259359179", "performanceInsights": { "avgPreviousExecutionMs": "1118" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "79", "computeMsMax": "79", "computeRatioAvg": 0.14794007490636704, "computeRatioMax": 0.14794007490636704, "endMs": "1665778559743", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.024344569288389514, "readRatioMax": 0.024344569288389514, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "88", "startMs": "1665778559666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.018726591760299626, "writeRatioMax": 0.018726591760299626 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.024344569288389514, "computeRatioMax": 0.024344569288389514, "endMs": "1665778559709", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011235955056179775, "readRatioMax": 0.011235955056179775, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778559684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02247191011235955, "writeRatioMax": 0.02247191011235955 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02247191011235955, "computeRatioMax": 0.02247191011235955, "endMs": "1665778559726", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011235955056179775, "readRatioMax": 0.011235955056179775, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778559698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category", "FROM item", "WHERE equal($234, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $235", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.024344569288389514, "writeRatioMax": 0.024344569288389514 }, { "completedParallelInputs": "1", "computeMsAvg": "196", "computeMsMax": "196", "computeRatioAvg": 0.36704119850187267, "computeRatioMax": 0.36704119850187267, "endMs": "1665778559910", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.02247191011235955, "readRatioMax": 0.02247191011235955, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665778559727", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage04_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.00749063670411985, "waitRatioMax": 0.00749063670411985, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.026217228464419477, "writeRatioMax": 0.026217228464419477 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.018726591760299626, "computeRatioMax": 0.018726591760299626, "endMs": "1665778559770", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.013108614232209739, "readRatioMax": 0.013108614232209739, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778559736", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year", "FROM date_dim", "WHERE equal($151, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.013108614232209739, "writeRatioMax": 0.013108614232209739 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.031835205992509365, "computeRatioMax": 0.031835205992509365, "endMs": "1665778559790", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011235955056179775, "readRatioMax": 0.011235955056179775, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778559748", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category", "FROM item", "WHERE equal($224, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $225", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.026217228464419477, "writeRatioMax": 0.026217228464419477 }, { "completedParallelInputs": "1", "computeMsAvg": "135", "computeMsMax": "135", "computeRatioAvg": 0.25280898876404495, "computeRatioMax": 0.25280898876404495, "endMs": "1665778559896", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.018726591760299626, "readRatioMax": 0.018726591760299626, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "164", "startMs": "1665778559771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.020599250936329586, "writeRatioMax": 0.020599250936329586 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.026217228464419477, "computeRatioMax": 0.026217228464419477, "endMs": "1665778559823", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.024344569288389514, "readRatioMax": 0.024344569288389514, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778559789", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_year", "FROM date_dim", "WHERE equal($131, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.016853932584269662, "writeRatioMax": 0.016853932584269662 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.024344569288389514, "computeRatioMax": 0.024344569288389514, "endMs": "1665778559841", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011235955056179775, "readRatioMax": 0.011235955056179775, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778559802", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category", "FROM item", "WHERE equal($214, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $215", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.016853932584269662, "writeRatioMax": 0.016853932584269662 }, { "completedParallelInputs": "1", "computeMsAvg": "72", "computeMsMax": "72", "computeRatioAvg": 0.1348314606741573, "computeRatioMax": 0.1348314606741573, "endMs": "1665778559921", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.031835205992509365, "readRatioMax": 0.031835205992509365, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "129", "startMs": "1665778559827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02247191011235955, "writeRatioMax": 0.02247191011235955 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.031835205992509365, "computeRatioMax": 0.031835205992509365, "endMs": "1665778559892", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.03932584269662921, "readRatioMax": 0.03932584269662921, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778559840", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003745318352059925, "waitRatioMax": 0.003745318352059925, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.013108614232209739, "writeRatioMax": 0.013108614232209739 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.024344569288389514, "computeRatioMax": 0.024344569288389514, "endMs": "1665778559889", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011235955056179775, "readRatioMax": 0.011235955056179775, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778559855", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category", "FROM item", "WHERE equal($204, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $205", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.033707865168539325, "writeRatioMax": 0.033707865168539325 }, { "completedParallelInputs": "1", "computeMsAvg": "197", "computeMsMax": "197", "computeRatioAvg": 0.36891385767790263, "computeRatioMax": 0.36891385767790263, "endMs": "1665778560043", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.02247191011235955, "readRatioMax": 0.02247191011235955, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "202", "startMs": "1665778559888", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.024344569288389514, "writeRatioMax": 0.024344569288389514 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.020599250936329586, "computeRatioMax": 0.020599250936329586, "endMs": "1665778559942", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.016853932584269662, "readRatioMax": 0.016853932584269662, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778559903", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.020599250936329586, "writeRatioMax": 0.020599250936329586 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.026217228464419477, "computeRatioMax": 0.026217228464419477, "endMs": "1665778559963", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009363295880149813, "readRatioMax": 0.009363295880149813, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778559919", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category", "FROM item", "WHERE equal($194, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $195", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0299625468164794, "writeRatioMax": 0.0299625468164794 }, { "completedParallelInputs": "1", "computeMsAvg": "113", "computeMsMax": "113", "computeRatioAvg": 0.21161048689138576, "computeRatioMax": 0.21161048689138576, "endMs": "1665778560084", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.033707865168539325, "readRatioMax": 0.033707865168539325, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "125", "startMs": "1665778559956", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0299625468164794, "writeRatioMax": 0.0299625468164794 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.020599250936329586, "computeRatioMax": 0.020599250936329586, "endMs": "1665778560040", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "39", "readMsMax": "39", "readRatioAvg": 0.07303370786516854, "readRatioMax": 0.07303370786516854, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778559982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year", "FROM date_dim", "WHERE equal($71, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage15_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.011235955056179775, "waitRatioMax": 0.011235955056179775, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.009363295880149813, "writeRatioMax": 0.009363295880149813 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.028089887640449437, "computeRatioMax": 0.028089887640449437, "endMs": "1665778560043", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.013108614232209739, "readRatioMax": 0.013108614232209739, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778559993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category", "FROM item", "WHERE equal($184, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $185", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.031835205992509365, "writeRatioMax": 0.031835205992509365 }, { "completedParallelInputs": "12", "computeMsAvg": "361", "computeMsMax": "499", "computeRatioAvg": 0.6760299625468165, "computeRatioMax": 0.9344569288389513, "endMs": "1665778560391", "id": "25", "inputStages": [ "5", "0", "2", "10", "9", "4", "8", "1", "6" ], "name": "S19: Join+", "parallelInputs": "12", "readMsAvg": "20", "readMsMax": "29", "readRatioAvg": 0.03745318352059925, "readRatioMax": 0.054307116104868915, "recordsRead": "7583694", "recordsWritten": "10588", "shuffleOutputBytes": "751356", "shuffleOutputBytesSpilled": "0", "slotMs": "4438", "startMs": "1665778560040", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $215", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $225", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$150, $151", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $235", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304", "$280 := SUM($305)", "$281 := SUM($306)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := subtract($560, coalesce($567, 0))", "$341 := subtract($561, coalesce($568, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$560 := $552, $561 := $553, $562 := $558, $563 := $554, $564 := $555, $565 := $556, $566 := $557, $567 := $32, $568 := $33", "LEFT OUTER HASH JOIN EACH WITH ALL ON $551 = $31, $550 = $30" ] }, { "kind": "JOIN", "substeps": [ "$550 := $531, $551 := $532, $552 := $533, $553 := $534, $554 := $535, $555 := $536, $556 := $537, $557 := $538, $558 := $131", "INNER HASH JOIN EACH WITH ALL ON $530 = $130" ] }, { "kind": "JOIN", "substeps": [ "$530 := $120, $531 := $121, $532 := $122, $533 := $123, $534 := $124, $535 := $211, $536 := $212, $537 := $213, $538 := $215", "INNER HASH JOIN EACH WITH ALL ON $121 = $210" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := subtract($610, coalesce($617, 0))", "$351 := subtract($611, coalesce($618, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$610 := $602, $611 := $603, $612 := $608, $613 := $604, $614 := $605, $615 := $606, $616 := $607, $617 := $42, $618 := $43", "LEFT OUTER HASH JOIN EACH WITH ALL ON $601 = $41, $600 = $40" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $151", "INNER HASH JOIN EACH WITH ALL ON $580 = $150" ] }, { "kind": "JOIN", "substeps": [ "$580 := $140, $581 := $141, $582 := $142, $583 := $143, $584 := $144, $585 := $221, $586 := $222, $587 := $223, $588 := $225", "INNER HASH JOIN EACH WITH ALL ON $141 = $220" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := subtract($660, coalesce($667, 0))", "$361 := subtract($661, coalesce($668, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$660 := $652, $661 := $653, $662 := $658, $663 := $654, $664 := $655, $665 := $656, $666 := $657, $667 := $52, $668 := $53", "LEFT OUTER HASH JOIN EACH WITH ALL ON $651 = $51, $650 = $50" ] }, { "kind": "JOIN", "substeps": [ "$650 := $631, $651 := $632, $652 := $633, $653 := $634, $654 := $635, $655 := $636, $656 := $637, $657 := $638, $658 := $171", "INNER HASH JOIN EACH WITH ALL ON $630 = $170" ] }, { "kind": "JOIN", "substeps": [ "$630 := $160, $631 := $161, $632 := $162, $633 := $163, $634 := $164, $635 := $231, $636 := $232, $637 := $233, $638 := $235", "INNER HASH JOIN EACH WITH ALL ON $161 = $230" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "TO __stage19_output", "BY HASH($670, $671, $672, $673, $674)" ] } ], "waitMsAvg": "8", "waitMsMax": "9", "waitRatioAvg": 0.0149812734082397, "waitRatioMax": 0.016853932584269662, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.009363295880149813, "writeRatioMax": 0.011235955056179775 }, { "completedParallelInputs": "12", "computeMsAvg": "368", "computeMsMax": "534", "computeRatioAvg": 0.6891385767790262, "computeRatioMax": 1, "endMs": "1665778560468", "id": "26", "inputStages": [ "21", "14", "17", "18", "22", "20", "13", "12", "16" ], "name": "S1A: Join+", "parallelInputs": "12", "readMsAvg": "20", "readMsMax": "33", "readRatioAvg": 0.03745318352059925, "readRatioMax": 0.06179775280898876, "recordsRead": "7583694", "recordsWritten": "10287", "shuffleOutputBytes": "730185", "shuffleOutputBytesSpilled": "0", "slotMs": "4191", "startMs": "1665778560115", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $185", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $195", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $205", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294", "$270 := SUM($295)", "$271 := SUM($296)" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := subtract($400, coalesce($407, 0))", "$311 := subtract($401, coalesce($408, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$400 := $392, $401 := $393, $402 := $398, $403 := $394, $404 := $395, $405 := $396, $406 := $397, $407 := $3, $408 := $4", "LEFT OUTER HASH JOIN EACH WITH ALL ON $391 = $2, $390 = $1" ] }, { "kind": "JOIN", "substeps": [ "$390 := $371, $391 := $372, $392 := $373, $393 := $374, $394 := $375, $395 := $376, $396 := $377, $397 := $378, $398 := $71", "INNER HASH JOIN EACH WITH ALL ON $370 = $70" ] }, { "kind": "JOIN", "substeps": [ "$370 := $60, $371 := $61, $372 := $62, $373 := $63, $374 := $64, $375 := $181, $376 := $182, $377 := $183, $378 := $185", "INNER HASH JOIN EACH WITH ALL ON $61 = $180" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := subtract($450, coalesce($457, 0))", "$321 := subtract($451, coalesce($458, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$450 := $442, $451 := $443, $452 := $448, $453 := $444, $454 := $445, $455 := $446, $456 := $447, $457 := $12, $458 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $441 = $11, $440 = $10" ] }, { "kind": "JOIN", "substeps": [ "$440 := $421, $441 := $422, $442 := $423, $443 := $424, $444 := $425, $445 := $426, $446 := $427, $447 := $428, $448 := $91", "INNER HASH JOIN EACH WITH ALL ON $420 = $90" ] }, { "kind": "JOIN", "substeps": [ "$420 := $80, $421 := $81, $422 := $82, $423 := $83, $424 := $84, $425 := $191, $426 := $192, $427 := $193, $428 := $195", "INNER HASH JOIN EACH WITH ALL ON $81 = $190" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := subtract($500, coalesce($507, 0))", "$331 := subtract($501, coalesce($508, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$500 := $492, $501 := $493, $502 := $498, $503 := $494, $504 := $495, $505 := $496, $506 := $497, $507 := $22, $508 := $23", "LEFT OUTER HASH JOIN EACH WITH ALL ON $491 = $21, $490 = $20" ] }, { "kind": "JOIN", "substeps": [ "$490 := $471, $491 := $472, $492 := $473, $493 := $474, $494 := $475, $495 := $476, $496 := $477, $497 := $478, $498 := $111", "INNER HASH JOIN EACH WITH ALL ON $470 = $110" ] }, { "kind": "JOIN", "substeps": [ "$470 := $100, $471 := $101, $472 := $102, $473 := $103, $474 := $104, $475 := $201, $476 := $202, $477 := $203, $478 := $205", "INNER HASH JOIN EACH WITH ALL ON $101 = $200" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "TO __stage1A_output", "BY HASH($510, $511, $512, $513, $514)" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.013108614232209739, "waitRatioMax": 0.013108614232209739, "writeMsAvg": "5", "writeMsMax": "11", "writeRatioAvg": 0.009363295880149813, "writeRatioMax": 0.020599250936329586 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.024344569288389514, "computeRatioMax": 0.024344569288389514, "endMs": "1665778560549", "id": "27", "inputStages": [ "25" ], "name": "S1B: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10588", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778560495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "FROM __stage19_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674", "$260 := SUM($280)", "$261 := SUM($281)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018726591760299626, "waitRatioMax": 0.0018726591760299626, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.04307116104868914, "writeRatioMax": 0.04307116104868914 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.0149812734082397, "computeRatioMax": 0.031835205992509365, "endMs": "1665778560648", "id": "29", "inputStages": [ "27" ], "name": "S1D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "881", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "5561", "startMs": "1665778560566", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "12", "waitMsMax": "18", "waitRatioAvg": 0.02247191011235955, "waitRatioMax": 0.033707865168539325, "writeMsAvg": "18", "writeMsMax": "31", "writeRatioAvg": 0.033707865168539325, "writeRatioMax": 0.05805243445692884 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.035580524344569285, "computeRatioMax": 0.035580524344569285, "endMs": "1665778560669", "id": "30", "inputStages": [ "29", "26" ], "name": "S1E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11168", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778560585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$240 ASC, $241 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := subtract($690, $697)", "$241 := subtract($691, $698)" ] }, { "kind": "FILTER", "substeps": [ "less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)" ] }, { "kind": "JOIN", "substeps": [ "$690 := $250, $691 := $251, $692 := $520, $693 := $521, $694 := $522, $695 := $523, $696 := $524, $697 := $260, $698 := $261, $699 := $680", "INNER HASH JOIN EACH WITH ALL ON $521 = $681, $522 = $682, $523 = $683, $524 = $684" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514", "$250 := SUM($270)", "$251 := SUM($271)" ] }, { "kind": "WRITE", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "TO __stage1E_output" ] } ], "waitMsAvg": "16", "waitMsMax": "16", "waitRatioAvg": 0.0299625468164794, "waitRatioMax": 0.0299625468164794, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.003745318352059925, "writeRatioMax": 0.003745318352059925 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.016853932584269662, "computeRatioMax": 0.016853932584269662, "endMs": "1665778560687", "id": "31", "inputStages": [ "30" ], "name": "S1F: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778560583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "FROM __stage1E_output" ] }, { "kind": "SORT", "substeps": [ "$700 ASC, $701 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719", "TO __stage1F_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.009363295880149813, "waitRatioMax": 0.009363295880149813, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.009363295880149813, "writeRatioMax": 0.009363295880149813 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "18", "elapsedMs": "647", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "3592" }, { "activeUnits": "24", "completedUnits": "145", "elapsedMs": "1256", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "17454" } ], "totalBytesBilled": "260046848", "totalBytesProcessed": "259359179", "totalPartitionsProcessed": "0", "totalSlotMs": "17454", "transferredBytes": "0" }, "startTime": "1665778559521", "totalBytesProcessed": "259359179", "totalSlotMs": "17454" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon462dfe1d_a916_4c96_a5f4_73fd678adc19" }, "priority": "INTERACTIVE", "query": "-- start query 75 in stream 0 using template query75.tpl\n\n/*\nFor two consecutive years track the sales of items by brand, class and category.\n*/\n\nWITH all_sales AS (\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,SUM(sales_cnt) AS sales_cnt\n ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n JOIN date_dim ON d_date_sk=cs_sold_date_sk\n LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n AND cs_item_sk=cr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n JOIN date_dim ON d_date_sk=ss_sold_date_sk\n LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n AND ss_item_sk=sr_item_sk)\n WHERE i_category='Books'\n UNION ALL\n SELECT d_year\n ,i_brand_id\n ,i_class_id\n ,i_category_id\n ,i_manufact_id\n ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n JOIN date_dim ON d_date_sk=ws_sold_date_sk\n LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n AND ws_item_sk=wr_item_sk)\n WHERE i_category='Books') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT prev_yr.d_year AS prev_year\n ,curr_yr.d_year AS year\n ,curr_yr.i_brand_id\n ,curr_yr.i_class_id\n ,curr_yr.i_category_id\n ,curr_yr.i_manufact_id\n ,prev_yr.sales_cnt AS prev_yr_cnt\n ,curr_yr.sales_cnt AS curr_yr_cnt\n ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n AND curr_yr.i_class_id=prev_yr.i_class_id\n AND curr_yr.i_category_id=prev_yr.i_category_id\n AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n AND curr_yr.d_year=2002\n AND prev_yr.d_year=2002-1\n AND (curr_yr.sales_cnt)/(prev_yr.sales_cnt)<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n LIMIT 100\n ;\n\n-- end query 75 in stream 0 using template query75.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "hEXdDMgDtwZ1eOJ5Fhy0Qw==", "id": "test-project-364309:europe-west1.query75_1665778561", "jobReference": { "jobId": "query75_1665778561", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query75_1665778561?location=europe-west1", "statistics": { "creationTime": "1665778562481", "endTime": "1665778563869", "finalExecutionDurationMs": "1068", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "259359179", "performanceInsights": { "avgPreviousExecutionMs": "1112" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "70", "computeMsMax": "70", "computeRatioAvg": 0.11075949367088607, "computeRatioMax": 0.11075949367088607, "endMs": "1665778562793", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011075949367088608, "readRatioMax": 0.011075949367088608, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "102", "startMs": "1665778562717", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52, $53", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.012658227848101266, "writeRatioMax": 0.012658227848101266 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.012658227848101266, "computeRatioMax": 0.012658227848101266, "endMs": "1665778562763", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778562735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0189873417721519, "writeRatioMax": 0.0189873417721519 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.015822784810126583, "computeRatioMax": 0.015822784810126583, "endMs": "1665778562786", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011075949367088608, "readRatioMax": 0.011075949367088608, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778562748", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category", "FROM item", "WHERE equal($234, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232, $233, $235", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0189873417721519, "writeRatioMax": 0.0189873417721519 }, { "completedParallelInputs": "1", "computeMsAvg": "251", "computeMsMax": "251", "computeRatioAvg": 0.3971518987341772, "computeRatioMax": 0.3971518987341772, "endMs": "1665778563004", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.02689873417721519, "readRatioMax": 0.02689873417721519, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "332", "startMs": "1665778562787", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43", "TO __stage04_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.014240506329113924, "waitRatioMax": 0.014240506329113924, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.03322784810126582, "writeRatioMax": 0.03322784810126582 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.014240506329113924, "computeRatioMax": 0.014240506329113924, "endMs": "1665778562833", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011075949367088608, "readRatioMax": 0.011075949367088608, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778562795", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:d_date_sk, $151:d_year", "FROM date_dim", "WHERE equal($151, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01740506329113924, "writeRatioMax": 0.01740506329113924 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0189873417721519, "computeRatioMax": 0.0189873417721519, "endMs": "1665778562842", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778562809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category", "FROM item", "WHERE equal($224, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$220, $221, $222, $223, $225", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.011075949367088608, "writeRatioMax": 0.011075949367088608 }, { "completedParallelInputs": "1", "computeMsAvg": "115", "computeMsMax": "115", "computeRatioAvg": 0.1819620253164557, "computeRatioMax": 0.1819620253164557, "endMs": "1665778562947", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.014240506329113924, "readRatioMax": 0.014240506329113924, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "148", "startMs": "1665778562836", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0189873417721519, "writeRatioMax": 0.0189873417721519 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.022151898734177215, "computeRatioMax": 0.022151898734177215, "endMs": "1665778562890", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778562852", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:d_date_sk, $131:d_year", "FROM date_dim", "WHERE equal($131, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.012658227848101266, "writeRatioMax": 0.012658227848101266 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01740506329113924, "computeRatioMax": 0.01740506329113924, "endMs": "1665778562910", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006329113924050633, "readRatioMax": 0.006329113924050633, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778562871", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category", "FROM item", "WHERE equal($214, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $215", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.023734177215189875, "writeRatioMax": 0.023734177215189875 }, { "completedParallelInputs": "1", "computeMsAvg": "74", "computeMsMax": "74", "computeRatioAvg": 0.11708860759493671, "computeRatioMax": 0.11708860759493671, "endMs": "1665778562994", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0189873417721519, "readRatioMax": 0.0189873417721519, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "3081020", "shuffleOutputBytesSpilled": "0", "slotMs": "112", "startMs": "1665778562900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.020569620253164556, "writeRatioMax": 0.020569620253164556 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.014240506329113924, "computeRatioMax": 0.014240506329113924, "endMs": "1665778562955", "id": "13", "name": "S0D: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00949367088607595, "readRatioMax": 0.00949367088607595, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778562915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0031645569620253164, "waitRatioMax": 0.0031645569620253164, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.020569620253164556, "writeRatioMax": 0.020569620253164556 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.012658227848101266, "computeRatioMax": 0.012658227848101266, "endMs": "1665778562963", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.004746835443037975, "readRatioMax": 0.004746835443037975, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778562928", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category", "FROM item", "WHERE equal($204, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $205", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.022151898734177215, "writeRatioMax": 0.022151898734177215 }, { "completedParallelInputs": "1", "computeMsAvg": "305", "computeMsMax": "305", "computeRatioAvg": 0.4825949367088608, "computeRatioMax": 0.4825949367088608, "endMs": "1665778563189", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.02689873417721519, "readRatioMax": 0.02689873417721519, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "12409664", "shuffleOutputBytesSpilled": "0", "slotMs": "300", "startMs": "1665778562952", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02531645569620253, "writeRatioMax": 0.02531645569620253 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.015822784810126583, "computeRatioMax": 0.015822784810126583, "endMs": "1665778563004", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00949367088607595, "readRatioMax": 0.00949367088607595, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778562966", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:d_date_sk, $91:d_year", "FROM date_dim", "WHERE equal($91, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0189873417721519, "writeRatioMax": 0.0189873417721519 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01740506329113924, "computeRatioMax": 0.01740506329113924, "endMs": "1665778563014", "id": "18", "name": "S12: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00949367088607595, "readRatioMax": 0.00949367088607595, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778562981", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category", "FROM item", "WHERE equal($194, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $195", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.012658227848101266, "writeRatioMax": 0.012658227848101266 }, { "completedParallelInputs": "1", "computeMsAvg": "125", "computeMsMax": "125", "computeRatioAvg": 0.19778481012658228, "computeRatioMax": 0.19778481012658228, "endMs": "1665778563123", "id": "20", "name": "S14: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.015822784810126583, "readRatioMax": 0.015822784810126583, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "6269772", "shuffleOutputBytesSpilled": "0", "slotMs": "125", "startMs": "1665778563008", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01740506329113924, "writeRatioMax": 0.01740506329113924 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01740506329113924, "computeRatioMax": 0.01740506329113924, "endMs": "1665778563053", "id": "21", "name": "S15: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00949367088607595, "readRatioMax": 0.00949367088607595, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665778563021", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_year", "FROM date_dim", "WHERE equal($71, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.02689873417721519, "writeRatioMax": 0.02689873417721519 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.020569620253164556, "computeRatioMax": 0.020569620253164556, "endMs": "1665778563067", "id": "22", "name": "S16: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007911392405063292, "readRatioMax": 0.007911392405063292, "recordsRead": "18000", "recordsWritten": "1733", "shuffleOutputBytes": "77929", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778563034", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category", "FROM item", "WHERE equal($184, 'Books')" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $182, $183, $185", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.012658227848101266, "writeRatioMax": 0.012658227848101266 }, { "completedParallelInputs": "12", "computeMsAvg": "350", "computeMsMax": "550", "computeRatioAvg": 0.5537974683544303, "computeRatioMax": 0.870253164556962, "endMs": "1665778563426", "id": "24", "inputStages": [ "9", "8", "5", "6", "4", "1", "0", "2", "10" ], "name": "S18: Join+", "parallelInputs": "12", "readMsAvg": "21", "readMsMax": "34", "readRatioAvg": 0.03322784810126582, "readRatioMax": 0.05379746835443038, "recordsRead": "7583694", "recordsWritten": "10588", "shuffleOutputBytes": "751356", "shuffleOutputBytesSpilled": "0", "slotMs": "4375", "startMs": "1665778563055", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $215", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$220, $221, $222, $223, $225", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$150, $151", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232, $233, $235", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52, $53", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304", "$280 := SUM($305)", "$281 := SUM($306)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := subtract($560, coalesce($567, 0))", "$341 := subtract($561, coalesce($568, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$560 := $552, $561 := $553, $562 := $558, $563 := $554, $564 := $555, $565 := $556, $566 := $557, $567 := $32, $568 := $33", "LEFT OUTER HASH JOIN EACH WITH ALL ON $551 = $31, $550 = $30" ] }, { "kind": "JOIN", "substeps": [ "$550 := $531, $551 := $532, $552 := $533, $553 := $534, $554 := $535, $555 := $536, $556 := $537, $557 := $538, $558 := $131", "INNER HASH JOIN EACH WITH ALL ON $530 = $130" ] }, { "kind": "JOIN", "substeps": [ "$530 := $120, $531 := $121, $532 := $122, $533 := $123, $534 := $124, $535 := $211, $536 := $212, $537 := $213, $538 := $215", "INNER HASH JOIN EACH WITH ALL ON $121 = $210" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := subtract($610, coalesce($617, 0))", "$351 := subtract($611, coalesce($618, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$610 := $602, $611 := $603, $612 := $608, $613 := $604, $614 := $605, $615 := $606, $616 := $607, $617 := $42, $618 := $43", "LEFT OUTER HASH JOIN EACH WITH ALL ON $601 = $41, $600 = $40" ] }, { "kind": "JOIN", "substeps": [ "$600 := $581, $601 := $582, $602 := $583, $603 := $584, $604 := $585, $605 := $586, $606 := $587, $607 := $588, $608 := $151", "INNER HASH JOIN EACH WITH ALL ON $580 = $150" ] }, { "kind": "JOIN", "substeps": [ "$580 := $140, $581 := $141, $582 := $142, $583 := $143, $584 := $144, $585 := $221, $586 := $222, $587 := $223, $588 := $225", "INNER HASH JOIN EACH WITH ALL ON $141 = $220" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := subtract($660, coalesce($667, 0))", "$361 := subtract($661, coalesce($668, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$660 := $652, $661 := $653, $662 := $658, $663 := $654, $664 := $655, $665 := $656, $666 := $657, $667 := $52, $668 := $53", "LEFT OUTER HASH JOIN EACH WITH ALL ON $651 = $51, $650 = $50" ] }, { "kind": "JOIN", "substeps": [ "$650 := $631, $651 := $632, $652 := $633, $653 := $634, $654 := $635, $655 := $636, $656 := $637, $657 := $638, $658 := $171", "INNER HASH JOIN EACH WITH ALL ON $630 = $170" ] }, { "kind": "JOIN", "substeps": [ "$630 := $160, $631 := $161, $632 := $162, $633 := $163, $634 := $164, $635 := $231, $636 := $232, $637 := $233, $638 := $235", "INNER HASH JOIN EACH WITH ALL ON $161 = $230" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "TO __stage18_output", "BY HASH($670, $671, $672, $673, $674)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0031645569620253164, "writeMsAvg": "6", "writeMsMax": "22", "writeRatioAvg": 0.00949367088607595, "writeRatioMax": 0.03481012658227848 }, { "completedParallelInputs": "12", "computeMsAvg": "398", "computeMsMax": "632", "computeRatioAvg": 0.629746835443038, "computeRatioMax": 1, "endMs": "1665778563587", "id": "25", "inputStages": [ "18", "12", "20", "16", "17", "22", "13", "21", "14" ], "name": "S19: Join+", "parallelInputs": "12", "readMsAvg": "18", "readMsMax": "25", "readRatioAvg": 0.028481012658227847, "readRatioMax": 0.03955696202531646, "recordsRead": "7583694", "recordsWritten": "10287", "shuffleOutputBytes": "730185", "shuffleOutputBytesSpilled": "0", "slotMs": "5035", "startMs": "1665778563197", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$180, $181, $182, $183, $185", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$70, $71", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $195", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$90, $91", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage10_output" ] }, { "kind": "READ", "substeps": [ "$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $205", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294", "$270 := SUM($295)", "$271 := SUM($296)" ] }, { "kind": "COMPUTE", "substeps": [ "$310 := subtract($400, coalesce($407, 0))", "$311 := subtract($401, coalesce($408, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$400 := $392, $401 := $393, $402 := $398, $403 := $394, $404 := $395, $405 := $396, $406 := $397, $407 := $3, $408 := $4", "LEFT OUTER HASH JOIN EACH WITH ALL ON $391 = $2, $390 = $1" ] }, { "kind": "JOIN", "substeps": [ "$390 := $371, $391 := $372, $392 := $373, $393 := $374, $394 := $375, $395 := $376, $396 := $377, $397 := $378, $398 := $71", "INNER HASH JOIN EACH WITH ALL ON $370 = $70" ] }, { "kind": "JOIN", "substeps": [ "$370 := $60, $371 := $61, $372 := $62, $373 := $63, $374 := $64, $375 := $181, $376 := $182, $377 := $183, $378 := $185", "INNER HASH JOIN EACH WITH ALL ON $61 = $180" ] }, { "kind": "COMPUTE", "substeps": [ "$320 := subtract($450, coalesce($457, 0))", "$321 := subtract($451, coalesce($458, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$450 := $442, $451 := $443, $452 := $448, $453 := $444, $454 := $445, $455 := $446, $456 := $447, $457 := $12, $458 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $441 = $11, $440 = $10" ] }, { "kind": "JOIN", "substeps": [ "$440 := $421, $441 := $422, $442 := $423, $443 := $424, $444 := $425, $445 := $426, $446 := $427, $447 := $428, $448 := $91", "INNER HASH JOIN EACH WITH ALL ON $420 = $90" ] }, { "kind": "JOIN", "substeps": [ "$420 := $80, $421 := $81, $422 := $82, $423 := $83, $424 := $84, $425 := $191, $426 := $192, $427 := $193, $428 := $195", "INNER HASH JOIN EACH WITH ALL ON $81 = $190" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := subtract($500, coalesce($507, 0))", "$331 := subtract($501, coalesce($508, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$500 := $492, $501 := $493, $502 := $498, $503 := $494, $504 := $495, $505 := $496, $506 := $497, $507 := $22, $508 := $23", "LEFT OUTER HASH JOIN EACH WITH ALL ON $491 = $21, $490 = $20" ] }, { "kind": "JOIN", "substeps": [ "$490 := $471, $491 := $472, $492 := $473, $493 := $474, $494 := $475, $495 := $476, $496 := $477, $497 := $478, $498 := $111", "INNER HASH JOIN EACH WITH ALL ON $470 = $110" ] }, { "kind": "JOIN", "substeps": [ "$470 := $100, $471 := $101, $472 := $102, $473 := $103, $474 := $104, $475 := $201, $476 := $202, $477 := $203, $478 := $205", "INNER HASH JOIN EACH WITH ALL ON $101 = $200" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "TO __stage19_output", "BY HASH($510, $511, $512, $513, $514)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0031645569620253164, "waitRatioMax": 0.004746835443037975, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.006329113924050633, "writeRatioMax": 0.00949367088607595 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.03322784810126582, "computeRatioMax": 0.03322784810126582, "endMs": "1665778563643", "id": "26", "inputStages": [ "24" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "10588", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778563608", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $670, $671, $672, $673, $674", "FROM __stage18_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674", "$260 := SUM($280)", "$261 := SUM($281)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015822784810126582, "waitRatioMax": 0.0015822784810126582, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01740506329113924, "writeRatioMax": 0.01740506329113924 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.012658227848101266, "computeRatioMax": 0.022151898734177215, "endMs": "1665778563721", "id": "28", "inputStages": [ "26" ], "name": "S1C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "881", "recordsWritten": "881", "shuffleOutputBytes": "62551", "shuffleOutputBytesSpilled": "0", "slotMs": "4277", "startMs": "1665778563656", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0031645569620253164, "waitRatioMax": 0.004746835443037975, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.023734177215189875, "writeRatioMax": 0.030063291139240507 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.02689873417721519, "computeRatioMax": 0.02689873417721519, "endMs": "1665778563733", "id": "29", "inputStages": [ "25", "28" ], "name": "S1D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11168", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "92", "startMs": "1665778563661", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $510, $511, $512, $513, $514", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $680, $681, $682, $683, $684", "FROM __stage1C_output" ] }, { "kind": "SORT", "substeps": [ "$240 ASC, $241 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := subtract($690, $697)", "$241 := subtract($691, $698)" ] }, { "kind": "FILTER", "substeps": [ "less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)" ] }, { "kind": "JOIN", "substeps": [ "$690 := $250, $691 := $251, $692 := $520, $693 := $521, $694 := $522, $695 := $523, $696 := $524, $697 := $260, $698 := $261, $699 := $680", "INNER HASH JOIN EACH WITH ALL ON $521 = $681, $522 = $682, $523 = $683, $524 = $684" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514", "$250 := SUM($270)", "$251 := SUM($271)" ] }, { "kind": "WRITE", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "TO __stage1D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004746835443037975, "waitRatioMax": 0.004746835443037975, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0031645569620253164, "writeRatioMax": 0.0031645569620253164 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.014240506329113924, "computeRatioMax": 0.014240506329113924, "endMs": "1665778563739", "id": "30", "inputStages": [ "29" ], "name": "S1E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9800", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778563671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$700, $701, $702, $703, $704, $705, $706, $707, $708, $709", "FROM __stage1D_output" ] }, { "kind": "SORT", "substeps": [ "$700 ASC, $701 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$710, $711, $712, $713, $714, $715, $716, $717, $718, $719", "TO __stage1E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004746835443037975, "waitRatioMax": 0.004746835443037975, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.004746835443037975, "writeRatioMax": 0.004746835443037975 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "21", "completedUnits": "21", "elapsedMs": "661", "estimatedRunnableUnits": "0", "pendingUnits": "21", "totalSlotMs": "3441" }, { "activeUnits": "2", "completedUnits": "145", "elapsedMs": "1242", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "16529" } ], "totalBytesBilled": "260046848", "totalBytesProcessed": "259359179", "totalPartitionsProcessed": "0", "totalSlotMs": "16529", "transferredBytes": "0" }, "startTime": "1665778562559", "totalBytesProcessed": "259359179", "totalSlotMs": "16529" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
