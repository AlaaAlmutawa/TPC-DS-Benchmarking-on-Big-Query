{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon579b5da1_9c2d_4643_87a1_764aa1f4ad65" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,extended_price\n ,extended_tax\n ,list_price\n from (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_ext_sales_price) extended_price \n ,sum(ss_ext_list_price) list_price\n ,sum(ss_ext_tax) extended_tax \n from store_sales\n ,date_dim\n ,store\n ,household_demographics\n ,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_dep_count = 3 or\n household_demographics.hd_vehicle_count= 4)\n and date_dim.d_year in (1998,1998+1,1998+2)\n and store.s_city in ('Fairview','Midway')\n group by ss_ticket_number\n ,ss_customer_sk\n ,ss_addr_sk,ca_city) dn\n ,customer\n ,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,ss_ticket_number\n limit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "TOfqcuVDZIRJXKIYILXlJw==", "id": "test-project-364309:europe-west1.query68_1665768433", "jobReference": { "jobId": "query68_1665768433", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query68_1665768433?location=europe-west1", "statistics": { "creationTime": "1665768433906", "endTime": "1665768435252", "finalExecutionDurationMs": "1096", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "271067796", "performanceInsights": { "avgPreviousExecutionMs": "780" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.041561712846347604, "computeRatioMax": 0.041561712846347604, "endMs": "1665768434167", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.011335012594458438, "readRatioMax": 0.011335012594458438, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768434123", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0025188916876574307, "waitRatioMax": 0.0025188916876574307, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0163727959697733, "writeRatioMax": 0.0163727959697733 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012594458438287154, "computeRatioMax": 0.012594458438287154, "endMs": "1665768434181", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005037783375314861, "readRatioMax": 0.005037783375314861, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768434144", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 3), equal($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0025188916876574307, "waitRatioMax": 0.0025188916876574307, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.031486146095717885, "writeRatioMax": 0.031486146095717885 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.013853904282115869, "computeRatioMax": 0.013853904282115869, "endMs": "1665768434198", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.010075566750629723, "readRatioMax": 0.010075566750629723, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768434160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Midway')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0025188916876574307, "waitRatioMax": 0.0025188916876574307, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.011335012594458438, "writeRatioMax": 0.011335012594458438 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.017632241813602016, "computeRatioMax": 0.017632241813602016, "endMs": "1665768434346", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008816120906801008, "readRatioMax": 0.008816120906801008, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "144", "startMs": "1665768434177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dom", "FROM date_dim", "WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0025188916876574307, "waitRatioMax": 0.0025188916876574307, "writeMsAvg": "153", "writeMsMax": "153", "writeRatioAvg": 0.19269521410579346, "writeRatioMax": 0.19269521410579346 }, { "completedParallelInputs": "6", "computeMsAvg": "582", "computeMsMax": "794", "computeRatioAvg": 0.7329974811083123, "computeRatioMax": 1, "endMs": "1665768434931", "id": "5", "inputStages": [ "3", "2", "0", "1" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "30", "readMsMax": "40", "readRatioAvg": 0.037783375314861464, "readRatioMax": 0.05037783375314862, "recordsRead": "3191708", "recordsWritten": "11531", "shuffleOutputBytes": "1052847", "shuffleOutputBytesSpilled": "0", "slotMs": "2904", "startMs": "1665768434384", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146", "$80 := SUM($143)", "$81 := SUM($144)", "$82 := SUM($145)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $135, $146 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115, $135 := $116", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96, $116 := $97", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47, $97 := $48", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012594458438287153, "waitRatioMax": 0.0012594458438287153, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.006297229219143577, "writeRatioMax": 0.006297229219143577 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.03904282115869018, "computeRatioMax": 0.03904282115869018, "endMs": "1665768435021", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.013853904282115869, "readRatioMax": 0.013853904282115869, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768434976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012594458438287153, "waitRatioMax": 0.0012594458438287153, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.015113350125944584, "writeRatioMax": 0.015113350125944584 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.0327455919395466, "computeRatioMax": 0.0327455919395466, "endMs": "1665768435054", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11531", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768435008", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)", "$72 := SUM($82)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012594458438287153, "waitRatioMax": 0.0012594458438287153, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0163727959697733, "writeRatioMax": 0.0163727959697733 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.010075566750629723, "computeRatioMax": 0.020151133501259445, "endMs": "1665768435104", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2249", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "2899", "startMs": "1665768435060", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0025188916876574307, "waitRatioMax": 0.003778337531486146, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.017632241813602016, "writeRatioMax": 0.028967254408060455 }, { "completedParallelInputs": "1", "computeMsAvg": "68", "computeMsMax": "68", "computeRatioAvg": 0.08564231738035265, "computeRatioMax": 0.08564231738035265, "endMs": "1665768435158", "id": "10", "inputStages": [ "6", "9" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.010075566750629723, "readRatioMax": 0.010075566750629723, "recordsRead": "152249", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665768435065", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($187, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $176, $181 := $177, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $174, $187 := $2", "INNER HASH JOIN EACH WITH ALL ON $175 = $1" ] }, { "kind": "JOIN", "substeps": [ "$175 := $11, $176 := $12, $177 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71, $174 := $72", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "TO __stage0A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.005037783375314861, "waitRatioMax": 0.005037783375314861, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0012594458438287153, "writeRatioMax": 0.0012594458438287153 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0163727959697733, "computeRatioMax": 0.0163727959697733, "endMs": "1665768435169", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665768435078", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012594458438287153, "waitRatioMax": 0.0012594458438287153, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.007556675062972292, "writeRatioMax": 0.007556675062972292 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "4", "elapsedMs": "668", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "499" }, { "activeUnits": "2", "completedUnits": "114", "elapsedMs": "1249", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6290" } ], "totalBytesBilled": "271581184", "totalBytesProcessed": "271067796", "totalPartitionsProcessed": "0", "totalSlotMs": "6290", "transferredBytes": "0" }, "startTime": "1665768433957", "totalBytesProcessed": "271067796", "totalSlotMs": "6290" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2b7ec3e3_f83c_4774_9257_03e768175226" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,extended_price\n ,extended_tax\n ,list_price\n from (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_ext_sales_price) extended_price \n ,sum(ss_ext_list_price) list_price\n ,sum(ss_ext_tax) extended_tax \n from store_sales\n ,date_dim\n ,store\n ,household_demographics\n ,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_dep_count = 3 or\n household_demographics.hd_vehicle_count= 4)\n and date_dim.d_year in (1998,1998+1,1998+2)\n and store.s_city in ('Fairview','Midway')\n group by ss_ticket_number\n ,ss_customer_sk\n ,ss_addr_sk,ca_city) dn\n ,customer\n ,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,ss_ticket_number\n limit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NjEuRKh01tArVBhfC3mufw==", "id": "test-project-364309:europe-west1.query68_1665778397", "jobReference": { "jobId": "query68_1665778397", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query68_1665778397?location=europe-west1", "statistics": { "creationTime": "1665778398356", "endTime": "1665778399294", "finalExecutionDurationMs": "744", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "271067796", "performanceInsights": { "avgPreviousExecutionMs": "833" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.03636363636363636, "computeRatioMax": 0.03636363636363636, "endMs": "1665778398536", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011570247933884297, "readRatioMax": 0.011570247933884297, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778398502", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.019834710743801654, "writeRatioMax": 0.019834710743801654 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.013223140495867768, "computeRatioMax": 0.013223140495867768, "endMs": "1665778398544", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008264462809917356, "readRatioMax": 0.008264462809917356, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778398513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 3), equal($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.011570247933884297, "writeRatioMax": 0.011570247933884297 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.009917355371900827, "computeRatioMax": 0.009917355371900827, "endMs": "1665778398566", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006611570247933884, "readRatioMax": 0.006611570247933884, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778398528", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Midway')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.02809917355371901, "writeRatioMax": 0.02809917355371901 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.011570247933884297, "computeRatioMax": 0.011570247933884297, "endMs": "1665778398573", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008264462809917356, "readRatioMax": 0.008264462809917356, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778398539", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dom", "FROM date_dim", "WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01818181818181818, "writeRatioMax": 0.01818181818181818 }, { "completedParallelInputs": "6", "computeMsAvg": "516", "computeMsMax": "605", "computeRatioAvg": 0.8528925619834711, "computeRatioMax": 1, "endMs": "1665778399031", "id": "5", "inputStages": [ "1", "2", "3", "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "36", "readMsMax": "55", "readRatioAvg": 0.05950413223140496, "readRatioMax": 0.09090909090909091, "recordsRead": "3191708", "recordsWritten": "11531", "shuffleOutputBytes": "1052847", "shuffleOutputBytesSpilled": "0", "slotMs": "3897", "startMs": "1665778398586", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146", "$80 := SUM($143)", "$81 := SUM($144)", "$82 := SUM($145)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $135, $146 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115, $135 := $116", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96, $116 := $97", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47, $97 := $48", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.009917355371900827, "writeRatioMax": 0.013223140495867768 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.06942148760330578, "computeRatioMax": 0.06942148760330578, "endMs": "1665778399109", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.013223140495867768, "readRatioMax": 0.013223140495867768, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778399067", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01652892561983471, "writeRatioMax": 0.01652892561983471 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.04132231404958678, "computeRatioMax": 0.04132231404958678, "endMs": "1665778399122", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11531", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778399089", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)", "$72 := SUM($82)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.001652892561983471, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013223140495867768, "writeRatioMax": 0.013223140495867768 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.011570247933884297, "computeRatioMax": 0.019834710743801654, "endMs": "1665778399175", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2249", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "2735", "startMs": "1665778399130", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.001652892561983471, "waitRatioMax": 0.0049586776859504135, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.023140495867768594, "writeRatioMax": 0.03140495867768595 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.06611570247933884, "computeRatioMax": 0.06611570247933884, "endMs": "1665778399201", "id": "10", "inputStages": [ "6", "9" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009917355371900827, "readRatioMax": 0.009917355371900827, "recordsRead": "152249", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665778399134", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($187, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $176, $181 := $177, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $174, $187 := $2", "INNER HASH JOIN EACH WITH ALL ON $175 = $1" ] }, { "kind": "JOIN", "substeps": [ "$175 := $11, $176 := $12, $177 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71, $174 := $72", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0049586776859504135, "waitRatioMax": 0.0049586776859504135, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001652892561983471, "writeRatioMax": 0.001652892561983471 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.013223140495867768, "computeRatioMax": 0.013223140495867768, "endMs": "1665778399210", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778399142", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003305785123966942, "waitRatioMax": 0.003305785123966942, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0049586776859504135, "writeRatioMax": 0.0049586776859504135 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "9", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3933" }, { "activeUnits": "2", "completedUnits": "114", "elapsedMs": "849", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6987" } ], "totalBytesBilled": "271581184", "totalBytesProcessed": "271067796", "totalPartitionsProcessed": "0", "totalSlotMs": "6987", "transferredBytes": "0" }, "startTime": "1665778398399", "totalBytesProcessed": "271067796", "totalSlotMs": "6987" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3e220df1_de9a_4cb4_b715_dcd46d31daa0" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,extended_price\n ,extended_tax\n ,list_price\n from (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_ext_sales_price) extended_price \n ,sum(ss_ext_list_price) list_price\n ,sum(ss_ext_tax) extended_tax \n from store_sales\n ,date_dim\n ,store\n ,household_demographics\n ,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_dep_count = 3 or\n household_demographics.hd_vehicle_count= 4)\n and date_dim.d_year in (1998,1998+1,1998+2)\n and store.s_city in ('Fairview','Midway')\n group by ss_ticket_number\n ,ss_customer_sk\n ,ss_addr_sk,ca_city) dn\n ,customer\n ,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,ss_ticket_number\n limit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "JotdFCtJhErtCP95h+ZZ3A==", "id": "test-project-364309:europe-west1.query68_1665778400", "jobReference": { "jobId": "query68_1665778400", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query68_1665778400?location=europe-west1", "statistics": { "creationTime": "1665778401524", "endTime": "1665778402596", "finalExecutionDurationMs": "814", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "271067796", "performanceInsights": { "avgPreviousExecutionMs": "820" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.046831955922865015, "computeRatioMax": 0.046831955922865015, "endMs": "1665778401757", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008264462809917356, "readRatioMax": 0.008264462809917356, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778401721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013774104683195593, "waitRatioMax": 0.0013774104683195593, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.013774104683195593, "writeRatioMax": 0.013774104683195593 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013774104683195593, "computeRatioMax": 0.013774104683195593, "endMs": "1665778401781", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006887052341597796, "readRatioMax": 0.006887052341597796, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778401738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 3), equal($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0027548209366391185, "waitRatioMax": 0.0027548209366391185, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.024793388429752067, "writeRatioMax": 0.024793388429752067 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013774104683195593, "computeRatioMax": 0.013774104683195593, "endMs": "1665778401780", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006887052341597796, "readRatioMax": 0.006887052341597796, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778401752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Midway')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013774104683195593, "waitRatioMax": 0.0013774104683195593, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.02066115702479339, "writeRatioMax": 0.02066115702479339 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01790633608815427, "computeRatioMax": 0.01790633608815427, "endMs": "1665778401819", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.012396694214876033, "readRatioMax": 0.012396694214876033, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778401781", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dom", "FROM date_dim", "WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "15", "waitMsMax": "15", "waitRatioAvg": 0.02066115702479339, "waitRatioMax": 0.02066115702479339, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.009641873278236915, "writeRatioMax": 0.009641873278236915 }, { "completedParallelInputs": "6", "computeMsAvg": "571", "computeMsMax": "726", "computeRatioAvg": 0.7865013774104683, "computeRatioMax": 1, "endMs": "1665778402307", "id": "5", "inputStages": [ "1", "0", "3", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "47", "readRatioAvg": 0.03856749311294766, "readRatioMax": 0.06473829201101929, "recordsRead": "3191708", "recordsWritten": "11531", "shuffleOutputBytes": "1052847", "shuffleOutputBytesSpilled": "0", "slotMs": "3113", "startMs": "1665778401830", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146", "$80 := SUM($143)", "$81 := SUM($144)", "$82 := SUM($145)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $135, $146 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115, $135 := $116", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96, $116 := $97", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47, $97 := $48", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013774104683195593, "waitRatioMax": 0.0013774104683195593, "writeMsAvg": "6", "writeMsMax": "10", "writeRatioAvg": 0.008264462809917356, "writeRatioMax": 0.013774104683195593 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.03168044077134986, "computeRatioMax": 0.03168044077134986, "endMs": "1665778402361", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008264462809917356, "readRatioMax": 0.008264462809917356, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778402328", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013774104683195593, "waitRatioMax": 0.0013774104683195593, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.015151515151515152, "writeRatioMax": 0.015151515151515152 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.026170798898071626, "computeRatioMax": 0.026170798898071626, "endMs": "1665778402396", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11531", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778402360", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)", "$72 := SUM($82)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013774104683195593, "waitRatioMax": 0.0013774104683195593, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.028925619834710745, "writeRatioMax": 0.028925619834710745 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.012396694214876033, "computeRatioMax": 0.028925619834710745, "endMs": "1665778402465", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2249", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "4388", "startMs": "1665778402401", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.005509641873278237, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.02203856749311295, "writeRatioMax": 0.03994490358126722 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.06198347107438017, "computeRatioMax": 0.06198347107438017, "endMs": "1665778402493", "id": "10", "inputStages": [ "9", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009641873278236915, "readRatioMax": 0.009641873278236915, "recordsRead": "152249", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665778402407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($187, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $176, $181 := $177, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $174, $187 := $2", "INNER HASH JOIN EACH WITH ALL ON $175 = $1" ] }, { "kind": "JOIN", "substeps": [ "$175 := $11, $176 := $12, $177 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71, $174 := $72", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "TO __stage0A_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.006887052341597796, "waitRatioMax": 0.006887052341597796, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0013774104683195593, "writeRatioMax": 0.0013774104683195593 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009641873278236915, "computeRatioMax": 0.009641873278236915, "endMs": "1665778402499", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778402418", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004132231404958678, "waitRatioMax": 0.004132231404958678, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.005509641873278237, "writeRatioMax": 0.005509641873278237 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "9", "elapsedMs": "640", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2625" }, { "activeUnits": "2", "completedUnits": "114", "elapsedMs": "952", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7839" } ], "totalBytesBilled": "271581184", "totalBytesProcessed": "271067796", "totalPartitionsProcessed": "0", "totalSlotMs": "7839", "transferredBytes": "0" }, "startTime": "1665778401583", "totalBytesProcessed": "271067796", "totalSlotMs": "7839" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon883ebe6a_ee98_4fdc_9e4b_1ae2901672a3" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,extended_price\n ,extended_tax\n ,list_price\n from (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_ext_sales_price) extended_price \n ,sum(ss_ext_list_price) list_price\n ,sum(ss_ext_tax) extended_tax \n from store_sales\n ,date_dim\n ,store\n ,household_demographics\n ,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_dep_count = 3 or\n household_demographics.hd_vehicle_count= 4)\n and date_dim.d_year in (1998,1998+1,1998+2)\n and store.s_city in ('Fairview','Midway')\n group by ss_ticket_number\n ,ss_customer_sk\n ,ss_addr_sk,ca_city) dn\n ,customer\n ,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,ss_ticket_number\n limit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "cAMvHnhR5ECLsOPbaAmavg==", "id": "test-project-364309:europe-west1.query68_1665778403", "jobReference": { "jobId": "query68_1665778403", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query68_1665778403?location=europe-west1", "statistics": { "creationTime": "1665778404515", "endTime": "1665778405473", "finalExecutionDurationMs": "727", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "271067796", "performanceInsights": { "avgPreviousExecutionMs": "819" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.047540983606557376, "computeRatioMax": 0.047540983606557376, "endMs": "1665778404729", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.013114754098360656, "readRatioMax": 0.013114754098360656, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778404688", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.022950819672131147, "writeRatioMax": 0.022950819672131147 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.022950819672131147, "computeRatioMax": 0.022950819672131147, "endMs": "1665778404739", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00819672131147541, "readRatioMax": 0.00819672131147541, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778404704", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 3), equal($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.014754098360655738, "writeRatioMax": 0.014754098360655738 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.013114754098360656, "computeRatioMax": 0.013114754098360656, "endMs": "1665778404761", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006557377049180328, "readRatioMax": 0.006557377049180328, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778404720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Midway')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.027868852459016394, "writeRatioMax": 0.027868852459016394 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.03114754098360656, "computeRatioMax": 0.03114754098360656, "endMs": "1665778404780", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.014754098360655738, "readRatioMax": 0.014754098360655738, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778404740", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dom", "FROM date_dim", "WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.009836065573770493, "waitRatioMax": 0.009836065573770493, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.011475409836065573, "writeRatioMax": 0.011475409836065573 }, { "completedParallelInputs": "6", "computeMsAvg": "504", "computeMsMax": "610", "computeRatioAvg": 0.8262295081967214, "computeRatioMax": 1, "endMs": "1665778405132", "id": "5", "inputStages": [ "1", "3", "0", "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "37", "readRatioAvg": 0.047540983606557376, "readRatioMax": 0.060655737704918035, "recordsRead": "3191708", "recordsWritten": "11531", "shuffleOutputBytes": "1052847", "shuffleOutputBytesSpilled": "0", "slotMs": "2356", "startMs": "1665778404794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146", "$80 := SUM($143)", "$81 := SUM($144)", "$82 := SUM($145)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $135, $146 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115, $135 := $116", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96, $116 := $97", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47, $97 := $48", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003278688524590164, "waitRatioMax": 0.003278688524590164, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.006557377049180328, "writeRatioMax": 0.00819672131147541 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.036065573770491806, "computeRatioMax": 0.036065573770491806, "endMs": "1665778405207", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00819672131147541, "readRatioMax": 0.00819672131147541, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778405163", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.018032786885245903, "writeRatioMax": 0.018032786885245903 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.029508196721311476, "computeRatioMax": 0.029508196721311476, "endMs": "1665778405259", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11531", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665778405192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)", "$72 := SUM($82)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "52", "writeMsMax": "52", "writeRatioAvg": 0.08524590163934426, "writeRatioMax": 0.08524590163934426 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.011475409836065573, "computeRatioMax": 0.021311475409836064, "endMs": "1665778405324", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2249", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "3247", "startMs": "1665778405270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.003278688524590164, "waitRatioMax": 0.006557377049180328, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.022950819672131147, "writeRatioMax": 0.029508196721311476 }, { "completedParallelInputs": "1", "computeMsAvg": "50", "computeMsMax": "50", "computeRatioAvg": 0.08196721311475409, "computeRatioMax": 0.08196721311475409, "endMs": "1665778405355", "id": "10", "inputStages": [ "6", "9" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011475409836065573, "readRatioMax": 0.011475409836065573, "recordsRead": "152249", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665778405279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($187, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $176, $181 := $177, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $174, $187 := $2", "INNER HASH JOIN EACH WITH ALL ON $175 = $1" ] }, { "kind": "JOIN", "substeps": [ "$175 := $11, $176 := $12, $177 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71, $174 := $72", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "TO __stage0A_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.006557377049180328, "waitRatioMax": 0.006557377049180328, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001639344262295082, "writeRatioMax": 0.001639344262295082 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01639344262295082, "computeRatioMax": 0.01639344262295082, "endMs": "1665778405377", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665778405292", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.009836065573770493, "writeRatioMax": 0.009836065573770493 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "10", "elapsedMs": "625", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "2552" }, { "activeUnits": "2", "completedUnits": "114", "elapsedMs": "852", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6157" } ], "totalBytesBilled": "271581184", "totalBytesProcessed": "271067796", "totalPartitionsProcessed": "0", "totalSlotMs": "6157", "transferredBytes": "0" }, "startTime": "1665778404565", "totalBytesProcessed": "271067796", "totalSlotMs": "6157" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon54fe49f7_8b49_4975_a9b5_678500cacf7c" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,extended_price\n ,extended_tax\n ,list_price\n from (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_ext_sales_price) extended_price \n ,sum(ss_ext_list_price) list_price\n ,sum(ss_ext_tax) extended_tax \n from store_sales\n ,date_dim\n ,store\n ,household_demographics\n ,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_dep_count = 3 or\n household_demographics.hd_vehicle_count= 4)\n and date_dim.d_year in (1998,1998+1,1998+2)\n and store.s_city in ('Fairview','Midway')\n group by ss_ticket_number\n ,ss_customer_sk\n ,ss_addr_sk,ca_city) dn\n ,customer\n ,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,ss_ticket_number\n limit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "eJHwv9TIQLuSnStxtDlc0w==", "id": "test-project-364309:europe-west1.query68_1665778406", "jobReference": { "jobId": "query68_1665778406", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query68_1665778406?location=europe-west1", "statistics": { "creationTime": "1665778407519", "endTime": "1665778408398", "finalExecutionDurationMs": "640", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "271067796", "performanceInsights": { "avgPreviousExecutionMs": "809" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.07956989247311828, "computeRatioMax": 0.07956989247311828, "endMs": "1665778407738", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012903225806451613, "readRatioMax": 0.012903225806451613, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778407704", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002150537634408602, "waitRatioMax": 0.002150537634408602, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01935483870967742, "writeRatioMax": 0.01935483870967742 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03225806451612903, "computeRatioMax": 0.03225806451612903, "endMs": "1665778407754", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010752688172043012, "readRatioMax": 0.010752688172043012, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778407719", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 3), equal($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004301075268817204, "waitRatioMax": 0.004301075268817204, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.017204301075268817, "writeRatioMax": 0.017204301075268817 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.021505376344086023, "computeRatioMax": 0.021505376344086023, "endMs": "1665778407775", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015053763440860216, "readRatioMax": 0.015053763440860216, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778407734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Midway')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002150537634408602, "waitRatioMax": 0.002150537634408602, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.017204301075268817, "computeRatioMax": 0.017204301075268817, "endMs": "1665778407773", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010752688172043012, "readRatioMax": 0.010752688172043012, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778407747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dom", "FROM date_dim", "WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002150537634408602, "waitRatioMax": 0.002150537634408602, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.030107526881720432, "writeRatioMax": 0.030107526881720432 }, { "completedParallelInputs": "6", "computeMsAvg": "419", "computeMsMax": "465", "computeRatioAvg": 0.9010752688172043, "computeRatioMax": 1, "endMs": "1665778408092", "id": "6", "inputStages": [ "3", "0", "2", "1" ], "name": "S06: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "33", "readRatioAvg": 0.06236559139784946, "readRatioMax": 0.07096774193548387, "recordsRead": "3191708", "recordsWritten": "11531", "shuffleOutputBytes": "1052847", "shuffleOutputBytesSpilled": "0", "slotMs": "2329", "startMs": "1665778407792", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146", "$80 := SUM($143)", "$81 := SUM($144)", "$82 := SUM($145)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $135, $146 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115, $135 := $116", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96, $116 := $97", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47, $97 := $48", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "TO __stage06_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002150537634408602, "waitRatioMax": 0.002150537634408602, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.010752688172043012, "writeRatioMax": 0.012903225806451613 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.060215053763440864, "computeRatioMax": 0.060215053763440864, "endMs": "1665778408151", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010752688172043012, "readRatioMax": 0.010752688172043012, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665778408119", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002150537634408602, "waitRatioMax": 0.002150537634408602, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01935483870967742, "writeRatioMax": 0.01935483870967742 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.06236559139784946, "computeRatioMax": 0.06236559139784946, "endMs": "1665778408188", "id": "9", "inputStages": [ "6" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11531", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778408150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)", "$72 := SUM($82)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $160, $161, $163", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002150537634408602, "waitRatioMax": 0.002150537634408602, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.015053763440860216, "writeRatioMax": 0.015053763440860216 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.017204301075268817, "computeRatioMax": 0.030107526881720432, "endMs": "1665778408259", "id": "10", "inputStages": [ "9" ], "name": "S0A: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2249", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "3860", "startMs": "1665778408197", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002150537634408602, "waitRatioMax": 0.004301075268817204, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.053763440860215055 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.11827956989247312, "computeRatioMax": 0.11827956989247312, "endMs": "1665778408301", "id": "11", "inputStages": [ "7", "10" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015053763440860216, "readRatioMax": 0.015053763440860216, "recordsRead": "152249", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778408201", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $160, $161, $163", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($187, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $176, $181 := $177, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $174, $187 := $2", "INNER HASH JOIN EACH WITH ALL ON $175 = $1" ] }, { "kind": "JOIN", "substeps": [ "$175 := $11, $176 := $12, $177 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71, $174 := $72", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "TO __stage0B_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002150537634408602, "writeRatioMax": 0.002150537634408602 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.012903225806451613, "computeRatioMax": 0.012903225806451613, "endMs": "1665778408311", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778408212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207", "TO __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0064516129032258064, "waitRatioMax": 0.0064516129032258064, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.010752688172043012, "writeRatioMax": 0.010752688172043012 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "101", "completedUnits": "12", "elapsedMs": "621", "estimatedRunnableUnits": "0", "pendingUnits": "102", "totalSlotMs": "2586" }, { "activeUnits": "101", "completedUnits": "114", "elapsedMs": "757", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6537" } ], "totalBytesBilled": "271581184", "totalBytesProcessed": "271067796", "totalPartitionsProcessed": "0", "totalSlotMs": "6537", "transferredBytes": "0" }, "startTime": "1665778407585", "totalBytesProcessed": "271067796", "totalSlotMs": "6537" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3308b3e0_2710_46ed_84ef_859f47c96f0e" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,ca_city\n ,bought_city\n ,ss_ticket_number\n ,extended_price\n ,extended_tax\n ,list_price\n from (select ss_ticket_number\n ,ss_customer_sk\n ,ca_city bought_city\n ,sum(ss_ext_sales_price) extended_price \n ,sum(ss_ext_list_price) list_price\n ,sum(ss_ext_tax) extended_tax \n from store_sales\n ,date_dim\n ,store\n ,household_demographics\n ,customer_address \n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and store_sales.ss_addr_sk = customer_address.ca_address_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_dep_count = 3 or\n household_demographics.hd_vehicle_count= 4)\n and date_dim.d_year in (1998,1998+1,1998+2)\n and store.s_city in ('Fairview','Midway')\n group by ss_ticket_number\n ,ss_customer_sk\n ,ss_addr_sk,ca_city) dn\n ,customer\n ,customer_address current_addr\n where ss_customer_sk = c_customer_sk\n and customer.c_current_addr_sk = current_addr.ca_address_sk\n and current_addr.ca_city <> bought_city\n order by c_last_name\n ,ss_ticket_number\n limit 100;\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "uSWACcA+JBzQ5Mgxu7k/TA==", "id": "test-project-364309:europe-west1.query68_1665778409", "jobReference": { "jobId": "query68_1665778409", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query68_1665778409?location=europe-west1", "statistics": { "creationTime": "1665778410222", "endTime": "1665778411121", "finalExecutionDurationMs": "677", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "271067796", "performanceInsights": { "avgPreviousExecutionMs": "792" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.05921052631578947, "computeRatioMax": 0.05921052631578947, "endMs": "1665778410431", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.019736842105263157, "readRatioMax": 0.019736842105263157, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778410394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ca_address_sk, $21:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0043859649122807015, "waitRatioMax": 0.0043859649122807015, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.02412280701754386, "writeRatioMax": 0.02412280701754386 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.010964912280701754, "computeRatioMax": 0.010964912280701754, "endMs": "1665778410437", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008771929824561403, "readRatioMax": 0.008771929824561403, "recordsRead": "7200", "recordsWritten": "1800", "shuffleOutputBytes": "16200", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778410412", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count", "FROM household_demographics", "WHERE or(equal($31, 3), equal($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021929824561403508, "waitRatioMax": 0.0021929824561403508, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03289473684210526, "writeRatioMax": 0.03289473684210526 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.02631578947368421, "endMs": "1665778410456", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.008771929824561403, "readRatioMax": 0.008771929824561403, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778410427", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:s_store_sk, $51:s_city", "FROM store", "WHERE in($51, 'Fairview', 'Midway')" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0043859649122807015, "waitRatioMax": 0.0043859649122807015, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.03728070175438596, "writeRatioMax": 0.03728070175438596 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02850877192982456, "computeRatioMax": 0.02850877192982456, "endMs": "1665778410482", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015350877192982455, "readRatioMax": 0.015350877192982455, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778410441", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_dom", "FROM date_dim", "WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0043859649122807015, "waitRatioMax": 0.0043859649122807015, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02850877192982456, "writeRatioMax": 0.02850877192982456 }, { "completedParallelInputs": "6", "computeMsAvg": "408", "computeMsMax": "456", "computeRatioAvg": 0.8947368421052632, "computeRatioMax": 1, "endMs": "1665778410806", "id": "5", "inputStages": [ "3", "1", "2", "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "27", "readMsMax": "32", "readRatioAvg": 0.05921052631578947, "readRatioMax": 0.07017543859649122, "recordsRead": "3191708", "recordsWritten": "11531", "shuffleOutputBytes": "1052847", "shuffleOutputBytesSpilled": "0", "slotMs": "2287", "startMs": "1665778410495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146", "$80 := SUM($143)", "$81 := SUM($144)", "$82 := SUM($145)" ] }, { "kind": "JOIN", "substeps": [ "$140 := $130, $141 := $131, $142 := $132, $143 := $133, $144 := $134, $145 := $135, $146 := $21", "INNER HASH JOIN EACH WITH ALL ON $131 = $20" ] }, { "kind": "JOIN", "substeps": [ "$130 := $110, $131 := $112, $132 := $113, $133 := $114, $134 := $115, $135 := $116", "INNER HASH JOIN EACH WITH ALL ON $111 = $30" ] }, { "kind": "JOIN", "substeps": [ "$110 := $90, $111 := $91, $112 := $92, $113 := $94, $114 := $95, $115 := $96, $116 := $97", "INNER HASH JOIN EACH WITH ALL ON $93 = $50" ] }, { "kind": "JOIN", "substeps": [ "$90 := $41, $91 := $42, $92 := $43, $93 := $44, $94 := $45, $95 := $46, $96 := $47, $97 := $48", "INNER HASH JOIN EACH WITH ALL ON $40 = $60" ] }, { "kind": "WRITE", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "TO __stage05_output", "BY HASH($150, $151, $152, $153)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0021929824561403508, "waitRatioMax": 0.0043859649122807015, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.008771929824561403, "writeRatioMax": 0.013157894736842105 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.06359649122807018, "computeRatioMax": 0.06359649122807018, "endMs": "1665778410862", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013157894736842105, "readRatioMax": 0.013157894736842105, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1127489", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778410826", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ca_address_sk, $2:ca_city", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021929824561403508, "waitRatioMax": 0.0021929824561403508, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02850877192982456, "writeRatioMax": 0.02850877192982456 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03289473684210526, "computeRatioMax": 0.03289473684210526, "endMs": "1665778410894", "id": "8", "inputStages": [ "5" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11531", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778410857", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$153, $151, $152, $150, $80, $81, $82", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153", "$70 := SUM($80)", "$71 := SUM($81)", "$72 := SUM($82)" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72, $160, $161, $163", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0043859649122807015, "waitRatioMax": 0.0043859649122807015, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.021929824561403508, "writeRatioMax": 0.021929824561403508 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.017543859649122806, "computeRatioMax": 0.039473684210526314, "endMs": "1665778410970", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2249", "recordsWritten": "2249", "shuffleOutputBytes": "185586", "shuffleOutputBytesSpilled": "0", "slotMs": "3517", "startMs": "1665778410909", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.010964912280701754, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.03289473684210526, "writeRatioMax": 0.05701754385964912 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.08771929824561403, "computeRatioMax": 0.08771929824561403, "endMs": "1665778411007", "id": "10", "inputStages": [ "6", "9" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013157894736842105, "readRatioMax": 0.013157894736842105, "recordsRead": "152249", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "98", "startMs": "1665778410915", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72, $160, $161, $163", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$181 ASC, $183 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "not_equal($187, $182)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $176, $181 := $177, $182 := $170, $183 := $171, $184 := $172, $185 := $173, $186 := $174, $187 := $2", "INNER HASH JOIN EACH WITH ALL ON $175 = $1" ] }, { "kind": "JOIN", "substeps": [ "$175 := $11, $176 := $12, $177 := $13, $170 := $163, $171 := $160, $172 := $70, $173 := $71, $174 := $72", "INNER HASH JOIN EACH WITH ALL ON $10 = $161" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "TO __stage0A_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.010964912280701754, "waitRatioMax": 0.010964912280701754, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0021929824561403508, "writeRatioMax": 0.0021929824561403508 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.019736842105263157, "computeRatioMax": 0.019736842105263157, "endMs": "1665778411023", "id": "11", "inputStages": [ "10" ], "name": "S0B: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "9922", "shuffleOutputBytesSpilled": "0", "slotMs": "104", "startMs": "1665778410928", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197", "FROM __stage0A_output" ] }, { "kind": "SORT", "substeps": [ "$192 ASC, $194 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207", "TO __stage0B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.008771929824561403, "waitRatioMax": 0.008771929824561403, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.019736842105263157, "writeRatioMax": 0.019736842105263157 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "11", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "2481" }, { "activeUnits": "1", "completedUnits": "114", "elapsedMs": "802", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6237" } ], "totalBytesBilled": "271581184", "totalBytesProcessed": "271067796", "totalPartitionsProcessed": "0", "totalSlotMs": "6237", "transferredBytes": "0" }, "startTime": "1665778410269", "totalBytesProcessed": "271067796", "totalSlotMs": "6237" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
