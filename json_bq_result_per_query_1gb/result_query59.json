{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9976800a_b99d_48c2_8b53_ff962ae6b7f6" }, "priority": "INTERACTIVE", "query": "-- start query 59 in stream 0 using template query59.tpl\n\n/*\nReport the increase of weekly store sales from one year to the next year for each store and day of the week.\n*/\n\nwith wss as \n (select d_week_seq,\n ss_store_sk,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\nselect s_store_name1,s_store_id1,d_week_seq1\n ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n ,s_store_id s_store_id1,sun_sales sun_sales1\n ,mon_sales mon_sales1,tue_sales tue_sales1\n ,wed_sales wed_sales1,thu_sales thu_sales1\n ,fri_sales fri_sales1,sat_sales sat_sales1\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212 and 1212 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n ,s_store_id s_store_id2,sun_sales sun_sales2\n ,mon_sales mon_sales2,tue_sales tue_sales2\n ,wed_sales wed_sales2,thu_sales thu_sales2\n ,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212+ 12 and 1212 + 23) x\n where s_store_id1=s_store_id2\n and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n limit 100\n;\n\n-- end query 59 in stream 0 using template query59.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "xdtsndiHVFyaMwRPn5NB0A==", "id": "test-project-364309:europe-west1.query59_1665768400", "jobReference": { "jobId": "query59_1665768400", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query59_1665768400?location=europe-west1", "statistics": { "creationTime": "1665768401469", "endTime": "1665768402559", "finalExecutionDurationMs": "881", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "90438696", "performanceInsights": { "avgPreviousExecutionMs": "774" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "60", "computeMsMax": "60", "computeRatioAvg": 0.08426966292134831, "computeRatioMax": 0.08426966292134831, "endMs": "1665768401685", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.016853932584269662, "readRatioMax": 0.016853932584269662, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665768401624", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_week_seq, $72:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014044943820224719, "waitRatioMax": 0.0014044943820224719, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01544943820224719, "writeRatioMax": 0.01544943820224719 }, { "completedParallelInputs": "1", "computeMsAvg": "66", "computeMsMax": "66", "computeRatioAvg": 0.09269662921348315, "computeRatioMax": 0.09269662921348315, "endMs": "1665768401741", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.02949438202247191, "readRatioMax": 0.02949438202247191, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "93", "startMs": "1665768401659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage02_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.008426966292134831, "waitRatioMax": 0.008426966292134831, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.014044943820224719, "writeRatioMax": 0.014044943820224719 }, { "completedParallelInputs": "6", "computeMsAvg": "489", "computeMsMax": "568", "computeRatioAvg": 0.6867977528089888, "computeRatioMax": 0.797752808988764, "endMs": "1665768402023", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "13", "readRatioAvg": 0.012640449438202247, "readRatioMax": 0.018258426966292134, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2318", "startMs": "1665768401699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $222, $231 := $220", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)", "$151 := case_no_value(equal($223, 'Friday'), $221, NULL)", "$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)", "$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)", "$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)", "$155 := case_no_value(equal($223, 'Monday'), $221, NULL)", "$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $61, $221 := $62, $222 := $71, $223 := $72", "INNER HASH JOIN EACH WITH ALL ON $60 = $70" ] }, { "kind": "WRITE", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014044943820224719, "waitRatioMax": 0.0014044943820224719, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.007022471910112359, "writeRatioMax": 0.008426966292134831 }, { "completedParallelInputs": "6", "computeMsAvg": "535", "computeMsMax": "712", "computeRatioAvg": 0.7514044943820225, "computeRatioMax": 1, "endMs": "1665768402134", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "10", "readRatioAvg": 0.012640449438202247, "readRatioMax": 0.014044943820224719, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2537", "startMs": "1665768401752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $160", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)", "$131 := case_no_value(equal($163, 'Friday'), $161, NULL)", "$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)", "$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)", "$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)", "$135 := case_no_value(equal($163, 'Monday'), $161, NULL)", "$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $51, $163 := $52", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($170, $171)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0014044943820224719, "waitRatioMax": 0.0028089887640449437, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0056179775280898875, "writeRatioMax": 0.007022471910112359 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.014044943820224719, "computeRatioMax": 0.014044943820224719, "endMs": "1665768402208", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008426966292134831, "readRatioMax": 0.008426966292134831, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768402166", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$31:d_week_seq, $30:d_month_seq", "FROM date_dim", "WHERE between($30, 1224, 1235)" ] }, { "kind": "WRITE", "substeps": [ "$31", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014044943820224719, "waitRatioMax": 0.0014044943820224719, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.03932584269662921, "writeRatioMax": 0.03932584269662921 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011235955056179775, "computeRatioMax": 0.011235955056179775, "endMs": "1665768402230", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008426966292134831, "readRatioMax": 0.008426966292134831, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768402189", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014044943820224719, "waitRatioMax": 0.0014044943820224719, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02247191011235955, "writeRatioMax": 0.02247191011235955 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.019662921348314606, "computeRatioMax": 0.019662921348314606, "endMs": "1665768402277", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009831460674157303, "readRatioMax": 0.009831460674157303, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768402238", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$11:d_week_seq, $10:d_month_seq", "FROM date_dim", "WHERE between($10, 1212, 1223)" ] }, { "kind": "WRITE", "substeps": [ "$11", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014044943820224719, "waitRatioMax": 0.0014044943820224719, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.011235955056179775, "writeRatioMax": 0.011235955056179775 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.009831460674157303, "computeRatioMax": 0.009831460674157303, "endMs": "1665768402292", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0056179775280898875, "readRatioMax": 0.0056179775280898875, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768402253", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_id, $3:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014044943820224719, "waitRatioMax": 0.0014044943820224719, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.037921348314606744, "writeRatioMax": 0.037921348314606744 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.037921348314606744, "computeRatioMax": 0.037921348314606744, "endMs": "1665768402344", "id": "12", "inputStages": [ "4", "7", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11381", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768402289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$31", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($271, 52)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $258, $271 := $250, $272 := $251, $273 := $252, $274 := $253, $275 := $254, $276 := $255, $277 := $256, $278 := $257", "INNER HASH JOIN EACH WITH ALL ON $250 = $31" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116, $258 := $21", "INNER HASH JOIN EACH WITH ALL ON $241 = $20" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014044943820224719, "waitRatioMax": 0.0014044943820224719, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.033707865168539325, "writeRatioMax": 0.033707865168539325 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.011235955056179775, "computeRatioMax": 0.026685393258426966, "endMs": "1665768402427", "id": "14", "inputStages": [ "12" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2190", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "3661", "startMs": "1665768402359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0028089887640449437, "waitRatioMax": 0.0056179775280898875, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.021067415730337078, "writeRatioMax": 0.037921348314606744 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.05196629213483146, "computeRatioMax": 0.05196629213483146, "endMs": "1665768402452", "id": "15", "inputStages": [ "14", "9", "10", "5" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13571", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665768402366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$11", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "FROM __stage0E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($303, $310)", "$81 := divide($304, $311)", "$82 := divide($305, $312)", "$83 := divide($306, $313)", "$84 := divide($307, $314)", "$85 := divide($308, $315)", "$86 := divide($309, $316)" ] }, { "kind": "SORT", "substeps": [ "$281 ASC, $280 ASC, $282 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$280 := $210, $281 := $211, $282 := $212, $283 := $213, $284 := $214, $285 := $215, $286 := $216, $287 := $217, $288 := $218, $289 := $219, $290 := $272, $291 := $273, $292 := $274, $293 := $275, $294 := $276, $295 := $277", "INNER HASH JOIN EACH WITH ALL ON $210 = $270, $212 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $198, $211 := $199, $212 := $190, $213 := $191, $214 := $192, $215 := $193, $216 := $194, $217 := $195, $218 := $196, $219 := $197", "INNER HASH JOIN EACH WITH ALL ON $190 = $11" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $100, $192 := $101, $193 := $102, $194 := $103, $195 := $104, $196 := $105, $197 := $106, $198 := $2, $199 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "TO __stage0F_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.007022471910112359, "waitRatioMax": 0.007022471910112359, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0056179775280898875, "writeRatioMax": 0.0056179775280898875 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011235955056179775, "computeRatioMax": 0.011235955056179775, "endMs": "1665768402461", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768402379", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$301 ASC, $300 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004213483146067416, "waitRatioMax": 0.004213483146067416, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.008426966292134831, "writeRatioMax": 0.008426966292134831 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "13", "elapsedMs": "612", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4495" }, { "activeUnits": "2", "completedUnits": "121", "elapsedMs": "994", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9080" } ], "totalBytesBilled": "91226112", "totalBytesProcessed": "90438696", "totalPartitionsProcessed": "0", "totalSlotMs": "9080", "transferredBytes": "0" }, "startTime": "1665768401514", "totalBytesProcessed": "90438696", "totalSlotMs": "9080" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoneb2bea97_1d56_4831_a4c9_d768ac031f97" }, "priority": "INTERACTIVE", "query": "-- start query 59 in stream 0 using template query59.tpl\n\n/*\nReport the increase of weekly store sales from one year to the next year for each store and day of the week.\n*/\n\nwith wss as \n (select d_week_seq,\n ss_store_sk,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\nselect s_store_name1,s_store_id1,d_week_seq1\n ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n ,s_store_id s_store_id1,sun_sales sun_sales1\n ,mon_sales mon_sales1,tue_sales tue_sales1\n ,wed_sales wed_sales1,thu_sales thu_sales1\n ,fri_sales fri_sales1,sat_sales sat_sales1\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212 and 1212 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n ,s_store_id s_store_id2,sun_sales sun_sales2\n ,mon_sales mon_sales2,tue_sales tue_sales2\n ,wed_sales wed_sales2,thu_sales thu_sales2\n ,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212+ 12 and 1212 + 23) x\n where s_store_id1=s_store_id2\n and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n limit 100\n;\n\n-- end query 59 in stream 0 using template query59.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ghDQ0gsOaAedq3vJpjxzzA==", "id": "test-project-364309:europe-west1.query59_1665777854", "jobReference": { "jobId": "query59_1665777854", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query59_1665777854?location=europe-west1", "statistics": { "creationTime": "1665777854863", "endTime": "1665777855777", "finalExecutionDurationMs": "717", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "90438696", "performanceInsights": { "avgPreviousExecutionMs": "801" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "56", "computeMsMax": "56", "computeRatioAvg": 0.09688581314878893, "computeRatioMax": 0.09688581314878893, "endMs": "1665777855063", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.01384083044982699, "readRatioMax": 0.01384083044982699, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665777855015", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_week_seq, $72:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0017301038062283738, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01730103806228374, "writeRatioMax": 0.01730103806228374 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.06401384083044982, "computeRatioMax": 0.06401384083044982, "endMs": "1665777855082", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00865051903114187, "readRatioMax": 0.00865051903114187, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777855045", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0017301038062283738, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.015570934256055362, "writeRatioMax": 0.015570934256055362 }, { "completedParallelInputs": "6", "computeMsAvg": "500", "computeMsMax": "566", "computeRatioAvg": 0.8650519031141869, "computeRatioMax": 0.9792387543252595, "endMs": "1665777855454", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "13", "readRatioAvg": 0.015570934256055362, "readRatioMax": 0.02249134948096886, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2705", "startMs": "1665777855091", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $222, $231 := $220", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)", "$151 := case_no_value(equal($223, 'Friday'), $221, NULL)", "$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)", "$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)", "$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)", "$155 := case_no_value(equal($223, 'Monday'), $221, NULL)", "$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $61, $221 := $62, $222 := $71, $223 := $72", "INNER HASH JOIN EACH WITH ALL ON $60 = $70" ] }, { "kind": "WRITE", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.01384083044982699, "waitRatioMax": 0.01384083044982699, "writeMsAvg": "6", "writeMsMax": "10", "writeRatioAvg": 0.010380622837370242, "writeRatioMax": 0.01730103806228374 }, { "completedParallelInputs": "6", "computeMsAvg": "503", "computeMsMax": "578", "computeRatioAvg": 0.870242214532872, "computeRatioMax": 1, "endMs": "1665777855468", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "12", "readRatioAvg": 0.015570934256055362, "readRatioMax": 0.020761245674740483, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2955", "startMs": "1665777855093", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $160", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)", "$131 := case_no_value(equal($163, 'Friday'), $161, NULL)", "$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)", "$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)", "$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)", "$135 := case_no_value(equal($163, 'Monday'), $161, NULL)", "$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $51, $163 := $52", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($170, $171)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.010380622837370242, "writeRatioMax": 0.01384083044982699 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01730103806228374, "computeRatioMax": 0.01730103806228374, "endMs": "1665777855530", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010380622837370242, "readRatioMax": 0.010380622837370242, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777855494", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$31:d_week_seq, $30:d_month_seq", "FROM date_dim", "WHERE between($30, 1224, 1235)" ] }, { "kind": "WRITE", "substeps": [ "$31", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0017301038062283738, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.01384083044982699, "writeRatioMax": 0.01384083044982699 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.010380622837370242, "computeRatioMax": 0.010380622837370242, "endMs": "1665777855546", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006920415224913495, "readRatioMax": 0.006920415224913495, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777855508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0017301038062283738, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.020761245674740483, "computeRatioMax": 0.020761245674740483, "endMs": "1665777855583", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012110726643598616, "readRatioMax": 0.012110726643598616, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777855537", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$11:d_week_seq, $10:d_month_seq", "FROM date_dim", "WHERE between($10, 1212, 1223)" ] }, { "kind": "WRITE", "substeps": [ "$11", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0017301038062283738, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.00865051903114187, "computeRatioMax": 0.00865051903114187, "endMs": "1665777855592", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.005190311418685121, "readRatioMax": 0.005190311418685121, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777855551", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_id, $3:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0017301038062283738, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0328719723183391, "writeRatioMax": 0.0328719723183391 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.031141868512110725, "computeRatioMax": 0.031141868512110725, "endMs": "1665777855615", "id": "12", "inputStages": [ "7", "6", "4" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11381", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777855584", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$31", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($271, 52)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $258, $271 := $250, $272 := $251, $273 := $252, $274 := $253, $275 := $254, $276 := $255, $277 := $256, $278 := $257", "INNER HASH JOIN EACH WITH ALL ON $250 = $31" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116, $258 := $21", "INNER HASH JOIN EACH WITH ALL ON $241 = $20" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0017301038062283738, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01730103806228374, "writeRatioMax": 0.01730103806228374 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.01384083044982699, "computeRatioMax": 0.025951557093425604, "endMs": "1665777855673", "id": "14", "inputStages": [ "12" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2190", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "4306", "startMs": "1665777855618", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "15", "writeMsMax": "22", "writeRatioAvg": 0.025951557093425604, "writeRatioMax": 0.03806228373702422 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.05709342560553633, "computeRatioMax": 0.05709342560553633, "endMs": "1665777855682", "id": "15", "inputStages": [ "14", "10", "9", "5" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13571", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "86", "startMs": "1665777855623", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$11", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "FROM __stage0E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($303, $310)", "$81 := divide($304, $311)", "$82 := divide($305, $312)", "$83 := divide($306, $313)", "$84 := divide($307, $314)", "$85 := divide($308, $315)", "$86 := divide($309, $316)" ] }, { "kind": "SORT", "substeps": [ "$281 ASC, $280 ASC, $282 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$280 := $210, $281 := $211, $282 := $212, $283 := $213, $284 := $214, $285 := $215, $286 := $216, $287 := $217, $288 := $218, $289 := $219, $290 := $272, $291 := $273, $292 := $274, $293 := $275, $294 := $276, $295 := $277", "INNER HASH JOIN EACH WITH ALL ON $210 = $270, $212 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $198, $211 := $199, $212 := $190, $213 := $191, $214 := $192, $215 := $193, $216 := $194, $217 := $195, $218 := $196, $219 := $197", "INNER HASH JOIN EACH WITH ALL ON $190 = $11" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $100, $192 := $101, $193 := $102, $194 := $103, $195 := $104, $196 := $105, $197 := $106, $198 := $2, $199 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034602076124567475, "waitRatioMax": 0.0034602076124567475, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0034602076124567475, "writeRatioMax": 0.0034602076124567475 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.02249134948096886, "computeRatioMax": 0.02249134948096886, "endMs": "1665777855693", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777855635", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$301 ASC, $300 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017301038062283738, "waitRatioMax": 0.0017301038062283738, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.00865051903114187, "writeRatioMax": 0.00865051903114187 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "14", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "5765" }, { "activeUnits": "2", "completedUnits": "121", "elapsedMs": "816", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10402" } ], "totalBytesBilled": "91226112", "totalBytesProcessed": "90438696", "totalPartitionsProcessed": "0", "totalSlotMs": "10402", "transferredBytes": "0" }, "startTime": "1665777854911", "totalBytesProcessed": "90438696", "totalSlotMs": "10402" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8cee2e9a_cc56_4296_b70d_76535427291f" }, "priority": "INTERACTIVE", "query": "-- start query 59 in stream 0 using template query59.tpl\n\n/*\nReport the increase of weekly store sales from one year to the next year for each store and day of the week.\n*/\n\nwith wss as \n (select d_week_seq,\n ss_store_sk,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\nselect s_store_name1,s_store_id1,d_week_seq1\n ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n ,s_store_id s_store_id1,sun_sales sun_sales1\n ,mon_sales mon_sales1,tue_sales tue_sales1\n ,wed_sales wed_sales1,thu_sales thu_sales1\n ,fri_sales fri_sales1,sat_sales sat_sales1\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212 and 1212 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n ,s_store_id s_store_id2,sun_sales sun_sales2\n ,mon_sales mon_sales2,tue_sales tue_sales2\n ,wed_sales wed_sales2,thu_sales thu_sales2\n ,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212+ 12 and 1212 + 23) x\n where s_store_id1=s_store_id2\n and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n limit 100\n;\n\n-- end query 59 in stream 0 using template query59.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ZkbIBHO89Hb+xrVSXRzXqg==", "id": "test-project-364309:europe-west1.query59_1665777856", "jobReference": { "jobId": "query59_1665777856", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query59_1665777856?location=europe-west1", "statistics": { "creationTime": "1665777857340", "endTime": "1665777858249", "finalExecutionDurationMs": "687", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "90438696", "performanceInsights": { "avgPreviousExecutionMs": "784" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "60", "computeMsMax": "60", "computeRatioAvg": 0.10849909584086799, "computeRatioMax": 0.10849909584086799, "endMs": "1665777857543", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777857495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_week_seq, $72:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018083182640144665, "waitRatioMax": 0.0018083182640144665, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.019891500904159132, "writeRatioMax": 0.019891500904159132 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.0867992766726944, "computeRatioMax": 0.0867992766726944, "endMs": "1665777857567", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009041591320072333, "readRatioMax": 0.009041591320072333, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777857526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018083182640144665, "waitRatioMax": 0.0018083182640144665, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.018083182640144666, "writeRatioMax": 0.018083182640144666 }, { "completedParallelInputs": "6", "computeMsAvg": "451", "computeMsMax": "489", "computeRatioAvg": 0.8155515370705244, "computeRatioMax": 0.8842676311030742, "endMs": "1665777857894", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "30", "readRatioAvg": 0.02531645569620253, "readRatioMax": 0.054249547920433995, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2488", "startMs": "1665777857567", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $222, $231 := $220", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)", "$151 := case_no_value(equal($223, 'Friday'), $221, NULL)", "$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)", "$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)", "$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)", "$155 := case_no_value(equal($223, 'Monday'), $221, NULL)", "$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $61, $221 := $62, $222 := $71, $223 := $72", "INNER HASH JOIN EACH WITH ALL ON $60 = $70" ] }, { "kind": "WRITE", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "24", "waitMsMax": "29", "waitRatioAvg": 0.0433996383363472, "waitRatioMax": 0.05244122965641953, "writeMsAvg": "8", "writeMsMax": "25", "writeRatioAvg": 0.014466546112115732, "writeRatioMax": 0.045207956600361664 }, { "completedParallelInputs": "6", "computeMsAvg": "453", "computeMsMax": "553", "computeRatioAvg": 0.8191681735985533, "computeRatioMax": 1, "endMs": "1665777857924", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.019891500904159132, "readRatioMax": 0.03074141048824593, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2437", "startMs": "1665777857578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $160", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)", "$131 := case_no_value(equal($163, 'Friday'), $161, NULL)", "$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)", "$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)", "$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)", "$135 := case_no_value(equal($163, 'Monday'), $161, NULL)", "$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $51, $163 := $52", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($170, $171)" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.007233273056057866, "waitRatioMax": 0.009041591320072333, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.007233273056057866, "writeRatioMax": 0.0108499095840868 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.018083182640144666, "computeRatioMax": 0.018083182640144666, "endMs": "1665777857971", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012658227848101266, "readRatioMax": 0.012658227848101266, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777857944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$31:d_week_seq, $30:d_month_seq", "FROM date_dim", "WHERE between($30, 1224, 1235)" ] }, { "kind": "WRITE", "substeps": [ "$31", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018083182640144665, "waitRatioMax": 0.0018083182640144665, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0108499095840868, "writeRatioMax": 0.0108499095840868 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.018083182640144666, "computeRatioMax": 0.018083182640144666, "endMs": "1665777858002", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007233273056057866, "readRatioMax": 0.007233273056057866, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777857958", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018083182640144665, "waitRatioMax": 0.0018083182640144665, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.034358047016274866, "writeRatioMax": 0.034358047016274866 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.027124773960216998, "computeRatioMax": 0.027124773960216998, "endMs": "1665777858025", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0108499095840868, "readRatioMax": 0.0108499095840868, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777857989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$11:d_week_seq, $10:d_month_seq", "FROM date_dim", "WHERE between($10, 1212, 1223)" ] }, { "kind": "WRITE", "substeps": [ "$11", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003616636528028933, "waitRatioMax": 0.003616636528028933, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0162748643761302, "writeRatioMax": 0.0162748643761302 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0162748643761302, "computeRatioMax": 0.0162748643761302, "endMs": "1665777858043", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0108499095840868, "readRatioMax": 0.0108499095840868, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665777858002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_id, $3:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018083182640144665, "waitRatioMax": 0.0018083182640144665, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.027124773960216998, "writeRatioMax": 0.027124773960216998 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.04701627486437613, "computeRatioMax": 0.04701627486437613, "endMs": "1665777858061", "id": "12", "inputStages": [ "7", "4", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11381", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777858032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$31", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($271, 52)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $258, $271 := $250, $272 := $251, $273 := $252, $274 := $253, $275 := $254, $276 := $255, $277 := $256, $278 := $257", "INNER HASH JOIN EACH WITH ALL ON $250 = $31" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116, $258 := $21", "INNER HASH JOIN EACH WITH ALL ON $241 = $20" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018083182640144665, "waitRatioMax": 0.0018083182640144665, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.012658227848101266, "writeRatioMax": 0.012658227848101266 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.014466546112115732, "computeRatioMax": 0.02531645569620253, "endMs": "1665777858130", "id": "14", "inputStages": [ "12" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2190", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "3989", "startMs": "1665777858066", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0054249547920434, "waitRatioMax": 0.007233273056057866, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.027124773960216998, "writeRatioMax": 0.048824593128390596 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.0433996383363472, "computeRatioMax": 0.0433996383363472, "endMs": "1665777858141", "id": "15", "inputStages": [ "9", "5", "10", "14" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13571", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665777858072", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$11", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "FROM __stage0E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($303, $310)", "$81 := divide($304, $311)", "$82 := divide($305, $312)", "$83 := divide($306, $313)", "$84 := divide($307, $314)", "$85 := divide($308, $315)", "$86 := divide($309, $316)" ] }, { "kind": "SORT", "substeps": [ "$281 ASC, $280 ASC, $282 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$280 := $210, $281 := $211, $282 := $212, $283 := $213, $284 := $214, $285 := $215, $286 := $216, $287 := $217, $288 := $218, $289 := $219, $290 := $272, $291 := $273, $292 := $274, $293 := $275, $294 := $276, $295 := $277", "INNER HASH JOIN EACH WITH ALL ON $210 = $270, $212 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $198, $211 := $199, $212 := $190, $213 := $191, $214 := $192, $215 := $193, $216 := $194, $217 := $195, $218 := $196, $219 := $197", "INNER HASH JOIN EACH WITH ALL ON $190 = $11" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $100, $192 := $101, $193 := $102, $194 := $103, $195 := $104, $196 := $105, $197 := $106, $198 := $2, $199 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "TO __stage0F_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.007233273056057866, "waitRatioMax": 0.007233273056057866, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.003616636528028933, "writeRatioMax": 0.003616636528028933 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0162748643761302, "computeRatioMax": 0.0162748643761302, "endMs": "1665777858149", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777858082", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$301 ASC, $300 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329", "TO __stage10_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0054249547920434, "waitRatioMax": 0.0054249547920434, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0054249547920434, "writeRatioMax": 0.0054249547920434 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "15", "elapsedMs": "597", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "5079" }, { "activeUnits": "3", "completedUnits": "121", "elapsedMs": "789", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9354" } ], "totalBytesBilled": "91226112", "totalBytesProcessed": "90438696", "totalPartitionsProcessed": "0", "totalSlotMs": "9354", "transferredBytes": "0" }, "startTime": "1665777857400", "totalBytesProcessed": "90438696", "totalSlotMs": "9354" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon32971993_2cf4_4a3e_b534_af7d052be3bc" }, "priority": "INTERACTIVE", "query": "-- start query 59 in stream 0 using template query59.tpl\n\n/*\nReport the increase of weekly store sales from one year to the next year for each store and day of the week.\n*/\n\nwith wss as \n (select d_week_seq,\n ss_store_sk,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\nselect s_store_name1,s_store_id1,d_week_seq1\n ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n ,s_store_id s_store_id1,sun_sales sun_sales1\n ,mon_sales mon_sales1,tue_sales tue_sales1\n ,wed_sales wed_sales1,thu_sales thu_sales1\n ,fri_sales fri_sales1,sat_sales sat_sales1\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212 and 1212 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n ,s_store_id s_store_id2,sun_sales sun_sales2\n ,mon_sales mon_sales2,tue_sales tue_sales2\n ,wed_sales wed_sales2,thu_sales thu_sales2\n ,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212+ 12 and 1212 + 23) x\n where s_store_id1=s_store_id2\n and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n limit 100\n;\n\n-- end query 59 in stream 0 using template query59.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2/3JX34dE3rsF+8JqPfjeQ==", "id": "test-project-364309:europe-west1.query59_1665777859", "jobReference": { "jobId": "query59_1665777859", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query59_1665777859?location=europe-west1", "statistics": { "creationTime": "1665777859855", "endTime": "1665777860967", "finalExecutionDurationMs": "895", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "90438696", "performanceInsights": { "avgPreviousExecutionMs": "768" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.053738317757009345, "computeRatioMax": 0.053738317757009345, "endMs": "1665777860085", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.010514018691588784, "readRatioMax": 0.010514018691588784, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665777860026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_week_seq, $72:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage00_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0035046728971962616, "waitRatioMax": 0.0035046728971962616, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.015186915887850467, "writeRatioMax": 0.015186915887850467 }, { "completedParallelInputs": "1", "computeMsAvg": "60", "computeMsMax": "60", "computeRatioAvg": 0.07009345794392523, "computeRatioMax": 0.07009345794392523, "endMs": "1665777860118", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007009345794392523, "readRatioMax": 0.007009345794392523, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665777860066", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002336448598130841, "waitRatioMax": 0.002336448598130841, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.011682242990654205, "writeRatioMax": 0.011682242990654205 }, { "completedParallelInputs": "6", "computeMsAvg": "539", "computeMsMax": "856", "computeRatioAvg": 0.6296728971962616, "computeRatioMax": 1, "endMs": "1665777860589", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "24", "readRatioAvg": 0.014018691588785047, "readRatioMax": 0.028037383177570093, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2696", "startMs": "1665777860104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $222, $231 := $220", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)", "$151 := case_no_value(equal($223, 'Friday'), $221, NULL)", "$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)", "$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)", "$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)", "$155 := case_no_value(equal($223, 'Monday'), $221, NULL)", "$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $61, $221 := $62, $222 := $71, $223 := $72", "INNER HASH JOIN EACH WITH ALL ON $60 = $70" ] }, { "kind": "WRITE", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "4", "waitMsMax": "8", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.009345794392523364, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.005841121495327103, "writeRatioMax": 0.008177570093457943 }, { "completedParallelInputs": "6", "computeMsAvg": "453", "computeMsMax": "646", "computeRatioAvg": 0.5292056074766355, "computeRatioMax": 0.7546728971962616, "endMs": "1665777860489", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "17", "readRatioAvg": 0.011682242990654205, "readRatioMax": 0.01985981308411215, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2336", "startMs": "1665777860144", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $160", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)", "$131 := case_no_value(equal($163, 'Friday'), $161, NULL)", "$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)", "$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)", "$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)", "$135 := case_no_value(equal($163, 'Monday'), $161, NULL)", "$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $51, $163 := $52", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($170, $171)" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.0035046728971962616, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.005841121495327103, "writeRatioMax": 0.008177570093457943 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010514018691588784, "computeRatioMax": 0.010514018691588784, "endMs": "1665777860648", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005841121495327103, "readRatioMax": 0.005841121495327103, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777860616", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$31:d_week_seq, $30:d_month_seq", "FROM date_dim", "WHERE between($30, 1224, 1235)" ] }, { "kind": "WRITE", "substeps": [ "$31", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002336448598130841, "waitRatioMax": 0.002336448598130841, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.01985981308411215, "writeRatioMax": 0.01985981308411215 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.008177570093457943, "computeRatioMax": 0.008177570093457943, "endMs": "1665777860670", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004672897196261682, "readRatioMax": 0.004672897196261682, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777860629", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011682242990654205, "waitRatioMax": 0.0011682242990654205, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02219626168224299, "writeRatioMax": 0.02219626168224299 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011682242990654205, "computeRatioMax": 0.011682242990654205, "endMs": "1665777860702", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005841121495327103, "readRatioMax": 0.005841121495327103, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777860662", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$11:d_week_seq, $10:d_month_seq", "FROM date_dim", "WHERE between($10, 1212, 1223)" ] }, { "kind": "WRITE", "substeps": [ "$11", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011682242990654205, "waitRatioMax": 0.0011682242990654205, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.017523364485981307, "writeRatioMax": 0.017523364485981307 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010514018691588784, "computeRatioMax": 0.010514018691588784, "endMs": "1665777860717", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004672897196261682, "readRatioMax": 0.004672897196261682, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777860680", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_id, $3:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002336448598130841, "waitRatioMax": 0.002336448598130841, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.017523364485981307, "writeRatioMax": 0.017523364485981307 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.037383177570093455, "computeRatioMax": 0.037383177570093455, "endMs": "1665777860747", "id": "12", "inputStages": [ "7", "4", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11381", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777860714", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$31", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($271, 52)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $258, $271 := $250, $272 := $251, $273 := $252, $274 := $253, $275 := $254, $276 := $255, $277 := $256, $278 := $257", "INNER HASH JOIN EACH WITH ALL ON $250 = $31" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116, $258 := $21", "INNER HASH JOIN EACH WITH ALL ON $241 = $20" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011682242990654205, "waitRatioMax": 0.0011682242990654205, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.008177570093457943, "writeRatioMax": 0.008177570093457943 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.009345794392523364, "computeRatioMax": 0.017523364485981307, "endMs": "1665777860828", "id": "14", "inputStages": [ "12" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2190", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "3685", "startMs": "1665777860764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.007009345794392523, "writeMsAvg": "18", "writeMsMax": "40", "writeRatioAvg": 0.02102803738317757, "writeRatioMax": 0.04672897196261682 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.04205607476635514, "computeRatioMax": 0.04205607476635514, "endMs": "1665777860848", "id": "15", "inputStages": [ "10", "5", "14", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13571", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665777860777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$11", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "FROM __stage0E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($303, $310)", "$81 := divide($304, $311)", "$82 := divide($305, $312)", "$83 := divide($306, $313)", "$84 := divide($307, $314)", "$85 := divide($308, $315)", "$86 := divide($309, $316)" ] }, { "kind": "SORT", "substeps": [ "$281 ASC, $280 ASC, $282 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$280 := $210, $281 := $211, $282 := $212, $283 := $213, $284 := $214, $285 := $215, $286 := $216, $287 := $217, $288 := $218, $289 := $219, $290 := $272, $291 := $273, $292 := $274, $293 := $275, $294 := $276, $295 := $277", "INNER HASH JOIN EACH WITH ALL ON $210 = $270, $212 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $198, $211 := $199, $212 := $190, $213 := $191, $214 := $192, $215 := $193, $216 := $194, $217 := $195, $218 := $196, $219 := $197", "INNER HASH JOIN EACH WITH ALL ON $190 = $11" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $100, $192 := $101, $193 := $102, $194 := $103, $195 := $104, $196 := $105, $197 := $106, $198 := $2, $199 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "TO __stage0F_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.007009345794392523, "waitRatioMax": 0.007009345794392523, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.004672897196261682, "writeRatioMax": 0.004672897196261682 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010514018691588784, "computeRatioMax": 0.010514018691588784, "endMs": "1665777860861", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777860790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$301 ASC, $300 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.004672897196261682, "waitRatioMax": 0.004672897196261682, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0035046728971962616, "writeRatioMax": 0.0035046728971962616 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "13", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4889" }, { "activeUnits": "2", "completedUnits": "121", "elapsedMs": "1019", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9222" } ], "totalBytesBilled": "91226112", "totalBytesProcessed": "90438696", "totalPartitionsProcessed": "0", "totalSlotMs": "9222", "transferredBytes": "0" }, "startTime": "1665777859901", "totalBytesProcessed": "90438696", "totalSlotMs": "9222" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonaa4cfff9_c35b_4a8d_a43a_490742038a96" }, "priority": "INTERACTIVE", "query": "-- start query 59 in stream 0 using template query59.tpl\n\n/*\nReport the increase of weekly store sales from one year to the next year for each store and day of the week.\n*/\n\nwith wss as \n (select d_week_seq,\n ss_store_sk,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\nselect s_store_name1,s_store_id1,d_week_seq1\n ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n ,s_store_id s_store_id1,sun_sales sun_sales1\n ,mon_sales mon_sales1,tue_sales tue_sales1\n ,wed_sales wed_sales1,thu_sales thu_sales1\n ,fri_sales fri_sales1,sat_sales sat_sales1\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212 and 1212 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n ,s_store_id s_store_id2,sun_sales sun_sales2\n ,mon_sales mon_sales2,tue_sales tue_sales2\n ,wed_sales wed_sales2,thu_sales thu_sales2\n ,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212+ 12 and 1212 + 23) x\n where s_store_id1=s_store_id2\n and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n limit 100\n;\n\n-- end query 59 in stream 0 using template query59.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "OeuSedR+i05fVdSVCkAVHw==", "id": "test-project-364309:europe-west1.query59_1665777861", "jobReference": { "jobId": "query59_1665777861", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query59_1665777861?location=europe-west1", "statistics": { "creationTime": "1665777862557", "endTime": "1665777863584", "finalExecutionDurationMs": "809", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "90438696", "performanceInsights": { "avgPreviousExecutionMs": "786" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.08761329305135952, "computeRatioMax": 0.08761329305135952, "endMs": "1665777862740", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0075528700906344415, "readRatioMax": 0.0075528700906344415, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665777862703", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_week_seq, $72:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0015105740181268882, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.015105740181268883, "writeRatioMax": 0.015105740181268883 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.061933534743202415, "computeRatioMax": 0.061933534743202415, "endMs": "1665777862773", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.010574018126888218, "readRatioMax": 0.010574018126888218, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777862734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0015105740181268882, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.013595166163141994, "writeRatioMax": 0.013595166163141994 }, { "completedParallelInputs": "6", "computeMsAvg": "482", "computeMsMax": "657", "computeRatioAvg": 0.7280966767371602, "computeRatioMax": 0.9924471299093656, "endMs": "1665777863103", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "8", "readMsMax": "9", "readRatioAvg": 0.012084592145015106, "readRatioMax": 0.013595166163141994, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2413", "startMs": "1665777862755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $222, $231 := $220", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)", "$151 := case_no_value(equal($223, 'Friday'), $221, NULL)", "$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)", "$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)", "$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)", "$155 := case_no_value(equal($223, 'Monday'), $221, NULL)", "$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $61, $221 := $62, $222 := $71, $223 := $72", "INNER HASH JOIN EACH WITH ALL ON $60 = $70" ] }, { "kind": "WRITE", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0015105740181268882, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.0075528700906344415, "writeRatioMax": 0.00906344410876133 }, { "completedParallelInputs": "6", "computeMsAvg": "466", "computeMsMax": "662", "computeRatioAvg": 0.7039274924471299, "computeRatioMax": 1, "endMs": "1665777863124", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.015105740181268883, "readRatioMax": 0.019637462235649546, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2499", "startMs": "1665777862788", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $160", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)", "$131 := case_no_value(equal($163, 'Friday'), $161, NULL)", "$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)", "$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)", "$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)", "$135 := case_no_value(equal($163, 'Monday'), $161, NULL)", "$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $51, $163 := $52", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($170, $171)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.0075528700906344415, "writeRatioMax": 0.010574018126888218 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.01812688821752266, "computeRatioMax": 0.01812688821752266, "endMs": "1665777863185", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006042296072507553, "readRatioMax": 0.006042296072507553, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777863146", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$31:d_week_seq, $30:d_month_seq", "FROM date_dim", "WHERE between($30, 1224, 1235)" ] }, { "kind": "WRITE", "substeps": [ "$31", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0015105740181268882, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.022658610271903322, "writeRatioMax": 0.022658610271903322 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.015105740181268883, "computeRatioMax": 0.015105740181268883, "endMs": "1665777863190", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0075528700906344415, "readRatioMax": 0.0075528700906344415, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777863158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0015105740181268882, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.027190332326283987, "writeRatioMax": 0.027190332326283987 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.022658610271903322, "computeRatioMax": 0.022658610271903322, "endMs": "1665777863238", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "25", "readMsMax": "25", "readRatioAvg": 0.0377643504531722, "readRatioMax": 0.0377643504531722, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665777863187", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$11:d_week_seq, $10:d_month_seq", "FROM date_dim", "WHERE between($10, 1212, 1223)" ] }, { "kind": "WRITE", "substeps": [ "$11", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0015105740181268882, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.021148036253776436, "writeRatioMax": 0.021148036253776436 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01661631419939577, "computeRatioMax": 0.01661631419939577, "endMs": "1665777863231", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00906344410876133, "readRatioMax": 0.00906344410876133, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777863199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_id, $3:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0015105740181268882, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.013595166163141994, "writeRatioMax": 0.013595166163141994 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.030211480362537766, "computeRatioMax": 0.030211480362537766, "endMs": "1665777863385", "id": "14", "inputStages": [ "5", "10", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11381", "recordsWritten": "2190", "shuffleOutputBytes": "345348", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777863357", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$11", "FROM __stage09_output" ] }, { "kind": "JOIN", "substeps": [ "$210 := $198, $211 := $199, $212 := $190, $213 := $191, $214 := $192, $215 := $193, $216 := $194, $217 := $195, $218 := $196, $219 := $197", "INNER HASH JOIN EACH WITH ALL ON $190 = $11" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $100, $192 := $101, $193 := $102, $194 := $103, $195 := $104, $196 := $105, $197 := $106, $198 := $2, $199 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212, $213, $214, $215, $216, $217, $218, $219", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015105740181268882, "waitRatioMax": 0.0015105740181268882, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.00906344410876133, "writeRatioMax": 0.00906344410876133 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.012084592145015106, "computeRatioMax": 0.022658610271903322, "endMs": "1665777863446", "id": "15", "inputStages": [ "14" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2190", "recordsWritten": "2190", "shuffleOutputBytes": "345348", "shuffleOutputBytesSpilled": "0", "slotMs": "3374", "startMs": "1665777863388", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "9", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.013595166163141994, "writeMsAvg": "15", "writeMsMax": "23", "writeRatioAvg": 0.022658610271903322, "writeRatioMax": 0.03474320241691843 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.05740181268882175, "computeRatioMax": 0.05740181268882175, "endMs": "1665777863463", "id": "16", "inputStages": [ "15", "7", "6", "4" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13571", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665777863397", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$31", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$210, $211, $212, $213, $214, $215, $216, $217, $218, $219", "FROM __stage0F_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($303, $310)", "$81 := divide($304, $311)", "$82 := divide($305, $312)", "$83 := divide($306, $313)", "$84 := divide($307, $314)", "$85 := divide($308, $315)", "$86 := divide($309, $316)" ] }, { "kind": "SORT", "substeps": [ "$281 ASC, $280 ASC, $282 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$290 := $272, $291 := $273, $292 := $274, $293 := $275, $294 := $276, $295 := $277, $296 := $278, $280 := $210, $281 := $211, $282 := $212, $283 := $213, $284 := $214, $285 := $215, $286 := $216, $287 := $217, $288 := $218", "INNER HASH JOIN EACH WITH ALL ON $270 = $210, $90 = $212" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($271, 52)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $258, $271 := $250, $272 := $251, $273 := $252, $274 := $253, $275 := $254, $276 := $255, $277 := $256, $278 := $257", "INNER HASH JOIN EACH WITH ALL ON $250 = $31" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116, $258 := $21", "INNER HASH JOIN EACH WITH ALL ON $241 = $20" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "TO __stage10_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.013595166163141994, "waitRatioMax": 0.013595166163141994, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0030211480362537764, "writeRatioMax": 0.0030211480362537764 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01661631419939577, "computeRatioMax": 0.01661631419939577, "endMs": "1665777863468", "id": "17", "inputStages": [ "16" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777863413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$301 ASC, $300 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0030211480362537764, "waitRatioMax": 0.0030211480362537764, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.006042296072507553, "writeRatioMax": 0.006042296072507553 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "16", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "5094" }, { "activeUnits": "3", "completedUnits": "121", "elapsedMs": "919", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8712" } ], "totalBytesBilled": "91226112", "totalBytesProcessed": "90438696", "totalPartitionsProcessed": "0", "totalSlotMs": "8712", "transferredBytes": "0" }, "startTime": "1665777862601", "totalBytesProcessed": "90438696", "totalSlotMs": "8712" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1d37bb6a_63bc_4ac3_a9ef_f9dabdb14b20" }, "priority": "INTERACTIVE", "query": "-- start query 59 in stream 0 using template query59.tpl\n\n/*\nReport the increase of weekly store sales from one year to the next year for each store and day of the week.\n*/\n\nwith wss as \n (select d_week_seq,\n ss_store_sk,\n sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\nselect s_store_name1,s_store_id1,d_week_seq1\n ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n ,s_store_id s_store_id1,sun_sales sun_sales1\n ,mon_sales mon_sales1,tue_sales tue_sales1\n ,wed_sales wed_sales1,thu_sales thu_sales1\n ,fri_sales fri_sales1,sat_sales sat_sales1\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212 and 1212 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n ,s_store_id s_store_id2,sun_sales sun_sales2\n ,mon_sales mon_sales2,tue_sales tue_sales2\n ,wed_sales wed_sales2,thu_sales thu_sales2\n ,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d\n where d.d_week_seq = wss.d_week_seq and\n ss_store_sk = s_store_sk and \n d_month_seq between 1212+ 12 and 1212 + 23) x\n where s_store_id1=s_store_id2\n and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n limit 100\n;\n\n-- end query 59 in stream 0 using template query59.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Z5fYhSCB7CA2ng1fyu9gJQ==", "id": "test-project-364309:europe-west1.query59_1665777864", "jobReference": { "jobId": "query59_1665777864", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query59_1665777864?location=europe-west1", "statistics": { "creationTime": "1665777865401", "endTime": "1665777866333", "finalExecutionDurationMs": "718", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "90438696", "performanceInsights": { "avgPreviousExecutionMs": "789" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.0837138508371385, "computeRatioMax": 0.0837138508371385, "endMs": "1665777865612", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0136986301369863, "readRatioMax": 0.0136986301369863, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665777865558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:d_date_sk, $71:d_week_seq, $72:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$70, $71, $72", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015220700152207, "waitRatioMax": 0.0015220700152207, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0228310502283105, "writeRatioMax": 0.0228310502283105 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.0532724505327245, "computeRatioMax": 0.0532724505327245, "endMs": "1665777865629", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0091324200913242, "readRatioMax": 0.0091324200913242, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777865591", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015220700152207, "waitRatioMax": 0.0015220700152207, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0167427701674277, "writeRatioMax": 0.0167427701674277 }, { "completedParallelInputs": "6", "computeMsAvg": "461", "computeMsMax": "551", "computeRatioAvg": 0.7016742770167428, "computeRatioMax": 0.8386605783866058, "endMs": "1665777865998", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "12", "readRatioAvg": 0.0136986301369863, "readRatioMax": 0.0182648401826484, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2404", "startMs": "1665777865629", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$70, $71, $72", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $222, $231 := $220", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)", "$151 := case_no_value(equal($223, 'Friday'), $221, NULL)", "$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)", "$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)", "$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)", "$155 := case_no_value(equal($223, 'Monday'), $221, NULL)", "$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $61, $221 := $62, $222 := $71, $223 := $72", "INNER HASH JOIN EACH WITH ALL ON $60 = $70" ] }, { "kind": "WRITE", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "9", "waitMsMax": "12", "waitRatioAvg": 0.0136986301369863, "waitRatioMax": 0.0182648401826484, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0060882800608828, "writeRatioMax": 0.0076103500761035 }, { "completedParallelInputs": "6", "computeMsAvg": "507", "computeMsMax": "657", "computeRatioAvg": 0.771689497716895, "computeRatioMax": 1, "endMs": "1665777865994", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "20", "readRatioAvg": 0.0167427701674277, "readRatioMax": 0.030441400304414, "recordsRead": "3318698", "recordsWritten": "11004", "shuffleOutputBytes": "1468860", "shuffleOutputBytesSpilled": "0", "slotMs": "2511", "startMs": "1665777865642", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $170 := $162, $171 := $160", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)", "$131 := case_no_value(equal($163, 'Friday'), $161, NULL)", "$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)", "$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)", "$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)", "$135 := case_no_value(equal($163, 'Monday'), $161, NULL)", "$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$160 := $41, $161 := $42, $162 := $51, $163 := $52", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($170, $171)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015220700152207, "waitRatioMax": 0.0015220700152207, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.0076103500761035, "writeRatioMax": 0.0091324200913242 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0121765601217656, "computeRatioMax": 0.0121765601217656, "endMs": "1665777866063", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0076103500761035, "readRatioMax": 0.0076103500761035, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777866033", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$31:d_week_seq, $30:d_month_seq", "FROM date_dim", "WHERE between($30, 1224, 1235)" ] }, { "kind": "WRITE", "substeps": [ "$31", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015220700152207, "waitRatioMax": 0.0015220700152207, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0258751902587519, "writeRatioMax": 0.0258751902587519 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0213089802130898, "computeRatioMax": 0.0213089802130898, "endMs": "1665777866086", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0091324200913242, "readRatioMax": 0.0091324200913242, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "360", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777866046", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:s_store_sk, $21:s_store_id", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015220700152207, "waitRatioMax": 0.0015220700152207, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0182648401826484, "writeRatioMax": 0.0182648401826484 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0197869101978691, "computeRatioMax": 0.0197869101978691, "endMs": "1665777866111", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0091324200913242, "readRatioMax": 0.0091324200913242, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777866074", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$11:d_week_seq, $10:d_month_seq", "FROM date_dim", "WHERE between($10, 1212, 1223)" ] }, { "kind": "WRITE", "substeps": [ "$11", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015220700152207, "waitRatioMax": 0.0015220700152207, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0106544901065449, "writeRatioMax": 0.0106544901065449 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0182648401826484, "computeRatioMax": 0.0182648401826484, "endMs": "1665777866129", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0076103500761035, "readRatioMax": 0.0076103500761035, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "471", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777866086", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_id, $3:s_store_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage0A_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0273972602739726, "writeRatioMax": 0.0273972602739726 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.0380517503805175, "computeRatioMax": 0.0380517503805175, "endMs": "1665777866159", "id": "12", "inputStages": [ "7", "6", "4" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11381", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777866117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$231, $230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$31", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($271, 52)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $258, $271 := $250, $272 := $251, $273 := $252, $274 := $253, $275 := $254, $276 := $255, $277 := $256, $278 := $257", "INNER HASH JOIN EACH WITH ALL ON $250 = $31" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116, $258 := $21", "INNER HASH JOIN EACH WITH ALL ON $241 = $20" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0015220700152207, "waitRatioMax": 0.0015220700152207, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0106544901065449, "writeRatioMax": 0.0106544901065449 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.0121765601217656, "computeRatioMax": 0.0273972602739726, "endMs": "1665777866225", "id": "14", "inputStages": [ "12" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2190", "recordsWritten": "2190", "shuffleOutputBytes": "325254", "shuffleOutputBytesSpilled": "0", "slotMs": "2992", "startMs": "1665777866171", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0015220700152207, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.0197869101978691, "writeRatioMax": 0.0289193302891933 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.0593607305936073, "computeRatioMax": 0.0593607305936073, "endMs": "1665777866236", "id": "15", "inputStages": [ "14", "5", "10", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "13571", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665777866176", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$171, $170, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage0A_output" ] }, { "kind": "READ", "substeps": [ "$11", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$90, $270, $272, $273, $274, $275, $276, $277, $278", "FROM __stage0E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := divide($303, $310)", "$81 := divide($304, $311)", "$82 := divide($305, $312)", "$83 := divide($306, $313)", "$84 := divide($307, $314)", "$85 := divide($308, $315)", "$86 := divide($309, $316)" ] }, { "kind": "SORT", "substeps": [ "$281 ASC, $280 ASC, $282 ASC", "LIMIT 100" ] }, { "kind": "JOIN", "substeps": [ "$280 := $210, $281 := $211, $282 := $212, $283 := $213, $284 := $214, $285 := $215, $286 := $216, $287 := $217, $288 := $218, $289 := $219, $290 := $272, $291 := $273, $292 := $274, $293 := $275, $294 := $276, $295 := $277", "INNER HASH JOIN EACH WITH ALL ON $210 = $270, $212 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $198, $211 := $199, $212 := $190, $213 := $191, $214 := $192, $215 := $193, $216 := $194, $217 := $195, $218 := $196, $219 := $197", "INNER HASH JOIN EACH WITH ALL ON $190 = $11" ] }, { "kind": "JOIN", "substeps": [ "$190 := $180, $191 := $100, $192 := $101, $193 := $102, $194 := $103, $195 := $104, $196 := $105, $197 := $106, $198 := $2, $199 := $3", "INNER HASH JOIN EACH WITH ALL ON $181 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "TO __stage0F_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0045662100456621, "waitRatioMax": 0.0045662100456621, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0045662100456621, "writeRatioMax": 0.0045662100456621 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0136986301369863, "computeRatioMax": 0.0136986301369863, "endMs": "1665777866242", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "15800", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665777866186", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $302, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$301 ASC, $300 ASC, $302 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0060882800608828, "waitRatioMax": 0.0060882800608828, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0076103500761035, "writeRatioMax": 0.0076103500761035 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "14", "elapsedMs": "606", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "5041" }, { "activeUnits": "2", "completedUnits": "121", "elapsedMs": "825", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8325" } ], "totalBytesBilled": "91226112", "totalBytesProcessed": "90438696", "totalPartitionsProcessed": "0", "totalSlotMs": "8325", "transferredBytes": "0" }, "startTime": "1665777865454", "totalBytesProcessed": "90438696", "totalSlotMs": "8325" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
