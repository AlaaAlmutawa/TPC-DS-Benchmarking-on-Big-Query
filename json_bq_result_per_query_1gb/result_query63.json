{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon20ed2139_e418_49e1_bd84_57a0a4b508b2" }, "priority": "INTERACTIVE", "query": "-- start query 63 in stream 0 using template query63.tpl\n\n/*\nFor a given year calculate the \nmonthly sales of items of specific categories, classes and brands that were sold in stores and \ngroup the results by store manager. \n\nAdditionally, for every month and manager print the yearly average sales of those items.\n*/\n\nselect benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \nfrom (select i_manager_id\n ,sum(ss_sales_price) sum_sales\n ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n from item\n ,store_sales\n ,date_dim\n ,store\n where ss_item_sk = i_item_sk\n and ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and d_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11)\n and (( i_category in ('Books','Children','Electronics')\n and i_class in ('personal','portable','reference','self-help')\n and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t 'exportiunivamalg #9','scholaramalgamalg #9'))\n or( i_category in ('Women','Music','Men')\n and i_class in ('accessories','classical','fragrances','pants')\n and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n ,avg_monthly_sales\n ,sum_sales\nlimit 100\n;\n\n-- end query 63 in stream 0 using template query63.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "zosxbnzMokxm8DgWby0peA==", "id": "test-project-364309:europe-west1.query63_1665768411", "jobReference": { "jobId": "query63_1665768411", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query63_1665768411?location=europe-west1", "statistics": { "creationTime": "1665768411809", "endTime": "1665768412485", "finalExecutionDurationMs": "452", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745580", "performanceInsights": { "avgPreviousExecutionMs": "480" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.06321839080459771, "computeRatioMax": 0.06321839080459771, "endMs": "1665768412024", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.028735632183908046, "readRatioMax": 0.028735632183908046, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768411968", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.1839080459770115, "writeRatioMax": 0.1839080459770115 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665768412047", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.040229885057471264, "readRatioMax": 0.040229885057471264, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768411993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.14367816091954022, "writeRatioMax": 0.14367816091954022 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.09195402298850575, "computeRatioMax": 0.09195402298850575, "endMs": "1665768412082", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.034482758620689655, "readRatioMax": 0.034482758620689655, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768412041", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manager_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.06896551724137931, "writeRatioMax": 0.06896551724137931 }, { "completedParallelInputs": "6", "computeMsAvg": "131", "computeMsMax": "174", "computeRatioAvg": 0.7528735632183908, "computeRatioMax": 1, "endMs": "1665768412211", "id": "4", "inputStages": [ "1", "0", "3" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.06321839080459771, "readRatioMax": 0.09770114942528736, "recordsRead": "2888276", "recordsWritten": "4927", "shuffleOutputBytes": "172125", "shuffleOutputBytesSpilled": "0", "slotMs": "767", "startMs": "1665768412096", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.034482758620689655, "writeRatioMax": 0.05172413793103448 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.08045977011494253, "computeRatioMax": 0.08045977011494253, "endMs": "1665768412237", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4927", "recordsWritten": "1003", "shuffleOutputBytes": "26062", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665768412220", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.034482758620689655, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.06321839080459771, "computeRatioMax": 0.06321839080459771, "endMs": "1665768412302", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768412262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.1206896551724138, "writeRatioMax": 0.1206896551724138 }, { "completedParallelInputs": "70", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.09770114942528736, "endMs": "1665768412365", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2539", "startMs": "1665768412313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.011494252873563218, "writeMsAvg": "26", "writeMsMax": "41", "writeRatioAvg": 0.14942528735632185, "writeRatioMax": 0.23563218390804597 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.05172413793103448, "computeRatioMax": 0.09770114942528736, "endMs": "1665768412364", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1003", "recordsWritten": "921", "shuffleOutputBytes": "39603", "shuffleOutputBytesSpilled": "0", "slotMs": "3448", "startMs": "1665768412319", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC, $51 ASC, $52 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.017241379310344827, "waitRatioMax": 0.05172413793103448, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.09195402298850575, "writeRatioMax": 0.16091954022988506 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04597701149425287, "computeRatioMax": 0.04597701149425287, "endMs": "1665768412379", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "921", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665768412340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005747126436781609, "waitRatioMax": 0.005747126436781609, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.028735632183908046, "writeRatioMax": 0.028735632183908046 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "183", "elapsedMs": "566", "estimatedRunnableUnits": "0", "pendingUnits": "30", "totalSlotMs": "6937" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745580", "totalPartitionsProcessed": "0", "totalSlotMs": "6937", "transferredBytes": "0" }, "startTime": "1665768411857", "totalBytesProcessed": "113745580", "totalSlotMs": "6937" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2a9a3c4f_50ad_4ae8_83a7_611e76bb2020" }, "priority": "INTERACTIVE", "query": "-- start query 63 in stream 0 using template query63.tpl\n\n/*\nFor a given year calculate the \nmonthly sales of items of specific categories, classes and brands that were sold in stores and \ngroup the results by store manager. \n\nAdditionally, for every month and manager print the yearly average sales of those items.\n*/\n\nselect benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \nfrom (select i_manager_id\n ,sum(ss_sales_price) sum_sales\n ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n from item\n ,store_sales\n ,date_dim\n ,store\n where ss_item_sk = i_item_sk\n and ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and d_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11)\n and (( i_category in ('Books','Children','Electronics')\n and i_class in ('personal','portable','reference','self-help')\n and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t 'exportiunivamalg #9','scholaramalgamalg #9'))\n or( i_category in ('Women','Music','Men')\n and i_class in ('accessories','classical','fragrances','pants')\n and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n ,avg_monthly_sales\n ,sum_sales\nlimit 100\n;\n\n-- end query 63 in stream 0 using template query63.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "TV02KwMWbHp3QjiIEPYDhA==", "id": "test-project-364309:europe-west1.query63_1665777903", "jobReference": { "jobId": "query63_1665777903", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query63_1665777903?location=europe-west1", "statistics": { "creationTime": "1665777904418", "endTime": "1665777905035", "finalExecutionDurationMs": "415", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745580", "performanceInsights": { "avgPreviousExecutionMs": "473" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.07228915662650602, "computeRatioMax": 0.07228915662650602, "endMs": "1665777904615", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04216867469879518, "readRatioMax": 0.04216867469879518, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777904578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006024096385542169, "waitRatioMax": 0.006024096385542169, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.04819277108433735, "writeRatioMax": 0.04819277108433735 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.09036144578313253, "computeRatioMax": 0.09036144578313253, "endMs": "1665777904633", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04819277108433735, "readRatioMax": 0.04819277108433735, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777904595", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006024096385542169, "waitRatioMax": 0.006024096385542169, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.04819277108433735, "writeRatioMax": 0.04819277108433735 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.07228915662650602, "computeRatioMax": 0.07228915662650602, "endMs": "1665777904664", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03614457831325301, "readRatioMax": 0.03614457831325301, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777904634", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manager_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.06626506024096386, "waitRatioMax": 0.06626506024096386, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.09036144578313253, "writeRatioMax": 0.09036144578313253 }, { "completedParallelInputs": "6", "computeMsAvg": "136", "computeMsMax": "166", "computeRatioAvg": 0.8192771084337349, "computeRatioMax": 1, "endMs": "1665777904786", "id": "4", "inputStages": [ "1", "0", "3" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.06626506024096386, "readRatioMax": 0.10240963855421686, "recordsRead": "2888276", "recordsWritten": "4927", "shuffleOutputBytes": "172125", "shuffleOutputBytesSpilled": "0", "slotMs": "817", "startMs": "1665777904671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006024096385542169, "waitRatioMax": 0.006024096385542169, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.030120481927710843, "writeRatioMax": 0.03614457831325301 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.10843373493975904, "computeRatioMax": 0.10843373493975904, "endMs": "1665777904827", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4927", "recordsWritten": "1003", "shuffleOutputBytes": "26062", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777904802", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006024096385542169, "waitRatioMax": 0.006024096385542169, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05421686746987952, "writeRatioMax": 0.05421686746987952 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.060240963855421686, "computeRatioMax": 0.060240963855421686, "endMs": "1665777904888", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777904851", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006024096385542169, "waitRatioMax": 0.006024096385542169, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.1144578313253012, "writeRatioMax": 0.1144578313253012 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "12", "computeRatioAvg": 0.04819277108433735, "computeRatioMax": 0.07228915662650602, "endMs": "1665777904949", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2877", "startMs": "1665777904900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012048192771084338, "waitRatioMax": 0.018072289156626505, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.08433734939759036, "writeRatioMax": 0.10843373493975904 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.04819277108433735, "computeRatioMax": 0.10240963855421686, "endMs": "1665777904954", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1003", "recordsWritten": "921", "shuffleOutputBytes": "39603", "shuffleOutputBytesSpilled": "0", "slotMs": "2522", "startMs": "1665777904906", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC, $51 ASC, $52 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.018072289156626505, "waitRatioMax": 0.024096385542168676, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.0783132530120482, "writeRatioMax": 0.12048192771084337 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04819277108433735, "computeRatioMax": 0.04819277108433735, "endMs": "1665777904961", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "921", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777904916", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012048192771084338, "waitRatioMax": 0.012048192771084338, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.030120481927710843, "writeRatioMax": 0.030120481927710843 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "518", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6395" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745580", "totalPartitionsProcessed": "0", "totalSlotMs": "6395", "transferredBytes": "0" }, "startTime": "1665777904475", "totalBytesProcessed": "113745580", "totalSlotMs": "6395" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6a438376_9a4d_496d_9b82_ead519e4751e" }, "priority": "INTERACTIVE", "query": "-- start query 63 in stream 0 using template query63.tpl\n\n/*\nFor a given year calculate the \nmonthly sales of items of specific categories, classes and brands that were sold in stores and \ngroup the results by store manager. \n\nAdditionally, for every month and manager print the yearly average sales of those items.\n*/\n\nselect benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \nfrom (select i_manager_id\n ,sum(ss_sales_price) sum_sales\n ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n from item\n ,store_sales\n ,date_dim\n ,store\n where ss_item_sk = i_item_sk\n and ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and d_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11)\n and (( i_category in ('Books','Children','Electronics')\n and i_class in ('personal','portable','reference','self-help')\n and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t 'exportiunivamalg #9','scholaramalgamalg #9'))\n or( i_category in ('Women','Music','Men')\n and i_class in ('accessories','classical','fragrances','pants')\n and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n ,avg_monthly_sales\n ,sum_sales\nlimit 100\n;\n\n-- end query 63 in stream 0 using template query63.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Ix2U+KQMJX0vnU/QKP+MaA==", "id": "test-project-364309:europe-west1.query63_1665777906", "jobReference": { "jobId": "query63_1665777906", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query63_1665777906?location=europe-west1", "statistics": { "creationTime": "1665777906679", "endTime": "1665777907289", "finalExecutionDurationMs": "381", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745580", "performanceInsights": { "avgPreviousExecutionMs": "462" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.10236220472440945, "computeRatioMax": 0.10236220472440945, "endMs": "1665777906887", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.07086614173228346, "readRatioMax": 0.07086614173228346, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777906841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007874015748031496, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.13385826771653545, "writeRatioMax": 0.13385826771653545 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.11023622047244094, "computeRatioMax": 0.11023622047244094, "endMs": "1665777906897", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.06299212598425197, "readRatioMax": 0.06299212598425197, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777906856", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007874015748031496, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.09448818897637795, "writeRatioMax": 0.09448818897637795 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.12598425196850394, "computeRatioMax": 0.12598425196850394, "endMs": "1665777906930", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.047244094488188976, "readRatioMax": 0.047244094488188976, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777906898", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manager_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.05511811023622047, "waitRatioMax": 0.05511811023622047, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.12598425196850394, "writeRatioMax": 0.12598425196850394 }, { "completedParallelInputs": "6", "computeMsAvg": "105", "computeMsMax": "127", "computeRatioAvg": 0.8267716535433071, "computeRatioMax": 1, "endMs": "1665777907024", "id": "4", "inputStages": [ "3", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.08661417322834646, "readRatioMax": 0.13385826771653545, "recordsRead": "2888276", "recordsWritten": "4927", "shuffleOutputBytes": "172125", "shuffleOutputBytesSpilled": "0", "slotMs": "612", "startMs": "1665777906935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007874015748031496, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.031496062992125984, "writeRatioMax": 0.047244094488188976 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.05511811023622047, "computeRatioMax": 0.05511811023622047, "endMs": "1665777907044", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4927", "recordsWritten": "1003", "shuffleOutputBytes": "26062", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665777907031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007874015748031496, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.031496062992125984, "writeRatioMax": 0.031496062992125984 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.047244094488188976, "computeRatioMax": 0.047244094488188976, "endMs": "1665777907105", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777907068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007874015748031496, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.15748031496062992, "writeRatioMax": 0.15748031496062992 }, { "completedParallelInputs": "83", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.06299212598425197, "computeRatioMax": 0.11023622047244094, "endMs": "1665777907172", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3144", "startMs": "1665777907116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "9", "waitRatioAvg": 0.007874015748031496, "waitRatioMax": 0.07086614173228346, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.11811023622047244, "writeRatioMax": 0.23622047244094488 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.07086614173228346, "computeRatioMax": 0.12598425196850394, "endMs": "1665777907171", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1003", "recordsWritten": "921", "shuffleOutputBytes": "39603", "shuffleOutputBytesSpilled": "0", "slotMs": "3399", "startMs": "1665777907124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC, $51 ASC, $52 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "10", "waitMsMax": "11", "waitRatioAvg": 0.07874015748031496, "waitRatioMax": 0.08661417322834646, "writeMsAvg": "13", "writeMsMax": "17", "writeRatioAvg": 0.10236220472440945, "writeRatioMax": 0.13385826771653545 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.047244094488188976, "computeRatioMax": 0.047244094488188976, "endMs": "1665777907183", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "921", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665777907132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007874015748031496, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.015748031496062992, "writeRatioMax": 0.015748031496062992 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "196", "elapsedMs": "493", "estimatedRunnableUnits": "0", "pendingUnits": "17", "totalSlotMs": "7362" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745580", "totalPartitionsProcessed": "0", "totalSlotMs": "7362", "transferredBytes": "0" }, "startTime": "1665777906730", "totalBytesProcessed": "113745580", "totalSlotMs": "7362" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon859b842d_0baf_4259_8142_9eb89025cfc1" }, "priority": "INTERACTIVE", "query": "-- start query 63 in stream 0 using template query63.tpl\n\n/*\nFor a given year calculate the \nmonthly sales of items of specific categories, classes and brands that were sold in stores and \ngroup the results by store manager. \n\nAdditionally, for every month and manager print the yearly average sales of those items.\n*/\n\nselect benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \nfrom (select i_manager_id\n ,sum(ss_sales_price) sum_sales\n ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n from item\n ,store_sales\n ,date_dim\n ,store\n where ss_item_sk = i_item_sk\n and ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and d_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11)\n and (( i_category in ('Books','Children','Electronics')\n and i_class in ('personal','portable','reference','self-help')\n and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t 'exportiunivamalg #9','scholaramalgamalg #9'))\n or( i_category in ('Women','Music','Men')\n and i_class in ('accessories','classical','fragrances','pants')\n and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n ,avg_monthly_sales\n ,sum_sales\nlimit 100\n;\n\n-- end query 63 in stream 0 using template query63.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "C+PFvRQculKFeaetL+NnZw==", "id": "test-project-364309:europe-west1.query63_1665777908", "jobReference": { "jobId": "query63_1665777908", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query63_1665777908?location=europe-west1", "statistics": { "creationTime": "1665777909127", "endTime": "1665777909763", "finalExecutionDurationMs": "440", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745580", "performanceInsights": { "avgPreviousExecutionMs": "448" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04790419161676647, "computeRatioMax": 0.04790419161676647, "endMs": "1665777909312", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03592814371257485, "readRatioMax": 0.03592814371257485, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777909282", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.10778443113772455, "writeRatioMax": 0.10778443113772455 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.08982035928143713, "computeRatioMax": 0.08982035928143713, "endMs": "1665777909346", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04790419161676647, "readRatioMax": 0.04790419161676647, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777909299", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011976047904191617, "waitRatioMax": 0.011976047904191617, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.08982035928143713, "writeRatioMax": 0.08982035928143713 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.09580838323353294, "computeRatioMax": 0.09580838323353294, "endMs": "1665777909382", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.029940119760479042, "readRatioMax": 0.029940119760479042, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777909347", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manager_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "16", "waitMsMax": "16", "waitRatioAvg": 0.09580838323353294, "waitRatioMax": 0.09580838323353294, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.041916167664670656, "writeRatioMax": 0.041916167664670656 }, { "completedParallelInputs": "6", "computeMsAvg": "117", "computeMsMax": "167", "computeRatioAvg": 0.7005988023952096, "computeRatioMax": 1, "endMs": "1665777909500", "id": "4", "inputStages": [ "1", "3", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "15", "readRatioAvg": 0.059880239520958084, "readRatioMax": 0.08982035928143713, "recordsRead": "2888276", "recordsWritten": "4927", "shuffleOutputBytes": "172125", "shuffleOutputBytesSpilled": "0", "slotMs": "790", "startMs": "1665777909398", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "6", "writeMsMax": "11", "writeRatioAvg": 0.03592814371257485, "writeRatioMax": 0.0658682634730539 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.041916167664670656, "computeRatioMax": 0.041916167664670656, "endMs": "1665777909534", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4927", "recordsWritten": "1003", "shuffleOutputBytes": "26062", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665777909520", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.005988023952095809, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.029940119760479042, "writeRatioMax": 0.029940119760479042 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.029940119760479042, "computeRatioMax": 0.029940119760479042, "endMs": "1665777909597", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777909561", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011976047904191617, "waitRatioMax": 0.011976047904191617, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.10778443113772455, "writeRatioMax": 0.10778443113772455 }, { "completedParallelInputs": "95", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.04790419161676647, "computeRatioMax": 0.10179640718562874, "endMs": "1665777909667", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3415", "startMs": "1665777909608", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005988023952095809, "waitRatioMax": 0.011976047904191617, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.08383233532934131, "writeRatioMax": 0.12574850299401197 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.04790419161676647, "computeRatioMax": 0.09580838323353294, "endMs": "1665777909667", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1003", "recordsWritten": "921", "shuffleOutputBytes": "39603", "shuffleOutputBytesSpilled": "0", "slotMs": "3449", "startMs": "1665777909615", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC, $51 ASC, $52 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.023952095808383235, "waitRatioMax": 0.029940119760479042, "writeMsAvg": "22", "writeMsMax": "32", "writeRatioAvg": 0.1317365269461078, "writeRatioMax": 0.19161676646706588 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.041916167664670656, "computeRatioMax": 0.041916167664670656, "endMs": "1665777909679", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "921", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665777909625", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.029940119760479042, "waitRatioMax": 0.029940119760479042, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.017964071856287425, "writeRatioMax": 0.017964071856287425 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "208", "elapsedMs": "549", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "7815" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745580", "totalPartitionsProcessed": "0", "totalSlotMs": "7815", "transferredBytes": "0" }, "startTime": "1665777909171", "totalBytesProcessed": "113745580", "totalSlotMs": "7815" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon54244cd3_54a4_4734_b8ee_220b8b3ef651" }, "priority": "INTERACTIVE", "query": "-- start query 63 in stream 0 using template query63.tpl\n\n/*\nFor a given year calculate the \nmonthly sales of items of specific categories, classes and brands that were sold in stores and \ngroup the results by store manager. \n\nAdditionally, for every month and manager print the yearly average sales of those items.\n*/\n\nselect benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \nfrom (select i_manager_id\n ,sum(ss_sales_price) sum_sales\n ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n from item\n ,store_sales\n ,date_dim\n ,store\n where ss_item_sk = i_item_sk\n and ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and d_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11)\n and (( i_category in ('Books','Children','Electronics')\n and i_class in ('personal','portable','reference','self-help')\n and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t 'exportiunivamalg #9','scholaramalgamalg #9'))\n or( i_category in ('Women','Music','Men')\n and i_class in ('accessories','classical','fragrances','pants')\n and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n ,avg_monthly_sales\n ,sum_sales\nlimit 100\n;\n\n-- end query 63 in stream 0 using template query63.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Ciykvxnuhtb6eLcLPs8TBg==", "id": "test-project-364309:europe-west1.query63_1665777910", "jobReference": { "jobId": "query63_1665777910", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query63_1665777910?location=europe-west1", "statistics": { "creationTime": "1665777911297", "endTime": "1665777911930", "finalExecutionDurationMs": "407", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745580", "performanceInsights": { "avgPreviousExecutionMs": "447" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07857142857142857, "computeRatioMax": 0.07857142857142857, "endMs": "1665777911495", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.05, "readRatioMax": 0.05, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777911460", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.1357142857142857, "writeRatioMax": 0.1357142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07142857142857142, "computeRatioMax": 0.07142857142857142, "endMs": "1665777911512", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.06428571428571428, "readRatioMax": 0.06428571428571428, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777911481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07857142857142857, "writeRatioMax": 0.07857142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.09285714285714286, "computeRatioMax": 0.09285714285714286, "endMs": "1665777911548", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03571428571428571, "readRatioMax": 0.03571428571428571, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777911513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manager_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05714285714285714, "writeRatioMax": 0.05714285714285714 }, { "completedParallelInputs": "6", "computeMsAvg": "118", "computeMsMax": "140", "computeRatioAvg": 0.8428571428571429, "computeRatioMax": 1, "endMs": "1665777911676", "id": "4", "inputStages": [ "3", "0", "1" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.08571428571428572, "readRatioMax": 0.11428571428571428, "recordsRead": "2888276", "recordsWritten": "4927", "shuffleOutputBytes": "172125", "shuffleOutputBytesSpilled": "0", "slotMs": "820", "startMs": "1665777911562", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.05 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07142857142857142, "computeRatioMax": 0.07142857142857142, "endMs": "1665777911700", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4927", "recordsWritten": "1003", "shuffleOutputBytes": "26062", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665777911684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.05714285714285714, "endMs": "1665777911755", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777911716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.1357142857142857, "writeRatioMax": 0.1357142857142857 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.09285714285714286, "endMs": "1665777911818", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2908", "startMs": "1665777911765", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.014285714285714285, "waitRatioMax": 0.02142857142857143, "writeMsAvg": "13", "writeMsMax": "28", "writeRatioAvg": 0.09285714285714286, "writeRatioMax": 0.2 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.12142857142857143, "endMs": "1665777911822", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1003", "recordsWritten": "921", "shuffleOutputBytes": "39603", "shuffleOutputBytesSpilled": "0", "slotMs": "3138", "startMs": "1665777911770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC, $51 ASC, $52 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.02857142857142857, "waitRatioMax": 0.04285714285714286, "writeMsAvg": "18", "writeMsMax": "33", "writeRatioAvg": 0.12857142857142856, "writeRatioMax": 0.2357142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06428571428571428, "computeRatioMax": 0.06428571428571428, "endMs": "1665777911829", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "921", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665777911779", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.02142857142857143, "waitRatioMax": 0.02142857142857143, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02142857142857143, "writeRatioMax": 0.02142857142857143 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "507", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7074" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745580", "totalPartitionsProcessed": "0", "totalSlotMs": "7074", "transferredBytes": "0" }, "startTime": "1665777911358", "totalBytesProcessed": "113745580", "totalSlotMs": "7074" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc29d38cb_75d3_47ce_bed1_8766453f0b44" }, "priority": "INTERACTIVE", "query": "-- start query 63 in stream 0 using template query63.tpl\n\n/*\nFor a given year calculate the \nmonthly sales of items of specific categories, classes and brands that were sold in stores and \ngroup the results by store manager. \n\nAdditionally, for every month and manager print the yearly average sales of those items.\n*/\n\nselect benchmark.sh benchmark_938pm.sh benchmark_alaa.sh done json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \nfrom (select i_manager_id\n ,sum(ss_sales_price) sum_sales\n ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n from item\n ,store_sales\n ,date_dim\n ,store\n where ss_item_sk = i_item_sk\n and ss_sold_date_sk = d_date_sk\n and ss_store_sk = s_store_sk\n and d_month_seq in (1200,1200+1,1200+2,1200+3,1200+4,1200+5,1200+6,1200+7,1200+8,1200+9,1200+10,1200+11)\n and (( i_category in ('Books','Children','Electronics')\n and i_class in ('personal','portable','reference','self-help')\n and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t 'exportiunivamalg #9','scholaramalgamalg #9'))\n or( i_category in ('Women','Music','Men')\n and i_class in ('accessories','classical','fragrances','pants')\n and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n ,avg_monthly_sales\n ,sum_sales\nlimit 100\n;\n\n-- end query 63 in stream 0 using template query63.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "zTS5jgZ83b7ViaeFvVweUQ==", "id": "test-project-364309:europe-west1.query63_1665777912", "jobReference": { "jobId": "query63_1665777912", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query63_1665777912?location=europe-west1", "statistics": { "creationTime": "1665777913531", "endTime": "1665777914206", "finalExecutionDurationMs": "414", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113745580", "performanceInsights": { "avgPreviousExecutionMs": "442" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0625, "computeRatioMax": 0.0625, "endMs": "1665777913751", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.041666666666666664, "readRatioMax": 0.041666666666666664, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777913716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0763888888888889, "writeRatioMax": 0.0763888888888889 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0763888888888889, "computeRatioMax": 0.0763888888888889, "endMs": "1665777913758", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04861111111111111, "readRatioMax": 0.04861111111111111, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "6588", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777913729", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_month_seq", "FROM date_dim", "WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.09722222222222222, "writeRatioMax": 0.09722222222222222 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.09722222222222222, "computeRatioMax": 0.09722222222222222, "endMs": "1665777913791", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.034722222222222224, "readRatioMax": 0.034722222222222224, "recordsRead": "18000", "recordsWritten": "934", "shuffleOutputBytes": "16812", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777913759", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $34:i_manager_id, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $34", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.013888888888888888, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "6", "computeMsAvg": "116", "computeMsMax": "144", "computeRatioAvg": 0.8055555555555556, "computeRatioMax": 1, "endMs": "1665777913914", "id": "4", "inputStages": [ "1", "0", "3" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.0763888888888889, "readRatioMax": 0.09722222222222222, "recordsRead": "2888276", "recordsWritten": "4927", "shuffleOutputBytes": "172125", "shuffleOutputBytesSpilled": "0", "slotMs": "677", "startMs": "1665777913806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $34", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $220 := $212, $221 := $211", "$110 := SUM($210)" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $203, $212 := $202", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "JOIN", "substeps": [ "$200 := $192, $201 := $193, $202 := $190, $203 := $22", "INNER HASH JOIN EACH WITH ALL ON $191 = $20" ] }, { "kind": "JOIN", "substeps": [ "$191 := $10, $192 := $12, $193 := $13, $190 := $34", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$221, $220, $110", "TO __stage04_output", "BY HASH($220, $221)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.125, "computeRatioMax": 0.125, "endMs": "1665777913947", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4927", "recordsWritten": "1003", "shuffleOutputBytes": "26062", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777913924", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$221, $220, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $220, $231 := $221", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$230, $70", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.034722222222222224 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08333333333333333, "computeRatioMax": 0.08333333333333333, "endMs": "1665777914016", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777913973", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $260", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($270, 0)", "$101 := coalesce($270, 1)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$150 := ROOT_AVG($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.006944444444444444, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.1527777777777778, "writeRatioMax": 0.1527777777777778 }, { "completedParallelInputs": "92", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.09722222222222222, "endMs": "1665777914076", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3266", "startMs": "1665777914023", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.006944444444444444, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.10416666666666667, "writeRatioMax": 0.1875 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.0625, "computeRatioMax": 0.10416666666666667, "endMs": "1665777914076", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1003", "recordsWritten": "921", "shuffleOutputBytes": "39603", "shuffleOutputBytesSpilled": "0", "slotMs": "3074", "startMs": "1665777914028", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $70", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$130, $131", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$50 ASC, $51 ASC, $52 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($51, NUMERIC<...>), divide(abs(subtract($52, $51)), $51), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := AVG($241) OVER (PARTITION BY $240 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$120 ASC" ] }, { "kind": "JOIN", "substeps": [ "$280 := $140, $281 := $141, $282 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($140, 0)", "$91 := coalesce($140, 1)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.020833333333333332, "waitRatioMax": 0.027777777777777776, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.09027777777777778, "writeRatioMax": 0.125 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.05555555555555555, "endMs": "1665777914088", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "921", "recordsWritten": "100", "shuffleOutputBytes": "4300", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665777914037", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $291, $292", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$290 ASC, $291 ASC, $292 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $302", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.020833333333333332, "waitRatioMax": 0.020833333333333332, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.034722222222222224, "writeRatioMax": 0.034722222222222224 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "205", "elapsedMs": "535", "estimatedRunnableUnits": "0", "pendingUnits": "8", "totalSlotMs": "7263" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113745580", "totalPartitionsProcessed": "0", "totalSlotMs": "7263", "transferredBytes": "0" }, "startTime": "1665777913601", "totalBytesProcessed": "113745580", "totalSlotMs": "7263" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
