{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonaa04b8e1_d6df_4350_ba65_145eb26b6602" }, "priority": "INTERACTIVE", "query": "select ss_customer_sk\n ,sum(act_sales) sumsales\n from (select ss_item_sk\n ,ss_ticket_number\n ,ss_customer_sk\n ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n else (ss_quantity*ss_sales_price) end act_sales\n from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n and sr_ticket_number = ss_ticket_number)\n ,reason\n where sr_reason_sk = r_reason_sk\n and r_reason_desc = 'reason 28') t\n group by ss_customer_sk\n order by sumsales, ss_customer_sk\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "xQswVKq8l4+ARtO8nW7oZw==", "id": "test-project-364309:europe-west1.query93_1665768517", "jobReference": { "jobId": "query93_1665768517", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query93_1665768517?location=europe-west1", "statistics": { "creationTime": "1665768518053", "endTime": "1665768519497", "finalExecutionDurationMs": "1267", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "143147752", "performanceInsights": { "avgPreviousExecutionMs": "597" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.01047486033519553, "computeRatioMax": 0.01047486033519553, "endMs": "1665768518246", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0034916201117318434, "readRatioMax": 0.0034916201117318434, "recordsRead": "35", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768518204", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:r_reason_sk, $21:r_reason_desc", "FROM reason", "WHERE equal($21, 'reason 28')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006983240223463687, "waitRatioMax": 0.0006983240223463687, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.012569832402234637, "writeRatioMax": 0.012569832402234637 }, { "completedParallelInputs": "1", "computeMsAvg": "221", "computeMsMax": "221", "computeRatioAvg": 0.1543296089385475, "computeRatioMax": 0.1543296089385475, "endMs": "1665768518393", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.011871508379888268, "readRatioMax": 0.011871508379888268, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "10190128", "shuffleOutputBytesSpilled": "0", "slotMs": "234", "startMs": "1665768518222", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006983240223463687, "waitRatioMax": 0.0006983240223463687, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01047486033519553, "writeRatioMax": 0.01047486033519553 }, { "completedParallelInputs": "6", "computeMsAvg": "818", "computeMsMax": "1432", "computeRatioAvg": 0.5712290502793296, "computeRatioMax": 1, "endMs": "1665768519290", "id": "2", "inputStages": [ "1", "0" ], "name": "S02: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "42", "readRatioAvg": 0.013966480446927373, "readRatioMax": 0.029329608938547486, "recordsRead": "4605494", "recordsWritten": "7555", "shuffleOutputBytes": "192046", "shuffleOutputBytesSpilled": "0", "slotMs": "4217", "startMs": "1665768518423", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $70", "$40 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS NUMERIC), $72), multiply(CAST($71 AS NUMERIC), $72))" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $62, $73 := $64", "INNER HASH JOIN EACH WITH ALL ON $63 = $20" ] }, { "kind": "JOIN", "substeps": [ "$60 := $2, $61 := $4, $62 := $5, $63 := $11, $64 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $1 = $10, $3 = $12" ] }, { "kind": "WRITE", "substeps": [ "$80, $40", "TO __stage02_output", "BY HASH($80)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0006983240223463687, "waitRatioMax": 0.0013966480446927375, "writeMsAvg": "8", "writeMsMax": "23", "writeRatioAvg": 0.00558659217877095, "writeRatioMax": 0.01606145251396648 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.013966480446927373, "computeRatioMax": 0.013966480446927373, "endMs": "1665768519396", "id": "3", "inputStages": [ "2" ], "name": "S03: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7555", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768519368", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $40", "FROM __stage02_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $90 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80", "$30 := SUM($40)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0013966480446927375, "waitRatioMax": 0.0013966480446927375, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0006983240223463687, "writeRatioMax": 0.0006983240223463687 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.018156424581005588, "computeRatioMax": 0.018156424581005588, "endMs": "1665768519437", "id": "4", "inputStages": [ "3" ], "name": "S04: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768519387", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$101 ASC, $100 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006983240223463687, "waitRatioMax": 0.0006983240223463687, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.007681564245810056, "writeRatioMax": 0.007681564245810056 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "2", "elapsedMs": "609", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "735" }, { "activeUnits": "2", "completedUnits": "10", "elapsedMs": "1361", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4594" } ], "totalBytesBilled": "143654912", "totalBytesProcessed": "143147752", "totalPartitionsProcessed": "0", "totalSlotMs": "4594", "transferredBytes": "0" }, "startTime": "1665768518096", "totalBytesProcessed": "143147752", "totalSlotMs": "4594" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbf1c7473_bd7e_4e0c_8ce4_2fb2e5f04e84" }, "priority": "INTERACTIVE", "query": "select ss_customer_sk\n ,sum(act_sales) sumsales\n from (select ss_item_sk\n ,ss_ticket_number\n ,ss_customer_sk\n ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n else (ss_quantity*ss_sales_price) end act_sales\n from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n and sr_ticket_number = ss_ticket_number)\n ,reason\n where sr_reason_sk = r_reason_sk\n and r_reason_desc = 'reason 28') t\n group by ss_customer_sk\n order by sumsales, ss_customer_sk\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "vsOG5nS+bcUDeHg0rZAUnw==", "id": "test-project-364309:europe-west1.query93_1665778818", "jobReference": { "jobId": "query93_1665778818", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query93_1665778818?location=europe-west1", "statistics": { "creationTime": "1665778819319", "endTime": "1665778820338", "finalExecutionDurationMs": "812", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "143147752", "performanceInsights": { "avgPreviousExecutionMs": "821" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010778443113772455, "computeRatioMax": 0.010778443113772455, "endMs": "1665778819514", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005988023952095809, "readRatioMax": 0.005988023952095809, "recordsRead": "35", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778819483", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:r_reason_sk, $21:r_reason_desc", "FROM reason", "WHERE equal($21, 'reason 28')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011976047904191617, "waitRatioMax": 0.0011976047904191617, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02155688622754491, "writeRatioMax": 0.02155688622754491 }, { "completedParallelInputs": "1", "computeMsAvg": "269", "computeMsMax": "269", "computeRatioAvg": 0.3221556886227545, "computeRatioMax": 0.3221556886227545, "endMs": "1665778819707", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.013173652694610778, "readRatioMax": 0.013173652694610778, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "10190128", "shuffleOutputBytesSpilled": "0", "slotMs": "329", "startMs": "1665778819497", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011976047904191617, "waitRatioMax": 0.0011976047904191617, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.019161676646706587, "writeRatioMax": 0.019161676646706587 }, { "completedParallelInputs": "6", "computeMsAvg": "651", "computeMsMax": "835", "computeRatioAvg": 0.7796407185628742, "computeRatioMax": 1, "endMs": "1665778820199", "id": "2", "inputStages": [ "0", "1" ], "name": "S02: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "21", "readRatioAvg": 0.02155688622754491, "readRatioMax": 0.025149700598802394, "recordsRead": "4605494", "recordsWritten": "7555", "shuffleOutputBytes": "192046", "shuffleOutputBytesSpilled": "0", "slotMs": "3626", "startMs": "1665778819747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $70", "$40 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS NUMERIC), $72), multiply(CAST($71 AS NUMERIC), $72))" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $62, $73 := $64", "INNER HASH JOIN EACH WITH ALL ON $63 = $20" ] }, { "kind": "JOIN", "substeps": [ "$60 := $2, $61 := $4, $62 := $5, $63 := $11, $64 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $1 = $10, $3 = $12" ] }, { "kind": "WRITE", "substeps": [ "$80, $40", "TO __stage02_output", "BY HASH($80)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011976047904191617, "waitRatioMax": 0.0011976047904191617, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.005988023952095809, "writeRatioMax": 0.00718562874251497 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011976047904191617, "computeRatioMax": 0.011976047904191617, "endMs": "1665778820219", "id": "3", "inputStages": [ "2" ], "name": "S03: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7555", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665778820204", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $40", "FROM __stage02_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $90 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80", "$30 := SUM($40)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011976047904191617, "waitRatioMax": 0.0011976047904191617, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0011976047904191617, "writeRatioMax": 0.0011976047904191617 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.015568862275449102, "computeRatioMax": 0.015568862275449102, "endMs": "1665778820260", "id": "4", "inputStages": [ "3" ], "name": "S04: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778820217", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$101 ASC, $100 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011976047904191617, "waitRatioMax": 0.0011976047904191617, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.017964071856287425, "writeRatioMax": 0.017964071856287425 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "2", "elapsedMs": "592", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "729" }, { "activeUnits": "6", "completedUnits": "10", "elapsedMs": "897", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4070" } ], "totalBytesBilled": "143654912", "totalBytesProcessed": "143147752", "totalPartitionsProcessed": "0", "totalSlotMs": "4070", "transferredBytes": "0" }, "startTime": "1665778819392", "totalBytesProcessed": "143147752", "totalSlotMs": "4070" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf8c5168c_7c71_4f3c_9948_c1708808d873" }, "priority": "INTERACTIVE", "query": "select ss_customer_sk\n ,sum(act_sales) sumsales\n from (select ss_item_sk\n ,ss_ticket_number\n ,ss_customer_sk\n ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n else (ss_quantity*ss_sales_price) end act_sales\n from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n and sr_ticket_number = ss_ticket_number)\n ,reason\n where sr_reason_sk = r_reason_sk\n and r_reason_desc = 'reason 28') t\n group by ss_customer_sk\n order by sumsales, ss_customer_sk\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "rVbmO12Q/vnTSTTwx2QIhQ==", "id": "test-project-364309:europe-west1.query93_1665778821", "jobReference": { "jobId": "query93_1665778821", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query93_1665778821?location=europe-west1", "statistics": { "creationTime": "1665778821954", "endTime": "1665778822917", "finalExecutionDurationMs": "792", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "143147752", "performanceInsights": { "avgPreviousExecutionMs": "819" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.009584664536741214, "computeRatioMax": 0.009584664536741214, "endMs": "1665778822125", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005324813631522897, "readRatioMax": 0.005324813631522897, "recordsRead": "35", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778822096", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:r_reason_sk, $21:r_reason_desc", "FROM reason", "WHERE equal($21, 'reason 28')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010649627263045794, "waitRatioMax": 0.0010649627263045794, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.01810436634717785, "writeRatioMax": 0.01810436634717785 }, { "completedParallelInputs": "1", "computeMsAvg": "140", "computeMsMax": "140", "computeRatioAvg": 0.14909478168264112, "computeRatioMax": 0.14909478168264112, "endMs": "1665778822245", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.011714589989350373, "readRatioMax": 0.011714589989350373, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "10190128", "shuffleOutputBytesSpilled": "0", "slotMs": "201", "startMs": "1665778822114", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002129925452609159, "waitRatioMax": 0.002129925452609159, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.014909478168264111, "writeRatioMax": 0.014909478168264111 }, { "completedParallelInputs": "6", "computeMsAvg": "683", "computeMsMax": "939", "computeRatioAvg": 0.7273695420660277, "computeRatioMax": 1, "endMs": "1665778822767", "id": "2", "inputStages": [ "1", "0" ], "name": "S02: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "29", "readRatioAvg": 0.019169329073482427, "readRatioMax": 0.0308839190628328, "recordsRead": "4605494", "recordsWritten": "7555", "shuffleOutputBytes": "192046", "shuffleOutputBytesSpilled": "0", "slotMs": "3627", "startMs": "1665778822262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $70", "$40 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS NUMERIC), $72), multiply(CAST($71 AS NUMERIC), $72))" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $62, $73 := $64", "INNER HASH JOIN EACH WITH ALL ON $63 = $20" ] }, { "kind": "JOIN", "substeps": [ "$60 := $2, $61 := $4, $62 := $5, $63 := $11, $64 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $1 = $10, $3 = $12" ] }, { "kind": "WRITE", "substeps": [ "$80, $40", "TO __stage02_output", "BY HASH($80)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.002129925452609159, "waitRatioMax": 0.004259850905218318, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.006389776357827476, "writeRatioMax": 0.008519701810436636 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.010649627263045794, "computeRatioMax": 0.010649627263045794, "endMs": "1665778822791", "id": "3", "inputStages": [ "2" ], "name": "S03: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7555", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665778822777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $40", "FROM __stage02_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $90 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80", "$30 := SUM($40)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010649627263045794, "waitRatioMax": 0.0010649627263045794, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0010649627263045794, "writeRatioMax": 0.0010649627263045794 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.01810436634717785, "computeRatioMax": 0.01810436634717785, "endMs": "1665778822844", "id": "4", "inputStages": [ "3" ], "name": "S04: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778822800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$101 ASC, $100 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002129925452609159, "waitRatioMax": 0.002129925452609159, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.0308839190628328, "writeRatioMax": 0.0308839190628328 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "4", "completedUnits": "4", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "1871" }, { "activeUnits": "4", "completedUnits": "10", "elapsedMs": "872", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3929" } ], "totalBytesBilled": "143654912", "totalBytesProcessed": "143147752", "totalPartitionsProcessed": "0", "totalSlotMs": "3929", "transferredBytes": "0" }, "startTime": "1665778821999", "totalBytesProcessed": "143147752", "totalSlotMs": "3929" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon888661f8_94d7_4c07_8414_74fde4161df0" }, "priority": "INTERACTIVE", "query": "select ss_customer_sk\n ,sum(act_sales) sumsales\n from (select ss_item_sk\n ,ss_ticket_number\n ,ss_customer_sk\n ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n else (ss_quantity*ss_sales_price) end act_sales\n from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n and sr_ticket_number = ss_ticket_number)\n ,reason\n where sr_reason_sk = r_reason_sk\n and r_reason_desc = 'reason 28') t\n group by ss_customer_sk\n order by sumsales, ss_customer_sk\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "cMelKmcT68YoD20euu2NIw==", "id": "test-project-364309:europe-west1.query93_1665778823", "jobReference": { "jobId": "query93_1665778823", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query93_1665778823?location=europe-west1", "statistics": { "creationTime": "1665778824587", "endTime": "1665778825654", "finalExecutionDurationMs": "828", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "143147752", "performanceInsights": { "avgPreviousExecutionMs": "813" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.007398273736128237, "computeRatioMax": 0.007398273736128237, "endMs": "1665778824830", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.0036991368680641184, "readRatioMax": 0.0036991368680641184, "recordsRead": "35", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778824792", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:r_reason_sk, $21:r_reason_desc", "FROM reason", "WHERE equal($21, 'reason 28')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002466091245376079, "waitRatioMax": 0.002466091245376079, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.018495684340320593, "writeRatioMax": 0.018495684340320593 }, { "completedParallelInputs": "1", "computeMsAvg": "381", "computeMsMax": "381", "computeRatioAvg": 0.46979038224414305, "computeRatioMax": 0.46979038224414305, "endMs": "1665778825050", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.012330456226880395, "readRatioMax": 0.012330456226880395, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "10190128", "shuffleOutputBytesSpilled": "0", "slotMs": "325", "startMs": "1665778824807", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002466091245376079, "waitRatioMax": 0.002466091245376079, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01726263871763255, "writeRatioMax": 0.01726263871763255 }, { "completedParallelInputs": "6", "computeMsAvg": "707", "computeMsMax": "811", "computeRatioAvg": 0.8717632552404438, "computeRatioMax": 1, "endMs": "1665778825519", "id": "2", "inputStages": [ "0", "1" ], "name": "S02: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "23", "readRatioAvg": 0.01972872996300863, "readRatioMax": 0.02836004932182491, "recordsRead": "4605494", "recordsWritten": "7555", "shuffleOutputBytes": "192046", "shuffleOutputBytesSpilled": "0", "slotMs": "3580", "startMs": "1665778825059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $70", "$40 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS NUMERIC), $72), multiply(CAST($71 AS NUMERIC), $72))" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $62, $73 := $64", "INNER HASH JOIN EACH WITH ALL ON $63 = $20" ] }, { "kind": "JOIN", "substeps": [ "$60 := $2, $61 := $4, $62 := $5, $63 := $11, $64 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $1 = $10, $3 = $12" ] }, { "kind": "WRITE", "substeps": [ "$80, $40", "TO __stage02_output", "BY HASH($80)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002466091245376079, "waitRatioMax": 0.002466091245376079, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.007398273736128237, "writeRatioMax": 0.009864364981504316 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009864364981504316, "computeRatioMax": 0.009864364981504316, "endMs": "1665778825538", "id": "3", "inputStages": [ "2" ], "name": "S03: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7555", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665778825526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $40", "FROM __stage02_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $90 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80", "$30 := SUM($40)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012330456226880395, "waitRatioMax": 0.0012330456226880395, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.009864364981504316, "computeRatioMax": 0.009864364981504316, "endMs": "1665778825574", "id": "4", "inputStages": [ "3" ], "name": "S04: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778825540", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$101 ASC, $100 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012330456226880395, "waitRatioMax": 0.0012330456226880395, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01726263871763255, "writeRatioMax": 0.01726263871763255 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "2", "elapsedMs": "622", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "651" }, { "activeUnits": "6", "completedUnits": "10", "elapsedMs": "933", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3981" } ], "totalBytesBilled": "143654912", "totalBytesProcessed": "143147752", "totalPartitionsProcessed": "0", "totalSlotMs": "3981", "transferredBytes": "0" }, "startTime": "1665778824671", "totalBytesProcessed": "143147752", "totalSlotMs": "3981" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon52ac4625_fae0_4645_b683_6044d1eedce2" }, "priority": "INTERACTIVE", "query": "select ss_customer_sk\n ,sum(act_sales) sumsales\n from (select ss_item_sk\n ,ss_ticket_number\n ,ss_customer_sk\n ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n else (ss_quantity*ss_sales_price) end act_sales\n from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n and sr_ticket_number = ss_ticket_number)\n ,reason\n where sr_reason_sk = r_reason_sk\n and r_reason_desc = 'reason 28') t\n group by ss_customer_sk\n order by sumsales, ss_customer_sk\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "b/H5KqQg27/3oUwpHR5weA==", "id": "test-project-364309:europe-west1.query93_1665778826", "jobReference": { "jobId": "query93_1665778826", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query93_1665778826?location=europe-west1", "statistics": { "creationTime": "1665778827425", "endTime": "1665778828326", "finalExecutionDurationMs": "709", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "143147752", "performanceInsights": { "avgPreviousExecutionMs": "816" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012517385257301807, "computeRatioMax": 0.012517385257301807, "endMs": "1665778827611", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006954102920723227, "readRatioMax": 0.006954102920723227, "recordsRead": "35", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778827579", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:r_reason_sk, $21:r_reason_desc", "FROM reason", "WHERE equal($21, 'reason 28')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.027816411682892908, "writeRatioMax": 0.027816411682892908 }, { "completedParallelInputs": "1", "computeMsAvg": "230", "computeMsMax": "230", "computeRatioAvg": 0.3198887343532684, "computeRatioMax": 0.3198887343532684, "endMs": "1665778827723", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.013908205841446454, "readRatioMax": 0.013908205841446454, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "10190128", "shuffleOutputBytesSpilled": "0", "slotMs": "228", "startMs": "1665778827593", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.016689847009735744, "writeRatioMax": 0.016689847009735744 }, { "completedParallelInputs": "6", "computeMsAvg": "568", "computeMsMax": "719", "computeRatioAvg": 0.7899860917941586, "computeRatioMax": 1, "endMs": "1665778828191", "id": "2", "inputStages": [ "0", "1" ], "name": "S02: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.022253129346314324, "readRatioMax": 0.027816411682892908, "recordsRead": "4605494", "recordsWritten": "7555", "shuffleOutputBytes": "192046", "shuffleOutputBytesSpilled": "0", "slotMs": "2985", "startMs": "1665778827747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $70", "$40 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS NUMERIC), $72), multiply(CAST($71 AS NUMERIC), $72))" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $62, $73 := $64", "INNER HASH JOIN EACH WITH ALL ON $63 = $20" ] }, { "kind": "JOIN", "substeps": [ "$60 := $2, $61 := $4, $62 := $5, $63 := $11, $64 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $1 = $10, $3 = $12" ] }, { "kind": "WRITE", "substeps": [ "$80, $40", "TO __stage02_output", "BY HASH($80)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0027816411682892906, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.005563282336578581, "writeRatioMax": 0.006954102920723227 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.016689847009735744, "computeRatioMax": 0.016689847009735744, "endMs": "1665778828215", "id": "3", "inputStages": [ "2" ], "name": "S03: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7555", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665778828203", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $40", "FROM __stage02_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $90 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80", "$30 := SUM($40)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.011126564673157162, "computeRatioMax": 0.011126564673157162, "endMs": "1665778828252", "id": "4", "inputStages": [ "3" ], "name": "S04: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778828217", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$101 ASC, $100 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013908205841446453, "waitRatioMax": 0.0013908205841446453, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.022253129346314324, "writeRatioMax": 0.022253129346314324 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "5", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "2081" }, { "activeUnits": "3", "completedUnits": "10", "elapsedMs": "796", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3298" } ], "totalBytesBilled": "143654912", "totalBytesProcessed": "143147752", "totalPartitionsProcessed": "0", "totalSlotMs": "3298", "transferredBytes": "0" }, "startTime": "1665778827481", "totalBytesProcessed": "143147752", "totalSlotMs": "3298" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4dbf7178_865c_485c_bf52_a8873eb190d0" }, "priority": "INTERACTIVE", "query": "select ss_customer_sk\n ,sum(act_sales) sumsales\n from (select ss_item_sk\n ,ss_ticket_number\n ,ss_customer_sk\n ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n else (ss_quantity*ss_sales_price) end act_sales\n from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n and sr_ticket_number = ss_ticket_number)\n ,reason\n where sr_reason_sk = r_reason_sk\n and r_reason_desc = 'reason 28') t\n group by ss_customer_sk\n order by sumsales, ss_customer_sk\n limit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "YBPEI9EGWgP6C1oyz77Q0g==", "id": "test-project-364309:europe-west1.query93_1665778829", "jobReference": { "jobId": "query93_1665778829", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query93_1665778829?location=europe-west1", "statistics": { "creationTime": "1665778829974", "endTime": "1665778831232", "finalExecutionDurationMs": "1068", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "143147752", "performanceInsights": { "avgPreviousExecutionMs": "801" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006187161639597835, "computeRatioMax": 0.006187161639597835, "endMs": "1665778830147", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0038669760247486465, "readRatioMax": 0.0038669760247486465, "recordsRead": "35", "recordsWritten": "1", "shuffleOutputBytes": "9", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778830116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:r_reason_sk, $21:r_reason_desc", "FROM reason", "WHERE equal($21, 'reason 28')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007733952049497294, "waitRatioMax": 0.0007733952049497294, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.013147718484145398, "writeRatioMax": 0.013147718484145398 }, { "completedParallelInputs": "1", "computeMsAvg": "179", "computeMsMax": "179", "computeRatioAvg": 0.13843774168600154, "computeRatioMax": 0.13843774168600154, "endMs": "1665778830304", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.01082753286929621, "readRatioMax": 0.01082753286929621, "recordsRead": "287514", "recordsWritten": "287514", "shuffleOutputBytes": "10190128", "shuffleOutputBytesSpilled": "0", "slotMs": "174", "startMs": "1665778830135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity", "FROM store_returns" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13", "TO __stage01_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.0038669760247486465, "waitRatioMax": 0.0038669760247486465, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01237432327919567, "writeRatioMax": 0.01237432327919567 }, { "completedParallelInputs": "6", "computeMsAvg": "844", "computeMsMax": "1293", "computeRatioAvg": 0.6527455529775715, "computeRatioMax": 1, "endMs": "1665778831077", "id": "2", "inputStages": [ "1", "0" ], "name": "S02: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "25", "readRatioAvg": 0.014694508894044857, "readRatioMax": 0.019334880123743233, "recordsRead": "4605494", "recordsWritten": "7555", "shuffleOutputBytes": "192046", "shuffleOutputBytesSpilled": "0", "slotMs": "4700", "startMs": "1665778830337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $80 := $70", "$40 := SUM($50)" ] }, { "kind": "COMPUTE", "substeps": [ "$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS NUMERIC), $72), multiply(CAST($71 AS NUMERIC), $72))" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $62, $73 := $64", "INNER HASH JOIN EACH WITH ALL ON $63 = $20" ] }, { "kind": "JOIN", "substeps": [ "$60 := $2, $61 := $4, $62 := $5, $63 := $11, $64 := $13", "LEFT OUTER HASH JOIN EACH WITH ALL ON $1 = $10, $3 = $12" ] }, { "kind": "WRITE", "substeps": [ "$80, $40", "TO __stage02_output", "BY HASH($80)" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0015467904098994587, "waitRatioMax": 0.004640371229698376, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.004640371229698376, "writeRatioMax": 0.005413766434648105 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.01082753286929621, "computeRatioMax": 0.01082753286929621, "endMs": "1665778831112", "id": "3", "inputStages": [ "2" ], "name": "S03: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7555", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665778831095", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $40", "FROM __stage02_output" ] }, { "kind": "SORT", "substeps": [ "$30 ASC, $90 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $90 := $80", "$30 := SUM($40)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015467904098994587, "waitRatioMax": 0.0015467904098994587, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0015467904098994587, "writeRatioMax": 0.0015467904098994587 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.008507347254447023, "computeRatioMax": 0.008507347254447023, "endMs": "1665778831148", "id": "4", "inputStages": [ "3" ], "name": "S04: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "1000", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778831111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101", "FROM __stage03_output" ] }, { "kind": "SORT", "substeps": [ "$101 ASC, $100 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015467904098994587, "waitRatioMax": 0.0015467904098994587, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010054137664346482, "writeRatioMax": 0.010054137664346482 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "reason" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "2", "elapsedMs": "592", "estimatedRunnableUnits": "0", "pendingUnits": "6", "totalSlotMs": "381" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "1152", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4971" } ], "totalBytesBilled": "143654912", "totalBytesProcessed": "143147752", "totalPartitionsProcessed": "0", "totalSlotMs": "4971", "transferredBytes": "0" }, "startTime": "1665778830025", "totalBytesProcessed": "143147752", "totalSlotMs": "4971" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
