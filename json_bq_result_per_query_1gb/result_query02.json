{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5dfb7078_c652_4b86_a0ca_380da8a1022c" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "HiLUjSLauSCjnLjhFHTlrw==", "id": "test-project-364309:europe-west1.query02_1665768201", "jobReference": { "jobId": "query02_1665768201", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665768201?location=europe-west1", "statistics": { "creationTime": "1665768201946", "endTime": "1665768202950", "finalExecutionDurationMs": "799", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "784" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.06271186440677966, "computeRatioMax": 0.06271186440677966, "endMs": "1665768202143", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011864406779661017, "readRatioMax": 0.011864406779661017, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768202103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01864406779661017, "writeRatioMax": 0.01864406779661017 }, { "completedParallelInputs": "1", "computeMsAvg": "53", "computeMsMax": "53", "computeRatioAvg": 0.08983050847457627, "computeRatioMax": 0.08983050847457627, "endMs": "1665768202178", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00847457627118644, "readRatioMax": 0.00847457627118644, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665768202135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.006779661016949152, "waitRatioMax": 0.006779661016949152, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "6", "computeMsAvg": "366", "computeMsMax": "580", "computeRatioAvg": 0.6203389830508474, "computeRatioMax": 0.9830508474576272, "endMs": "1665768202525", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.020338983050847456, "readRatioMax": 0.025423728813559324, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2772", "startMs": "1665768202158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "2", "waitMsMax": "7", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.011864406779661017, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.00847457627118644, "writeRatioMax": 0.011864406779661017 }, { "completedParallelInputs": "6", "computeMsAvg": "356", "computeMsMax": "590", "computeRatioAvg": 0.6033898305084746, "computeRatioMax": 1, "endMs": "1665768202552", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "18", "readRatioAvg": 0.023728813559322035, "readRatioMax": 0.030508474576271188, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2060", "startMs": "1665768202186", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.00847457627118644, "writeRatioMax": 0.013559322033898305 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.020338983050847456, "computeRatioMax": 0.020338983050847456, "endMs": "1665768202638", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00847457627118644, "readRatioMax": 0.00847457627118644, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665768202595", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02711864406779661, "writeRatioMax": 0.02711864406779661 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.020338983050847456, "computeRatioMax": 0.020338983050847456, "endMs": "1665768202660", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011864406779661017, "readRatioMax": 0.011864406779661017, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768202624", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.030508474576271188, "computeRatioMax": 0.030508474576271188, "endMs": "1665768202708", "id": "10", "inputStages": [ "6", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768202659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.04067796610169491, "writeRatioMax": 0.04067796610169491 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.015254237288135594, "computeRatioMax": 0.030508474576271188, "endMs": "1665768202783", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "3871", "startMs": "1665768202727", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.003389830508474576, "waitRatioMax": 0.005084745762711864, "writeMsAvg": "21", "writeMsMax": "31", "writeRatioAvg": 0.03559322033898305, "writeRatioMax": 0.05254237288135593 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.03559322033898305, "computeRatioMax": 0.03559322033898305, "endMs": "1665768202800", "id": "13", "inputStages": [ "8", "12", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665768202744", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.005084745762711864, "writeRatioMax": 0.005084745762711864 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01864406779661017, "computeRatioMax": 0.01864406779661017, "endMs": "1665768202857", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768202817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001694915254237288, "waitRatioMax": 0.001694915254237288, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.04915254237288136, "writeRatioMax": 0.04915254237288136 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "4941" }, { "activeUnits": "1", "completedUnits": "119", "elapsedMs": "902", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8964" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "8964", "transferredBytes": "0" }, "startTime": "1665768202000", "totalBytesProcessed": "54106245", "totalSlotMs": "8964" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4fc689da_4eef_4ad7_9406_2c35d90f0874" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "X11y1V++Ej/nm6uTlWuw+w==", "id": "test-project-364309:europe-west1.query02_1665776417", "jobReference": { "jobId": "query02_1665776417", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776417?location=europe-west1", "statistics": { "creationTime": "1665776418505", "endTime": "1665776419481", "finalExecutionDurationMs": "778", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "792" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.04792332268370607, "computeRatioMax": 0.04792332268370607, "endMs": "1665776418689", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007987220447284345, "readRatioMax": 0.007987220447284345, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776418656", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.012779552715654952, "writeRatioMax": 0.012779552715654952 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.06230031948881789, "computeRatioMax": 0.06230031948881789, "endMs": "1665776418727", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011182108626198083, "readRatioMax": 0.011182108626198083, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665776418683", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.019169329073482427, "writeRatioMax": 0.019169329073482427 }, { "completedParallelInputs": "6", "computeMsAvg": "412", "computeMsMax": "626", "computeRatioAvg": 0.65814696485623, "computeRatioMax": 1, "endMs": "1665776419097", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.019169329073482427, "readRatioMax": 0.025559105431309903, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2532", "startMs": "1665776418709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "5", "writeMsMax": "10", "writeRatioAvg": 0.007987220447284345, "writeRatioMax": 0.01597444089456869 }, { "completedParallelInputs": "6", "computeMsAvg": "328", "computeMsMax": "518", "computeRatioAvg": 0.5239616613418531, "computeRatioMax": 0.8274760383386581, "endMs": "1665776419032", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.01757188498402556, "readRatioMax": 0.027156549520766772, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "1971", "startMs": "1665776418733", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.007987220447284345, "writeRatioMax": 0.009584664536741214 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.012779552715654952, "computeRatioMax": 0.012779552715654952, "endMs": "1665776419187", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006389776357827476, "readRatioMax": 0.006389776357827476, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776419150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.022364217252396165, "writeRatioMax": 0.022364217252396165 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01437699680511182, "computeRatioMax": 0.01437699680511182, "endMs": "1665776419221", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006389776357827476, "readRatioMax": 0.006389776357827476, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776419179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.025559105431309903, "writeRatioMax": 0.025559105431309903 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.020766773162939296, "computeRatioMax": 0.020766773162939296, "endMs": "1665776419260", "id": "10", "inputStages": [ "6", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665776419210", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.036741214057507986, "writeRatioMax": 0.036741214057507986 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.012779552715654952, "computeRatioMax": 0.03035143769968051, "endMs": "1665776419325", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "4212", "startMs": "1665776419273", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.003194888178913738, "waitRatioMax": 0.006389776357827476, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.022364217252396165, "writeRatioMax": 0.0463258785942492 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.02875399361022364, "computeRatioMax": 0.02875399361022364, "endMs": "1665776419344", "id": "13", "inputStages": [ "12", "8", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776419287", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.004792332268370607, "waitRatioMax": 0.004792332268370607, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.007987220447284345, "writeRatioMax": 0.007987220447284345 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01597444089456869, "computeRatioMax": 0.01597444089456869, "endMs": "1665776419389", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776419355", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.020766773162939296, "writeRatioMax": 0.020766773162939296 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "14", "elapsedMs": "600", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "4617" }, { "activeUnits": "1", "completedUnits": "119", "elapsedMs": "876", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8953" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "8953", "transferredBytes": "0" }, "startTime": "1665776418558", "totalBytesProcessed": "54106245", "totalSlotMs": "8953" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonfce3bf3d_552f_40c7_9de1_247d8da50c4c" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "GYyzQgqSXiGNLAh/FNbNAw==", "id": "test-project-364309:europe-west1.query02_1665776420", "jobReference": { "jobId": "query02_1665776420", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776420?location=europe-west1", "statistics": { "creationTime": "1665776421208", "endTime": "1665776422234", "finalExecutionDurationMs": "802", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "792" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.05185185185185185, "computeRatioMax": 0.05185185185185185, "endMs": "1665776421404", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01037037037037037, "readRatioMax": 0.01037037037037037, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776421365", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014814814814814814, "waitRatioMax": 0.0014814814814814814, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.016296296296296295, "writeRatioMax": 0.016296296296296295 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.07111111111111111, "computeRatioMax": 0.07111111111111111, "endMs": "1665776421434", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007407407407407408, "readRatioMax": 0.007407407407407408, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665776421394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014814814814814814, "waitRatioMax": 0.0014814814814814814, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.013333333333333334, "writeRatioMax": 0.013333333333333334 }, { "completedParallelInputs": "6", "computeMsAvg": "368", "computeMsMax": "675", "computeRatioAvg": 0.5451851851851852, "computeRatioMax": 1, "endMs": "1665776421779", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "15", "readRatioAvg": 0.01925925925925926, "readRatioMax": 0.022222222222222223, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2891", "startMs": "1665776421418", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014814814814814814, "waitRatioMax": 0.0014814814814814814, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.007407407407407408, "writeRatioMax": 0.01037037037037037 }, { "completedParallelInputs": "6", "computeMsAvg": "402", "computeMsMax": "638", "computeRatioAvg": 0.5955555555555555, "computeRatioMax": 0.9451851851851852, "endMs": "1665776421855", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.02074074074074074, "readRatioMax": 0.025185185185185185, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "4278", "startMs": "1665776421443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014814814814814814, "waitRatioMax": 0.0014814814814814814, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.008888888888888889, "writeRatioMax": 0.013333333333333334 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01037037037037037, "computeRatioMax": 0.01037037037037037, "endMs": "1665776421904", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.005925925925925926, "readRatioMax": 0.005925925925925926, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776421878", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014814814814814814, "waitRatioMax": 0.0014814814814814814, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.022222222222222223, "writeRatioMax": 0.022222222222222223 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.014814814814814815, "computeRatioMax": 0.014814814814814815, "endMs": "1665776421940", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008888888888888889, "readRatioMax": 0.008888888888888889, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665776421908", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002962962962962963, "waitRatioMax": 0.002962962962962963, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.008888888888888889, "writeRatioMax": 0.008888888888888889 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.016296296296296295, "computeRatioMax": 0.016296296296296295, "endMs": "1665776421988", "id": "10", "inputStages": [ "4", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776421937", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002962962962962963, "waitRatioMax": 0.002962962962962963, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.035555555555555556, "writeRatioMax": 0.035555555555555556 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.01037037037037037, "computeRatioMax": 0.02074074074074074, "endMs": "1665776422059", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "4148", "startMs": "1665776422005", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "10", "waitRatioAvg": 0.002962962962962963, "waitRatioMax": 0.014814814814814815, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.02074074074074074, "writeRatioMax": 0.034074074074074076 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.025185185185185185, "computeRatioMax": 0.025185185185185185, "endMs": "1665776422076", "id": "13", "inputStages": [ "8", "12", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776422019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014814814814814814, "waitRatioMax": 0.0014814814814814814, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.005925925925925926, "writeRatioMax": 0.005925925925925926 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017777777777777778, "computeRatioMax": 0.017777777777777778, "endMs": "1665776422122", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776422083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014814814814814814, "waitRatioMax": 0.0014814814814814814, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01925925925925926, "writeRatioMax": 0.01925925925925926 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "14", "elapsedMs": "603", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7309" }, { "activeUnits": "0", "completedUnits": "119", "elapsedMs": "905", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11697" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "11697", "transferredBytes": "0" }, "startTime": "1665776421264", "totalBytesProcessed": "54106245", "totalSlotMs": "11697" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4f3e7daa_0802_4c45_b16d_d837ae03bd73" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "9QoM1eH9QpstFB8L+SNTCA==", "id": "test-project-364309:europe-west1.query02_1665776423", "jobReference": { "jobId": "query02_1665776423", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776423?location=europe-west1", "statistics": { "creationTime": "1665776423935", "endTime": "1665776424944", "finalExecutionDurationMs": "833", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "792" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.054441260744985676, "computeRatioMax": 0.054441260744985676, "endMs": "1665776424114", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01002865329512894, "readRatioMax": 0.01002865329512894, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "77", "startMs": "1665776424073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014326647564469914, "waitRatioMax": 0.0014326647564469914, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.017191977077363897, "writeRatioMax": 0.017191977077363897 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.055873925501432664, "computeRatioMax": 0.055873925501432664, "endMs": "1665776424141", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008595988538681949, "readRatioMax": 0.008595988538681949, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776424102", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014326647564469914, "waitRatioMax": 0.0014326647564469914, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.015759312320916905, "writeRatioMax": 0.015759312320916905 }, { "completedParallelInputs": "6", "computeMsAvg": "392", "computeMsMax": "698", "computeRatioAvg": 0.5616045845272206, "computeRatioMax": 1, "endMs": "1665776424584", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "28", "readRatioAvg": 0.02148997134670487, "readRatioMax": 0.04011461318051576, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2504", "startMs": "1665776424123", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014326647564469914, "waitRatioMax": 0.0014326647564469914, "writeMsAvg": "7", "writeMsMax": "19", "writeRatioAvg": 0.01002865329512894, "writeRatioMax": 0.027220630372492838 }, { "completedParallelInputs": "6", "computeMsAvg": "391", "computeMsMax": "618", "computeRatioAvg": 0.5601719197707736, "computeRatioMax": 0.8853868194842407, "endMs": "1665776424526", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "18", "readRatioAvg": 0.015759312320916905, "readRatioMax": 0.025787965616045846, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "3228", "startMs": "1665776424157", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0014326647564469914, "waitRatioMax": 0.0028653295128939827, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.0071633237822349575, "writeRatioMax": 0.01002865329512894 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.015759312320916905, "computeRatioMax": 0.015759312320916905, "endMs": "1665776424650", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008595988538681949, "readRatioMax": 0.008595988538681949, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776424614", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014326647564469914, "waitRatioMax": 0.0014326647564469914, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.011461318051575931, "writeRatioMax": 0.011461318051575931 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017191977077363897, "computeRatioMax": 0.017191977077363897, "endMs": "1665776424676", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.011461318051575931, "readRatioMax": 0.011461318051575931, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776424641", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014326647564469914, "waitRatioMax": 0.0014326647564469914, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01002865329512894, "writeRatioMax": 0.01002865329512894 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01862464183381089, "computeRatioMax": 0.01862464183381089, "endMs": "1665776424729", "id": "10", "inputStages": [ "6", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665776424676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.03868194842406877, "writeRatioMax": 0.03868194842406877 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.011461318051575931, "computeRatioMax": 0.02005730659025788, "endMs": "1665776424800", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "5278", "startMs": "1665776424743", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0028653295128939827, "waitRatioMax": 0.004297994269340974, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.022922636103151862, "writeRatioMax": 0.04011461318051576 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.02005730659025788, "computeRatioMax": 0.02005730659025788, "endMs": "1665776424810", "id": "13", "inputStages": [ "8", "12", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776424760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0057306590257879654, "waitRatioMax": 0.0057306590257879654, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0028653295128939827, "writeRatioMax": 0.0028653295128939827 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.017191977077363897, "computeRatioMax": 0.017191977077363897, "endMs": "1665776424864", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665776424829", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0014326647564469914, "waitRatioMax": 0.0014326647564469914, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01862464183381089, "writeRatioMax": 0.01862464183381089 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "13", "elapsedMs": "594", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "5775" }, { "activeUnits": "3", "completedUnits": "119", "elapsedMs": "923", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11336" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "11336", "transferredBytes": "0" }, "startTime": "1665776423980", "totalBytesProcessed": "54106245", "totalSlotMs": "11336" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone6e0d58e_b41d_4169_8659_4038cdf09f49" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "tzaYUo4HY5cMKs5PZ8t63A==", "id": "test-project-364309:europe-west1.query02_1665776426", "jobReference": { "jobId": "query02_1665776426", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776426?location=europe-west1", "statistics": { "creationTime": "1665776426659", "endTime": "1665776427702", "finalExecutionDurationMs": "851", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "793" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.04895104895104895, "computeRatioMax": 0.04895104895104895, "endMs": "1665776426842", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.008391608391608392, "readRatioMax": 0.008391608391608392, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776426805", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.0013986013986013986, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.013986013986013986, "writeRatioMax": 0.013986013986013986 }, { "completedParallelInputs": "1", "computeMsAvg": "61", "computeMsMax": "61", "computeRatioAvg": 0.08531468531468532, "computeRatioMax": 0.08531468531468532, "endMs": "1665776426878", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006993006993006993, "readRatioMax": 0.006993006993006993, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665776426834", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.0013986013986013986, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.012587412587412588, "writeRatioMax": 0.012587412587412588 }, { "completedParallelInputs": "6", "computeMsAvg": "397", "computeMsMax": "689", "computeRatioAvg": 0.5552447552447553, "computeRatioMax": 0.9636363636363636, "endMs": "1665776427219", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.013986013986013986, "readRatioMax": 0.016783216783216783, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2858", "startMs": "1665776426855", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.002797202797202797, "waitRatioMax": 0.004195804195804196, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.008391608391608392 }, { "completedParallelInputs": "6", "computeMsAvg": "362", "computeMsMax": "715", "computeRatioAvg": 0.5062937062937063, "computeRatioMax": 1, "endMs": "1665776427344", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.015384615384615385, "readRatioMax": 0.019580419580419582, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "3011", "startMs": "1665776426887", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.0013986013986013986, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.005594405594405594, "writeRatioMax": 0.008391608391608392 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.012587412587412588, "computeRatioMax": 0.012587412587412588, "endMs": "1665776427403", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006993006993006993, "readRatioMax": 0.006993006993006993, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776427366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.0013986013986013986, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.019580419580419582, "writeRatioMax": 0.019580419580419582 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.016783216783216783, "computeRatioMax": 0.016783216783216783, "endMs": "1665776427424", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.006993006993006993, "readRatioMax": 0.006993006993006993, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776427394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.0013986013986013986, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.019580419580419582, "writeRatioMax": 0.019580419580419582 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.025174825174825177, "computeRatioMax": 0.025174825174825177, "endMs": "1665776427485", "id": "10", "inputStages": [ "4", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776427431", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.0013986013986013986, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.027972027972027972, "writeRatioMax": 0.027972027972027972 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.012587412587412588, "computeRatioMax": 0.023776223776223775, "endMs": "1665776427559", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "5867", "startMs": "1665776427499", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "7", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.009790209790209791, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.019580419580419582, "writeRatioMax": 0.03076923076923077 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.022377622377622378, "computeRatioMax": 0.022377622377622378, "endMs": "1665776427575", "id": "13", "inputStages": [ "8", "12", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776427513", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.0013986013986013986, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.005594405594405594, "writeRatioMax": 0.005594405594405594 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01818181818181818, "computeRatioMax": 0.01818181818181818, "endMs": "1665776427619", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776427583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013986013986013986, "waitRatioMax": 0.0013986013986013986, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.02097902097902098, "writeRatioMax": 0.02097902097902098 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "13", "elapsedMs": "599", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "5399" }, { "activeUnits": "3", "completedUnits": "119", "elapsedMs": "944", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "12093" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "12093", "transferredBytes": "0" }, "startTime": "1665776426708", "totalBytesProcessed": "54106245", "totalSlotMs": "12093" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone9d84e5f_4438_4816_a5d9_f57318037628" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "5zkfLl1jhNodIU6IBiK/fg==", "id": "test-project-364309:europe-west1.query02_1665776428", "jobReference": { "jobId": "query02_1665776428", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776428?location=europe-west1", "statistics": { "creationTime": "1665776429274", "endTime": "1665776430343", "finalExecutionDurationMs": "869", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "793" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.04569190600522193, "computeRatioMax": 0.04569190600522193, "endMs": "1665776429458", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.009138381201044387, "readRatioMax": 0.009138381201044387, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776429420", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.014360313315926894, "writeRatioMax": 0.014360313315926894 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.04308093994778068, "computeRatioMax": 0.04308093994778068, "endMs": "1665776429501", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007832898172323759, "readRatioMax": 0.007832898172323759, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665776429453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.016971279373368148, "writeRatioMax": 0.016971279373368148 }, { "completedParallelInputs": "6", "computeMsAvg": "389", "computeMsMax": "766", "computeRatioAvg": 0.5078328981723238, "computeRatioMax": 1, "endMs": "1665776429885", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "12", "readRatioAvg": 0.014360313315926894, "readRatioMax": 0.015665796344647518, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2652", "startMs": "1665776429475", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.006527415143603133, "writeRatioMax": 0.007832898172323759 }, { "completedParallelInputs": "6", "computeMsAvg": "347", "computeMsMax": "638", "computeRatioAvg": 0.45300261096605743, "computeRatioMax": 0.8328981723237598, "endMs": "1665776429910", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.014360313315926894, "readRatioMax": 0.018276762402088774, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2416", "startMs": "1665776429516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "25", "writeMsMax": "69", "writeRatioAvg": 0.03263707571801567, "writeRatioMax": 0.09007832898172324 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.014360313315926894, "computeRatioMax": 0.014360313315926894, "endMs": "1665776430008", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007832898172323759, "readRatioMax": 0.007832898172323759, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776429965", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02349869451697128, "writeRatioMax": 0.02349869451697128 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.013054830287206266, "computeRatioMax": 0.013054830287206266, "endMs": "1665776430033", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.010443864229765013, "readRatioMax": 0.010443864229765013, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665776429997", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.01174934725848564, "writeRatioMax": 0.01174934725848564 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.016971279373368148, "computeRatioMax": 0.016971279373368148, "endMs": "1665776430088", "id": "10", "inputStages": [ "6", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665776430038", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0026109660574412533, "waitRatioMax": 0.0026109660574412533, "writeMsAvg": "34", "writeMsMax": "34", "writeRatioAvg": 0.044386422976501305, "writeRatioMax": 0.044386422976501305 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.010443864229765013, "computeRatioMax": 0.018276762402088774, "endMs": "1665776430169", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "5759", "startMs": "1665776430097", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0026109660574412533, "waitRatioMax": 0.007832898172323759, "writeMsAvg": "19", "writeMsMax": "37", "writeRatioAvg": 0.024804177545691905, "writeRatioMax": 0.048302872062663184 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.020887728459530026, "computeRatioMax": 0.020887728459530026, "endMs": "1665776430187", "id": "13", "inputStages": [ "12", "8", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776430113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0039164490861618795, "waitRatioMax": 0.0039164490861618795, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.006527415143603133, "writeRatioMax": 0.006527415143603133 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0195822454308094, "computeRatioMax": 0.0195822454308094, "endMs": "1665776430243", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665776430203", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0013054830287206266, "waitRatioMax": 0.0013054830287206266, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.016971279373368148, "writeRatioMax": 0.016971279373368148 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "14", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5170" }, { "activeUnits": "0", "completedUnits": "119", "elapsedMs": "963", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11262" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "11262", "transferredBytes": "0" }, "startTime": "1665776429317", "totalBytesProcessed": "54106245", "totalSlotMs": "11262" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon785b572a_ca19_4a6a_b310_f2eaf117c952" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "TzByJ6Y9qxWqK/L6hrZvqw==", "id": "test-project-364309:europe-west1.query02_1665776686", "jobReference": { "jobId": "query02_1665776686", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776686?location=europe-west1", "statistics": { "creationTime": "1665776687022", "endTime": "1665776688167", "finalExecutionDurationMs": "909", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "794" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "53", "computeMsMax": "53", "computeRatioAvg": 0.0660024906600249, "computeRatioMax": 0.0660024906600249, "endMs": "1665776687256", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.024906600249066, "readRatioMax": 0.024906600249066, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665776687195", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.012453300124533, "writeRatioMax": 0.012453300124533 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.0647571606475716, "computeRatioMax": 0.0647571606475716, "endMs": "1665776687260", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009962640099626401, "readRatioMax": 0.009962640099626401, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "102", "startMs": "1665776687222", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0112079701120797, "writeRatioMax": 0.0112079701120797 }, { "completedParallelInputs": "6", "computeMsAvg": "369", "computeMsMax": "755", "computeRatioAvg": 0.45952677459526775, "computeRatioMax": 0.9402241594022416, "endMs": "1665776687679", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "12", "readRatioAvg": 0.0136986301369863, "readRatioMax": 0.014943960149439602, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2231", "startMs": "1665776687278", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.0136986301369863, "waitRatioMax": 0.0136986301369863, "writeMsAvg": "6", "writeMsMax": "12", "writeRatioAvg": 0.007471980074719801, "writeRatioMax": 0.014943960149439602 }, { "completedParallelInputs": "6", "computeMsAvg": "413", "computeMsMax": "803", "computeRatioAvg": 0.5143212951432129, "computeRatioMax": 1, "endMs": "1665776687768", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "24", "readRatioAvg": 0.0161892901618929, "readRatioMax": 0.029887920298879204, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2529", "startMs": "1665776687277", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.0062266500622665, "waitRatioMax": 0.007471980074719801, "writeMsAvg": "7", "writeMsMax": "17", "writeRatioAvg": 0.008717310087173101, "writeRatioMax": 0.021170610211706103 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.012453300124533, "computeRatioMax": 0.012453300124533, "endMs": "1665776687828", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.008717310087173101, "readRatioMax": 0.008717310087173101, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776687794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.023661270236612703, "writeRatioMax": 0.023661270236612703 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.017434620174346202, "computeRatioMax": 0.017434620174346202, "endMs": "1665776687867", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007471980074719801, "readRatioMax": 0.007471980074719801, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776687828", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.012453300124533, "writeRatioMax": 0.012453300124533 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.014943960149439602, "computeRatioMax": 0.014943960149439602, "endMs": "1665776687906", "id": "10", "inputStages": [ "4", "6" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776687858", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.0273972602739726, "writeRatioMax": 0.0273972602739726 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.009962640099626401, "computeRatioMax": 0.021170610211706103, "endMs": "1665776687974", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "5174", "startMs": "1665776687912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0024906600249066002, "waitRatioMax": 0.0049813200498132005, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.0186799501867995, "writeRatioMax": 0.0323785803237858 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.021170610211706103, "computeRatioMax": 0.021170610211706103, "endMs": "1665776687985", "id": "13", "inputStages": [ "12", "8", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776687926", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0037359900373599006, "waitRatioMax": 0.0037359900373599006, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0037359900373599006, "writeRatioMax": 0.0037359900373599006 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0136986301369863, "computeRatioMax": 0.0136986301369863, "endMs": "1665776688064", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665776687998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012453300124533001, "waitRatioMax": 0.0012453300124533001, "writeMsAvg": "55", "writeMsMax": "55", "writeRatioAvg": 0.0684931506849315, "writeRatioMax": 0.0684931506849315 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "13", "elapsedMs": "606", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4172" }, { "activeUnits": "3", "completedUnits": "119", "elapsedMs": "1017", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10412" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "10412", "transferredBytes": "0" }, "startTime": "1665776687091", "totalBytesProcessed": "54106245", "totalSlotMs": "10412" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc509a75d_9369_4502_91d7_f46cb381022b" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "GGbW/ifVivSHIyWvuhZmyA==", "id": "test-project-364309:europe-west1.query02_1665776689", "jobReference": { "jobId": "query02_1665776689", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776689?location=europe-west1", "statistics": { "creationTime": "1665776689860", "endTime": "1665776691066", "finalExecutionDurationMs": "984", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "795" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.05835240274599542, "computeRatioMax": 0.05835240274599542, "endMs": "1665776690073", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006864988558352402, "readRatioMax": 0.006864988558352402, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665776690024", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011441647597254005, "waitRatioMax": 0.0011441647597254005, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.010297482837528604, "writeRatioMax": 0.010297482837528604 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665776690091", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009153318077803204, "readRatioMax": 0.009153318077803204, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776690050", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011441647597254005, "waitRatioMax": 0.0011441647597254005, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.014874141876430207, "writeRatioMax": 0.014874141876430207 }, { "completedParallelInputs": "6", "computeMsAvg": "458", "computeMsMax": "874", "computeRatioAvg": 0.5240274599542334, "computeRatioMax": 1, "endMs": "1665776690616", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.012585812356979404, "readRatioMax": 0.016018306636155607, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2759", "startMs": "1665776690092", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "14", "waitMsMax": "17", "waitRatioAvg": 0.016018306636155607, "waitRatioMax": 0.019450800915331808, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005720823798627002, "writeRatioMax": 0.005720823798627002 }, { "completedParallelInputs": "6", "computeMsAvg": "405", "computeMsMax": "871", "computeRatioAvg": 0.4633867276887872, "computeRatioMax": 0.9965675057208238, "endMs": "1665776690651", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "26", "readRatioAvg": 0.016018306636155607, "readRatioMax": 0.029748283752860413, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2155", "startMs": "1665776690108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0011441647597254005, "waitRatioMax": 0.002288329519450801, "writeMsAvg": "6", "writeMsMax": "14", "writeRatioAvg": 0.006864988558352402, "writeRatioMax": 0.016018306636155607 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012585812356979404, "computeRatioMax": 0.012585812356979404, "endMs": "1665776690743", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005720823798627002, "readRatioMax": 0.005720823798627002, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776690702", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011441647597254005, "waitRatioMax": 0.0011441647597254005, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.017162471395881007, "writeRatioMax": 0.017162471395881007 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013729977116704805, "computeRatioMax": 0.013729977116704805, "endMs": "1665776690770", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006864988558352402, "readRatioMax": 0.006864988558352402, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776690736", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011441647597254005, "waitRatioMax": 0.0011441647597254005, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.020594965675057208, "writeRatioMax": 0.020594965675057208 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.016018306636155607, "computeRatioMax": 0.016018306636155607, "endMs": "1665776690824", "id": "10", "inputStages": [ "6", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665776690773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011441647597254005, "waitRatioMax": 0.0011441647597254005, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.010297482837528604, "computeRatioMax": 0.021739130434782608, "endMs": "1665776690895", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "4583", "startMs": "1665776690838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.002288329519450801, "waitRatioMax": 0.004576659038901602, "writeMsAvg": "15", "writeMsMax": "24", "writeRatioAvg": 0.017162471395881007, "writeRatioMax": 0.02745995423340961 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.021739130434782608, "endMs": "1665776690913", "id": "13", "inputStages": [ "5", "12", "8" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776690852", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002288329519450801, "waitRatioMax": 0.002288329519450801, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.006864988558352402, "writeRatioMax": 0.006864988558352402 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.014874141876430207, "computeRatioMax": 0.014874141876430207, "endMs": "1665776690962", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776690923", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011441647597254005, "waitRatioMax": 0.0011441647597254005, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.030892448512585814, "writeRatioMax": 0.030892448512585814 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "12", "elapsedMs": "606", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "3516" }, { "activeUnits": "6", "completedUnits": "119", "elapsedMs": "1084", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9948" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "9948", "transferredBytes": "0" }, "startTime": "1665776689921", "totalBytesProcessed": "54106245", "totalSlotMs": "9948" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3e3c0fd0_b622_40a6_97e4_0c8628216627" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NLHrZpTMkp7aV738/B3z8g==", "id": "test-project-364309:europe-west1.query02_1665776692", "jobReference": { "jobId": "query02_1665776692", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776692?location=europe-west1", "statistics": { "creationTime": "1665776692620", "endTime": "1665776693685", "finalExecutionDurationMs": "844", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "797" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.0353356890459364, "computeRatioMax": 0.0353356890459364, "endMs": "1665776692823", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007067137809187279, "readRatioMax": 0.007067137809187279, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776692781", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001177856301531213, "waitRatioMax": 0.001177856301531213, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.020023557126030624, "writeRatioMax": 0.020023557126030624 }, { "completedParallelInputs": "1", "computeMsAvg": "69", "computeMsMax": "69", "computeRatioAvg": 0.0812720848056537, "computeRatioMax": 0.0812720848056537, "endMs": "1665776692864", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.009422850412249705, "readRatioMax": 0.009422850412249705, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "91", "startMs": "1665776692809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001177856301531213, "waitRatioMax": 0.001177856301531213, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.012956419316843345, "writeRatioMax": 0.012956419316843345 }, { "completedParallelInputs": "6", "computeMsAvg": "365", "computeMsMax": "601", "computeRatioAvg": 0.4299175500588928, "computeRatioMax": 0.7078916372202592, "endMs": "1665776693230", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "18", "readRatioAvg": 0.014134275618374558, "readRatioMax": 0.02120141342756184, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2218", "startMs": "1665776692830", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001177856301531213, "waitRatioMax": 0.001177856301531213, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005889281507656066, "writeRatioMax": 0.005889281507656066 }, { "completedParallelInputs": "6", "computeMsAvg": "467", "computeMsMax": "849", "computeRatioAvg": 0.5500588928150766, "computeRatioMax": 1, "endMs": "1665776693308", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "20", "readRatioAvg": 0.015312131919905771, "readRatioMax": 0.023557126030624265, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2663", "startMs": "1665776692877", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001177856301531213, "waitRatioMax": 0.001177856301531213, "writeMsAvg": "7", "writeMsMax": "16", "writeRatioAvg": 0.008244994110718492, "writeRatioMax": 0.01884570082449941 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01060070671378092, "computeRatioMax": 0.01060070671378092, "endMs": "1665776693372", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005889281507656066, "readRatioMax": 0.005889281507656066, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776693339", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0035335689045936395, "waitRatioMax": 0.0035335689045936395, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.007067137809187279, "writeRatioMax": 0.007067137809187279 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012956419316843345, "computeRatioMax": 0.012956419316843345, "endMs": "1665776693406", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007067137809187279, "readRatioMax": 0.007067137809187279, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776693367", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001177856301531213, "waitRatioMax": 0.001177856301531213, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.014134275618374558, "writeRatioMax": 0.014134275618374558 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.01884570082449941, "computeRatioMax": 0.01884570082449941, "endMs": "1665776693442", "id": "10", "inputStages": [ "6", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776693394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001177856301531213, "waitRatioMax": 0.001177856301531213, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.02591283863368669, "writeRatioMax": 0.02591283863368669 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.009422850412249705, "computeRatioMax": 0.016489988221436984, "endMs": "1665776693510", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "4046", "startMs": "1665776693454", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.002355712603062426, "waitRatioMax": 0.0035335689045936395, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.016489988221436984, "writeRatioMax": 0.027090694935217905 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.03297997644287397, "computeRatioMax": 0.03297997644287397, "endMs": "1665776693539", "id": "13", "inputStages": [ "5", "12", "8" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776693474", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.004711425206124852, "waitRatioMax": 0.004711425206124852, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005889281507656066, "writeRatioMax": 0.005889281507656066 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.014134275618374558, "computeRatioMax": 0.014134275618374558, "endMs": "1665776693580", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776693544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001177856301531213, "waitRatioMax": 0.001177856301531213, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.015312131919905771, "writeRatioMax": 0.015312131919905771 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "13", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "4972" }, { "activeUnits": "2", "completedUnits": "119", "elapsedMs": "948", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9348" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "9348", "transferredBytes": "0" }, "startTime": "1665776692678", "totalBytesProcessed": "54106245", "totalSlotMs": "9348" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoneed0d5a0_a708_4013_9ac1_a9fe95886d1b" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "CHnlK1DjLb72myU+pHe9kw==", "id": "test-project-364309:europe-west1.query02_1665776694", "jobReference": { "jobId": "query02_1665776694", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776694?location=europe-west1", "statistics": { "creationTime": "1665776695517", "endTime": "1665776696667", "finalExecutionDurationMs": "932", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "798" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "69", "computeMsMax": "69", "computeRatioAvg": 0.07624309392265194, "computeRatioMax": 0.07624309392265194, "endMs": "1665776695812", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "68", "readMsMax": "68", "readRatioAvg": 0.07513812154696133, "readRatioMax": 0.07513812154696133, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "182", "startMs": "1665776695682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.011049723756906077, "waitRatioMax": 0.011049723756906077, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.026519337016574586, "writeRatioMax": 0.026519337016574586 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.04751381215469613, "computeRatioMax": 0.04751381215469613, "endMs": "1665776695736", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.004419889502762431, "readRatioMax": 0.004419889502762431, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776695701", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011049723756906078, "waitRatioMax": 0.0011049723756906078, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.009944751381215469, "writeRatioMax": 0.009944751381215469 }, { "completedParallelInputs": "6", "computeMsAvg": "442", "computeMsMax": "905", "computeRatioAvg": 0.48839779005524864, "computeRatioMax": 1, "endMs": "1665776696239", "id": "4", "inputStages": [ "2" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.012154696132596685, "readRatioMax": 0.015469613259668509, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2270", "startMs": "1665776695751", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage04_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011049723756906078, "waitRatioMax": 0.0011049723756906078, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.0055248618784530384, "writeRatioMax": 0.0066298342541436465 }, { "completedParallelInputs": "6", "computeMsAvg": "386", "computeMsMax": "734", "computeRatioAvg": 0.4265193370165746, "computeRatioMax": 0.8110497237569061, "endMs": "1665776696198", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "13", "readRatioAvg": 0.012154696132596685, "readRatioMax": 0.014364640883977901, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2102", "startMs": "1665776695832", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage05_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011049723756906078, "waitRatioMax": 0.0011049723756906078, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.004419889502762431, "writeRatioMax": 0.0055248618784530384 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012154696132596685, "computeRatioMax": 0.012154696132596685, "endMs": "1665776696351", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0055248618784530384, "readRatioMax": 0.0055248618784530384, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776696321", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011049723756906078, "waitRatioMax": 0.0011049723756906078, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.017679558011049725, "writeRatioMax": 0.017679558011049725 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.016574585635359115, "computeRatioMax": 0.016574585635359115, "endMs": "1665776696386", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0066298342541436465, "readRatioMax": 0.0066298342541436465, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776696348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011049723756906078, "waitRatioMax": 0.0011049723756906078, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.019889502762430938, "writeRatioMax": 0.019889502762430938 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.015469613259668509, "computeRatioMax": 0.015469613259668509, "endMs": "1665776696421", "id": "10", "inputStages": [ "6", "5" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665776696374", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011049723756906078, "waitRatioMax": 0.0011049723756906078, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.02541436464088398, "writeRatioMax": 0.02541436464088398 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.008839779005524863, "computeRatioMax": 0.01878453038674033, "endMs": "1665776696489", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "3890", "startMs": "1665776696439", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0022099447513812156, "waitRatioMax": 0.0033149171270718232, "writeMsAvg": "15", "writeMsMax": "24", "writeRatioAvg": 0.016574585635359115, "writeRatioMax": 0.026519337016574586 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.020994475138121547, "computeRatioMax": 0.020994475138121547, "endMs": "1665776696513", "id": "13", "inputStages": [ "8", "12", "4" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776696451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011049723756906078, "waitRatioMax": 0.0011049723756906078, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0055248618784530384, "writeRatioMax": 0.0055248618784530384 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.014364640883977901, "computeRatioMax": 0.014364640883977901, "endMs": "1665776696565", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776696526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011049723756906078, "waitRatioMax": 0.0011049723756906078, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.017679558011049725, "writeRatioMax": 0.017679558011049725 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "12", "elapsedMs": "618", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "4181" }, { "activeUnits": "5", "completedUnits": "119", "elapsedMs": "1038", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9271" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "9271", "transferredBytes": "0" }, "startTime": "1665776695566", "totalBytesProcessed": "54106245", "totalSlotMs": "9271" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0600a6f3_a5f6_4aca_8386_7fae3668b842" }, "priority": "INTERACTIVE", "query": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n ,sales_price\n from (select ws_sold_date_sk sold_date_sk\n ,ws_ext_sales_price sales_price\n from web_sales \n union all\n select cs_sold_date_sk sold_date_sk\n ,cs_ext_sales_price sales_price\n from catalog_sales)),\n wswscs as \n (select d_week_seq,\n sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,\n sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n ,round(sun_sales1/sun_sales2,2)\n ,round(mon_sales1/mon_sales2,2)\n ,round(tue_sales1/tue_sales2,2)\n ,round(wed_sales1/wed_sales2,2)\n ,round(thu_sales1/thu_sales2,2)\n ,round(fri_sales1/fri_sales2,2)\n ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n ,sun_sales sun_sales1\n ,mon_sales mon_sales1\n ,tue_sales tue_sales1\n ,wed_sales wed_sales1\n ,thu_sales thu_sales1\n ,fri_sales fri_sales1\n ,sat_sales sat_sales1\n from wswscs,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n ,sun_sales sun_sales2\n ,mon_sales mon_sales2\n ,tue_sales tue_sales2\n ,wed_sales wed_sales2\n ,thu_sales thu_sales2\n ,fri_sales fri_sales2\n ,sat_sales sat_sales2\n from wswscs\n ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq and\n d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NulARzuG3LXIEno2DLEe4Q==", "id": "test-project-364309:europe-west1.query02_1665776697", "jobReference": { "jobId": "query02_1665776697", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query02_1665776697?location=europe-west1", "statistics": { "creationTime": "1665776698254", "endTime": "1665776699208", "finalExecutionDurationMs": "749", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54106245", "performanceInsights": { "avgPreviousExecutionMs": "799" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.10869565217391304, "computeRatioMax": 0.10869565217391304, "endMs": "1665776698460", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011857707509881422, "readRatioMax": 0.011857707509881422, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665776698415", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_week_seq, $52:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$50, $51, $52", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001976284584980237, "waitRatioMax": 0.001976284584980237, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.017786561264822136, "writeRatioMax": 0.017786561264822136 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.06126482213438735, "computeRatioMax": 0.06126482213438735, "endMs": "1665776698488", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.011857707509881422, "readRatioMax": 0.011857707509881422, "recordsRead": "73049", "recordsWritten": "73049", "shuffleOutputBytes": "2201906", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776698452", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_week_seq, $22:d_day_name", "FROM date_dim" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001976284584980237, "waitRatioMax": 0.001976284584980237, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.017786561264822136, "writeRatioMax": 0.017786561264822136 }, { "completedParallelInputs": "6", "computeMsAvg": "318", "computeMsMax": "486", "computeRatioAvg": 0.6284584980237155, "computeRatioMax": 0.9604743083003953, "endMs": "1665776698765", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "12", "readMsMax": "16", "readRatioAvg": 0.023715415019762844, "readRatioMax": 0.03162055335968379, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "1812", "startMs": "1665776698471", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ws_sold_date_sk, $61:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51, $52", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $221", "$140 := SUM($156)", "$141 := SUM($155)", "$142 := SUM($154)", "$143 := SUM($153)", "$144 := SUM($152)", "$145 := SUM($151)", "$146 := SUM($150)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)", "$151 := case_no_value(equal($222, 'Friday'), $220, NULL)", "$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)", "$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)", "$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)", "$155 := case_no_value(equal($222, 'Monday'), $220, NULL)", "$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $171, $221 := $51, $222 := $52", "INNER HASH JOIN EACH WITH ALL ON $170 = $50" ] }, { "kind": "WRITE", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "TO __stage04_output", "BY HASH($230)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001976284584980237, "waitRatioMax": 0.001976284584980237, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.009881422924901186, "writeRatioMax": 0.011857707509881422 }, { "completedParallelInputs": "6", "computeMsAvg": "349", "computeMsMax": "506", "computeRatioAvg": 0.6897233201581028, "computeRatioMax": 1, "endMs": "1665776698825", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.025691699604743084, "readRatioMax": 0.03557312252964427, "recordsRead": "2599226", "recordsWritten": "1577", "shuffleOutputBytes": "200800", "shuffleOutputBytesSpilled": "0", "slotMs": "2024", "startMs": "1665776698502", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_ext_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $181", "$120 := SUM($136)", "$121 := SUM($135)", "$122 := SUM($134)", "$123 := SUM($133)", "$124 := SUM($132)", "$125 := SUM($131)", "$126 := SUM($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)", "$131 := case_no_value(equal($182, 'Friday'), $180, NULL)", "$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)", "$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)", "$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)", "$135 := case_no_value(equal($182, 'Monday'), $180, NULL)", "$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $161, $181 := $21, $182 := $22", "INNER HASH JOIN EACH WITH ALL ON $160 = $20" ] }, { "kind": "WRITE", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "TO __stage05_output", "BY HASH($190)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001976284584980237, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.009881422924901186, "writeRatioMax": 0.01383399209486166 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015810276679841896, "computeRatioMax": 0.015810276679841896, "endMs": "1665776698893", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.007905138339920948, "readRatioMax": 0.007905138339920948, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776698856", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_week_seq, $11:d_year", "FROM date_dim", "WHERE equal($11, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001976284584980237, "waitRatioMax": 0.001976284584980237, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.02766798418972332, "writeRatioMax": 0.02766798418972332 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.015810276679841896, "computeRatioMax": 0.015810276679841896, "endMs": "1665776698931", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.009881422924901186, "readRatioMax": 0.009881422924901186, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776698890", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_week_seq, $2:d_year", "FROM date_dim", "WHERE equal($2, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001976284584980237, "waitRatioMax": 0.001976284584980237, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.03359683794466403, "writeRatioMax": 0.03359683794466403 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.02766798418972332, "computeRatioMax": 0.02766798418972332, "endMs": "1665776698976", "id": "10", "inputStages": [ "6", "4" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1942", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665776698925", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230, $140, $141, $142, $143, $144, $145, $146", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage06_output" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := subtract($250, 53)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $110, $252 := $111, $253 := $112, $254 := $113, $255 := $114, $256 := $115, $257 := $116", "INNER HASH JOIN EACH WITH ALL ON $240 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230", "$110 := SUM($140)", "$111 := SUM($141)", "$112 := SUM($142)", "$113 := SUM($143)", "$114 := SUM($144)", "$115 := SUM($145)", "$116 := SUM($146)" ] }, { "kind": "WRITE", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001976284584980237, "waitRatioMax": 0.001976284584980237, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.045454545454545456, "writeRatioMax": 0.045454545454545456 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.015810276679841896, "computeRatioMax": 0.03162055335968379, "endMs": "1665776699047", "id": "12", "inputStages": [ "10" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "365", "recordsWritten": "365", "shuffleOutputBytes": "46720", "shuffleOutputBytesSpilled": "0", "slotMs": "4254", "startMs": "1665776698995", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.005928853754940711, "waitRatioMax": 0.007905138339920948, "writeMsAvg": "15", "writeMsMax": "39", "writeRatioAvg": 0.029644268774703556, "writeRatioMax": 0.07707509881422925 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665776699063", "id": "13", "inputStages": [ "8", "5", "12" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2307", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776699008", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $120, $121, $122, $123, $124, $125, $126", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$90, $251, $252, $253, $254, $255, $256, $257", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := round(divide($261, $268), 2)", "$81 := round(divide($262, $269), 2)", "$82 := round(divide($263, $270), 2)", "$83 := round(divide($264, $271), 2)", "$84 := round(divide($265, $272), 2)", "$85 := round(divide($266, $273), 2)", "$86 := round(divide($267, $274), 2)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $210, $261 := $211, $262 := $212, $263 := $213, $264 := $214, $265 := $215, $266 := $216, $267 := $217, $268 := $251, $269 := $252, $270 := $253, $271 := $254, $272 := $255, $273 := $256, $274 := $257", "INNER HASH JOIN EACH WITH ALL ON $210 = $90" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $100, $212 := $101, $213 := $102, $214 := $103, $215 := $104, $216 := $105, $217 := $106", "INNER HASH JOIN EACH WITH ALL ON $200 = $1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190", "$100 := SUM($120)", "$101 := SUM($121)", "$102 := SUM($122)", "$103 := SUM($123)", "$104 := SUM($124)", "$105 := SUM($125)", "$106 := SUM($126)" ] }, { "kind": "WRITE", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001976284584980237, "waitRatioMax": 0.001976284584980237, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.007905138339920948, "writeRatioMax": 0.007905138339920948 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.03162055335968379, "computeRatioMax": 0.03162055335968379, "endMs": "1665776699120", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2513", "recordsWritten": "2513", "shuffleOutputBytes": "321664", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776699083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $80, $81, $82, $83, $84, $85, $86", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$260 ASC" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286, $287", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.023715415019762844, "writeRatioMax": 0.023715415019762844 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "15", "elapsedMs": "610", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "4034" }, { "activeUnits": "2", "completedUnits": "119", "elapsedMs": "856", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8450" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54106245", "totalPartitionsProcessed": "0", "totalSlotMs": "8450", "transferredBytes": "0" }, "startTime": "1665776698306", "totalBytesProcessed": "54106245", "totalSlotMs": "8450" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
