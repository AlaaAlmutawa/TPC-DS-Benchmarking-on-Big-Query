{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8db17f01_6a01_4aa3_80c3_3fd7de2328a1" }, "priority": "INTERACTIVE", "query": "-- start query 35 in stream 0 using template query35.tpl\n\n/*\nFor the groups of customers living in the same state, having the same gender and marital status who have purchased from stores and from either the catalog or the web during a given year, display the following:\n \u2022 state, gender, marital status, count of customers\n \u2022 min, max, avg, count distinct of the customer\u2019s dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s employed dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s dependents in college count\nDisplay / calculate the \u201ccount of customers\u201d multiple times to emulate a potential reporting tool scenario\n*/\n\nselect \n ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n count(*) cnt1,\n min(cd_dep_count),\n max(cd_dep_count),\n avg(cd_dep_count),\n cd_dep_employed_count,\n count(*) cnt2,\n min(cd_dep_employed_count),\n max(cd_dep_employed_count),\n avg(cd_dep_employed_count),\n cd_dep_college_count,\n count(*) cnt3,\n min(cd_dep_college_count),\n max(cd_dep_college_count),\n avg(cd_dep_college_count)\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) or \n exists (select benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4))\n group by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n limit 100\n ;\n\n-- end query 35 in stream 0 using template query35.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "6/EKBYxv6H1sxZmYXOWnkw==", "id": "test-project-364309:europe-west1.query35_1665768325", "jobReference": { "jobId": "query35_1665768325", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query35_1665768325?location=europe-west1", "statistics": { "creationTime": "1665768325972", "endTime": "1665768328743", "finalExecutionDurationMs": "2542", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156174392", "performanceInsights": { "avgPreviousExecutionMs": "1772" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.008547008547008548, "computeRatioMax": 0.008547008547008548, "endMs": "1665768326200", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006216006216006216, "readRatioMax": 0.006216006216006216, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768326155", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_qoy", "FROM date_dim", "WHERE and(equal($61, 2002), less($62, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000777000777000777, "waitRatioMax": 0.000777000777000777, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.012432012432012432, "writeRatioMax": 0.012432012432012432 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.023310023310023312, "computeRatioMax": 0.023310023310023312, "endMs": "1665768326275", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003885003885003885, "readRatioMax": 0.003885003885003885, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768326230", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "25", "waitMsMax": "25", "waitRatioAvg": 0.019425019425019424, "waitRatioMax": 0.019425019425019424, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.009324009324009324, "writeRatioMax": 0.009324009324009324 }, { "completedParallelInputs": "6", "computeMsAvg": "116", "computeMsMax": "148", "computeRatioAvg": 0.09013209013209013, "computeRatioMax": 0.11499611499611499, "endMs": "1665768326358", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "14", "readRatioAvg": 0.00777000777000777, "readRatioMax": 0.010878010878010878, "recordsRead": "2882048", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "741", "startMs": "1665768326246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001554001554001554, "waitRatioMax": 0.001554001554001554, "writeMsAvg": "22", "writeMsMax": "24", "writeRatioAvg": 0.017094017094017096, "writeRatioMax": 0.018648018648018648 }, { "completedParallelInputs": "1", "computeMsAvg": "134", "computeMsMax": "134", "computeRatioAvg": 0.10411810411810411, "computeRatioMax": 0.10411810411810411, "endMs": "1665768326437", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004662004662004662, "readRatioMax": 0.004662004662004662, "recordsRead": "150000", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "141", "startMs": "1665768326326", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71, $232 := $81", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000777000777000777, "waitRatioMax": 0.000777000777000777, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.016317016317016316, "writeRatioMax": 0.016317016317016316 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.006993006993006993, "computeRatioMax": 0.014763014763014764, "endMs": "1665768326518", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "96562", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "4176", "startMs": "1665768326453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.006993006993006993, "writeMsAvg": "21", "writeMsMax": "51", "writeRatioAvg": 0.016317016317016316, "writeRatioMax": 0.039627039627039624 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.00777000777000777, "computeRatioMax": 0.01554001554001554, "endMs": "1665768326519", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "299459", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "3971", "startMs": "1665768326453", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "7", "waitMsMax": "10", "waitRatioAvg": 0.005439005439005439, "waitRatioMax": 0.00777000777000777, "writeMsAvg": "17", "writeMsMax": "31", "writeRatioAvg": 0.01320901320901321, "writeRatioMax": 0.024087024087024088 }, { "completedParallelInputs": "1", "computeMsAvg": "1287", "computeMsMax": "1287", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768327364", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.016317016317016316, "readRatioMax": 0.016317016317016316, "recordsRead": "2316821", "recordsWritten": "96562", "shuffleOutputBytes": "9808618", "shuffleOutputBytesSpilled": "0", "slotMs": "1324", "startMs": "1665768326468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_dep_count, $44:cd_dep_employed_count, $45:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $277", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($276)", "$202 := ANY_VALUE($275)", "$203 := ANY_VALUE($274)", "$204 := ANY_VALUE($273)", "$205 := ANY_VALUE($272)", "$206 := ANY_VALUE($271)", "$207 := ANY_VALUE($270)", "$208 := SUM($278)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $242, $271 := $243, $272 := $244, $273 := $245, $274 := $246, $275 := $240, $276 := $241, $277 := $210, $278 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$242 := $41, $243 := $42, $244 := $43, $245 := $44, $246 := $45, $240 := $230, $241 := $232", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.005439005439005439, "waitRatioMax": 0.005439005439005439, "writeMsAvg": "51", "writeMsMax": "51", "writeRatioAvg": 0.039627039627039624, "writeRatioMax": 0.039627039627039624 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.006993006993006993, "computeRatioMax": 0.006993006993006993, "endMs": "1665768327633", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004662004662004662, "readRatioMax": 0.004662004662004662, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768327595", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($31, 2002), less($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001554001554001554, "waitRatioMax": 0.001554001554001554, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010101010101010102, "writeRatioMax": 0.010101010101010102 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.08469308469308469, "computeRatioMax": 0.08469308469308469, "endMs": "1665768327759", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.011655011655011656, "readRatioMax": 0.011655011655011656, "recordsRead": "719658", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "129", "startMs": "1665768327662", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001554001554001554, "waitRatioMax": 0.001554001554001554, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.009324009324009324, "writeRatioMax": 0.009324009324009324 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.006993006993006993, "computeRatioMax": 0.01554001554001554, "endMs": "1665768327829", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "78955", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "3417", "startMs": "1665768327777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.003108003108003108, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.010878010878010878, "writeRatioMax": 0.01554001554001554 }, { "completedParallelInputs": "1", "computeMsAvg": "350", "computeMsMax": "350", "computeRatioAvg": 0.27195027195027194, "computeRatioMax": 0.27195027195027194, "endMs": "1665768328013", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "175517", "recordsWritten": "22704", "shuffleOutputBytes": "2267090", "shuffleOutputBytesSpilled": "0", "slotMs": "293", "startMs": "1665768327785", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($317)", "$162 := ANY_VALUE($316)", "$163 := ANY_VALUE($315)", "$164 := ANY_VALUE($314)", "$165 := ANY_VALUE($313)", "$166 := ANY_VALUE($312)", "$167 := ANY_VALUE($311)", "$168 := SUM($318)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $197, $318 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $192 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($198), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := ANY_VALUE($207)", "$198 := SUM($208)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.006216006216006216, "writeRatioMax": 0.006216006216006216 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.016317016317016316, "computeRatioMax": 0.016317016317016316, "endMs": "1665768328145", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.010101010101010102, "readRatioMax": 0.010101010101010102, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768328094", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim", "WHERE and(equal($11, 2002), less($12, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000777000777000777, "waitRatioMax": 0.000777000777000777, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.011655011655011656, "writeRatioMax": 0.011655011655011656 }, { "completedParallelInputs": "5", "computeMsAvg": "78", "computeMsMax": "94", "computeRatioAvg": 0.06060606060606061, "computeRatioMax": 0.07303807303807304, "endMs": "1665768328318", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.00777000777000777, "readRatioMax": 0.010101010101010102, "recordsRead": "1442918", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "479", "startMs": "1665768328174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $150", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000777000777000777, "waitRatioMax": 0.000777000777000777, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.006216006216006216, "writeRatioMax": 0.00777000777000777 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.006993006993006993, "computeRatioMax": 0.011655011655011656, "endMs": "1665768328413", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "158759", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "4742", "startMs": "1665768328338", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.003108003108003108, "waitRatioMax": 0.003885003885003885, "writeMsAvg": "22", "writeMsMax": "33", "writeRatioAvg": 0.017094017094017096, "writeRatioMax": 0.02564102564102564 }, { "completedParallelInputs": "1", "computeMsAvg": "129", "computeMsMax": "129", "computeRatioAvg": 0.10023310023310024, "computeRatioMax": 0.10023310023310024, "endMs": "1665768328492", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "181463", "recordsWritten": "22704", "shuffleOutputBytes": "2285066", "shuffleOutputBytesSpilled": "0", "slotMs": "111", "startMs": "1665768328363", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($357)", "$122 := ANY_VALUE($356)", "$123 := ANY_VALUE($355)", "$124 := ANY_VALUE($354)", "$125 := ANY_VALUE($353)", "$126 := ANY_VALUE($352)", "$127 := ANY_VALUE($351)", "$128 := SUM($358)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $131, $352 := $141, $353 := $142, $354 := $143, $355 := $144, $356 := $145, $357 := $147, $358 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $146 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()", "$131 := if(is_null($148), 0, $140)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$140 := SUM_OF_COUNTS($160)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($162)", "$143 := ANY_VALUE($163)", "$144 := ANY_VALUE($164)", "$145 := ANY_VALUE($165)", "$146 := ANY_VALUE($166)", "$147 := ANY_VALUE($167)", "$148 := SUM($168)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001554001554001554, "waitRatioMax": 0.001554001554001554, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.004662004662004662, "writeRatioMax": 0.004662004662004662 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.04895104895104895, "computeRatioMax": 0.04895104895104895, "endMs": "1665768328576", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22704", "recordsWritten": "4873", "shuffleOutputBytes": "764113", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665768328525", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $111, $381 := $116, $382 := $115, $383 := $114, $384 := $113, $385 := $112", "$100 := MIN($114)", "$101 := MAX($114)", "$102 := SHARD_AVG($114)", "$103 := MIN($113)", "$104 := MAX($113)", "$105 := SHARD_AVG($113)", "$106 := COUNT_STAR()", "$107 := MIN($112)", "$108 := MAX($112)", "$109 := SHARD_AVG($112)" ] }, { "kind": "FILTER", "substeps": [ "or(greater($117, 0), greater(if(is_null($118), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := ANY_VALUE($126)", "$117 := ANY_VALUE($127)", "$118 := SUM($128)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384, $385)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000777000777000777, "waitRatioMax": 0.000777000777000777, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.006993006993006993 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.016317016317016316, "computeRatioMax": 0.016317016317016316, "endMs": "1665768328645", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4873", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665768328582", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC, $395 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385", "$90 := MIN($100)", "$91 := MAX($101)", "$92 := ROOT_AVG($102)", "$93 := MIN($103)", "$94 := MAX($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := MIN($107)", "$98 := MAX($108)", "$99 := ROOT_AVG($109)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001554001554001554, "waitRatioMax": 0.001554001554001554, "writeMsAvg": "44", "writeMsMax": "44", "writeRatioAvg": 0.03418803418803419, "writeRatioMax": 0.03418803418803419 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00777000777000777, "computeRatioMax": 0.00777000777000777, "endMs": "1665768328662", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665768328600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $415 ASC, $414 ASC, $413 ASC, $412 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$420, $421, $422, $423, $424, $425, $426, $427, $428, $429, $430, $431, $432, $433, $434, $435", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000777000777000777, "waitRatioMax": 0.000777000777000777, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.00777000777000777, "writeRatioMax": 0.00777000777000777 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "644", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "9162" }, { "activeUnits": "1", "completedUnits": "314", "elapsedMs": "2152", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "14418" }, { "activeUnits": "0", "completedUnits": "423", "elapsedMs": "2692", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "19958" } ], "totalBytesBilled": "156237824", "totalBytesProcessed": "156174392", "totalPartitionsProcessed": "0", "totalSlotMs": "19958", "transferredBytes": "0" }, "startTime": "1665768326012", "totalBytesProcessed": "156174392", "totalSlotMs": "19958" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb98de002_b51a_48c0_8dd2_b85d1ca4a7a8" }, "priority": "INTERACTIVE", "query": "-- start query 35 in stream 0 using template query35.tpl\n\n/*\nFor the groups of customers living in the same state, having the same gender and marital status who have purchased from stores and from either the catalog or the web during a given year, display the following:\n \u2022 state, gender, marital status, count of customers\n \u2022 min, max, avg, count distinct of the customer\u2019s dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s employed dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s dependents in college count\nDisplay / calculate the \u201ccount of customers\u201d multiple times to emulate a potential reporting tool scenario\n*/\n\nselect \n ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n count(*) cnt1,\n min(cd_dep_count),\n max(cd_dep_count),\n avg(cd_dep_count),\n cd_dep_employed_count,\n count(*) cnt2,\n min(cd_dep_employed_count),\n max(cd_dep_employed_count),\n avg(cd_dep_employed_count),\n cd_dep_college_count,\n count(*) cnt3,\n min(cd_dep_college_count),\n max(cd_dep_college_count),\n avg(cd_dep_college_count)\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4))\n group by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n limit 100\n ;\n\n-- end query 35 in stream 0 using template query35.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ft0JXHfk4mPaNiCKvPeqBw==", "id": "test-project-364309:europe-west1.query35_1665777311", "jobReference": { "jobId": "query35_1665777311", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query35_1665777311?location=europe-west1", "statistics": { "creationTime": "1665777311796", "endTime": "1665777314162", "finalExecutionDurationMs": "2082", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156174392", "performanceInsights": { "avgPreviousExecutionMs": "1926" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.011591148577449948, "computeRatioMax": 0.011591148577449948, "endMs": "1665777312091", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007376185458377239, "readRatioMax": 0.007376185458377239, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665777312031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_qoy", "FROM date_dim", "WHERE and(equal($61, 2002), less($62, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.001053740779768177, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01685985247629083, "writeRatioMax": 0.01685985247629083 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.0368809272918862, "computeRatioMax": 0.0368809272918862, "endMs": "1665777312195", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008429926238145416, "readRatioMax": 0.008429926238145416, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665777312146", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "28", "waitMsMax": "28", "waitRatioAvg": 0.029504741833508957, "waitRatioMax": 0.029504741833508957, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01053740779768177, "writeRatioMax": 0.01053740779768177 }, { "completedParallelInputs": "6", "computeMsAvg": "131", "computeMsMax": "156", "computeRatioAvg": 0.1380400421496312, "computeRatioMax": 0.1643835616438356, "endMs": "1665777312294", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "11", "readRatioAvg": 0.009483667017913594, "readRatioMax": 0.011591148577449948, "recordsRead": "2882048", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "804", "startMs": "1665777312174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.002107481559536354, "writeMsAvg": "21", "writeMsMax": "24", "writeRatioAvg": 0.022128556375131718, "writeRatioMax": 0.02528977871443625 }, { "completedParallelInputs": "1", "computeMsAvg": "151", "computeMsMax": "151", "computeRatioAvg": 0.15911485774499473, "computeRatioMax": 0.15911485774499473, "endMs": "1665777312349", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006322444678609062, "readRatioMax": 0.006322444678609062, "recordsRead": "150000", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "168", "startMs": "1665777312224", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71, $232 := $81", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002107481559536354, "waitRatioMax": 0.002107481559536354, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.02423603793466807, "writeRatioMax": 0.02423603793466807 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.009483667017913594, "computeRatioMax": 0.01791359325605901, "endMs": "1665777312424", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "96562", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "4154", "startMs": "1665777312358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.003161222339304531, "waitRatioMax": 0.006322444678609062, "writeMsAvg": "19", "writeMsMax": "31", "writeRatioAvg": 0.020021074815595362, "writeRatioMax": 0.032665964172813484 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.009483667017913594, "computeRatioMax": 0.01791359325605901, "endMs": "1665777312431", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "299459", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "4431", "startMs": "1665777312358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.005268703898840885, "waitRatioMax": 0.006322444678609062, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.015806111696522657, "writeRatioMax": 0.030558482613277135 }, { "completedParallelInputs": "1", "computeMsAvg": "949", "computeMsMax": "949", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777313028", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.011591148577449948, "readRatioMax": 0.011591148577449948, "recordsRead": "2316821", "recordsWritten": "96562", "shuffleOutputBytes": "9808618", "shuffleOutputBytesSpilled": "0", "slotMs": "930", "startMs": "1665777312369", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_dep_count, $44:cd_dep_employed_count, $45:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $277", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($276)", "$202 := ANY_VALUE($275)", "$203 := ANY_VALUE($274)", "$204 := ANY_VALUE($273)", "$205 := ANY_VALUE($272)", "$206 := ANY_VALUE($271)", "$207 := ANY_VALUE($270)", "$208 := SUM($278)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $242, $271 := $243, $272 := $244, $273 := $245, $274 := $246, $275 := $240, $276 := $241, $277 := $210, $278 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$242 := $41, $243 := $42, $244 := $43, $245 := $44, $246 := $45, $240 := $230, $241 := $232", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.006322444678609062, "waitRatioMax": 0.006322444678609062, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.006322444678609062, "writeRatioMax": 0.006322444678609062 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.008429926238145416, "computeRatioMax": 0.008429926238145416, "endMs": "1665777313257", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008429926238145416, "readRatioMax": 0.008429926238145416, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777313219", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($31, 2002), less($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.001053740779768177, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.012644889357218124, "writeRatioMax": 0.012644889357218124 }, { "completedParallelInputs": "1", "computeMsAvg": "94", "computeMsMax": "94", "computeRatioAvg": 0.09905163329820864, "computeRatioMax": 0.09905163329820864, "endMs": "1665777313366", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008429926238145416, "readRatioMax": 0.008429926238145416, "recordsRead": "719658", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665777313289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.001053740779768177, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.011591148577449948, "writeRatioMax": 0.011591148577449948 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.009483667017913594, "computeRatioMax": 0.014752370916754479, "endMs": "1665777313446", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "78955", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "4747", "startMs": "1665777313386", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.002107481559536354, "waitRatioMax": 0.003161222339304531, "writeMsAvg": "26", "writeMsMax": "33", "writeRatioAvg": 0.0273972602739726, "writeRatioMax": 0.03477344573234984 }, { "completedParallelInputs": "1", "computeMsAvg": "177", "computeMsMax": "177", "computeRatioAvg": 0.18651211801896733, "computeRatioMax": 0.18651211801896733, "endMs": "1665777313548", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "175517", "recordsWritten": "22704", "shuffleOutputBytes": "2267090", "shuffleOutputBytesSpilled": "0", "slotMs": "159", "startMs": "1665777313391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($317)", "$162 := ANY_VALUE($316)", "$163 := ANY_VALUE($315)", "$164 := ANY_VALUE($314)", "$165 := ANY_VALUE($313)", "$166 := ANY_VALUE($312)", "$167 := ANY_VALUE($311)", "$168 := SUM($318)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $197, $318 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $192 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($198), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := ANY_VALUE($207)", "$198 := SUM($208)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.001053740779768177, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.006322444678609062, "writeRatioMax": 0.006322444678609062 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.015806111696522657, "computeRatioMax": 0.015806111696522657, "endMs": "1665777313642", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.01053740779768177, "readRatioMax": 0.01053740779768177, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665777313594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim", "WHERE and(equal($11, 2002), less($12, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002107481559536354, "waitRatioMax": 0.002107481559536354, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.012644889357218124, "writeRatioMax": 0.012644889357218124 }, { "completedParallelInputs": "5", "computeMsAvg": "73", "computeMsMax": "126", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.1327713382507903, "endMs": "1665777313789", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.011591148577449948, "readRatioMax": 0.015806111696522657, "recordsRead": "1442918", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "446", "startMs": "1665777313666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $150", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.002107481559536354, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.008429926238145416, "writeRatioMax": 0.01053740779768177 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.009483667017913594, "computeRatioMax": 0.018967334035827187, "endMs": "1665777313858", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "158759", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "4183", "startMs": "1665777313793", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.002107481559536354, "waitRatioMax": 0.005268703898840885, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.02107481559536354, "writeRatioMax": 0.032665964172813484 }, { "completedParallelInputs": "1", "computeMsAvg": "116", "computeMsMax": "116", "computeRatioAvg": 0.12223393045310854, "computeRatioMax": 0.12223393045310854, "endMs": "1665777313923", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "181463", "recordsWritten": "22704", "shuffleOutputBytes": "2285066", "shuffleOutputBytesSpilled": "0", "slotMs": "109", "startMs": "1665777313817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($357)", "$122 := ANY_VALUE($356)", "$123 := ANY_VALUE($355)", "$124 := ANY_VALUE($354)", "$125 := ANY_VALUE($353)", "$126 := ANY_VALUE($352)", "$127 := ANY_VALUE($351)", "$128 := SUM($358)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $131, $352 := $141, $353 := $142, $354 := $143, $355 := $144, $356 := $145, $357 := $147, $358 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $146 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()", "$131 := if(is_null($148), 0, $140)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$140 := SUM_OF_COUNTS($160)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($162)", "$143 := ANY_VALUE($163)", "$144 := ANY_VALUE($164)", "$145 := ANY_VALUE($165)", "$146 := ANY_VALUE($166)", "$147 := ANY_VALUE($167)", "$148 := SUM($168)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003161222339304531, "waitRatioMax": 0.003161222339304531, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.003161222339304531, "writeRatioMax": 0.003161222339304531 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.06111696522655427, "computeRatioMax": 0.06111696522655427, "endMs": "1665777313990", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22704", "recordsWritten": "4873", "shuffleOutputBytes": "764113", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777313946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $111, $381 := $116, $382 := $115, $383 := $114, $384 := $113, $385 := $112", "$100 := MIN($114)", "$101 := MAX($114)", "$102 := SHARD_AVG($114)", "$103 := MIN($113)", "$104 := MAX($113)", "$105 := SHARD_AVG($113)", "$106 := COUNT_STAR()", "$107 := MIN($112)", "$108 := MAX($112)", "$109 := SHARD_AVG($112)" ] }, { "kind": "FILTER", "substeps": [ "or(greater($117, 0), greater(if(is_null($118), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := ANY_VALUE($126)", "$117 := ANY_VALUE($127)", "$118 := SUM($128)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384, $385)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.001053740779768177, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008429926238145416, "writeRatioMax": 0.008429926238145416 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.02107481559536354, "computeRatioMax": 0.02107481559536354, "endMs": "1665777314041", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4873", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777313995", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC, $395 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385", "$90 := MIN($100)", "$91 := MAX($101)", "$92 := ROOT_AVG($102)", "$93 := MIN($103)", "$94 := MAX($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := MIN($107)", "$98 := MAX($108)", "$99 := ROOT_AVG($109)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.001053740779768177, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.023182297154899896, "writeRatioMax": 0.023182297154899896 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.007376185458377239, "computeRatioMax": 0.007376185458377239, "endMs": "1665777314057", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777314014", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $415 ASC, $414 ASC, $413 ASC, $412 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$420, $421, $422, $423, $424, $425, $426, $427, $428, $429, $430, $431, $432, $433, $434, $435", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001053740779768177, "waitRatioMax": 0.001053740779768177, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.006322444678609062, "writeRatioMax": 0.006322444678609062 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "680", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "9958" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "2256", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "20733" } ], "totalBytesBilled": "156237824", "totalBytesProcessed": "156174392", "totalPartitionsProcessed": "0", "totalSlotMs": "20733", "transferredBytes": "0" }, "startTime": "1665777311852", "totalBytesProcessed": "156174392", "totalSlotMs": "20733" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbf5e19db_dcf5_4a13_8e60_1c447ae9df0e" }, "priority": "INTERACTIVE", "query": "-- start query 35 in stream 0 using template query35.tpl\n\n/*\nFor the groups of customers living in the same state, having the same gender and marital status who have purchased from stores and from either the catalog or the web during a given year, display the following:\n \u2022 state, gender, marital status, count of customers\n \u2022 min, max, avg, count distinct of the customer\u2019s dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s employed dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s dependents in college count\nDisplay / calculate the \u201ccount of customers\u201d multiple times to emulate a potential reporting tool scenario\n*/\n\nselect \n ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n count(*) cnt1,\n min(cd_dep_count),\n max(cd_dep_count),\n avg(cd_dep_count),\n cd_dep_employed_count,\n count(*) cnt2,\n min(cd_dep_employed_count),\n max(cd_dep_employed_count),\n avg(cd_dep_employed_count),\n cd_dep_college_count,\n count(*) cnt3,\n min(cd_dep_college_count),\n max(cd_dep_college_count),\n avg(cd_dep_college_count)\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4))\n group by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n limit 100\n ;\n\n-- end query 35 in stream 0 using template query35.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "JM8ckRJHjJ5ozDzHOg94+g==", "id": "test-project-364309:europe-west1.query35_1665777315", "jobReference": { "jobId": "query35_1665777315", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query35_1665777315?location=europe-west1", "statistics": { "creationTime": "1665777315794", "endTime": "1665777317833", "finalExecutionDurationMs": "1750", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156174392", "performanceInsights": { "avgPreviousExecutionMs": "1952" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.010256410256410256, "computeRatioMax": 0.010256410256410256, "endMs": "1665777316052", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0071794871794871795, "readRatioMax": 0.0071794871794871795, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777316021", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_qoy", "FROM date_dim", "WHERE and(equal($61, 2002), less($62, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.015384615384615385, "writeRatioMax": 0.015384615384615385 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.02358974358974359, "computeRatioMax": 0.02358974358974359, "endMs": "1665777316113", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008205128205128205, "readRatioMax": 0.008205128205128205, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777316079", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "15", "waitMsMax": "15", "waitRatioAvg": 0.015384615384615385, "waitRatioMax": 0.015384615384615385, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.010256410256410256, "writeRatioMax": 0.010256410256410256 }, { "completedParallelInputs": "6", "computeMsAvg": "105", "computeMsMax": "162", "computeRatioAvg": 0.1076923076923077, "computeRatioMax": 0.16615384615384615, "endMs": "1665777316224", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.011282051282051283, "readRatioMax": 0.015384615384615385, "recordsRead": "2882048", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "759", "startMs": "1665777316093", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "22", "writeMsMax": "29", "writeRatioAvg": 0.022564102564102566, "writeRatioMax": 0.029743589743589743 }, { "completedParallelInputs": "1", "computeMsAvg": "96", "computeMsMax": "96", "computeRatioAvg": 0.09846153846153846, "computeRatioMax": 0.09846153846153846, "endMs": "1665777316218", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.010256410256410256, "readRatioMax": 0.010256410256410256, "recordsRead": "150000", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "112", "startMs": "1665777316129", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71, $232 := $81", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.020512820512820513, "writeRatioMax": 0.020512820512820513 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.009230769230769232, "computeRatioMax": 0.017435897435897435, "endMs": "1665777316303", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "96562", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "3595", "startMs": "1665777316247", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0020512820512820513, "waitRatioMax": 0.006153846153846154, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.014358974358974359, "writeRatioMax": 0.019487179487179488 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.009230769230769232, "computeRatioMax": 0.017435897435897435, "endMs": "1665777316298", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "299459", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "3418", "startMs": "1665777316247", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.0041025641025641026, "waitRatioMax": 0.006153846153846154, "writeMsAvg": "11", "writeMsMax": "23", "writeRatioAvg": 0.011282051282051283, "writeRatioMax": 0.02358974358974359 }, { "completedParallelInputs": "1", "computeMsAvg": "975", "computeMsMax": "975", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777316835", "id": "9", "inputStages": [ "8", "7" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.011282051282051283, "readRatioMax": 0.011282051282051283, "recordsRead": "2316821", "recordsWritten": "96562", "shuffleOutputBytes": "9808618", "shuffleOutputBytesSpilled": "0", "slotMs": "749", "startMs": "1665777316258", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_dep_count, $44:cd_dep_employed_count, $45:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $277", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($276)", "$202 := ANY_VALUE($275)", "$203 := ANY_VALUE($274)", "$204 := ANY_VALUE($273)", "$205 := ANY_VALUE($272)", "$206 := ANY_VALUE($271)", "$207 := ANY_VALUE($270)", "$208 := SUM($278)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $242, $271 := $243, $272 := $244, $273 := $245, $274 := $246, $275 := $240, $276 := $241, $277 := $210, $278 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$242 := $41, $243 := $42, $244 := $43, $245 := $44, $246 := $45, $240 := $230, $241 := $232", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.005128205128205128, "waitRatioMax": 0.005128205128205128, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005128205128205128, "writeRatioMax": 0.005128205128205128 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.014358974358974359, "computeRatioMax": 0.014358974358974359, "endMs": "1665777316931", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.009230769230769232, "readRatioMax": 0.009230769230769232, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777316887", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($31, 2002), less($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.012307692307692308, "writeRatioMax": 0.012307692307692308 }, { "completedParallelInputs": "1", "computeMsAvg": "104", "computeMsMax": "104", "computeRatioAvg": 0.10666666666666667, "computeRatioMax": 0.10666666666666667, "endMs": "1665777317033", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.009230769230769232, "readRatioMax": 0.009230769230769232, "recordsRead": "719658", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "108", "startMs": "1665777316950", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.009230769230769232, "writeRatioMax": 0.009230769230769232 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.008205128205128205, "computeRatioMax": 0.01641025641025641, "endMs": "1665777317091", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "78955", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "3609", "startMs": "1665777317040", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0020512820512820513, "waitRatioMax": 0.0041025641025641026, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.015384615384615385, "writeRatioMax": 0.020512820512820513 }, { "completedParallelInputs": "1", "computeMsAvg": "298", "computeMsMax": "298", "computeRatioAvg": 0.30564102564102563, "computeRatioMax": 0.30564102564102563, "endMs": "1665777317241", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "175517", "recordsWritten": "22704", "shuffleOutputBytes": "2267090", "shuffleOutputBytesSpilled": "0", "slotMs": "312", "startMs": "1665777317045", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($317)", "$162 := ANY_VALUE($316)", "$163 := ANY_VALUE($315)", "$164 := ANY_VALUE($314)", "$165 := ANY_VALUE($313)", "$166 := ANY_VALUE($312)", "$167 := ANY_VALUE($311)", "$168 := SUM($318)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $197, $318 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $192 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($198), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := ANY_VALUE($207)", "$198 := SUM($208)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003076923076923077, "waitRatioMax": 0.003076923076923077, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0041025641025641026, "writeRatioMax": 0.0041025641025641026 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.011282051282051283, "computeRatioMax": 0.011282051282051283, "endMs": "1665777317333", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0071794871794871795, "readRatioMax": 0.0071794871794871795, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777317291", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim", "WHERE and(equal($11, 2002), less($12, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.015384615384615385, "writeRatioMax": 0.015384615384615385 }, { "completedParallelInputs": "5", "computeMsAvg": "75", "computeMsMax": "87", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.08923076923076922, "endMs": "1665777317441", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "11", "readRatioAvg": 0.009230769230769232, "readRatioMax": 0.011282051282051283, "recordsRead": "1442918", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "425", "startMs": "1665777317366", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $150", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "9", "writeMsMax": "11", "writeRatioAvg": 0.009230769230769232, "writeRatioMax": 0.011282051282051283 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.009230769230769232, "computeRatioMax": 0.019487179487179488, "endMs": "1665777317503", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "158759", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "3911", "startMs": "1665777317445", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.0020512820512820513, "waitRatioMax": 0.005128205128205128, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.01641025641025641, "writeRatioMax": 0.03076923076923077 }, { "completedParallelInputs": "1", "computeMsAvg": "157", "computeMsMax": "157", "computeRatioAvg": 0.16102564102564101, "computeRatioMax": 0.16102564102564101, "endMs": "1665777317585", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "181463", "recordsWritten": "22704", "shuffleOutputBytes": "2285066", "shuffleOutputBytesSpilled": "0", "slotMs": "170", "startMs": "1665777317462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($357)", "$122 := ANY_VALUE($356)", "$123 := ANY_VALUE($355)", "$124 := ANY_VALUE($354)", "$125 := ANY_VALUE($353)", "$126 := ANY_VALUE($352)", "$127 := ANY_VALUE($351)", "$128 := SUM($358)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $131, $352 := $141, $353 := $142, $354 := $143, $355 := $144, $356 := $145, $357 := $147, $358 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $146 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()", "$131 := if(is_null($148), 0, $140)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$140 := SUM_OF_COUNTS($160)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($162)", "$143 := ANY_VALUE($163)", "$144 := ANY_VALUE($164)", "$145 := ANY_VALUE($165)", "$146 := ANY_VALUE($166)", "$147 := ANY_VALUE($167)", "$148 := SUM($168)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.018461538461538463, "writeRatioMax": 0.018461538461538463 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.05641025641025641, "computeRatioMax": 0.05641025641025641, "endMs": "1665777317663", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22704", "recordsWritten": "4873", "shuffleOutputBytes": "764113", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665777317625", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $111, $381 := $116, $382 := $115, $383 := $114, $384 := $113, $385 := $112", "$100 := MIN($114)", "$101 := MAX($114)", "$102 := SHARD_AVG($114)", "$103 := MIN($113)", "$104 := MAX($113)", "$105 := SHARD_AVG($113)", "$106 := COUNT_STAR()", "$107 := MIN($112)", "$108 := MAX($112)", "$109 := SHARD_AVG($112)" ] }, { "kind": "FILTER", "substeps": [ "or(greater($117, 0), greater(if(is_null($118), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := ANY_VALUE($126)", "$117 := ANY_VALUE($127)", "$118 := SUM($128)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384, $385)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005128205128205128, "writeRatioMax": 0.005128205128205128 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.019487179487179488, "computeRatioMax": 0.019487179487179488, "endMs": "1665777317713", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4873", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777317673", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC, $395 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385", "$90 := MIN($100)", "$91 := MAX($101)", "$92 := ROOT_AVG($102)", "$93 := MIN($103)", "$94 := MAX($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := MIN($107)", "$98 := MAX($108)", "$99 := ROOT_AVG($109)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.011282051282051283, "writeRatioMax": 0.011282051282051283 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.009230769230769232, "computeRatioMax": 0.009230769230769232, "endMs": "1665777317728", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777317689", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $415 ASC, $414 ASC, $413 ASC, $412 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$420, $421, $422, $423, $424, $425, $426, $427, $428, $429, $430, $431, $432, $433, $434, $435", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010256410256410256, "waitRatioMax": 0.0010256410256410256, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0041025641025641026, "writeRatioMax": 0.0041025641025641026 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "645", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "8039" }, { "activeUnits": "5", "completedUnits": "423", "elapsedMs": "1903", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "17531" } ], "totalBytesBilled": "156237824", "totalBytesProcessed": "156174392", "totalPartitionsProcessed": "0", "totalSlotMs": "17531", "transferredBytes": "0" }, "startTime": "1665777315877", "totalBytesProcessed": "156174392", "totalSlotMs": "17531" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbc3d02f8_18ec_4f41_90af_3916022bc256" }, "priority": "INTERACTIVE", "query": "-- start query 35 in stream 0 using template query35.tpl\n\n/*\nFor the groups of customers living in the same state, having the same gender and marital status who have purchased from stores and from either the catalog or the web during a given year, display the following:\n \u2022 state, gender, marital status, count of customers\n \u2022 min, max, avg, count distinct of the customer\u2019s dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s employed dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s dependents in college count\nDisplay / calculate the \u201ccount of customers\u201d multiple times to emulate a potential reporting tool scenario\n*/\n\nselect \n ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n count(*) cnt1,\n min(cd_dep_count),\n max(cd_dep_count),\n avg(cd_dep_count),\n cd_dep_employed_count,\n count(*) cnt2,\n min(cd_dep_employed_count),\n max(cd_dep_employed_count),\n avg(cd_dep_employed_count),\n cd_dep_college_count,\n count(*) cnt3,\n min(cd_dep_college_count),\n max(cd_dep_college_count),\n avg(cd_dep_college_count)\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4))\n group by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n limit 100\n ;\n\n-- end query 35 in stream 0 using template query35.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "kwG+tWFFebmNyItGhYVjog==", "id": "test-project-364309:europe-west1.query35_1665777319", "jobReference": { "jobId": "query35_1665777319", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query35_1665777319?location=europe-west1", "statistics": { "creationTime": "1665777319850", "endTime": "1665777322494", "finalExecutionDurationMs": "2364", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156174392", "performanceInsights": { "avgPreviousExecutionMs": "1923" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.006962025316455696, "computeRatioMax": 0.006962025316455696, "endMs": "1665777320088", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.00569620253164557, "readRatioMax": 0.00569620253164557, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777320051", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_qoy", "FROM date_dim", "WHERE and(equal($61, 2002), less($62, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.00569620253164557, "writeRatioMax": 0.00569620253164557 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.013924050632911392, "computeRatioMax": 0.013924050632911392, "endMs": "1665777320134", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0037974683544303796, "readRatioMax": 0.0037974683544303796, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777320100", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.008227848101265823, "writeRatioMax": 0.008227848101265823 }, { "completedParallelInputs": "6", "computeMsAvg": "106", "computeMsMax": "136", "computeRatioAvg": 0.0670886075949367, "computeRatioMax": 0.08607594936708861, "endMs": "1665777320239", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "12", "readRatioAvg": 0.00569620253164557, "readRatioMax": 0.007594936708860759, "recordsRead": "2882048", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "707", "startMs": "1665777320131", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0006329113924050633, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "22", "writeMsMax": "23", "writeRatioAvg": 0.013924050632911392, "writeRatioMax": 0.014556962025316455 }, { "completedParallelInputs": "1", "computeMsAvg": "155", "computeMsMax": "155", "computeRatioAvg": 0.0981012658227848, "computeRatioMax": 0.0981012658227848, "endMs": "1665777320269", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.007594936708860759, "readRatioMax": 0.007594936708860759, "recordsRead": "150000", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "169", "startMs": "1665777320154", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71, $232 := $81", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.015822784810126583, "writeRatioMax": 0.015822784810126583 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.00569620253164557, "computeRatioMax": 0.010126582278481013, "endMs": "1665777320334", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "96562", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "3341", "startMs": "1665777320281", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "8", "waitMsMax": "36", "waitRatioAvg": 0.005063291139240506, "waitRatioMax": 0.02278481012658228, "writeMsAvg": "13", "writeMsMax": "28", "writeRatioAvg": 0.008227848101265823, "writeRatioMax": 0.017721518987341773 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.005063291139240506, "computeRatioMax": 0.008860759493670886, "endMs": "1665777320349", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "299459", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "2036", "startMs": "1665777320281", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "29", "waitMsMax": "36", "waitRatioAvg": 0.018354430379746836, "waitRatioMax": 0.02278481012658228, "writeMsAvg": "4", "writeMsMax": "19", "writeRatioAvg": 0.002531645569620253, "writeRatioMax": 0.012025316455696202 }, { "completedParallelInputs": "1", "computeMsAvg": "1580", "computeMsMax": "1580", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777321253", "id": "9", "inputStages": [ "8", "7" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.013924050632911392, "readRatioMax": 0.013924050632911392, "recordsRead": "2316821", "recordsWritten": "96562", "shuffleOutputBytes": "9808618", "shuffleOutputBytesSpilled": "0", "slotMs": "1324", "startMs": "1665777320318", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_dep_count, $44:cd_dep_employed_count, $45:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $277", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($276)", "$202 := ANY_VALUE($275)", "$203 := ANY_VALUE($274)", "$204 := ANY_VALUE($273)", "$205 := ANY_VALUE($272)", "$206 := ANY_VALUE($271)", "$207 := ANY_VALUE($270)", "$208 := SUM($278)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $242, $271 := $243, $272 := $244, $273 := $245, $274 := $246, $275 := $240, $276 := $241, $277 := $210, $278 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$242 := $41, $243 := $42, $244 := $43, $245 := $44, $246 := $45, $240 := $230, $241 := $232", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "32", "waitMsMax": "32", "waitRatioAvg": 0.020253164556962026, "waitRatioMax": 0.020253164556962026, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0037974683544303796, "writeRatioMax": 0.0037974683544303796 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.005063291139240506, "computeRatioMax": 0.005063291139240506, "endMs": "1665777321537", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0037974683544303796, "readRatioMax": 0.0037974683544303796, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777321499", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($31, 2002), less($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.015822784810126583, "writeRatioMax": 0.015822784810126583 }, { "completedParallelInputs": "1", "computeMsAvg": "105", "computeMsMax": "105", "computeRatioAvg": 0.06645569620253164, "computeRatioMax": 0.06645569620253164, "endMs": "1665777321677", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.007594936708860759, "readRatioMax": 0.007594936708860759, "recordsRead": "719658", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "133", "startMs": "1665777321575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.010759493670886076, "writeRatioMax": 0.010759493670886076 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.00569620253164557, "computeRatioMax": 0.013291139240506329, "endMs": "1665777321738", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "78955", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "3692", "startMs": "1665777321684", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.0031645569620253164, "writeMsAvg": "15", "writeMsMax": "24", "writeRatioAvg": 0.00949367088607595, "writeRatioMax": 0.015189873417721518 }, { "completedParallelInputs": "1", "computeMsAvg": "214", "computeMsMax": "214", "computeRatioAvg": 0.13544303797468354, "computeRatioMax": 0.13544303797468354, "endMs": "1665777321823", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "175517", "recordsWritten": "22704", "shuffleOutputBytes": "2267090", "shuffleOutputBytesSpilled": "0", "slotMs": "195", "startMs": "1665777321692", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($317)", "$162 := ANY_VALUE($316)", "$163 := ANY_VALUE($315)", "$164 := ANY_VALUE($314)", "$165 := ANY_VALUE($313)", "$166 := ANY_VALUE($312)", "$167 := ANY_VALUE($311)", "$168 := SUM($318)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $197, $318 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $192 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($198), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := ANY_VALUE($207)", "$198 := SUM($208)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0031645569620253164, "writeRatioMax": 0.0031645569620253164 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.006329113924050633, "computeRatioMax": 0.006329113924050633, "endMs": "1665777321886", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.005063291139240506, "readRatioMax": 0.005063291139240506, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777321843", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim", "WHERE and(equal($11, 2002), less($12, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006329113924050633, "waitRatioMax": 0.0006329113924050633, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.008860759493670886, "writeRatioMax": 0.008860759493670886 }, { "completedParallelInputs": "5", "computeMsAvg": "89", "computeMsMax": "102", "computeRatioAvg": 0.056329113924050635, "computeRatioMax": 0.06455696202531645, "endMs": "1665777322007", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "19", "readRatioAvg": 0.007594936708860759, "readRatioMax": 0.012025316455696202, "recordsRead": "1442918", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "477", "startMs": "1665777321922", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $150", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "9", "writeMsMax": "11", "writeRatioAvg": 0.00569620253164557, "writeRatioMax": 0.006962025316455696 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.005063291139240506, "computeRatioMax": 0.01139240506329114, "endMs": "1665777322084", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "158759", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "4208", "startMs": "1665777322016", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.002531645569620253, "waitRatioMax": 0.0031645569620253164, "writeMsAvg": "16", "writeMsMax": "22", "writeRatioAvg": 0.010126582278481013, "writeRatioMax": 0.013924050632911392 }, { "completedParallelInputs": "1", "computeMsAvg": "226", "computeMsMax": "226", "computeRatioAvg": 0.14303797468354432, "computeRatioMax": 0.14303797468354432, "endMs": "1665777322231", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "181463", "recordsWritten": "22704", "shuffleOutputBytes": "2285066", "shuffleOutputBytesSpilled": "0", "slotMs": "219", "startMs": "1665777322031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($357)", "$122 := ANY_VALUE($356)", "$123 := ANY_VALUE($355)", "$124 := ANY_VALUE($354)", "$125 := ANY_VALUE($353)", "$126 := ANY_VALUE($352)", "$127 := ANY_VALUE($351)", "$128 := SUM($358)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $131, $352 := $141, $353 := $142, $354 := $143, $355 := $144, $356 := $145, $357 := $147, $358 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $146 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()", "$131 := if(is_null($148), 0, $140)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$140 := SUM_OF_COUNTS($160)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($162)", "$143 := ANY_VALUE($163)", "$144 := ANY_VALUE($164)", "$145 := ANY_VALUE($165)", "$146 := ANY_VALUE($166)", "$147 := ANY_VALUE($167)", "$148 := SUM($168)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0037974683544303796, "writeRatioMax": 0.0037974683544303796 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.028481012658227847, "computeRatioMax": 0.028481012658227847, "endMs": "1665777322294", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22704", "recordsWritten": "4873", "shuffleOutputBytes": "764113", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777322256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $111, $381 := $116, $382 := $115, $383 := $114, $384 := $113, $385 := $112", "$100 := MIN($114)", "$101 := MAX($114)", "$102 := SHARD_AVG($114)", "$103 := MIN($113)", "$104 := MAX($113)", "$105 := SHARD_AVG($113)", "$106 := COUNT_STAR()", "$107 := MIN($112)", "$108 := MAX($112)", "$109 := SHARD_AVG($112)" ] }, { "kind": "FILTER", "substeps": [ "or(greater($117, 0), greater(if(is_null($118), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := ANY_VALUE($126)", "$117 := ANY_VALUE($127)", "$118 := SUM($128)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384, $385)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.004430379746835443, "writeRatioMax": 0.004430379746835443 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.013924050632911392, "computeRatioMax": 0.013924050632911392, "endMs": "1665777322352", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4873", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777322314", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC, $395 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385", "$90 := MIN($100)", "$91 := MAX($101)", "$92 := ROOT_AVG($102)", "$93 := MIN($103)", "$94 := MAX($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := MIN($107)", "$98 := MAX($108)", "$99 := ROOT_AVG($109)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "TO __stage15_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.004430379746835443, "waitRatioMax": 0.004430379746835443, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0037974683544303796, "writeRatioMax": 0.0037974683544303796 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.006329113924050633, "computeRatioMax": 0.006329113924050633, "endMs": "1665777322374", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777322326", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $415 ASC, $414 ASC, $413 ASC, $412 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$420, $421, $422, $423, $424, $425, $426, $427, $428, $429, $430, $431, $432, $433, $434, $435", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012658227848101266, "waitRatioMax": 0.0012658227848101266, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0037974683544303796, "writeRatioMax": 0.0037974683544303796 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "646", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6459" }, { "activeUnits": "101", "completedUnits": "423", "elapsedMs": "2538", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "16812" } ], "totalBytesBilled": "156237824", "totalBytesProcessed": "156174392", "totalPartitionsProcessed": "0", "totalSlotMs": "16812", "transferredBytes": "0" }, "startTime": "1665777319905", "totalBytesProcessed": "156174392", "totalSlotMs": "16812" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3fafe0e9_49f2_4c45_9b0e_9f0e073c0b1e" }, "priority": "INTERACTIVE", "query": "-- start query 35 in stream 0 using template query35.tpl\n\n/*\nFor the groups of customers living in the same state, having the same gender and marital status who have purchased from stores and from either the catalog or the web during a given year, display the following:\n \u2022 state, gender, marital status, count of customers\n \u2022 min, max, avg, count distinct of the customer\u2019s dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s employed dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s dependents in college count\nDisplay / calculate the \u201ccount of customers\u201d multiple times to emulate a potential reporting tool scenario\n*/\n\nselect \n ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n count(*) cnt1,\n min(cd_dep_count),\n max(cd_dep_count),\n avg(cd_dep_count),\n cd_dep_employed_count,\n count(*) cnt2,\n min(cd_dep_employed_count),\n max(cd_dep_employed_count),\n avg(cd_dep_employed_count),\n cd_dep_college_count,\n count(*) cnt3,\n min(cd_dep_college_count),\n max(cd_dep_college_count),\n avg(cd_dep_college_count)\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4))\n group by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n limit 100\n ;\n\n-- end query 35 in stream 0 using template query35.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Tt6qF4RsljRbQq8garhf+Q==", "id": "test-project-364309:europe-west1.query35_1665777324", "jobReference": { "jobId": "query35_1665777324", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query35_1665777324?location=europe-west1", "statistics": { "creationTime": "1665777325101", "endTime": "1665777327390", "finalExecutionDurationMs": "2018", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156174392", "performanceInsights": { "avgPreviousExecutionMs": "1978" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.006906077348066298, "computeRatioMax": 0.006906077348066298, "endMs": "1665777325346", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.006906077348066298, "readRatioMax": 0.006906077348066298, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777325306", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_qoy", "FROM date_dim", "WHERE and(equal($61, 2002), less($62, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.004834254143646409, "writeRatioMax": 0.004834254143646409 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.013121546961325966, "computeRatioMax": 0.013121546961325966, "endMs": "1665777325380", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003453038674033149, "readRatioMax": 0.003453038674033149, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777325351", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.006906077348066298, "writeRatioMax": 0.006906077348066298 }, { "completedParallelInputs": "6", "computeMsAvg": "114", "computeMsMax": "172", "computeRatioAvg": 0.0787292817679558, "computeRatioMax": 0.11878453038674033, "endMs": "1665777325524", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "17", "readRatioAvg": 0.007596685082872928, "readRatioMax": 0.011740331491712707, "recordsRead": "2882048", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "814", "startMs": "1665777325378", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "23", "writeMsMax": "26", "writeRatioAvg": 0.015883977900552487, "writeRatioMax": 0.017955801104972375 }, { "completedParallelInputs": "1", "computeMsAvg": "158", "computeMsMax": "158", "computeRatioAvg": 0.10911602209944751, "computeRatioMax": 0.10911602209944751, "endMs": "1665777325520", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004834254143646409, "readRatioMax": 0.004834254143646409, "recordsRead": "150000", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "167", "startMs": "1665777325395", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71, $232 := $81", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006906077348066298, "waitRatioMax": 0.0006906077348066298, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.015193370165745856, "writeRatioMax": 0.015193370165745856 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.006215469613259668, "computeRatioMax": 0.014502762430939226, "endMs": "1665777325600", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "96562", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "3460", "startMs": "1665777325549", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.0020718232044198894, "waitRatioMax": 0.004834254143646409, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.010359116022099447, "writeRatioMax": 0.017955801104972375 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.006215469613259668, "computeRatioMax": 0.011740331491712707, "endMs": "1665777325616", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "299459", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "4517", "startMs": "1665777325549", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.004143646408839779, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "26", "writeMsMax": "50", "writeRatioAvg": 0.017955801104972375, "writeRatioMax": 0.034530386740331494 }, { "completedParallelInputs": "1", "computeMsAvg": "1448", "computeMsMax": "1448", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777326361", "id": "9", "inputStages": [ "8", "7" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.008977900552486187, "readRatioMax": 0.008977900552486187, "recordsRead": "2316821", "recordsWritten": "96562", "shuffleOutputBytes": "9808618", "shuffleOutputBytesSpilled": "0", "slotMs": "1128", "startMs": "1665777325558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_dep_count, $44:cd_dep_employed_count, $45:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $277", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($276)", "$202 := ANY_VALUE($275)", "$203 := ANY_VALUE($274)", "$204 := ANY_VALUE($273)", "$205 := ANY_VALUE($272)", "$206 := ANY_VALUE($271)", "$207 := ANY_VALUE($270)", "$208 := SUM($278)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $242, $271 := $243, $272 := $244, $273 := $245, $274 := $246, $275 := $240, $276 := $241, $277 := $210, $278 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$242 := $41, $243 := $42, $244 := $43, $245 := $44, $246 := $45, $240 := $230, $241 := $232", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0027624309392265192, "waitRatioMax": 0.0027624309392265192, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.004834254143646409, "writeRatioMax": 0.004834254143646409 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0055248618784530384, "computeRatioMax": 0.0055248618784530384, "endMs": "1665777326511", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004143646408839779, "readRatioMax": 0.004143646408839779, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777326481", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($31, 2002), less($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006906077348066298, "waitRatioMax": 0.0006906077348066298, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.011049723756906077, "writeRatioMax": 0.011049723756906077 }, { "completedParallelInputs": "1", "computeMsAvg": "126", "computeMsMax": "126", "computeRatioAvg": 0.08701657458563536, "computeRatioMax": 0.08701657458563536, "endMs": "1665777326612", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.006906077348066298, "readRatioMax": 0.006906077348066298, "recordsRead": "719658", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "115", "startMs": "1665777326527", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006906077348066298, "waitRatioMax": 0.0006906077348066298, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006215469613259668, "writeRatioMax": 0.006215469613259668 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.006215469613259668, "computeRatioMax": 0.011740331491712707, "endMs": "1665777326691", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "78955", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "3149", "startMs": "1665777326634", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.004143646408839779, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.009668508287292817, "writeRatioMax": 0.015193370165745856 }, { "completedParallelInputs": "1", "computeMsAvg": "180", "computeMsMax": "180", "computeRatioAvg": 0.12430939226519337, "computeRatioMax": 0.12430939226519337, "endMs": "1665777326804", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "175517", "recordsWritten": "22704", "shuffleOutputBytes": "2267090", "shuffleOutputBytesSpilled": "0", "slotMs": "162", "startMs": "1665777326640", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($317)", "$162 := ANY_VALUE($316)", "$163 := ANY_VALUE($315)", "$164 := ANY_VALUE($314)", "$165 := ANY_VALUE($313)", "$166 := ANY_VALUE($312)", "$167 := ANY_VALUE($311)", "$168 := SUM($318)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $197, $318 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $192 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($198), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := ANY_VALUE($207)", "$198 := SUM($208)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.004143646408839779, "writeRatioMax": 0.004143646408839779 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007596685082872928, "computeRatioMax": 0.007596685082872928, "endMs": "1665777326899", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.006215469613259668, "readRatioMax": 0.006215469613259668, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777326863", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim", "WHERE and(equal($11, 2002), less($12, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0055248618784530384, "writeRatioMax": 0.0055248618784530384 }, { "completedParallelInputs": "5", "computeMsAvg": "76", "computeMsMax": "89", "computeRatioAvg": 0.052486187845303865, "computeRatioMax": 0.06146408839779006, "endMs": "1665777326990", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "14", "readRatioAvg": 0.006906077348066298, "readRatioMax": 0.009668508287292817, "recordsRead": "1442918", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "396", "startMs": "1665777326921", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $150", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006906077348066298, "waitRatioMax": 0.0006906077348066298, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.004834254143646409, "writeRatioMax": 0.006215469613259668 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0055248618784530384, "computeRatioMax": 0.011049723756906077, "endMs": "1665777327048", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "158759", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "3155", "startMs": "1665777326999", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0020718232044198894, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.010359116022099447, "writeRatioMax": 0.014502762430939226 }, { "completedParallelInputs": "1", "computeMsAvg": "141", "computeMsMax": "141", "computeRatioAvg": 0.09737569060773481, "computeRatioMax": 0.09737569060773481, "endMs": "1665777327148", "id": "19", "inputStages": [ "14", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "181463", "recordsWritten": "22704", "shuffleOutputBytes": "2285066", "shuffleOutputBytesSpilled": "0", "slotMs": "154", "startMs": "1665777327012", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($357)", "$122 := ANY_VALUE($356)", "$123 := ANY_VALUE($355)", "$124 := ANY_VALUE($354)", "$125 := ANY_VALUE($353)", "$126 := ANY_VALUE($352)", "$127 := ANY_VALUE($351)", "$128 := SUM($358)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $131, $352 := $141, $353 := $142, $354 := $143, $355 := $144, $356 := $145, $357 := $147, $358 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $146 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()", "$131 := if(is_null($148), 0, $140)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$140 := SUM_OF_COUNTS($160)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($162)", "$143 := ANY_VALUE($163)", "$144 := ANY_VALUE($164)", "$145 := ANY_VALUE($165)", "$146 := ANY_VALUE($166)", "$147 := ANY_VALUE($167)", "$148 := SUM($168)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0020718232044198894, "waitRatioMax": 0.0020718232044198894, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0055248618784530384, "writeRatioMax": 0.0055248618784530384 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.03314917127071823, "computeRatioMax": 0.03314917127071823, "endMs": "1665777327210", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22704", "recordsWritten": "4873", "shuffleOutputBytes": "764113", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777327171", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $111, $381 := $116, $382 := $115, $383 := $114, $384 := $113, $385 := $112", "$100 := MIN($114)", "$101 := MAX($114)", "$102 := SHARD_AVG($114)", "$103 := MIN($113)", "$104 := MAX($113)", "$105 := SHARD_AVG($113)", "$106 := COUNT_STAR()", "$107 := MIN($112)", "$108 := MAX($112)", "$109 := SHARD_AVG($112)" ] }, { "kind": "FILTER", "substeps": [ "or(greater($117, 0), greater(if(is_null($118), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := ANY_VALUE($126)", "$117 := ANY_VALUE($127)", "$118 := SUM($128)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384, $385)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0013812154696132596, "waitRatioMax": 0.0013812154696132596, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.004143646408839779, "writeRatioMax": 0.004143646408839779 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.011049723756906077, "computeRatioMax": 0.011049723756906077, "endMs": "1665777327256", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4873", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777327221", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC, $395 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385", "$90 := MIN($100)", "$91 := MAX($101)", "$92 := ROOT_AVG($102)", "$93 := MIN($103)", "$94 := MAX($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := MIN($107)", "$98 := MAX($108)", "$99 := ROOT_AVG($109)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006906077348066298, "waitRatioMax": 0.0006906077348066298, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006215469613259668, "writeRatioMax": 0.006215469613259668 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.006906077348066298, "computeRatioMax": 0.006906077348066298, "endMs": "1665777327276", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777327233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $415 ASC, $414 ASC, $413 ASC, $412 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$420, $421, $422, $423, $424, $425, $426, $427, $428, $429, $430, $431, $432, $433, $434, $435", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006906077348066298, "waitRatioMax": 0.0006906077348066298, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.004143646408839779, "writeRatioMax": 0.004143646408839779 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "649", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "8831" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "2179", "estimatedRunnableUnits": "1", "pendingUnits": "0", "totalSlotMs": "17289" } ], "totalBytesBilled": "156237824", "totalBytesProcessed": "156174392", "totalPartitionsProcessed": "0", "totalSlotMs": "17289", "transferredBytes": "0" }, "startTime": "1665777325158", "totalBytesProcessed": "156174392", "totalSlotMs": "17289" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon15e0a97e_49f9_4a55_beb1_b4ed8c421dd7" }, "priority": "INTERACTIVE", "query": "-- start query 35 in stream 0 using template query35.tpl\n\n/*\nFor the groups of customers living in the same state, having the same gender and marital status who have purchased from stores and from either the catalog or the web during a given year, display the following:\n \u2022 state, gender, marital status, count of customers\n \u2022 min, max, avg, count distinct of the customer\u2019s dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s employed dependent count\n \u2022 min, max, avg, count distinct of the customer\u2019s dependents in college count\nDisplay / calculate the \u201ccount of customers\u201d multiple times to emulate a potential reporting tool scenario\n*/\n\nselect \n ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n count(*) cnt1,\n min(cd_dep_count),\n max(cd_dep_count),\n avg(cd_dep_count),\n cd_dep_employed_count,\n count(*) cnt2,\n min(cd_dep_employed_count),\n max(cd_dep_employed_count),\n avg(cd_dep_employed_count),\n cd_dep_college_count,\n count(*) cnt3,\n min(cd_dep_college_count),\n max(cd_dep_college_count),\n avg(cd_dep_college_count)\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_qoy < 4))\n group by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by ca_state,\n cd_gender,\n cd_marital_status,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n limit 100\n ;\n\n-- end query 35 in stream 0 using template query35.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "UXE5vycSrv0/Qng5ZcZ77Q==", "id": "test-project-364309:europe-west1.query35_1665777328", "jobReference": { "jobId": "query35_1665777328", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query35_1665777328?location=europe-west1", "statistics": { "creationTime": "1665777329213", "endTime": "1665777331657", "finalExecutionDurationMs": "2158", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "156174392", "performanceInsights": { "avgPreviousExecutionMs": "1983" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.008202323991797676, "computeRatioMax": 0.008202323991797676, "endMs": "1665777329460", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.006151742993848257, "readRatioMax": 0.006151742993848257, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777329429", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_qoy", "FROM date_dim", "WHERE and(equal($61, 2002), less($62, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.000683526999316473, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.008202323991797676, "writeRatioMax": 0.008202323991797676 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.01845522898154477, "computeRatioMax": 0.01845522898154477, "endMs": "1665777329517", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.006151742993848257, "readRatioMax": 0.006151742993848257, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777329480", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.000683526999316473, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.008202323991797676, "writeRatioMax": 0.008202323991797676 }, { "completedParallelInputs": "6", "computeMsAvg": "110", "computeMsMax": "126", "computeRatioAvg": 0.07518796992481203, "computeRatioMax": 0.0861244019138756, "endMs": "1665777329636", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "8", "readMsMax": "12", "readRatioAvg": 0.005468215994531784, "readRatioMax": 0.008202323991797676, "recordsRead": "2882048", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "642", "startMs": "1665777329525", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$260 := $51, $261 := $220", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$260, $261", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.001367053998632946, "writeMsAvg": "21", "writeMsMax": "24", "writeRatioAvg": 0.014354066985645933, "writeRatioMax": 0.016404647983595352 }, { "completedParallelInputs": "1", "computeMsAvg": "213", "computeMsMax": "213", "computeRatioAvg": 0.14559125085440874, "computeRatioMax": 0.14559125085440874, "endMs": "1665777329678", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.005468215994531784, "readRatioMax": 0.005468215994531784, "recordsRead": "150000", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "195", "startMs": "1665777329547", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $70, $231 := $71, $232 := $81", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$230, $231, $232", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.000683526999316473, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01367053998632946, "writeRatioMax": 0.01367053998632946 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.006151742993848257, "computeRatioMax": 0.010252904989747095, "endMs": "1665777329752", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "96562", "recordsWritten": "96562", "shuffleOutputBytes": "2395942", "shuffleOutputBytesSpilled": "0", "slotMs": "3541", "startMs": "1665777329697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "3", "waitMsMax": "9", "waitRatioAvg": 0.002050580997949419, "waitRatioMax": 0.006151742993848257, "writeMsAvg": "16", "writeMsMax": "20", "writeRatioAvg": 0.010936431989063569, "writeRatioMax": 0.01367053998632946 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.006151742993848257, "computeRatioMax": 0.010252904989747095, "endMs": "1665777329759", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "299459", "recordsWritten": "299459", "shuffleOutputBytes": "5390262", "shuffleOutputBytesSpilled": "0", "slotMs": "3311", "startMs": "1665777329698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "7", "waitMsMax": "10", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.00683526999316473, "writeMsAvg": "13", "writeMsMax": "22", "writeRatioAvg": 0.00888585099111415, "writeRatioMax": 0.015037593984962405 }, { "completedParallelInputs": "1", "computeMsAvg": "1463", "computeMsMax": "1463", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777330514", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.010252904989747095, "readRatioMax": 0.010252904989747095, "recordsRead": "2316821", "recordsWritten": "96562", "shuffleOutputBytes": "9808618", "shuffleOutputBytesSpilled": "0", "slotMs": "1153", "startMs": "1665777329708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_dep_count, $44:cd_dep_employed_count, $45:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$230, $231, $232", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$260, $261", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $277", "$200 := COUNT_STAR()", "$201 := ANY_VALUE($276)", "$202 := ANY_VALUE($275)", "$203 := ANY_VALUE($274)", "$204 := ANY_VALUE($273)", "$205 := ANY_VALUE($272)", "$206 := ANY_VALUE($271)", "$207 := ANY_VALUE($270)", "$208 := SUM($278)" ] }, { "kind": "JOIN", "substeps": [ "$270 := $242, $271 := $243, $272 := $244, $273 := $245, $274 := $246, $275 := $240, $276 := $241, $277 := $210, $278 := $261", "LEFT OUTER HASH JOIN EACH WITH ALL ON $240 = $260" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$242 := $41, $243 := $42, $244 := $43, $245 := $44, $246 := $45, $240 := $230, $241 := $232", "INNER HASH JOIN EACH WITH ALL ON $40 = $231" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "TO __stage09_output", "BY HASH($280)" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.006151742993848257, "waitRatioMax": 0.006151742993848257, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.004784688995215311, "writeRatioMax": 0.004784688995215311 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007518796992481203, "computeRatioMax": 0.007518796992481203, "endMs": "1665777330639", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004784688995215311, "readRatioMax": 0.004784688995215311, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777330596", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_qoy", "FROM date_dim", "WHERE and(equal($31, 2002), less($32, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.000683526999316473, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010252904989747095, "writeRatioMax": 0.010252904989747095 }, { "completedParallelInputs": "1", "computeMsAvg": "122", "computeMsMax": "122", "computeRatioAvg": 0.08339029391660971, "computeRatioMax": 0.08339029391660971, "endMs": "1665777330749", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004101161995898838, "readRatioMax": 0.004101161995898838, "recordsRead": "719658", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "111", "startMs": "1665777330669", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$300 := $21, $301 := $180", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$300, $301", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.000683526999316473, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.00683526999316473, "writeRatioMax": 0.00683526999316473 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.006151742993848257, "computeRatioMax": 0.01367053998632946, "endMs": "1665777330822", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "78955", "recordsWritten": "78955", "shuffleOutputBytes": "1421190", "shuffleOutputBytesSpilled": "0", "slotMs": "3662", "startMs": "1665777330764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.001367053998632946, "waitRatioMax": 0.002734107997265892, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.010936431989063569, "writeRatioMax": 0.02050580997949419 }, { "completedParallelInputs": "1", "computeMsAvg": "245", "computeMsMax": "245", "computeRatioAvg": 0.1674641148325359, "computeRatioMax": 0.1674641148325359, "endMs": "1665777330972", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "175517", "recordsWritten": "22704", "shuffleOutputBytes": "2267090", "shuffleOutputBytesSpilled": "0", "slotMs": "215", "startMs": "1665777330769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $202, $203, $204, $205, $206, $207, $208, $280", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$300, $301", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310", "$160 := COUNT_STAR()", "$161 := ANY_VALUE($317)", "$162 := ANY_VALUE($316)", "$163 := ANY_VALUE($315)", "$164 := ANY_VALUE($314)", "$165 := ANY_VALUE($313)", "$166 := ANY_VALUE($312)", "$167 := ANY_VALUE($311)", "$168 := SUM($318)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $170, $311 := $191, $312 := $192, $313 := $193, $314 := $194, $315 := $195, $316 := $196, $317 := $197, $318 := $301", "LEFT OUTER HASH JOIN EACH WITH ALL ON $192 = $300" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($198), 0, $190), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$190 := SUM_OF_COUNTS($200)", "$191 := ANY_VALUE($201)", "$192 := ANY_VALUE($202)", "$193 := ANY_VALUE($203)", "$194 := ANY_VALUE($204)", "$195 := ANY_VALUE($205)", "$196 := ANY_VALUE($206)", "$197 := ANY_VALUE($207)", "$198 := SUM($208)" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "TO __stage0E_output", "BY HASH($320)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.002734107997265892, "waitRatioMax": 0.002734107997265892, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.002734107997265892, "writeRatioMax": 0.002734107997265892 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007518796992481203, "computeRatioMax": 0.007518796992481203, "endMs": "1665777331063", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004101161995898838, "readRatioMax": 0.004101161995898838, "recordsRead": "73049", "recordsWritten": "274", "shuffleOutputBytes": "2466", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777331019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_qoy", "FROM date_dim", "WHERE and(equal($11, 2002), less($12, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.000683526999316473, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.01161995898838004, "writeRatioMax": 0.01161995898838004 }, { "completedParallelInputs": "5", "computeMsAvg": "75", "computeMsMax": "89", "computeRatioAvg": 0.05126452494873548, "computeRatioMax": 0.060833902939166094, "endMs": "1665777331170", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "14", "readMsMax": "19", "readRatioAvg": 0.009569377990430622, "readRatioMax": 0.012987012987012988, "recordsRead": "1442918", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "458", "startMs": "1665777331085", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$340 := $2, $341 := $150", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := 1" ] }, { "kind": "WRITE", "substeps": [ "$340, $341", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.001367053998632946, "writeMsAvg": "11", "writeMsMax": "12", "writeRatioAvg": 0.007518796992481203, "writeRatioMax": 0.008202323991797676 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "19", "computeRatioAvg": 0.00683526999316473, "computeRatioMax": 0.012987012987012988, "endMs": "1665777331238", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "158759", "recordsWritten": "158759", "shuffleOutputBytes": "2857662", "shuffleOutputBytesSpilled": "0", "slotMs": "3886", "startMs": "1665777331174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.001367053998632946, "waitRatioMax": 0.002050580997949419, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.010252904989747095, "writeRatioMax": 0.017088174982911826 }, { "completedParallelInputs": "1", "computeMsAvg": "164", "computeMsMax": "164", "computeRatioAvg": 0.11209842788790157, "computeRatioMax": 0.11209842788790157, "endMs": "1665777331336", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "181463", "recordsWritten": "22704", "shuffleOutputBytes": "2285066", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665777331191", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $161, $162, $163, $164, $165, $166, $167, $168, $320", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$340, $341", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$120 := COUNT_STAR()", "$121 := ANY_VALUE($357)", "$122 := ANY_VALUE($356)", "$123 := ANY_VALUE($355)", "$124 := ANY_VALUE($354)", "$125 := ANY_VALUE($353)", "$126 := ANY_VALUE($352)", "$127 := ANY_VALUE($351)", "$128 := SUM($358)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $130, $351 := $131, $352 := $141, $353 := $142, $354 := $143, $355 := $144, $356 := $145, $357 := $147, $358 := $341", "LEFT OUTER HASH JOIN EACH WITH ALL ON $146 = $340" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := UNIQUE_ROW_ID()", "$131 := if(is_null($148), 0, $140)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320", "$140 := SUM_OF_COUNTS($160)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($162)", "$143 := ANY_VALUE($163)", "$144 := ANY_VALUE($164)", "$145 := ANY_VALUE($165)", "$146 := ANY_VALUE($166)", "$147 := ANY_VALUE($167)", "$148 := SUM($168)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "TO __stage13_output", "BY HASH($360)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001367053998632946, "waitRatioMax": 0.001367053998632946, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.004784688995215311, "writeRatioMax": 0.004784688995215311 }, { "completedParallelInputs": "1", "computeMsAvg": "68", "computeMsMax": "68", "computeRatioAvg": 0.04647983595352016, "computeRatioMax": 0.04647983595352016, "endMs": "1665777331426", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22704", "recordsWritten": "4873", "shuffleOutputBytes": "764113", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665777331369", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127, $128, $360", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $111, $381 := $116, $382 := $115, $383 := $114, $384 := $113, $385 := $112", "$100 := MIN($114)", "$101 := MAX($114)", "$102 := SHARD_AVG($114)", "$103 := MIN($113)", "$104 := MAX($113)", "$105 := SHARD_AVG($113)", "$106 := COUNT_STAR()", "$107 := MIN($112)", "$108 := MAX($112)", "$109 := SHARD_AVG($112)" ] }, { "kind": "FILTER", "substeps": [ "or(greater($117, 0), greater(if(is_null($118), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)", "$113 := ANY_VALUE($123)", "$114 := ANY_VALUE($124)", "$115 := ANY_VALUE($125)", "$116 := ANY_VALUE($126)", "$117 := ANY_VALUE($127)", "$118 := SUM($128)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "TO __stage14_output", "BY HASH($380, $381, $382, $383, $384, $385)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.000683526999316473, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.007518796992481203, "writeRatioMax": 0.007518796992481203 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.01161995898838004, "computeRatioMax": 0.01161995898838004, "endMs": "1665777331509", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "4873", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777331443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $108, $109, $380, $385, $384, $383, $382, $381", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$390 ASC, $391 ASC, $392 ASC, $393 ASC, $394 ASC, $395 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385", "$90 := MIN($100)", "$91 := MAX($101)", "$92 := ROOT_AVG($102)", "$93 := MIN($103)", "$94 := MAX($104)", "$95 := ROOT_AVG($105)", "$96 := SUM_OF_COUNTS($106)", "$97 := MIN($107)", "$98 := MAX($108)", "$99 := ROOT_AVG($109)" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001367053998632946, "waitRatioMax": 0.001367053998632946, "writeMsAvg": "49", "writeMsMax": "49", "writeRatioAvg": 0.03349282296650718, "writeRatioMax": 0.03349282296650718 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007518796992481203, "computeRatioMax": 0.007518796992481203, "endMs": "1665777331538", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "13000", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665777331476", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $408, $409, $410, $411, $412, $413, $414, $415", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$410 ASC, $415 ASC, $414 ASC, $413 ASC, $412 ASC, $411 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$420, $421, $422, $423, $424, $425, $426, $427, $428, $429, $430, $431, $432, $433, $434, $435", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000683526999316473, "waitRatioMax": 0.000683526999316473, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.016404647983595352, "writeRatioMax": 0.016404647983595352 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "647", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7851" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "2308", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "17802" } ], "totalBytesBilled": "156237824", "totalBytesProcessed": "156174392", "totalPartitionsProcessed": "0", "totalSlotMs": "17802", "transferredBytes": "0" }, "startTime": "1665777329283", "totalBytesProcessed": "156174392", "totalSlotMs": "17802" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
