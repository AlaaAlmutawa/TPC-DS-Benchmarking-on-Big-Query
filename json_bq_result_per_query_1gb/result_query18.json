{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7e635c7e_4698_4754_82af_6766ad5830a9" }, "priority": "INTERACTIVE", "query": "-- start query 18 in stream 0 using template query18.tpl\nselect i_item_id,\n ca_country,\n ca_state, \n ca_county,\n avg( cast(cs_quantity as decimal)) agg1,\n avg( cast(cs_list_price as decimal)) agg2,\n avg( cast(cs_coupon_amt as decimal)) agg3,\n avg( cast(cs_sales_price as decimal)) agg4,\n avg( cast(cs_net_profit as decimal)) agg5,\n avg( cast(c_birth_year as decimal)) agg6,\n avg( cast(cd1.cd_dep_count as decimal)) agg7\n from catalog_sales, customer_demographics cd1, \n customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n cs_item_sk = i_item_sk and\n cs_bill_cdemo_sk = cd1.cd_demo_sk and\n cs_bill_customer_sk = c_customer_sk and\n cd1.cd_gender = 'F' and \n cd1.cd_education_status = 'Unknown' and\n c_current_cdemo_sk = cd2.cd_demo_sk and\n c_current_addr_sk = ca_address_sk and\n c_birth_month in (1,6,8,9,12,2) and\n d_year = 1998 and\n ca_state in ('MS','IN','ND'\n ,'OK','NM','VA','MS')\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n ca_state, \n ca_county,\n\ti_item_id\nlimit 100\n ;\n\n-- end query 18 in stream 0 using template query18.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8W8uU88uQDA1id0zjvWiqw==", "id": "test-project-364309:europe-west1.query18_1665768256", "jobReference": { "jobId": "query18_1665768256", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query18_1665768256?location=europe-west1", "statistics": { "creationTime": "1665768256910", "endTime": "1665768259249", "finalExecutionDurationMs": "2127", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "215722014", "performanceInsights": { "avgPreviousExecutionMs": "1956" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "527", "computeMsMax": "527", "computeRatioAvg": 0.19198542805100183, "computeRatioMax": 0.19198542805100183, "endMs": "1665768257503", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.00546448087431694, "readRatioMax": 0.00546448087431694, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "17287200", "shuffleOutputBytesSpilled": "0", "slotMs": "555", "startMs": "1665768257077", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cd_demo_sk", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036429872495446266, "waitRatioMax": 0.00036429872495446266, "writeMsAvg": "61", "writeMsMax": "61", "writeRatioAvg": 0.022222222222222223, "writeRatioMax": 0.022222222222222223 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.00546448087431694, "computeRatioMax": 0.00546448087431694, "endMs": "1665768257145", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0018214936247723133, "readRatioMax": 0.0018214936247723133, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768257095", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036429872495446266, "waitRatioMax": 0.00036429872495446266, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.008014571948998178, "writeRatioMax": 0.008014571948998178 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.03570127504553734, "computeRatioMax": 0.03570127504553734, "endMs": "1665768257175", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0036429872495446266, "readRatioMax": 0.0036429872495446266, "recordsRead": "1920800", "recordsWritten": "137200", "shuffleOutputBytes": "2469600", "shuffleOutputBytesSpilled": "0", "slotMs": "94", "startMs": "1665768257111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status", "FROM customer_demographics", "WHERE and(equal($21, 'F'), equal($22, 'Unknown'))" ] }, { "kind": "WRITE", "substeps": [ "$20, $23", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036429872495446266, "waitRatioMax": 0.00036429872495446266, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.003278688524590164, "writeRatioMax": 0.003278688524590164 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.00546448087431694, "computeRatioMax": 0.00546448087431694, "endMs": "1665768257160", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0025500910746812386, "readRatioMax": 0.0025500910746812386, "recordsRead": "50000", "recordsWritten": "7317", "shuffleOutputBytes": "384809", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768257129", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country", "FROM customer_address", "WHERE in($32, 'MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036429872495446266, "waitRatioMax": 0.00036429872495446266, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.005100182149362477, "writeRatioMax": 0.005100182149362477 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0025500910746812386, "computeRatioMax": 0.0025500910746812386, "endMs": "1665768257178", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002185792349726776, "readRatioMax": 0.002185792349726776, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768257149", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.006193078324225865, "writeRatioMax": 0.006193078324225865 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.014571948998178506, "computeRatioMax": 0.014571948998178506, "endMs": "1665768257213", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.007285974499089253, "readRatioMax": 0.007285974499089253, "recordsRead": "100000", "recordsWritten": "47714", "shuffleOutputBytes": "1703984", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665768257160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month", "FROM customer", "WHERE in($63, 1, 6, 8, 9, 12, 2)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $64", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036429872495446266, "waitRatioMax": 0.00036429872495446266, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0036429872495446266, "writeRatioMax": 0.0036429872495446266 }, { "completedParallelInputs": "5", "computeMsAvg": "2069", "computeMsMax": "2745", "computeRatioAvg": 0.7537340619307833, "computeRatioMax": 1, "endMs": "1665768259001", "id": "8", "inputStages": [ "3", "0", "5", "2", "4", "1" ], "name": "S08: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "35", "readRatioAvg": 0.00947176684881603, "readRatioMax": 0.012750455373406194, "recordsRead": "12098528", "recordsWritten": "5228", "shuffleOutputBytes": "777184", "shuffleOutputBytesSpilled": "0", "slotMs": "7897", "startMs": "1665768257508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $64", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $23", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $93, $251 := $94, $252 := $95, $253 := $96, $254 := $110", "$80 := SHARD_AVG($90)", "$81 := SHARD_AVG($236)", "$82 := SHARD_AVG($238)", "$83 := SHARD_AVG($237)", "$84 := SHARD_AVG($239)", "$85 := SHARD_AVG($91)", "$86 := SHARD_AVG($92)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := CAST($235 AS NUMERIC)", "$91 := CAST($240 AS NUMERIC)", "$92 := CAST($231 AS NUMERIC)", "$93 := if(equal(bitwise_and($120, 1), 0), NULL, $230)", "$94 := if(equal(bitwise_and($120, 2), 0), NULL, $234)", "$95 := if(equal(bitwise_and($120, 4), 0), NULL, $233)", "$96 := if(equal(bitwise_and($120, 8), 0), NULL, $232)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $210, $232 := $211, $233 := $212, $234 := $213, $235 := $214, $236 := $215, $237 := $216, $238 := $217, $239 := $218, $240 := $220", "INNER HASH JOIN EACH WITH ALL ON $219 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $190, $212 := $191, $213 := $192, $214 := $194, $215 := $195, $216 := $196, $217 := $197, $218 := $198, $219 := $199, $220 := $200, $221 := $11", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $180, $192 := $181, $193 := $171, $194 := $172, $195 := $173, $196 := $174, $197 := $175, $198 := $176, $199 := $177, $200 := $178, $201 := $23", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $155, $176 := $156, $177 := $157, $178 := $159, $179 := $31, $180 := $32, $181 := $33", "INNER HASH JOIN EACH WITH ALL ON $158 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $140", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $40, $131 := $42, $132 := $43, $133 := $44, $134 := $45, $135 := $46, $136 := $47, $137 := $48, $138 := $61, $139 := $62, $140 := $64", "INNER HASH JOIN EACH WITH ALL ON $41 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := subtract($121, 1)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "TO __stage08_output", "BY HASH($250, $251, $252, $253, $254)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036429872495446266, "waitRatioMax": 0.00036429872495446266, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0018214936247723133, "writeRatioMax": 0.0018214936247723133 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.007650273224043716, "computeRatioMax": 0.007650273224043716, "endMs": "1665768259108", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5228", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665768259090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$261 ASC, $262 ASC, $263 ASC, $260 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $253, $264 := $254", "$70 := ROOT_AVG($80)", "$71 := ROOT_AVG($81)", "$72 := ROOT_AVG($82)", "$73 := ROOT_AVG($83)", "$74 := ROOT_AVG($84)", "$75 := ROOT_AVG($85)", "$76 := ROOT_AVG($86)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036429872495446266, "waitRatioMax": 0.00036429872495446266, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00036429872495446266, "writeRatioMax": 0.00036429872495446266 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0029143897996357013, "computeRatioMax": 0.0029143897996357013, "endMs": "1665768259162", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665768259104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$278 ASC, $279 ASC, $280 ASC, $277 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $300", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00036429872495446266, "waitRatioMax": 0.00036429872495446266, "writeMsAvg": "50", "writeMsMax": "50", "writeRatioAvg": 0.018214936247723135, "writeRatioMax": 0.018214936247723135 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "6", "elapsedMs": "621", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "1490" }, { "activeUnits": "6", "completedUnits": "13", "elapsedMs": "2240", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9473" } ], "totalBytesBilled": "216006656", "totalBytesProcessed": "215722014", "totalPartitionsProcessed": "0", "totalSlotMs": "9473", "transferredBytes": "0" }, "startTime": "1665768256958", "totalBytesProcessed": "215722014", "totalSlotMs": "9473" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona628c875_f56d_4e09_8b62_e4ce921c7700" }, "priority": "INTERACTIVE", "query": "-- start query 18 in stream 0 using template query18.tpl\nselect i_item_id,\n ca_country,\n ca_state, \n ca_county,\n avg( cast(cs_quantity as decimal)) agg1,\n avg( cast(cs_list_price as decimal)) agg2,\n avg( cast(cs_coupon_amt as decimal)) agg3,\n avg( cast(cs_sales_price as decimal)) agg4,\n avg( cast(cs_net_profit as decimal)) agg5,\n avg( cast(c_birth_year as decimal)) agg6,\n avg( cast(cd1.cd_dep_count as decimal)) agg7\n from catalog_sales, customer_demographics cd1, \n customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n cs_item_sk = i_item_sk and\n cs_bill_cdemo_sk = cd1.cd_demo_sk and\n cs_bill_customer_sk = c_customer_sk and\n cd1.cd_gender = 'F' and \n cd1.cd_education_status = 'Unknown' and\n c_current_cdemo_sk = cd2.cd_demo_sk and\n c_current_addr_sk = ca_address_sk and\n c_birth_month in (1,6,8,9,12,2) and\n d_year = 1998 and\n ca_state in ('MS','IN','ND'\n ,'OK','NM','VA','MS')\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n ca_state, \n ca_county,\n\ti_item_id\nlimit 100\n ;\n\n-- end query 18 in stream 0 using template query18.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ixGbj85f9Wdth1Uzc3CUUQ==", "id": "test-project-364309:europe-west1.query18_1665776961", "jobReference": { "jobId": "query18_1665776961", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query18_1665776961?location=europe-west1", "statistics": { "creationTime": "1665776962367", "endTime": "1665776964652", "finalExecutionDurationMs": "2065", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "215722014", "performanceInsights": { "avgPreviousExecutionMs": "1977" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "605", "computeMsMax": "605", "computeRatioAvg": 0.21992002908033442, "computeRatioMax": 0.21992002908033442, "endMs": "1665776963004", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.004725554343874954, "readRatioMax": 0.004725554343874954, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "17287200", "shuffleOutputBytesSpilled": "0", "slotMs": "561", "startMs": "1665776962543", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cd_demo_sk", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003635041802980734, "waitRatioMax": 0.0003635041802980734, "writeMsAvg": "85", "writeMsMax": "85", "writeRatioAvg": 0.030897855325336242, "writeRatioMax": 0.030897855325336242 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.010905125408942203, "computeRatioMax": 0.010905125408942203, "endMs": "1665776962606", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0036350418029807343, "readRatioMax": 0.0036350418029807343, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776962558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003635041802980734, "waitRatioMax": 0.0003635041802980734, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.007633587786259542, "writeRatioMax": 0.007633587786259542 }, { "completedParallelInputs": "1", "computeMsAvg": "106", "computeMsMax": "106", "computeRatioAvg": 0.03853144311159579, "computeRatioMax": 0.03853144311159579, "endMs": "1665776962653", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.004725554343874954, "readRatioMax": 0.004725554343874954, "recordsRead": "1920800", "recordsWritten": "137200", "shuffleOutputBytes": "2469600", "shuffleOutputBytesSpilled": "0", "slotMs": "105", "startMs": "1665776962572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status", "FROM customer_demographics", "WHERE and(equal($21, 'F'), equal($22, 'Unknown'))" ] }, { "kind": "WRITE", "substeps": [ "$20, $23", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003635041802980734, "waitRatioMax": 0.0003635041802980734, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.003998545983278807, "writeRatioMax": 0.003998545983278807 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0058160668847691745, "computeRatioMax": 0.0058160668847691745, "endMs": "1665776962614", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0029080334423845873, "readRatioMax": 0.0029080334423845873, "recordsRead": "50000", "recordsWritten": "7317", "shuffleOutputBytes": "384809", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776962586", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country", "FROM customer_address", "WHERE in($32, 'MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003635041802980734, "waitRatioMax": 0.0003635041802980734, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0029080334423845873, "writeRatioMax": 0.0029080334423845873 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0021810250817884407, "computeRatioMax": 0.0021810250817884407, "endMs": "1665776962632", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002544529262086514, "readRatioMax": 0.002544529262086514, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776962602", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003635041802980734, "waitRatioMax": 0.0003635041802980734, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0021810250817884407, "writeRatioMax": 0.0021810250817884407 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.013813158851326791, "computeRatioMax": 0.013813158851326791, "endMs": "1665776962659", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.003271537622682661, "readRatioMax": 0.003271537622682661, "recordsRead": "100000", "recordsWritten": "47714", "shuffleOutputBytes": "1703984", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776962618", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month", "FROM customer", "WHERE in($63, 1, 6, 8, 9, 12, 2)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $64", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007270083605961468, "waitRatioMax": 0.0007270083605961468, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.003271537622682661, "writeRatioMax": 0.003271537622682661 }, { "completedParallelInputs": "5", "computeMsAvg": "1967", "computeMsMax": "2751", "computeRatioAvg": 0.7150127226463104, "computeRatioMax": 1, "endMs": "1665776964502", "id": "8", "inputStages": [ "2", "5", "1", "0", "4", "3" ], "name": "S08: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "31", "readRatioAvg": 0.009451108687749909, "readRatioMax": 0.011268629589240277, "recordsRead": "12098528", "recordsWritten": "5228", "shuffleOutputBytes": "777184", "shuffleOutputBytesSpilled": "0", "slotMs": "8452", "startMs": "1665776963028", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $64", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $23", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $93, $251 := $94, $252 := $95, $253 := $96, $254 := $110", "$80 := SHARD_AVG($90)", "$81 := SHARD_AVG($236)", "$82 := SHARD_AVG($238)", "$83 := SHARD_AVG($237)", "$84 := SHARD_AVG($239)", "$85 := SHARD_AVG($91)", "$86 := SHARD_AVG($92)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := CAST($235 AS NUMERIC)", "$91 := CAST($240 AS NUMERIC)", "$92 := CAST($231 AS NUMERIC)", "$93 := if(equal(bitwise_and($120, 1), 0), NULL, $230)", "$94 := if(equal(bitwise_and($120, 2), 0), NULL, $234)", "$95 := if(equal(bitwise_and($120, 4), 0), NULL, $233)", "$96 := if(equal(bitwise_and($120, 8), 0), NULL, $232)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $210, $232 := $211, $233 := $212, $234 := $213, $235 := $214, $236 := $215, $237 := $216, $238 := $217, $239 := $218, $240 := $220", "INNER HASH JOIN EACH WITH ALL ON $219 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $190, $212 := $191, $213 := $192, $214 := $194, $215 := $195, $216 := $196, $217 := $197, $218 := $198, $219 := $199, $220 := $200, $221 := $11", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $180, $192 := $181, $193 := $171, $194 := $172, $195 := $173, $196 := $174, $197 := $175, $198 := $176, $199 := $177, $200 := $178, $201 := $23", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $155, $176 := $156, $177 := $157, $178 := $159, $179 := $31, $180 := $32, $181 := $33", "INNER HASH JOIN EACH WITH ALL ON $158 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $140", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $40, $131 := $42, $132 := $43, $133 := $44, $134 := $45, $135 := $46, $136 := $47, $137 := $48, $138 := $61, $139 := $62, $140 := $64", "INNER HASH JOIN EACH WITH ALL ON $41 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := subtract($121, 1)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "TO __stage08_output", "BY HASH($250, $251, $252, $253, $254)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003635041802980734, "waitRatioMax": 0.0003635041802980734, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.0018175209014903672, "writeRatioMax": 0.0021810250817884407 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0061795710650672485, "computeRatioMax": 0.0061795710650672485, "endMs": "1665776964533", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5228", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665776964516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$261 ASC, $262 ASC, $263 ASC, $260 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $253, $264 := $254", "$70 := ROOT_AVG($80)", "$71 := ROOT_AVG($81)", "$72 := ROOT_AVG($82)", "$73 := ROOT_AVG($83)", "$74 := ROOT_AVG($84)", "$75 := ROOT_AVG($85)", "$76 := ROOT_AVG($86)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003635041802980734, "waitRatioMax": 0.0003635041802980734, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.002544529262086514, "computeRatioMax": 0.002544529262086514, "endMs": "1665776964568", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776964533", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$278 ASC, $279 ASC, $280 ASC, $277 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $300", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003635041802980734, "waitRatioMax": 0.0003635041802980734, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0058160668847691745, "writeRatioMax": 0.0058160668847691745 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "6", "elapsedMs": "622", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "2628" }, { "activeUnits": "4", "completedUnits": "13", "elapsedMs": "2187", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11129" } ], "totalBytesBilled": "216006656", "totalBytesProcessed": "215722014", "totalPartitionsProcessed": "0", "totalSlotMs": "11129", "transferredBytes": "0" }, "startTime": "1665776962423", "totalBytesProcessed": "215722014", "totalSlotMs": "11129" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc1da57b6_b113_4db4_83a2_717f193c4131" }, "priority": "INTERACTIVE", "query": "-- start query 18 in stream 0 using template query18.tpl\nselect i_item_id,\n ca_country,\n ca_state, \n ca_county,\n avg( cast(cs_quantity as decimal)) agg1,\n avg( cast(cs_list_price as decimal)) agg2,\n avg( cast(cs_coupon_amt as decimal)) agg3,\n avg( cast(cs_sales_price as decimal)) agg4,\n avg( cast(cs_net_profit as decimal)) agg5,\n avg( cast(c_birth_year as decimal)) agg6,\n avg( cast(cd1.cd_dep_count as decimal)) agg7\n from catalog_sales, customer_demographics cd1, \n customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n cs_item_sk = i_item_sk and\n cs_bill_cdemo_sk = cd1.cd_demo_sk and\n cs_bill_customer_sk = c_customer_sk and\n cd1.cd_gender = 'F' and \n cd1.cd_education_status = 'Unknown' and\n c_current_cdemo_sk = cd2.cd_demo_sk and\n c_current_addr_sk = ca_address_sk and\n c_birth_month in (1,6,8,9,12,2) and\n d_year = 1998 and\n ca_state in ('MS','IN','ND'\n ,'OK','NM','VA','MS')\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n ca_state, \n ca_county,\n\ti_item_id\nlimit 100\n ;\n\n-- end query 18 in stream 0 using template query18.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "nUADlxHxEZbc1BA1S7sHOg==", "id": "test-project-364309:europe-west1.query18_1665776965", "jobReference": { "jobId": "query18_1665776965", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query18_1665776965?location=europe-west1", "statistics": { "creationTime": "1665776966367", "endTime": "1665776968732", "finalExecutionDurationMs": "2128", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "215722014", "performanceInsights": { "avgPreviousExecutionMs": "1987" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "578", "computeMsMax": "578", "computeRatioAvg": 0.23933747412008283, "computeRatioMax": 0.23933747412008283, "endMs": "1665776967035", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.004968944099378882, "readRatioMax": 0.004968944099378882, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "17287200", "shuffleOutputBytesSpilled": "0", "slotMs": "557", "startMs": "1665776966549", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cd_demo_sk", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "63", "writeMsMax": "63", "writeRatioAvg": 0.02608695652173913, "writeRatioMax": 0.02608695652173913 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.008695652173913044, "computeRatioMax": 0.008695652173913044, "endMs": "1665776966609", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002898550724637681, "readRatioMax": 0.002898550724637681, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776966563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.009523809523809525, "writeRatioMax": 0.009523809523809525 }, { "completedParallelInputs": "1", "computeMsAvg": "93", "computeMsMax": "93", "computeRatioAvg": 0.03850931677018633, "computeRatioMax": 0.03850931677018633, "endMs": "1665776966659", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.004554865424430642, "readRatioMax": 0.004554865424430642, "recordsRead": "1920800", "recordsWritten": "137200", "shuffleOutputBytes": "2469600", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665776966581", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status", "FROM customer_demographics", "WHERE and(equal($21, 'F'), equal($22, 'Unknown'))" ] }, { "kind": "WRITE", "substeps": [ "$20, $23", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.004554865424430642, "writeRatioMax": 0.004554865424430642 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.008695652173913044, "computeRatioMax": 0.008695652173913044, "endMs": "1665776966658", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002484472049689441, "readRatioMax": 0.002484472049689441, "recordsRead": "50000", "recordsWritten": "7317", "shuffleOutputBytes": "384809", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776966607", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country", "FROM customer_address", "WHERE in($32, 'MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.009523809523809525, "writeRatioMax": 0.009523809523809525 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.004140786749482402, "computeRatioMax": 0.004140786749482402, "endMs": "1665776966684", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.002898550724637681, "readRatioMax": 0.002898550724637681, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776966640", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.012008281573498964, "writeRatioMax": 0.012008281573498964 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.01780538302277433, "computeRatioMax": 0.01780538302277433, "endMs": "1665776966714", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0033126293995859213, "readRatioMax": 0.0033126293995859213, "recordsRead": "100000", "recordsWritten": "47714", "shuffleOutputBytes": "1703984", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776966667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month", "FROM customer", "WHERE in($63, 1, 6, 8, 9, 12, 2)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $64", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.004140786749482402, "writeRatioMax": 0.004140786749482402 }, { "completedParallelInputs": "5", "computeMsAvg": "2068", "computeMsMax": "2415", "computeRatioAvg": 0.8563146997929607, "computeRatioMax": 1, "endMs": "1665776968563", "id": "8", "inputStages": [ "3", "4", "5", "0", "1", "2" ], "name": "S08: Join+", "parallelInputs": "5", "readMsAvg": "29", "readMsMax": "33", "readRatioAvg": 0.012008281573498964, "readRatioMax": 0.013664596273291925, "recordsRead": "12098528", "recordsWritten": "5228", "shuffleOutputBytes": "777184", "shuffleOutputBytesSpilled": "0", "slotMs": "9732", "startMs": "1665776967056", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $64", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $23", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $93, $251 := $94, $252 := $95, $253 := $96, $254 := $110", "$80 := SHARD_AVG($90)", "$81 := SHARD_AVG($236)", "$82 := SHARD_AVG($238)", "$83 := SHARD_AVG($237)", "$84 := SHARD_AVG($239)", "$85 := SHARD_AVG($91)", "$86 := SHARD_AVG($92)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := CAST($235 AS NUMERIC)", "$91 := CAST($240 AS NUMERIC)", "$92 := CAST($231 AS NUMERIC)", "$93 := if(equal(bitwise_and($120, 1), 0), NULL, $230)", "$94 := if(equal(bitwise_and($120, 2), 0), NULL, $234)", "$95 := if(equal(bitwise_and($120, 4), 0), NULL, $233)", "$96 := if(equal(bitwise_and($120, 8), 0), NULL, $232)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $210, $232 := $211, $233 := $212, $234 := $213, $235 := $214, $236 := $215, $237 := $216, $238 := $217, $239 := $218, $240 := $220", "INNER HASH JOIN EACH WITH ALL ON $219 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $190, $212 := $191, $213 := $192, $214 := $194, $215 := $195, $216 := $196, $217 := $197, $218 := $198, $219 := $199, $220 := $200, $221 := $11", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $180, $192 := $181, $193 := $171, $194 := $172, $195 := $173, $196 := $174, $197 := $175, $198 := $176, $199 := $177, $200 := $178, $201 := $23", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $155, $176 := $156, $177 := $157, $178 := $159, $179 := $31, $180 := $32, $181 := $33", "INNER HASH JOIN EACH WITH ALL ON $158 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $140", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $40, $131 := $42, $132 := $43, $133 := $44, $134 := $45, $135 := $46, $136 := $47, $137 := $48, $138 := $61, $139 := $62, $140 := $64", "INNER HASH JOIN EACH WITH ALL ON $41 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := subtract($121, 1)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "TO __stage08_output", "BY HASH($250, $251, $252, $253, $254)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "6", "writeMsMax": "10", "writeRatioAvg": 0.002484472049689441, "writeRatioMax": 0.004140786749482402 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.012008281573498964, "computeRatioMax": 0.012008281573498964, "endMs": "1665776968596", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5228", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776968569", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$261 ASC, $262 ASC, $263 ASC, $260 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $253, $264 := $254", "$70 := ROOT_AVG($80)", "$71 := ROOT_AVG($81)", "$72 := ROOT_AVG($82)", "$73 := ROOT_AVG($83)", "$74 := ROOT_AVG($84)", "$75 := ROOT_AVG($85)", "$76 := ROOT_AVG($86)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00041407867494824016, "writeRatioMax": 0.00041407867494824016 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.004554865424430642, "computeRatioMax": 0.004554865424430642, "endMs": "1665776968650", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776968585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$278 ASC, $279 ASC, $280 ASC, $277 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $300", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00041407867494824016, "waitRatioMax": 0.00041407867494824016, "writeMsAvg": "55", "writeMsMax": "55", "writeRatioAvg": 0.022774327122153208, "writeRatioMax": 0.022774327122153208 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "6", "elapsedMs": "627", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "1150" }, { "activeUnits": "5", "completedUnits": "10", "elapsedMs": "2062", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "10779" }, { "activeUnits": "2", "completedUnits": "13", "elapsedMs": "2255", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10967" } ], "totalBytesBilled": "216006656", "totalBytesProcessed": "215722014", "totalPartitionsProcessed": "0", "totalSlotMs": "10967", "transferredBytes": "0" }, "startTime": "1665776966424", "totalBytesProcessed": "215722014", "totalSlotMs": "10967" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5589d544_0d3f_453b_96f8_5de2a6718773" }, "priority": "INTERACTIVE", "query": "-- start query 18 in stream 0 using template query18.tpl\nselect i_item_id,\n ca_country,\n ca_state, \n ca_county,\n avg( cast(cs_quantity as decimal)) agg1,\n avg( cast(cs_list_price as decimal)) agg2,\n avg( cast(cs_coupon_amt as decimal)) agg3,\n avg( cast(cs_sales_price as decimal)) agg4,\n avg( cast(cs_net_profit as decimal)) agg5,\n avg( cast(c_birth_year as decimal)) agg6,\n avg( cast(cd1.cd_dep_count as decimal)) agg7\n from catalog_sales, customer_demographics cd1, \n customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n cs_item_sk = i_item_sk and\n cs_bill_cdemo_sk = cd1.cd_demo_sk and\n cs_bill_customer_sk = c_customer_sk and\n cd1.cd_gender = 'F' and \n cd1.cd_education_status = 'Unknown' and\n c_current_cdemo_sk = cd2.cd_demo_sk and\n c_current_addr_sk = ca_address_sk and\n c_birth_month in (1,6,8,9,12,2) and\n d_year = 1998 and\n ca_state in ('MS','IN','ND'\n ,'OK','NM','VA','MS')\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n ca_state, \n ca_county,\n\ti_item_id\nlimit 100\n ;\n\n-- end query 18 in stream 0 using template query18.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "+AaIbc6lJHB7XVLFD05bqA==", "id": "test-project-364309:europe-west1.query18_1665776969", "jobReference": { "jobId": "query18_1665776969", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query18_1665776969?location=europe-west1", "statistics": { "creationTime": "1665776970402", "endTime": "1665776972706", "finalExecutionDurationMs": "2038", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "215722014", "performanceInsights": { "avgPreviousExecutionMs": "2001" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "453", "computeMsMax": "453", "computeRatioAvg": 0.17185128983308043, "computeRatioMax": 0.17185128983308043, "endMs": "1665776970995", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0034142640364188165, "readRatioMax": 0.0034142640364188165, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "17287200", "shuffleOutputBytesSpilled": "0", "slotMs": "448", "startMs": "1665776970597", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cd_demo_sk", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00037936267071320183, "waitRatioMax": 0.00037936267071320183, "writeMsAvg": "59", "writeMsMax": "59", "writeRatioAvg": 0.022382397572078907, "writeRatioMax": 0.022382397572078907 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.004931714719271623, "computeRatioMax": 0.004931714719271623, "endMs": "1665776970650", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0018968133535660092, "readRatioMax": 0.0018968133535660092, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776970610", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00037936267071320183, "waitRatioMax": 0.00037936267071320183, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.009104704097116844, "writeRatioMax": 0.009104704097116844 }, { "completedParallelInputs": "1", "computeMsAvg": "87", "computeMsMax": "87", "computeRatioAvg": 0.033004552352048556, "computeRatioMax": 0.033004552352048556, "endMs": "1665776970691", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0037936267071320183, "readRatioMax": 0.0037936267071320183, "recordsRead": "1920800", "recordsWritten": "137200", "shuffleOutputBytes": "2469600", "shuffleOutputBytesSpilled": "0", "slotMs": "83", "startMs": "1665776970623", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status", "FROM customer_demographics", "WHERE and(equal($21, 'F'), equal($22, 'Unknown'))" ] }, { "kind": "WRITE", "substeps": [ "$20, $23", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00037936267071320183, "waitRatioMax": 0.00037936267071320183, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0034142640364188165, "writeRatioMax": 0.0034142640364188165 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.007966616084977238, "computeRatioMax": 0.007966616084977238, "endMs": "1665776970671", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.004552352048558422, "readRatioMax": 0.004552352048558422, "recordsRead": "50000", "recordsWritten": "7317", "shuffleOutputBytes": "384809", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776970637", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country", "FROM customer_address", "WHERE in($32, 'MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00037936267071320183, "waitRatioMax": 0.00037936267071320183, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0030349013657056147, "writeRatioMax": 0.0030349013657056147 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.002655538694992413, "computeRatioMax": 0.002655538694992413, "endMs": "1665776970678", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.002276176024279211, "readRatioMax": 0.002276176024279211, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776970651", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.005690440060698027, "writeRatioMax": 0.005690440060698027 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.014415781487101669, "computeRatioMax": 0.014415781487101669, "endMs": "1665776970710", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0037936267071320183, "readRatioMax": 0.0037936267071320183, "recordsRead": "100000", "recordsWritten": "47714", "shuffleOutputBytes": "1703984", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776970667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month", "FROM customer", "WHERE in($63, 1, 6, 8, 9, 12, 2)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $64", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00037936267071320183, "waitRatioMax": 0.00037936267071320183, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0037936267071320183, "writeRatioMax": 0.0037936267071320183 }, { "completedParallelInputs": "5", "computeMsAvg": "2288", "computeMsMax": "2636", "computeRatioAvg": 0.8679817905918058, "computeRatioMax": 1, "endMs": "1665776972537", "id": "8", "inputStages": [ "4", "2", "0", "1", "5", "3" ], "name": "S08: Join+", "parallelInputs": "5", "readMsAvg": "32", "readMsMax": "50", "readRatioAvg": 0.012139605462822459, "readRatioMax": 0.01896813353566009, "recordsRead": "12098528", "recordsWritten": "5228", "shuffleOutputBytes": "777184", "shuffleOutputBytesSpilled": "0", "slotMs": "9182", "startMs": "1665776971039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $64", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $23", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $93, $251 := $94, $252 := $95, $253 := $96, $254 := $110", "$80 := SHARD_AVG($90)", "$81 := SHARD_AVG($236)", "$82 := SHARD_AVG($238)", "$83 := SHARD_AVG($237)", "$84 := SHARD_AVG($239)", "$85 := SHARD_AVG($91)", "$86 := SHARD_AVG($92)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := CAST($235 AS NUMERIC)", "$91 := CAST($240 AS NUMERIC)", "$92 := CAST($231 AS NUMERIC)", "$93 := if(equal(bitwise_and($120, 1), 0), NULL, $230)", "$94 := if(equal(bitwise_and($120, 2), 0), NULL, $234)", "$95 := if(equal(bitwise_and($120, 4), 0), NULL, $233)", "$96 := if(equal(bitwise_and($120, 8), 0), NULL, $232)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $210, $232 := $211, $233 := $212, $234 := $213, $235 := $214, $236 := $215, $237 := $216, $238 := $217, $239 := $218, $240 := $220", "INNER HASH JOIN EACH WITH ALL ON $219 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $190, $212 := $191, $213 := $192, $214 := $194, $215 := $195, $216 := $196, $217 := $197, $218 := $198, $219 := $199, $220 := $200, $221 := $11", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $180, $192 := $181, $193 := $171, $194 := $172, $195 := $173, $196 := $174, $197 := $175, $198 := $176, $199 := $177, $200 := $178, $201 := $23", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $155, $176 := $156, $177 := $157, $178 := $159, $179 := $31, $180 := $32, $181 := $33", "INNER HASH JOIN EACH WITH ALL ON $158 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $140", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $40, $131 := $42, $132 := $43, $133 := $44, $134 := $45, $135 := $46, $136 := $47, $137 := $48, $138 := $61, $139 := $62, $140 := $64", "INNER HASH JOIN EACH WITH ALL ON $41 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := subtract($121, 1)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "TO __stage08_output", "BY HASH($250, $251, $252, $253, $254)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0007587253414264037, "waitRatioMax": 0.0007587253414264037, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.0015174506828528073, "writeRatioMax": 0.0018968133535660092 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.006069802731411229, "computeRatioMax": 0.006069802731411229, "endMs": "1665776972572", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5228", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665776972556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$261 ASC, $262 ASC, $263 ASC, $260 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $253, $264 := $254", "$70 := ROOT_AVG($80)", "$71 := ROOT_AVG($81)", "$72 := ROOT_AVG($82)", "$73 := ROOT_AVG($83)", "$74 := ROOT_AVG($84)", "$75 := ROOT_AVG($85)", "$76 := ROOT_AVG($86)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00037936267071320183, "waitRatioMax": 0.00037936267071320183, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00037936267071320183, "writeRatioMax": 0.00037936267071320183 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.005311077389984826, "computeRatioMax": 0.005311077389984826, "endMs": "1665776972611", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776972575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$278 ASC, $279 ASC, $280 ASC, $277 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $300", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00037936267071320183, "waitRatioMax": 0.00037936267071320183, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.009863429438543247, "writeRatioMax": 0.009863429438543247 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "6", "elapsedMs": "629", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "1655" }, { "activeUnits": "4", "completedUnits": "13", "elapsedMs": "2169", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10894" } ], "totalBytesBilled": "216006656", "totalBytesProcessed": "215722014", "totalPartitionsProcessed": "0", "totalSlotMs": "10894", "transferredBytes": "0" }, "startTime": "1665776970470", "totalBytesProcessed": "215722014", "totalSlotMs": "10894" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7703a390_d3de_43e7_a432_0fd1233571af" }, "priority": "INTERACTIVE", "query": "-- start query 18 in stream 0 using template query18.tpl\nselect i_item_id,\n ca_country,\n ca_state, \n ca_county,\n avg( cast(cs_quantity as decimal)) agg1,\n avg( cast(cs_list_price as decimal)) agg2,\n avg( cast(cs_coupon_amt as decimal)) agg3,\n avg( cast(cs_sales_price as decimal)) agg4,\n avg( cast(cs_net_profit as decimal)) agg5,\n avg( cast(c_birth_year as decimal)) agg6,\n avg( cast(cd1.cd_dep_count as decimal)) agg7\n from catalog_sales, customer_demographics cd1, \n customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n cs_item_sk = i_item_sk and\n cs_bill_cdemo_sk = cd1.cd_demo_sk and\n cs_bill_customer_sk = c_customer_sk and\n cd1.cd_gender = 'F' and \n cd1.cd_education_status = 'Unknown' and\n c_current_cdemo_sk = cd2.cd_demo_sk and\n c_current_addr_sk = ca_address_sk and\n c_birth_month in (1,6,8,9,12,2) and\n d_year = 1998 and\n ca_state in ('MS','IN','ND'\n ,'OK','NM','VA','MS')\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n ca_state, \n ca_county,\n\ti_item_id\nlimit 100\n ;\n\n-- end query 18 in stream 0 using template query18.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "GiVH72B8O45PCaB9J5kBNg==", "id": "test-project-364309:europe-west1.query18_1665776973", "jobReference": { "jobId": "query18_1665776973", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query18_1665776973?location=europe-west1", "statistics": { "creationTime": "1665776974398", "endTime": "1665776976585", "finalExecutionDurationMs": "1932", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "215722014", "performanceInsights": { "avgPreviousExecutionMs": "2004" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "807", "computeMsMax": "807", "computeRatioAvg": 0.3265884257385674, "computeRatioMax": 0.3265884257385674, "endMs": "1665776974991", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.004451639012545528, "readRatioMax": 0.004451639012545528, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "17287200", "shuffleOutputBytesSpilled": "0", "slotMs": "658", "startMs": "1665776974600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cd_demo_sk", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004046944556859571, "waitRatioMax": 0.0004046944556859571, "writeMsAvg": "66", "writeMsMax": "66", "writeRatioAvg": 0.026709834075273168, "writeRatioMax": 0.026709834075273168 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.010522055847834885, "computeRatioMax": 0.010522055847834885, "endMs": "1665776974662", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0020234722784297854, "readRatioMax": 0.0020234722784297854, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776974619", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004046944556859571, "waitRatioMax": 0.0004046944556859571, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.008903278025091057, "writeRatioMax": 0.008903278025091057 }, { "completedParallelInputs": "1", "computeMsAvg": "93", "computeMsMax": "93", "computeRatioAvg": 0.03763658437879401, "computeRatioMax": 0.03763658437879401, "endMs": "1665776974705", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.004046944556859571, "readRatioMax": 0.004046944556859571, "recordsRead": "1920800", "recordsWritten": "137200", "shuffleOutputBytes": "2469600", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665776974639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status", "FROM customer_demographics", "WHERE and(equal($21, 'F'), equal($22, 'Unknown'))" ] }, { "kind": "WRITE", "substeps": [ "$20, $23", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004046944556859571, "waitRatioMax": 0.0004046944556859571, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.003237555645487657, "writeRatioMax": 0.003237555645487657 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.006879805746661271, "computeRatioMax": 0.006879805746661271, "endMs": "1665776974697", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.003237555645487657, "readRatioMax": 0.003237555645487657, "recordsRead": "50000", "recordsWritten": "7317", "shuffleOutputBytes": "384809", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776974656", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country", "FROM customer_address", "WHERE in($32, 'MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0004046944556859571, "waitRatioMax": 0.0004046944556859571, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0028328611898017, "writeRatioMax": 0.0028328611898017 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.005261027923917442, "computeRatioMax": 0.005261027923917442, "endMs": "1665776974737", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0028328611898017, "readRatioMax": 0.0028328611898017, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776974697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "25", "waitMsMax": "25", "waitRatioAvg": 0.010117361392148928, "waitRatioMax": 0.010117361392148928, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.006070416835289356, "writeRatioMax": 0.006070416835289356 }, { "completedParallelInputs": "1", "computeMsAvg": "49", "computeMsMax": "49", "computeRatioAvg": 0.019830028328611898, "computeRatioMax": 0.019830028328611898, "endMs": "1665776974740", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.003237555645487657, "readRatioMax": 0.003237555645487657, "recordsRead": "100000", "recordsWritten": "47714", "shuffleOutputBytes": "1703984", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776974697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month", "FROM customer", "WHERE in($63, 1, 6, 8, 9, 12, 2)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $64", "TO __stage05_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.003642250101173614, "waitRatioMax": 0.003642250101173614, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.003642250101173614, "writeRatioMax": 0.003642250101173614 }, { "completedParallelInputs": "5", "computeMsAvg": "2094", "computeMsMax": "2471", "computeRatioAvg": 0.8474301902063942, "computeRatioMax": 1, "endMs": "1665776976401", "id": "8", "inputStages": [ "4", "1", "0", "5", "3", "2" ], "name": "S08: Join+", "parallelInputs": "5", "readMsAvg": "30", "readMsMax": "33", "readRatioAvg": 0.012140833670578713, "readRatioMax": 0.013354917037636584, "recordsRead": "12098528", "recordsWritten": "5228", "shuffleOutputBytes": "777184", "shuffleOutputBytesSpilled": "0", "slotMs": "9177", "startMs": "1665776975019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $64", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $23", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $93, $251 := $94, $252 := $95, $253 := $96, $254 := $110", "$80 := SHARD_AVG($90)", "$81 := SHARD_AVG($236)", "$82 := SHARD_AVG($238)", "$83 := SHARD_AVG($237)", "$84 := SHARD_AVG($239)", "$85 := SHARD_AVG($91)", "$86 := SHARD_AVG($92)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := CAST($235 AS NUMERIC)", "$91 := CAST($240 AS NUMERIC)", "$92 := CAST($231 AS NUMERIC)", "$93 := if(equal(bitwise_and($120, 1), 0), NULL, $230)", "$94 := if(equal(bitwise_and($120, 2), 0), NULL, $234)", "$95 := if(equal(bitwise_and($120, 4), 0), NULL, $233)", "$96 := if(equal(bitwise_and($120, 8), 0), NULL, $232)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $210, $232 := $211, $233 := $212, $234 := $213, $235 := $214, $236 := $215, $237 := $216, $238 := $217, $239 := $218, $240 := $220", "INNER HASH JOIN EACH WITH ALL ON $219 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $190, $212 := $191, $213 := $192, $214 := $194, $215 := $195, $216 := $196, $217 := $197, $218 := $198, $219 := $199, $220 := $200, $221 := $11", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $180, $192 := $181, $193 := $171, $194 := $172, $195 := $173, $196 := $174, $197 := $175, $198 := $176, $199 := $177, $200 := $178, $201 := $23", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $155, $176 := $156, $177 := $157, $178 := $159, $179 := $31, $180 := $32, $181 := $33", "INNER HASH JOIN EACH WITH ALL ON $158 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $140", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $40, $131 := $42, $132 := $43, $133 := $44, $134 := $45, $135 := $46, $136 := $47, $137 := $48, $138 := $61, $139 := $62, $140 := $64", "INNER HASH JOIN EACH WITH ALL ON $41 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := subtract($121, 1)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "TO __stage08_output", "BY HASH($250, $251, $252, $253, $254)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008093889113719142, "waitRatioMax": 0.0008093889113719142, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.0020234722784297854, "writeRatioMax": 0.0024281667341157424 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0084985835694051, "computeRatioMax": 0.0084985835694051, "endMs": "1665776976448", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5228", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665776976427", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$261 ASC, $262 ASC, $263 ASC, $260 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $253, $264 := $254", "$70 := ROOT_AVG($80)", "$71 := ROOT_AVG($81)", "$72 := ROOT_AVG($82)", "$73 := ROOT_AVG($83)", "$74 := ROOT_AVG($84)", "$75 := ROOT_AVG($85)", "$76 := ROOT_AVG($86)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0012140833670578712, "waitRatioMax": 0.0012140833670578712, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0004046944556859571, "writeRatioMax": 0.0004046944556859571 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.004451639012545528, "computeRatioMax": 0.004451639012545528, "endMs": "1665776976484", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776976445", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$278 ASC, $279 ASC, $280 ASC, $277 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $300", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0008093889113719142, "waitRatioMax": 0.0008093889113719142, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.011736139214892756, "writeRatioMax": 0.011736139214892756 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "6", "elapsedMs": "647", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "1514" }, { "activeUnits": "4", "completedUnits": "13", "elapsedMs": "2076", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10636" } ], "totalBytesBilled": "216006656", "totalBytesProcessed": "215722014", "totalPartitionsProcessed": "0", "totalSlotMs": "10636", "transferredBytes": "0" }, "startTime": "1665776974455", "totalBytesProcessed": "215722014", "totalSlotMs": "10636" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon77c6e333_68c4_4888_8113_06f5fcb92db7" }, "priority": "INTERACTIVE", "query": "-- start query 18 in stream 0 using template query18.tpl\nselect i_item_id,\n ca_country,\n ca_state, \n ca_county,\n avg( cast(cs_quantity as decimal)) agg1,\n avg( cast(cs_list_price as decimal)) agg2,\n avg( cast(cs_coupon_amt as decimal)) agg3,\n avg( cast(cs_sales_price as decimal)) agg4,\n avg( cast(cs_net_profit as decimal)) agg5,\n avg( cast(c_birth_year as decimal)) agg6,\n avg( cast(cd1.cd_dep_count as decimal)) agg7\n from catalog_sales, customer_demographics cd1, \n customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n cs_item_sk = i_item_sk and\n cs_bill_cdemo_sk = cd1.cd_demo_sk and\n cs_bill_customer_sk = c_customer_sk and\n cd1.cd_gender = 'F' and \n cd1.cd_education_status = 'Unknown' and\n c_current_cdemo_sk = cd2.cd_demo_sk and\n c_current_addr_sk = ca_address_sk and\n c_birth_month in (1,6,8,9,12,2) and\n d_year = 1998 and\n ca_state in ('MS','IN','ND'\n ,'OK','NM','VA','MS')\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n ca_state, \n ca_county,\n\ti_item_id\nlimit 100\n ;\n\n-- end query 18 in stream 0 using template query18.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "RQhTdNNR8dTyV3WRx3VNJQ==", "id": "test-project-364309:europe-west1.query18_1665776977", "jobReference": { "jobId": "query18_1665776977", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query18_1665776977?location=europe-west1", "statistics": { "creationTime": "1665776978420", "endTime": "1665776980418", "finalExecutionDurationMs": "1750", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "215722014", "performanceInsights": { "avgPreviousExecutionMs": "1998" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "739", "computeMsMax": "739", "computeRatioAvg": 0.33560399636693916, "computeRatioMax": 0.33560399636693916, "endMs": "1665776979097", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.005449591280653951, "readRatioMax": 0.005449591280653951, "recordsRead": "1920800", "recordsWritten": "1920800", "shuffleOutputBytes": "17287200", "shuffleOutputBytesSpilled": "0", "slotMs": "619", "startMs": "1665776978617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cd_demo_sk", "FROM customer_demographics" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.00045413260672116256, "writeMsAvg": "72", "writeMsMax": "72", "writeRatioAvg": 0.0326975476839237, "writeRatioMax": 0.0326975476839237 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.009082652134423252, "computeRatioMax": 0.009082652134423252, "endMs": "1665776978678", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0036330608537693005, "readRatioMax": 0.0036330608537693005, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "540000", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776978632", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_item_id", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.00045413260672116256, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.011353315168029064, "writeRatioMax": 0.011353315168029064 }, { "completedParallelInputs": "1", "computeMsAvg": "122", "computeMsMax": "122", "computeRatioAvg": 0.055404178019981834, "computeRatioMax": 0.055404178019981834, "endMs": "1665776978724", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.005449591280653951, "readRatioMax": 0.005449591280653951, "recordsRead": "1920800", "recordsWritten": "137200", "shuffleOutputBytes": "2469600", "shuffleOutputBytesSpilled": "0", "slotMs": "83", "startMs": "1665776978647", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status", "FROM customer_demographics", "WHERE and(equal($21, 'F'), equal($22, 'Unknown'))" ] }, { "kind": "WRITE", "substeps": [ "$20, $23", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.00045413260672116256, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.004087193460490463, "writeRatioMax": 0.004087193460490463 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.006357856494096276, "computeRatioMax": 0.006357856494096276, "endMs": "1665776978692", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.004995458673932788, "readRatioMax": 0.004995458673932788, "recordsRead": "50000", "recordsWritten": "7317", "shuffleOutputBytes": "384809", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776978662", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country", "FROM customer_address", "WHERE in($32, 'MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.00045413260672116256, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.004087193460490463, "writeRatioMax": 0.004087193460490463 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.004995458673932788, "computeRatioMax": 0.004995458673932788, "endMs": "1665776978720", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0036330608537693005, "readRatioMax": 0.0036330608537693005, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "3285", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776978677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 1998)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.00045413260672116256, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.006357856494096276, "writeRatioMax": 0.006357856494096276 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.021798365122615803, "computeRatioMax": 0.021798365122615803, "endMs": "1665776978746", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.005449591280653951, "readRatioMax": 0.005449591280653951, "recordsRead": "100000", "recordsWritten": "47714", "shuffleOutputBytes": "1703984", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665776978691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month", "FROM customer", "WHERE in($63, 1, 6, 8, 9, 12, 2)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $64", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.00045413260672116256, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.005903723887375113, "writeRatioMax": 0.005903723887375113 }, { "completedParallelInputs": "5", "computeMsAvg": "1792", "computeMsMax": "2202", "computeRatioAvg": 0.8138056312443234, "computeRatioMax": 1, "endMs": "1665776980273", "id": "8", "inputStages": [ "5", "3", "0", "4", "2", "1" ], "name": "S08: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "33", "readRatioAvg": 0.011807447774750226, "readRatioMax": 0.014986376021798364, "recordsRead": "12098528", "recordsWritten": "5228", "shuffleOutputBytes": "777184", "shuffleOutputBytesSpilled": "0", "slotMs": "7183", "startMs": "1665776979179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $64", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $23", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $93, $251 := $94, $252 := $95, $253 := $96, $254 := $110", "$80 := SHARD_AVG($90)", "$81 := SHARD_AVG($236)", "$82 := SHARD_AVG($238)", "$83 := SHARD_AVG($237)", "$84 := SHARD_AVG($239)", "$85 := SHARD_AVG($91)", "$86 := SHARD_AVG($92)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := CAST($235 AS NUMERIC)", "$91 := CAST($240 AS NUMERIC)", "$92 := CAST($231 AS NUMERIC)", "$93 := if(equal(bitwise_and($120, 1), 0), NULL, $230)", "$94 := if(equal(bitwise_and($120, 2), 0), NULL, $234)", "$95 := if(equal(bitwise_and($120, 4), 0), NULL, $233)", "$96 := if(equal(bitwise_and($120, 8), 0), NULL, $232)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$230 := $221, $231 := $210, $232 := $211, $233 := $212, $234 := $213, $235 := $214, $236 := $215, $237 := $216, $238 := $217, $239 := $218, $240 := $220", "INNER HASH JOIN EACH WITH ALL ON $219 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $190, $212 := $191, $213 := $192, $214 := $194, $215 := $195, $216 := $196, $217 := $197, $218 := $198, $219 := $199, $220 := $200, $221 := $11", "INNER HASH JOIN EACH WITH ALL ON $193 = $10" ] }, { "kind": "JOIN", "substeps": [ "$190 := $179, $191 := $180, $192 := $181, $193 := $171, $194 := $172, $195 := $173, $196 := $174, $197 := $175, $198 := $176, $199 := $177, $200 := $178, $201 := $23", "INNER HASH JOIN EACH WITH ALL ON $170 = $20" ] }, { "kind": "JOIN", "substeps": [ "$170 := $150, $171 := $151, $172 := $152, $173 := $153, $174 := $154, $175 := $155, $176 := $156, $177 := $157, $178 := $159, $179 := $31, $180 := $32, $181 := $33", "INNER HASH JOIN EACH WITH ALL ON $158 = $30" ] }, { "kind": "JOIN", "substeps": [ "$150 := $131, $151 := $132, $152 := $133, $153 := $134, $154 := $135, $155 := $136, $156 := $137, $157 := $138, $158 := $139, $159 := $140", "INNER HASH JOIN EACH WITH ALL ON $130 = $50" ] }, { "kind": "JOIN", "substeps": [ "$130 := $40, $131 := $42, $132 := $43, $133 := $44, $134 := $45, $135 := $46, $136 := $47, $137 := $48, $138 := $61, $139 := $62, $140 := $64", "INNER HASH JOIN EACH WITH ALL ON $41 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := subtract($121, 1)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "TO __stage08_output", "BY HASH($250, $251, $252, $253, $254)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.0009082652134423251, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.002270663033605813, "writeRatioMax": 0.0027247956403269754 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.01226158038147139, "computeRatioMax": 0.01226158038147139, "endMs": "1665776980304", "id": "9", "inputStages": [ "8" ], "name": "S09: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5228", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665776980279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82, $83, $84, $85, $86, $250, $251, $252, $253, $254", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$261 ASC, $262 ASC, $263 ASC, $260 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $253, $264 := $254", "$70 := ROOT_AVG($80)", "$71 := ROOT_AVG($81)", "$72 := ROOT_AVG($82)", "$73 := ROOT_AVG($83)", "$74 := ROOT_AVG($84)", "$75 := ROOT_AVG($85)", "$76 := ROOT_AVG($86)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.00045413260672116256, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00045413260672116256, "writeRatioMax": 0.00045413260672116256 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.004995458673932788, "computeRatioMax": 0.004995458673932788, "endMs": "1665776980330", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "14280", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776980293", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $278, $279, $280", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$278 ASC, $279 ASC, $280 ASC, $277 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296, $297, $298, $299, $300", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00045413260672116256, "waitRatioMax": 0.00045413260672116256, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.006357856494096276, "writeRatioMax": 0.006357856494096276 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "6", "completedUnits": "8", "elapsedMs": "639", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "2105" }, { "activeUnits": "5", "completedUnits": "13", "elapsedMs": "1891", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10195" } ], "totalBytesBilled": "216006656", "totalBytesProcessed": "215722014", "totalPartitionsProcessed": "0", "totalSlotMs": "10195", "transferredBytes": "0" }, "startTime": "1665776978479", "totalBytesProcessed": "215722014", "totalSlotMs": "10195" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
