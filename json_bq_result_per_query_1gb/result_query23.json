{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona6a6a2c4_26db_4ee6_88d3_39549000aea9" }, "priority": "INTERACTIVE", "query": "-- start query 23 in stream 0 using template query23.tpl\n\n/*\nThis query contains multiple, related iterations:\n\nFind frequently sold items that were sold more than 4 times on any day during four consecutive years through the store sales channel.\n Compute the maximum store sales made by any given customer in a period of four consecutive years (same as above).\n Compute the best store customers that are in the 5th percentile of sales.\n\nFinally, compute the total web and catalog sales in a particular month made by our best store customers buying our most frequent store items.\n*/\n\nwith frequent_ss_items as \n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk \n and d_year in (2000,2000+1,2000+2,2000+3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax \n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3) \n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from max_store_sales))\n select sum(sales)\n from (select cs_quantity*cs_list_price sales\n from catalog_sales\n ,date_dim \n where d_year = 2000 \n and d_moy = 2 \n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n union all\n select ws_quantity*ws_list_price sales\n from web_sales \n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \n order by sum(sales)\n limit 100\n ;\nwith frequent_ss_items as\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk\n and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax\n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3)\n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select\n *\n from max_store_sales))\n select c_last_name,c_first_name,sales\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\n from catalog_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and cs_bill_customer_sk = c_customer_sk \n group by c_last_name,c_first_name\n union all\n select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\n from web_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and ws_bill_customer_sk = c_customer_sk\n group by c_last_name,c_first_name) \n order by c_last_name,c_first_name,sales\n limit 100\n ;\n\n-- end query 23 in stream 0 using template query23.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "RQcbs38GUtK9n01B17t/Ag==", "id": "test-project-364309:europe-west1.query23_1665768277", "jobReference": { "jobId": "query23_1665768277", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query23_1665768277?location=europe-west1", "statistics": { "creationTime": "1665768278517", "endTime": "1665768287781", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "c_last_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "c_first_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "sales", "type": "NUMERIC" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "485490688", "totalBytesProcessed": "484776359", "totalSlotMs": "100388" }, "startTime": "1665768278569", "totalBytesProcessed": "484776359", "totalSlotMs": "100388" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf32d8fd2_6b45_43b6_bc7e_3a5fb27afbbb" }, "priority": "INTERACTIVE", "query": "-- start query 23 in stream 0 using template query23.tpl\n\n/*\nThis query contains multiple, related iterations:\n\nFind frequently sold items that were sold more than 4 times on any day during four consecutive years through the store sales channel.\n Compute the maximum store sales made by any given customer in a period of four consecutive years (same as above).\n Compute the best store customers that are in the 5th percentile of sales.\n\nFinally, compute the total web and catalog sales in a particular month made by our best store customers buying our most frequent store items.\n*/\n\nwith frequent_ss_items as \n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk \n and d_year in (2000,2000+1,2000+2,2000+3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax \n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3) \n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from max_store_sales))\n select sum(sales)\n from (select cs_quantity*cs_list_price sales\n from catalog_sales\n ,date_dim \n where d_year = 2000 \n and d_moy = 2 \n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n union all\n select ws_quantity*ws_list_price sales\n from web_sales \n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \n order by sum(sales)\n limit 100\n ;\nwith frequent_ss_items as\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk\n and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax\n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3)\n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select\n *\n from max_store_sales))\n select c_last_name,c_first_name,sales\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\n from catalog_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and cs_bill_customer_sk = c_customer_sk \n group by c_last_name,c_first_name\n union all\n select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\n from web_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and ws_bill_customer_sk = c_customer_sk\n group by c_last_name,c_first_name) \n order by c_last_name,c_first_name,sales\n limit 100\n ;\n\n-- end query 23 in stream 0 using template query23.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "BBp6hya4EV+/k0lvW3+8vA==", "id": "test-project-364309:europe-west1.query23_1665777077", "jobReference": { "jobId": "query23_1665777077", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query23_1665777077?location=europe-west1", "statistics": { "creationTime": "1665777078238", "endTime": "1665777086745", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "c_last_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "c_first_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "sales", "type": "NUMERIC" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "485490688", "totalBytesProcessed": "484776359", "totalSlotMs": "83014" }, "startTime": "1665777078289", "totalBytesProcessed": "484776359", "totalSlotMs": "83014" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona5d3c777_51d2_4395_8635_4de6f93cb487" }, "priority": "INTERACTIVE", "query": "-- start query 23 in stream 0 using template query23.tpl\n\n/*\nThis query contains multiple, related iterations:\n\nFind frequently sold items that were sold more than 4 times on any day during four consecutive years through the store sales channel.\n Compute the maximum store sales made by any given customer in a period of four consecutive years (same as above).\n Compute the best store customers that are in the 5th percentile of sales.\n\nFinally, compute the total web and catalog sales in a particular month made by our best store customers buying our most frequent store items.\n*/\n\nwith frequent_ss_items as \n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk \n and d_year in (2000,2000+1,2000+2,2000+3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax \n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3) \n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from max_store_sales))\n select sum(sales)\n from (select cs_quantity*cs_list_price sales\n from catalog_sales\n ,date_dim \n where d_year = 2000 \n and d_moy = 2 \n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n union all\n select ws_quantity*ws_list_price sales\n from web_sales \n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \n order by sum(sales)\n limit 100\n ;\nwith frequent_ss_items as\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk\n and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax\n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3)\n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select\n *\n from max_store_sales))\n select c_last_name,c_first_name,sales\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\n from catalog_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and cs_bill_customer_sk = c_customer_sk \n group by c_last_name,c_first_name\n union all\n select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\n from web_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and ws_bill_customer_sk = c_customer_sk\n group by c_last_name,c_first_name) \n order by c_last_name,c_first_name,sales\n limit 100\n ;\n\n-- end query 23 in stream 0 using template query23.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "wPlMnwr3pVqJmirpryxz6g==", "id": "test-project-364309:europe-west1.query23_1665777088", "jobReference": { "jobId": "query23_1665777088", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query23_1665777088?location=europe-west1", "statistics": { "creationTime": "1665777088996", "endTime": "1665777098585", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "c_last_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "c_first_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "sales", "type": "NUMERIC" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "485490688", "totalBytesProcessed": "484776359", "totalSlotMs": "86571" }, "startTime": "1665777089046", "totalBytesProcessed": "484776359", "totalSlotMs": "86571" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond823a78b_9a80_4642_9282_93d93332b3fb" }, "priority": "INTERACTIVE", "query": "-- start query 23 in stream 0 using template query23.tpl\n\n/*\nThis query contains multiple, related iterations:\n\nFind frequently sold items that were sold more than 4 times on any day during four consecutive years through the store sales channel.\n Compute the maximum store sales made by any given customer in a period of four consecutive years (same as above).\n Compute the best store customers that are in the 5th percentile of sales.\n\nFinally, compute the total web and catalog sales in a particular month made by our best store customers buying our most frequent store items.\n*/\n\nwith frequent_ss_items as \n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk \n and d_year in (2000,2000+1,2000+2,2000+3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax \n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3) \n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from max_store_sales))\n select sum(sales)\n from (select cs_quantity*cs_list_price sales\n from catalog_sales\n ,date_dim \n where d_year = 2000 \n and d_moy = 2 \n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n union all\n select ws_quantity*ws_list_price sales\n from web_sales \n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \n order by sum(sales)\n limit 100\n ;\nwith frequent_ss_items as\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk\n and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax\n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3)\n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select\n *\n from max_store_sales))\n select c_last_name,c_first_name,sales\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\n from catalog_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and cs_bill_customer_sk = c_customer_sk \n group by c_last_name,c_first_name\n union all\n select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\n from web_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and ws_bill_customer_sk = c_customer_sk\n group by c_last_name,c_first_name) \n order by c_last_name,c_first_name,sales\n limit 100\n ;\n\n-- end query 23 in stream 0 using template query23.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "cavVgJVOv2gqolBz+wjfcg==", "id": "test-project-364309:europe-west1.query23_1665777101", "jobReference": { "jobId": "query23_1665777101", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query23_1665777101?location=europe-west1", "statistics": { "creationTime": "1665777101807", "endTime": "1665777111713", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "c_last_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "c_first_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "sales", "type": "NUMERIC" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "485490688", "totalBytesProcessed": "484776359", "totalSlotMs": "87515" }, "startTime": "1665777101866", "totalBytesProcessed": "484776359", "totalSlotMs": "87515" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona399f4a0_9f40_4aec_9625_1802af8d273f" }, "priority": "INTERACTIVE", "query": "-- start query 23 in stream 0 using template query23.tpl\n\n/*\nThis query contains multiple, related iterations:\n\nFind frequently sold items that were sold more than 4 times on any day during four consecutive years through the store sales channel.\n Compute the maximum store sales made by any given customer in a period of four consecutive years (same as above).\n Compute the best store customers that are in the 5th percentile of sales.\n\nFinally, compute the total web and catalog sales in a particular month made by our best store customers buying our most frequent store items.\n*/\n\nwith frequent_ss_items as \n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk \n and d_year in (2000,2000+1,2000+2,2000+3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax \n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3) \n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from max_store_sales))\n select sum(sales)\n from (select cs_quantity*cs_list_price sales\n from catalog_sales\n ,date_dim \n where d_year = 2000 \n and d_moy = 2 \n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n union all\n select ws_quantity*ws_list_price sales\n from web_sales \n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \n order by sum(sales)\n limit 100\n ;\nwith frequent_ss_items as\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk\n and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax\n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3)\n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select\n *\n from max_store_sales))\n select c_last_name,c_first_name,sales\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\n from catalog_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and cs_bill_customer_sk = c_customer_sk \n group by c_last_name,c_first_name\n union all\n select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\n from web_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and ws_bill_customer_sk = c_customer_sk\n group by c_last_name,c_first_name) \n order by c_last_name,c_first_name,sales\n limit 100\n ;\n\n-- end query 23 in stream 0 using template query23.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "f7LCSUWPHfUo3bcbhzT9YA==", "id": "test-project-364309:europe-west1.query23_1665777114", "jobReference": { "jobId": "query23_1665777114", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query23_1665777114?location=europe-west1", "statistics": { "creationTime": "1665777114657", "endTime": "1665777123989", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "c_last_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "c_first_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "sales", "type": "NUMERIC" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "485490688", "totalBytesProcessed": "484776359", "totalSlotMs": "81268" }, "startTime": "1665777114705", "totalBytesProcessed": "484776359", "totalSlotMs": "81268" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc9ed328c_95cf_4d5d_9489_1b0e4a0c5f9e" }, "priority": "INTERACTIVE", "query": "-- start query 23 in stream 0 using template query23.tpl\n\n/*\nThis query contains multiple, related iterations:\n\nFind frequently sold items that were sold more than 4 times on any day during four consecutive years through the store sales channel.\n Compute the maximum store sales made by any given customer in a period of four consecutive years (same as above).\n Compute the best store customers that are in the 5th percentile of sales.\n\nFinally, compute the total web and catalog sales in a particular month made by our best store customers buying our most frequent store items.\n*/\n\nwith frequent_ss_items as \n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim \n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk \n and d_year in (2000,2000+1,2000+2,2000+3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax \n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3) \n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp from max_store_sales))\n select sum(sales)\n from (select cs_quantity*cs_list_price sales\n from catalog_sales\n ,date_dim \n where d_year = 2000 \n and d_moy = 2 \n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n union all\n select ws_quantity*ws_list_price sales\n from web_sales \n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) \n order by sum(sales)\n limit 100\n ;\nwith frequent_ss_items as\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n from store_sales\n ,date_dim\n ,item\n where ss_sold_date_sk = d_date_sk\n and ss_item_sk = i_item_sk\n and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)\n group by itemdesc,i_item_sk,d_date\n having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax\n from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n from store_sales\n ,customer\n ,date_dim \n where ss_customer_sk = c_customer_sk\n and ss_sold_date_sk = d_date_sk\n and d_year in (2000,2000+1,2000+2,2000+3)\n group by c_customer_sk)),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n from store_sales\n ,customer\n where ss_customer_sk = c_customer_sk\n group by c_customer_sk\n having sum(ss_quantity*ss_sales_price) > (50/100.0) benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp (select\n *\n from max_store_sales))\n select c_last_name,c_first_name,sales\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\n from catalog_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and cs_sold_date_sk = d_date_sk \n and cs_item_sk in (select item_sk from frequent_ss_items)\n and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and cs_bill_customer_sk = c_customer_sk \n group by c_last_name,c_first_name\n union all\n select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\n from web_sales\n ,customer\n ,date_dim \n where d_year = 2000 \n and d_moy = 2\n and ws_sold_date_sk = d_date_sk \n and ws_item_sk in (select item_sk from frequent_ss_items)\n and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n and ws_bill_customer_sk = c_customer_sk\n group by c_last_name,c_first_name) \n order by c_last_name,c_first_name,sales\n limit 100\n ;\n\n-- end query 23 in stream 0 using template query23.tpl", "useLegacySql": false, "useQueryCache": false } }, "etag": "25LS3WjrP1lSJKSsuW8yHQ==", "id": "test-project-364309:europe-west1.query23_1665777126", "jobReference": { "jobId": "query23_1665777126", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query23_1665777126?location=europe-west1", "statistics": { "creationTime": "1665777127499", "endTime": "1665777135895", "numChildJobs": "2", "query": { "schema": { "fields": [ { "mode": "NULLABLE", "name": "c_last_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "c_first_name", "type": "STRING" }, { "mode": "NULLABLE", "name": "sales", "type": "NUMERIC" } ] }, "statementType": "SCRIPT", "totalBytesBilled": "485490688", "totalBytesProcessed": "484776359", "totalSlotMs": "85256" }, "startTime": "1665777127554", "totalBytesProcessed": "484776359", "totalSlotMs": "85256" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
