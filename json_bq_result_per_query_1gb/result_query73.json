{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc7dae616_aeba_4a67_bee3_66b2e60c6785" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag \n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and case when household_demographics.hd_vehicle_count > 0 then \n household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Orange County','Bronx County','Franklin County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dj,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 1 and 5\n order by cnt desc, c_last_name asc;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "J5obGibtJB5ZasAJ4PyLgw==", "id": "test-project-364309:europe-west1.query73_1665768458", "jobReference": { "jobId": "query73_1665768458", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query73_1665768458?location=europe-west1", "statistics": { "creationTime": "1665768458803", "endTime": "1665768459440", "finalExecutionDurationMs": "421", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "468" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03763440860215054, "computeRatioMax": 0.03763440860215054, "endMs": "1665768459013", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.021505376344086023, "readRatioMax": 0.021505376344086023, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768458974", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.005376344086021506, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.08064516129032258, "writeRatioMax": 0.08064516129032258 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.043010752688172046, "computeRatioMax": 0.043010752688172046, "endMs": "1665768459027", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.021505376344086023, "readRatioMax": 0.021505376344086023, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768458986", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Orange County', 'Bronx County', 'Franklin County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.005376344086021506, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0913978494623656, "writeRatioMax": 0.0913978494623656 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06451612903225806, "computeRatioMax": 0.06451612903225806, "endMs": "1665768459030", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.04838709677419355, "readRatioMax": 0.04838709677419355, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768459001", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(between($42, 1, 2), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.005376344086021506, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05913978494623656, "writeRatioMax": 0.05913978494623656 }, { "completedParallelInputs": "6", "computeMsAvg": "132", "computeMsMax": "186", "computeRatioAvg": 0.7096774193548387, "computeRatioMax": 1, "endMs": "1665768459150", "id": "4", "inputStages": [ "2", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "17", "readRatioAvg": 0.06989247311827956, "readRatioMax": 0.0913978494623656, "recordsRead": "2887148", "recordsWritten": "7099", "shuffleOutputBytes": "190969", "shuffleOutputBytesSpilled": "0", "slotMs": "706", "startMs": "1665768459037", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.005376344086021506, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.021505376344086023, "writeRatioMax": 0.026881720430107527 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.043010752688172046, "computeRatioMax": 0.043010752688172046, "endMs": "1665768459221", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7099", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768459186", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 1, 5)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.005376344086021506, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.13978494623655913, "writeRatioMax": 0.13978494623655913 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.043010752688172046, "computeRatioMax": 0.08064516129032258, "endMs": "1665768459286", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "3513", "startMs": "1665768459225", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "22", "writeMsMax": "33", "writeRatioAvg": 0.11827956989247312, "writeRatioMax": 0.1774193548387097 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.16666666666666666, "computeRatioMax": 0.16666666666666666, "endMs": "1665768459320", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.06989247311827956, "readRatioMax": 0.06989247311827956, "recordsRead": "100005", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768459229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.021505376344086023, "writeRatioMax": 0.021505376344086023 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04838709677419355, "computeRatioMax": 0.04838709677419355, "endMs": "1665768459366", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768459327", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$121 DESC, $124 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005376344086021506, "waitRatioMax": 0.005376344086021506, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.06451612903225806 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "530", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4430" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "4430", "transferredBytes": "0" }, "startTime": "1665768458860", "totalBytesProcessed": "116189683", "totalSlotMs": "4430" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon31f13537_2fb0_4531_9dbf_a5ab58b52fed" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag \n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and case when household_demographics.hd_vehicle_count > 0 then \n household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Orange County','Bronx County','Franklin County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dj,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 1 and 5\n order by cnt desc, c_last_name asc;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "7DxvUw3BEdUPjl8UFObl4g==", "id": "test-project-364309:europe-west1.query73_1665778516", "jobReference": { "jobId": "query73_1665778516", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query73_1665778516?location=europe-west1", "statistics": { "creationTime": "1665778517301", "endTime": "1665778517992", "finalExecutionDurationMs": "442", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "463" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.04794520547945205, "computeRatioMax": 0.04794520547945205, "endMs": "1665778517518", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0273972602739726, "readRatioMax": 0.0273972602739726, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778517477", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.11643835616438356, "writeRatioMax": 0.11643835616438356 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0410958904109589, "computeRatioMax": 0.0410958904109589, "endMs": "1665778517527", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.02054794520547945, "readRatioMax": 0.02054794520547945, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778517493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Orange County', 'Bronx County', 'Franklin County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.10273972602739725, "writeRatioMax": 0.10273972602739725 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0821917808219178, "computeRatioMax": 0.0821917808219178, "endMs": "1665778517539", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0684931506849315, "readRatioMax": 0.0684931506849315, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778517509", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(between($42, 1, 2), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06164383561643835, "writeRatioMax": 0.06164383561643835 }, { "completedParallelInputs": "6", "computeMsAvg": "128", "computeMsMax": "146", "computeRatioAvg": 0.8767123287671232, "computeRatioMax": 1, "endMs": "1665778517670", "id": "4", "inputStages": [ "1", "2", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "20", "readRatioAvg": 0.0958904109589041, "readRatioMax": 0.136986301369863, "recordsRead": "2887148", "recordsWritten": "7099", "shuffleOutputBytes": "190969", "shuffleOutputBytesSpilled": "0", "slotMs": "809", "startMs": "1665778517548", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.03424657534246575, "writeRatioMax": 0.0410958904109589 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0684931506849315, "computeRatioMax": 0.0684931506849315, "endMs": "1665778517741", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7099", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778517703", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 1, 5)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0958904109589041, "writeRatioMax": 0.0958904109589041 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.04794520547945205, "computeRatioMax": 0.0821917808219178, "endMs": "1665778517805", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "2849", "startMs": "1665778517752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0136986301369863, "waitRatioMax": 0.02054794520547945, "writeMsAvg": "20", "writeMsMax": "30", "writeRatioAvg": 0.136986301369863, "writeRatioMax": 0.2054794520547945 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.21232876712328766, "computeRatioMax": 0.21232876712328766, "endMs": "1665778517841", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0684931506849315, "readRatioMax": 0.0684931506849315, "recordsRead": "100005", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778517758", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02054794520547945, "writeRatioMax": 0.02054794520547945 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.06164383561643835, "computeRatioMax": 0.06164383561643835, "endMs": "1665778517888", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778517852", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$121 DESC, $124 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00684931506849315, "waitRatioMax": 0.00684931506849315, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1095890410958904, "writeRatioMax": 0.1095890410958904 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "551", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3861" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "3861", "transferredBytes": "0" }, "startTime": "1665778517367", "totalBytesProcessed": "116189683", "totalSlotMs": "3861" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone7ad309b_3adb_46d0_bd5f_7c319aee08a5" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag \n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and case when household_demographics.hd_vehicle_count > 0 then \n household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Orange County','Bronx County','Franklin County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dj,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 1 and 5\n order by cnt desc, c_last_name asc;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "tiBWlITDTz25RA1qs8QAXQ==", "id": "test-project-364309:europe-west1.query73_1665778519", "jobReference": { "jobId": "query73_1665778519", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query73_1665778519?location=europe-west1", "statistics": { "creationTime": "1665778519717", "endTime": "1665778520432", "finalExecutionDurationMs": "502", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "462" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.08465608465608465, "computeRatioMax": 0.08465608465608465, "endMs": "1665778519913", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.037037037037037035, "readRatioMax": 0.037037037037037035, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778519873", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005291005291005291, "waitRatioMax": 0.005291005291005291, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.047619047619047616, "writeRatioMax": 0.047619047619047616 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.031746031746031744, "computeRatioMax": 0.031746031746031744, "endMs": "1665778519944", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.021164021164021163, "readRatioMax": 0.021164021164021163, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778519887", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Orange County', 'Bronx County', 'Franklin County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010582010582010581, "waitRatioMax": 0.010582010582010581, "writeMsAvg": "47", "writeMsMax": "47", "writeRatioAvg": 0.24867724867724866, "writeRatioMax": 0.24867724867724866 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.06878306878306878, "computeRatioMax": 0.06878306878306878, "endMs": "1665778519941", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.037037037037037035, "readRatioMax": 0.037037037037037035, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778519904", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(between($42, 1, 2), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005291005291005291, "waitRatioMax": 0.005291005291005291, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.037037037037037035, "writeRatioMax": 0.037037037037037035 }, { "completedParallelInputs": "6", "computeMsAvg": "157", "computeMsMax": "189", "computeRatioAvg": 0.8306878306878307, "computeRatioMax": 1, "endMs": "1665778520110", "id": "5", "inputStages": [ "2", "1", "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "20", "readRatioAvg": 0.07936507936507936, "readRatioMax": 0.10582010582010581, "recordsRead": "2887148", "recordsWritten": "7099", "shuffleOutputBytes": "190969", "shuffleOutputBytesSpilled": "0", "slotMs": "961", "startMs": "1665778519970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage05_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005291005291005291, "waitRatioMax": 0.005291005291005291, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.026455026455026454, "writeRatioMax": 0.042328042328042326 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.07407407407407407, "computeRatioMax": 0.07407407407407407, "endMs": "1665778520189", "id": "7", "inputStages": [ "5" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7099", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778520151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage05_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 1, 5)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010582010582010581, "waitRatioMax": 0.010582010582010581, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07936507936507936, "writeRatioMax": 0.07936507936507936 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.042328042328042326, "computeRatioMax": 0.08465608465608465, "endMs": "1665778520261", "id": "8", "inputStages": [ "7" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "3828", "startMs": "1665778520199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.010582010582010581, "waitRatioMax": 0.015873015873015872, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.07407407407407407, "writeRatioMax": 0.14814814814814814 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.23809523809523808, "computeRatioMax": 0.23809523809523808, "endMs": "1665778520301", "id": "9", "inputStages": [ "8" ], "name": "S09: Join", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.07936507936507936, "readRatioMax": 0.07936507936507936, "recordsRead": "100005", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665778520207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage08_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage09_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.026455026455026454, "waitRatioMax": 0.026455026455026454, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.031746031746031744, "writeRatioMax": 0.031746031746031744 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.031746031746031744, "computeRatioMax": 0.031746031746031744, "endMs": "1665778520348", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778520312", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$121 DESC, $124 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005291005291005291, "waitRatioMax": 0.005291005291005291, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.14814814814814814, "writeRatioMax": 0.14814814814814814 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5087" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "5087", "transferredBytes": "0" }, "startTime": "1665778519784", "totalBytesProcessed": "116189683", "totalSlotMs": "5087" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7fefb627_fccc_4813_8e46_3e8e451f19eb" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag \n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and case when household_demographics.hd_vehicle_count > 0 then \n household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Orange County','Bronx County','Franklin County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dj,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 1 and 5\n order by cnt desc, c_last_name asc;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "IV1aDHdhwcqiRFcjvGyZvQ==", "id": "test-project-364309:europe-west1.query73_1665778521", "jobReference": { "jobId": "query73_1665778521", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query73_1665778521?location=europe-west1", "statistics": { "creationTime": "1665778522141", "endTime": "1665778522798", "finalExecutionDurationMs": "475", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "465" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03571428571428571, "computeRatioMax": 0.03571428571428571, "endMs": "1665778522307", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.02040816326530612, "readRatioMax": 0.02040816326530612, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778522278", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.00510204081632653, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.09693877551020408, "writeRatioMax": 0.09693877551020408 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04081632653061224, "computeRatioMax": 0.04081632653061224, "endMs": "1665778522320", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.02040816326530612, "readRatioMax": 0.02040816326530612, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778522290", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Orange County', 'Bronx County', 'Franklin County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.00510204081632653, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05612244897959184, "computeRatioMax": 0.05612244897959184, "endMs": "1665778522343", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04081632653061224, "readRatioMax": 0.04081632653061224, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778522302", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(between($42, 1, 2), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.00510204081632653, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07653061224489796, "writeRatioMax": 0.07653061224489796 }, { "completedParallelInputs": "6", "computeMsAvg": "132", "computeMsMax": "196", "computeRatioAvg": 0.673469387755102, "computeRatioMax": 1, "endMs": "1665778522503", "id": "4", "inputStages": [ "1", "0", "2" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "24", "readRatioAvg": 0.08163265306122448, "readRatioMax": 0.12244897959183673, "recordsRead": "2887148", "recordsWritten": "7099", "shuffleOutputBytes": "190969", "shuffleOutputBytesSpilled": "0", "slotMs": "932", "startMs": "1665778522354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.00510204081632653, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.025510204081632654, "writeRatioMax": 0.04081632653061224 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.07653061224489796, "computeRatioMax": 0.07653061224489796, "endMs": "1665778522580", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7099", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778522544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 1, 5)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.00510204081632653, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.04081632653061224, "computeRatioMax": 0.09693877551020408, "endMs": "1665778522640", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "3643", "startMs": "1665778522594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.07653061224489796, "writeRatioMax": 0.09183673469387756 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.1683673469387755, "computeRatioMax": 0.1683673469387755, "endMs": "1665778522687", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.061224489795918366, "readRatioMax": 0.061224489795918366, "recordsRead": "100005", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778522598", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.00510204081632653, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.025510204081632654, "writeRatioMax": 0.025510204081632654 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04081632653061224, "computeRatioMax": 0.04081632653061224, "endMs": "1665778522731", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778522690", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$121 DESC, $124 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00510204081632653, "waitRatioMax": 0.00510204081632653, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.08673469387755102, "writeRatioMax": 0.08673469387755102 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "557", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4815" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "4815", "transferredBytes": "0" }, "startTime": "1665778522191", "totalBytesProcessed": "116189683", "totalSlotMs": "4815" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4ba52088_d9d7_4614_ba0b_8972341d625c" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag \n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and case when household_demographics.hd_vehicle_count > 0 then \n household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Orange County','Bronx County','Franklin County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dj,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 1 and 5\n order by cnt desc, c_last_name asc;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NLlelWN13t+3bJWLGgrFpA==", "id": "test-project-364309:europe-west1.query73_1665778523", "jobReference": { "jobId": "query73_1665778523", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query73_1665778523?location=europe-west1", "statistics": { "creationTime": "1665778524472", "endTime": "1665778525202", "finalExecutionDurationMs": "498", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "466" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03888888888888889, "computeRatioMax": 0.03888888888888889, "endMs": "1665778524703", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.027777777777777776, "readRatioMax": 0.027777777777777776, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778524657", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011111111111111112, "waitRatioMax": 0.011111111111111112, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.11666666666666667, "writeRatioMax": 0.11666666666666667 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.027777777777777776, "computeRatioMax": 0.027777777777777776, "endMs": "1665778524707", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.016666666666666666, "readRatioMax": 0.016666666666666666, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778524676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Orange County', 'Bronx County', 'Franklin County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.022222222222222223, "waitRatioMax": 0.022222222222222223, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.11666666666666667, "writeRatioMax": 0.11666666666666667 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06666666666666667, "computeRatioMax": 0.06666666666666667, "endMs": "1665778524720", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03333333333333333, "readRatioMax": 0.03333333333333333, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778524693", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(between($42, 1, 2), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005555555555555556, "waitRatioMax": 0.005555555555555556, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.07222222222222222, "writeRatioMax": 0.07222222222222222 }, { "completedParallelInputs": "6", "computeMsAvg": "137", "computeMsMax": "180", "computeRatioAvg": 0.7611111111111111, "computeRatioMax": 1, "endMs": "1665778524870", "id": "4", "inputStages": [ "2", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "19", "readRatioAvg": 0.07222222222222222, "readRatioMax": 0.10555555555555556, "recordsRead": "2887148", "recordsWritten": "7099", "shuffleOutputBytes": "190969", "shuffleOutputBytesSpilled": "0", "slotMs": "967", "startMs": "1665778524732", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005555555555555556, "waitRatioMax": 0.011111111111111112, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.027777777777777776, "writeRatioMax": 0.027777777777777776 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.044444444444444446, "computeRatioMax": 0.044444444444444446, "endMs": "1665778524950", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7099", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778524916", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 1, 5)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005555555555555556, "waitRatioMax": 0.005555555555555556, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.13333333333333333, "writeRatioMax": 0.13333333333333333 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.03888888888888889, "computeRatioMax": 0.07777777777777778, "endMs": "1665778525018", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "3234", "startMs": "1665778524965", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "5", "waitMsMax": "14", "waitRatioAvg": 0.027777777777777776, "waitRatioMax": 0.07777777777777778, "writeMsAvg": "7", "writeMsMax": "29", "writeRatioAvg": 0.03888888888888889, "writeRatioMax": 0.16111111111111112 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.16111111111111112, "computeRatioMax": 0.16111111111111112, "endMs": "1665778525055", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.06111111111111111, "readRatioMax": 0.06111111111111111, "recordsRead": "100005", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665778524989", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.044444444444444446, "waitRatioMax": 0.044444444444444446, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.011111111111111112, "writeRatioMax": 0.011111111111111112 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03333333333333333, "computeRatioMax": 0.03333333333333333, "endMs": "1665778525105", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778525066", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$121 DESC, $124 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011111111111111112, "waitRatioMax": 0.011111111111111112, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.08888888888888889, "writeRatioMax": 0.08888888888888889 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "112", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4462" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "4462", "transferredBytes": "0" }, "startTime": "1665778524528", "totalBytesProcessed": "116189683", "totalSlotMs": "4462" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone589377d_9b9b_4446_8f89_5a71bf7e3c54" }, "priority": "INTERACTIVE", "query": "select c_last_name\n ,c_first_name\n ,c_salutation\n ,c_preferred_cust_flag \n ,ss_ticket_number\n ,cnt from\n (select ss_ticket_number\n ,ss_customer_sk\n ,count(*) cnt\n from store_sales,date_dim,store,household_demographics\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_store_sk = store.s_store_sk \n and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n and date_dim.d_dom between 1 and 2 \n and (household_demographics.hd_buy_potential = '>10000' or\n household_demographics.hd_buy_potential = 'Unknown')\n and household_demographics.hd_vehicle_count > 0\n and case when household_demographics.hd_vehicle_count > 0 then \n household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n and date_dim.d_year in (1999,1999+1,1999+2)\n and store.s_county in ('Orange County','Bronx County','Franklin County','Williamson County')\n group by ss_ticket_number,ss_customer_sk) dj,customer\n where ss_customer_sk = c_customer_sk\n and cnt between 1 and 5\n order by cnt desc, c_last_name asc;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "x0rGfsBl39YRJsdvswkCZQ==", "id": "test-project-364309:europe-west1.query73_1665778526", "jobReference": { "jobId": "query73_1665778526", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query73_1665778526?location=europe-west1", "statistics": { "creationTime": "1665778527065", "endTime": "1665778527865", "finalExecutionDurationMs": "575", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "116189683", "performanceInsights": { "avgPreviousExecutionMs": "468" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.08024691358024691, "computeRatioMax": 0.08024691358024691, "endMs": "1665778527275", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.06172839506172839, "readRatioMax": 0.06172839506172839, "recordsRead": "7200", "recordsWritten": "1040", "shuffleOutputBytes": "9360", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778527239", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count", "FROM household_demographics", "WHERE and(or(equal($11, '>10000'), equal($11, 'Unknown')), greater($13, 0), ...)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006172839506172839, "waitRatioMax": 0.006172839506172839, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.043209876543209874, "writeRatioMax": 0.043209876543209874 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.05555555555555555, "endMs": "1665778527290", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.024691358024691357, "readRatioMax": 0.024691358024691357, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778527252", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:s_store_sk, $31:s_county", "FROM store", "WHERE in($31, 'Orange County', 'Bronx County', 'Franklin County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012345679012345678, "waitRatioMax": 0.012345679012345678, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08641975308641975, "writeRatioMax": 0.08641975308641975 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.08024691358024691, "computeRatioMax": 0.08024691358024691, "endMs": "1665778527304", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.037037037037037035, "readRatioMax": 0.037037037037037035, "recordsRead": "73049", "recordsWritten": "72", "shuffleOutputBytes": "648", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778527266", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:d_date_sk, $41:d_year, $42:d_dom", "FROM date_dim", "WHERE and(between($42, 1, 2), in($41, 1999, 2000, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006172839506172839, "waitRatioMax": 0.006172839506172839, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.08024691358024691, "writeRatioMax": 0.08024691358024691 }, { "completedParallelInputs": "6", "computeMsAvg": "136", "computeMsMax": "162", "computeRatioAvg": 0.8395061728395061, "computeRatioMax": 1, "endMs": "1665778527471", "id": "4", "inputStages": [ "0", "2", "1" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.08641975308641975, "readRatioMax": 0.10493827160493827, "recordsRead": "2887148", "recordsWritten": "7099", "shuffleOutputBytes": "190969", "shuffleOutputBytesSpilled": "0", "slotMs": "863", "startMs": "1665778527319", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $91, $101 := $90", "$60 := COUNT_STAR()" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $82", "INNER HASH JOIN EACH WITH ALL ON $81 = $10" ] }, { "kind": "JOIN", "substeps": [ "$80 := $70, $81 := $71, $82 := $73", "INNER HASH JOIN EACH WITH ALL ON $72 = $30" ] }, { "kind": "JOIN", "substeps": [ "$70 := $21, $71 := $22, $72 := $23, $73 := $24", "INNER HASH JOIN EACH WITH ALL ON $20 = $40" ] }, { "kind": "WRITE", "substeps": [ "$101, $100, $60", "TO __stage04_output", "BY HASH($100, $101)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.006172839506172839, "waitRatioMax": 0.012345679012345678, "writeMsAvg": "7", "writeMsMax": "15", "writeRatioAvg": 0.043209876543209874, "writeRatioMax": 0.09259259259259259 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.043209876543209874, "computeRatioMax": 0.043209876543209874, "endMs": "1665778527548", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7099", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778527512", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$101, $100, $60", "FROM __stage04_output" ] }, { "kind": "FILTER", "substeps": [ "between($50, 1, 5)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100, $111 := $101", "$50 := SUM_OF_COUNTS($60)" ] }, { "kind": "WRITE", "substeps": [ "$50, $110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006172839506172839, "waitRatioMax": 0.006172839506172839, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.1728395061728395, "writeRatioMax": 0.1728395061728395 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.09876543209876543, "endMs": "1665778527658", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "135", "shuffleOutputBytesSpilled": "0", "slotMs": "6464", "startMs": "1665778527564", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012345679012345678, "waitRatioMax": 0.018518518518518517, "writeMsAvg": "33", "writeMsMax": "69", "writeRatioAvg": 0.2037037037037037, "writeRatioMax": 0.42592592592592593 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.19135802469135801, "computeRatioMax": 0.19135802469135801, "endMs": "1665778527693", "id": "8", "inputStages": [ "7" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.06172839506172839, "readRatioMax": 0.06172839506172839, "recordsRead": "100005", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778527569", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$50, $110, $111", "FROM __stage07_output" ] }, { "kind": "JOIN", "substeps": [ "$122 := $2, $123 := $3, $124 := $4, $125 := $5, $120 := $110, $121 := $50", "INNER HASH JOIN EACH WITH ALL ON $1 = $111" ] }, { "kind": "WRITE", "substeps": [ "$122, $123, $124, $125, $120, $121", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.024691358024691357, "waitRatioMax": 0.024691358024691357, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.030864197530864196, "writeRatioMax": 0.030864197530864196 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05555555555555555, "computeRatioMax": 0.05555555555555555, "endMs": "1665778527772", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "266", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778527705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $123, $124, $125, $120, $121", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$121 DESC, $124 ASC" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006172839506172839, "waitRatioMax": 0.006172839506172839, "writeMsAvg": "58", "writeMsMax": "58", "writeRatioAvg": 0.35802469135802467, "writeRatioMax": 0.35802469135802467 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "household_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "111", "elapsedMs": "599", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7532" }, { "activeUnits": "1", "completedUnits": "112", "elapsedMs": "673", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7582" } ], "totalBytesBilled": "116391936", "totalBytesProcessed": "116189683", "totalPartitionsProcessed": "0", "totalSlotMs": "7582", "transferredBytes": "0" }, "startTime": "1665778527140", "totalBytesProcessed": "116189683", "totalSlotMs": "7582" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
