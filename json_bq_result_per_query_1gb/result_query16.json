{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonfe493547_be97_49e1_b2bf_066f6f400be9" }, "priority": "INTERACTIVE", "query": "select \n count(distinct cs_order_number) as order_count\n ,sum(cs_ext_ship_cost) as total_shipping_cost\n ,sum(cs_net_profit) as total_net_profit\nfrom\n catalog_sales cs1\n ,date_dim\n ,customer_address\n ,call_center\nwhere\n d_date between '2002-2-01' and \n (cast('2002-2-01' + 60 as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'GA'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County'\n)\nand exists (select *\n from catalog_sales cs2\n where cs1.cs_order_number = cs2.cs_order_number\n and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n from catalog_returns cr1\n where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "JRa8AQObj1sbhsOqWkUddA==", "id": "test-project-364309:europe-west1.query16_1665768249", "jobReference": { "jobId": "query16_1665768249", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query16_1665768249?location=europe-west1", "statistics": { "creationTime": "1665768250402", "endTime": "1665768251488", "finalExecutionDurationMs": "897", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "106362194", "performanceInsights": { "avgPreviousExecutionMs": "1014" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "88", "computeMsMax": "88", "computeRatioAvg": 0.10628019323671498, "computeRatioMax": 0.10628019323671498, "endMs": "1665768250633", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.013285024154589372, "readRatioMax": 0.013285024154589372, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "1296603", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665768250560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012077294685990338, "waitRatioMax": 0.0012077294685990338, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.020531400966183576, "writeRatioMax": 0.020531400966183576 }, { "completedParallelInputs": "5", "computeMsAvg": "145", "computeMsMax": "199", "computeRatioAvg": 0.1751207729468599, "computeRatioMax": 0.24033816425120774, "endMs": "1665768250763", "id": "1", "name": "S01: Input", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "18", "readRatioAvg": 0.013285024154589372, "readRatioMax": 0.021739130434782608, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "1010", "startMs": "1665768250578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_warehouse_sk, $11:cs_order_number", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012077294685990338, "waitRatioMax": 0.0012077294685990338, "writeMsAvg": "28", "writeMsMax": "43", "writeRatioAvg": 0.033816425120772944, "writeRatioMax": 0.051932367149758456 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.013285024154589372, "computeRatioMax": 0.013285024154589372, "endMs": "1665768250635", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.007246376811594203, "readRatioMax": 0.007246376811594203, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "54", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768250591", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cc_call_center_sk, $21:cc_county", "FROM call_center", "WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012077294685990338, "waitRatioMax": 0.0012077294685990338, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01932367149758454, "writeRatioMax": 0.01932367149758454 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.014492753623188406, "computeRatioMax": 0.014492753623188406, "endMs": "1665768250647", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.00966183574879227, "readRatioMax": 0.00966183574879227, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768250606", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012077294685990338, "waitRatioMax": 0.0012077294685990338, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.018115942028985508, "writeRatioMax": 0.018115942028985508 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.018115942028985508, "computeRatioMax": 0.018115942028985508, "endMs": "1665768250667", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.010869565217391304, "readRatioMax": 0.010869565217391304, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768250623", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 11719, 11779)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012077294685990338, "waitRatioMax": 0.0012077294685990338, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01570048309178744, "writeRatioMax": 0.01570048309178744 }, { "completedParallelInputs": "100", "computeMsAvg": "15", "computeMsMax": "26", "computeRatioAvg": 0.018115942028985508, "computeRatioMax": 0.03140096618357488, "endMs": "1665768250867", "id": "6", "inputStages": [ "1" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "6258", "startMs": "1665768250775", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0024154589371980675, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.020531400966183576, "writeRatioMax": 0.036231884057971016 }, { "completedParallelInputs": "5", "computeMsAvg": "732", "computeMsMax": "828", "computeRatioAvg": 0.8840579710144928, "computeRatioMax": 1, "endMs": "1665768251345", "id": "7", "inputStages": [ "3", "4", "0", "6", "2" ], "name": "S07: Join+", "parallelInputs": "5", "readMsAvg": "21", "readMsMax": "25", "readRatioAvg": 0.025362318840579712, "readRatioMax": 0.030193236714975844, "recordsRead": "9382188", "recordsWritten": "576", "shuffleOutputBytes": "11640", "shuffleOutputBytesSpilled": "0", "slotMs": "3433", "startMs": "1665768250782", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage07_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.006038647342995169, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.004830917874396135, "writeRatioMax": 0.006038647342995169 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.007246376811594203, "computeRatioMax": 0.007246376811594203, "endMs": "1665768251366", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "576", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665768251355", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage08_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012077294685990338, "waitRatioMax": 0.0012077294685990338, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.004830917874396135, "writeRatioMax": 0.004830917874396135 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.010869565217391304, "computeRatioMax": 0.010869565217391304, "endMs": "1665768251410", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768251373", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012077294685990338, "waitRatioMax": 0.0012077294685990338, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01570048309178744, "writeRatioMax": 0.01570048309178744 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.013285024154589372, "computeRatioMax": 0.013285024154589372, "endMs": "1665768251422", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768251388", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0012077294685990338, "waitRatioMax": 0.0012077294685990338, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.00966183574879227, "writeRatioMax": 0.00966183574879227 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "109", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "8038" }, { "activeUnits": "5", "completedUnits": "117", "elapsedMs": "1007", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11017" } ], "totalBytesBilled": "106954752", "totalBytesProcessed": "106362194", "totalPartitionsProcessed": "0", "totalSlotMs": "11017", "transferredBytes": "0" }, "startTime": "1665768250448", "totalBytesProcessed": "106362194", "totalSlotMs": "11017" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonadc0c3b5_ac59_421a_95a4_cf81e310cd00" }, "priority": "INTERACTIVE", "query": "select \n count(distinct cs_order_number) as order_count\n ,sum(cs_ext_ship_cost) as total_shipping_cost\n ,sum(cs_net_profit) as total_net_profit\nfrom\n catalog_sales cs1\n ,date_dim\n ,customer_address\n ,call_center\nwhere\n d_date between '2002-2-01' and \n (cast('2002-2-01' + 60 as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'GA'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County'\n)\nand exists (select *\n from catalog_sales cs2\n where cs1.cs_order_number = cs2.cs_order_number\n and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n from catalog_returns cr1\n where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Zt4+813hIMTLAZ0s51ZReQ==", "id": "test-project-364309:europe-west1.query16_1665776927", "jobReference": { "jobId": "query16_1665776927", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query16_1665776927?location=europe-west1", "statistics": { "creationTime": "1665776928096", "endTime": "1665776929355", "finalExecutionDurationMs": "1058", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "106362194", "performanceInsights": { "avgPreviousExecutionMs": "997" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.028963414634146343, "computeRatioMax": 0.028963414634146343, "endMs": "1665776928293", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005335365853658537, "readRatioMax": 0.005335365853658537, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "1296603", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776928254", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007621951219512195, "waitRatioMax": 0.0007621951219512195, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006859756097560976, "writeRatioMax": 0.006859756097560976 }, { "completedParallelInputs": "5", "computeMsAvg": "150", "computeMsMax": "192", "computeRatioAvg": 0.11432926829268293, "computeRatioMax": 0.14634146341463414, "endMs": "1665776928414", "id": "1", "name": "S01: Input", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "12", "readRatioAvg": 0.006859756097560976, "readRatioMax": 0.009146341463414634, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "723", "startMs": "1665776928271", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_warehouse_sk, $11:cs_order_number", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007621951219512195, "waitRatioMax": 0.001524390243902439, "writeMsAvg": "26", "writeMsMax": "34", "writeRatioAvg": 0.019817073170731708, "writeRatioMax": 0.025914634146341462 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.005335365853658537, "computeRatioMax": 0.005335365853658537, "endMs": "1665776928332", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.023628048780487805, "readRatioMax": 0.023628048780487805, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "54", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776928288", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cc_call_center_sk, $21:cc_county", "FROM call_center", "WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001524390243902439, "waitRatioMax": 0.001524390243902439, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0038109756097560975, "writeRatioMax": 0.0038109756097560975 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.009146341463414634, "computeRatioMax": 0.009146341463414634, "endMs": "1665776928343", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.009146341463414634, "readRatioMax": 0.009146341463414634, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776928304", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007621951219512195, "waitRatioMax": 0.0007621951219512195, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.006097560975609756, "writeRatioMax": 0.006097560975609756 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.012195121951219513, "computeRatioMax": 0.012195121951219513, "endMs": "1665776928363", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.006859756097560976, "readRatioMax": 0.006859756097560976, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776928318", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 11719, 11779)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007621951219512195, "waitRatioMax": 0.0007621951219512195, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.008384146341463415, "writeRatioMax": 0.008384146341463415 }, { "completedParallelInputs": "100", "computeMsAvg": "14", "computeMsMax": "23", "computeRatioAvg": 0.010670731707317074, "computeRatioMax": 0.01753048780487805, "endMs": "1665776928486", "id": "6", "inputStages": [ "1" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "4786", "startMs": "1665776928419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.001524390243902439, "waitRatioMax": 0.0022865853658536584, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.011432926829268292, "writeRatioMax": 0.022103658536585365 }, { "completedParallelInputs": "5", "computeMsAvg": "964", "computeMsMax": "1312", "computeRatioAvg": 0.7347560975609756, "computeRatioMax": 1, "endMs": "1665776929191", "id": "7", "inputStages": [ "2", "4", "6", "0", "3" ], "name": "S07: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "47", "readRatioAvg": 0.019817073170731708, "readRatioMax": 0.035823170731707314, "recordsRead": "9382188", "recordsWritten": "576", "shuffleOutputBytes": "11640", "shuffleOutputBytesSpilled": "0", "slotMs": "4497", "startMs": "1665776928429", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage07_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.0007621951219512195, "waitRatioMax": 0.003048780487804878, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.0038109756097560975, "writeRatioMax": 0.006097560975609756 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.009146341463414634, "computeRatioMax": 0.009146341463414634, "endMs": "1665776929217", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "576", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665776929203", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage08_output", "BY HASH($250)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0022865853658536584, "waitRatioMax": 0.0022865853658536584, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.003048780487804878, "writeRatioMax": 0.003048780487804878 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.008384146341463415, "computeRatioMax": 0.008384146341463415, "endMs": "1665776929258", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776929221", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007621951219512195, "waitRatioMax": 0.0007621951219512195, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.011432926829268292, "writeRatioMax": 0.011432926829268292 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.004573170731707317, "computeRatioMax": 0.004573170731707317, "endMs": "1665776929277", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776929236", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007621951219512195, "waitRatioMax": 0.0007621951219512195, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0038109756097560975, "writeRatioMax": 0.0038109756097560975 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "109", "elapsedMs": "610", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "5940" }, { "activeUnits": "5", "completedUnits": "117", "elapsedMs": "1166", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10283" } ], "totalBytesBilled": "106954752", "totalBytesProcessed": "106362194", "totalPartitionsProcessed": "0", "totalSlotMs": "10283", "transferredBytes": "0" }, "startTime": "1665776928145", "totalBytesProcessed": "106362194", "totalSlotMs": "10283" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6b93f6e2_15c9_4043_b28f_6c50259946df" }, "priority": "INTERACTIVE", "query": "select \n count(distinct cs_order_number) as order_count\n ,sum(cs_ext_ship_cost) as total_shipping_cost\n ,sum(cs_net_profit) as total_net_profit\nfrom\n catalog_sales cs1\n ,date_dim\n ,customer_address\n ,call_center\nwhere\n d_date between '2002-2-01' and \n (cast('2002-2-01' + 60 as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'GA'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County'\n)\nand exists (select *\n from catalog_sales cs2\n where cs1.cs_order_number = cs2.cs_order_number\n and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n from catalog_returns cr1\n where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "13vEvm//HYJduWvj61L5eg==", "id": "test-project-364309:europe-west1.query16_1665776930", "jobReference": { "jobId": "query16_1665776930", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query16_1665776930?location=europe-west1", "statistics": { "creationTime": "1665776930929", "endTime": "1665776932074", "finalExecutionDurationMs": "909", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "106362194", "performanceInsights": { "avgPreviousExecutionMs": "1005" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "79", "computeMsMax": "79", "computeRatioAvg": 0.06314948041566747, "computeRatioMax": 0.06314948041566747, "endMs": "1665776931168", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.007993605115907274, "readRatioMax": 0.007993605115907274, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "1296603", "shuffleOutputBytesSpilled": "0", "slotMs": "84", "startMs": "1665776931103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.0007993605115907274, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.012789768185451638, "writeRatioMax": 0.012789768185451638 }, { "completedParallelInputs": "5", "computeMsAvg": "180", "computeMsMax": "236", "computeRatioAvg": 0.14388489208633093, "computeRatioMax": 0.18864908073541167, "endMs": "1665776931255", "id": "1", "name": "S01: Input", "parallelInputs": "5", "readMsAvg": "8", "readMsMax": "9", "readRatioAvg": 0.006394884092725819, "readRatioMax": 0.007194244604316547, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "732", "startMs": "1665776931117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_warehouse_sk, $11:cs_order_number", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.0007993605115907274, "writeMsAvg": "28", "writeMsMax": "32", "writeRatioAvg": 0.02238209432454037, "writeRatioMax": 0.025579536370903277 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.007993605115907274, "computeRatioMax": 0.007993605115907274, "endMs": "1665776931164", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0031974420463629096, "readRatioMax": 0.0031974420463629096, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "54", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776931132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cc_call_center_sk, $21:cc_county", "FROM call_center", "WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.0007993605115907274, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.006394884092725819, "writeRatioMax": 0.006394884092725819 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006394884092725819, "computeRatioMax": 0.006394884092725819, "endMs": "1665776931173", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004796163069544364, "readRatioMax": 0.004796163069544364, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665776931147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.0007993605115907274, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010391686650679457, "writeRatioMax": 0.010391686650679457 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.011990407673860911, "computeRatioMax": 0.011990407673860911, "endMs": "1665776931205", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006394884092725819, "readRatioMax": 0.006394884092725819, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776931162", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 11719, 11779)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.008792965627498001, "writeRatioMax": 0.008792965627498001 }, { "completedParallelInputs": "100", "computeMsAvg": "14", "computeMsMax": "25", "computeRatioAvg": 0.011191047162270184, "computeRatioMax": 0.019984012789768184, "endMs": "1665776931337", "id": "6", "inputStages": [ "1" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "3968", "startMs": "1665776931260", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.0015987210231814548, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.011191047162270184, "writeRatioMax": 0.01838529176658673 }, { "completedParallelInputs": "5", "computeMsAvg": "903", "computeMsMax": "1251", "computeRatioAvg": 0.7218225419664268, "computeRatioMax": 1, "endMs": "1665776931897", "id": "7", "inputStages": [ "2", "3", "6", "0", "4" ], "name": "S07: Join+", "parallelInputs": "5", "readMsAvg": "20", "readMsMax": "21", "readRatioAvg": 0.01598721023181455, "readRatioMax": 0.016786570743405275, "recordsRead": "9382188", "recordsWritten": "576", "shuffleOutputBytes": "11640", "shuffleOutputBytesSpilled": "0", "slotMs": "3759", "startMs": "1665776931264", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage07_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0031974420463629096, "writeRatioMax": 0.0031974420463629096 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006394884092725819, "computeRatioMax": 0.006394884092725819, "endMs": "1665776931918", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "576", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665776931905", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage08_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.0007993605115907274, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.002398081534772182, "writeRatioMax": 0.002398081534772182 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006394884092725819, "computeRatioMax": 0.006394884092725819, "endMs": "1665776931957", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776931923", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.0007993605115907274, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.011191047162270184, "writeRatioMax": 0.011191047162270184 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007194244604316547, "computeRatioMax": 0.007194244604316547, "endMs": "1665776931980", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776931938", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007993605115907274, "waitRatioMax": 0.0007993605115907274, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.003996802557953637, "writeRatioMax": 0.003996802557953637 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "109", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "5909" }, { "activeUnits": "5", "completedUnits": "117", "elapsedMs": "1011", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8774" } ], "totalBytesBilled": "106954752", "totalBytesProcessed": "106362194", "totalPartitionsProcessed": "0", "totalSlotMs": "8774", "transferredBytes": "0" }, "startTime": "1665776931001", "totalBytesProcessed": "106362194", "totalSlotMs": "8774" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0dd64295_f920_46a1_a172_7a1d47750c45" }, "priority": "INTERACTIVE", "query": "select \n count(distinct cs_order_number) as order_count\n ,sum(cs_ext_ship_cost) as total_shipping_cost\n ,sum(cs_net_profit) as total_net_profit\nfrom\n catalog_sales cs1\n ,date_dim\n ,customer_address\n ,call_center\nwhere\n d_date between '2002-2-01' and \n (cast('2002-2-01' + 60 as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'GA'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County'\n)\nand exists (select *\n from catalog_sales cs2\n where cs1.cs_order_number = cs2.cs_order_number\n and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n from catalog_returns cr1\n where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "fYxjCU5nig4tfywewlWitg==", "id": "test-project-364309:europe-west1.query16_1665776933", "jobReference": { "jobId": "query16_1665776933", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query16_1665776933?location=europe-west1", "statistics": { "creationTime": "1665776933821", "endTime": "1665776935105", "finalExecutionDurationMs": "1090", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "106362194", "performanceInsights": { "avgPreviousExecutionMs": "994" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "62", "computeMsMax": "62", "computeRatioAvg": 0.05081967213114754, "computeRatioMax": 0.05081967213114754, "endMs": "1665776934012", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004918032786885246, "readRatioMax": 0.004918032786885246, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "1296603", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776933958", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.011475409836065573, "writeRatioMax": 0.011475409836065573 }, { "completedParallelInputs": "5", "computeMsAvg": "151", "computeMsMax": "178", "computeRatioAvg": 0.12377049180327869, "computeRatioMax": 0.14590163934426228, "endMs": "1665776934112", "id": "1", "name": "S01: Input", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "10", "readRatioAvg": 0.007377049180327869, "readRatioMax": 0.00819672131147541, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "739", "startMs": "1665776933972", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_warehouse_sk, $11:cs_order_number", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "30", "writeMsMax": "32", "writeRatioAvg": 0.02459016393442623, "writeRatioMax": 0.02622950819672131 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.010655737704918032, "computeRatioMax": 0.010655737704918032, "endMs": "1665776934026", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005737704918032787, "readRatioMax": 0.005737704918032787, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "54", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776933987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cc_call_center_sk, $21:cc_county", "FROM call_center", "WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.007377049180327869, "writeRatioMax": 0.007377049180327869 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00819672131147541, "computeRatioMax": 0.00819672131147541, "endMs": "1665776934033", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005737704918032787, "readRatioMax": 0.005737704918032787, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776934002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.013114754098360656, "writeRatioMax": 0.013114754098360656 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00819672131147541, "computeRatioMax": 0.00819672131147541, "endMs": "1665776934041", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005737704918032787, "readRatioMax": 0.005737704918032787, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665776934018", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 11719, 11779)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.001639344262295082, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.004918032786885246, "writeRatioMax": 0.004918032786885246 }, { "completedParallelInputs": "100", "computeMsAvg": "14", "computeMsMax": "23", "computeRatioAvg": 0.011475409836065573, "computeRatioMax": 0.018852459016393444, "endMs": "1665776934184", "id": "6", "inputStages": [ "1" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "4672", "startMs": "1665776934117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.001639344262295082, "waitRatioMax": 0.002459016393442623, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.012295081967213115, "writeRatioMax": 0.01721311475409836 }, { "completedParallelInputs": "5", "computeMsAvg": "998", "computeMsMax": "1220", "computeRatioAvg": 0.8180327868852459, "computeRatioMax": 1, "endMs": "1665776934916", "id": "7", "inputStages": [ "4", "2", "6", "0", "3" ], "name": "S07: Join+", "parallelInputs": "5", "readMsAvg": "30", "readMsMax": "38", "readRatioAvg": 0.02459016393442623, "readRatioMax": 0.03114754098360656, "recordsRead": "9382188", "recordsWritten": "576", "shuffleOutputBytes": "11640", "shuffleOutputBytesSpilled": "0", "slotMs": "4548", "startMs": "1665776934122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage07_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.003278688524590164, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.005737704918032787, "writeRatioMax": 0.006557377049180328 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007377049180327869, "computeRatioMax": 0.007377049180327869, "endMs": "1665776934957", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "576", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665776934944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage08_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.003278688524590164, "writeRatioMax": 0.003278688524590164 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007377049180327869, "computeRatioMax": 0.007377049180327869, "endMs": "1665776935001", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776934962", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.011475409836065573, "writeRatioMax": 0.011475409836065573 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.014754098360655738, "computeRatioMax": 0.014754098360655738, "endMs": "1665776935013", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776934977", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000819672131147541, "waitRatioMax": 0.000819672131147541, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.007377049180327869, "writeRatioMax": 0.007377049180327869 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "109", "elapsedMs": "592", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "5924" }, { "activeUnits": "5", "completedUnits": "117", "elapsedMs": "1186", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10213" } ], "totalBytesBilled": "106954752", "totalBytesProcessed": "106362194", "totalPartitionsProcessed": "0", "totalSlotMs": "10213", "transferredBytes": "0" }, "startTime": "1665776933868", "totalBytesProcessed": "106362194", "totalSlotMs": "10213" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5b336825_5c65_4289_9512_5cea4f1100fa" }, "priority": "INTERACTIVE", "query": "select \n count(distinct cs_order_number) as order_count\n ,sum(cs_ext_ship_cost) as total_shipping_cost\n ,sum(cs_net_profit) as total_net_profit\nfrom\n catalog_sales cs1\n ,date_dim\n ,customer_address\n ,call_center\nwhere\n d_date between '2002-2-01' and \n (cast('2002-2-01' + 60 as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'GA'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County'\n)\nand exists (select *\n from catalog_sales cs2\n where cs1.cs_order_number = cs2.cs_order_number\n and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n from catalog_returns cr1\n where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "B9plFJAt9JRV2rb4LFX1pQ==", "id": "test-project-364309:europe-west1.query16_1665776936", "jobReference": { "jobId": "query16_1665776936", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query16_1665776936?location=europe-west1", "statistics": { "creationTime": "1665776936712", "endTime": "1665776937930", "finalExecutionDurationMs": "980", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "106362194", "performanceInsights": { "avgPreviousExecutionMs": "1004" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.047524752475247525, "computeRatioMax": 0.047524752475247525, "endMs": "1665776936941", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.006930693069306931, "readRatioMax": 0.006930693069306931, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "1296603", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776936891", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0009900990099009901, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01287128712871287, "writeRatioMax": 0.01287128712871287 }, { "completedParallelInputs": "5", "computeMsAvg": "197", "computeMsMax": "218", "computeRatioAvg": 0.19504950495049506, "computeRatioMax": 0.21584158415841584, "endMs": "1665776937054", "id": "1", "name": "S01: Input", "parallelInputs": "5", "readMsAvg": "8", "readMsMax": "9", "readRatioAvg": 0.007920792079207921, "readRatioMax": 0.00891089108910891, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "849", "startMs": "1665776936908", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_warehouse_sk, $11:cs_order_number", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0009900990099009901, "writeMsAvg": "29", "writeMsMax": "31", "writeRatioAvg": 0.028712871287128714, "writeRatioMax": 0.030693069306930693 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.009900990099009901, "computeRatioMax": 0.009900990099009901, "endMs": "1665776936972", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0039603960396039604, "readRatioMax": 0.0039603960396039604, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "54", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776936931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cc_call_center_sk, $21:cc_county", "FROM call_center", "WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0009900990099009901, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.028712871287128714, "writeRatioMax": 0.028712871287128714 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01287128712871287, "computeRatioMax": 0.01287128712871287, "endMs": "1665776936989", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.009900990099009901, "readRatioMax": 0.009900990099009901, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776936949", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0009900990099009901, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.007920792079207921, "writeRatioMax": 0.007920792079207921 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.011881188118811881, "computeRatioMax": 0.011881188118811881, "endMs": "1665776937006", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005940594059405941, "readRatioMax": 0.005940594059405941, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776936967", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 11719, 11779)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0009900990099009901, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01287128712871287, "writeRatioMax": 0.01287128712871287 }, { "completedParallelInputs": "100", "computeMsAvg": "14", "computeMsMax": "20", "computeRatioAvg": 0.013861386138613862, "computeRatioMax": 0.019801980198019802, "endMs": "1665776937134", "id": "6", "inputStages": [ "1" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "5139", "startMs": "1665776937058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0019801980198019802, "waitRatioMax": 0.0029702970297029703, "writeMsAvg": "16", "writeMsMax": "19", "writeRatioAvg": 0.015841584158415842, "writeRatioMax": 0.01881188118811881 }, { "completedParallelInputs": "5", "computeMsAvg": "953", "computeMsMax": "1010", "computeRatioAvg": 0.9435643564356435, "computeRatioMax": 1, "endMs": "1665776937740", "id": "7", "inputStages": [ "3", "0", "4", "2", "6" ], "name": "S07: Join+", "parallelInputs": "5", "readMsAvg": "25", "readMsMax": "35", "readRatioAvg": 0.024752475247524754, "readRatioMax": 0.034653465346534656, "recordsRead": "9382188", "recordsWritten": "576", "shuffleOutputBytes": "11640", "shuffleOutputBytesSpilled": "0", "slotMs": "3789", "startMs": "1665776937062", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage07_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "1", "waitMsMax": "5", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0049504950495049506, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.005940594059405941, "writeRatioMax": 0.00891089108910891 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0049504950495049506, "computeRatioMax": 0.0049504950495049506, "endMs": "1665776937767", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "576", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665776937749", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage08_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0009900990099009901, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0039603960396039604, "writeRatioMax": 0.0039603960396039604 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.01287128712871287, "computeRatioMax": 0.01287128712871287, "endMs": "1665776937809", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776937772", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0009900990099009901, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.01287128712871287, "writeRatioMax": 0.01287128712871287 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.016831683168316833, "computeRatioMax": 0.016831683168316833, "endMs": "1665776937836", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776937788", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009900990099009901, "waitRatioMax": 0.0009900990099009901, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01089108910891089, "writeRatioMax": 0.01089108910891089 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "109", "elapsedMs": "614", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "6698" }, { "activeUnits": "5", "completedUnits": "117", "elapsedMs": "1086", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10042" } ], "totalBytesBilled": "106954752", "totalBytesProcessed": "106362194", "totalPartitionsProcessed": "0", "totalSlotMs": "10042", "transferredBytes": "0" }, "startTime": "1665776936779", "totalBytesProcessed": "106362194", "totalSlotMs": "10042" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon936744f2_6528_4254_8c82_82f662f08988" }, "priority": "INTERACTIVE", "query": "select \n count(distinct cs_order_number) as order_count\n ,sum(cs_ext_ship_cost) as total_shipping_cost\n ,sum(cs_net_profit) as total_net_profit\nfrom\n catalog_sales cs1\n ,date_dim\n ,customer_address\n ,call_center\nwhere\n d_date between '2002-2-01' and \n (cast('2002-2-01' + 60 as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'GA'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n 'Williamson County'\n)\nand exists (select *\n from catalog_sales cs2\n where cs1.cs_order_number = cs2.cs_order_number\n and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n from catalog_returns cr1\n where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\nlimit 100;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ldStUCtyH6NQuvJw8L14MA==", "id": "test-project-364309:europe-west1.query16_1665776938", "jobReference": { "jobId": "query16_1665776938", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query16_1665776938?location=europe-west1", "statistics": { "creationTime": "1665776939548", "endTime": "1665776940610", "finalExecutionDurationMs": "855", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "106362194", "performanceInsights": { "avgPreviousExecutionMs": "1002" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.06366630076838639, "computeRatioMax": 0.06366630076838639, "endMs": "1665776939760", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007683863885839737, "readRatioMax": 0.007683863885839737, "recordsRead": "144067", "recordsWritten": "144067", "shuffleOutputBytes": "1296603", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665776939704", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cr_order_number", "FROM catalog_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021953896816684962, "waitRatioMax": 0.0021953896816684962, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.015367727771679473, "writeRatioMax": 0.015367727771679473 }, { "completedParallelInputs": "5", "computeMsAvg": "161", "computeMsMax": "212", "computeRatioAvg": 0.17672886937431395, "computeRatioMax": 0.2327113062568606, "endMs": "1665776939858", "id": "1", "name": "S01: Input", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.010976948408342482, "readRatioMax": 0.014270032930845226, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "745", "startMs": "1665776939719", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:cs_warehouse_sk, $11:cs_order_number", "FROM catalog_sales" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0021953896816684962, "waitRatioMax": 0.0021953896816684962, "writeMsAvg": "27", "writeMsMax": "32", "writeRatioAvg": 0.029637760702524697, "writeRatioMax": 0.03512623490669594 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012074643249176729, "computeRatioMax": 0.012074643249176729, "endMs": "1665776939765", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008781558726673985, "readRatioMax": 0.008781558726673985, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "54", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776939734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cc_call_center_sk, $21:cc_county", "FROM call_center", "WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')" ] }, { "kind": "WRITE", "substeps": [ "$20", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010976948408342481, "waitRatioMax": 0.0010976948408342481, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01646542261251372, "writeRatioMax": 0.01646542261251372 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.007683863885839737, "computeRatioMax": 0.007683863885839737, "endMs": "1665776939788", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006586169045005488, "readRatioMax": 0.006586169045005488, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "22014", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776939750", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ca_address_sk, $41:ca_state", "FROM customer_address", "WHERE equal($41, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010976948408342481, "waitRatioMax": 0.0010976948408342481, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.014270032930845226, "writeRatioMax": 0.014270032930845226 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.015367727771679473, "computeRatioMax": 0.015367727771679473, "endMs": "1665776939807", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.005488474204171241, "readRatioMax": 0.005488474204171241, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776939765", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_date", "FROM date_dim", "WHERE between($51, 11719, 11779)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010976948408342481, "waitRatioMax": 0.0010976948408342481, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.015367727771679473, "writeRatioMax": 0.015367727771679473 }, { "completedParallelInputs": "100", "computeMsAvg": "14", "computeMsMax": "29", "computeRatioAvg": 0.015367727771679473, "computeRatioMax": 0.031833150384193196, "endMs": "1665776939940", "id": "6", "inputStages": [ "1" ], "name": "S06: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1441548", "recordsWritten": "1441548", "shuffleOutputBytes": "25890696", "shuffleOutputBytesSpilled": "0", "slotMs": "4785", "startMs": "1665776939863", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage01_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.003293084522502744, "waitRatioMax": 0.0043907793633369925, "writeMsAvg": "16", "writeMsMax": "27", "writeRatioAvg": 0.01756311745334797, "writeRatioMax": 0.029637760702524697 }, { "completedParallelInputs": "5", "computeMsAvg": "815", "computeMsMax": "911", "computeRatioAvg": 0.8946212952799122, "computeRatioMax": 1, "endMs": "1665776940448", "id": "7", "inputStages": [ "3", "6", "2", "4", "0" ], "name": "S07: Join+", "parallelInputs": "5", "readMsAvg": "24", "readMsMax": "29", "readRatioAvg": 0.026344676180021953, "readRatioMax": 0.031833150384193196, "recordsRead": "9382188", "recordsWritten": "576", "shuffleOutputBytes": "11640", "shuffleOutputBytesSpilled": "0", "slotMs": "3569", "startMs": "1665776939872", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage06_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $170, $231 := $150", "$140 := SUM($152)", "$141 := SUM($151)" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := if(equal($170, 1), $220, NULL)", "$151 := if(equal($170, 0), $222, NULL)", "$152 := if(equal($170, 0), $221, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $212, $222 := $213", "ANTI HASH JOIN EACH WITH ALL ON $211 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $10", "SEMI HASH JOIN EACH WITH ALL ON $201 = $11" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $20" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185", "INNER HASH JOIN EACH WITH ALL ON $180 = $40" ] }, { "kind": "JOIN", "substeps": [ "$180 := $31, $181 := $32, $182 := $33, $183 := $34, $184 := $35, $185 := $36", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $231, $230", "TO __stage07_output", "BY HASH($230, $231)" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0021953896816684962, "waitRatioMax": 0.0043907793633369925, "writeMsAvg": "5", "writeMsMax": "9", "writeRatioAvg": 0.005488474204171241, "writeRatioMax": 0.009879253567508232 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013172338090010977, "computeRatioMax": 0.013172338090010977, "endMs": "1665776940475", "id": "8", "inputStages": [ "7" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "576", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665776940459", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $231, $230", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $240", "$110 := COUNT($122)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($120)" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(equal($240, 0), $131, NULL)", "$121 := if(equal($240, 0), $130, NULL)", "$122 := if(equal($240, 1), $241, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231", "$130 := SUM($140)", "$131 := SUM($141)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $250", "TO __stage08_output", "BY HASH($250)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010976948408342481, "waitRatioMax": 0.0010976948408342481, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.005488474204171241, "writeRatioMax": 0.005488474204171241 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.007683863885839737, "computeRatioMax": 0.007683863885839737, "endMs": "1665776940514", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776940479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110, $111, $112, $250", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($92)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($90)" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := if(equal($260, 0), $102, NULL)", "$91 := if(equal($260, 0), $101, NULL)", "$92 := if(equal($260, 1), $100, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$100 := SUM_OF_COUNTS($110)", "$101 := ANY_VALUE($111)", "$102 := ANY_VALUE($112)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $82", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010976948408342481, "waitRatioMax": 0.0010976948408342481, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01646542261251372, "writeRatioMax": 0.01646542261251372 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.015367727771679473, "computeRatioMax": 0.015367727771679473, "endMs": "1665776940527", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776940494", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80, $81, $82", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($70), 0, $70)" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($80)", "$71 := ANY_VALUE($81)", "$72 := ANY_VALUE($82)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0010976948408342481, "waitRatioMax": 0.0010976948408342481, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008781558726673985, "writeRatioMax": 0.008781558726673985 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "call_center" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "5", "completedUnits": "109", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "6040" }, { "activeUnits": "5", "completedUnits": "117", "elapsedMs": "959", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9305" } ], "totalBytesBilled": "106954752", "totalBytesProcessed": "106362194", "totalPartitionsProcessed": "0", "totalSlotMs": "9305", "transferredBytes": "0" }, "startTime": "1665776939601", "totalBytesProcessed": "106362194", "totalSlotMs": "9305" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
