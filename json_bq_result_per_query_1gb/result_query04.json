{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon80f4aaa7_e4d4_4766_915b_7989830dd479" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "2QrAaQLYU1I4p/3HNc8XTQ==", "id": "test-project-364309:europe-west1.query04_1665768206", "jobReference": { "jobId": "query04_1665768206", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665768206?location=europe-west1", "statistics": { "creationTime": "1665768207198", "endTime": "1665768209355", "finalExecutionDurationMs": "1862", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2042" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.008620689655172414, "computeRatioMax": 0.008620689655172414, "endMs": "1665768207442", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.007053291536050157, "readRatioMax": 0.007053291536050157, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768207404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0054858934169279, "writeRatioMax": 0.0054858934169279 }, { "completedParallelInputs": "1", "computeMsAvg": "183", "computeMsMax": "183", "computeRatioAvg": 0.14341692789968652, "computeRatioMax": 0.14341692789968652, "endMs": "1665768207607", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.014106583072100314, "readRatioMax": 0.014106583072100314, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "226", "startMs": "1665768207440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001567398119122257, "waitRatioMax": 0.001567398119122257, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0109717868338558, "writeRatioMax": 0.0109717868338558 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.008620689655172414, "computeRatioMax": 0.008620689655172414, "endMs": "1665768207494", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.007053291536050157, "readRatioMax": 0.007053291536050157, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768207455", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001567398119122257, "waitRatioMax": 0.001567398119122257, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0054858934169279, "writeRatioMax": 0.0054858934169279 }, { "completedParallelInputs": "1", "computeMsAvg": "255", "computeMsMax": "255", "computeRatioAvg": 0.19984326018808776, "computeRatioMax": 0.19984326018808776, "endMs": "1665768207689", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.013322884012539185, "readRatioMax": 0.013322884012539185, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "272", "startMs": "1665768207480", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.013322884012539185, "writeRatioMax": 0.013322884012539185 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006269592476489028, "computeRatioMax": 0.006269592476489028, "endMs": "1665768207521", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003918495297805642, "readRatioMax": 0.003918495297805642, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768207495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.011755485893416929, "writeRatioMax": 0.011755485893416929 }, { "completedParallelInputs": "1", "computeMsAvg": "248", "computeMsMax": "248", "computeRatioAvg": 0.19435736677115986, "computeRatioMax": 0.19435736677115986, "endMs": "1665768207718", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.0109717868338558, "readRatioMax": 0.0109717868338558, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "262", "startMs": "1665768207521", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.011755485893416929, "writeRatioMax": 0.011755485893416929 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.004702194357366771, "computeRatioMax": 0.004702194357366771, "endMs": "1665768207571", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003918495297805642, "readRatioMax": 0.003918495297805642, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768207535", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001567398119122257, "waitRatioMax": 0.001567398119122257, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0109717868338558, "writeRatioMax": 0.0109717868338558 }, { "completedParallelInputs": "1", "computeMsAvg": "250", "computeMsMax": "250", "computeRatioAvg": 0.19592476489028213, "computeRatioMax": 0.19592476489028213, "endMs": "1665768207769", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.02821316614420063, "readRatioMax": 0.02821316614420063, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "297", "startMs": "1665768207560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.018025078369905956, "writeRatioMax": 0.018025078369905956 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0109717868338558, "computeRatioMax": 0.0109717868338558, "endMs": "1665768207620", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006269592476489028, "readRatioMax": 0.006269592476489028, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768207578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.012539184952978056, "writeRatioMax": 0.012539184952978056 }, { "completedParallelInputs": "1", "computeMsAvg": "235", "computeMsMax": "235", "computeRatioAvg": 0.1841692789968652, "computeRatioMax": 0.1841692789968652, "endMs": "1665768207828", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.011755485893416929, "readRatioMax": 0.011755485893416929, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "266", "startMs": "1665768207612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.011755485893416929, "writeRatioMax": 0.011755485893416929 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.008620689655172414, "computeRatioMax": 0.008620689655172414, "endMs": "1665768207656", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.007053291536050157, "readRatioMax": 0.007053291536050157, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768207628", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.008620689655172414, "writeRatioMax": 0.008620689655172414 }, { "completedParallelInputs": "1", "computeMsAvg": "189", "computeMsMax": "189", "computeRatioAvg": 0.1481191222570533, "computeRatioMax": 0.1481191222570533, "endMs": "1665768207843", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.013322884012539185, "readRatioMax": 0.013322884012539185, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "223", "startMs": "1665768207654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.012539184952978056, "writeRatioMax": 0.012539184952978056 }, { "completedParallelInputs": "6", "computeMsAvg": "1076", "computeMsMax": "1276", "computeRatioAvg": 0.8432601880877743, "computeRatioMax": 1, "endMs": "1665768208379", "id": "18", "inputStages": [ "2", "0" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "34", "readMsMax": "38", "readRatioAvg": 0.02664576802507837, "readRatioMax": 0.029780564263322883, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "5444", "startMs": "1665768207660", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage12_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.001567398119122257, "writeMsAvg": "9", "writeMsMax": "11", "writeRatioAvg": 0.007053291536050157, "writeRatioMax": 0.008620689655172414 }, { "completedParallelInputs": "5", "computeMsAvg": "725", "computeMsMax": "813", "computeRatioAvg": 0.5681818181818182, "computeRatioMax": 0.6371473354231975, "endMs": "1665768208245", "id": "19", "inputStages": [ "5", "3" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "30", "readMsMax": "40", "readRatioAvg": 0.023510971786833857, "readRatioMax": 0.03134796238244514, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "3208", "startMs": "1665768207740", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage13_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001567398119122257, "waitRatioMax": 0.001567398119122257, "writeMsAvg": "23", "writeMsMax": "24", "writeRatioAvg": 0.018025078369905956, "writeRatioMax": 0.018808777429467086 }, { "completedParallelInputs": "6", "computeMsAvg": "986", "computeMsMax": "1152", "computeRatioAvg": 0.7727272727272727, "computeRatioMax": 0.9028213166144201, "endMs": "1665768208518", "id": "20", "inputStages": [ "8", "6" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "34", "readMsMax": "46", "readRatioAvg": 0.02664576802507837, "readRatioMax": 0.03605015673981191, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "5020", "startMs": "1665768207782", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage14_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "9", "writeMsMax": "15", "writeRatioAvg": 0.007053291536050157, "writeRatioMax": 0.011755485893416929 }, { "completedParallelInputs": "5", "computeMsAvg": "748", "computeMsMax": "892", "computeRatioAvg": 0.5862068965517241, "computeRatioMax": 0.6990595611285266, "endMs": "1665768208303", "id": "21", "inputStages": [ "9", "11" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "24", "readMsMax": "32", "readRatioAvg": 0.018808777429467086, "readRatioMax": 0.025078369905956112, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3142", "startMs": "1665768207808", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "21", "writeMsMax": "23", "writeRatioAvg": 0.016457680250783698, "writeRatioMax": 0.018025078369905956 }, { "completedParallelInputs": "1", "computeMsAvg": "781", "computeMsMax": "781", "computeRatioAvg": 0.6120689655172413, "computeRatioMax": 0.6120689655172413, "endMs": "1665768208349", "id": "22", "inputStages": [ "14", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "32", "readMsMax": "32", "readRatioAvg": 0.025078369905956112, "readRatioMax": 0.025078369905956112, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "672", "startMs": "1665768207868", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.014106583072100314, "writeRatioMax": 0.014106583072100314 }, { "completedParallelInputs": "1", "computeMsAvg": "823", "computeMsMax": "823", "computeRatioAvg": 0.6449843260188087, "computeRatioMax": 0.6449843260188087, "endMs": "1665768208384", "id": "23", "inputStages": [ "15", "17" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "39", "readMsMax": "39", "readRatioAvg": 0.030564263322884012, "readRatioMax": 0.030564263322884012, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "707", "startMs": "1665768207884", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01567398119122257, "writeRatioMax": 0.01567398119122257 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.02115987460815047, "computeRatioMax": 0.02115987460815047, "endMs": "1665768208604", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665768208537", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "46", "writeMsMax": "46", "writeRatioAvg": 0.03605015673981191, "writeRatioMax": 0.03605015673981191 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.024294670846394983, "computeRatioMax": 0.024294670846394983, "endMs": "1665768208592", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768208548", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.017241379310344827, "writeRatioMax": 0.017241379310344827 }, { "completedParallelInputs": "1", "computeMsAvg": "156", "computeMsMax": "156", "computeRatioAvg": 0.12225705329153605, "computeRatioMax": 0.12225705329153605, "endMs": "1665768208685", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "168", "startMs": "1665768208561", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.018025078369905956, "writeRatioMax": 0.018025078369905956 }, { "completedParallelInputs": "1", "computeMsAvg": "227", "computeMsMax": "227", "computeRatioAvg": 0.1778996865203762, "computeRatioMax": 0.1778996865203762, "endMs": "1665768208719", "id": "27", "inputStages": [ "19" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "212", "startMs": "1665768208572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage13_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.016457680250783698, "writeRatioMax": 0.016457680250783698 }, { "completedParallelInputs": "1", "computeMsAvg": "286", "computeMsMax": "286", "computeRatioAvg": 0.22413793103448276, "computeRatioMax": 0.22413793103448276, "endMs": "1665768208756", "id": "29", "inputStages": [ "18" ], "name": "S1D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "237", "startMs": "1665768208598", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$280, $410", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007836990595611285, "waitRatioMax": 0.0007836990595611285, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.014890282131661442, "writeRatioMax": 0.014890282131661442 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.007053291536050157, "computeRatioMax": 0.012539184952978056, "endMs": "1665768208870", "id": "30", "inputStages": [ "29" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "3753", "startMs": "1665768208809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.0023510971786833857, "waitRatioMax": 0.004702194357366771, "writeMsAvg": "16", "writeMsMax": "28", "writeRatioAvg": 0.012539184952978056, "writeRatioMax": 0.0219435736677116 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.006269592476489028, "computeRatioMax": 0.014890282131661442, "endMs": "1665768208867", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "2985", "startMs": "1665768208810", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.004702194357366771, "waitRatioMax": 0.006269592476489028, "writeMsAvg": "13", "writeMsMax": "29", "writeRatioAvg": 0.01018808777429467, "writeRatioMax": 0.022727272727272728 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.0054858934169279, "computeRatioMax": 0.0109717868338558, "endMs": "1665768208871", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "1988", "startMs": "1665768208809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.006269592476489028, "waitRatioMax": 0.007836990595611285, "writeMsAvg": "3", "writeMsMax": "17", "writeRatioAvg": 0.0023510971786833857, "writeRatioMax": 0.013322884012539185 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.006269592476489028, "computeRatioMax": 0.01567398119122257, "endMs": "1665768208871", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "2408", "startMs": "1665768208810", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.007053291536050157, "waitRatioMax": 0.008620689655172414, "writeMsAvg": "4", "writeMsMax": "17", "writeRatioAvg": 0.003134796238244514, "writeRatioMax": 0.013322884012539185 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.006269592476489028, "computeRatioMax": 0.011755485893416929, "endMs": "1665768208885", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3168", "startMs": "1665768208810", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.007836990595611285, "waitRatioMax": 0.009404388714733543, "writeMsAvg": "4", "writeMsMax": "25", "writeRatioAvg": 0.003134796238244514, "writeRatioMax": 0.019592476489028215 }, { "completedParallelInputs": "1", "computeMsAvg": "490", "computeMsMax": "490", "computeRatioAvg": 0.384012539184953, "computeRatioMax": 0.384012539184953, "endMs": "1665768209120", "id": "35", "inputStages": [ "30", "31", "32", "34", "20", "33" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "316129", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "425", "startMs": "1665768208836", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$280, $410", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240, $480 := $410, $481 := $280", "INNER HASH JOIN EACH WITH ALL ON $470 = $410" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.008620689655172414, "waitRatioMax": 0.008620689655172414, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0007836990595611285, "writeRatioMax": 0.0007836990595611285 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.003918495297805642, "computeRatioMax": 0.003918495297805642, "endMs": "1665768209192", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "350", "startMs": "1665768208838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.0054858934169279, "waitRatioMax": 0.0054858934169279, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.003134796238244514, "writeRatioMax": 0.003134796238244514 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "12", "elapsedMs": "656", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "4167" }, { "activeUnits": "4", "completedUnits": "543", "elapsedMs": "2039", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "36873" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "36873", "transferredBytes": "0" }, "startTime": "1665768207252", "totalBytesProcessed": "401794978", "totalSlotMs": "36873" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5ef58a65_dfdc_4ff4_ada7_88a6a9da3f43" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "mPsYrsY+7gjyb/N+o9gfVg==", "id": "test-project-364309:europe-west1.query04_1665776442", "jobReference": { "jobId": "query04_1665776442", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776442?location=europe-west1", "statistics": { "creationTime": "1665776443036", "endTime": "1665776445454", "finalExecutionDurationMs": "2101", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2029" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.009406657018813314, "computeRatioMax": 0.009406657018813314, "endMs": "1665776443298", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.007959479015918957, "readRatioMax": 0.007959479015918957, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665776443254", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006512301013024602, "writeRatioMax": 0.006512301013024602 }, { "completedParallelInputs": "1", "computeMsAvg": "209", "computeMsMax": "209", "computeRatioAvg": 0.1512301013024602, "computeRatioMax": 0.1512301013024602, "endMs": "1665776443444", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.012301013024602027, "readRatioMax": 0.012301013024602027, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "259", "startMs": "1665776443284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.009406657018813314, "writeRatioMax": 0.009406657018813314 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.006512301013024602, "computeRatioMax": 0.006512301013024602, "endMs": "1665776443394", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004341534008683068, "readRatioMax": 0.004341534008683068, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776443351", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "49", "waitMsMax": "49", "waitRatioAvg": 0.03545586107091172, "waitRatioMax": 0.03545586107091172, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.011577424023154847, "writeRatioMax": 0.011577424023154847 }, { "completedParallelInputs": "1", "computeMsAvg": "187", "computeMsMax": "187", "computeRatioAvg": 0.1353111432706223, "computeRatioMax": 0.1353111432706223, "endMs": "1665776443528", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.01085383502170767, "readRatioMax": 0.01085383502170767, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "251", "startMs": "1665776443351", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.010130246020260492, "waitRatioMax": 0.010130246020260492, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.011577424023154847, "writeRatioMax": 0.011577424023154847 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.011577424023154847, "computeRatioMax": 0.011577424023154847, "endMs": "1665776443390", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.010130246020260492, "readRatioMax": 0.010130246020260492, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776443353", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.007959479015918957, "writeRatioMax": 0.007959479015918957 }, { "completedParallelInputs": "1", "computeMsAvg": "156", "computeMsMax": "156", "computeRatioAvg": 0.11287988422575977, "computeRatioMax": 0.11287988422575977, "endMs": "1665776443518", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.009406657018813314, "readRatioMax": 0.009406657018813314, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "198", "startMs": "1665776443381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01085383502170767, "writeRatioMax": 0.01085383502170767 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007959479015918957, "computeRatioMax": 0.007959479015918957, "endMs": "1665776443439", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.006512301013024602, "readRatioMax": 0.006512301013024602, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776443397", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.010130246020260492, "writeRatioMax": 0.010130246020260492 }, { "completedParallelInputs": "1", "computeMsAvg": "156", "computeMsMax": "156", "computeRatioAvg": 0.11287988422575977, "computeRatioMax": 0.11287988422575977, "endMs": "1665776443611", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.010130246020260492, "readRatioMax": 0.010130246020260492, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "263", "startMs": "1665776443427", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.011577424023154847, "writeRatioMax": 0.011577424023154847 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.006512301013024602, "computeRatioMax": 0.006512301013024602, "endMs": "1665776443485", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.006512301013024602, "readRatioMax": 0.006512301013024602, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776443443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006512301013024602, "writeRatioMax": 0.006512301013024602 }, { "completedParallelInputs": "1", "computeMsAvg": "248", "computeMsMax": "248", "computeRatioAvg": 0.17945007235890015, "computeRatioMax": 0.17945007235890015, "endMs": "1665776443678", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.01085383502170767, "readRatioMax": 0.01085383502170767, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "243", "startMs": "1665776443478", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01447178002894356, "writeRatioMax": 0.01447178002894356 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.008683068017366137, "computeRatioMax": 0.008683068017366137, "endMs": "1665776443537", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.005788712011577424, "readRatioMax": 0.005788712011577424, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776443495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01085383502170767, "writeRatioMax": 0.01085383502170767 }, { "completedParallelInputs": "1", "computeMsAvg": "152", "computeMsMax": "152", "computeRatioAvg": 0.10998552821997105, "computeRatioMax": 0.10998552821997105, "endMs": "1665776443682", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.013748191027496382, "readRatioMax": 0.013748191027496382, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "243", "startMs": "1665776443525", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01085383502170767, "writeRatioMax": 0.01085383502170767 }, { "completedParallelInputs": "6", "computeMsAvg": "1147", "computeMsMax": "1382", "computeRatioAvg": 0.8299565846599132, "computeRatioMax": 1, "endMs": "1665776444414", "id": "18", "inputStages": [ "0", "2" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "32", "readMsMax": "40", "readRatioAvg": 0.023154848046309694, "readRatioMax": 0.02894356005788712, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "8374", "startMs": "1665776443530", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage12_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "10", "writeMsMax": "13", "writeRatioAvg": 0.00723589001447178, "writeRatioMax": 0.009406657018813314 }, { "completedParallelInputs": "6", "computeMsAvg": "1042", "computeMsMax": "1276", "computeRatioAvg": 0.7539797395079595, "computeRatioMax": 0.9232995658465991, "endMs": "1665776444331", "id": "19", "inputStages": [ "6", "8" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "31", "readMsMax": "38", "readRatioAvg": 0.02243125904486252, "readRatioMax": 0.027496382054992764, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "5453", "startMs": "1665776443540", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage13_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "9", "writeMsMax": "22", "writeRatioAvg": 0.006512301013024602, "writeRatioMax": 0.015918958031837915 }, { "completedParallelInputs": "5", "computeMsAvg": "603", "computeMsMax": "673", "computeRatioAvg": 0.4363241678726483, "computeRatioMax": 0.4869753979739508, "endMs": "1665776443953", "id": "20", "inputStages": [ "5", "3" ], "name": "S14: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "29", "readRatioAvg": 0.01881331403762663, "readRatioMax": 0.020984081041968163, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "2773", "startMs": "1665776443556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage14_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "21", "writeMsMax": "22", "writeRatioAvg": 0.015195369030390739, "writeRatioMax": 0.015918958031837915 }, { "completedParallelInputs": "5", "computeMsAvg": "592", "computeMsMax": "783", "computeRatioAvg": 0.4283646888567294, "computeRatioMax": 0.5665701881331404, "endMs": "1665776444092", "id": "21", "inputStages": [ "11", "9" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "24", "readMsMax": "28", "readRatioAvg": 0.017366136034732273, "readRatioMax": 0.020260492040520984, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "2710", "startMs": "1665776443636", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "23", "writeMsMax": "30", "writeRatioAvg": 0.016642547033285094, "writeRatioMax": 0.02170767004341534 }, { "completedParallelInputs": "1", "computeMsAvg": "1211", "computeMsMax": "1211", "computeRatioAvg": 0.8762662807525325, "computeRatioMax": 0.8762662807525325, "endMs": "1665776444382", "id": "22", "inputStages": [ "12", "14" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.02604920405209841, "readRatioMax": 0.02604920405209841, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "1166", "startMs": "1665776443744", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.015195369030390739, "writeRatioMax": 0.015195369030390739 }, { "completedParallelInputs": "1", "computeMsAvg": "1150", "computeMsMax": "1150", "computeRatioAvg": 0.8321273516642547, "computeRatioMax": 0.8321273516642547, "endMs": "1665776444405", "id": "23", "inputStages": [ "15", "17" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "33", "readMsMax": "33", "readRatioAvg": 0.023878437047756874, "readRatioMax": 0.023878437047756874, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "803", "startMs": "1665776443760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001447178002894356, "waitRatioMax": 0.001447178002894356, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.015195369030390739, "writeRatioMax": 0.015195369030390739 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.02170767004341534, "computeRatioMax": 0.02170767004341534, "endMs": "1665776444609", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665776444568", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01447178002894356, "writeRatioMax": 0.01447178002894356 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.02532561505065123, "computeRatioMax": 0.02532561505065123, "endMs": "1665776444621", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665776444582", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.013024602026049204, "writeRatioMax": 0.013024602026049204 }, { "completedParallelInputs": "1", "computeMsAvg": "141", "computeMsMax": "141", "computeRatioAvg": 0.1020260492040521, "computeRatioMax": 0.1020260492040521, "endMs": "1665776444708", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665776444596", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01447178002894356, "writeRatioMax": 0.01447178002894356 }, { "completedParallelInputs": "1", "computeMsAvg": "204", "computeMsMax": "204", "computeRatioAvg": 0.1476121562952243, "computeRatioMax": 0.1476121562952243, "endMs": "1665776444739", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "281", "startMs": "1665776444611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage14_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01447178002894356, "writeRatioMax": 0.01447178002894356 }, { "completedParallelInputs": "1", "computeMsAvg": "410", "computeMsMax": "410", "computeRatioAvg": 0.29667149059334297, "computeRatioMax": 0.29667149059334297, "endMs": "1665776444873", "id": "29", "inputStages": [ "18" ], "name": "S1D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "467", "startMs": "1665776444640", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$280, $410", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000723589001447178, "waitRatioMax": 0.000723589001447178, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.015195369030390739, "writeRatioMax": 0.015195369030390739 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.006512301013024602, "computeRatioMax": 0.012301013024602027, "endMs": "1665776444956", "id": "30", "inputStages": [ "29" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "5362", "startMs": "1665776444899", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "7", "waitRatioAvg": 0.002894356005788712, "waitRatioMax": 0.005065123010130246, "writeMsAvg": "20", "writeMsMax": "32", "writeRatioAvg": 0.01447178002894356, "writeRatioMax": 0.023154848046309694 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.005788712011577424, "computeRatioMax": 0.01085383502170767, "endMs": "1665776444966", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "5011", "startMs": "1665776444898", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "8", "waitMsMax": "9", "waitRatioAvg": 0.005788712011577424, "waitRatioMax": 0.006512301013024602, "writeMsAvg": "7", "writeMsMax": "20", "writeRatioAvg": 0.005065123010130246, "writeRatioMax": 0.01447178002894356 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.005788712011577424, "computeRatioMax": 0.013024602026049204, "endMs": "1665776444960", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "3871", "startMs": "1665776444900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.006512301013024602, "waitRatioMax": 0.007959479015918957, "writeMsAvg": "11", "writeMsMax": "27", "writeRatioAvg": 0.007959479015918957, "writeRatioMax": 0.019536903039073805 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.005065123010130246, "computeRatioMax": 0.011577424023154847, "endMs": "1665776444956", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "3139", "startMs": "1665776444899", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.006512301013024602, "waitRatioMax": 0.007959479015918957, "writeMsAvg": "4", "writeMsMax": "27", "writeRatioAvg": 0.002894356005788712, "writeRatioMax": 0.019536903039073805 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.005065123010130246, "computeRatioMax": 0.010130246020260492, "endMs": "1665776444959", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "2362", "startMs": "1665776444899", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "10", "waitMsMax": "11", "waitRatioAvg": 0.00723589001447178, "waitRatioMax": 0.007959479015918957, "writeMsAvg": "3", "writeMsMax": "18", "writeRatioAvg": 0.002170767004341534, "writeRatioMax": 0.013024602026049204 }, { "completedParallelInputs": "1", "computeMsAvg": "408", "computeMsMax": "408", "computeRatioAvg": 0.2952243125904486, "computeRatioMax": 0.2952243125904486, "endMs": "1665776445207", "id": "35", "inputStages": [ "34", "31", "33", "30", "32", "19" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "316129", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "540", "startMs": "1665776444924", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$280, $410", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240, $480 := $410, $481 := $280", "INNER HASH JOIN EACH WITH ALL ON $470 = $410" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.010130246020260492, "waitRatioMax": 0.010130246020260492, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.001447178002894356, "writeRatioMax": 0.001447178002894356 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.005065123010130246, "computeRatioMax": 0.005065123010130246, "endMs": "1665776445283", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "472", "startMs": "1665776444925", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.005788712011577424, "waitRatioMax": 0.005788712011577424, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.002894356005788712, "writeRatioMax": 0.002894356005788712 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "23", "completedUnits": "12", "elapsedMs": "654", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "4311" }, { "activeUnits": "12", "completedUnits": "40", "elapsedMs": "1704", "estimatedRunnableUnits": "5", "pendingUnits": "2", "totalSlotMs": "25500" }, { "activeUnits": "2", "completedUnits": "543", "elapsedMs": "2274", "estimatedRunnableUnits": "5", "pendingUnits": "0", "totalSlotMs": "46174" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "46174", "transferredBytes": "0" }, "startTime": "1665776443102", "totalBytesProcessed": "401794978", "totalSlotMs": "46174" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncf5766b4_08f3_453f_8e79_3940aa1c09a4" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "EiqniatIL2daQ3ZETOKYpA==", "id": "test-project-364309:europe-west1.query04_1665776447", "jobReference": { "jobId": "query04_1665776447", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776447?location=europe-west1", "statistics": { "creationTime": "1665776448066", "endTime": "1665776450571", "finalExecutionDurationMs": "2207", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2033" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0047169811320754715, "computeRatioMax": 0.0047169811320754715, "endMs": "1665776448320", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003930817610062893, "readRatioMax": 0.003930817610062893, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776448282", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.009433962264150943, "writeRatioMax": 0.009433962264150943 }, { "completedParallelInputs": "1", "computeMsAvg": "223", "computeMsMax": "223", "computeRatioAvg": 0.17531446540880502, "computeRatioMax": 0.17531446540880502, "endMs": "1665776448530", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.018081761006289308, "readRatioMax": 0.018081761006289308, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "337", "startMs": "1665776448310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01179245283018868, "writeRatioMax": 0.01179245283018868 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006289308176100629, "computeRatioMax": 0.006289308176100629, "endMs": "1665776448360", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003930817610062893, "readRatioMax": 0.003930817610062893, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776448325", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0110062893081761, "writeRatioMax": 0.0110062893081761 }, { "completedParallelInputs": "1", "computeMsAvg": "152", "computeMsMax": "152", "computeRatioAvg": 0.11949685534591195, "computeRatioMax": 0.11949685534591195, "endMs": "1665776448499", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.009433962264150943, "readRatioMax": 0.009433962264150943, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "209", "startMs": "1665776448353", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.012578616352201259, "writeRatioMax": 0.012578616352201259 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.010220125786163521, "computeRatioMax": 0.010220125786163521, "endMs": "1665776448403", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0047169811320754715, "readRatioMax": 0.0047169811320754715, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665776448373", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0047169811320754715, "writeRatioMax": 0.0047169811320754715 }, { "completedParallelInputs": "1", "computeMsAvg": "251", "computeMsMax": "251", "computeRatioAvg": 0.19732704402515724, "computeRatioMax": 0.19732704402515724, "endMs": "1665776448550", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.009433962264150943, "readRatioMax": 0.009433962264150943, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "366", "startMs": "1665776448404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.008647798742138365, "writeRatioMax": 0.008647798742138365 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007075471698113208, "computeRatioMax": 0.007075471698113208, "endMs": "1665776448467", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003930817610062893, "readRatioMax": 0.003930817610062893, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776448421", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0110062893081761, "writeRatioMax": 0.0110062893081761 }, { "completedParallelInputs": "1", "computeMsAvg": "182", "computeMsMax": "182", "computeRatioAvg": 0.1430817610062893, "computeRatioMax": 0.1430817610062893, "endMs": "1665776448629", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.010220125786163521, "readRatioMax": 0.010220125786163521, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "252", "startMs": "1665776448448", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0023584905660377358, "waitRatioMax": 0.0023584905660377358, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.01179245283018868, "writeRatioMax": 0.01179245283018868 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.007861635220125786, "computeRatioMax": 0.007861635220125786, "endMs": "1665776448524", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003930817610062893, "readRatioMax": 0.003930817610062893, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665776448468", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0031446540880503146, "waitRatioMax": 0.0031446540880503146, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.012578616352201259, "writeRatioMax": 0.012578616352201259 }, { "completedParallelInputs": "1", "computeMsAvg": "162", "computeMsMax": "162", "computeRatioAvg": 0.12735849056603774, "computeRatioMax": 0.12735849056603774, "endMs": "1665776448658", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.0110062893081761, "readRatioMax": 0.0110062893081761, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "220", "startMs": "1665776448509", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0023584905660377358, "waitRatioMax": 0.0023584905660377358, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0110062893081761, "writeRatioMax": 0.0110062893081761 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.007861635220125786, "computeRatioMax": 0.007861635220125786, "endMs": "1665776448566", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.007075471698113208, "readRatioMax": 0.007075471698113208, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776448529", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.007075471698113208, "writeRatioMax": 0.007075471698113208 }, { "completedParallelInputs": "1", "computeMsAvg": "208", "computeMsMax": "208", "computeRatioAvg": 0.16352201257861634, "computeRatioMax": 0.16352201257861634, "endMs": "1665776448746", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.013364779874213837, "readRatioMax": 0.013364779874213837, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "334", "startMs": "1665776448556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01650943396226415, "writeRatioMax": 0.01650943396226415 }, { "completedParallelInputs": "5", "computeMsAvg": "679", "computeMsMax": "840", "computeRatioAvg": 0.5338050314465409, "computeRatioMax": 0.660377358490566, "endMs": "1665776449158", "id": "18", "inputStages": [ "3", "5" ], "name": "S12: Join+", "parallelInputs": "5", "readMsAvg": "31", "readMsMax": "41", "readRatioAvg": 0.02437106918238994, "readRatioMax": 0.03223270440251572, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "3783", "startMs": "1665776448571", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage12_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "23", "writeMsMax": "24", "writeRatioAvg": 0.018081761006289308, "writeRatioMax": 0.018867924528301886 }, { "completedParallelInputs": "6", "computeMsAvg": "1053", "computeMsMax": "1228", "computeRatioAvg": 0.8278301886792453, "computeRatioMax": 0.9654088050314465, "endMs": "1665776449306", "id": "19", "inputStages": [ "2", "0" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "36", "readMsMax": "50", "readRatioAvg": 0.02830188679245283, "readRatioMax": 0.03930817610062893, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "7123", "startMs": "1665776448576", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage13_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "9", "writeMsMax": "11", "writeRatioAvg": 0.007075471698113208, "writeRatioMax": 0.008647798742138365 }, { "completedParallelInputs": "6", "computeMsAvg": "1066", "computeMsMax": "1272", "computeRatioAvg": 0.8380503144654088, "computeRatioMax": 1, "endMs": "1665776449414", "id": "20", "inputStages": [ "8", "6" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "36", "readRatioAvg": 0.0220125786163522, "readRatioMax": 0.02830188679245283, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "6102", "startMs": "1665776448598", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage14_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.00550314465408805, "writeRatioMax": 0.006289308176100629 }, { "completedParallelInputs": "5", "computeMsAvg": "668", "computeMsMax": "772", "computeRatioAvg": 0.5251572327044025, "computeRatioMax": 0.6069182389937107, "endMs": "1665776449124", "id": "21", "inputStages": [ "11", "9" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "23", "readMsMax": "29", "readRatioAvg": 0.018081761006289308, "readRatioMax": 0.02279874213836478, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3493", "startMs": "1665776448673", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "21", "writeMsMax": "23", "writeRatioAvg": 0.01650943396226415, "writeRatioMax": 0.018081761006289308 }, { "completedParallelInputs": "1", "computeMsAvg": "849", "computeMsMax": "849", "computeRatioAvg": 0.6674528301886793, "computeRatioMax": 0.6674528301886793, "endMs": "1665776449264", "id": "22", "inputStages": [ "14", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "32", "readMsMax": "32", "readRatioAvg": 0.025157232704402517, "readRatioMax": 0.025157232704402517, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "847", "startMs": "1665776448686", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.014150943396226415, "writeRatioMax": 0.014150943396226415 }, { "completedParallelInputs": "1", "computeMsAvg": "916", "computeMsMax": "916", "computeRatioAvg": 0.720125786163522, "computeRatioMax": 0.720125786163522, "endMs": "1665776449333", "id": "23", "inputStages": [ "17", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "34", "readMsMax": "34", "readRatioAvg": 0.026729559748427674, "readRatioMax": 0.026729559748427674, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "889", "startMs": "1665776448814", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.014150943396226415, "writeRatioMax": 0.014150943396226415 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.018081761006289308, "computeRatioMax": 0.018081761006289308, "endMs": "1665776449511", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776449474", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.014937106918238994, "writeRatioMax": 0.014937106918238994 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.029874213836477988, "computeRatioMax": 0.029874213836477988, "endMs": "1665776449531", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665776449489", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.014937106918238994, "writeRatioMax": 0.014937106918238994 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.08569182389937106, "computeRatioMax": 0.08569182389937106, "endMs": "1665776449587", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "116", "startMs": "1665776449506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007861635220125787, "waitRatioMax": 0.0007861635220125787, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.014150943396226415, "writeRatioMax": 0.014150943396226415 }, { "completedParallelInputs": "1", "computeMsAvg": "223", "computeMsMax": "223", "computeRatioAvg": 0.17531446540880502, "computeRatioMax": 0.17531446540880502, "endMs": "1665776449658", "id": "27", "inputStages": [ "18" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "210", "startMs": "1665776449523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.014150943396226415, "writeRatioMax": 0.014150943396226415 }, { "completedParallelInputs": "1", "computeMsAvg": "359", "computeMsMax": "359", "computeRatioAvg": 0.28223270440251574, "computeRatioMax": 0.28223270440251574, "endMs": "1665776449778", "id": "28", "inputStages": [ "20" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2768741", "shuffleOutputBytesSpilled": "0", "slotMs": "356", "startMs": "1665776449541", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$240, $470, $471, $472, $474", "TO __stage1C_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0031446540880503146, "waitRatioMax": 0.0031446540880503146, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01650943396226415, "writeRatioMax": 0.01650943396226415 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.007075471698113208, "computeRatioMax": 0.01729559748427673, "endMs": "1665776449861", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2768741", "shuffleOutputBytesSpilled": "0", "slotMs": "4546", "startMs": "1665776449796", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0031446540880503146, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.0110062893081761, "writeRatioMax": 0.015723270440251572 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.006289308176100629, "computeRatioMax": 0.014937106918238994, "endMs": "1665776449860", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "4225", "startMs": "1665776449797", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.0031446540880503146, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.0110062893081761, "writeRatioMax": 0.014937106918238994 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.006289308176100629, "computeRatioMax": 0.014150943396226415, "endMs": "1665776449851", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "3714", "startMs": "1665776449798", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.003930817610062893, "waitRatioMax": 0.0047169811320754715, "writeMsAvg": "10", "writeMsMax": "23", "writeRatioAvg": 0.007861635220125786, "writeRatioMax": 0.018081761006289308 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.006289308176100629, "computeRatioMax": 0.014150943396226415, "endMs": "1665776449851", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "3631", "startMs": "1665776449799", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.00550314465408805, "writeMsAvg": "5", "writeMsMax": "18", "writeRatioAvg": 0.003930817610062893, "writeRatioMax": 0.014150943396226415 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "23", "computeRatioAvg": 0.006289308176100629, "computeRatioMax": 0.018081761006289308, "endMs": "1665776449852", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3768", "startMs": "1665776449801", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.0047169811320754715, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "6", "writeMsMax": "17", "writeRatioAvg": 0.0047169811320754715, "writeRatioMax": 0.013364779874213837 }, { "completedParallelInputs": "1", "computeMsAvg": "622", "computeMsMax": "622", "computeRatioAvg": 0.4889937106918239, "computeRatioMax": 0.4889937106918239, "endMs": "1665776450284", "id": "35", "inputStages": [ "30", "31", "33", "34", "19", "32" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "314993", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "688", "startMs": "1665776449814", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$240, $470, $471, $472, $474", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$480 := $410, $481 := $280, $482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240", "INNER HASH JOIN EACH WITH ALL ON $410 = $470" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.00550314465408805, "waitRatioMax": 0.00550314465408805, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0015723270440251573, "writeRatioMax": 0.0015723270440251573 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0047169811320754715, "computeRatioMax": 0.0047169811320754715, "endMs": "1665776450342", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "586", "startMs": "1665776449821", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015723270440251573, "waitRatioMax": 0.0015723270440251573, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0031446540880503146, "writeRatioMax": 0.0031446540880503146 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "12", "elapsedMs": "646", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "5154" }, { "activeUnits": "355", "completedUnits": "539", "elapsedMs": "1716", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "47167" }, { "activeUnits": "0", "completedUnits": "543", "elapsedMs": "2379", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "48533" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "48533", "transferredBytes": "0" }, "startTime": "1665776448139", "totalBytesProcessed": "401794978", "totalSlotMs": "48533" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anondc351621_b36e_4e88_8b0a_9d2cb2afe384" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "0ag7SILmqChC4mute/vjHg==", "id": "test-project-364309:europe-west1.query04_1665776452", "jobReference": { "jobId": "query04_1665776452", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776452?location=europe-west1", "statistics": { "creationTime": "1665776453298", "endTime": "1665776455706", "finalExecutionDurationMs": "2100", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2043" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.006644518272425249, "computeRatioMax": 0.006644518272425249, "endMs": "1665776453562", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.003986710963455149, "readRatioMax": 0.003986710963455149, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776453526", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.007973421926910298, "writeRatioMax": 0.007973421926910298 }, { "completedParallelInputs": "1", "computeMsAvg": "258", "computeMsMax": "258", "computeRatioAvg": 0.17142857142857143, "computeRatioMax": 0.17142857142857143, "endMs": "1665776453741", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.009966777408637873, "readRatioMax": 0.009966777408637873, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "251", "startMs": "1665776453554", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00132890365448505, "waitRatioMax": 0.00132890365448505, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0106312292358804, "writeRatioMax": 0.0106312292358804 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.008637873754152824, "computeRatioMax": 0.008637873754152824, "endMs": "1665776453607", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.003986710963455149, "readRatioMax": 0.003986710963455149, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665776453570", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.007973421926910298, "writeRatioMax": 0.007973421926910298 }, { "completedParallelInputs": "1", "computeMsAvg": "218", "computeMsMax": "218", "computeRatioAvg": 0.14485049833887043, "computeRatioMax": 0.14485049833887043, "endMs": "1665776453771", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.011960132890365448, "readRatioMax": 0.011960132890365448, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "252", "startMs": "1665776453599", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.009966777408637873, "writeRatioMax": 0.009966777408637873 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.007973421926910298, "computeRatioMax": 0.007973421926910298, "endMs": "1665776453647", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.003986710963455149, "readRatioMax": 0.003986710963455149, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776453613", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0053156146179402, "writeRatioMax": 0.0053156146179402 }, { "completedParallelInputs": "1", "computeMsAvg": "153", "computeMsMax": "153", "computeRatioAvg": 0.10166112956810631, "computeRatioMax": 0.10166112956810631, "endMs": "1665776453807", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.007973421926910298, "readRatioMax": 0.007973421926910298, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "218", "startMs": "1665776453644", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00132890365448505, "waitRatioMax": 0.00132890365448505, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.008637873754152824, "writeRatioMax": 0.008637873754152824 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.005980066445182724, "computeRatioMax": 0.005980066445182724, "endMs": "1665776453695", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004651162790697674, "readRatioMax": 0.004651162790697674, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776453662", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.012624584717607974, "writeRatioMax": 0.012624584717607974 }, { "completedParallelInputs": "1", "computeMsAvg": "223", "computeMsMax": "223", "computeRatioAvg": 0.14817275747508304, "computeRatioMax": 0.14817275747508304, "endMs": "1665776453900", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.011960132890365448, "readRatioMax": 0.011960132890365448, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "330", "startMs": "1665776453689", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00132890365448505, "waitRatioMax": 0.00132890365448505, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0106312292358804, "writeRatioMax": 0.0106312292358804 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.003986710963455149, "computeRatioMax": 0.003986710963455149, "endMs": "1665776453741", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0033222591362126247, "readRatioMax": 0.0033222591362126247, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776453704", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.01727574750830565, "writeRatioMax": 0.01727574750830565 }, { "completedParallelInputs": "1", "computeMsAvg": "267", "computeMsMax": "267", "computeRatioAvg": 0.17740863787375416, "computeRatioMax": 0.17740863787375416, "endMs": "1665776453910", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.0106312292358804, "readRatioMax": 0.0106312292358804, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "318", "startMs": "1665776453727", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.011295681063122924, "writeRatioMax": 0.011295681063122924 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.005980066445182724, "computeRatioMax": 0.005980066445182724, "endMs": "1665776453778", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.006644518272425249, "readRatioMax": 0.006644518272425249, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776453742", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.003986710963455149, "writeRatioMax": 0.003986710963455149 }, { "completedParallelInputs": "1", "computeMsAvg": "221", "computeMsMax": "221", "computeRatioAvg": 0.146843853820598, "computeRatioMax": 0.146843853820598, "endMs": "1665776453948", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.007308970099667774, "readRatioMax": 0.007308970099667774, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "216", "startMs": "1665776453765", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.006644518272425249, "writeRatioMax": 0.006644518272425249 }, { "completedParallelInputs": "6", "computeMsAvg": "1061", "computeMsMax": "1220", "computeRatioAvg": 0.704983388704319, "computeRatioMax": 0.8106312292358804, "endMs": "1665776454474", "id": "18", "inputStages": [ "2", "0" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "31", "readMsMax": "39", "readRatioAvg": 0.020598006644518274, "readRatioMax": 0.025913621262458473, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "6198", "startMs": "1665776453771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage12_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00132890365448505, "waitRatioMax": 0.0019933554817275745, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.004651162790697674, "writeRatioMax": 0.0053156146179402 }, { "completedParallelInputs": "5", "computeMsAvg": "762", "computeMsMax": "874", "computeRatioAvg": 0.506312292358804, "computeRatioMax": 0.5807308970099668, "endMs": "1665776454428", "id": "19", "inputStages": [ "5", "3" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "29", "readMsMax": "48", "readRatioAvg": 0.019269102990033222, "readRatioMax": 0.03189368770764119, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "4123", "startMs": "1665776453802", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage13_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.00132890365448505, "writeMsAvg": "24", "writeMsMax": "32", "writeRatioAvg": 0.015946843853820596, "writeRatioMax": 0.0212624584717608 }, { "completedParallelInputs": "6", "computeMsAvg": "1058", "computeMsMax": "1505", "computeRatioAvg": 0.7029900332225913, "computeRatioMax": 1, "endMs": "1665776454639", "id": "20", "inputStages": [ "6", "8" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "27", "readMsMax": "33", "readRatioAvg": 0.017940199335548173, "readRatioMax": 0.021926910299003323, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "6005", "startMs": "1665776453853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage14_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.004651162790697674, "writeRatioMax": 0.0053156146179402 }, { "completedParallelInputs": "5", "computeMsAvg": "642", "computeMsMax": "854", "computeRatioAvg": 0.42657807308970097, "computeRatioMax": 0.5674418604651162, "endMs": "1665776454531", "id": "21", "inputStages": [ "11", "9" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "24", "readMsMax": "29", "readRatioAvg": 0.015946843853820596, "readRatioMax": 0.019269102990033222, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3352", "startMs": "1665776453958", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.00132890365448505, "writeMsAvg": "21", "writeMsMax": "23", "writeRatioAvg": 0.013953488372093023, "writeRatioMax": 0.015282392026578074 }, { "completedParallelInputs": "1", "computeMsAvg": "1225", "computeMsMax": "1225", "computeRatioAvg": 0.813953488372093, "computeRatioMax": 0.813953488372093, "endMs": "1665776454713", "id": "22", "inputStages": [ "14", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "49", "readMsMax": "49", "readRatioAvg": 0.03255813953488372, "readRatioMax": 0.03255813953488372, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "1203", "startMs": "1665776453974", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.014617940199335547, "writeRatioMax": 0.014617940199335547 }, { "completedParallelInputs": "1", "computeMsAvg": "812", "computeMsMax": "812", "computeRatioAvg": 0.5395348837209303, "computeRatioMax": 0.5395348837209303, "endMs": "1665776454557", "id": "23", "inputStages": [ "17", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "52", "readMsMax": "52", "readRatioAvg": 0.0345514950166113, "readRatioMax": 0.0345514950166113, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "872", "startMs": "1665776453990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00132890365448505, "waitRatioMax": 0.00132890365448505, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.015946843853820596, "writeRatioMax": 0.015946843853820596 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.019269102990033222, "computeRatioMax": 0.019269102990033222, "endMs": "1665776454864", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776454816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.012624584717607974, "writeRatioMax": 0.012624584717607974 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.0212624584717608, "computeRatioMax": 0.0212624584717608, "endMs": "1665776454877", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776454835", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00132890365448505, "waitRatioMax": 0.00132890365448505, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.013289036544850499, "writeRatioMax": 0.013289036544850499 }, { "completedParallelInputs": "1", "computeMsAvg": "198", "computeMsMax": "198", "computeRatioAvg": 0.13156146179401992, "computeRatioMax": 0.13156146179401992, "endMs": "1665776454969", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "216", "startMs": "1665776454849", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.013289036544850499, "writeRatioMax": 0.013289036544850499 }, { "completedParallelInputs": "1", "computeMsAvg": "150", "computeMsMax": "150", "computeRatioAvg": 0.09966777408637874, "computeRatioMax": 0.09966777408637874, "endMs": "1665776454967", "id": "27", "inputStages": [ "19" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "145", "startMs": "1665776454861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage13_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.013289036544850499, "writeRatioMax": 0.013289036544850499 }, { "completedParallelInputs": "1", "computeMsAvg": "406", "computeMsMax": "406", "computeRatioAvg": 0.26976744186046514, "computeRatioMax": 0.26976744186046514, "endMs": "1665776455107", "id": "29", "inputStages": [ "18" ], "name": "S1D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "273", "startMs": "1665776454889", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$280, $410", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000664451827242525, "waitRatioMax": 0.000664451827242525, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.013289036544850499, "writeRatioMax": 0.013289036544850499 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.0053156146179402, "computeRatioMax": 0.009966777408637873, "endMs": "1665776455228", "id": "30", "inputStages": [ "29" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "4403", "startMs": "1665776455145", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "10", "waitRatioAvg": 0.0033222591362126247, "waitRatioMax": 0.006644518272425249, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.009966777408637873, "writeRatioMax": 0.020598006644518274 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "22", "computeRatioAvg": 0.0053156146179402, "computeRatioMax": 0.014617940199335547, "endMs": "1665776455226", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "3547", "startMs": "1665776455146", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.006644518272425249, "waitRatioMax": 0.007973421926910298, "writeMsAvg": "11", "writeMsMax": "29", "writeRatioAvg": 0.007308970099667774, "writeRatioMax": 0.019269102990033222 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0053156146179402, "computeRatioMax": 0.0106312292358804, "endMs": "1665776455215", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "2375", "startMs": "1665776455147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "11", "waitMsMax": "13", "waitRatioAvg": 0.007308970099667774, "waitRatioMax": 0.008637873754152824, "writeMsAvg": "3", "writeMsMax": "17", "writeRatioAvg": 0.0019933554817275745, "writeRatioMax": 0.011295681063122924 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.004651162790697674, "computeRatioMax": 0.0106312292358804, "endMs": "1665776455216", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "1856", "startMs": "1665776455147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "12", "waitMsMax": "13", "waitRatioAvg": 0.007973421926910298, "waitRatioMax": 0.008637873754152824, "writeMsAvg": "3", "writeMsMax": "30", "writeRatioAvg": 0.0019933554817275745, "writeRatioMax": 0.019933554817275746 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.004651162790697674, "computeRatioMax": 0.009302325581395349, "endMs": "1665776455217", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "1937", "startMs": "1665776455149", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "12", "waitMsMax": "14", "waitRatioAvg": 0.007973421926910298, "waitRatioMax": 0.009302325581395349, "writeMsAvg": "2", "writeMsMax": "19", "writeRatioAvg": 0.00132890365448505, "writeRatioMax": 0.012624584717607974 }, { "completedParallelInputs": "1", "computeMsAvg": "534", "computeMsMax": "534", "computeRatioAvg": 0.3548172757475083, "computeRatioMax": 0.3548172757475083, "endMs": "1665776455503", "id": "35", "inputStages": [ "34", "32", "33", "31", "20", "30" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "316129", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "475", "startMs": "1665776455183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$280, $410", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240, $480 := $410, $481 := $280", "INNER HASH JOIN EACH WITH ALL ON $470 = $410" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.008637873754152824, "waitRatioMax": 0.008637873754152824, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.000664451827242525, "writeRatioMax": 0.000664451827242525 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.0026578073089701, "computeRatioMax": 0.0026578073089701, "endMs": "1665776455518", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "283", "startMs": "1665776455183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00132890365448505, "waitRatioMax": 0.00132890365448505, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0019933554817275745, "writeRatioMax": 0.0019933554817275745 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "12", "elapsedMs": "673", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "5735" }, { "activeUnits": "3", "completedUnits": "41", "elapsedMs": "2265", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "26213" }, { "completedUnits": "543", "elapsedMs": "2293", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "41179" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "41179", "transferredBytes": "0" }, "startTime": "1665776453355", "totalBytesProcessed": "401794978", "totalSlotMs": "41179" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone0087289_1241_4d56_a964_33dd507588b8" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Y9TVroQXBCwYUCDlEH3Blg==", "id": "test-project-364309:europe-west1.query04_1665776456", "jobReference": { "jobId": "query04_1665776456", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776456?location=europe-west1", "statistics": { "creationTime": "1665776457543", "endTime": "1665776459735", "finalExecutionDurationMs": "1930", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2046" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.015988372093023256, "computeRatioMax": 0.015988372093023256, "endMs": "1665776457769", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.010901162790697675, "readRatioMax": 0.010901162790697675, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776457728", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.007267441860465116, "writeRatioMax": 0.007267441860465116 }, { "completedParallelInputs": "1", "computeMsAvg": "181", "computeMsMax": "181", "computeRatioAvg": 0.13154069767441862, "computeRatioMax": 0.13154069767441862, "endMs": "1665776457919", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.014534883720930232, "readRatioMax": 0.014534883720930232, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "190", "startMs": "1665776457760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010901162790697675, "writeRatioMax": 0.010901162790697675 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.005813953488372093, "computeRatioMax": 0.005813953488372093, "endMs": "1665776457814", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.003633720930232558, "readRatioMax": 0.003633720930232558, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776457774", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.011627906976744186, "writeRatioMax": 0.011627906976744186 }, { "completedParallelInputs": "1", "computeMsAvg": "223", "computeMsMax": "223", "computeRatioAvg": 0.1620639534883721, "computeRatioMax": 0.1620639534883721, "endMs": "1665776458013", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "25", "readMsMax": "25", "readRatioAvg": 0.018168604651162792, "readRatioMax": 0.018168604651162792, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "227", "startMs": "1665776457803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.014534883720930232, "writeRatioMax": 0.014534883720930232 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.00872093023255814, "computeRatioMax": 0.00872093023255814, "endMs": "1665776457863", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.00944767441860465, "readRatioMax": 0.00944767441860465, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776457819", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.007267441860465116, "writeRatioMax": 0.007267441860465116 }, { "completedParallelInputs": "1", "computeMsAvg": "230", "computeMsMax": "230", "computeRatioAvg": 0.16715116279069767, "computeRatioMax": 0.16715116279069767, "endMs": "1665776458058", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.013808139534883721, "readRatioMax": 0.013808139534883721, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "295", "startMs": "1665776457849", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010901162790697675, "writeRatioMax": 0.010901162790697675 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.005813953488372093, "computeRatioMax": 0.005813953488372093, "endMs": "1665776457899", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.006540697674418605, "readRatioMax": 0.006540697674418605, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776457868", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.010174418604651164, "writeRatioMax": 0.010174418604651164 }, { "completedParallelInputs": "1", "computeMsAvg": "234", "computeMsMax": "234", "computeRatioAvg": 0.17005813953488372, "computeRatioMax": 0.17005813953488372, "endMs": "1665776458035", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.00944767441860465, "readRatioMax": 0.00944767441860465, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "240", "startMs": "1665776457898", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.00872093023255814, "writeRatioMax": 0.00872093023255814 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007994186046511628, "computeRatioMax": 0.007994186046511628, "endMs": "1665776457955", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00436046511627907, "readRatioMax": 0.00436046511627907, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776457913", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010901162790697675, "writeRatioMax": 0.010901162790697675 }, { "completedParallelInputs": "1", "computeMsAvg": "242", "computeMsMax": "242", "computeRatioAvg": 0.17587209302325582, "computeRatioMax": 0.17587209302325582, "endMs": "1665776458153", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "26", "readMsMax": "26", "readRatioAvg": 0.0188953488372093, "readRatioMax": 0.0188953488372093, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "311", "startMs": "1665776457941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.015988372093023256, "writeRatioMax": 0.015988372093023256 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007994186046511628, "computeRatioMax": 0.007994186046511628, "endMs": "1665776458000", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00436046511627907, "readRatioMax": 0.00436046511627907, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776457956", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.012354651162790697, "writeRatioMax": 0.012354651162790697 }, { "completedParallelInputs": "1", "computeMsAvg": "200", "computeMsMax": "200", "computeRatioAvg": 0.14534883720930233, "computeRatioMax": 0.14534883720930233, "endMs": "1665776458157", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.010174418604651164, "readRatioMax": 0.010174418604651164, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "261", "startMs": "1665776457986", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.015988372093023256, "writeRatioMax": 0.015988372093023256 }, { "completedParallelInputs": "6", "computeMsAvg": "946", "computeMsMax": "1237", "computeRatioAvg": 0.6875, "computeRatioMax": 0.8989825581395349, "endMs": "1665776458633", "id": "18", "inputStages": [ "0", "2" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "32", "readMsMax": "40", "readRatioAvg": 0.023255813953488372, "readRatioMax": 0.029069767441860465, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "5263", "startMs": "1665776457993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage12_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "10", "writeMsMax": "19", "writeRatioAvg": 0.007267441860465116, "writeRatioMax": 0.013808139534883721 }, { "completedParallelInputs": "5", "computeMsAvg": "687", "computeMsMax": "797", "computeRatioAvg": 0.4992732558139535, "computeRatioMax": 0.5792151162790697, "endMs": "1665776458586", "id": "19", "inputStages": [ "3", "5" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "27", "readMsMax": "37", "readRatioAvg": 0.019622093023255814, "readRatioMax": 0.02688953488372093, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "3303", "startMs": "1665776458031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage13_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "25", "writeMsMax": "36", "writeRatioAvg": 0.018168604651162792, "writeRatioMax": 0.02616279069767442 }, { "completedParallelInputs": "5", "computeMsAvg": "704", "computeMsMax": "772", "computeRatioAvg": 0.5116279069767442, "computeRatioMax": 0.561046511627907, "endMs": "1665776458538", "id": "20", "inputStages": [ "11", "9" ], "name": "S14: Join+", "parallelInputs": "5", "readMsAvg": "27", "readMsMax": "30", "readRatioAvg": 0.019622093023255814, "readRatioMax": 0.02180232558139535, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3245", "startMs": "1665776458057", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage14_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "22", "writeMsMax": "24", "writeRatioAvg": 0.015988372093023256, "writeRatioMax": 0.01744186046511628 }, { "completedParallelInputs": "6", "computeMsAvg": "942", "computeMsMax": "1179", "computeRatioAvg": 0.684593023255814, "computeRatioMax": 0.8568313953488372, "endMs": "1665776458856", "id": "21", "inputStages": [ "8", "6" ], "name": "S15: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "34", "readRatioAvg": 0.020348837209302327, "readRatioMax": 0.024709302325581394, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "5603", "startMs": "1665776458092", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage15_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.005087209302325582, "writeRatioMax": 0.006540697674418605 }, { "completedParallelInputs": "1", "computeMsAvg": "1376", "computeMsMax": "1376", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776458927", "id": "22", "inputStages": [ "12", "14" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.02616279069767442, "readRatioMax": 0.02616279069767442, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "1236", "startMs": "1665776458205", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.014534883720930232, "writeRatioMax": 0.014534883720930232 }, { "completedParallelInputs": "1", "computeMsAvg": "1301", "computeMsMax": "1301", "computeRatioAvg": 0.9454941860465116, "computeRatioMax": 0.9454941860465116, "endMs": "1665776458910", "id": "23", "inputStages": [ "17", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "38", "readMsMax": "38", "readRatioAvg": 0.027616279069767442, "readRatioMax": 0.027616279069767442, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "1292", "startMs": "1665776458225", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.015988372093023256, "writeRatioMax": 0.015988372093023256 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.02252906976744186, "computeRatioMax": 0.02252906976744186, "endMs": "1665776459118", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665776459059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.015261627906976744, "writeRatioMax": 0.015261627906976744 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.023255813953488372, "computeRatioMax": 0.023255813953488372, "endMs": "1665776459131", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665776459074", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.01744186046511628, "writeRatioMax": 0.01744186046511628 }, { "completedParallelInputs": "1", "computeMsAvg": "115", "computeMsMax": "115", "computeRatioAvg": 0.08357558139534883, "computeRatioMax": 0.08357558139534883, "endMs": "1665776459202", "id": "26", "inputStages": [ "20" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "131", "startMs": "1665776459103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014534883720930232, "waitRatioMax": 0.0014534883720930232, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.013808139534883721, "writeRatioMax": 0.013808139534883721 }, { "completedParallelInputs": "1", "computeMsAvg": "119", "computeMsMax": "119", "computeRatioAvg": 0.08648255813953488, "computeRatioMax": 0.08648255813953488, "endMs": "1665776459208", "id": "27", "inputStages": [ "19" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "131", "startMs": "1665776459117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage13_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.015261627906976744, "writeRatioMax": 0.015261627906976744 }, { "completedParallelInputs": "1", "computeMsAvg": "263", "computeMsMax": "263", "computeRatioAvg": 0.19113372093023256, "computeRatioMax": 0.19113372093023256, "endMs": "1665776459316", "id": "29", "inputStages": [ "18" ], "name": "S1D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "273", "startMs": "1665776459149", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$280, $410", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007267441860465116, "waitRatioMax": 0.0007267441860465116, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.016715116279069766, "writeRatioMax": 0.016715116279069766 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.006540697674418605, "computeRatioMax": 0.012354651162790697, "endMs": "1665776459403", "id": "30", "inputStages": [ "29" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "4857", "startMs": "1665776459344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.002180232558139535, "waitRatioMax": 0.005087209302325582, "writeMsAvg": "18", "writeMsMax": "32", "writeRatioAvg": 0.01308139534883721, "writeRatioMax": 0.023255813953488372 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.005813953488372093, "computeRatioMax": 0.01308139534883721, "endMs": "1665776459405", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "4322", "startMs": "1665776459344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.005087209302325582, "waitRatioMax": 0.005813953488372093, "writeMsAvg": "16", "writeMsMax": "50", "writeRatioAvg": 0.011627906976744186, "writeRatioMax": 0.036337209302325583 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.005813953488372093, "computeRatioMax": 0.013808139534883721, "endMs": "1665776459406", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "3545", "startMs": "1665776459345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "8", "waitMsMax": "9", "waitRatioAvg": 0.005813953488372093, "waitRatioMax": 0.006540697674418605, "writeMsAvg": "10", "writeMsMax": "31", "writeRatioAvg": 0.007267441860465116, "writeRatioMax": 0.02252906976744186 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.005813953488372093, "computeRatioMax": 0.015261627906976744, "endMs": "1665776459405", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "3510", "startMs": "1665776459345", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.006540697674418605, "waitRatioMax": 0.007994186046511628, "writeMsAvg": "7", "writeMsMax": "52", "writeRatioAvg": 0.005087209302325582, "writeRatioMax": 0.0377906976744186 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "23", "computeRatioAvg": 0.005813953488372093, "computeRatioMax": 0.016715116279069766, "endMs": "1665776459416", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3445", "startMs": "1665776459346", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.007267441860465116, "waitRatioMax": 0.00872093023255814, "writeMsAvg": "5", "writeMsMax": "29", "writeRatioAvg": 0.003633720930232558, "writeRatioMax": 0.021075581395348836 }, { "completedParallelInputs": "1", "computeMsAvg": "379", "computeMsMax": "379", "computeRatioAvg": 0.2754360465116279, "computeRatioMax": 0.2754360465116279, "endMs": "1665776459603", "id": "35", "inputStages": [ "33", "21", "31", "34", "32", "30" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "316129", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "354", "startMs": "1665776459370", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$280, $410", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240, $480 := $410, $481 := $280", "INNER HASH JOIN EACH WITH ALL ON $470 = $410" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.007994186046511628, "waitRatioMax": 0.007994186046511628, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0007267441860465116, "writeRatioMax": 0.0007267441860465116 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.010901162790697675, "computeRatioMax": 0.010901162790697675, "endMs": "1665776459614", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "215", "startMs": "1665776459369", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.003633720930232558, "waitRatioMax": 0.003633720930232558, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006540697674418605, "writeRatioMax": 0.006540697674418605 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "12", "elapsedMs": "644", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "4274" }, { "activeUnits": "501", "completedUnits": "543", "elapsedMs": "2093", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "44110" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "44110", "transferredBytes": "0" }, "startTime": "1665776457586", "totalBytesProcessed": "401794978", "totalSlotMs": "44110" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6b87b4ad_88a7_4bbb_a775_2893922f4f8c" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NYE+f1m1dHRkDbJ2h2PBzA==", "id": "test-project-364309:europe-west1.query04_1665776461", "jobReference": { "jobId": "query04_1665776461", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776461?location=europe-west1", "statistics": { "creationTime": "1665776461663", "endTime": "1665776464126", "finalExecutionDurationMs": "2185", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2040" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0056939501779359435, "computeRatioMax": 0.0056939501779359435, "endMs": "1665776461894", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004270462633451958, "readRatioMax": 0.004270462633451958, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776461867", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0099644128113879, "writeRatioMax": 0.0099644128113879 }, { "completedParallelInputs": "1", "computeMsAvg": "178", "computeMsMax": "178", "computeRatioAvg": 0.12669039145907474, "computeRatioMax": 0.12669039145907474, "endMs": "1665776462038", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.008540925266903915, "readRatioMax": 0.008540925266903915, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "192", "startMs": "1665776461894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.008540925266903915, "writeRatioMax": 0.008540925266903915 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.006405693950177936, "computeRatioMax": 0.006405693950177936, "endMs": "1665776461946", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00498220640569395, "readRatioMax": 0.00498220640569395, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776461910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.006405693950177936, "writeRatioMax": 0.006405693950177936 }, { "completedParallelInputs": "1", "computeMsAvg": "216", "computeMsMax": "216", "computeRatioAvg": 0.15373665480427046, "computeRatioMax": 0.15373665480427046, "endMs": "1665776462172", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "24", "readMsMax": "24", "readRatioAvg": 0.01708185053380783, "readRatioMax": 0.01708185053380783, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "304", "startMs": "1665776461937", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.014234875444839857, "writeRatioMax": 0.014234875444839857 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0071174377224199285, "computeRatioMax": 0.0071174377224199285, "endMs": "1665776461985", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0056939501779359435, "readRatioMax": 0.0056939501779359435, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776461951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.00498220640569395, "writeRatioMax": 0.00498220640569395 }, { "completedParallelInputs": "1", "computeMsAvg": "301", "computeMsMax": "301", "computeRatioAvg": 0.21423487544483985, "computeRatioMax": 0.21423487544483985, "endMs": "1665776462159", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.007829181494661922, "readRatioMax": 0.007829181494661922, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "338", "startMs": "1665776461978", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0099644128113879, "writeRatioMax": 0.0099644128113879 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.007829181494661922, "computeRatioMax": 0.007829181494661922, "endMs": "1665776462040", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.00498220640569395, "readRatioMax": 0.00498220640569395, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776461993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.012099644128113879, "writeRatioMax": 0.012099644128113879 }, { "completedParallelInputs": "1", "computeMsAvg": "204", "computeMsMax": "204", "computeRatioAvg": 0.14519572953736654, "computeRatioMax": 0.14519572953736654, "endMs": "1665776462214", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.012811387900355872, "readRatioMax": 0.012811387900355872, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "227", "startMs": "1665776462021", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.010676156583629894, "writeRatioMax": 0.010676156583629894 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.008540925266903915, "computeRatioMax": 0.008540925266903915, "endMs": "1665776462080", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0056939501779359435, "readRatioMax": 0.0056939501779359435, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665776462037", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.009252669039145907, "writeRatioMax": 0.009252669039145907 }, { "completedParallelInputs": "1", "computeMsAvg": "219", "computeMsMax": "219", "computeRatioAvg": 0.15587188612099645, "computeRatioMax": 0.15587188612099645, "endMs": "1665776462278", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.013523131672597865, "readRatioMax": 0.013523131672597865, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "294", "startMs": "1665776462065", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0014234875444839859, "waitRatioMax": 0.0014234875444839859, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.013523131672597865, "writeRatioMax": 0.013523131672597865 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0056939501779359435, "computeRatioMax": 0.0056939501779359435, "endMs": "1665776462114", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0035587188612099642, "readRatioMax": 0.0035587188612099642, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776462079", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.008540925266903915, "writeRatioMax": 0.008540925266903915 }, { "completedParallelInputs": "1", "computeMsAvg": "235", "computeMsMax": "235", "computeRatioAvg": 0.16725978647686832, "computeRatioMax": 0.16725978647686832, "endMs": "1665776462319", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.012811387900355872, "readRatioMax": 0.012811387900355872, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "283", "startMs": "1665776462103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.01708185053380783, "writeRatioMax": 0.01708185053380783 }, { "completedParallelInputs": "6", "computeMsAvg": "1117", "computeMsMax": "1405", "computeRatioAvg": 0.795017793594306, "computeRatioMax": 1, "endMs": "1665776462832", "id": "18", "inputStages": [ "0", "2" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "37", "readRatioAvg": 0.0199288256227758, "readRatioMax": 0.026334519572953737, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "5946", "startMs": "1665776462108", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage12_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "9", "writeMsMax": "12", "writeRatioAvg": 0.006405693950177936, "writeRatioMax": 0.008540925266903915 }, { "completedParallelInputs": "6", "computeMsAvg": "1116", "computeMsMax": "1331", "computeRatioAvg": 0.7943060498220641, "computeRatioMax": 0.9473309608540925, "endMs": "1665776462967", "id": "19", "inputStages": [ "8", "6" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "38", "readMsMax": "48", "readRatioAvg": 0.02704626334519573, "readRatioMax": 0.03416370106761566, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "6609", "startMs": "1665776462172", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage13_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "10", "writeMsMax": "13", "writeRatioAvg": 0.0071174377224199285, "writeRatioMax": 0.009252669039145907 }, { "completedParallelInputs": "5", "computeMsAvg": "782", "computeMsMax": "1028", "computeRatioAvg": 0.5565836298932384, "computeRatioMax": 0.7316725978647687, "endMs": "1665776462867", "id": "20", "inputStages": [ "5", "3" ], "name": "S14: Join+", "parallelInputs": "5", "readMsAvg": "31", "readMsMax": "47", "readRatioAvg": 0.02206405693950178, "readRatioMax": 0.03345195729537367, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "3672", "startMs": "1665776462192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage14_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "28", "writeMsMax": "42", "writeRatioAvg": 0.0199288256227758, "writeRatioMax": 0.0298932384341637 }, { "completedParallelInputs": "5", "computeMsAvg": "714", "computeMsMax": "907", "computeRatioAvg": 0.5081850533807829, "computeRatioMax": 0.6455516014234876, "endMs": "1665776462993", "id": "21", "inputStages": [ "11", "9" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "29", "readMsMax": "47", "readRatioAvg": 0.020640569395017794, "readRatioMax": 0.03345195729537367, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3495", "startMs": "1665776462283", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0014234875444839859, "writeMsAvg": "26", "writeMsMax": "49", "writeRatioAvg": 0.018505338078291814, "writeRatioMax": 0.034875444839857654 }, { "completedParallelInputs": "1", "computeMsAvg": "1244", "computeMsMax": "1244", "computeRatioAvg": 0.8854092526690391, "computeRatioMax": 0.8854092526690391, "endMs": "1665776463034", "id": "22", "inputStages": [ "12", "14" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "34", "readMsMax": "34", "readRatioAvg": 0.024199288256227757, "readRatioMax": 0.024199288256227757, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "1184", "startMs": "1665776462331", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.016370106761565837, "writeRatioMax": 0.016370106761565837 }, { "completedParallelInputs": "1", "computeMsAvg": "1134", "computeMsMax": "1134", "computeRatioAvg": 0.80711743772242, "computeRatioMax": 0.80711743772242, "endMs": "1665776463007", "id": "23", "inputStages": [ "17", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "32", "readMsMax": "32", "readRatioAvg": 0.022775800711743774, "readRatioMax": 0.022775800711743774, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "868", "startMs": "1665776462365", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.014234875444839857, "writeRatioMax": 0.014234875444839857 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.025622775800711744, "computeRatioMax": 0.025622775800711744, "endMs": "1665776463238", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665776463178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.01708185053380783, "writeRatioMax": 0.01708185053380783 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.022775800711743774, "computeRatioMax": 0.022775800711743774, "endMs": "1665776463224", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776463191", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0056939501779359435, "writeRatioMax": 0.0056939501779359435 }, { "completedParallelInputs": "1", "computeMsAvg": "114", "computeMsMax": "114", "computeRatioAvg": 0.08113879003558719, "computeRatioMax": 0.08113879003558719, "endMs": "1665776463292", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "128", "startMs": "1665776463204", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01494661921708185, "writeRatioMax": 0.01494661921708185 }, { "completedParallelInputs": "1", "computeMsAvg": "147", "computeMsMax": "147", "computeRatioAvg": 0.10462633451957296, "computeRatioMax": 0.10462633451957296, "endMs": "1665776463326", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "160", "startMs": "1665776463216", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage14_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.016370106761565837, "writeRatioMax": 0.016370106761565837 }, { "completedParallelInputs": "1", "computeMsAvg": "212", "computeMsMax": "212", "computeRatioAvg": 0.15088967971530248, "computeRatioMax": 0.15088967971530248, "endMs": "1665776463391", "id": "29", "inputStages": [ "18" ], "name": "S1D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "195", "startMs": "1665776463243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$280, $410", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007117437722419929, "waitRatioMax": 0.0007117437722419929, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.014234875444839857, "writeRatioMax": 0.014234875444839857 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.006405693950177936, "computeRatioMax": 0.013523131672597865, "endMs": "1665776463498", "id": "30", "inputStages": [ "29" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "3436", "startMs": "1665776463437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0014234875444839859, "waitRatioMax": 0.0028469750889679717, "writeMsAvg": "17", "writeMsMax": "31", "writeRatioAvg": 0.012099644128113879, "writeRatioMax": 0.02206405693950178 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.0056939501779359435, "computeRatioMax": 0.012811387900355872, "endMs": "1665776463503", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "3384", "startMs": "1665776463437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.004270462633451958, "waitRatioMax": 0.00498220640569395, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.010676156583629894, "writeRatioMax": 0.020640569395017794 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "17", "computeRatioAvg": 0.00498220640569395, "computeRatioMax": 0.012099644128113879, "endMs": "1665776463492", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "2564", "startMs": "1665776463437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.00498220640569395, "waitRatioMax": 0.0056939501779359435, "writeMsAvg": "10", "writeMsMax": "26", "writeRatioAvg": 0.0071174377224199285, "writeRatioMax": 0.018505338078291814 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.00498220640569395, "computeRatioMax": 0.0099644128113879, "endMs": "1665776463493", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "2376", "startMs": "1665776463437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.00498220640569395, "waitRatioMax": 0.006405693950177936, "writeMsAvg": "4", "writeMsMax": "27", "writeRatioAvg": 0.0028469750889679717, "writeRatioMax": 0.019217081850533807 }, { "completedParallelInputs": "100", "computeMsAvg": "6", "computeMsMax": "14", "computeRatioAvg": 0.004270462633451958, "computeRatioMax": 0.0099644128113879, "endMs": "1665776463492", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "1798", "startMs": "1665776463437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.006405693950177936, "waitRatioMax": 0.0071174377224199285, "writeMsAvg": "3", "writeMsMax": "16", "writeRatioAvg": 0.002135231316725979, "writeRatioMax": 0.011387900355871887 }, { "completedParallelInputs": "1", "computeMsAvg": "660", "computeMsMax": "660", "computeRatioAvg": 0.4697508896797153, "computeRatioMax": 0.4697508896797153, "endMs": "1665776463841", "id": "35", "inputStages": [ "34", "30", "19", "32", "31", "33" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "316129", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "607", "startMs": "1665776463462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$280, $410", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240, $480 := $410, $481 := $280", "INNER HASH JOIN EACH WITH ALL ON $470 = $410" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.0071174377224199285, "waitRatioMax": 0.0071174377224199285, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0007117437722419929, "writeRatioMax": 0.0007117437722419929 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.004270462633451958, "computeRatioMax": 0.004270462633451958, "endMs": "1665776463924", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "427", "startMs": "1665776463462", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0028469750889679717, "waitRatioMax": 0.0028469750889679717, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0035587188612099642, "writeRatioMax": 0.0035587188612099642 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "12", "elapsedMs": "642", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "4569" }, { "activeUnits": "12", "completedUnits": "540", "elapsedMs": "1776", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "38756" }, { "activeUnits": "0", "completedUnits": "543", "elapsedMs": "2342", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "39838" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "39838", "transferredBytes": "0" }, "startTime": "1665776461727", "totalBytesProcessed": "401794978", "totalSlotMs": "39838" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon66e5f2ee_b06f_4a22_83d4_66799019dcbe" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8SKfpejfB2v7dDqd876Mfg==", "id": "test-project-364309:europe-west1.query04_1665776711", "jobReference": { "jobId": "query04_1665776711", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776711?location=europe-west1", "statistics": { "creationTime": "1665776712245", "endTime": "1665776714324", "finalExecutionDurationMs": "1804", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2047" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006509357200976403, "computeRatioMax": 0.006509357200976403, "endMs": "1665776712488", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0040683482506102524, "readRatioMax": 0.0040683482506102524, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776712451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.02034174125305126, "writeRatioMax": 0.02034174125305126 }, { "completedParallelInputs": "1", "computeMsAvg": "235", "computeMsMax": "235", "computeRatioAvg": 0.19121236777868186, "computeRatioMax": 0.19121236777868186, "endMs": "1665776712738", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.01708706265256306, "readRatioMax": 0.01708706265256306, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "326", "startMs": "1665776712479", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01708706265256306, "writeRatioMax": 0.01708706265256306 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006509357200976403, "computeRatioMax": 0.006509357200976403, "endMs": "1665776712529", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0040683482506102524, "readRatioMax": 0.0040683482506102524, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776712492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.011391375101708706, "writeRatioMax": 0.011391375101708706 }, { "completedParallelInputs": "1", "computeMsAvg": "250", "computeMsMax": "250", "computeRatioAvg": 0.20341741253051263, "computeRatioMax": 0.20341741253051263, "endMs": "1665776712706", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.012205044751830757, "readRatioMax": 0.012205044751830757, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "327", "startMs": "1665776712521", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.02034174125305126, "writeRatioMax": 0.02034174125305126 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.008950366151342554, "computeRatioMax": 0.008950366151342554, "endMs": "1665776712565", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004882017900732303, "readRatioMax": 0.004882017900732303, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776712536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.011391375101708706, "writeRatioMax": 0.011391375101708706 }, { "completedParallelInputs": "1", "computeMsAvg": "232", "computeMsMax": "232", "computeRatioAvg": 0.1887713588283157, "computeRatioMax": 0.1887713588283157, "endMs": "1665776712779", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.01790073230268511, "readRatioMax": 0.01790073230268511, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "292", "startMs": "1665776712562", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.014646053702196907, "writeRatioMax": 0.014646053702196907 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.011391375101708706, "computeRatioMax": 0.011391375101708706, "endMs": "1665776712623", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004882017900732303, "readRatioMax": 0.004882017900732303, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776712580", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.009764035801464606, "writeRatioMax": 0.009764035801464606 }, { "completedParallelInputs": "1", "computeMsAvg": "239", "computeMsMax": "239", "computeRatioAvg": 0.19446704637917006, "computeRatioMax": 0.19446704637917006, "endMs": "1665776712784", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.009764035801464606, "readRatioMax": 0.009764035801464606, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "244", "startMs": "1665776712609", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.013018714401952807, "writeRatioMax": 0.013018714401952807 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.012205044751830757, "computeRatioMax": 0.012205044751830757, "endMs": "1665776712667", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004882017900732303, "readRatioMax": 0.004882017900732303, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776712628", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010577705451586655, "writeRatioMax": 0.010577705451586655 }, { "completedParallelInputs": "1", "computeMsAvg": "159", "computeMsMax": "159", "computeRatioAvg": 0.12937347436940602, "computeRatioMax": 0.12937347436940602, "endMs": "1665776712804", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.008950366151342554, "readRatioMax": 0.008950366151342554, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "179", "startMs": "1665776712662", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010577705451586655, "writeRatioMax": 0.010577705451586655 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.010577705451586655, "computeRatioMax": 0.010577705451586655, "endMs": "1665776712715", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.004882017900732303, "readRatioMax": 0.004882017900732303, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776712677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.01952807160292921, "writeRatioMax": 0.01952807160292921 }, { "completedParallelInputs": "1", "computeMsAvg": "235", "computeMsMax": "235", "computeRatioAvg": 0.19121236777868186, "computeRatioMax": 0.19121236777868186, "endMs": "1665776712878", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.008950366151342554, "readRatioMax": 0.008950366151342554, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "308", "startMs": "1665776712709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01708706265256306, "writeRatioMax": 0.01708706265256306 }, { "completedParallelInputs": "5", "computeMsAvg": "637", "computeMsMax": "797", "computeRatioAvg": 0.5183075671277462, "computeRatioMax": 0.6484947111472742, "endMs": "1665776713224", "id": "18", "inputStages": [ "3", "5" ], "name": "S12: Join+", "parallelInputs": "5", "readMsAvg": "26", "readMsMax": "30", "readRatioAvg": 0.02115541090317331, "readRatioMax": 0.024410089503661515, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "2999", "startMs": "1665776712728", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage12_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "22", "writeMsMax": "25", "writeRatioAvg": 0.01790073230268511, "writeRatioMax": 0.02034174125305126 }, { "completedParallelInputs": "6", "computeMsAvg": "967", "computeMsMax": "1056", "computeRatioAvg": 0.7868185516680228, "computeRatioMax": 0.8592351505288853, "endMs": "1665776713476", "id": "19", "inputStages": [ "0", "2" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "39", "readRatioAvg": 0.023596419853539462, "readRatioMax": 0.03173311635475997, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "5503", "startMs": "1665776712803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage13_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0024410089503661514, "writeMsAvg": "10", "writeMsMax": "20", "writeRatioAvg": 0.008136696501220505, "writeRatioMax": 0.01627339300244101 }, { "completedParallelInputs": "6", "computeMsAvg": "1109", "computeMsMax": "1229", "computeRatioAvg": 0.9023596419853539, "computeRatioMax": 1, "endMs": "1665776713527", "id": "20", "inputStages": [ "6", "8" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "30", "readMsMax": "38", "readRatioAvg": 0.024410089503661515, "readRatioMax": 0.030919446704637917, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "5854", "startMs": "1665776712818", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage14_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.006509357200976403, "writeRatioMax": 0.007323026851098454 }, { "completedParallelInputs": "5", "computeMsAvg": "691", "computeMsMax": "758", "computeRatioAvg": 0.5622457282343368, "computeRatioMax": 0.6167615947925142, "endMs": "1665776713331", "id": "21", "inputStages": [ "11", "9" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "27", "readMsMax": "35", "readRatioAvg": 0.021969080553295363, "readRatioMax": 0.028478437754271765, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3062", "startMs": "1665776712834", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "22", "writeMsMax": "24", "writeRatioAvg": 0.01790073230268511, "writeRatioMax": 0.01952807160292921 }, { "completedParallelInputs": "1", "computeMsAvg": "1182", "computeMsMax": "1182", "computeRatioAvg": 0.9617575264442636, "computeRatioMax": 0.9617575264442636, "endMs": "1665776713492", "id": "22", "inputStages": [ "14", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "37", "readMsMax": "37", "readRatioAvg": 0.030105777054515868, "readRatioMax": 0.030105777054515868, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "1069", "startMs": "1665776712850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01627339300244101, "writeRatioMax": 0.01627339300244101 }, { "completedParallelInputs": "1", "computeMsAvg": "909", "computeMsMax": "909", "computeRatioAvg": 0.7396257119609438, "computeRatioMax": 0.7396257119609438, "endMs": "1665776713445", "id": "23", "inputStages": [ "15", "17" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "39", "readMsMax": "39", "readRatioAvg": 0.03173311635475997, "readRatioMax": 0.03173311635475997, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "818", "startMs": "1665776712925", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01627339300244101, "writeRatioMax": 0.01627339300244101 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.03580146460537022, "computeRatioMax": 0.03580146460537022, "endMs": "1665776713596", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665776713548", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01708706265256306, "writeRatioMax": 0.01708706265256306 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.03173311635475997, "computeRatioMax": 0.03173311635475997, "endMs": "1665776713606", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776713564", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01627339300244101, "writeRatioMax": 0.01627339300244101 }, { "completedParallelInputs": "1", "computeMsAvg": "170", "computeMsMax": "170", "computeRatioAvg": 0.1383238405207486, "computeRatioMax": 0.1383238405207486, "endMs": "1665776713695", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "171", "startMs": "1665776713580", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.01871440195280716, "writeRatioMax": 0.01871440195280716 }, { "completedParallelInputs": "1", "computeMsAvg": "182", "computeMsMax": "182", "computeRatioAvg": 0.14808787632221318, "computeRatioMax": 0.14808787632221318, "endMs": "1665776713728", "id": "27", "inputStages": [ "18" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "185", "startMs": "1665776713603", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01627339300244101, "writeRatioMax": 0.01627339300244101 }, { "completedParallelInputs": "1", "computeMsAvg": "291", "computeMsMax": "291", "computeRatioAvg": 0.2367778681855167, "computeRatioMax": 0.2367778681855167, "endMs": "1665776713827", "id": "28", "inputStages": [ "20" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2768741", "shuffleOutputBytesSpilled": "0", "slotMs": "289", "startMs": "1665776713620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$240, $470, $471, $472, $474", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0016273393002441008, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01708706265256306, "writeRatioMax": 0.01708706265256306 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.006509357200976403, "computeRatioMax": 0.012205044751830757, "endMs": "1665776713921", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2768741", "shuffleOutputBytesSpilled": "0", "slotMs": "3491", "startMs": "1665776713850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.0016273393002441008, "waitRatioMax": 0.0040683482506102524, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.011391375101708706, "writeRatioMax": 0.015459723352318959 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.005695687550854353, "computeRatioMax": 0.011391375101708706, "endMs": "1665776713912", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "3101", "startMs": "1665776713850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.005695687550854353, "waitRatioMax": 0.007323026851098454, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.012205044751830757, "writeRatioMax": 0.023596419853539462 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.006509357200976403, "computeRatioMax": 0.013832384052074858, "endMs": "1665776713909", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "2974", "startMs": "1665776713851", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "8", "waitMsMax": "9", "waitRatioAvg": 0.006509357200976403, "waitRatioMax": 0.007323026851098454, "writeMsAvg": "10", "writeMsMax": "21", "writeRatioAvg": 0.008136696501220505, "writeRatioMax": 0.01708706265256306 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.005695687550854353, "computeRatioMax": 0.012205044751830757, "endMs": "1665776713911", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "2970", "startMs": "1665776713851", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.007323026851098454, "waitRatioMax": 0.008136696501220505, "writeMsAvg": "5", "writeMsMax": "28", "writeRatioAvg": 0.0040683482506102524, "writeRatioMax": 0.022782750203417412 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.005695687550854353, "computeRatioMax": 0.010577705451586655, "endMs": "1665776713908", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "1799", "startMs": "1665776713853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.007323026851098454, "waitRatioMax": 0.008136696501220505, "writeMsAvg": "3", "writeMsMax": "20", "writeRatioAvg": 0.0024410089503661514, "writeRatioMax": 0.01627339300244101 }, { "completedParallelInputs": "1", "computeMsAvg": "388", "computeMsMax": "388", "computeRatioAvg": 0.31570382424735555, "computeRatioMax": 0.31570382424735555, "endMs": "1665776714145", "id": "35", "inputStages": [ "33", "34", "19", "32", "31", "30" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "314993", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "387", "startMs": "1665776713871", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage13_output" ] }, { "kind": "READ", "substeps": [ "$240, $470, $471, $472, $474", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$480 := $410, $481 := $280, $482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240", "INNER HASH JOIN EACH WITH ALL ON $410 = $470" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.006509357200976403, "waitRatioMax": 0.006509357200976403, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0016273393002441008, "writeRatioMax": 0.0016273393002441008 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.005695687550854353, "computeRatioMax": 0.005695687550854353, "endMs": "1665776714166", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "174", "startMs": "1665776713874", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008136696501220504, "waitRatioMax": 0.0008136696501220504, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0040683482506102524, "writeRatioMax": 0.0040683482506102524 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "12", "elapsedMs": "651", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "6089" }, { "activeUnits": "2", "completedUnits": "543", "elapsedMs": "1968", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "39791" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "39791", "transferredBytes": "0" }, "startTime": "1665776712302", "totalBytesProcessed": "401794978", "totalSlotMs": "39791" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon33d7443a_f974_40fd_bd95_5c982ad50c33" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Z0If48tzzI9XpJHU+gjNYg==", "id": "test-project-364309:europe-west1.query04_1665776715", "jobReference": { "jobId": "query04_1665776715", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776715?location=europe-west1", "statistics": { "creationTime": "1665776716517", "endTime": "1665776719032", "finalExecutionDurationMs": "2218", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2036" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.008252063015753939, "computeRatioMax": 0.008252063015753939, "endMs": "1665776716771", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005251312828207052, "readRatioMax": 0.005251312828207052, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776716737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.00450112528132033, "writeRatioMax": 0.00450112528132033 }, { "completedParallelInputs": "1", "computeMsAvg": "194", "computeMsMax": "194", "computeRatioAvg": 0.145536384096024, "computeRatioMax": 0.145536384096024, "endMs": "1665776716949", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.012003000750187547, "readRatioMax": 0.012003000750187547, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "236", "startMs": "1665776716766", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015003750937734434, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.011252813203300824, "writeRatioMax": 0.011252813203300824 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.00900225056264066, "computeRatioMax": 0.00900225056264066, "endMs": "1665776716820", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006001500375093774, "readRatioMax": 0.006001500375093774, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776716790", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.005251312828207052, "waitRatioMax": 0.005251312828207052, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.010502625656414103, "writeRatioMax": 0.010502625656414103 }, { "completedParallelInputs": "1", "computeMsAvg": "296", "computeMsMax": "296", "computeRatioAvg": 0.2220555138784696, "computeRatioMax": 0.2220555138784696, "endMs": "1665776717019", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.012003000750187547, "readRatioMax": 0.012003000750187547, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "294", "startMs": "1665776716813", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.010502625656414103, "writeRatioMax": 0.010502625656414103 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.012003000750187547, "computeRatioMax": 0.012003000750187547, "endMs": "1665776716862", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006001500375093774, "readRatioMax": 0.006001500375093774, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776716825", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.006001500375093774, "writeRatioMax": 0.006001500375093774 }, { "completedParallelInputs": "1", "computeMsAvg": "280", "computeMsMax": "280", "computeRatioAvg": 0.21005251312828208, "computeRatioMax": 0.21005251312828208, "endMs": "1665776717056", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.012003000750187547, "readRatioMax": 0.012003000750187547, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "302", "startMs": "1665776716854", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.010502625656414103, "writeRatioMax": 0.010502625656414103 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.010502625656414103, "computeRatioMax": 0.010502625656414103, "endMs": "1665776716917", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005251312828207052, "readRatioMax": 0.005251312828207052, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776716870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.012003000750187547, "writeRatioMax": 0.012003000750187547 }, { "completedParallelInputs": "1", "computeMsAvg": "193", "computeMsMax": "193", "computeRatioAvg": 0.1447861965491373, "computeRatioMax": 0.1447861965491373, "endMs": "1665776717088", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.009752438109527382, "readRatioMax": 0.009752438109527382, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "237", "startMs": "1665776716899", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.012753188297074268, "writeRatioMax": 0.012753188297074268 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.009752438109527382, "computeRatioMax": 0.009752438109527382, "endMs": "1665776716962", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00450112528132033, "readRatioMax": 0.00450112528132033, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776716911", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.0172543135783946, "writeRatioMax": 0.0172543135783946 }, { "completedParallelInputs": "1", "computeMsAvg": "198", "computeMsMax": "198", "computeRatioAvg": 0.1485371342835709, "computeRatioMax": 0.1485371342835709, "endMs": "1665776717120", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.015003750937734433, "readRatioMax": 0.015003750937734433, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "231", "startMs": "1665776716952", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.00450112528132033, "waitRatioMax": 0.00450112528132033, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.012753188297074268, "writeRatioMax": 0.012753188297074268 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.010502625656414103, "computeRatioMax": 0.010502625656414103, "endMs": "1665776717002", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00450112528132033, "readRatioMax": 0.00450112528132033, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776716961", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015003750937734434, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.00450112528132033, "writeRatioMax": 0.00450112528132033 }, { "completedParallelInputs": "1", "computeMsAvg": "227", "computeMsMax": "227", "computeRatioAvg": 0.17029257314328583, "computeRatioMax": 0.17029257314328583, "endMs": "1665776717220", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.0172543135783946, "readRatioMax": 0.0172543135783946, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "273", "startMs": "1665776717017", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015003750937734434, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.014253563390847712, "writeRatioMax": 0.014253563390847712 }, { "completedParallelInputs": "6", "computeMsAvg": "1050", "computeMsMax": "1333", "computeRatioAvg": 0.7876969242310577, "computeRatioMax": 1, "endMs": "1665776717788", "id": "18", "inputStages": [ "2", "0" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "42", "readRatioAvg": 0.021005251312828207, "readRatioMax": 0.03150787696924231, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "5718", "startMs": "1665776717022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage12_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015003750937734434, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "7", "writeMsMax": "11", "writeRatioAvg": 0.005251312828207052, "writeRatioMax": 0.008252063015753939 }, { "completedParallelInputs": "5", "computeMsAvg": "755", "computeMsMax": "852", "computeRatioAvg": 0.5663915978994749, "computeRatioMax": 0.6391597899474869, "endMs": "1665776717591", "id": "19", "inputStages": [ "3", "5" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "28", "readMsMax": "33", "readRatioAvg": 0.021005251312828207, "readRatioMax": 0.024756189047261814, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "3590", "startMs": "1665776717065", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage13_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015003750937734434, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "22", "writeMsMax": "25", "writeRatioAvg": 0.016504126031507877, "writeRatioMax": 0.018754688672168042 }, { "completedParallelInputs": "6", "computeMsAvg": "976", "computeMsMax": "1098", "computeRatioAvg": 0.7321830457614403, "computeRatioMax": 0.8237059264816204, "endMs": "1665776717745", "id": "20", "inputStages": [ "6", "8" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "28", "readMsMax": "37", "readRatioAvg": 0.021005251312828207, "readRatioMax": 0.0277569392348087, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "6399", "startMs": "1665776717071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage14_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.005251312828207052, "writeRatioMax": 0.006001500375093774 }, { "completedParallelInputs": "5", "computeMsAvg": "596", "computeMsMax": "797", "computeRatioAvg": 0.44711177794448614, "computeRatioMax": 0.5978994748687172, "endMs": "1665776717669", "id": "21", "inputStages": [ "11", "9" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "27", "readMsMax": "51", "readRatioAvg": 0.020255063765941484, "readRatioMax": 0.03825956489122281, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3075", "startMs": "1665776717156", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "21", "writeMsMax": "25", "writeRatioAvg": 0.015753938484621154, "writeRatioMax": 0.018754688672168042 }, { "completedParallelInputs": "1", "computeMsAvg": "901", "computeMsMax": "901", "computeRatioAvg": 0.6759189797449362, "computeRatioMax": 0.6759189797449362, "endMs": "1665776717808", "id": "22", "inputStages": [ "12", "14" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "48", "readMsMax": "48", "readRatioAvg": 0.03600900225056264, "readRatioMax": 0.03600900225056264, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "894", "startMs": "1665776717172", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015003750937734434, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.015003750937734433, "writeRatioMax": 0.015003750937734433 }, { "completedParallelInputs": "1", "computeMsAvg": "1004", "computeMsMax": "1004", "computeRatioAvg": 0.7531882970742686, "computeRatioMax": 0.7531882970742686, "endMs": "1665776717938", "id": "23", "inputStages": [ "15", "17" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "70", "readMsMax": "70", "readRatioAvg": 0.05251312828207052, "readRatioMax": 0.05251312828207052, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "1060", "startMs": "1665776717274", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0015003750937734434, "waitRatioMax": 0.0015003750937734434, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.02250562640660165, "writeRatioMax": 0.02250562640660165 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.029257314328582147, "computeRatioMax": 0.029257314328582147, "endMs": "1665776718221", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776718170", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.015753938484621154, "writeRatioMax": 0.015753938484621154 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.03375843960990248, "computeRatioMax": 0.03375843960990248, "endMs": "1665776718232", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776718185", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.015753938484621154, "writeRatioMax": 0.015753938484621154 }, { "completedParallelInputs": "1", "computeMsAvg": "131", "computeMsMax": "131", "computeRatioAvg": 0.09827456864216054, "computeRatioMax": 0.09827456864216054, "endMs": "1665776718295", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "135", "startMs": "1665776718198", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.015003750937734433, "writeRatioMax": 0.015003750937734433 }, { "completedParallelInputs": "1", "computeMsAvg": "257", "computeMsMax": "257", "computeRatioAvg": 0.19279819954988747, "computeRatioMax": 0.19279819954988747, "endMs": "1665776718329", "id": "27", "inputStages": [ "19" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665776718211", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage13_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.014253563390847712, "writeRatioMax": 0.014253563390847712 }, { "completedParallelInputs": "1", "computeMsAvg": "451", "computeMsMax": "451", "computeRatioAvg": 0.33833458364591146, "computeRatioMax": 0.33833458364591146, "endMs": "1665776718496", "id": "29", "inputStages": [ "18" ], "name": "S1D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "388", "startMs": "1665776718237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$280, $410", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0007501875468867217, "waitRatioMax": 0.0007501875468867217, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.014253563390847712, "writeRatioMax": 0.014253563390847712 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.006001500375093774, "computeRatioMax": 0.011252813203300824, "endMs": "1665776718618", "id": "30", "inputStages": [ "29" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "3367", "startMs": "1665776718554", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "8", "waitRatioAvg": 0.0037509377344336083, "waitRatioMax": 0.006001500375093774, "writeMsAvg": "12", "writeMsMax": "19", "writeRatioAvg": 0.00900225056264066, "writeRatioMax": 0.014253563390847712 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.005251312828207052, "computeRatioMax": 0.009752438109527382, "endMs": "1665776718624", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "3081", "startMs": "1665776718555", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.006751687921980495, "waitRatioMax": 0.007501875468867217, "writeMsAvg": "5", "writeMsMax": "18", "writeRatioAvg": 0.0037509377344336083, "writeRatioMax": 0.01350337584396099 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.005251312828207052, "computeRatioMax": 0.011252813203300824, "endMs": "1665776718620", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "2209", "startMs": "1665776718556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.007501875468867217, "waitRatioMax": 0.00900225056264066, "writeMsAvg": "3", "writeMsMax": "17", "writeRatioAvg": 0.002250562640660165, "writeRatioMax": 0.012753188297074268 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.005251312828207052, "computeRatioMax": 0.010502625656414103, "endMs": "1665776718624", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "1871", "startMs": "1665776718555", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "12", "waitMsMax": "14", "waitRatioAvg": 0.00900225056264066, "waitRatioMax": 0.010502625656414103, "writeMsAvg": "3", "writeMsMax": "29", "writeRatioAvg": 0.002250562640660165, "writeRatioMax": 0.02175543885971493 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.005251312828207052, "computeRatioMax": 0.012003000750187547, "endMs": "1665776718624", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "1855", "startMs": "1665776718556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "14", "waitMsMax": "16", "waitRatioAvg": 0.010502625656414103, "waitRatioMax": 0.012003000750187547, "writeMsAvg": "3", "writeMsMax": "19", "writeRatioAvg": 0.002250562640660165, "writeRatioMax": 0.014253563390847712 }, { "completedParallelInputs": "1", "computeMsAvg": "393", "computeMsMax": "393", "computeRatioAvg": 0.2948237059264816, "computeRatioMax": 0.2948237059264816, "endMs": "1665776718845", "id": "35", "inputStages": [ "31", "33", "20", "30", "32", "34" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "316129", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "354", "startMs": "1665776718588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$280, $410", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240, $480 := $410, $481 := $280", "INNER HASH JOIN EACH WITH ALL ON $470 = $410" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "17", "waitMsMax": "17", "waitRatioAvg": 0.012753188297074268, "waitRatioMax": 0.012753188297074268, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0007501875468867217, "writeRatioMax": 0.0007501875468867217 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.00450112528132033, "computeRatioMax": 0.00450112528132033, "endMs": "1665776718861", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "224", "startMs": "1665776718595", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.003000750187546887, "waitRatioMax": 0.003000750187546887, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0037509377344336083, "writeRatioMax": 0.0037509377344336083 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "12", "elapsedMs": "659", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "6342" }, { "activeUnits": "4", "completedUnits": "38", "elapsedMs": "1713", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "25980" }, { "activeUnits": "2", "completedUnits": "543", "elapsedMs": "2397", "estimatedRunnableUnits": "3", "pendingUnits": "0", "totalSlotMs": "40105" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "40105", "transferredBytes": "0" }, "startTime": "1665776716579", "totalBytesProcessed": "401794978", "totalSlotMs": "40105" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon688208a4_0bf9_4a1c_b774_d02dfa0cf504" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "mhV+qew5sMFzHe02SzRFbg==", "id": "test-project-364309:europe-west1.query04_1665776721", "jobReference": { "jobId": "query04_1665776721", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776721?location=europe-west1", "statistics": { "creationTime": "1665776721618", "endTime": "1665776723761", "finalExecutionDurationMs": "1896", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2044" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00825082508250825, "computeRatioMax": 0.00825082508250825, "endMs": "1665776721857", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006600660066006601, "readRatioMax": 0.006600660066006601, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776721814", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.014026402640264026, "writeRatioMax": 0.014026402640264026 }, { "completedParallelInputs": "1", "computeMsAvg": "331", "computeMsMax": "331", "computeRatioAvg": 0.2731023102310231, "computeRatioMax": 0.2731023102310231, "endMs": "1665776722116", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.013201320132013201, "readRatioMax": 0.013201320132013201, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "324", "startMs": "1665776721853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.013201320132013201, "writeRatioMax": 0.013201320132013201 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009075907590759076, "computeRatioMax": 0.009075907590759076, "endMs": "1665776721915", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005775577557755775, "readRatioMax": 0.005775577557755775, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776721872", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.014026402640264026, "writeRatioMax": 0.014026402640264026 }, { "completedParallelInputs": "1", "computeMsAvg": "215", "computeMsMax": "215", "computeRatioAvg": 0.1773927392739274, "computeRatioMax": 0.1773927392739274, "endMs": "1665776722086", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.0165016501650165, "readRatioMax": 0.0165016501650165, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "225", "startMs": "1665776721908", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.014026402640264026, "writeRatioMax": 0.014026402640264026 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007425742574257425, "computeRatioMax": 0.007425742574257425, "endMs": "1665776721965", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0049504950495049506, "readRatioMax": 0.0049504950495049506, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776721926", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010726072607260726, "writeRatioMax": 0.010726072607260726 }, { "completedParallelInputs": "1", "computeMsAvg": "250", "computeMsMax": "250", "computeRatioAvg": 0.20627062706270627, "computeRatioMax": 0.20627062706270627, "endMs": "1665776722219", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.017326732673267328, "readRatioMax": 0.017326732673267328, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "285", "startMs": "1665776721963", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.0165016501650165, "writeRatioMax": 0.0165016501650165 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009075907590759076, "computeRatioMax": 0.009075907590759076, "endMs": "1665776722023", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.006600660066006601, "readRatioMax": 0.006600660066006601, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776721981", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010726072607260726, "writeRatioMax": 0.010726072607260726 }, { "completedParallelInputs": "1", "computeMsAvg": "278", "computeMsMax": "278", "computeRatioAvg": 0.22937293729372937, "computeRatioMax": 0.22937293729372937, "endMs": "1665776722225", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.010726072607260726, "readRatioMax": 0.010726072607260726, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "212", "startMs": "1665776722025", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01155115511551155, "writeRatioMax": 0.01155115511551155 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00825082508250825, "computeRatioMax": 0.00825082508250825, "endMs": "1665776722083", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005775577557755775, "readRatioMax": 0.005775577557755775, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776722042", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.014026402640264026, "writeRatioMax": 0.014026402640264026 }, { "completedParallelInputs": "1", "computeMsAvg": "356", "computeMsMax": "356", "computeRatioAvg": 0.29372937293729373, "computeRatioMax": 0.29372937293729373, "endMs": "1665776722298", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.01155115511551155, "readRatioMax": 0.01155115511551155, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "353", "startMs": "1665776722090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01155115511551155, "writeRatioMax": 0.01155115511551155 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009075907590759076, "computeRatioMax": 0.009075907590759076, "endMs": "1665776722163", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0049504950495049506, "readRatioMax": 0.0049504950495049506, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776722111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010726072607260726, "writeRatioMax": 0.010726072607260726 }, { "completedParallelInputs": "1", "computeMsAvg": "245", "computeMsMax": "245", "computeRatioAvg": 0.20214521452145215, "computeRatioMax": 0.20214521452145215, "endMs": "1665776722338", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.0165016501650165, "readRatioMax": 0.0165016501650165, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "307", "startMs": "1665776722156", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.019801980198019802, "writeRatioMax": 0.019801980198019802 }, { "completedParallelInputs": "5", "computeMsAvg": "762", "computeMsMax": "1195", "computeRatioAvg": 0.6287128712871287, "computeRatioMax": 0.985973597359736, "endMs": "1665776722877", "id": "18", "inputStages": [ "5", "3" ], "name": "S12: Join+", "parallelInputs": "5", "readMsAvg": "23", "readMsMax": "27", "readRatioAvg": 0.018976897689768978, "readRatioMax": 0.022277227722772276, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "3424", "startMs": "1665776722193", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage12_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.018151815181518153, "writeRatioMax": 0.018151815181518153 }, { "completedParallelInputs": "6", "computeMsAvg": "1082", "computeMsMax": "1212", "computeRatioAvg": 0.8927392739273927, "computeRatioMax": 1, "endMs": "1665776722917", "id": "19", "inputStages": [ "0", "2" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "37", "readRatioAvg": 0.02392739273927393, "readRatioMax": 0.03052805280528053, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "5541", "startMs": "1665776722199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage13_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.006600660066006601, "writeRatioMax": 0.00825082508250825 }, { "completedParallelInputs": "6", "computeMsAvg": "954", "computeMsMax": "1173", "computeRatioAvg": 0.7871287128712872, "computeRatioMax": 0.9678217821782178, "endMs": "1665776722851", "id": "20", "inputStages": [ "8", "6" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "24", "readMsMax": "29", "readRatioAvg": 0.019801980198019802, "readRatioMax": 0.02392739273927393, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "4594", "startMs": "1665776722272", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage14_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.0049504950495049506, "writeRatioMax": 0.006600660066006601 }, { "completedParallelInputs": "5", "computeMsAvg": "699", "computeMsMax": "800", "computeRatioAvg": 0.5767326732673267, "computeRatioMax": 0.6600660066006601, "endMs": "1665776722810", "id": "21", "inputStages": [ "9", "11" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "31", "readMsMax": "45", "readRatioAvg": 0.02557755775577558, "readRatioMax": 0.03712871287128713, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3340", "startMs": "1665776722304", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "25", "writeMsMax": "30", "writeRatioAvg": 0.020627062706270627, "writeRatioMax": 0.024752475247524754 }, { "completedParallelInputs": "1", "computeMsAvg": "746", "computeMsMax": "746", "computeRatioAvg": 0.6155115511551155, "computeRatioMax": 0.6155115511551155, "endMs": "1665776722881", "id": "22", "inputStages": [ "14", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "44", "readMsMax": "44", "readRatioAvg": 0.036303630363036306, "readRatioMax": 0.036303630363036306, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "733", "startMs": "1665776722361", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.017326732673267328, "writeRatioMax": 0.017326732673267328 }, { "completedParallelInputs": "1", "computeMsAvg": "936", "computeMsMax": "936", "computeRatioAvg": 0.7722772277227723, "computeRatioMax": 0.7722772277227723, "endMs": "1665776722888", "id": "23", "inputStages": [ "17", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "27", "readMsMax": "27", "readRatioAvg": 0.022277227722772276, "readRatioMax": 0.022277227722772276, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "786", "startMs": "1665776722382", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.0165016501650165, "writeRatioMax": 0.0165016501650165 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.0297029702970297, "computeRatioMax": 0.0297029702970297, "endMs": "1665776723017", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "77", "startMs": "1665776722955", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.018976897689768978, "writeRatioMax": 0.018976897689768978 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.028877887788778877, "computeRatioMax": 0.028877887788778877, "endMs": "1665776723025", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776722972", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.015676567656765675, "writeRatioMax": 0.015676567656765675 }, { "completedParallelInputs": "1", "computeMsAvg": "175", "computeMsMax": "175", "computeRatioAvg": 0.1443894389438944, "computeRatioMax": 0.1443894389438944, "endMs": "1665776723134", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "191", "startMs": "1665776722993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.018151815181518153, "writeRatioMax": 0.018151815181518153 }, { "completedParallelInputs": "1", "computeMsAvg": "174", "computeMsMax": "174", "computeRatioAvg": 0.14356435643564355, "computeRatioMax": 0.14356435643564355, "endMs": "1665776723125", "id": "27", "inputStages": [ "18" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "187", "startMs": "1665776723013", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage12_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.017326732673267328, "writeRatioMax": 0.017326732673267328 }, { "completedParallelInputs": "1", "computeMsAvg": "239", "computeMsMax": "239", "computeRatioAvg": 0.1971947194719472, "computeRatioMax": 0.1971947194719472, "endMs": "1665776723198", "id": "29", "inputStages": [ "19" ], "name": "S1D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "224", "startMs": "1665776723044", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage13_output" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$280, $410", "TO __stage1D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008250825082508251, "waitRatioMax": 0.0008250825082508251, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.018151815181518153, "writeRatioMax": 0.018151815181518153 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.007425742574257425, "computeRatioMax": 0.015676567656765675, "endMs": "1665776723310", "id": "30", "inputStages": [ "29" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "5337", "startMs": "1665776723232", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0016501650165016502, "waitRatioMax": 0.0049504950495049506, "writeMsAvg": "36", "writeMsMax": "64", "writeRatioAvg": 0.0297029702970297, "writeRatioMax": 0.052805280528052806 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "21", "computeRatioAvg": 0.007425742574257425, "computeRatioMax": 0.017326732673267328, "endMs": "1665776723299", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "4153", "startMs": "1665776723233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.0049504950495049506, "waitRatioMax": 0.005775577557755775, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.012376237623762377, "writeRatioMax": 0.024752475247524754 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.007425742574257425, "computeRatioMax": 0.014026402640264026, "endMs": "1665776723314", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "5001", "startMs": "1665776723234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.005775577557755775, "waitRatioMax": 0.006600660066006601, "writeMsAvg": "28", "writeMsMax": "55", "writeRatioAvg": 0.0231023102310231, "writeRatioMax": 0.04537953795379538 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.005775577557755775, "computeRatioMax": 0.01155115511551155, "endMs": "1665776723313", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "5005", "startMs": "1665776723233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "8", "waitMsMax": "10", "waitRatioAvg": 0.006600660066006601, "waitRatioMax": 0.00825082508250825, "writeMsAvg": "41", "writeMsMax": "65", "writeRatioAvg": 0.03382838283828383, "writeRatioMax": 0.05363036303630363 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.006600660066006601, "computeRatioMax": 0.012376237623762377, "endMs": "1665776723308", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "4176", "startMs": "1665776723234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.007425742574257425, "waitRatioMax": 0.00825082508250825, "writeMsAvg": "23", "writeMsMax": "49", "writeRatioAvg": 0.018976897689768978, "writeRatioMax": 0.040429042904290426 }, { "completedParallelInputs": "1", "computeMsAvg": "484", "computeMsMax": "484", "computeRatioAvg": 0.39933993399339934, "computeRatioMax": 0.39933993399339934, "endMs": "1665776723568", "id": "35", "inputStages": [ "32", "20", "30", "31", "33", "34" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "316129", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "415", "startMs": "1665776723249", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$280, $410", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240, $480 := $410, $481 := $280", "INNER HASH JOIN EACH WITH ALL ON $470 = $410" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "12", "waitMsMax": "12", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0008250825082508251, "writeRatioMax": 0.0008250825082508251 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.005775577557755775, "computeRatioMax": 0.005775577557755775, "endMs": "1665776723616", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "269", "startMs": "1665776723260", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.0049504950495049506, "waitRatioMax": 0.0049504950495049506, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0016501650165016502, "writeRatioMax": 0.0016501650165016502 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "25", "completedUnits": "11", "elapsedMs": "643", "estimatedRunnableUnits": "0", "pendingUnits": "25", "totalSlotMs": "6497" }, { "activeUnits": "9", "completedUnits": "543", "elapsedMs": "2046", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "50497" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "50497", "transferredBytes": "0" }, "startTime": "1665776721674", "totalBytesProcessed": "401794978", "totalSlotMs": "50497" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoneb6b584c_011b_499d_842e_d777a6863d0a" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "vEcseVAzvgrMhGt3lMElpg==", "id": "test-project-364309:europe-west1.query04_1665776725", "jobReference": { "jobId": "query04_1665776725", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776725?location=europe-west1", "statistics": { "creationTime": "1665776725620", "endTime": "1665776728209", "finalExecutionDurationMs": "2271", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2038" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.006176652254478073, "computeRatioMax": 0.006176652254478073, "endMs": "1665776725889", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0037059913526868438, "readRatioMax": 0.0037059913526868438, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776725848", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.016676961087090797, "writeRatioMax": 0.016676961087090797 }, { "completedParallelInputs": "1", "computeMsAvg": "229", "computeMsMax": "229", "computeRatioAvg": 0.14144533662754788, "computeRatioMax": 0.14144533662754788, "endMs": "1665776726103", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0067943174799258805, "readRatioMax": 0.0067943174799258805, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "265", "startMs": "1665776725886", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006176652254478073, "waitRatioMax": 0.0006176652254478073, "writeMsAvg": "35", "writeMsMax": "35", "writeRatioAvg": 0.021618282890673256, "writeRatioMax": 0.021618282890673256 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0074119827053736875, "computeRatioMax": 0.0074119827053736875, "endMs": "1665776725973", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004323656578134651, "readRatioMax": 0.004323656578134651, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776725920", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.01605929586164299, "writeRatioMax": 0.01605929586164299 }, { "completedParallelInputs": "1", "computeMsAvg": "255", "computeMsMax": "255", "computeRatioAvg": 0.15750463248919086, "computeRatioMax": 0.15750463248919086, "endMs": "1665776726166", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.00926497838171711, "readRatioMax": 0.00926497838171711, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "275", "startMs": "1665776725965", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.00926497838171711, "writeRatioMax": 0.00926497838171711 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.008029647930821495, "computeRatioMax": 0.008029647930821495, "endMs": "1665776726030", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.004941321803582459, "readRatioMax": 0.004941321803582459, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776725986", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.008647313156269302, "writeRatioMax": 0.008647313156269302 }, { "completedParallelInputs": "1", "computeMsAvg": "182", "computeMsMax": "182", "computeRatioAvg": 0.11241507103150093, "computeRatioMax": 0.11241507103150093, "endMs": "1665776726166", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0074119827053736875, "readRatioMax": 0.0074119827053736875, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "175", "startMs": "1665776726020", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.00926497838171711, "writeRatioMax": 0.00926497838171711 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.006176652254478073, "computeRatioMax": 0.006176652254478073, "endMs": "1665776726081", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004323656578134651, "readRatioMax": 0.004323656578134651, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776726036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006176652254478073, "waitRatioMax": 0.0006176652254478073, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.009882643607164917, "writeRatioMax": 0.009882643607164917 }, { "completedParallelInputs": "1", "computeMsAvg": "173", "computeMsMax": "173", "computeRatioAvg": 0.10685608400247067, "computeRatioMax": 0.10685608400247067, "endMs": "1665776726219", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.008029647930821495, "readRatioMax": 0.008029647930821495, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "179", "startMs": "1665776726071", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.008647313156269302, "writeRatioMax": 0.008647313156269302 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0074119827053736875, "computeRatioMax": 0.0074119827053736875, "endMs": "1665776726137", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.004941321803582459, "readRatioMax": 0.004941321803582459, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776726096", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.008647313156269302, "writeRatioMax": 0.008647313156269302 }, { "completedParallelInputs": "1", "computeMsAvg": "192", "computeMsMax": "192", "computeRatioAvg": 0.118591723285979, "computeRatioMax": 0.118591723285979, "endMs": "1665776726280", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0074119827053736875, "readRatioMax": 0.0074119827053736875, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "193", "startMs": "1665776726131", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006176652254478073, "waitRatioMax": 0.0006176652254478073, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.00926497838171711, "writeRatioMax": 0.00926497838171711 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.004323656578134651, "computeRatioMax": 0.004323656578134651, "endMs": "1665776726188", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0030883261272390363, "readRatioMax": 0.0030883261272390363, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776726149", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.009882643607164917, "writeRatioMax": 0.009882643607164917 }, { "completedParallelInputs": "1", "computeMsAvg": "189", "computeMsMax": "189", "computeRatioAvg": 0.11673872760963558, "computeRatioMax": 0.11673872760963558, "endMs": "1665776726372", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.009882643607164917, "readRatioMax": 0.009882643607164917, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "225", "startMs": "1665776726178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.012353304508956145, "writeRatioMax": 0.012353304508956145 }, { "completedParallelInputs": "6", "computeMsAvg": "923", "computeMsMax": "1307", "computeRatioAvg": 0.5701050030883261, "computeRatioMax": 0.8072884496602841, "endMs": "1665776726946", "id": "18", "inputStages": [ "2", "0" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "27", "readMsMax": "36", "readRatioAvg": 0.016676961087090797, "readRatioMax": 0.022235948116121063, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "4873", "startMs": "1665776726186", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage12_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.004323656578134651, "writeRatioMax": 0.005558987029030266 }, { "completedParallelInputs": "6", "computeMsAvg": "1123", "computeMsMax": "1619", "computeRatioAvg": 0.6936380481778875, "computeRatioMax": 1, "endMs": "1665776727175", "id": "19", "inputStages": [ "6", "8" ], "name": "S13: Join+", "parallelInputs": "6", "readMsAvg": "36", "readMsMax": "70", "readRatioAvg": 0.022235948116121063, "readRatioMax": 0.04323656578134651, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "5463", "startMs": "1665776726196", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage13_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0018529956763434219, "writeMsAvg": "8", "writeMsMax": "13", "writeRatioAvg": 0.004941321803582459, "writeRatioMax": 0.008029647930821495 }, { "completedParallelInputs": "5", "computeMsAvg": "635", "computeMsMax": "776", "computeRatioAvg": 0.3922174181593576, "computeRatioMax": 0.4793082149474985, "endMs": "1665776726690", "id": "20", "inputStages": [ "3", "5" ], "name": "S14: Join+", "parallelInputs": "5", "readMsAvg": "23", "readMsMax": "26", "readRatioAvg": 0.014206300185299567, "readRatioMax": 0.01605929586164299, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "2849", "startMs": "1665776726244", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage14_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "22", "writeMsMax": "24", "writeRatioAvg": 0.013588634959851761, "writeRatioMax": 0.014823965410747375 }, { "completedParallelInputs": "5", "computeMsAvg": "760", "computeMsMax": "883", "computeRatioAvg": 0.4694255713403335, "computeRatioMax": 0.5453983940704138, "endMs": "1665776726829", "id": "21", "inputStages": [ "9", "11" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "33", "readMsMax": "37", "readRatioAvg": 0.02038295243977764, "readRatioMax": 0.02285361334156887, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3455", "startMs": "1665776726275", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0024706609017912293, "waitRatioMax": 0.0024706609017912293, "writeMsAvg": "24", "writeMsMax": "25", "writeRatioAvg": 0.014823965410747375, "writeRatioMax": 0.015441630636195183 }, { "completedParallelInputs": "1", "computeMsAvg": "1026", "computeMsMax": "1026", "computeRatioAvg": 0.6337245213094502, "computeRatioMax": 0.6337245213094502, "endMs": "1665776726856", "id": "22", "inputStages": [ "12", "14" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "33", "readMsMax": "33", "readRatioAvg": 0.02038295243977764, "readRatioMax": 0.02038295243977764, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "631", "startMs": "1665776726306", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0018529956763434219, "waitRatioMax": 0.0018529956763434219, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.011117974058060531, "writeRatioMax": 0.011117974058060531 }, { "completedParallelInputs": "1", "computeMsAvg": "765", "computeMsMax": "765", "computeRatioAvg": 0.47251389746757255, "computeRatioMax": 0.47251389746757255, "endMs": "1665776726918", "id": "23", "inputStages": [ "17", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.022235948116121063, "readRatioMax": 0.022235948116121063, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "1365", "startMs": "1665776726403", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.01173563928350834, "writeRatioMax": 0.01173563928350834 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.022235948116121063, "computeRatioMax": 0.022235948116121063, "endMs": "1665776727345", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665776727267", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006176652254478073, "waitRatioMax": 0.0006176652254478073, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.014206300185299567, "writeRatioMax": 0.014206300185299567 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.0253242742433601, "computeRatioMax": 0.0253242742433601, "endMs": "1665776727350", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776727282", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.015441630636195183, "writeRatioMax": 0.015441630636195183 }, { "completedParallelInputs": "1", "computeMsAvg": "156", "computeMsMax": "156", "computeRatioAvg": 0.09635577516985794, "computeRatioMax": 0.09635577516985794, "endMs": "1665776727434", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665776727322", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.012970969734403953, "writeRatioMax": 0.012970969734403953 }, { "completedParallelInputs": "1", "computeMsAvg": "137", "computeMsMax": "137", "computeRatioAvg": 0.0846201358863496, "computeRatioMax": 0.0846201358863496, "endMs": "1665776727446", "id": "27", "inputStages": [ "20" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "141", "startMs": "1665776727340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage14_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006176652254478073, "waitRatioMax": 0.0006176652254478073, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.014823965410747375, "writeRatioMax": 0.014823965410747375 }, { "completedParallelInputs": "1", "computeMsAvg": "311", "computeMsMax": "311", "computeRatioAvg": 0.19209388511426806, "computeRatioMax": 0.19209388511426806, "endMs": "1665776727554", "id": "28", "inputStages": [ "19" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2768741", "shuffleOutputBytesSpilled": "0", "slotMs": "302", "startMs": "1665776727355", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$240, $470, $471, $472, $474", "TO __stage1C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0012353304508956147, "waitRatioMax": 0.0012353304508956147, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.014823965410747375, "writeRatioMax": 0.014823965410747375 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "20", "computeRatioAvg": 0.005558987029030266, "computeRatioMax": 0.012353304508956145, "endMs": "1665776727674", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2768741", "shuffleOutputBytesSpilled": "0", "slotMs": "3653", "startMs": "1665776727612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.0018529956763434219, "waitRatioMax": 0.0037059913526868438, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.008647313156269302, "writeRatioMax": 0.017294626312538603 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.004941321803582459, "computeRatioMax": 0.012970969734403953, "endMs": "1665776727672", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "2685", "startMs": "1665776727609", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.0037059913526868438, "waitRatioMax": 0.004323656578134651, "writeMsAvg": "6", "writeMsMax": "27", "writeRatioAvg": 0.0037059913526868438, "writeRatioMax": 0.016676961087090797 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.004323656578134651, "computeRatioMax": 0.008647313156269302, "endMs": "1665776727674", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "1685", "startMs": "1665776727610", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.004323656578134651, "waitRatioMax": 0.004941321803582459, "writeMsAvg": "2", "writeMsMax": "5", "writeRatioAvg": 0.0012353304508956147, "writeRatioMax": 0.0030883261272390363 }, { "completedParallelInputs": "100", "computeMsAvg": "6", "computeMsMax": "16", "computeRatioAvg": 0.0037059913526868438, "computeRatioMax": 0.009882643607164917, "endMs": "1665776727675", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "1628", "startMs": "1665776727611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.005558987029030266, "waitRatioMax": 0.0067943174799258805, "writeMsAvg": "2", "writeMsMax": "18", "writeRatioAvg": 0.0012353304508956147, "writeRatioMax": 0.011117974058060531 }, { "completedParallelInputs": "100", "computeMsAvg": "6", "computeMsMax": "13", "computeRatioAvg": 0.0037059913526868438, "computeRatioMax": 0.008029647930821495, "endMs": "1665776727675", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "1563", "startMs": "1665776727610", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "10", "waitMsMax": "12", "waitRatioAvg": 0.006176652254478073, "waitRatioMax": 0.0074119827053736875, "writeMsAvg": "2", "writeMsMax": "25", "writeRatioAvg": 0.0012353304508956147, "writeRatioMax": 0.015441630636195183 }, { "completedParallelInputs": "1", "computeMsAvg": "510", "computeMsMax": "510", "computeRatioAvg": 0.3150092649783817, "computeRatioMax": 0.3150092649783817, "endMs": "1665776728001", "id": "35", "inputStages": [ "31", "34", "30", "32", "33", "18" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "314993", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "1028", "startMs": "1665776727644", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$240, $470, $471, $472, $474", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$480 := $410, $481 := $280, $482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240", "INNER HASH JOIN EACH WITH ALL ON $410 = $470" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.008029647930821495, "waitRatioMax": 0.008029647930821495, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0024706609017912293, "writeRatioMax": 0.0024706609017912293 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0030883261272390363, "computeRatioMax": 0.0030883261272390363, "endMs": "1665776728064", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "365", "startMs": "1665776727644", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0024706609017912293, "waitRatioMax": 0.0024706609017912293, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0030883261272390363, "writeRatioMax": 0.0030883261272390363 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "25", "completedUnits": "11", "elapsedMs": "676", "estimatedRunnableUnits": "0", "pendingUnits": "25", "totalSlotMs": "3527" }, { "activeUnits": "5", "completedUnits": "38", "elapsedMs": "1748", "estimatedRunnableUnits": "0", "pendingUnits": "4", "totalSlotMs": "22118" }, { "activeUnits": "2", "completedUnits": "543", "elapsedMs": "2472", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "35671" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "35671", "transferredBytes": "0" }, "startTime": "1665776725674", "totalBytesProcessed": "401794978", "totalSlotMs": "35671" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc5189b9e_5ae9_4cdf_8d56_cee3a553d6ae" }, "priority": "INTERACTIVE", "query": "-- start query 4 in stream 0 using template query4.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n ,'c' sale_type\n from customer\n ,catalog_sales\n ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\nunion all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag\n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_c_firstyear\n ,year_total t_c_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_c_secyear.customer_id\n and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_c_firstyear.sale_type = 'c'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_c_secyear.sale_type = 'c'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_c_firstyear.dyear = 2001\n and t_c_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_c_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_birth_country\n limit 100\n;\n\n-- end query 4 in stream 0 using template query4.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "sGM0QaR/3yS6hduwioM/sA==", "id": "test-project-364309:europe-west1.query04_1665776730", "jobReference": { "jobId": "query04_1665776730", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query04_1665776730?location=europe-west1", "statistics": { "creationTime": "1665776730653", "endTime": "1665776733018", "finalExecutionDurationMs": "2104", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "401794978", "performanceInsights": { "avgPreviousExecutionMs": "2047" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0030656039239730227, "computeRatioMax": 0.0030656039239730227, "endMs": "1665776730874", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.004904966278356836, "readRatioMax": 0.004904966278356836, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776730844", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170:d_date_sk, $171:d_year", "FROM date_dim", "WHERE equal($171, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001226241569589209, "waitRatioMax": 0.001226241569589209, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.009809932556713672, "writeRatioMax": 0.009809932556713672 }, { "completedParallelInputs": "1", "computeMsAvg": "183", "computeMsMax": "183", "computeRatioAvg": 0.11220110361741263, "computeRatioMax": 0.11220110361741263, "endMs": "1665776731035", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.011649294911097487, "readRatioMax": 0.011649294911097487, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "190", "startMs": "1665776730875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150:c_customer_sk, $151:c_customer_id, $152:c_first_name, $153:c_last_name, $154:c_preferred_cust_flag, $155:c_birth_country, $156:c_login, $157:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.009196811771919068, "writeRatioMax": 0.009196811771919068 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.00797057020232986, "computeRatioMax": 0.00797057020232986, "endMs": "1665776730920", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004291845493562232, "readRatioMax": 0.004291845493562232, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776730891", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140:d_date_sk, $141:d_year", "FROM date_dim", "WHERE equal($141, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.009196811771919068, "writeRatioMax": 0.009196811771919068 }, { "completedParallelInputs": "1", "computeMsAvg": "273", "computeMsMax": "273", "computeRatioAvg": 0.16738197424892703, "computeRatioMax": 0.16738197424892703, "endMs": "1665776731112", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.008583690987124463, "readRatioMax": 0.008583690987124463, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "281", "startMs": "1665776730920", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120:c_customer_sk, $121:c_customer_id, $122:c_first_name, $123:c_last_name, $124:c_preferred_cust_flag, $125:c_birth_country, $126:c_login, $127:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.00797057020232986, "writeRatioMax": 0.00797057020232986 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0061312078479460455, "computeRatioMax": 0.0061312078479460455, "endMs": "1665776730980", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004291845493562232, "readRatioMax": 0.004291845493562232, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776730938", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.008583690987124463, "writeRatioMax": 0.008583690987124463 }, { "completedParallelInputs": "1", "computeMsAvg": "170", "computeMsMax": "170", "computeRatioAvg": 0.10423053341508277, "computeRatioMax": 0.10423053341508277, "endMs": "1665776731147", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.00797057020232986, "readRatioMax": 0.00797057020232986, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "187", "startMs": "1665776730976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.009196811771919068, "writeRatioMax": 0.009196811771919068 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.004291845493562232, "computeRatioMax": 0.004291845493562232, "endMs": "1665776731029", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0030656039239730227, "readRatioMax": 0.0030656039239730227, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776730992", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.009196811771919068, "writeRatioMax": 0.009196811771919068 }, { "completedParallelInputs": "1", "computeMsAvg": "298", "computeMsMax": "298", "computeRatioAvg": 0.18270999386879216, "computeRatioMax": 0.18270999386879216, "endMs": "1665776731240", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.009809932556713672, "readRatioMax": 0.009809932556713672, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "304", "startMs": "1665776731020", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.009809932556713672, "writeRatioMax": 0.009809932556713672 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.004904966278356836, "computeRatioMax": 0.004904966278356836, "endMs": "1665776731069", "id": "12", "name": "S0C: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.002452483139178418, "readRatioMax": 0.002452483139178418, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776731033", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.008583690987124463, "writeRatioMax": 0.008583690987124463 }, { "completedParallelInputs": "1", "computeMsAvg": "196", "computeMsMax": "196", "computeRatioAvg": 0.12017167381974249, "computeRatioMax": 0.12017167381974249, "endMs": "1665776731241", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.009809932556713672, "readRatioMax": 0.009809932556713672, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "218", "startMs": "1665776731065", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.009809932556713672, "writeRatioMax": 0.009809932556713672 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0061312078479460455, "computeRatioMax": 0.0061312078479460455, "endMs": "1665776731122", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.004291845493562232, "readRatioMax": 0.004291845493562232, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776731081", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.008583690987124463, "writeRatioMax": 0.008583690987124463 }, { "completedParallelInputs": "1", "computeMsAvg": "257", "computeMsMax": "257", "computeRatioAvg": 0.15757204169221337, "computeRatioMax": 0.15757204169221337, "endMs": "1665776731314", "id": "17", "name": "S11: Input", "parallelInputs": "1", "readMsAvg": "24", "readMsMax": "24", "readRatioAvg": 0.014714898835070508, "readRatioMax": 0.014714898835070508, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "273", "startMs": "1665776731112", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.010423053341508276, "writeRatioMax": 0.010423053341508276 }, { "completedParallelInputs": "6", "computeMsAvg": "1182", "computeMsMax": "1500", "computeRatioAvg": 0.7247087676272226, "computeRatioMax": 0.9196811771919068, "endMs": "1665776731997", "id": "18", "inputStages": [ "0", "2" ], "name": "S12: Join+", "parallelInputs": "6", "readMsAvg": "33", "readMsMax": "43", "readRatioAvg": 0.02023298589822195, "readRatioMax": 0.026364193746167996, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24002179", "shuffleOutputBytesSpilled": "0", "slotMs": "6387", "startMs": "1665776731117", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_ext_discount_amt, $163:ss_ext_sales_price, $164:ss_ext_wholesale_cost, $165:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$170, $171", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380, $401 := $381, $402 := $382, $403 := $383, $404 := $384, $405 := $385, $406 := $386, $407 := $391", "$320 := SUM($350)" ] }, { "kind": "COMPUTE", "substeps": [ "$350 := divide(add(subtract(subtract($390, $389), $387), $388), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $360, $381 := $361, $382 := $362, $383 := $363, $384 := $364, $385 := $365, $386 := $366, $387 := $368, $388 := $369, $389 := $370, $390 := $371, $391 := $171", "INNER HASH JOIN EACH WITH ALL ON $367 = $170" ] }, { "kind": "JOIN", "substeps": [ "$367 := $160, $368 := $162, $369 := $163, $370 := $164, $371 := $165, $360 := $151, $361 := $152, $362 := $153, $363 := $154, $364 := $155, $365 := $156, $366 := $157", "INNER HASH JOIN EACH WITH ALL ON $161 = $150" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "TO __stage12_output", "BY HASH($400, $401, $402, $403, $404, $405, $406, $407)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.004291845493562232, "writeRatioMax": 0.005518087063151441 }, { "completedParallelInputs": "5", "computeMsAvg": "691", "computeMsMax": "849", "computeRatioAvg": 0.42366646229307175, "computeRatioMax": 0.5205395462906193, "endMs": "1665776731674", "id": "19", "inputStages": [ "3", "5" ], "name": "S13: Join+", "parallelInputs": "5", "readMsAvg": "27", "readMsMax": "34", "readRatioAvg": 0.01655426118945432, "readRatioMax": 0.020846106683016553, "recordsRead": "1943373", "recordsWritten": "116084", "shuffleOutputBytes": "13897322", "shuffleOutputBytesSpilled": "0", "slotMs": "2970", "startMs": "1665776731166", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130:cs_sold_date_sk, $131:cs_bill_customer_sk, $132:cs_ext_discount_amt, $133:cs_ext_sales_price, $134:cs_ext_wholesale_cost, $135:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$120, $121, $122, $123, $124, $125, $126, $127", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $530 := $510, $531 := $511, $532 := $512, $533 := $513, $534 := $514, $535 := $515, $536 := $516, $537 := $521", "$310 := SUM($340)" ] }, { "kind": "COMPUTE", "substeps": [ "$340 := divide(add(subtract(subtract($520, $519), $517), $518), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$510 := $490, $511 := $491, $512 := $492, $513 := $493, $514 := $494, $515 := $495, $516 := $496, $517 := $498, $518 := $499, $519 := $500, $520 := $501, $521 := $141", "INNER HASH JOIN EACH WITH ALL ON $497 = $140" ] }, { "kind": "JOIN", "substeps": [ "$497 := $130, $498 := $132, $499 := $133, $500 := $134, $501 := $135, $490 := $121, $491 := $122, $492 := $123, $493 := $124, $494 := $125, $495 := $126, $496 := $127", "INNER HASH JOIN EACH WITH ALL ON $131 = $120" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "TO __stage13_output", "BY HASH($530, $531, $532, $533, $534, $535, $536, $537)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "22", "writeMsMax": "27", "writeRatioAvg": 0.0134886572654813, "writeRatioMax": 0.01655426118945432 }, { "completedParallelInputs": "6", "computeMsAvg": "1146", "computeMsMax": "1631", "computeRatioAvg": 0.7026364193746168, "computeRatioMax": 1, "endMs": "1665776732107", "id": "20", "inputStages": [ "8", "6" ], "name": "S14: Join+", "parallelInputs": "6", "readMsAvg": "31", "readMsMax": "46", "readRatioAvg": 0.01900674432863274, "readRatioMax": 0.028203556100551808, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24171617", "shuffleOutputBytesSpilled": "0", "slotMs": "6379", "startMs": "1665776731179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_sales_price, $104:ss_ext_wholesale_cost, $105:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $440, $461 := $441, $462 := $442, $463 := $443, $464 := $444, $465 := $445, $466 := $446, $467 := $451", "$300 := SUM($330)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := divide(add(subtract(subtract($450, $449), $447), $448), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$440 := $420, $441 := $421, $442 := $422, $443 := $423, $444 := $424, $445 := $425, $446 := $426, $447 := $428, $448 := $429, $449 := $430, $450 := $431, $451 := $111", "INNER HASH JOIN EACH WITH ALL ON $427 = $110" ] }, { "kind": "JOIN", "substeps": [ "$427 := $100, $428 := $102, $429 := $103, $430 := $104, $431 := $105, $420 := $91, $421 := $92, $422 := $93, $423 := $94, $424 := $95, $425 := $96, $426 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "TO __stage14_output", "BY HASH($460, $461, $462, $463, $464, $465, $466, $467)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.004904966278356836, "writeRatioMax": 0.0061312078479460455 }, { "completedParallelInputs": "5", "computeMsAvg": "674", "computeMsMax": "823", "computeRatioAvg": 0.4132434089515635, "computeRatioMax": 0.5045984058859595, "endMs": "1665776731776", "id": "21", "inputStages": [ "11", "9" ], "name": "S15: Join+", "parallelInputs": "5", "readMsAvg": "30", "readMsMax": "34", "readRatioAvg": 0.018393623543838136, "readRatioMax": 0.020846106683016553, "recordsRead": "1943373", "recordsWritten": "115475", "shuffleOutputBytes": "13828714", "shuffleOutputBytesSpilled": "0", "slotMs": "3094", "startMs": "1665776731271", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cs_sold_date_sk, $71:cs_bill_customer_sk, $72:cs_ext_discount_amt, $73:cs_ext_sales_price, $74:cs_ext_wholesale_cost, $75:cs_ext_list_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $600 := $580, $601 := $581, $602 := $582, $603 := $583, $604 := $584, $605 := $585, $606 := $586, $607 := $591", "$260 := SUM($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := divide(add(subtract(subtract($590, $589), $587), $588), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$580 := $560, $581 := $561, $582 := $562, $583 := $563, $584 := $564, $585 := $565, $586 := $566, $587 := $568, $588 := $569, $589 := $570, $590 := $571, $591 := $81", "INNER HASH JOIN EACH WITH ALL ON $567 = $80" ] }, { "kind": "JOIN", "substeps": [ "$567 := $70, $568 := $72, $569 := $73, $570 := $74, $571 := $75, $560 := $61, $561 := $62, $562 := $63, $563 := $64, $564 := $65, $565 := $66, $566 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "TO __stage15_output", "BY HASH($600, $601, $602, $603, $604, $605, $606, $607)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.001226241569589209, "writeMsAvg": "22", "writeMsMax": "24", "writeRatioAvg": 0.0134886572654813, "writeRatioMax": 0.014714898835070508 }, { "completedParallelInputs": "1", "computeMsAvg": "905", "computeMsMax": "905", "computeRatioAvg": 0.5548743102391172, "computeRatioMax": 0.5548743102391172, "endMs": "1665776731851", "id": "22", "inputStages": [ "12", "14" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "41", "readMsMax": "41", "readRatioAvg": 0.025137952176578784, "readRatioMax": 0.025137952176578784, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "786", "startMs": "1665776731285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_sold_date_sk, $41:ws_bill_customer_sk, $42:ws_ext_discount_amt, $43:ws_ext_sales_price, $44:ws_ext_wholesale_cost, $45:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $670 := $650, $671 := $651, $672 := $652, $673 := $653, $674 := $654, $675 := $655, $676 := $656, $677 := $661", "$230 := SUM($270)" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := divide(add(subtract(subtract($660, $659), $657), $658), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$650 := $630, $651 := $631, $652 := $632, $653 := $633, $654 := $634, $655 := $635, $656 := $636, $657 := $638, $658 := $639, $659 := $640, $660 := $641, $661 := $51", "INNER HASH JOIN EACH WITH ALL ON $637 = $50" ] }, { "kind": "JOIN", "substeps": [ "$637 := $40, $638 := $42, $639 := $43, $640 := $44, $641 := $45, $630 := $31, $631 := $32, $632 := $33, $633 := $34, $634 := $35, $635 := $36, $636 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "TO __stage16_output", "BY HASH($670, $671, $672, $673, $674, $675, $676, $677)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.012875536480686695, "writeRatioMax": 0.012875536480686695 }, { "completedParallelInputs": "1", "computeMsAvg": "843", "computeMsMax": "843", "computeRatioAvg": 0.5168608215818516, "computeRatioMax": 0.5168608215818516, "endMs": "1665776731916", "id": "23", "inputStages": [ "17", "15" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "34", "readMsMax": "34", "readRatioAvg": 0.020846106683016553, "readRatioMax": 0.020846106683016553, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "765", "startMs": "1665776731377", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_sales_price, $14:ws_ext_wholesale_cost, $15:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage11_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $740 := $720, $741 := $721, $742 := $722, $743 := $723, $744 := $724, $745 := $725, $746 := $726, $747 := $731", "$200 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := divide(add(subtract(subtract($730, $729), $727), $728), NUMERIC<...>)" ] }, { "kind": "JOIN", "substeps": [ "$720 := $700, $721 := $701, $722 := $702, $723 := $703, $724 := $704, $725 := $705, $726 := $706, $727 := $708, $728 := $709, $729 := $710, $730 := $711, $731 := $21", "INNER HASH JOIN EACH WITH ALL ON $707 = $20" ] }, { "kind": "JOIN", "substeps": [ "$707 := $10, $708 := $12, $709 := $13, $710 := $14, $711 := $15, $700 := $2, $701 := $3, $702 := $4, $703 := $5, $704 := $6, $705 := $7, $706 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "TO __stage17_output", "BY HASH($740, $741, $742, $743, $744, $745, $746, $747)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001226241569589209, "waitRatioMax": 0.001226241569589209, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.012875536480686695, "writeRatioMax": 0.012875536480686695 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.022072348252605765, "computeRatioMax": 0.022072348252605765, "endMs": "1665776732175", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665776732126", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$740, $741, $742, $743, $744, $745, $746, $747, $200", "FROM __stage17_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $750 := $740, $751 := $741, $752 := $742, $753 := $743, $754 := $744, $755 := $745, $756 := $746, $757 := $747", "$180 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$180, $750", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.014714898835070508, "writeRatioMax": 0.014714898835070508 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.03372164316370325, "computeRatioMax": 0.03372164316370325, "endMs": "1665776732203", "id": "25", "inputStages": [ "22" ], "name": "S19: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665776732143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$670, $671, $672, $673, $674, $675, $676, $677, $230", "FROM __stage16_output" ] }, { "kind": "FILTER", "substeps": [ "greater($190, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674, $685 := $675, $686 := $676, $687 := $677", "$190 := SUM($230)" ] }, { "kind": "WRITE", "substeps": [ "$190, $680", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.014714898835070508, "writeRatioMax": 0.014714898835070508 }, { "completedParallelInputs": "1", "computeMsAvg": "126", "computeMsMax": "126", "computeRatioAvg": 0.07725321888412018, "computeRatioMax": 0.07725321888412018, "endMs": "1665776732253", "id": "26", "inputStages": [ "21" ], "name": "S1A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "115475", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "132", "startMs": "1665776732158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$600, $601, $602, $603, $604, $605, $606, $607, $260", "FROM __stage15_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $610 := $600, $611 := $601, $612 := $602, $613 := $603, $614 := $604, $615 := $605, $616 := $606, $617 := $607", "$210 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$210, $610", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.012262415695892091, "writeRatioMax": 0.012262415695892091 }, { "completedParallelInputs": "1", "computeMsAvg": "151", "computeMsMax": "151", "computeRatioAvg": 0.09258123850398528, "computeRatioMax": 0.09258123850398528, "endMs": "1665776732282", "id": "27", "inputStages": [ "19" ], "name": "S1B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "116084", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "162", "startMs": "1665776732174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535, $536, $537, $310", "FROM __stage13_output" ] }, { "kind": "FILTER", "substeps": [ "greater($250, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $540 := $530, $541 := $531, $542 := $532, $543 := $533, $544 := $534, $545 := $535, $546 := $536, $547 := $537", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$250, $540", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.011649294911097487, "writeRatioMax": 0.011649294911097487 }, { "completedParallelInputs": "1", "computeMsAvg": "387", "computeMsMax": "387", "computeRatioAvg": 0.23727774371551197, "computeRatioMax": 0.23727774371551197, "endMs": "1665776732442", "id": "28", "inputStages": [ "20" ], "name": "S1C: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2768741", "shuffleOutputBytesSpilled": "0", "slotMs": "389", "startMs": "1665776732191", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$460, $461, $462, $463, $464, $465, $466, $467, $300", "FROM __stage14_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $460, $471 := $461, $472 := $462, $473 := $463, $474 := $464, $475 := $465, $476 := $466, $477 := $467", "$240 := SUM($300)" ] }, { "kind": "WRITE", "substeps": [ "$240, $470, $471, $472, $474", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0006131207847946045, "waitRatioMax": 0.0006131207847946045, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.014101778050275904, "writeRatioMax": 0.014101778050275904 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "23", "computeRatioAvg": 0.005518087063151441, "computeRatioMax": 0.014101778050275904, "endMs": "1665776732555", "id": "30", "inputStages": [ "28" ], "name": "S1E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2768741", "shuffleOutputBytesSpilled": "0", "slotMs": "3616", "startMs": "1665776732490", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.0018393623543838135, "waitRatioMax": 0.0030656039239730227, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.009809932556713672, "writeRatioMax": 0.017780502759043533 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.004904966278356836, "computeRatioMax": 0.009196811771919068, "endMs": "1665776732567", "id": "31", "inputStages": [ "27" ], "name": "S1F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26314", "recordsWritten": "26314", "shuffleOutputBytes": "999932", "shuffleOutputBytesSpilled": "0", "slotMs": "3997", "startMs": "1665776732491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1B_output" ] } ], "waitMsAvg": "7", "waitMsMax": "9", "waitRatioAvg": 0.004291845493562232, "waitRatioMax": 0.005518087063151441, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.008583690987124463, "writeRatioMax": 0.01655426118945432 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.005518087063151441, "computeRatioMax": 0.009196811771919068, "endMs": "1665776732571", "id": "32", "inputStages": [ "26" ], "name": "S20: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27177", "recordsWritten": "27177", "shuffleOutputBytes": "1032726", "shuffleOutputBytesSpilled": "0", "slotMs": "4112", "startMs": "1665776732492", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage1A_output" ] } ], "waitMsAvg": "8", "waitMsMax": "9", "waitRatioAvg": 0.004904966278356836, "waitRatioMax": 0.005518087063151441, "writeMsAvg": "22", "writeMsMax": "56", "writeRatioAvg": 0.0134886572654813, "writeRatioMax": 0.034334763948497854 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "17", "computeRatioAvg": 0.004291845493562232, "computeRatioMax": 0.010423053341508276, "endMs": "1665776732566", "id": "33", "inputStages": [ "25" ], "name": "S21: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11324", "recordsWritten": "11324", "shuffleOutputBytes": "430312", "shuffleOutputBytesSpilled": "0", "slotMs": "2490", "startMs": "1665776732491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage19_output" ] } ], "waitMsAvg": "9", "waitMsMax": "10", "waitRatioAvg": 0.005518087063151441, "waitRatioMax": 0.0061312078479460455, "writeMsAvg": "4", "writeMsMax": "20", "writeRatioAvg": 0.002452483139178418, "writeRatioMax": 0.012262415695892091 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.004291845493562232, "computeRatioMax": 0.009809932556713672, "endMs": "1665776732555", "id": "34", "inputStages": [ "24" ], "name": "S22: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "1887", "startMs": "1665776732491", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage18_output" ] } ], "waitMsAvg": "9", "waitMsMax": "11", "waitRatioAvg": 0.005518087063151441, "waitRatioMax": 0.00674432863274065, "writeMsAvg": "3", "writeMsMax": "17", "writeRatioAvg": 0.0018393623543838135, "writeRatioMax": 0.010423053341508276 }, { "completedParallelInputs": "1", "computeMsAvg": "418", "computeMsMax": "418", "computeRatioAvg": 0.2562844880441447, "computeRatioMax": 0.2562844880441447, "endMs": "1665776732834", "id": "35", "inputStages": [ "31", "18", "30", "33", "32", "34" ], "name": "S23: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "314993", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "392", "startMs": "1665776732515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $402, $403, $404, $405, $406, $407, $320", "FROM __stage12_output" ] }, { "kind": "READ", "substeps": [ "$240, $470, $471, $472, $474", "FROM __stage1E_output" ] }, { "kind": "READ", "substeps": [ "$250, $540", "FROM __stage1F_output" ] }, { "kind": "READ", "substeps": [ "$210, $610", "FROM __stage20_output" ] }, { "kind": "READ", "substeps": [ "$190, $680", "FROM __stage21_output" ] }, { "kind": "READ", "substeps": [ "$180, $750", "FROM __stage22_output" ] }, { "kind": "SORT", "substeps": [ "$760 ASC, $761 ASC, $762 ASC, $763 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($766, NUMERIC<...>), divide($765, $766), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$760 := $690, $761 := $691, $762 := $692, $763 := $693, $764 := $697, $765 := $695, $766 := $696, $767 := $180", "INNER HASH JOIN EACH WITH ALL ON $694 = $750" ] }, { "kind": "JOIN", "substeps": [ "$690 := $620, $691 := $621, $692 := $622, $693 := $623, $694 := $624, $695 := $628, $696 := $626, $697 := $190", "INNER HASH JOIN EACH WITH ALL ON $624 = $680" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($626, NUMERIC<...>), divide($628, $626), NULL), ...)" ] }, { "kind": "JOIN", "substeps": [ "$620 := $550, $621 := $551, $622 := $552, $623 := $553, $624 := $554, $625 := $555, $626 := $557, $627 := $556, $628 := $210", "INNER HASH JOIN EACH WITH ALL ON $554 = $610" ] }, { "kind": "JOIN", "substeps": [ "$550 := $482, $551 := $483, $552 := $484, $553 := $485, $554 := $480, $555 := $486, $556 := $481, $557 := $250", "INNER HASH JOIN EACH WITH ALL ON $480 = $540" ] }, { "kind": "JOIN", "substeps": [ "$480 := $410, $481 := $280, $482 := $470, $483 := $471, $484 := $472, $485 := $474, $486 := $240", "INNER HASH JOIN EACH WITH ALL ON $410 = $470" ] }, { "kind": "FILTER", "substeps": [ "greater($280, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400, $411 := $401, $412 := $402, $413 := $403, $414 := $404, $415 := $405, $416 := $406, $417 := $407", "$280 := SUM($320)" ] }, { "kind": "WRITE", "substeps": [ "$770, $771, $772, $773", "TO __stage23_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.00797057020232986, "waitRatioMax": 0.00797057020232986, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0006131207847946045, "writeRatioMax": 0.0006131207847946045 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.00674432863274065, "computeRatioMax": 0.00674432863274065, "endMs": "1665776732890", "id": "36", "inputStages": [ "35" ], "name": "S24: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8", "recordsWritten": "8", "shuffleOutputBytes": "451", "shuffleOutputBytesSpilled": "0", "slotMs": "276", "startMs": "1665776732514", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$770, $771, $772, $773", "FROM __stage23_output" ] }, { "kind": "SORT", "substeps": [ "$770 ASC, $771 ASC, $772 ASC, $773 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$780, $781, $782, $783", "TO __stage24_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.003678724708767627, "waitRatioMax": 0.003678724708767627, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.002452483139178418, "writeRatioMax": 0.002452483139178418 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "24", "completedUnits": "12", "elapsedMs": "646", "estimatedRunnableUnits": "0", "pendingUnits": "24", "totalSlotMs": "4408" }, { "activeUnits": "11", "completedUnits": "40", "elapsedMs": "1692", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "24633" }, { "activeUnits": "2", "completedUnits": "543", "elapsedMs": "2270", "estimatedRunnableUnits": "6", "pendingUnits": "0", "totalSlotMs": "41887" } ], "totalBytesBilled": "402653184", "totalBytesProcessed": "401794978", "totalPartitionsProcessed": "0", "totalSlotMs": "41887", "transferredBytes": "0" }, "startTime": "1665776730699", "totalBytesProcessed": "401794978", "totalSlotMs": "41887" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
