{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbf718b40_362c_4017_84c1_c15ff6c9f2c1" }, "priority": "INTERACTIVE", "query": "-- start query 62 in stream 0 using template query62.tpl\nselect \n substr(w_warehouse_name,1,20)\n ,sm_type\n ,web_name\n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as days_30 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as days_31_60 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as days_61_90 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as days_91_120 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as more_120_days\nfrom\n web_sales\n ,warehouse\n ,ship_mode\n ,web_site\n ,date_dim\nwhere\n d_month_seq between 1200 and 1200 + 11\nand ws_ship_date_sk = d_date_sk\nand ws_warehouse_sk = w_warehouse_sk\nand ws_ship_mode_sk = sm_ship_mode_sk\nand ws_web_site_sk = web_site_sk\ngroup by\n 1\n ,sm_type\n ,web_name\norder by 1\n ,sm_type\n ,web_name\n limit 100\n;\n\n-- end query 62 in stream 0 using template query62.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "TuVS6hoU9hTBV/7kTsUZQw==", "id": "test-project-364309:europe-west1.query62_1665768408", "jobReference": { "jobId": "query62_1665768408", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query62_1665768408?location=europe-west1", "statistics": { "creationTime": "1665768409331", "endTime": "1665768410157", "finalExecutionDurationMs": "591", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "29937852", "performanceInsights": { "avgPreviousExecutionMs": "583" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03263403263403263, "computeRatioMax": 0.03263403263403263, "endMs": "1665768409557", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.023310023310023312, "readRatioMax": 0.023310023310023312, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768409510", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_month_seq", "FROM date_dim", "WHERE between($11, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03496503496503497, "writeRatioMax": 0.03496503496503497 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.027972027972027972, "computeRatioMax": 0.027972027972027972, "endMs": "1665768409579", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013986013986013986, "readRatioMax": 0.013986013986013986, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "600", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768409532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:web_site_sk, $2:web_name", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04195804195804196, "writeRatioMax": 0.04195804195804196 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02097902097902098, "computeRatioMax": 0.02097902097902098, "endMs": "1665768409598", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.046620046620046623, "readRatioMax": 0.046620046620046623, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768409550", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sm_ship_mode_sk, $21:sm_type", "FROM ship_mode" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.016317016317016316, "writeRatioMax": 0.016317016317016316 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.027972027972027972, "computeRatioMax": 0.027972027972027972, "endMs": "1665768409627", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011655011655011656, "readRatioMax": 0.011655011655011656, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768409573", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:w_warehouse_sk, $41:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.06993006993006994, "writeRatioMax": 0.06993006993006994 }, { "completedParallelInputs": "1", "computeMsAvg": "429", "computeMsMax": "429", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768409977", "id": "5", "inputStages": [ "1", "2", "3", "0" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "68", "readMsMax": "68", "readRatioAvg": 0.1585081585081585, "readRatioMax": 0.1585081585081585, "recordsRead": "719805", "recordsWritten": "150", "shuffleOutputBytes": "13005", "shuffleOutputBytesSpilled": "0", "slotMs": "431", "startMs": "1665768409636", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ship_date_sk, $32:ws_web_site_sk, $33:ws_ship_mode_sk, $34:ws_warehouse_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $70, $121 := $111, $122 := $110", "$60 := SUM($75)", "$61 := SUM($74)", "$62 := SUM($73)", "$63 := SUM($72)", "$64 := SUM($71)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := substr($114, 1, 20)", "$71 := case_no_value(greater(subtract($113, $112), 120), 1, 0)", "$72 := case_no_value(and(greater(subtract($113, $112), 90), less_or_equal(subtract($113, $112), 120)), 1, 0)", "$73 := case_no_value(and(greater(subtract($113, $112), 60), less_or_equal(subtract($113, $112), 90)), 1, 0)", "$74 := case_no_value(and(greater(subtract($113, $112), 30), less_or_equal(subtract($113, $112), 60)), 1, 0)", "$75 := case_no_value(less_or_equal(subtract($113, $112), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $104, $111 := $100, $112 := $101, $113 := $102, $114 := $103", "INNER HASH JOIN EACH WITH ALL ON $102 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $91, $103 := $93, $104 := $2", "INNER HASH JOIN EACH WITH ALL ON $92 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $81, $92 := $82, $93 := $84, $94 := $21", "INNER HASH JOIN EACH WITH ALL ON $83 = $20" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $33, $84 := $41", "INNER HASH JOIN EACH WITH ALL ON $34 = $40" ] }, { "kind": "WRITE", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "TO __stage05_output", "BY HASH($120, $121, $122)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.011655011655011656, "writeRatioMax": 0.011655011655011656 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016317016317016316, "computeRatioMax": 0.016317016317016316, "endMs": "1665768410017", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665768410005", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121, $132 := $122", "$50 := SUM($60)", "$51 := SUM($61)", "$52 := SUM($62)", "$53 := SUM($63)", "$54 := SUM($64)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004662004662004662, "waitRatioMax": 0.004662004662004662, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002331002331002331, "writeRatioMax": 0.002331002331002331 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02564102564102564, "computeRatioMax": 0.02564102564102564, "endMs": "1665768410066", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768410026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$147 ASC, $141 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.06526806526806526, "writeRatioMax": 0.06526806526806526 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "621", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "597" }, { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "704", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "647" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "29937852", "totalPartitionsProcessed": "0", "totalSlotMs": "647", "transferredBytes": "0" }, "startTime": "1665768409390", "totalBytesProcessed": "29937852", "totalSlotMs": "647" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon7a1ff546_fdc5_4cc6_a516_8eab2b43e872" }, "priority": "INTERACTIVE", "query": "-- start query 62 in stream 0 using template query62.tpl\nselect \n substr(w_warehouse_name,1,20)\n ,sm_type\n ,web_name\n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as days_30 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as days_31_60 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as days_61_90 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as days_91_120 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as more_120_days\nfrom\n web_sales\n ,warehouse\n ,ship_mode\n ,web_site\n ,date_dim\nwhere\n d_month_seq between 1200 and 1200 + 11\nand ws_ship_date_sk = d_date_sk\nand ws_warehouse_sk = w_warehouse_sk\nand ws_ship_mode_sk = sm_ship_mode_sk\nand ws_web_site_sk = web_site_sk\ngroup by\n 1\n ,sm_type\n ,web_name\norder by 1\n ,sm_type\n ,web_name\n limit 100\n;\n\n-- end query 62 in stream 0 using template query62.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "tqcPPDH1LORumm8PB6EBAg==", "id": "test-project-364309:europe-west1.query62_1665777891", "jobReference": { "jobId": "query62_1665777891", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query62_1665777891?location=europe-west1", "statistics": { "creationTime": "1665777892527", "endTime": "1665777893350", "finalExecutionDurationMs": "609", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "29937852", "performanceInsights": { "avgPreviousExecutionMs": "584" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.01680672268907563, "endMs": "1665777892732", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.013445378151260505, "readRatioMax": 0.013445378151260505, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777892696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_month_seq", "FROM date_dim", "WHERE between($11, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0033613445378151263, "waitRatioMax": 0.0033613445378151263, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013445378151260505, "writeRatioMax": 0.013445378151260505 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.011764705882352941, "computeRatioMax": 0.011764705882352941, "endMs": "1665777892738", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.021848739495798318, "readRatioMax": 0.021848739495798318, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "600", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777892707", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:web_site_sk, $2:web_name", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016806722689075631, "waitRatioMax": 0.0016806722689075631, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01680672268907563, "writeRatioMax": 0.01680672268907563 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.018487394957983194, "computeRatioMax": 0.018487394957983194, "endMs": "1665777892758", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011764705882352941, "readRatioMax": 0.011764705882352941, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777892722", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sm_ship_mode_sk, $21:sm_type", "FROM ship_mode" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016806722689075631, "waitRatioMax": 0.0016806722689075631, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.013445378151260505, "writeRatioMax": 0.013445378151260505 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.015126050420168067, "computeRatioMax": 0.015126050420168067, "endMs": "1665777892781", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010084033613445379, "readRatioMax": 0.010084033613445379, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777892738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:w_warehouse_sk, $41:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage03_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0067226890756302525, "waitRatioMax": 0.0067226890756302525, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.02689075630252101, "writeRatioMax": 0.02689075630252101 }, { "completedParallelInputs": "1", "computeMsAvg": "595", "computeMsMax": "595", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777893123", "id": "5", "inputStages": [ "1", "3", "2", "0" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.025210084033613446, "readRatioMax": 0.025210084033613446, "recordsRead": "719805", "recordsWritten": "150", "shuffleOutputBytes": "13005", "shuffleOutputBytesSpilled": "0", "slotMs": "423", "startMs": "1665777892792", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ship_date_sk, $32:ws_web_site_sk, $33:ws_ship_mode_sk, $34:ws_warehouse_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $70, $121 := $111, $122 := $110", "$60 := SUM($75)", "$61 := SUM($74)", "$62 := SUM($73)", "$63 := SUM($72)", "$64 := SUM($71)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := substr($114, 1, 20)", "$71 := case_no_value(greater(subtract($113, $112), 120), 1, 0)", "$72 := case_no_value(and(greater(subtract($113, $112), 90), less_or_equal(subtract($113, $112), 120)), 1, 0)", "$73 := case_no_value(and(greater(subtract($113, $112), 60), less_or_equal(subtract($113, $112), 90)), 1, 0)", "$74 := case_no_value(and(greater(subtract($113, $112), 30), less_or_equal(subtract($113, $112), 60)), 1, 0)", "$75 := case_no_value(less_or_equal(subtract($113, $112), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $104, $111 := $100, $112 := $101, $113 := $102, $114 := $103", "INNER HASH JOIN EACH WITH ALL ON $102 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $91, $103 := $93, $104 := $2", "INNER HASH JOIN EACH WITH ALL ON $92 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $81, $92 := $82, $93 := $84, $94 := $21", "INNER HASH JOIN EACH WITH ALL ON $83 = $20" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $33, $84 := $41", "INNER HASH JOIN EACH WITH ALL ON $34 = $40" ] }, { "kind": "WRITE", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "TO __stage05_output", "BY HASH($120, $121, $122)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016806722689075631, "waitRatioMax": 0.0016806722689075631, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.010084033613445379, "writeRatioMax": 0.010084033613445379 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.021848739495798318, "computeRatioMax": 0.021848739495798318, "endMs": "1665777893242", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777893220", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121, $132 := $122", "$50 := SUM($60)", "$51 := SUM($61)", "$52 := SUM($62)", "$53 := SUM($63)", "$54 := SUM($64)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0033613445378151263, "waitRatioMax": 0.0033613445378151263, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.005042016806722689, "writeRatioMax": 0.005042016806722689 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.018487394957983194, "computeRatioMax": 0.018487394957983194, "endMs": "1665777893267", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777893233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$147 ASC, $141 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0033613445378151263, "waitRatioMax": 0.0033613445378151263, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.023529411764705882, "writeRatioMax": 0.023529411764705882 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "5", "elapsedMs": "603", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "566" }, { "activeUnits": "0", "completedUnits": "7", "elapsedMs": "708", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "628" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "29937852", "totalPartitionsProcessed": "0", "totalSlotMs": "628", "transferredBytes": "0" }, "startTime": "1665777892593", "totalBytesProcessed": "29937852", "totalSlotMs": "628" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb4dfa460_4082_4e0d_9a5e_9cf2c62c6f37" }, "priority": "INTERACTIVE", "query": "-- start query 62 in stream 0 using template query62.tpl\nselect \n substr(w_warehouse_name,1,20)\n ,sm_type\n ,web_name\n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as days_30 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as days_31_60 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as days_61_90 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as days_91_120 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as more_120_days\nfrom\n web_sales\n ,warehouse\n ,ship_mode\n ,web_site\n ,date_dim\nwhere\n d_month_seq between 1200 and 1200 + 11\nand ws_ship_date_sk = d_date_sk\nand ws_warehouse_sk = w_warehouse_sk\nand ws_ship_mode_sk = sm_ship_mode_sk\nand ws_web_site_sk = web_site_sk\ngroup by\n 1\n ,sm_type\n ,web_name\norder by 1\n ,sm_type\n ,web_name\n limit 100\n;\n\n-- end query 62 in stream 0 using template query62.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "TqPIC7nltU7jUYIWzBZ3Eg==", "id": "test-project-364309:europe-west1.query62_1665777894", "jobReference": { "jobId": "query62_1665777894", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query62_1665777894?location=europe-west1", "statistics": { "creationTime": "1665777894995", "endTime": "1665777895769", "finalExecutionDurationMs": "583", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "29937852", "performanceInsights": { "avgPreviousExecutionMs": "587" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.020766773162939296, "computeRatioMax": 0.020766773162939296, "endMs": "1665777895178", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.01437699680511182, "readRatioMax": 0.01437699680511182, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777895135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_month_seq", "FROM date_dim", "WHERE between($11, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.01597444089456869, "writeRatioMax": 0.01597444089456869 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.012779552715654952, "computeRatioMax": 0.012779552715654952, "endMs": "1665777895181", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.009584664536741214, "readRatioMax": 0.009584664536741214, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "600", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777895148", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:web_site_sk, $2:web_name", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.02875399361022364, "writeRatioMax": 0.02875399361022364 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.009584664536741214, "computeRatioMax": 0.009584664536741214, "endMs": "1665777895192", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.007987220447284345, "readRatioMax": 0.007987220447284345, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777895161", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sm_ship_mode_sk, $21:sm_type", "FROM ship_mode" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003194888178913738, "waitRatioMax": 0.003194888178913738, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.03035143769968051, "writeRatioMax": 0.03035143769968051 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.027156549520766772, "computeRatioMax": 0.027156549520766772, "endMs": "1665777895229", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011182108626198083, "readRatioMax": 0.011182108626198083, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777895189", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:w_warehouse_sk, $41:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003194888178913738, "waitRatioMax": 0.003194888178913738, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01757188498402556, "writeRatioMax": 0.01757188498402556 }, { "completedParallelInputs": "1", "computeMsAvg": "626", "computeMsMax": "626", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777895597", "id": "5", "inputStages": [ "1", "3", "2", "0" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.022364217252396165, "readRatioMax": 0.022364217252396165, "recordsRead": "719805", "recordsWritten": "150", "shuffleOutputBytes": "13005", "shuffleOutputBytesSpilled": "0", "slotMs": "544", "startMs": "1665777895242", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ship_date_sk, $32:ws_web_site_sk, $33:ws_ship_mode_sk, $34:ws_warehouse_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $70, $121 := $111, $122 := $110", "$60 := SUM($75)", "$61 := SUM($74)", "$62 := SUM($73)", "$63 := SUM($72)", "$64 := SUM($71)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := substr($114, 1, 20)", "$71 := case_no_value(greater(subtract($113, $112), 120), 1, 0)", "$72 := case_no_value(and(greater(subtract($113, $112), 90), less_or_equal(subtract($113, $112), 120)), 1, 0)", "$73 := case_no_value(and(greater(subtract($113, $112), 60), less_or_equal(subtract($113, $112), 90)), 1, 0)", "$74 := case_no_value(and(greater(subtract($113, $112), 30), less_or_equal(subtract($113, $112), 60)), 1, 0)", "$75 := case_no_value(less_or_equal(subtract($113, $112), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $104, $111 := $100, $112 := $101, $113 := $102, $114 := $103", "INNER HASH JOIN EACH WITH ALL ON $102 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $91, $103 := $93, $104 := $2", "INNER HASH JOIN EACH WITH ALL ON $92 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $81, $92 := $82, $93 := $84, $94 := $21", "INNER HASH JOIN EACH WITH ALL ON $83 = $20" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $33, $84 := $41", "INNER HASH JOIN EACH WITH ALL ON $34 = $40" ] }, { "kind": "WRITE", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "TO __stage05_output", "BY HASH($120, $121, $122)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.007987220447284345, "writeRatioMax": 0.007987220447284345 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.012779552715654952, "computeRatioMax": 0.012779552715654952, "endMs": "1665777895645", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665777895632", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121, $132 := $122", "$50 := SUM($60)", "$51 := SUM($61)", "$52 := SUM($62)", "$53 := SUM($63)", "$54 := SUM($64)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003194888178913738, "waitRatioMax": 0.003194888178913738, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001597444089456869, "writeRatioMax": 0.001597444089456869 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01757188498402556, "computeRatioMax": 0.01757188498402556, "endMs": "1665777895686", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777895646", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$147 ASC, $141 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001597444089456869, "waitRatioMax": 0.001597444089456869, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.04792332268370607, "writeRatioMax": 0.04792332268370607 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "596", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "691" }, { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "676", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "747" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "29937852", "totalPartitionsProcessed": "0", "totalSlotMs": "747", "transferredBytes": "0" }, "startTime": "1665777895041", "totalBytesProcessed": "29937852", "totalSlotMs": "747" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon91d357a7_c79e_4111_ac8b_91add6121e7f" }, "priority": "INTERACTIVE", "query": "-- start query 62 in stream 0 using template query62.tpl\nselect \n substr(w_warehouse_name,1,20)\n ,sm_type\n ,web_name\n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as days_30 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as days_31_60 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as days_61_90 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as days_91_120 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as more_120_days\nfrom\n web_sales\n ,warehouse\n ,ship_mode\n ,web_site\n ,date_dim\nwhere\n d_month_seq between 1200 and 1200 + 11\nand ws_ship_date_sk = d_date_sk\nand ws_warehouse_sk = w_warehouse_sk\nand ws_ship_mode_sk = sm_ship_mode_sk\nand ws_web_site_sk = web_site_sk\ngroup by\n 1\n ,sm_type\n ,web_name\norder by 1\n ,sm_type\n ,web_name\n limit 100\n;\n\n-- end query 62 in stream 0 using template query62.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "w783J6+BfZ1Nq2SzKpDJOw==", "id": "test-project-364309:europe-west1.query62_1665777896", "jobReference": { "jobId": "query62_1665777896", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query62_1665777896?location=europe-west1", "statistics": { "creationTime": "1665777897423", "endTime": "1665777898092", "finalExecutionDurationMs": "503", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "29937852", "performanceInsights": { "avgPreviousExecutionMs": "587" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.04087193460490463, "computeRatioMax": 0.04087193460490463, "endMs": "1665777897590", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03814713896457766, "readRatioMax": 0.03814713896457766, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777897558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_month_seq", "FROM date_dim", "WHERE between($11, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01634877384196185, "writeRatioMax": 0.01634877384196185 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.027247956403269755, "computeRatioMax": 0.027247956403269755, "endMs": "1665777897612", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01634877384196185, "readRatioMax": 0.01634877384196185, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "600", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777897578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:web_site_sk, $2:web_name", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02452316076294278, "writeRatioMax": 0.02452316076294278 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01907356948228883, "computeRatioMax": 0.01907356948228883, "endMs": "1665777897633", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01634877384196185, "readRatioMax": 0.01634877384196185, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777897594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sm_ship_mode_sk, $21:sm_type", "FROM ship_mode" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04087193460490463, "writeRatioMax": 0.04087193460490463 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02452316076294278, "computeRatioMax": 0.02452316076294278, "endMs": "1665777897642", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013623978201634877, "readRatioMax": 0.013623978201634877, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777897609", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:w_warehouse_sk, $41:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.05722070844686648, "writeRatioMax": 0.05722070844686648 }, { "completedParallelInputs": "1", "computeMsAvg": "367", "computeMsMax": "367", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777897906", "id": "5", "inputStages": [ "3", "0", "1", "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.05722070844686648, "readRatioMax": 0.05722070844686648, "recordsRead": "719805", "recordsWritten": "150", "shuffleOutputBytes": "13005", "shuffleOutputBytesSpilled": "0", "slotMs": "329", "startMs": "1665777897660", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ship_date_sk, $32:ws_web_site_sk, $33:ws_ship_mode_sk, $34:ws_warehouse_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $70, $121 := $111, $122 := $110", "$60 := SUM($75)", "$61 := SUM($74)", "$62 := SUM($73)", "$63 := SUM($72)", "$64 := SUM($71)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := substr($114, 1, 20)", "$71 := case_no_value(greater(subtract($113, $112), 120), 1, 0)", "$72 := case_no_value(and(greater(subtract($113, $112), 90), less_or_equal(subtract($113, $112), 120)), 1, 0)", "$73 := case_no_value(and(greater(subtract($113, $112), 60), less_or_equal(subtract($113, $112), 90)), 1, 0)", "$74 := case_no_value(and(greater(subtract($113, $112), 30), less_or_equal(subtract($113, $112), 60)), 1, 0)", "$75 := case_no_value(less_or_equal(subtract($113, $112), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $104, $111 := $100, $112 := $101, $113 := $102, $114 := $103", "INNER HASH JOIN EACH WITH ALL ON $102 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $91, $103 := $93, $104 := $2", "INNER HASH JOIN EACH WITH ALL ON $92 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $81, $92 := $82, $93 := $84, $94 := $21", "INNER HASH JOIN EACH WITH ALL ON $83 = $20" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $33, $84 := $41", "INNER HASH JOIN EACH WITH ALL ON $34 = $40" ] }, { "kind": "WRITE", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "TO __stage05_output", "BY HASH($120, $121, $122)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01907356948228883, "writeRatioMax": 0.01907356948228883 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.010899182561307902, "computeRatioMax": 0.010899182561307902, "endMs": "1665777897970", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665777897962", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121, $132 := $122", "$50 := SUM($60)", "$51 := SUM($61)", "$52 := SUM($62)", "$53 := SUM($63)", "$54 := SUM($64)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0027247956403269754, "writeRatioMax": 0.0027247956403269754 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.021798365122615803, "computeRatioMax": 0.021798365122615803, "endMs": "1665777898030", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777897992", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$147 ASC, $141 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.04632152588555858, "writeRatioMax": 0.04632152588555858 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "7", "elapsedMs": "594", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "513" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "29937852", "totalPartitionsProcessed": "0", "totalSlotMs": "513", "transferredBytes": "0" }, "startTime": "1665777897463", "totalBytesProcessed": "29937852", "totalSlotMs": "513" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon725e496f_ef14_4e68_9204_30afc858c972" }, "priority": "INTERACTIVE", "query": "-- start query 62 in stream 0 using template query62.tpl\nselect \n substr(w_warehouse_name,1,20)\n ,sm_type\n ,web_name\n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as days_30 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as days_31_60 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as days_61_90 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as days_91_120 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as more_120_days\nfrom\n web_sales\n ,warehouse\n ,ship_mode\n ,web_site\n ,date_dim\nwhere\n d_month_seq between 1200 and 1200 + 11\nand ws_ship_date_sk = d_date_sk\nand ws_warehouse_sk = w_warehouse_sk\nand ws_ship_mode_sk = sm_ship_mode_sk\nand ws_web_site_sk = web_site_sk\ngroup by\n 1\n ,sm_type\n ,web_name\norder by 1\n ,sm_type\n ,web_name\n limit 100\n;\n\n-- end query 62 in stream 0 using template query62.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "qXScnglcISjdVErEuCd61Q==", "id": "test-project-364309:europe-west1.query62_1665777899", "jobReference": { "jobId": "query62_1665777899", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query62_1665777899?location=europe-west1", "statistics": { "creationTime": "1665777899684", "endTime": "1665777900475", "finalExecutionDurationMs": "609", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "29937852", "performanceInsights": { "avgPreviousExecutionMs": "578" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.012131715771230503, "computeRatioMax": 0.012131715771230503, "endMs": "1665777899850", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010398613518197574, "readRatioMax": 0.010398613518197574, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777899823", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_month_seq", "FROM date_dim", "WHERE between($11, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017331022530329288, "waitRatioMax": 0.0017331022530329288, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.025996533795493933, "writeRatioMax": 0.025996533795493933 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.01559792027729636, "computeRatioMax": 0.01559792027729636, "endMs": "1665777899869", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010398613518197574, "readRatioMax": 0.010398613518197574, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "600", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777899838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:web_site_sk, $2:web_name", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034662045060658577, "waitRatioMax": 0.0034662045060658577, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03119584055459272, "writeRatioMax": 0.03119584055459272 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.010398613518197574, "computeRatioMax": 0.010398613518197574, "endMs": "1665777899879", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010398613518197574, "readRatioMax": 0.010398613518197574, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777899849", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sm_ship_mode_sk, $21:sm_type", "FROM ship_mode" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017331022530329288, "waitRatioMax": 0.0017331022530329288, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.03119584055459272, "writeRatioMax": 0.03119584055459272 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.008665511265164644, "computeRatioMax": 0.008665511265164644, "endMs": "1665777899886", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.006932409012131715, "readRatioMax": 0.006932409012131715, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665777899861", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:w_warehouse_sk, $41:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017331022530329288, "waitRatioMax": 0.0017331022530329288, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.024263431542461005, "writeRatioMax": 0.024263431542461005 }, { "completedParallelInputs": "1", "computeMsAvg": "577", "computeMsMax": "577", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777900232", "id": "5", "inputStages": [ "2", "1", "3", "0" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.024263431542461005, "readRatioMax": 0.024263431542461005, "recordsRead": "719805", "recordsWritten": "150", "shuffleOutputBytes": "13005", "shuffleOutputBytesSpilled": "0", "slotMs": "494", "startMs": "1665777899897", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ship_date_sk, $32:ws_web_site_sk, $33:ws_ship_mode_sk, $34:ws_warehouse_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $70, $121 := $111, $122 := $110", "$60 := SUM($75)", "$61 := SUM($74)", "$62 := SUM($73)", "$63 := SUM($72)", "$64 := SUM($71)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := substr($114, 1, 20)", "$71 := case_no_value(greater(subtract($113, $112), 120), 1, 0)", "$72 := case_no_value(and(greater(subtract($113, $112), 90), less_or_equal(subtract($113, $112), 120)), 1, 0)", "$73 := case_no_value(and(greater(subtract($113, $112), 60), less_or_equal(subtract($113, $112), 90)), 1, 0)", "$74 := case_no_value(and(greater(subtract($113, $112), 30), less_or_equal(subtract($113, $112), 60)), 1, 0)", "$75 := case_no_value(less_or_equal(subtract($113, $112), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $104, $111 := $100, $112 := $101, $113 := $102, $114 := $103", "INNER HASH JOIN EACH WITH ALL ON $102 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $91, $103 := $93, $104 := $2", "INNER HASH JOIN EACH WITH ALL ON $92 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $81, $92 := $82, $93 := $84, $94 := $21", "INNER HASH JOIN EACH WITH ALL ON $83 = $20" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $33, $84 := $41", "INNER HASH JOIN EACH WITH ALL ON $34 = $40" ] }, { "kind": "WRITE", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "TO __stage05_output", "BY HASH($120, $121, $122)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017331022530329288, "waitRatioMax": 0.0017331022530329288, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.008665511265164644, "writeRatioMax": 0.008665511265164644 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.012131715771230503, "computeRatioMax": 0.012131715771230503, "endMs": "1665777900296", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "10", "startMs": "1665777900287", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121, $132 := $122", "$50 := SUM($60)", "$51 := SUM($61)", "$52 := SUM($62)", "$53 := SUM($63)", "$54 := SUM($64)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0034662045060658577, "waitRatioMax": 0.0034662045060658577, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02079722703639515, "computeRatioMax": 0.02079722703639515, "endMs": "1665777900391", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665777900299", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$147 ASC, $141 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017331022530329288, "waitRatioMax": 0.0017331022530329288, "writeMsAvg": "56", "writeMsMax": "56", "writeRatioAvg": 0.09705372616984402, "writeRatioMax": 0.09705372616984402 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "6", "elapsedMs": "590", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "602" }, { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "694", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "708" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "29937852", "totalPartitionsProcessed": "0", "totalSlotMs": "708", "transferredBytes": "0" }, "startTime": "1665777899734", "totalBytesProcessed": "29937852", "totalSlotMs": "708" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona0a8c84b_fe5b_47ef_89ad_0b0e52698e2f" }, "priority": "INTERACTIVE", "query": "-- start query 62 in stream 0 using template query62.tpl\nselect \n substr(w_warehouse_name,1,20)\n ,sm_type\n ,web_name\n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as days_30 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as days_31_60 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as days_61_90 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as days_91_120 \n ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as more_120_days\nfrom\n web_sales\n ,warehouse\n ,ship_mode\n ,web_site\n ,date_dim\nwhere\n d_month_seq between 1200 and 1200 + 11\nand ws_ship_date_sk = d_date_sk\nand ws_warehouse_sk = w_warehouse_sk\nand ws_ship_mode_sk = sm_ship_mode_sk\nand ws_web_site_sk = web_site_sk\ngroup by\n 1\n ,sm_type\n ,web_name\norder by 1\n ,sm_type\n ,web_name\n limit 100\n;\n\n-- end query 62 in stream 0 using template query62.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "YszBSWZcVdbquSdJMgobmg==", "id": "test-project-364309:europe-west1.query62_1665777901", "jobReference": { "jobId": "query62_1665777901", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query62_1665777901?location=europe-west1", "statistics": { "creationTime": "1665777902054", "endTime": "1665777902774", "finalExecutionDurationMs": "537", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "29937852", "performanceInsights": { "avgPreviousExecutionMs": "581" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0262582056892779, "computeRatioMax": 0.0262582056892779, "endMs": "1665777902234", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0175054704595186, "readRatioMax": 0.0175054704595186, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777902201", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_month_seq", "FROM date_dim", "WHERE between($11, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03282275711159737, "writeRatioMax": 0.03282275711159737 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0175054704595186, "computeRatioMax": 0.0175054704595186, "endMs": "1665777902256", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010940919037199124, "readRatioMax": 0.010940919037199124, "recordsRead": "30", "recordsWritten": "30", "shuffleOutputBytes": "600", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777902215", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:web_site_sk, $2:web_name", "FROM web_site" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.037199124726477024, "writeRatioMax": 0.037199124726477024 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0175054704595186, "computeRatioMax": 0.0175054704595186, "endMs": "1665777902281", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.010940919037199124, "readRatioMax": 0.010940919037199124, "recordsRead": "20", "recordsWritten": "20", "shuffleOutputBytes": "430", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777902234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sm_ship_mode_sk, $21:sm_type", "FROM ship_mode" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.04814004376367615, "writeRatioMax": 0.04814004376367615 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.028446389496717725, "computeRatioMax": 0.028446389496717725, "endMs": "1665777902286", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.015317286652078774, "readRatioMax": 0.015317286652078774, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "136", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777902249", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:w_warehouse_sk, $41:w_warehouse_name", "FROM warehouse" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00437636761487965, "waitRatioMax": 0.00437636761487965, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.0437636761487965, "writeRatioMax": 0.0437636761487965 }, { "completedParallelInputs": "1", "computeMsAvg": "457", "computeMsMax": "457", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777902593", "id": "5", "inputStages": [ "1", "3", "0", "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0262582056892779, "readRatioMax": 0.0262582056892779, "recordsRead": "719805", "recordsWritten": "150", "shuffleOutputBytes": "13005", "shuffleOutputBytesSpilled": "0", "slotMs": "420", "startMs": "1665777902294", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_ship_date_sk, $32:ws_web_site_sk, $33:ws_ship_mode_sk, $34:ws_warehouse_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $120 := $70, $121 := $111, $122 := $110", "$60 := SUM($75)", "$61 := SUM($74)", "$62 := SUM($73)", "$63 := SUM($72)", "$64 := SUM($71)" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := substr($114, 1, 20)", "$71 := case_no_value(greater(subtract($113, $112), 120), 1, 0)", "$72 := case_no_value(and(greater(subtract($113, $112), 90), less_or_equal(subtract($113, $112), 120)), 1, 0)", "$73 := case_no_value(and(greater(subtract($113, $112), 60), less_or_equal(subtract($113, $112), 90)), 1, 0)", "$74 := case_no_value(and(greater(subtract($113, $112), 30), less_or_equal(subtract($113, $112), 60)), 1, 0)", "$75 := case_no_value(less_or_equal(subtract($113, $112), 30), 1, 0)" ] }, { "kind": "JOIN", "substeps": [ "$110 := $104, $111 := $100, $112 := $101, $113 := $102, $114 := $103", "INNER HASH JOIN EACH WITH ALL ON $102 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $94, $101 := $90, $102 := $91, $103 := $93, $104 := $2", "INNER HASH JOIN EACH WITH ALL ON $92 = $1" ] }, { "kind": "JOIN", "substeps": [ "$90 := $80, $91 := $81, $92 := $82, $93 := $84, $94 := $21", "INNER HASH JOIN EACH WITH ALL ON $83 = $20" ] }, { "kind": "JOIN", "substeps": [ "$80 := $30, $81 := $31, $82 := $32, $83 := $33, $84 := $41", "INNER HASH JOIN EACH WITH ALL ON $34 = $40" ] }, { "kind": "WRITE", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "TO __stage05_output", "BY HASH($120, $121, $122)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.010940919037199124, "writeRatioMax": 0.010940919037199124 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0175054704595186, "computeRatioMax": 0.0175054704595186, "endMs": "1665777902674", "id": "6", "inputStages": [ "5" ], "name": "S06: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665777902659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$122, $121, $60, $61, $62, $63, $64, $120", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$130 ASC, $131 ASC, $132 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121, $132 := $122", "$50 := SUM($60)", "$51 := SUM($61)", "$52 := SUM($62)", "$53 := SUM($63)", "$54 := SUM($64)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002188183807439825, "writeRatioMax": 0.002188183807439825 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.019693654266958426, "computeRatioMax": 0.019693654266958426, "endMs": "1665777902709", "id": "7", "inputStages": [ "6" ], "name": "S07: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "8505", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777902674", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146, $147", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$147 ASC, $141 ASC, $140 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154, $155, $156, $157", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002188183807439825, "waitRatioMax": 0.002188183807439825, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.05908096280087528, "writeRatioMax": 0.05908096280087528 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "ship_mode" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "warehouse" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "6", "elapsedMs": "603", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "601" }, { "activeUnits": "1", "completedUnits": "7", "elapsedMs": "635", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "634" } ], "totalBytesBilled": "52428800", "totalBytesProcessed": "29937852", "totalPartitionsProcessed": "0", "totalSlotMs": "634", "transferredBytes": "0" }, "startTime": "1665777902099", "totalBytesProcessed": "29937852", "totalSlotMs": "634" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
