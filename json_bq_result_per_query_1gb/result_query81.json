{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb9b5f1e5_5700_414a_8a9e_2638eb23f4b7" }, "priority": "INTERACTIVE", "query": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n ,date_dim\n ,customer_address\n where cr_returned_date_sk = d_date_sk \n and d_year =2000\n and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n ,ca_state )\n select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "BbliCFplpzjFBeh3lSVGVg==", "id": "test-project-364309:europe-west1.query81_1665768485", "jobReference": { "jobId": "query81_1665768485", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query81_1665768485?location=europe-west1", "statistics": { "creationTime": "1665768486436", "endTime": "1665768487221", "finalExecutionDurationMs": "541", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "18097943", "performanceInsights": { "avgPreviousExecutionMs": "617" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.2446043165467626, "computeRatioMax": 0.2446043165467626, "endMs": "1665768486648", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05755395683453238, "readRatioMax": 0.05755395683453238, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768486613", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.07194244604316546, "writeRatioMax": 0.07194244604316546 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.05755395683453238, "endMs": "1665768486668", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03597122302158273, "readRatioMax": 0.03597122302158273, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768486630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10071942446043165, "writeRatioMax": 0.10071942446043165 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.19424460431654678, "computeRatioMax": 0.19424460431654678, "endMs": "1665768486698", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05755395683453238, "readRatioMax": 0.05755395683453238, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768486660", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.07913669064748201, "writeRatioMax": 0.07913669064748201 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07194244604316546, "computeRatioMax": 0.07194244604316546, "endMs": "1665768486712", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03597122302158273, "readRatioMax": 0.03597122302158273, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768486676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.09352517985611511, "writeRatioMax": 0.09352517985611511 }, { "completedParallelInputs": "1", "computeMsAvg": "139", "computeMsMax": "139", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768486780", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.1366906474820144, "readRatioMax": 0.1366906474820144, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "136", "startMs": "1665768486696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $252", "$140 := SUM($251)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $242, $252 := $61", "INNER HASH JOIN EACH WITH ALL ON $241 = $60" ] }, { "kind": "JOIN", "substeps": [ "$240 := $71, $241 := $72, $242 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$261, $260, $140", "TO __stage06_output", "BY HASH($260, $261)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03597122302158273, "writeRatioMax": 0.03597122302158273 }, { "completedParallelInputs": "1", "computeMsAvg": "95", "computeMsMax": "95", "computeRatioAvg": 0.6834532374100719, "computeRatioMax": 0.6834532374100719, "endMs": "1665768486812", "id": "7", "inputStages": [ "4", "3" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.08633093525179857, "readRatioMax": 0.08633093525179857, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "97", "startMs": "1665768486731", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03597122302158273, "writeRatioMax": 0.03597122302158273 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.2733812949640288, "computeRatioMax": 0.2733812949640288, "endMs": "1665768486858", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "52", "shuffleOutputBytes": "1229", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665768486817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$261, $260, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$280, $110", "TO __stage08_output", "BY HASH($280)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04316546762589928, "writeRatioMax": 0.04316546762589928 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.1510791366906475, "computeRatioMax": 0.1510791366906475, "endMs": "1665768486942", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665768486882", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $290", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.2302158273381295, "writeRatioMax": 0.2302158273381295 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.2446043165467626, "computeRatioMax": 0.2446043165467626, "endMs": "1665768486941", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768486896", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.14388489208633093, "writeRatioMax": 0.14388489208633093 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.2446043165467626, "computeRatioMax": 0.2446043165467626, "endMs": "1665768486979", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.1079136690647482, "readRatioMax": 0.1079136690647482, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "365799", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665768486913", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_street_number, $12:ca_street_name, $13:ca_street_type, $14:ca_suite_number, $15:ca_city, $16:ca_county, $17:ca_state, $18:ca_zip, $19:ca_country, $20:ca_gmt_offset, $21:ca_location_type", "FROM customer_address", "WHERE equal($17, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.16546762589928057, "writeRatioMax": 0.16546762589928057 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.06474820143884892, "computeRatioMax": 0.1223021582733813, "endMs": "1665768487034", "id": "13", "inputStages": [ "10" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27751", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "3277", "startMs": "1665768486984", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.02158273381294964, "waitRatioMax": 0.03597122302158273, "writeMsAvg": "16", "writeMsMax": "21", "writeRatioAvg": 0.11510791366906475, "writeRatioMax": 0.1510791366906475 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.1223021582733813, "endMs": "1665768487039", "id": "14", "inputStages": [ "9" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "3151", "startMs": "1665768486985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.03597122302158273, "waitRatioMax": 0.04316546762589928, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.10071942446043165, "writeRatioMax": 0.14388489208633093 }, { "completedParallelInputs": "1", "computeMsAvg": "80", "computeMsMax": "80", "computeRatioAvg": 0.5755395683453237, "computeRatioMax": 0.5755395683453237, "endMs": "1665768487099", "id": "15", "inputStages": [ "14", "11", "13" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.10071942446043165, "readRatioMax": 0.10071942446043165, "recordsRead": "130248", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665768486993", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$90, $290", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $306 ASC, $307 ASC, $308 ASC, $309 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($315, multiply($316, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$300 := $210, $301 := $211, $302 := $212, $303 := $213, $304 := $214, $305 := $215, $306 := $216, $307 := $217, $308 := $218, $309 := $219, $310 := $220, $311 := $221, $312 := $222, $313 := $223, $314 := $224, $315 := $226", "INNER HASH JOIN EACH WITH ALL ON $225 = $290" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $163, $223 := $164, $224 := $165, $225 := $201", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $11, $156 := $12, $157 := $13, $158 := $14, $159 := $15, $160 := $16, $161 := $17, $162 := $18, $163 := $19, $164 := $20, $165 := $21", "INNER HASH JOIN EACH WITH ALL ON $3 = $10" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "TO __stage0F_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.04316546762589928, "waitRatioMax": 0.04316546762589928, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.007194244604316547, "writeRatioMax": 0.007194244604316547 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07194244604316546, "computeRatioMax": 0.07194244604316546, "endMs": "1665768487114", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665768487004", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$320 ASC, $321 ASC, $322 ASC, $323 ASC, $324 ASC, $325 ASC, $326 ASC, $327 ASC, $328 ASC, $329 ASC, $330 ASC, $331 ASC, $332 ASC, $333 ASC, $334 ASC, $335 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347, $348, $349, $350, $351, $352, $353, $354, $355", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02158273381294964, "writeRatioMax": 0.02158273381294964 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "621", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7075" }, { "activeUnits": "1", "completedUnits": "212", "elapsedMs": "672", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7149" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "18097943", "totalPartitionsProcessed": "0", "totalSlotMs": "7149", "transferredBytes": "0" }, "startTime": "1665768486494", "totalBytesProcessed": "18097943", "totalSlotMs": "7149" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon84982a09_b36a_4c97_bbab_5829bdf54afb" }, "priority": "INTERACTIVE", "query": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n ,date_dim\n ,customer_address\n where cr_returned_date_sk = d_date_sk \n and d_year =2000\n and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n ,ca_state )\n select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "uTvBZL6Bd0robajWVP9zkQ==", "id": "test-project-364309:europe-west1.query81_1665778651", "jobReference": { "jobId": "query81_1665778651", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query81_1665778651?location=europe-west1", "statistics": { "creationTime": "1665778652552", "endTime": "1665778653313", "finalExecutionDurationMs": "568", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "18097943", "performanceInsights": { "avgPreviousExecutionMs": "591" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.18238993710691823, "computeRatioMax": 0.18238993710691823, "endMs": "1665778652737", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.06918238993710692, "readRatioMax": 0.06918238993710692, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778652698", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.08176100628930817, "writeRatioMax": 0.08176100628930817 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.08176100628930817, "computeRatioMax": 0.08176100628930817, "endMs": "1665778652755", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.050314465408805034, "readRatioMax": 0.050314465408805034, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778652715", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.07547169811320754, "writeRatioMax": 0.07547169811320754 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.2138364779874214, "computeRatioMax": 0.2138364779874214, "endMs": "1665778652784", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03773584905660377, "readRatioMax": 0.03773584905660377, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778652746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.06918238993710692, "writeRatioMax": 0.06918238993710692 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06289308176100629, "computeRatioMax": 0.06289308176100629, "endMs": "1665778652797", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.05660377358490566, "readRatioMax": 0.05660377358490566, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778652761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0440251572327044, "writeRatioMax": 0.0440251572327044 }, { "completedParallelInputs": "1", "computeMsAvg": "159", "computeMsMax": "159", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778652881", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.0880503144654088, "readRatioMax": 0.0880503144654088, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "158", "startMs": "1665778652778", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $252", "$140 := SUM($251)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $242, $252 := $61", "INNER HASH JOIN EACH WITH ALL ON $241 = $60" ] }, { "kind": "JOIN", "substeps": [ "$240 := $71, $241 := $72, $242 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$261, $260, $140", "TO __stage06_output", "BY HASH($260, $261)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0440251572327044, "writeRatioMax": 0.0440251572327044 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.6855345911949685, "computeRatioMax": 0.6855345911949685, "endMs": "1665778652896", "id": "7", "inputStages": [ "3", "4" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.09433962264150944, "readRatioMax": 0.09433962264150944, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "91", "startMs": "1665778652811", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.031446540880503145, "writeRatioMax": 0.031446540880503145 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.14465408805031446, "computeRatioMax": 0.14465408805031446, "endMs": "1665778652968", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "52", "shuffleOutputBytes": "1229", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778652933", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$261, $260, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$280, $110", "TO __stage08_output", "BY HASH($280)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03773584905660377, "writeRatioMax": 0.03773584905660377 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0880503144654088, "computeRatioMax": 0.0880503144654088, "endMs": "1665778653029", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778652994", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $290", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.1509433962264151, "writeRatioMax": 0.1509433962264151 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.3018867924528302, "computeRatioMax": 0.3018867924528302, "endMs": "1665778653063", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665778653007", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.14465408805031446, "writeRatioMax": 0.14465408805031446 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.1509433962264151, "computeRatioMax": 0.1509433962264151, "endMs": "1665778653069", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.05660377358490566, "readRatioMax": 0.05660377358490566, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "365799", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778653026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_street_number, $12:ca_street_name, $13:ca_street_type, $14:ca_suite_number, $15:ca_city, $16:ca_county, $17:ca_state, $18:ca_zip, $19:ca_country, $20:ca_gmt_offset, $21:ca_location_type", "FROM customer_address", "WHERE equal($17, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006289308176100629, "waitRatioMax": 0.006289308176100629, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.050314465408805034, "writeRatioMax": 0.050314465408805034 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.050314465408805034, "computeRatioMax": 0.11320754716981132, "endMs": "1665778653134", "id": "13", "inputStages": [ "10" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27751", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "3319", "startMs": "1665778653079", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.012578616352201259, "waitRatioMax": 0.031446540880503145, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.0880503144654088, "writeRatioMax": 0.1509433962264151 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.0440251572327044, "computeRatioMax": 0.0880503144654088, "endMs": "1665778653134", "id": "14", "inputStages": [ "9" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "3057", "startMs": "1665778653079", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.025157232704402517, "waitRatioMax": 0.031446540880503145, "writeMsAvg": "16", "writeMsMax": "22", "writeRatioAvg": 0.10062893081761007, "writeRatioMax": 0.13836477987421383 }, { "completedParallelInputs": "1", "computeMsAvg": "75", "computeMsMax": "75", "computeRatioAvg": 0.4716981132075472, "computeRatioMax": 0.4716981132075472, "endMs": "1665778653197", "id": "15", "inputStages": [ "11", "13", "14" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.09433962264150944, "readRatioMax": 0.09433962264150944, "recordsRead": "130248", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "91", "startMs": "1665778653088", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$90, $290", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $306 ASC, $307 ASC, $308 ASC, $309 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($315, multiply($316, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$300 := $210, $301 := $211, $302 := $212, $303 := $213, $304 := $214, $305 := $215, $306 := $216, $307 := $217, $308 := $218, $309 := $219, $310 := $220, $311 := $221, $312 := $222, $313 := $223, $314 := $224, $315 := $226", "INNER HASH JOIN EACH WITH ALL ON $225 = $290" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $163, $223 := $164, $224 := $165, $225 := $201", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $11, $156 := $12, $157 := $13, $158 := $14, $159 := $15, $160 := $16, $161 := $17, $162 := $18, $163 := $19, $164 := $20, $165 := $21", "INNER HASH JOIN EACH WITH ALL ON $3 = $10" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "TO __stage0F_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.031446540880503145, "waitRatioMax": 0.031446540880503145, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.012578616352201259, "writeRatioMax": 0.012578616352201259 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05660377358490566, "computeRatioMax": 0.05660377358490566, "endMs": "1665778653210", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "89", "startMs": "1665778653096", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$320 ASC, $321 ASC, $322 ASC, $323 ASC, $324 ASC, $325 ASC, $326 ASC, $327 ASC, $328 ASC, $329 ASC, $330 ASC, $331 ASC, $332 ASC, $333 ASC, $334 ASC, $335 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347, $348, $349, $350, $351, $352, $353, $354, $355", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012578616352201259, "waitRatioMax": 0.012578616352201259, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.018867924528301886, "writeRatioMax": 0.018867924528301886 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7096" }, { "activeUnits": "1", "completedUnits": "212", "elapsedMs": "661", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7174" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "18097943", "totalPartitionsProcessed": "0", "totalSlotMs": "7174", "transferredBytes": "0" }, "startTime": "1665778652602", "totalBytesProcessed": "18097943", "totalSlotMs": "7174" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc7ffbba0_58c2_4faf_b88d_3661825608cf" }, "priority": "INTERACTIVE", "query": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n ,date_dim\n ,customer_address\n where cr_returned_date_sk = d_date_sk \n and d_year =2000\n and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n ,ca_state )\n select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "nQL/C7JswNITI3C/Ac6cHQ==", "id": "test-project-364309:europe-west1.query81_1665778654", "jobReference": { "jobId": "query81_1665778654", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query81_1665778654?location=europe-west1", "statistics": { "creationTime": "1665778654965", "endTime": "1665778655716", "finalExecutionDurationMs": "568", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "18097943", "performanceInsights": { "avgPreviousExecutionMs": "586" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.15714285714285714, "computeRatioMax": 0.15714285714285714, "endMs": "1665778655144", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04285714285714286, "readRatioMax": 0.04285714285714286, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778655102", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.09285714285714286, "computeRatioMax": 0.09285714285714286, "endMs": "1665778655156", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.07142857142857142, "readRatioMax": 0.07142857142857142, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778655118", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.05, "writeRatioMax": 0.05 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.21428571428571427, "computeRatioMax": 0.21428571428571427, "endMs": "1665778655179", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04285714285714286, "readRatioMax": 0.04285714285714286, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778655146", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06428571428571428, "writeRatioMax": 0.06428571428571428 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07857142857142857, "computeRatioMax": 0.07857142857142857, "endMs": "1665778655197", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04285714285714286, "readRatioMax": 0.04285714285714286, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778655160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.08571428571428572, "writeRatioMax": 0.08571428571428572 }, { "completedParallelInputs": "1", "computeMsAvg": "118", "computeMsMax": "118", "computeRatioAvg": 0.8428571428571429, "computeRatioMax": 0.8428571428571429, "endMs": "1665778655257", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.07857142857142857, "readRatioMax": 0.07857142857142857, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "123", "startMs": "1665778655173", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $252", "$140 := SUM($251)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $242, $252 := $61", "INNER HASH JOIN EACH WITH ALL ON $241 = $60" ] }, { "kind": "JOIN", "substeps": [ "$240 := $71, $241 := $72, $242 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$261, $260, $140", "TO __stage06_output", "BY HASH($260, $261)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04285714285714286, "writeRatioMax": 0.04285714285714286 }, { "completedParallelInputs": "1", "computeMsAvg": "140", "computeMsMax": "140", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778655302", "id": "7", "inputStages": [ "3", "4" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.1, "readRatioMax": 0.1, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665778655209", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04285714285714286, "writeRatioMax": 0.04285714285714286 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.25, "computeRatioMax": 0.25, "endMs": "1665778655315", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "52", "shuffleOutputBytes": "1229", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778655288", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$261, $260, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$280, $110", "TO __stage08_output", "BY HASH($280)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.05714285714285714, "endMs": "1665778655386", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778655335", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $290", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.20714285714285716, "writeRatioMax": 0.20714285714285716 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.2571428571428571, "computeRatioMax": 0.2571428571428571, "endMs": "1665778655391", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778655347", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.1357142857142857, "writeRatioMax": 0.1357142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.10714285714285714, "computeRatioMax": 0.10714285714285714, "endMs": "1665778655384", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03571428571428571, "readRatioMax": 0.03571428571428571, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "365799", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778655360", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_street_number, $12:ca_street_name, $13:ca_street_type, $14:ca_suite_number, $15:ca_city, $16:ca_county, $17:ca_state, $18:ca_zip, $19:ca_country, $20:ca_gmt_offset, $21:ca_location_type", "FROM customer_address", "WHERE equal($17, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007142857142857143, "waitRatioMax": 0.007142857142857143, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05714285714285714, "writeRatioMax": 0.05714285714285714 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.05, "computeRatioMax": 0.08571428571428572, "endMs": "1665778655450", "id": "14", "inputStages": [ "10" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27751", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "2749", "startMs": "1665778655402", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.02142857142857143, "waitRatioMax": 0.02857142857142857, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.1, "writeRatioMax": 0.12857142857142856 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.05714285714285714, "computeRatioMax": 0.1, "endMs": "1665778655458", "id": "15", "inputStages": [ "9" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "3254", "startMs": "1665778655404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.02142857142857143, "waitRatioMax": 0.02857142857142857, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.09285714285714286, "writeRatioMax": 0.1357142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "65", "computeMsMax": "65", "computeRatioAvg": 0.4642857142857143, "computeRatioMax": 0.4642857142857143, "endMs": "1665778655592", "id": "16", "inputStages": [ "11", "14", "15" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.07857142857142857, "readRatioMax": 0.07857142857142857, "recordsRead": "130248", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "176", "startMs": "1665778655409", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$90, $290", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $306 ASC, $307 ASC, $308 ASC, $309 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($315, multiply($316, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$300 := $210, $301 := $211, $302 := $212, $303 := $213, $304 := $214, $305 := $215, $306 := $216, $307 := $217, $308 := $218, $309 := $219, $310 := $220, $311 := $221, $312 := $222, $313 := $223, $314 := $224, $315 := $226", "INNER HASH JOIN EACH WITH ALL ON $225 = $290" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $163, $223 := $164, $224 := $165, $225 := $201", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $11, $156 := $12, $157 := $13, $158 := $14, $159 := $15, $160 := $16, $161 := $17, $162 := $18, $163 := $19, $164 := $20, $165 := $21", "INNER HASH JOIN EACH WITH ALL ON $3 = $10" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.02857142857142857, "waitRatioMax": 0.02857142857142857, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02142857142857143, "writeRatioMax": 0.02142857142857143 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07142857142857142, "computeRatioMax": 0.07142857142857142, "endMs": "1665778655622", "id": "17", "inputStages": [ "16" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "147", "startMs": "1665778655416", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$320 ASC, $321 ASC, $322 ASC, $323 ASC, $324 ASC, $325 ASC, $326 ASC, $327 ASC, $328 ASC, $329 ASC, $330 ASC, $331 ASC, $332 ASC, $333 ASC, $334 ASC, $335 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347, $348, $349, $350, $351, $352, $353, $354, $355", "TO __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.02857142857142857, "waitRatioMax": 0.02857142857142857, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02142857142857143, "writeRatioMax": 0.02142857142857143 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "588", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6731" }, { "activeUnits": "1", "completedUnits": "212", "elapsedMs": "657", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6879" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "18097943", "totalPartitionsProcessed": "0", "totalSlotMs": "6879", "transferredBytes": "0" }, "startTime": "1665778655016", "totalBytesProcessed": "18097943", "totalSlotMs": "6879" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3b65b8ea_14c4_4416_ba4c_c7aead6b5a6c" }, "priority": "INTERACTIVE", "query": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n ,date_dim\n ,customer_address\n where cr_returned_date_sk = d_date_sk \n and d_year =2000\n and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n ,ca_state )\n select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "IxY2G1phmXbIvJKJ8aDlCw==", "id": "test-project-364309:europe-west1.query81_1665778656", "jobReference": { "jobId": "query81_1665778656", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query81_1665778656?location=europe-west1", "statistics": { "creationTime": "1665778657470", "endTime": "1665778658280", "finalExecutionDurationMs": "599", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "18097943", "performanceInsights": { "avgPreviousExecutionMs": "582" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.20670391061452514, "computeRatioMax": 0.20670391061452514, "endMs": "1665778657648", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0446927374301676, "readRatioMax": 0.0446927374301676, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778657611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05027932960893855, "writeRatioMax": 0.05027932960893855 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0446927374301676, "computeRatioMax": 0.0446927374301676, "endMs": "1665778657668", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0335195530726257, "readRatioMax": 0.0335195530726257, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778657629", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0782122905027933, "writeRatioMax": 0.0782122905027933 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.18435754189944134, "computeRatioMax": 0.18435754189944134, "endMs": "1665778657690", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0335195530726257, "readRatioMax": 0.0335195530726257, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778657658", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05027932960893855, "writeRatioMax": 0.05027932960893855 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.09497206703910614, "computeRatioMax": 0.09497206703910614, "endMs": "1665778657708", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.05027932960893855, "readRatioMax": 0.05027932960893855, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778657672", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0111731843575419, "waitRatioMax": 0.0111731843575419, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.08379888268156424, "writeRatioMax": 0.08379888268156424 }, { "completedParallelInputs": "1", "computeMsAvg": "136", "computeMsMax": "136", "computeRatioAvg": 0.7597765363128491, "computeRatioMax": 0.7597765363128491, "endMs": "1665778657803", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.10614525139664804, "readRatioMax": 0.10614525139664804, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "135", "startMs": "1665778657693", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $252", "$140 := SUM($251)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $242, $252 := $61", "INNER HASH JOIN EACH WITH ALL ON $241 = $60" ] }, { "kind": "JOIN", "substeps": [ "$240 := $71, $241 := $72, $242 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$261, $260, $140", "TO __stage06_output", "BY HASH($260, $261)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03910614525139665, "writeRatioMax": 0.03910614525139665 }, { "completedParallelInputs": "1", "computeMsAvg": "179", "computeMsMax": "179", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778657829", "id": "7", "inputStages": [ "4", "3" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.07262569832402235, "readRatioMax": 0.07262569832402235, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665778657715", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0446927374301676, "writeRatioMax": 0.0446927374301676 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.16759776536312848, "computeRatioMax": 0.16759776536312848, "endMs": "1665778657885", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "52", "shuffleOutputBytes": "1229", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778657848", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$261, $260, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$280, $110", "TO __stage08_output", "BY HASH($280)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0335195530726257, "writeRatioMax": 0.0335195530726257 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03910614525139665, "computeRatioMax": 0.03910614525139665, "endMs": "1665778657962", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778657913", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $290", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.16201117318435754, "writeRatioMax": 0.16201117318435754 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.20670391061452514, "computeRatioMax": 0.20670391061452514, "endMs": "1665778657985", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665778657927", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.12849162011173185, "writeRatioMax": 0.12849162011173185 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.10614525139664804, "computeRatioMax": 0.10614525139664804, "endMs": "1665778657983", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0335195530726257, "readRatioMax": 0.0335195530726257, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "365799", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778657942", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_street_number, $12:ca_street_name, $13:ca_street_type, $14:ca_suite_number, $15:ca_city, $16:ca_county, $17:ca_state, $18:ca_zip, $19:ca_country, $20:ca_gmt_offset, $21:ca_location_type", "FROM customer_address", "WHERE equal($17, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00558659217877095, "waitRatioMax": 0.00558659217877095, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.055865921787709494, "writeRatioMax": 0.055865921787709494 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.03910614525139665, "computeRatioMax": 0.07262569832402235, "endMs": "1665778658060", "id": "14", "inputStages": [ "10" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27751", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "3045", "startMs": "1665778658007", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.027932960893854747, "waitRatioMax": 0.03910614525139665, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.08379888268156424, "writeRatioMax": 0.11173184357541899 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.03910614525139665, "computeRatioMax": 0.07262569832402235, "endMs": "1665778658062", "id": "15", "inputStages": [ "9" ], "name": "S0F: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "2464", "startMs": "1665778658010", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.03910614525139665, "waitRatioMax": 0.0446927374301676, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.07262569832402235, "writeRatioMax": 0.10614525139664804 }, { "completedParallelInputs": "1", "computeMsAvg": "89", "computeMsMax": "89", "computeRatioAvg": 0.4972067039106145, "computeRatioMax": 0.4972067039106145, "endMs": "1665778658131", "id": "16", "inputStages": [ "11", "14", "15" ], "name": "S10: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.08379888268156424, "readRatioMax": 0.08379888268156424, "recordsRead": "130248", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "129", "startMs": "1665778658022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$90, $290", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $306 ASC, $307 ASC, $308 ASC, $309 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($315, multiply($316, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$300 := $210, $301 := $211, $302 := $212, $303 := $213, $304 := $214, $305 := $215, $306 := $216, $307 := $217, $308 := $218, $309 := $219, $310 := $220, $311 := $221, $312 := $222, $313 := $223, $314 := $224, $315 := $226", "INNER HASH JOIN EACH WITH ALL ON $225 = $290" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $163, $223 := $164, $224 := $165, $225 := $201", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $11, $156 := $12, $157 := $13, $158 := $14, $159 := $15, $160 := $16, $161 := $17, $162 := $18, $163 := $19, $164 := $20, $165 := $21", "INNER HASH JOIN EACH WITH ALL ON $3 = $10" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "TO __stage10_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.055865921787709494, "waitRatioMax": 0.055865921787709494, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00558659217877095, "writeRatioMax": 0.00558659217877095 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.055865921787709494, "computeRatioMax": 0.055865921787709494, "endMs": "1665778658152", "id": "17", "inputStages": [ "16" ], "name": "S11: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665778658026", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$320 ASC, $321 ASC, $322 ASC, $323 ASC, $324 ASC, $325 ASC, $326 ASC, $327 ASC, $328 ASC, $329 ASC, $330 ASC, $331 ASC, $332 ASC, $333 ASC, $334 ASC, $335 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347, $348, $349, $350, $351, $352, $353, $354, $355", "TO __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0223463687150838, "waitRatioMax": 0.0223463687150838, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0223463687150838, "writeRatioMax": 0.0223463687150838 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "210", "elapsedMs": "593", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "6160" }, { "activeUnits": "2", "completedUnits": "212", "elapsedMs": "699", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6346" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "18097943", "totalPartitionsProcessed": "0", "totalSlotMs": "6346", "transferredBytes": "0" }, "startTime": "1665778657520", "totalBytesProcessed": "18097943", "totalSlotMs": "6346" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4b713693_4e61_40a7_a1cb_72e90884a4be" }, "priority": "INTERACTIVE", "query": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n ,date_dim\n ,customer_address\n where cr_returned_date_sk = d_date_sk \n and d_year =2000\n and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n ,ca_state )\n select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "bd/FulnLc7blloAEM+a/qA==", "id": "test-project-364309:europe-west1.query81_1665778659", "jobReference": { "jobId": "query81_1665778659", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query81_1665778659?location=europe-west1", "statistics": { "creationTime": "1665778659948", "endTime": "1665778660701", "finalExecutionDurationMs": "561", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "18097943", "performanceInsights": { "avgPreviousExecutionMs": "585" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.2014388489208633, "computeRatioMax": 0.2014388489208633, "endMs": "1665778660124", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05755395683453238, "readRatioMax": 0.05755395683453238, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778660083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.10071942446043165, "writeRatioMax": 0.10071942446043165 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.09352517985611511, "computeRatioMax": 0.09352517985611511, "endMs": "1665778660129", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.07194244604316546, "readRatioMax": 0.07194244604316546, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778660100", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05755395683453238, "writeRatioMax": 0.05755395683453238 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.23741007194244604, "computeRatioMax": 0.23741007194244604, "endMs": "1665778660166", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.050359712230215826, "readRatioMax": 0.050359712230215826, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778660127", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.07194244604316546, "writeRatioMax": 0.07194244604316546 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.04316546762589928, "computeRatioMax": 0.04316546762589928, "endMs": "1665778660171", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04316546762589928, "readRatioMax": 0.04316546762589928, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778660143", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1079136690647482, "writeRatioMax": 0.1079136690647482 }, { "completedParallelInputs": "1", "computeMsAvg": "139", "computeMsMax": "139", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778660272", "id": "6", "inputStages": [ "1", "0" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.1079136690647482, "readRatioMax": 0.1079136690647482, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "122", "startMs": "1665778660163", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $252", "$140 := SUM($251)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $242, $252 := $61", "INNER HASH JOIN EACH WITH ALL ON $241 = $60" ] }, { "kind": "JOIN", "substeps": [ "$240 := $71, $241 := $72, $242 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$261, $260, $140", "TO __stage06_output", "BY HASH($260, $261)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.050359712230215826, "writeRatioMax": 0.050359712230215826 }, { "completedParallelInputs": "1", "computeMsAvg": "118", "computeMsMax": "118", "computeRatioAvg": 0.8489208633093526, "computeRatioMax": 0.8489208633093526, "endMs": "1665778660277", "id": "7", "inputStages": [ "3", "4" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.10071942446043165, "readRatioMax": 0.10071942446043165, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665778660185", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04316546762589928, "writeRatioMax": 0.04316546762589928 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.12949640287769784, "computeRatioMax": 0.12949640287769784, "endMs": "1665778660351", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "52", "shuffleOutputBytes": "1229", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778660318", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$261, $260, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$280, $110", "TO __stage08_output", "BY HASH($280)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04316546762589928, "writeRatioMax": 0.04316546762589928 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07913669064748201, "computeRatioMax": 0.07913669064748201, "endMs": "1665778660436", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665778660385", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $290", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.20863309352517986, "writeRatioMax": 0.20863309352517986 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.31654676258992803, "computeRatioMax": 0.31654676258992803, "endMs": "1665778660454", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778660403", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.15827338129496402, "writeRatioMax": 0.15827338129496402 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.2014388489208633, "computeRatioMax": 0.2014388489208633, "endMs": "1665778660465", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.08633093525179857, "readRatioMax": 0.08633093525179857, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "365799", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665778660418", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_street_number, $12:ca_street_name, $13:ca_street_type, $14:ca_suite_number, $15:ca_city, $16:ca_county, $17:ca_state, $18:ca_zip, $19:ca_country, $20:ca_gmt_offset, $21:ca_location_type", "FROM customer_address", "WHERE equal($17, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.12949640287769784, "writeRatioMax": 0.12949640287769784 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.1223021582733813, "endMs": "1665778660528", "id": "13", "inputStages": [ "10" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27751", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "3768", "startMs": "1665778660470", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.02158273381294964, "waitRatioMax": 0.02877697841726619, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.14388489208633093, "writeRatioMax": 0.22302158273381295 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.12949640287769784, "endMs": "1665778660530", "id": "14", "inputStages": [ "9" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "3500", "startMs": "1665778660471", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "8", "waitRatioAvg": 0.02877697841726619, "waitRatioMax": 0.05755395683453238, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.11510791366906475, "writeRatioMax": 0.20863309352517986 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.37410071942446044, "computeRatioMax": 0.37410071942446044, "endMs": "1665778660579", "id": "15", "inputStages": [ "13", "14", "11" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.06474820143884892, "readRatioMax": 0.06474820143884892, "recordsRead": "130248", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778660484", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$90, $290", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $306 ASC, $307 ASC, $308 ASC, $309 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($315, multiply($316, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$300 := $210, $301 := $211, $302 := $212, $303 := $213, $304 := $214, $305 := $215, $306 := $216, $307 := $217, $308 := $218, $309 := $219, $310 := $220, $311 := $221, $312 := $222, $313 := $223, $314 := $224, $315 := $226", "INNER HASH JOIN EACH WITH ALL ON $225 = $290" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $163, $223 := $164, $224 := $165, $225 := $201", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $11, $156 := $12, $157 := $13, $158 := $14, $159 := $15, $160 := $16, $161 := $17, $162 := $18, $163 := $19, $164 := $20, $165 := $21", "INNER HASH JOIN EACH WITH ALL ON $3 = $10" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "TO __stage0F_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.05755395683453238, "waitRatioMax": 0.05755395683453238, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.007194244604316547, "writeRatioMax": 0.007194244604316547 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.08633093525179857, "computeRatioMax": 0.08633093525179857, "endMs": "1665778660593", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778660495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$320 ASC, $321 ASC, $322 ASC, $323 ASC, $324 ASC, $325 ASC, $326 ASC, $327 ASC, $328 ASC, $329 ASC, $330 ASC, $331 ASC, $332 ASC, $333 ASC, $334 ASC, $335 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347, $348, $349, $350, $351, $352, $353, $354, $355", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02158273381294964, "writeRatioMax": 0.02158273381294964 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "211", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7887" }, { "activeUnits": "1", "completedUnits": "212", "elapsedMs": "662", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7921" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "18097943", "totalPartitionsProcessed": "0", "totalSlotMs": "7921", "transferredBytes": "0" }, "startTime": "1665778659988", "totalBytesProcessed": "18097943", "totalSlotMs": "7921" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon243a320c_ea44_4c67_9666_bcb6586e8431" }, "priority": "INTERACTIVE", "query": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n ,date_dim\n ,customer_address\n where cr_returned_date_sk = d_date_sk \n and d_year =2000\n and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n ,ca_state )\n select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n ,customer_address\n ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t from customer_total_return ctr2 \n \t where ctr1.ctr_state = ctr2.ctr_state)\n and ca_address_sk = c_current_addr_sk\n and ca_state = 'GA'\n and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n ,ca_location_type,ctr_total_return\n limit 100\n ;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "nuYYSdBcdm1bMm6c63uWFg==", "id": "test-project-364309:europe-west1.query81_1665778661", "jobReference": { "jobId": "query81_1665778661", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query81_1665778661?location=europe-west1", "statistics": { "creationTime": "1665778662322", "endTime": "1665778663032", "finalExecutionDurationMs": "508", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "18097943", "performanceInsights": { "avgPreviousExecutionMs": "582" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.20863309352517986, "computeRatioMax": 0.20863309352517986, "endMs": "1665778662522", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03597122302158273, "readRatioMax": 0.03597122302158273, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778662467", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:ca_address_sk, $61:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$60, $61", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.17266187050359713, "writeRatioMax": 0.17266187050359713 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.07194244604316546, "computeRatioMax": 0.07194244604316546, "endMs": "1665778662546", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04316546762589928, "readRatioMax": 0.04316546762589928, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778662512", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.06474820143884892, "writeRatioMax": 0.06474820143884892 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.12949640287769784, "computeRatioMax": 0.12949640287769784, "endMs": "1665778662573", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03597122302158273, "readRatioMax": 0.03597122302158273, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "790700", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778662542", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.09352517985611511, "writeRatioMax": 0.09352517985611511 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.05755395683453238, "endMs": "1665778662592", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.050359712230215826, "readRatioMax": 0.050359712230215826, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778662558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.12949640287769784, "writeRatioMax": 0.12949640287769784 }, { "completedParallelInputs": "1", "computeMsAvg": "139", "computeMsMax": "139", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778662676", "id": "6", "inputStages": [ "0", "1" ], "name": "S06: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.09352517985611511, "readRatioMax": 0.09352517985611511, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "127", "startMs": "1665778662578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$60, $61", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $252", "$140 := SUM($251)" ] }, { "kind": "JOIN", "substeps": [ "$250 := $240, $251 := $242, $252 := $61", "INNER HASH JOIN EACH WITH ALL ON $241 = $60" ] }, { "kind": "JOIN", "substeps": [ "$240 := $71, $241 := $72, $242 := $73", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$261, $260, $140", "TO __stage06_output", "BY HASH($260, $261)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.050359712230215826, "writeRatioMax": 0.050359712230215826 }, { "completedParallelInputs": "1", "computeMsAvg": "127", "computeMsMax": "127", "computeRatioAvg": 0.9136690647482014, "computeRatioMax": 0.9136690647482014, "endMs": "1665778662705", "id": "7", "inputStages": [ "3", "4" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.10071942446043165, "readRatioMax": 0.10071942446043165, "recordsRead": "194433", "recordsWritten": "27796", "shuffleOutputBytes": "909574", "shuffleOutputBytesSpilled": "0", "slotMs": "119", "startMs": "1665778662616", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax", "FROM catalog_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $182", "$120 := SUM($181)" ] }, { "kind": "JOIN", "substeps": [ "$180 := $170, $181 := $172, $182 := $31", "INNER HASH JOIN EACH WITH ALL ON $171 = $30" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$191, $190, $120", "TO __stage07_output", "BY HASH($190, $191)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04316546762589928, "writeRatioMax": 0.04316546762589928 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.2302158273381295, "computeRatioMax": 0.2302158273381295, "endMs": "1665778662734", "id": "8", "inputStages": [ "6" ], "name": "S08: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "52", "shuffleOutputBytes": "1229", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778662705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$261, $260, $140", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $271", "$110 := SHARD_AVG($130)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261", "$130 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$280, $110", "TO __stage08_output", "BY HASH($280)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04316546762589928, "writeRatioMax": 0.04316546762589928 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.04316546762589928, "computeRatioMax": 0.04316546762589928, "endMs": "1665778662803", "id": "9", "inputStages": [ "8" ], "name": "S09: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "52", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778662756", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $110", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280", "$90 := ROOT_AVG($110)" ] }, { "kind": "WRITE", "substeps": [ "$90, $290", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.014388489208633094, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.2014388489208633, "writeRatioMax": 0.2014388489208633 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.2949640287769784, "computeRatioMax": 0.2949640287769784, "endMs": "1665778662817", "id": "10", "inputStages": [ "7" ], "name": "S0A: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27796", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778662770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$191, $190, $120", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $190, $201 := $191", "$100 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$100, $200, $201", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.1366906474820144, "writeRatioMax": 0.1366906474820144 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.19424460431654678, "computeRatioMax": 0.19424460431654678, "endMs": "1665778662818", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05755395683453238, "readRatioMax": 0.05755395683453238, "recordsRead": "50000", "recordsWritten": "2446", "shuffleOutputBytes": "365799", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778662784", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_street_number, $12:ca_street_name, $13:ca_street_type, $14:ca_suite_number, $15:ca_city, $16:ca_county, $17:ca_state, $18:ca_zip, $19:ca_country, $20:ca_gmt_offset, $21:ca_location_type", "FROM customer_address", "WHERE equal($17, 'GA')" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.05755395683453238, "writeRatioMax": 0.05755395683453238 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.1223021582733813, "endMs": "1665778662892", "id": "13", "inputStages": [ "10" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27751", "recordsWritten": "27751", "shuffleOutputBytes": "908535", "shuffleOutputBytesSpilled": "0", "slotMs": "3145", "startMs": "1665778662837", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.02158273381294964, "waitRatioMax": 0.050359712230215826, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.10071942446043165, "writeRatioMax": 0.19424460431654678 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.050359712230215826, "computeRatioMax": 0.09352517985611511, "endMs": "1665778662887", "id": "14", "inputStages": [ "9" ], "name": "S0E: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "51", "recordsWritten": "51", "shuffleOutputBytes": "1224", "shuffleOutputBytesSpilled": "0", "slotMs": "2599", "startMs": "1665778662838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage09_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.04316546762589928, "waitRatioMax": 0.05755395683453238, "writeMsAvg": "7", "writeMsMax": "19", "writeRatioAvg": 0.050359712230215826, "writeRatioMax": 0.1366906474820144 }, { "completedParallelInputs": "1", "computeMsAvg": "59", "computeMsMax": "59", "computeRatioAvg": 0.4244604316546763, "computeRatioMax": 0.4244604316546763, "endMs": "1665778662931", "id": "15", "inputStages": [ "11", "13", "14" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.05755395683453238, "readRatioMax": 0.05755395683453238, "recordsRead": "130248", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665778662852", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$100, $200, $201", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$90, $290", "FROM __stage0E_output" ] }, { "kind": "SORT", "substeps": [ "$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $306 ASC, $307 ASC, $308 ASC, $309 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($315, multiply($316, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$300 := $210, $301 := $211, $302 := $212, $303 := $213, $304 := $214, $305 := $215, $306 := $216, $307 := $217, $308 := $218, $309 := $219, $310 := $220, $311 := $221, $312 := $222, $313 := $223, $314 := $224, $315 := $226", "INNER HASH JOIN EACH WITH ALL ON $225 = $290" ] }, { "kind": "JOIN", "substeps": [ "$210 := $151, $211 := $152, $212 := $153, $213 := $154, $214 := $155, $215 := $156, $216 := $157, $217 := $158, $218 := $159, $219 := $160, $220 := $161, $221 := $162, $222 := $163, $223 := $164, $224 := $165, $225 := $201", "INNER HASH JOIN EACH WITH ALL ON $150 = $200" ] }, { "kind": "JOIN", "substeps": [ "$150 := $1, $151 := $2, $152 := $4, $153 := $5, $154 := $6, $155 := $11, $156 := $12, $157 := $13, $158 := $14, $159 := $15, $160 := $16, $161 := $17, $162 := $18, $163 := $19, $164 := $20, $165 := $21", "INNER HASH JOIN EACH WITH ALL ON $3 = $10" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "TO __stage0F_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.05755395683453238, "waitRatioMax": 0.05755395683453238, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.007194244604316547, "writeRatioMax": 0.007194244604316547 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.05755395683453238, "endMs": "1665778662940", "id": "16", "inputStages": [ "15" ], "name": "S10: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "21021", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665778662856", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $328, $329, $330, $331, $332, $333, $334, $335", "FROM __stage0F_output" ] }, { "kind": "SORT", "substeps": [ "$320 ASC, $321 ASC, $322 ASC, $323 ASC, $324 ASC, $325 ASC, $326 ASC, $327 ASC, $328 ASC, $329 ASC, $330 ASC, $331 ASC, $332 ASC, $333 ASC, $334 ASC, $335 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$340, $341, $342, $343, $344, $345, $346, $347, $348, $349, $350, $351, $352, $353, $354, $355", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.02877697841726619, "waitRatioMax": 0.02877697841726619, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02158273381294964, "writeRatioMax": 0.02158273381294964 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "212", "elapsedMs": "601", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6415" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "18097943", "totalPartitionsProcessed": "0", "totalSlotMs": "6415", "transferredBytes": "0" }, "startTime": "1665778662375", "totalBytesProcessed": "18097943", "totalSlotMs": "6415" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
