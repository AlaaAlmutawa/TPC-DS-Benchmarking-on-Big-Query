{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon20e22508_02f5_4c34_a9c5_332b6d500ad0" }, "priority": "INTERACTIVE", "query": "-- start query 95 in stream 0 using template query95.tpl\n\n/*\nProduce a count of web sales and total shipping cost and net profit in a given 60 day period to customers \nin a given state from a named web site for returned orders shipped from more than one warehouse.\n*/\n\nwith ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and '1999-4-02' \nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n from web_returns,ws_wh\n where wr_order_number = ws_wh.ws_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 95 in stream 0 using template query95.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "oZ30MI4mdRCHSfpoymTp7A==", "id": "test-project-364309:europe-west1.query95_1665768523", "jobReference": { "jobId": "query95_1665768523", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query95_1665768523?location=europe-west1", "statistics": { "creationTime": "1665768524572", "endTime": "1665768528601", "finalExecutionDurationMs": "3791", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "3394" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.006241466744685001, "computeRatioMax": 0.006241466744685001, "endMs": "1665768524787", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0015603666861712503, "readRatioMax": 0.0015603666861712503, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768524748", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001950458357714063, "waitRatioMax": 0.0001950458357714063, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0023405500292568754, "writeRatioMax": 0.0023405500292568754 }, { "completedParallelInputs": "1", "computeMsAvg": "351", "computeMsMax": "351", "computeRatioAvg": 0.0684610883557636, "computeRatioMax": 0.0684610883557636, "endMs": "1665768524940", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001365320850399844, "readRatioMax": 0.001365320850399844, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "225", "startMs": "1665768524764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_warehouse_sk, $51:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001950458357714063, "waitRatioMax": 0.0001950458357714063, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0037058708796567194, "writeRatioMax": 0.0037058708796567194 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0021455041934854693, "computeRatioMax": 0.0021455041934854693, "endMs": "1665768524827", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0009752291788570314, "readRatioMax": 0.0009752291788570314, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768524795", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:web_site_sk, $11:web_company_name", "FROM web_site", "WHERE equal($11, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001950458357714063, "waitRatioMax": 0.0001950458357714063, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0037058708796567194, "writeRatioMax": 0.0037058708796567194 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0021455041934854693, "computeRatioMax": 0.0021455041934854693, "endMs": "1665768524860", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0011702750146284377, "readRatioMax": 0.0011702750146284377, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768524816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address", "WHERE equal($31, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001950458357714063, "waitRatioMax": 0.0001950458357714063, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.005656329237370782, "writeRatioMax": 0.005656329237370782 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.0023405500292568754, "computeRatioMax": 0.0023405500292568754, "endMs": "1665768524870", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0011702750146284377, "readRatioMax": 0.0011702750146284377, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768524831", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date", "FROM date_dim", "WHERE between($61, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0003900916715428126, "waitRatioMax": 0.0003900916715428126, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0021455041934854693, "writeRatioMax": 0.0021455041934854693 }, { "completedParallelInputs": "1", "computeMsAvg": "5127", "computeMsMax": "5127", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768527705", "id": "7", "inputStages": [ "0", "1" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.0021455041934854693, "readRatioMax": 0.0021455041934854693, "recordsRead": "1510531", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "3811", "startMs": "1665768524971", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_warehouse_sk, $41:ws_order_number", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $1", "INNER HASH JOIN EACH WITH ALL ON $221 = $1" ] }, { "kind": "FILTER", "substeps": [ "not_equal($220, $222)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $40, $221 := $41, $222 := $50", "INNER HASH JOIN EACH WITH ALL ON $41 = $51" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001950458357714063, "waitRatioMax": 0.0001950458357714063, "writeMsAvg": "452", "writeMsMax": "452", "writeRatioAvg": 0.08816071776867564, "writeRatioMax": 0.08816071776867564 }, { "completedParallelInputs": "100", "computeMsAvg": "28", "computeMsMax": "48", "computeRatioAvg": 0.005461283401599376, "computeRatioMax": 0.009362200117027502, "endMs": "1665768527823", "id": "8", "inputStages": [ "7" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8677946", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "4758", "startMs": "1665768527735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.0007801833430856252, "waitRatioMax": 0.0011702750146284377, "writeMsAvg": "11", "writeMsMax": "29", "writeRatioAvg": 0.0021455041934854693, "writeRatioMax": 0.005656329237370782 }, { "completedParallelInputs": "1", "computeMsAvg": "907", "computeMsMax": "907", "computeRatioAvg": 0.1769065730446655, "computeRatioMax": 0.1769065730446655, "endMs": "1665768528343", "id": "9", "inputStages": [ "4", "5", "3", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "35", "readMsMax": "35", "readRatioAvg": 0.00682660425199922, "readRatioMax": 0.00682660425199922, "recordsRead": "9398992", "recordsWritten": "74", "shuffleOutputBytes": "1504", "shuffleOutputBytesSpilled": "0", "slotMs": "798", "startMs": "1665768527746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_ship_date_sk, $21:ws_ship_addr_sk, $22:ws_web_site_sk, $23:ws_order_number, $24:ws_ext_ship_cost, $25:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$230", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $180, $251 := $160", "$150 := SUM($162)", "$151 := SUM($161)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($180, 1), $240, NULL)", "$161 := if(equal($180, 0), $242, NULL)", "$162 := if(equal($180, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$240 := $210, $241 := $211, $242 := $212", "SEMI HASH JOIN EACH WITH ALL ON $210 = $230" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $202, $212 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $10" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $30" ] }, { "kind": "JOIN", "substeps": [ "$190 := $21, $191 := $22, $192 := $23, $193 := $24, $194 := $25", "INNER HASH JOIN EACH WITH ALL ON $20 = $60" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $251, $250", "TO __stage09_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.0009752291788570314, "waitRatioMax": 0.0009752291788570314, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0015603666861712503, "writeRatioMax": 0.0015603666861712503 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0015603666861712503, "computeRatioMax": 0.0015603666861712503, "endMs": "1665768528427", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "74", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665768528413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $251, $250", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$120 := COUNT($132)", "$121 := ANY_VALUE($131)", "$122 := ANY_VALUE($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := if(equal($260, 0), $141, NULL)", "$131 := if(equal($260, 0), $140, NULL)", "$132 := if(equal($260, 1), $261, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$140 := SUM($150)", "$141 := SUM($151)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $270", "TO __stage0A_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0001950458357714063, "waitRatioMax": 0.0001950458357714063, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0007801833430856252, "writeRatioMax": 0.0007801833430856252 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0011702750146284377, "computeRatioMax": 0.0011702750146284377, "endMs": "1665768528471", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768528437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $270", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($102)", "$91 := ANY_VALUE($101)", "$92 := ANY_VALUE($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := if(equal($280, 0), $112, NULL)", "$101 := if(equal($280, 0), $111, NULL)", "$102 := if(equal($280, 1), $110, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage0B_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0005851375073142189, "waitRatioMax": 0.0005851375073142189, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.002925687536571094, "writeRatioMax": 0.002925687536571094 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0025355958650282815, "computeRatioMax": 0.0025355958650282815, "endMs": "1665768528498", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665768528456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(is_null($80), 0, $80)" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($90)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0003900916715428126, "waitRatioMax": 0.0003900916715428126, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.001365320850399844, "writeRatioMax": 0.001365320850399844 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "621", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "504" }, { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "1600", "estimatedRunnableUnits": "1", "pendingUnits": "1", "totalSlotMs": "1820" }, { "activeUnits": "1", "completedUnits": "106", "elapsedMs": "3579", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "9386" }, { "activeUnits": "1", "completedUnits": "110", "elapsedMs": "3918", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9909" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "9909", "transferredBytes": "0" }, "startTime": "1665768524628", "totalBytesProcessed": "54123827", "totalSlotMs": "9909" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon51b66a29_be03_47ab_96de_8ee512d82250" }, "priority": "INTERACTIVE", "query": "-- start query 95 in stream 0 using template query95.tpl\n\n/*\nProduce a count of web sales and total shipping cost and net profit in a given 60 day period to customers \nin a given state from a named web site for returned orders shipped from more than one warehouse.\n*/\n\nwith ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and '1999-4-02' \nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n from web_returns,ws_wh\n where wr_order_number = ws_wh.ws_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 95 in stream 0 using template query95.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "mDWOe9oR6Qo8vLHhJF5ebw==", "id": "test-project-364309:europe-west1.query95_1665778846", "jobReference": { "jobId": "query95_1665778846", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query95_1665778846?location=europe-west1", "statistics": { "creationTime": "1665778847384", "endTime": "1665778850551", "finalExecutionDurationMs": "2943", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "3473" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.01118162586884255, "computeRatioMax": 0.01118162586884255, "endMs": "1665778847591", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0015110305228165609, "readRatioMax": 0.0015110305228165609, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778847554", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003022061045633122, "waitRatioMax": 0.0003022061045633122, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.003324267150196434, "writeRatioMax": 0.003324267150196434 }, { "completedParallelInputs": "1", "computeMsAvg": "261", "computeMsMax": "261", "computeRatioAvg": 0.07887579329102448, "computeRatioMax": 0.07887579329102448, "endMs": "1665778847779", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0030220610456331218, "readRatioMax": 0.0030220610456331218, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "270", "startMs": "1665778847584", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_warehouse_sk, $41:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0006044122091266244, "waitRatioMax": 0.0006044122091266244, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.008461770927772741, "writeRatioMax": 0.008461770927772741 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.001813236627379873, "computeRatioMax": 0.001813236627379873, "endMs": "1665778847643", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0015110305228165609, "readRatioMax": 0.0015110305228165609, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778847602", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:web_site_sk, $11:web_company_name", "FROM web_site", "WHERE equal($11, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003022061045633122, "waitRatioMax": 0.0003022061045633122, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.005137503777576307, "writeRatioMax": 0.005137503777576307 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0030220610456331218, "computeRatioMax": 0.0030220610456331218, "endMs": "1665778847649", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.001813236627379873, "readRatioMax": 0.001813236627379873, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778847620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address", "WHERE equal($31, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0006044122091266244, "waitRatioMax": 0.0006044122091266244, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.004835297673012995, "writeRatioMax": 0.004835297673012995 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.003626473254759746, "computeRatioMax": 0.003626473254759746, "endMs": "1665778847673", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.001813236627379873, "readRatioMax": 0.001813236627379873, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778847635", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date", "FROM date_dim", "WHERE between($61, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0006044122091266244, "waitRatioMax": 0.0006044122091266244, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.003626473254759746, "writeRatioMax": 0.003626473254759746 }, { "completedParallelInputs": "1", "computeMsAvg": "3309", "computeMsMax": "3309", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778849896", "id": "7", "inputStages": [ "0", "2" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.001813236627379873, "readRatioMax": 0.001813236627379873, "recordsRead": "1510531", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "2803", "startMs": "1665778847800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_warehouse_sk, $51:ws_order_number", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $1", "INNER HASH JOIN EACH WITH ALL ON $221 = $1" ] }, { "kind": "FILTER", "substeps": [ "not_equal($220, $222)" ] }, { "kind": "JOIN", "substeps": [ "$222 := $50, $220 := $40, $221 := $41", "INNER HASH JOIN EACH WITH ALL ON $51 = $41" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003022061045633122, "waitRatioMax": 0.0003022061045633122, "writeMsAvg": "396", "writeMsMax": "396", "writeRatioAvg": 0.11967361740707162, "writeRatioMax": 0.11967361740707162 }, { "completedParallelInputs": "1", "computeMsAvg": "322", "computeMsMax": "322", "computeRatioAvg": 0.09731036566938653, "computeRatioMax": 0.09731036566938653, "endMs": "1665778850312", "id": "8", "inputStages": [ "5", "4", "3" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "26", "readMsMax": "26", "readRatioAvg": 0.007857358718646117, "readRatioMax": 0.007857358718646117, "recordsRead": "721046", "recordsWritten": "147", "shuffleOutputBytes": "6321", "shuffleOutputBytesSpilled": "0", "slotMs": "294", "startMs": "1665778850080", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_ship_date_sk, $21:ws_ship_addr_sk, $22:ws_web_site_sk, $23:ws_order_number, $24:ws_ext_ship_cost, $25:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $202, $212 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $10" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $30" ] }, { "kind": "JOIN", "substeps": [ "$190 := $21, $191 := $22, $192 := $23, $193 := $24, $194 := $25", "INNER HASH JOIN EACH WITH ALL ON $20 = $60" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003022061045633122, "waitRatioMax": 0.0003022061045633122, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.001813236627379873, "writeRatioMax": 0.001813236627379873 }, { "completedParallelInputs": "100", "computeMsAvg": "14", "computeMsMax": "28", "computeRatioAvg": 0.0042308854638863705, "computeRatioMax": 0.008461770927772741, "endMs": "1665778850390", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5900601", "recordsWritten": "125", "shuffleOutputBytes": "3748", "shuffleOutputBytesSpilled": "0", "slotMs": "2254", "startMs": "1665778850329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$230", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $180, $251 := $160", "$150 := SUM($162)", "$151 := SUM($161)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($180, 1), $240, NULL)", "$161 := if(equal($180, 0), $242, NULL)", "$162 := if(equal($180, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$240 := $210, $241 := $211, $242 := $212", "SEMI HASH JOIN EACH WITH EACH ON $210 = $230" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $251, $250", "TO __stage09_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0006044122091266244, "waitRatioMax": 0.0006044122091266244, "writeMsAvg": "4", "writeMsMax": "11", "writeRatioAvg": 0.0012088244182532487, "writeRatioMax": 0.003324267150196434 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.003324267150196434, "computeRatioMax": 0.003324267150196434, "endMs": "1665778850423", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "125", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665778850405", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $251, $250", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$120 := COUNT($132)", "$121 := ANY_VALUE($131)", "$122 := ANY_VALUE($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := if(equal($260, 0), $141, NULL)", "$131 := if(equal($260, 0), $140, NULL)", "$132 := if(equal($260, 1), $261, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$140 := SUM($150)", "$141 := SUM($151)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $270", "TO __stage0A_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003022061045633122, "waitRatioMax": 0.0003022061045633122, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0015110305228165609, "writeRatioMax": 0.0015110305228165609 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0027198549410698096, "computeRatioMax": 0.0027198549410698096, "endMs": "1665778850461", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778850427", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $270", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($102)", "$91 := ANY_VALUE($101)", "$92 := ANY_VALUE($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := if(equal($280, 0), $112, NULL)", "$101 := if(equal($280, 0), $111, NULL)", "$102 := if(equal($280, 1), $110, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003022061045633122, "waitRatioMax": 0.0003022061045633122, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0042308854638863705, "writeRatioMax": 0.0042308854638863705 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0027198549410698096, "computeRatioMax": 0.0027198549410698096, "endMs": "1665778850467", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778850442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(is_null($80), 0, $80)" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($90)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0003022061045633122, "waitRatioMax": 0.0003022061045633122, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.001813236627379873, "writeRatioMax": 0.001813236627379873 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "600", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "415" }, { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "1583", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1671" }, { "activeUnits": "0", "completedUnits": "110", "elapsedMs": "3037", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5820" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "5820", "transferredBytes": "0" }, "startTime": "1665778847455", "totalBytesProcessed": "54123827", "totalSlotMs": "5820" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf67c35a3_a630_487e_b1cd_d003de155198" }, "priority": "INTERACTIVE", "query": "-- start query 95 in stream 0 using template query95.tpl\n\n/*\nProduce a count of web sales and total shipping cost and net profit in a given 60 day period to customers \nin a given state from a named web site for returned orders shipped from more than one warehouse.\n*/\n\nwith ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and '1999-4-02' \nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n from web_returns,ws_wh\n where wr_order_number = ws_wh.ws_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 95 in stream 0 using template query95.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "K4LCfzm34fkMml/npriLLQ==", "id": "test-project-364309:europe-west1.query95_1665778851", "jobReference": { "jobId": "query95_1665778851", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query95_1665778851?location=europe-west1", "statistics": { "creationTime": "1665778852477", "endTime": "1665778855727", "finalExecutionDurationMs": "3042", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "3385" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.009878903760356916, "computeRatioMax": 0.009878903760356916, "endMs": "1665778852679", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0022307202039515616, "readRatioMax": 0.0022307202039515616, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778852630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.003505417463352454, "writeRatioMax": 0.003505417463352454 }, { "completedParallelInputs": "1", "computeMsAvg": "272", "computeMsMax": "272", "computeRatioAvg": 0.08667941363926067, "computeRatioMax": 0.08667941363926067, "endMs": "1665778852842", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0019120458891013384, "readRatioMax": 0.0019120458891013384, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "256", "startMs": "1665778852646", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_warehouse_sk, $51:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.005417463352453792, "writeRatioMax": 0.005417463352453792 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0022307202039515616, "computeRatioMax": 0.0022307202039515616, "endMs": "1665778852722", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0015933715742511153, "readRatioMax": 0.0015933715742511153, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778852681", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:web_site_sk, $11:web_company_name", "FROM web_site", "WHERE equal($11, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.006054811982154238, "writeRatioMax": 0.006054811982154238 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.004461440407903123, "computeRatioMax": 0.004461440407903123, "endMs": "1665778852737", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0028680688336520078, "readRatioMax": 0.0028680688336520078, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778852697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address", "WHERE equal($31, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0025493945188017845, "writeRatioMax": 0.0025493945188017845 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.005098789037603569, "computeRatioMax": 0.005098789037603569, "endMs": "1665778852754", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0022307202039515616, "readRatioMax": 0.0022307202039515616, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778852716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date", "FROM date_dim", "WHERE between($61, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0057361376673040155, "writeRatioMax": 0.0057361376673040155 }, { "completedParallelInputs": "1", "computeMsAvg": "3138", "computeMsMax": "3138", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778854743", "id": "7", "inputStages": [ "0", "1" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.005098789037603569, "readRatioMax": 0.005098789037603569, "recordsRead": "1510531", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "3168", "startMs": "1665778852911", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_warehouse_sk, $41:ws_order_number", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $1", "INNER HASH JOIN EACH WITH ALL ON $221 = $1" ] }, { "kind": "FILTER", "substeps": [ "not_equal($220, $222)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $40, $221 := $41, $222 := $50", "INNER HASH JOIN EACH WITH ALL ON $41 = $51" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "284", "writeMsMax": "284", "writeRatioAvg": 0.09050350541746335, "writeRatioMax": 0.09050350541746335 }, { "completedParallelInputs": "100", "computeMsAvg": "27", "computeMsMax": "47", "computeRatioAvg": 0.008604206500956023, "computeRatioMax": 0.014977692797960485, "endMs": "1665778854823", "id": "8", "inputStages": [ "7" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8677946", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "5299", "startMs": "1665778854746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.0006373486297004461, "writeMsAvg": "19", "writeMsMax": "52", "writeRatioAvg": 0.006054811982154238, "writeRatioMax": 0.0165710643722116 }, { "completedParallelInputs": "1", "computeMsAvg": "957", "computeMsMax": "957", "computeRatioAvg": 0.3049713193116635, "computeRatioMax": 0.3049713193116635, "endMs": "1665778855428", "id": "9", "inputStages": [ "4", "3", "8", "5" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "26", "readMsMax": "26", "readRatioAvg": 0.0082855321861058, "readRatioMax": 0.0082855321861058, "recordsRead": "9398992", "recordsWritten": "74", "shuffleOutputBytes": "1504", "shuffleOutputBytesSpilled": "0", "slotMs": "895", "startMs": "1665778854749", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_ship_date_sk, $21:ws_ship_addr_sk, $22:ws_web_site_sk, $23:ws_order_number, $24:ws_ext_ship_cost, $25:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$230", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $180, $251 := $160", "$150 := SUM($162)", "$151 := SUM($161)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($180, 1), $240, NULL)", "$161 := if(equal($180, 0), $242, NULL)", "$162 := if(equal($180, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$240 := $210, $241 := $211, $242 := $212", "SEMI HASH JOIN EACH WITH ALL ON $210 = $230" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $202, $212 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $10" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $30" ] }, { "kind": "JOIN", "substeps": [ "$190 := $21, $191 := $22, $192 := $23, $193 := $24, $194 := $25", "INNER HASH JOIN EACH WITH ALL ON $20 = $60" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $251, $250", "TO __stage09_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0015933715742511153, "writeRatioMax": 0.0015933715742511153 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0022307202039515616, "computeRatioMax": 0.0022307202039515616, "endMs": "1665778855584", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "74", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665778855571", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $251, $250", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$120 := COUNT($132)", "$121 := ANY_VALUE($131)", "$122 := ANY_VALUE($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := if(equal($260, 0), $141, NULL)", "$131 := if(equal($260, 0), $140, NULL)", "$132 := if(equal($260, 1), $261, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$140 := SUM($150)", "$141 := SUM($151)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $270", "TO __stage0A_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0015933715742511153, "writeRatioMax": 0.0015933715742511153 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0019120458891013384, "computeRatioMax": 0.0019120458891013384, "endMs": "1665778855624", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665778855587", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $270", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($102)", "$91 := ANY_VALUE($101)", "$92 := ANY_VALUE($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := if(equal($280, 0), $112, NULL)", "$101 := if(equal($280, 0), $111, NULL)", "$102 := if(equal($280, 1), $110, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.005098789037603569, "writeRatioMax": 0.005098789037603569 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.003505417463352454, "computeRatioMax": 0.003505417463352454, "endMs": "1665778855645", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778855604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(is_null($80), 0, $80)" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($90)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031867431485022306, "waitRatioMax": 0.00031867431485022306, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0028680688336520078, "writeRatioMax": 0.0028680688336520078 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "593", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "691" }, { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "1579", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2437" }, { "activeUnits": "1", "completedUnits": "110", "elapsedMs": "3135", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10053" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "10053", "transferredBytes": "0" }, "startTime": "1665778852538", "totalBytesProcessed": "54123827", "totalSlotMs": "10053" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon5cc3d66a_f7a7_4502_b2f3_a9f50851ce3f" }, "priority": "INTERACTIVE", "query": "-- start query 95 in stream 0 using template query95.tpl\n\n/*\nProduce a count of web sales and total shipping cost and net profit in a given 60 day period to customers \nin a given state from a named web site for returned orders shipped from more than one warehouse.\n*/\n\nwith ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and '1999-4-02' \nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n from web_returns,ws_wh\n where wr_order_number = ws_wh.ws_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 95 in stream 0 using template query95.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "QCvhFOl22seIAHUk48oQOw==", "id": "test-project-364309:europe-west1.query95_1665778856", "jobReference": { "jobId": "query95_1665778856", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query95_1665778856?location=europe-west1", "statistics": { "creationTime": "1665778857471", "endTime": "1665778861332", "finalExecutionDurationMs": "3649", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "3336" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.007116564417177914, "computeRatioMax": 0.007116564417177914, "endMs": "1665778857678", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.001226993865030675, "readRatioMax": 0.001226993865030675, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665778857633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0034355828220858898, "writeRatioMax": 0.0034355828220858898 }, { "completedParallelInputs": "1", "computeMsAvg": "250", "computeMsMax": "250", "computeRatioAvg": 0.06134969325153374, "computeRatioMax": 0.06134969325153374, "endMs": "1665778857868", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.00294478527607362, "readRatioMax": 0.00294478527607362, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "280", "startMs": "1665778857685", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_warehouse_sk, $41:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.005644171779141104, "writeRatioMax": 0.005644171779141104 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.00196319018404908, "computeRatioMax": 0.00196319018404908, "endMs": "1665778857759", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.000736196319018405, "readRatioMax": 0.000736196319018405, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778857713", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:web_site_sk, $11:web_company_name", "FROM web_site", "WHERE equal($11, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.005398773006134969, "writeRatioMax": 0.005398773006134969 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00245398773006135, "computeRatioMax": 0.00245398773006135, "endMs": "1665778857769", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.00196319018404908, "readRatioMax": 0.00196319018404908, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778857726", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address", "WHERE equal($31, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.00392638036809816, "writeRatioMax": 0.00392638036809816 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.00294478527607362, "computeRatioMax": 0.00294478527607362, "endMs": "1665778857789", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.00147239263803681, "readRatioMax": 0.00147239263803681, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778857750", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date", "FROM date_dim", "WHERE between($61, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.00588957055214724, "writeRatioMax": 0.00588957055214724 }, { "completedParallelInputs": "1", "computeMsAvg": "4075", "computeMsMax": "4075", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778860573", "id": "7", "inputStages": [ "0", "2" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.00245398773006135, "readRatioMax": 0.00245398773006135, "recordsRead": "1510531", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "4155", "startMs": "1665778857902", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_warehouse_sk, $51:ws_order_number", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $1", "INNER HASH JOIN EACH WITH ALL ON $221 = $1" ] }, { "kind": "FILTER", "substeps": [ "not_equal($220, $222)" ] }, { "kind": "JOIN", "substeps": [ "$222 := $50, $220 := $40, $221 := $41", "INNER HASH JOIN EACH WITH ALL ON $51 = $41" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "468", "writeMsMax": "468", "writeRatioAvg": 0.11484662576687117, "writeRatioMax": 0.11484662576687117 }, { "completedParallelInputs": "1", "computeMsAvg": "443", "computeMsMax": "443", "computeRatioAvg": 0.10871165644171779, "computeRatioMax": 0.10871165644171779, "endMs": "1665778861055", "id": "8", "inputStages": [ "5", "3", "4" ], "name": "S08: Join", "parallelInputs": "1", "readMsAvg": "36", "readMsMax": "36", "readRatioAvg": 0.008834355828220859, "readRatioMax": 0.008834355828220859, "recordsRead": "721046", "recordsWritten": "147", "shuffleOutputBytes": "6321", "shuffleOutputBytesSpilled": "0", "slotMs": "407", "startMs": "1665778860779", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_ship_date_sk, $21:ws_ship_addr_sk, $22:ws_web_site_sk, $23:ws_order_number, $24:ws_ext_ship_cost, $25:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $202, $212 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $10" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $30" ] }, { "kind": "JOIN", "substeps": [ "$190 := $21, $191 := $22, $192 := $23, $193 := $24, $194 := $25", "INNER HASH JOIN EACH WITH ALL ON $20 = $60" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.00196319018404908, "writeRatioMax": 0.00196319018404908 }, { "completedParallelInputs": "100", "computeMsAvg": "13", "computeMsMax": "27", "computeRatioAvg": 0.0031901840490797546, "computeRatioMax": 0.006625766871165644, "endMs": "1665778861160", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5900601", "recordsWritten": "125", "shuffleOutputBytes": "3748", "shuffleOutputBytesSpilled": "0", "slotMs": "1996", "startMs": "1665778861122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$230", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $180, $251 := $160", "$150 := SUM($162)", "$151 := SUM($161)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($180, 1), $240, NULL)", "$161 := if(equal($180, 0), $242, NULL)", "$162 := if(equal($180, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$240 := $210, $241 := $211, $242 := $212", "SEMI HASH JOIN EACH WITH EACH ON $210 = $230" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $251, $250", "TO __stage09_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00049079754601227, "waitRatioMax": 0.000736196319018405, "writeMsAvg": "4", "writeMsMax": "11", "writeRatioAvg": 0.00098159509202454, "writeRatioMax": 0.0026993865030674846 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0017177914110429449, "computeRatioMax": 0.0017177914110429449, "endMs": "1665778861189", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "125", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665778861174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $251, $250", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$120 := COUNT($132)", "$121 := ANY_VALUE($131)", "$122 := ANY_VALUE($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := if(equal($260, 0), $141, NULL)", "$131 := if(equal($260, 0), $140, NULL)", "$132 := if(equal($260, 1), $261, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$140 := SUM($150)", "$141 := SUM($151)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $270", "TO __stage0A_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.00098159509202454, "writeRatioMax": 0.00098159509202454 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0017177914110429449, "computeRatioMax": 0.0017177914110429449, "endMs": "1665778861229", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778861192", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $270", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($102)", "$91 := ANY_VALUE($101)", "$92 := ANY_VALUE($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := if(equal($280, 0), $112, NULL)", "$101 := if(equal($280, 0), $111, NULL)", "$102 := if(equal($280, 1), $110, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0034355828220858898, "writeRatioMax": 0.0034355828220858898 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00245398773006135, "computeRatioMax": 0.00245398773006135, "endMs": "1665778861247", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778861207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(is_null($80), 0, $80)" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($90)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000245398773006135, "waitRatioMax": 0.000245398773006135, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0017177914110429449, "writeRatioMax": 0.0017177914110429449 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "665" }, { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "2588", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3623" }, { "activeUnits": "0", "completedUnits": "110", "elapsedMs": "3751", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7315" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "7315", "transferredBytes": "0" }, "startTime": "1665778857530", "totalBytesProcessed": "54123827", "totalSlotMs": "7315" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3d53b124_6bc5_4294_b879_5054243de013" }, "priority": "INTERACTIVE", "query": "-- start query 95 in stream 0 using template query95.tpl\n\n/*\nProduce a count of web sales and total shipping cost and net profit in a given 60 day period to customers \nin a given state from a named web site for returned orders shipped from more than one warehouse.\n*/\n\nwith ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and '1999-4-02' \nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n from web_returns,ws_wh\n where wr_order_number = ws_wh.ws_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 95 in stream 0 using template query95.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "eFjWSo3GSVWSN+ZbT1ze5w==", "id": "test-project-364309:europe-west1.query95_1665778863", "jobReference": { "jobId": "query95_1665778863", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query95_1665778863?location=europe-west1", "statistics": { "creationTime": "1665778863664", "endTime": "1665778867835", "finalExecutionDurationMs": "3969", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "3375" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.006302934804018121, "computeRatioMax": 0.006302934804018121, "endMs": "1665778863858", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0015757337010045302, "readRatioMax": 0.0015757337010045302, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665778863821", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00019696671262556627, "waitRatioMax": 0.00019696671262556627, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.002166633838881229, "writeRatioMax": 0.002166633838881229 }, { "completedParallelInputs": "1", "computeMsAvg": "378", "computeMsMax": "378", "computeRatioAvg": 0.07445341737246405, "computeRatioMax": 0.07445341737246405, "endMs": "1665778864112", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0017727004136300964, "readRatioMax": 0.0017727004136300964, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "290", "startMs": "1665778863837", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_warehouse_sk, $51:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00019696671262556627, "waitRatioMax": 0.00019696671262556627, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.003939334252511325, "writeRatioMax": 0.003939334252511325 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0019696671262556626, "computeRatioMax": 0.0019696671262556626, "endMs": "1665778863926", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0011818002757533978, "readRatioMax": 0.0011818002757533978, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778863873", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:web_site_sk, $11:web_company_name", "FROM web_site", "WHERE equal($11, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.002166633838881229, "waitRatioMax": 0.002166633838881229, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.004924167815639157, "writeRatioMax": 0.004924167815639157 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0019696671262556626, "computeRatioMax": 0.0019696671262556626, "endMs": "1665778863913", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0017727004136300964, "readRatioMax": 0.0017727004136300964, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778863875", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address", "WHERE equal($31, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00019696671262556627, "waitRatioMax": 0.00019696671262556627, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0017727004136300964, "writeRatioMax": 0.0017727004136300964 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.002166633838881229, "computeRatioMax": 0.002166633838881229, "endMs": "1665778863926", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.001378766988378964, "readRatioMax": 0.001378766988378964, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778863888", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date", "FROM date_dim", "WHERE between($61, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00019696671262556627, "waitRatioMax": 0.00019696671262556627, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.0023636005515067955, "writeRatioMax": 0.0023636005515067955 }, { "completedParallelInputs": "1", "computeMsAvg": "5077", "computeMsMax": "5077", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778866686", "id": "8", "inputStages": [ "1", "0" ], "name": "S08: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0017727004136300964, "readRatioMax": 0.0017727004136300964, "recordsRead": "1510531", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "3110", "startMs": "1665778864172", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_warehouse_sk, $41:ws_order_number", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $1", "INNER HASH JOIN EACH WITH ALL ON $221 = $1" ] }, { "kind": "FILTER", "substeps": [ "not_equal($220, $222)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $40, $221 := $41, $222 := $50", "INNER HASH JOIN EACH WITH ALL ON $41 = $51" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00019696671262556627, "waitRatioMax": 0.00019696671262556627, "writeMsAvg": "423", "writeMsMax": "423", "writeRatioAvg": 0.08331691944061453, "writeRatioMax": 0.08331691944061453 }, { "completedParallelInputs": "100", "computeMsAvg": "28", "computeMsMax": "56", "computeRatioAvg": 0.005515067953515856, "computeRatioMax": 0.011030135907031712, "endMs": "1665778866875", "id": "9", "inputStages": [ "8" ], "name": "S09: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8677946", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "5612", "startMs": "1665778866780", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.00039393342525113255, "waitRatioMax": 0.0005909001378766989, "writeMsAvg": "15", "writeMsMax": "25", "writeRatioAvg": 0.0029545006893834944, "writeRatioMax": 0.004924167815639157 }, { "completedParallelInputs": "1", "computeMsAvg": "1034", "computeMsMax": "1034", "computeRatioAvg": 0.20366358085483555, "computeRatioMax": 0.20366358085483555, "endMs": "1665778867517", "id": "10", "inputStages": [ "3", "9", "4", "5" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "28", "readMsMax": "28", "readRatioAvg": 0.005515067953515856, "readRatioMax": 0.005515067953515856, "recordsRead": "9398992", "recordsWritten": "74", "shuffleOutputBytes": "1504", "shuffleOutputBytesSpilled": "0", "slotMs": "1052", "startMs": "1665778866785", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_ship_date_sk, $21:ws_ship_addr_sk, $22:ws_web_site_sk, $23:ws_order_number, $24:ws_ext_ship_cost, $25:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$230", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $180, $251 := $160", "$150 := SUM($162)", "$151 := SUM($161)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($180, 1), $240, NULL)", "$161 := if(equal($180, 0), $242, NULL)", "$162 := if(equal($180, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$240 := $210, $241 := $211, $242 := $212", "SEMI HASH JOIN EACH WITH ALL ON $210 = $230" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $202, $212 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $10" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $30" ] }, { "kind": "JOIN", "substeps": [ "$190 := $21, $191 := $22, $192 := $23, $193 := $24, $194 := $25", "INNER HASH JOIN EACH WITH ALL ON $20 = $60" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $251, $250", "TO __stage0A_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.00039393342525113255, "waitRatioMax": 0.00039393342525113255, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0009848335631278313, "writeRatioMax": 0.0009848335631278313 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.001378766988378964, "computeRatioMax": 0.001378766988378964, "endMs": "1665778867705", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "74", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665778867692", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $251, $250", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$120 := COUNT($132)", "$121 := ANY_VALUE($131)", "$122 := ANY_VALUE($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := if(equal($260, 0), $141, NULL)", "$131 := if(equal($260, 0), $140, NULL)", "$132 := if(equal($260, 1), $261, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$140 := SUM($150)", "$141 := SUM($151)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $270", "TO __stage0B_output", "BY HASH($270)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00019696671262556627, "waitRatioMax": 0.00019696671262556627, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0009848335631278313, "writeRatioMax": 0.0009848335631278313 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.003545400827260193, "computeRatioMax": 0.003545400827260193, "endMs": "1665778867757", "id": "12", "inputStages": [ "11" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665778867714", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $270", "FROM __stage0B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($102)", "$91 := ANY_VALUE($101)", "$92 := ANY_VALUE($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := if(equal($280, 0), $112, NULL)", "$101 := if(equal($280, 0), $111, NULL)", "$102 := if(equal($280, 1), $110, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0005909001378766989, "waitRatioMax": 0.0005909001378766989, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0031514674020090604, "writeRatioMax": 0.0031514674020090604 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0009848335631278313, "computeRatioMax": 0.0009848335631278313, "endMs": "1665778867763", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778867726", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(is_null($80), 0, $80)" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($90)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00019696671262556627, "waitRatioMax": 0.00019696671262556627, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0009848335631278313, "writeRatioMax": 0.0009848335631278313 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "903" }, { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "2582", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3384" }, { "activeUnits": "1", "completedUnits": "110", "elapsedMs": "4062", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "10543" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "10543", "transferredBytes": "0" }, "startTime": "1665778863724", "totalBytesProcessed": "54123827", "totalSlotMs": "10543" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon31424f23_a676_4991_9a51_3c4c9f2da14c" }, "priority": "INTERACTIVE", "query": "-- start query 95 in stream 0 using template query95.tpl\n\n/*\nProduce a count of web sales and total shipping cost and net profit in a given 60 day period to customers \nin a given state from a named web site for returned orders shipped from more than one warehouse.\n*/\n\nwith ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select \n count(distinct ws_order_number) as order_count\n ,sum(ws_ext_ship_cost) as total_shipping_cost\n ,sum(ws_net_profit) as total_net_profit\nfrom\n web_sales ws1\n ,date_dim\n ,customer_address\n ,web_site\nwhere\n d_date between '1999-2-01' and '1999-4-02' \nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IL'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n from web_returns,ws_wh\n where wr_order_number = ws_wh.ws_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n;\n\n-- end query 95 in stream 0 using template query95.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "XhfHldhFwvTX3DhCBtE9pw==", "id": "test-project-364309:europe-west1.query95_1665778869", "jobReference": { "jobId": "query95_1665778869", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query95_1665778869?location=europe-west1", "statistics": { "creationTime": "1665778869900", "endTime": "1665778872981", "finalExecutionDurationMs": "2845", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "54123827", "performanceInsights": { "avgPreviousExecutionMs": "3441" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.005626758361988122, "computeRatioMax": 0.005626758361988122, "endMs": "1665778870100", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0012503907471084713, "readRatioMax": 0.0012503907471084713, "recordsRead": "71763", "recordsWritten": "71763", "shuffleOutputBytes": "645867", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778870073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:wr_order_number", "FROM web_returns" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031259768677711783, "waitRatioMax": 0.00031259768677711783, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.0031259768677711786, "writeRatioMax": 0.0031259768677711786 }, { "completedParallelInputs": "1", "computeMsAvg": "228", "computeMsMax": "228", "computeRatioAvg": 0.07127227258518287, "computeRatioMax": 0.07127227258518287, "endMs": "1665778870298", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0025007814942169426, "readRatioMax": 0.0025007814942169426, "recordsRead": "719384", "recordsWritten": "719384", "shuffleOutputBytes": "12947480", "shuffleOutputBytesSpilled": "0", "slotMs": "247", "startMs": "1665778870099", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ws_warehouse_sk, $41:ws_order_number", "FROM web_sales" ] }, { "kind": "WRITE", "substeps": [ "$40, $41", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031259768677711783, "waitRatioMax": 0.00031259768677711783, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.007814942169427946, "writeRatioMax": 0.007814942169427946 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.0015629884338855893, "computeRatioMax": 0.0015629884338855893, "endMs": "1665778870171", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.0012503907471084713, "readRatioMax": 0.0012503907471084713, "recordsRead": "30", "recordsWritten": "5", "shuffleOutputBytes": "45", "shuffleOutputBytesSpilled": "0", "slotMs": "19", "startMs": "1665778870145", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:web_site_sk, $11:web_company_name", "FROM web_site", "WHERE equal($11, 'pri')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage03_output" ] } ], "waitMsAvg": "28", "waitMsMax": "28", "waitRatioAvg": 0.0087527352297593, "waitRatioMax": 0.0087527352297593, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.004688965301656768, "writeRatioMax": 0.004688965301656768 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0034385745545482964, "computeRatioMax": 0.0034385745545482964, "endMs": "1665778870176", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0031259768677711786, "readRatioMax": 0.0031259768677711786, "recordsRead": "50000", "recordsWritten": "1596", "shuffleOutputBytes": "14364", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778870146", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ca_address_sk, $31:ca_state", "FROM customer_address", "WHERE equal($31, 'IL')" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage04_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.0031259768677711786, "waitRatioMax": 0.0031259768677711786, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.002813379180994061, "writeRatioMax": 0.002813379180994061 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0031259768677711786, "computeRatioMax": 0.0031259768677711786, "endMs": "1665778870178", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.0015629884338855893, "readRatioMax": 0.0015629884338855893, "recordsRead": "73049", "recordsWritten": "61", "shuffleOutputBytes": "549", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665778870151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_date", "FROM date_dim", "WHERE between($61, 10623, 10683)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031259768677711783, "waitRatioMax": 0.00031259768677711783, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.004063769928102532, "writeRatioMax": 0.004063769928102532 }, { "completedParallelInputs": "1", "computeMsAvg": "3199", "computeMsMax": "3199", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778872176", "id": "7", "inputStages": [ "0", "2" ], "name": "S07: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.00437636761487965, "readRatioMax": 0.00437636761487965, "recordsRead": "1510531", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "2686", "startMs": "1665778870344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ws_warehouse_sk, $51:ws_order_number", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$40, $41", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$230 := $1", "INNER HASH JOIN EACH WITH ALL ON $221 = $1" ] }, { "kind": "FILTER", "substeps": [ "not_equal($220, $222)" ] }, { "kind": "JOIN", "substeps": [ "$222 := $50, $220 := $40, $221 := $41", "INNER HASH JOIN EACH WITH ALL ON $51 = $41" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031259768677711783, "waitRatioMax": 0.00031259768677711783, "writeMsAvg": "251", "writeMsMax": "251", "writeRatioAvg": 0.07846201938105658, "writeRatioMax": 0.07846201938105658 }, { "completedParallelInputs": "100", "computeMsAvg": "27", "computeMsMax": "46", "computeRatioAvg": 0.008440137542982182, "computeRatioMax": 0.01437949359174742, "endMs": "1665778872362", "id": "8", "inputStages": [ "7" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "8677946", "recordsWritten": "8677946", "shuffleOutputBytes": "78101514", "shuffleOutputBytesSpilled": "0", "slotMs": "5464", "startMs": "1665778872286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0006251953735542357, "waitRatioMax": 0.0009377930603313535, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.005001562988433885, "writeRatioMax": 0.009377930603313536 }, { "completedParallelInputs": "1", "computeMsAvg": "673", "computeMsMax": "673", "computeRatioAvg": 0.21037824320100032, "computeRatioMax": 0.21037824320100032, "endMs": "1665778872764", "id": "9", "inputStages": [ "4", "5", "3", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.006877149109096593, "readRatioMax": 0.006877149109096593, "recordsRead": "9398992", "recordsWritten": "74", "shuffleOutputBytes": "1504", "shuffleOutputBytesSpilled": "0", "slotMs": "650", "startMs": "1665778872291", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_ship_date_sk, $21:ws_ship_addr_sk, $22:ws_web_site_sk, $23:ws_order_number, $24:ws_ext_ship_cost, $25:ws_net_profit", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$230", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $250 := $180, $251 := $160", "$150 := SUM($162)", "$151 := SUM($161)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($180, 1), $240, NULL)", "$161 := if(equal($180, 0), $242, NULL)", "$162 := if(equal($180, 0), $241, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := ARRAY<...>" ] }, { "kind": "JOIN", "substeps": [ "$240 := $210, $241 := $211, $242 := $212", "SEMI HASH JOIN EACH WITH ALL ON $210 = $230" ] }, { "kind": "JOIN", "substeps": [ "$210 := $201, $211 := $202, $212 := $203", "INNER HASH JOIN EACH WITH ALL ON $200 = $10" ] }, { "kind": "JOIN", "substeps": [ "$200 := $191, $201 := $192, $202 := $193, $203 := $194", "INNER HASH JOIN EACH WITH ALL ON $190 = $30" ] }, { "kind": "JOIN", "substeps": [ "$190 := $21, $191 := $22, $192 := $23, $193 := $24, $194 := $25", "INNER HASH JOIN EACH WITH ALL ON $20 = $60" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $251, $250", "TO __stage09_output", "BY HASH($250, $251)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0009377930603313535, "waitRatioMax": 0.0009377930603313535, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0012503907471084713, "writeRatioMax": 0.0012503907471084713 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0025007814942169426, "computeRatioMax": 0.0025007814942169426, "endMs": "1665778872820", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "74", "recordsWritten": "2", "shuffleOutputBytes": "72", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665778872806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $251, $250", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260", "$120 := COUNT($132)", "$121 := ANY_VALUE($131)", "$122 := ANY_VALUE($130)" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := if(equal($260, 0), $141, NULL)", "$131 := if(equal($260, 0), $140, NULL)", "$132 := if(equal($260, 1), $261, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250, $261 := $251", "$140 := SUM($150)", "$141 := SUM($151)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $122, $270", "TO __stage0A_output", "BY HASH($270)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0006251953735542357, "waitRatioMax": 0.0006251953735542357, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0012503907471084713, "writeRatioMax": 0.0012503907471084713 }, { "completedParallelInputs": "1", "computeMsAvg": "3", "computeMsMax": "3", "computeRatioAvg": 0.0009377930603313535, "computeRatioMax": 0.0009377930603313535, "endMs": "1665778872859", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665778872827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121, $122, $270", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($102)", "$91 := ANY_VALUE($101)", "$92 := ANY_VALUE($100)" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := if(equal($280, 0), $112, NULL)", "$101 := if(equal($280, 0), $111, NULL)", "$102 := if(equal($280, 1), $110, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270", "$110 := SUM_OF_COUNTS($120)", "$111 := ANY_VALUE($121)", "$112 := ANY_VALUE($122)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031259768677711783, "waitRatioMax": 0.00031259768677711783, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.008127539856205065, "writeRatioMax": 0.008127539856205065 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.002813379180994061, "computeRatioMax": 0.002813379180994061, "endMs": "1665778872880", "id": "12", "inputStages": [ "11" ], "name": "S0C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "43", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778872842", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$70 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$70 := if(is_null($80), 0, $80)" ] }, { "kind": "AGGREGATE", "substeps": [ "$80 := ANY_VALUE($90)", "$81 := ANY_VALUE($91)", "$82 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00031259768677711783, "waitRatioMax": 0.00031259768677711783, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.001875586120662707, "writeRatioMax": 0.001875586120662707 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_site" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "5", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "578" }, { "activeUnits": "1", "completedUnits": "106", "elapsedMs": "2579", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "8729" }, { "activeUnits": "1", "completedUnits": "110", "elapsedMs": "2940", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "9451" } ], "totalBytesBilled": "54525952", "totalBytesProcessed": "54123827", "totalPartitionsProcessed": "0", "totalSlotMs": "9451", "transferredBytes": "0" }, "startTime": "1665778869976", "totalBytesProcessed": "54123827", "totalSlotMs": "9451" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
