{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0b52b3db_27c7_4e71_a6e1_bf1b2965810b" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "CoJ50M3mKnDgtjwC9FrJUg==", "id": "test-project-364309:europe-west1.query11_1665768229", "jobReference": { "jobId": "query11_1665768229", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665768229?location=europe-west1", "statistics": { "creationTime": "1665768230441", "endTime": "1665768232665", "finalExecutionDurationMs": "1995", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1655" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013437849944008958, "computeRatioMax": 0.013437849944008958, "endMs": "1665768230632", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007838745800671893, "readRatioMax": 0.007838745800671893, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768230601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011198208286674132, "waitRatioMax": 0.0011198208286674132, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0167973124300112, "writeRatioMax": 0.0167973124300112 }, { "completedParallelInputs": "1", "computeMsAvg": "300", "computeMsMax": "300", "computeRatioAvg": 0.335946248600224, "computeRatioMax": 0.335946248600224, "endMs": "1665768230861", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.020156774916013438, "readRatioMax": 0.020156774916013438, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "308", "startMs": "1665768230631", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0022396416573348264, "waitRatioMax": 0.0022396416573348264, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.020156774916013438, "writeRatioMax": 0.020156774916013438 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.011198208286674132, "computeRatioMax": 0.011198208286674132, "endMs": "1665768230814", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006718924972004479, "readRatioMax": 0.006718924972004479, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768230757", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "106", "waitMsMax": "106", "waitRatioAvg": 0.1187010078387458, "waitRatioMax": 0.1187010078387458, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.03135498320268757, "writeRatioMax": 0.03135498320268757 }, { "completedParallelInputs": "1", "computeMsAvg": "202", "computeMsMax": "202", "computeRatioAvg": 0.22620380739081747, "computeRatioMax": 0.22620380739081747, "endMs": "1665768230943", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.020156774916013438, "readRatioMax": 0.020156774916013438, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "217", "startMs": "1665768230762", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "69", "waitMsMax": "69", "waitRatioAvg": 0.07726763717805152, "waitRatioMax": 0.07726763717805152, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01791713325867861, "writeRatioMax": 0.01791713325867861 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.015677491601343786, "computeRatioMax": 0.015677491601343786, "endMs": "1665768230806", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.011198208286674132, "readRatioMax": 0.011198208286674132, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768230766", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "52", "waitMsMax": "52", "waitRatioAvg": 0.05823068309070549, "waitRatioMax": 0.05823068309070549, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.011198208286674132, "writeRatioMax": 0.011198208286674132 }, { "completedParallelInputs": "1", "computeMsAvg": "218", "computeMsMax": "218", "computeRatioAvg": 0.24412094064949608, "computeRatioMax": 0.24412094064949608, "endMs": "1665768230974", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.02127659574468085, "readRatioMax": 0.02127659574468085, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "277", "startMs": "1665768230762", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "16", "waitMsMax": "16", "waitRatioAvg": 0.01791713325867861, "waitRatioMax": 0.01791713325867861, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.02127659574468085, "writeRatioMax": 0.02127659574468085 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.012318029115341545, "computeRatioMax": 0.012318029115341545, "endMs": "1665768230808", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007838745800671893, "readRatioMax": 0.007838745800671893, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768230769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0033594624860022394, "waitRatioMax": 0.0033594624860022394, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.008958566629339306, "writeRatioMax": 0.008958566629339306 }, { "completedParallelInputs": "1", "computeMsAvg": "285", "computeMsMax": "285", "computeRatioAvg": 0.3191489361702128, "computeRatioMax": 0.3191489361702128, "endMs": "1665768231020", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0167973124300112, "readRatioMax": 0.0167973124300112, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "266", "startMs": "1665768230806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011198208286674132, "waitRatioMax": 0.0011198208286674132, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.020156774916013438, "writeRatioMax": 0.020156774916013438 }, { "completedParallelInputs": "6", "computeMsAvg": "724", "computeMsMax": "846", "computeRatioAvg": 0.8107502799552072, "computeRatioMax": 0.9473684210526315, "endMs": "1665768231395", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.01791713325867861, "readRatioMax": 0.022396416573348264, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "3580", "startMs": "1665768230896", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0022396416573348264, "waitRatioMax": 0.0033594624860022394, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.007838745800671893, "writeRatioMax": 0.010078387458006719 }, { "completedParallelInputs": "1", "computeMsAvg": "631", "computeMsMax": "631", "computeRatioAvg": 0.7066069428891377, "computeRatioMax": 0.7066069428891377, "endMs": "1665768231432", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "25", "readMsMax": "25", "readRatioAvg": 0.027995520716685332, "readRatioMax": 0.027995520716685332, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "639", "startMs": "1665768230966", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0D_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0022396416573348264, "waitRatioMax": 0.0022396416573348264, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.02463605823068309, "writeRatioMax": 0.02463605823068309 }, { "completedParallelInputs": "6", "computeMsAvg": "746", "computeMsMax": "893", "computeRatioAvg": 0.8353863381858903, "computeRatioMax": 1, "endMs": "1665768231545", "id": "14", "inputStages": [ "8", "6" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "37", "readRatioAvg": 0.02463605823068309, "readRatioMax": 0.04143337066069429, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "4068", "startMs": "1665768231013", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0E_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.0022396416573348264, "waitRatioMax": 0.0033594624860022394, "writeMsAvg": "8", "writeMsMax": "11", "writeRatioAvg": 0.008958566629339306, "writeRatioMax": 0.012318029115341545 }, { "completedParallelInputs": "1", "computeMsAvg": "574", "computeMsMax": "574", "computeRatioAvg": 0.6427771556550952, "computeRatioMax": 0.6427771556550952, "endMs": "1665768231459", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "27", "readMsMax": "27", "readRatioAvg": 0.030235162374020158, "readRatioMax": 0.030235162374020158, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "433", "startMs": "1665768231093", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0033594624860022394, "waitRatioMax": 0.0033594624860022394, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.026875699888017916, "writeRatioMax": 0.026875699888017916 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.05039193729003359, "computeRatioMax": 0.05039193729003359, "endMs": "1665768231640", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768231594", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0022396416573348264, "waitRatioMax": 0.0022396416573348264, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.020156774916013438, "writeRatioMax": 0.020156774916013438 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.04479283314669653, "computeRatioMax": 0.04479283314669653, "endMs": "1665768231664", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665768231610", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0011198208286674132, "waitRatioMax": 0.0011198208286674132, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.022396416573348264, "writeRatioMax": 0.022396416573348264 }, { "completedParallelInputs": "1", "computeMsAvg": "411", "computeMsMax": "411", "computeRatioAvg": 0.46024636058230683, "computeRatioMax": 0.46024636058230683, "endMs": "1665768231811", "id": "18", "inputStages": [ "14" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "376", "startMs": "1665768231628", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$130, $330, $331, $332, $333", "TO __stage12_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0033594624860022394, "waitRatioMax": 0.0033594624860022394, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.023516237402015677, "writeRatioMax": 0.023516237402015677 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.008958566629339306, "computeRatioMax": 0.019036954087346025, "endMs": "1665768231911", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "3529", "startMs": "1665768231840", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "4", "waitMsMax": "13", "waitRatioAvg": 0.004479283314669653, "waitRatioMax": 0.014557670772676373, "writeMsAvg": "11", "writeMsMax": "30", "writeRatioAvg": 0.012318029115341545, "writeRatioMax": 0.0335946248600224 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "20", "computeRatioAvg": 0.007838745800671893, "computeRatioMax": 0.022396416573348264, "endMs": "1665768231911", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "2637", "startMs": "1665768231846", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "13", "waitMsMax": "17", "waitRatioAvg": 0.014557670772676373, "waitRatioMax": 0.019036954087346025, "writeMsAvg": "4", "writeMsMax": "27", "writeRatioAvg": 0.004479283314669653, "writeRatioMax": 0.030235162374020158 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.007838745800671893, "computeRatioMax": 0.01791713325867861, "endMs": "1665768231911", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "2253", "startMs": "1665768231846", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "17", "waitMsMax": "21", "waitRatioAvg": 0.019036954087346025, "waitRatioMax": 0.023516237402015677, "writeMsAvg": "4", "writeMsMax": "29", "writeRatioAvg": 0.004479283314669653, "writeRatioMax": 0.032474804031354984 }, { "completedParallelInputs": "1", "computeMsAvg": "565", "computeMsMax": "565", "computeRatioAvg": 0.6326987681970885, "computeRatioMax": 0.6326987681970885, "endMs": "1665768232315", "id": "23", "inputStages": [ "12", "21", "20", "22" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "583", "startMs": "1665768231877", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $330, $331, $332, $333", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$340 := $280, $341 := $160, $342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130", "INNER HASH JOIN EACH WITH ALL ON $280 = $330" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "21", "waitMsMax": "21", "waitRatioAvg": 0.023516237402015677, "waitRatioMax": 0.023516237402015677, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.011198208286674132, "writeRatioMax": 0.011198208286674132 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.013437849944008958, "computeRatioMax": 0.013437849944008958, "endMs": "1665768232393", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "566", "startMs": "1665768231878", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0033594624860022394, "waitRatioMax": 0.0033594624860022394, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0033594624860022394, "writeRatioMax": 0.0033594624860022394 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "619", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "3259" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "2134", "estimatedRunnableUnits": "1", "pendingUnits": "0", "totalSlotMs": "21344" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "21344", "transferredBytes": "0" }, "startTime": "1665768230485", "totalBytesProcessed": "176020858", "totalSlotMs": "21344" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon87527b06_e50d_415a_8fa9_e34cc119bdb1" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "W8DBiHHj7v1TQr1A+f/7+w==", "id": "test-project-364309:europe-west1.query11_1665776556", "jobReference": { "jobId": "query11_1665776556", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776556?location=europe-west1", "statistics": { "creationTime": "1665776556829", "endTime": "1665776558695", "finalExecutionDurationMs": "1660", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1703" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.011661807580174927, "computeRatioMax": 0.011661807580174927, "endMs": "1665776557013", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.006802721088435374, "readRatioMax": 0.006802721088435374, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776556978", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.007774538386783284, "writeRatioMax": 0.007774538386783284 }, { "completedParallelInputs": "1", "computeMsAvg": "181", "computeMsMax": "181", "computeRatioAvg": 0.17589893100097181, "computeRatioMax": 0.17589893100097181, "endMs": "1665776557209", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.01652089407191448, "readRatioMax": 0.01652089407191448, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "411", "startMs": "1665776557005", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.013605442176870748, "writeRatioMax": 0.013605442176870748 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.008746355685131196, "computeRatioMax": 0.008746355685131196, "endMs": "1665776557149", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.008746355685131196, "readRatioMax": 0.008746355685131196, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776557103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "86", "waitMsMax": "86", "waitRatioAvg": 0.08357628765792031, "waitRatioMax": 0.08357628765792031, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.014577259475218658, "writeRatioMax": 0.014577259475218658 }, { "completedParallelInputs": "1", "computeMsAvg": "210", "computeMsMax": "210", "computeRatioAvg": 0.20408163265306123, "computeRatioMax": 0.20408163265306123, "endMs": "1665776557333", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.015549076773566569, "readRatioMax": 0.015549076773566569, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "328", "startMs": "1665776557103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "57", "waitMsMax": "57", "waitRatioAvg": 0.05539358600583091, "waitRatioMax": 0.05539358600583091, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.01749271137026239, "writeRatioMax": 0.01749271137026239 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.006802721088435374, "computeRatioMax": 0.006802721088435374, "endMs": "1665776557142", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.006802721088435374, "readRatioMax": 0.006802721088435374, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776557104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "42", "waitMsMax": "42", "waitRatioAvg": 0.04081632653061224, "waitRatioMax": 0.04081632653061224, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.024295432458697766, "writeRatioMax": 0.024295432458697766 }, { "completedParallelInputs": "1", "computeMsAvg": "194", "computeMsMax": "194", "computeRatioAvg": 0.18853255587949466, "computeRatioMax": 0.18853255587949466, "endMs": "1665776557277", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.013605442176870748, "readRatioMax": 0.013605442176870748, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "228", "startMs": "1665776557103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.010689990281827016, "waitRatioMax": 0.010689990281827016, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.011661807580174927, "writeRatioMax": 0.011661807580174927 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.006802721088435374, "computeRatioMax": 0.006802721088435374, "endMs": "1665776557149", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004859086491739553, "readRatioMax": 0.004859086491739553, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776557109", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.014577259475218658, "writeRatioMax": 0.014577259475218658 }, { "completedParallelInputs": "1", "computeMsAvg": "176", "computeMsMax": "176", "computeRatioAvg": 0.17103984450923226, "computeRatioMax": 0.17103984450923226, "endMs": "1665776557337", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.011661807580174927, "readRatioMax": 0.011661807580174927, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "244", "startMs": "1665776557139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.012633624878522837, "writeRatioMax": 0.012633624878522837 }, { "completedParallelInputs": "6", "computeMsAvg": "710", "computeMsMax": "779", "computeRatioAvg": 0.6899902818270165, "computeRatioMax": 0.7570456754130224, "endMs": "1665776557749", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "23", "readRatioAvg": 0.01749271137026239, "readRatioMax": 0.022351797862001945, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "3784", "startMs": "1665776557262", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "8", "writeMsMax": "12", "writeRatioAvg": 0.007774538386783284, "writeRatioMax": 0.011661807580174927 }, { "completedParallelInputs": "6", "computeMsAvg": "830", "computeMsMax": "1029", "computeRatioAvg": 0.8066083576287658, "computeRatioMax": 1, "endMs": "1665776557937", "id": "13", "inputStages": [ "8", "6" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "23", "readRatioAvg": 0.0184645286686103, "readRatioMax": 0.022351797862001945, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "4590", "startMs": "1665776557320", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0D_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "8", "writeMsMax": "14", "writeRatioAvg": 0.007774538386783284, "writeRatioMax": 0.013605442176870748 }, { "completedParallelInputs": "1", "computeMsAvg": "676", "computeMsMax": "676", "computeRatioAvg": 0.6569484936831875, "computeRatioMax": 0.6569484936831875, "endMs": "1665776557733", "id": "14", "inputStages": [ "5", "3" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "24", "readMsMax": "24", "readRatioAvg": 0.023323615160349854, "readRatioMax": 0.023323615160349854, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "699", "startMs": "1665776557363", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0E_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.01749271137026239, "writeRatioMax": 0.01749271137026239 }, { "completedParallelInputs": "1", "computeMsAvg": "699", "computeMsMax": "699", "computeRatioAvg": 0.6793002915451894, "computeRatioMax": 0.6793002915451894, "endMs": "1665776557787", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.021379980563654033, "readRatioMax": 0.021379980563654033, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "441", "startMs": "1665776557408", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.01749271137026239, "writeRatioMax": 0.01749271137026239 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.028182701652089408, "computeRatioMax": 0.028182701652089408, "endMs": "1665776558032", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665776557988", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.022351797862001945, "writeRatioMax": 0.022351797862001945 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.027210884353741496, "computeRatioMax": 0.027210884353741496, "endMs": "1665776558046", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776558003", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0E_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009718172983479105, "waitRatioMax": 0.0009718172983479105, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.021379980563654033, "writeRatioMax": 0.021379980563654033 }, { "completedParallelInputs": "1", "computeMsAvg": "298", "computeMsMax": "298", "computeRatioAvg": 0.28960155490767736, "computeRatioMax": 0.28960155490767736, "endMs": "1665776558234", "id": "19", "inputStages": [ "12" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "372", "startMs": "1665776558032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$160, $280", "TO __stage13_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0184645286686103, "writeRatioMax": 0.0184645286686103 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.007774538386783284, "computeRatioMax": 0.012633624878522837, "endMs": "1665776558331", "id": "20", "inputStages": [ "19" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "4052", "startMs": "1665776558280", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.001943634596695821, "waitRatioMax": 0.004859086491739553, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.013605442176870748, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.007774538386783284, "computeRatioMax": 0.013605442176870748, "endMs": "1665776558331", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "4676", "startMs": "1665776558281", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.004859086491739553, "waitRatioMax": 0.0058309037900874635, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.014577259475218658, "writeRatioMax": 0.0184645286686103 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "19", "computeRatioAvg": 0.006802721088435374, "computeRatioMax": 0.0184645286686103, "endMs": "1665776558335", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "4077", "startMs": "1665776558281", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.0058309037900874635, "waitRatioMax": 0.006802721088435374, "writeMsAvg": "7", "writeMsMax": "19", "writeRatioAvg": 0.006802721088435374, "writeRatioMax": 0.0184645286686103 }, { "completedParallelInputs": "1", "computeMsAvg": "362", "computeMsMax": "362", "computeRatioAvg": 0.35179786200194363, "computeRatioMax": 0.35179786200194363, "endMs": "1665776558532", "id": "23", "inputStages": [ "21", "22", "13", "20" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "262866", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "428", "startMs": "1665776558295", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$160, $280", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130, $340 := $280, $341 := $160", "INNER HASH JOIN EACH WITH ALL ON $330 = $280" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.006802721088435374, "waitRatioMax": 0.006802721088435374, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0009718172983479105, "writeRatioMax": 0.0009718172983479105 }, { "completedParallelInputs": "1", "computeMsAvg": "3", "computeMsMax": "3", "computeRatioAvg": 0.0029154518950437317, "computeRatioMax": 0.0029154518950437317, "endMs": "1665776558578", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "348", "startMs": "1665776558298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001943634596695821, "waitRatioMax": 0.001943634596695821, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0029154518950437317, "writeRatioMax": 0.0029154518950437317 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "599", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "3303" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1766", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "26751" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "26751", "transferredBytes": "0" }, "startTime": "1665776556880", "totalBytesProcessed": "176020858", "totalSlotMs": "26751" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond297f3fb_d846_45f1_bc11_119774b9741f" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8dz710w8anV0EPesYCDRCw==", "id": "test-project-364309:europe-west1.query11_1665776560", "jobReference": { "jobId": "query11_1665776560", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776560?location=europe-west1", "statistics": { "creationTime": "1665776560887", "endTime": "1665776562803", "finalExecutionDurationMs": "1686", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1698" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.006672226855713094, "computeRatioMax": 0.006672226855713094, "endMs": "1665776561094", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0050041701417848205, "readRatioMax": 0.0050041701417848205, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665776561056", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010842368640533779, "writeRatioMax": 0.010842368640533779 }, { "completedParallelInputs": "1", "computeMsAvg": "166", "computeMsMax": "166", "computeRatioAvg": 0.13844870725604672, "computeRatioMax": 0.13844870725604672, "endMs": "1665776561228", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.014178482068390326, "readRatioMax": 0.014178482068390326, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "208", "startMs": "1665776561080", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.013344453711426188, "writeRatioMax": 0.013344453711426188 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.005838198498748957, "computeRatioMax": 0.005838198498748957, "endMs": "1665776561137", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0050041701417848205, "readRatioMax": 0.0050041701417848205, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776561094", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.014178482068390326, "writeRatioMax": 0.014178482068390326 }, { "completedParallelInputs": "1", "computeMsAvg": "165", "computeMsMax": "165", "computeRatioAvg": 0.13761467889908258, "computeRatioMax": 0.13761467889908258, "endMs": "1665776561385", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.010008340283569641, "readRatioMax": 0.010008340283569641, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "220", "startMs": "1665776561228", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "107", "waitMsMax": "107", "waitRatioAvg": 0.08924103419516263, "waitRatioMax": 0.08924103419516263, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.011676396997497914, "writeRatioMax": 0.011676396997497914 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.009174311926605505, "computeRatioMax": 0.009174311926605505, "endMs": "1665776561273", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.005838198498748957, "readRatioMax": 0.005838198498748957, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776561233", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "98", "waitMsMax": "98", "waitRatioAvg": 0.0817347789824854, "waitRatioMax": 0.0817347789824854, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.010008340283569641, "writeRatioMax": 0.010008340283569641 }, { "completedParallelInputs": "1", "computeMsAvg": "282", "computeMsMax": "282", "computeRatioAvg": 0.23519599666388658, "computeRatioMax": 0.23519599666388658, "endMs": "1665776561440", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.012510425354462052, "readRatioMax": 0.012510425354462052, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "336", "startMs": "1665776561234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "70", "waitMsMax": "70", "waitRatioAvg": 0.058381984987489574, "waitRatioMax": 0.058381984987489574, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.012510425354462052, "writeRatioMax": 0.012510425354462052 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.008340283569641367, "computeRatioMax": 0.008340283569641367, "endMs": "1665776561266", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.007506255212677231, "readRatioMax": 0.007506255212677231, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665776561235", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "51", "waitMsMax": "51", "waitRatioAvg": 0.042535446205170975, "waitRatioMax": 0.042535446205170975, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.010842368640533779, "writeRatioMax": 0.010842368640533779 }, { "completedParallelInputs": "1", "computeMsAvg": "242", "computeMsMax": "242", "computeRatioAvg": 0.2018348623853211, "computeRatioMax": 0.2018348623853211, "endMs": "1665776561416", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.012510425354462052, "readRatioMax": 0.012510425354462052, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "390", "startMs": "1665776561234", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "26", "waitMsMax": "26", "waitRatioAvg": 0.021684737281067557, "waitRatioMax": 0.021684737281067557, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.014178482068390326, "writeRatioMax": 0.014178482068390326 }, { "completedParallelInputs": "6", "computeMsAvg": "812", "computeMsMax": "1044", "computeRatioAvg": 0.677231025854879, "computeRatioMax": 0.8707256046705588, "endMs": "1665776561807", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "23", "readRatioAvg": 0.014178482068390326, "readRatioMax": 0.019182652210175146, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "5103", "startMs": "1665776561236", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.005838198498748957, "writeRatioMax": 0.006672226855713094 }, { "completedParallelInputs": "1", "computeMsAvg": "606", "computeMsMax": "606", "computeRatioAvg": 0.5054211843202668, "computeRatioMax": 0.5054211843202668, "endMs": "1665776561871", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "48", "readMsMax": "48", "readRatioAvg": 0.040033361134278564, "readRatioMax": 0.040033361134278564, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "823", "startMs": "1665776561431", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0D_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.01751459549624687, "writeRatioMax": 0.01751459549624687 }, { "completedParallelInputs": "1", "computeMsAvg": "734", "computeMsMax": "734", "computeRatioAvg": 0.6121768140116765, "computeRatioMax": 0.6121768140116765, "endMs": "1665776561893", "id": "14", "inputStages": [ "11", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "38", "readMsMax": "38", "readRatioAvg": 0.0316930775646372, "readRatioMax": 0.0316930775646372, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "759", "startMs": "1665776561448", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0E_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0016680567139282735, "waitRatioMax": 0.0016680567139282735, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.01834862385321101, "writeRatioMax": 0.01834862385321101 }, { "completedParallelInputs": "6", "computeMsAvg": "828", "computeMsMax": "1199", "computeRatioAvg": 0.6905754795663053, "computeRatioMax": 1, "endMs": "1665776562108", "id": "15", "inputStages": [ "6", "8" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "23", "readRatioAvg": 0.0158465387823186, "readRatioMax": 0.019182652210175146, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "5985", "startMs": "1665776561486", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0F_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.005838198498748957, "writeRatioMax": 0.008340283569641367 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.02418682235195997, "computeRatioMax": 0.02418682235195997, "endMs": "1665776562178", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665776562139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0158465387823186, "writeRatioMax": 0.0158465387823186 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.027522935779816515, "computeRatioMax": 0.027522935779816515, "endMs": "1665776562198", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776562154", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.016680567139282735, "writeRatioMax": 0.016680567139282735 }, { "completedParallelInputs": "1", "computeMsAvg": "298", "computeMsMax": "298", "computeRatioAvg": 0.24854045037531275, "computeRatioMax": 0.24854045037531275, "endMs": "1665776562354", "id": "18", "inputStages": [ "15" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "289", "startMs": "1665776562169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$130, $330, $331, $332, $333", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008340283569641367, "waitRatioMax": 0.0008340283569641367, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.019182652210175146, "writeRatioMax": 0.019182652210175146 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.006672226855713094, "computeRatioMax": 0.014178482068390326, "endMs": "1665776562415", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "4638", "startMs": "1665776562364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0016680567139282735, "waitRatioMax": 0.0050041701417848205, "writeMsAvg": "15", "writeMsMax": "17", "writeRatioAvg": 0.012510425354462052, "writeRatioMax": 0.014178482068390326 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.005838198498748957, "computeRatioMax": 0.013344453711426188, "endMs": "1665776562416", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "4638", "startMs": "1665776562365", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.0050041701417848205, "waitRatioMax": 0.005838198498748957, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.011676396997497914, "writeRatioMax": 0.0158465387823186 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.005838198498748957, "computeRatioMax": 0.013344453711426188, "endMs": "1665776562416", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "4599", "startMs": "1665776562365", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.0050041701417848205, "waitRatioMax": 0.005838198498748957, "writeMsAvg": "11", "writeMsMax": "18", "writeRatioAvg": 0.009174311926605505, "writeRatioMax": 0.015012510425354461 }, { "completedParallelInputs": "1", "computeMsAvg": "315", "computeMsMax": "315", "computeRatioAvg": 0.2627189324437031, "computeRatioMax": 0.2627189324437031, "endMs": "1665776562616", "id": "23", "inputStages": [ "21", "12", "22", "20" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "309", "startMs": "1665776562376", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $330, $331, $332, $333", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$340 := $280, $341 := $160, $342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130", "INNER HASH JOIN EACH WITH ALL ON $280 = $330" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.007506255212677231, "waitRatioMax": 0.007506255212677231, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0050041701417848205, "computeRatioMax": 0.0050041701417848205, "endMs": "1665776562649", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "457", "startMs": "1665776562386", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0025020850708924102, "waitRatioMax": 0.0025020850708924102, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.003336113427856547, "writeRatioMax": 0.003336113427856547 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "616", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "3206" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1814", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "30043" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "30043", "transferredBytes": "0" }, "startTime": "1665776560941", "totalBytesProcessed": "176020858", "totalSlotMs": "30043" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon58bf7c2e_6255_4c93_9ae6_e6b755727e75" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "jnB9NAfnkosy3ViQQGQAPw==", "id": "test-project-364309:europe-west1.query11_1665776564", "jobReference": { "jobId": "query11_1665776564", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776564?location=europe-west1", "statistics": { "creationTime": "1665776564793", "endTime": "1665776566584", "finalExecutionDurationMs": "1576", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1697" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.009656652360515022, "computeRatioMax": 0.009656652360515022, "endMs": "1665776565023", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0075107296137339056, "readRatioMax": 0.0075107296137339056, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776564982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.016094420600858368, "writeRatioMax": 0.016094420600858368 }, { "completedParallelInputs": "1", "computeMsAvg": "140", "computeMsMax": "140", "computeRatioAvg": 0.15021459227467812, "computeRatioMax": 0.15021459227467812, "endMs": "1665776565204", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.013948497854077254, "readRatioMax": 0.013948497854077254, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "197", "startMs": "1665776565073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "48", "waitMsMax": "48", "waitRatioAvg": 0.05150214592274678, "waitRatioMax": 0.05150214592274678, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.016094420600858368, "writeRatioMax": 0.016094420600858368 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01072961373390558, "computeRatioMax": 0.01072961373390558, "endMs": "1665776565117", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008583690987124463, "readRatioMax": 0.008583690987124463, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776565075", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "24", "waitMsMax": "24", "waitRatioAvg": 0.02575107296137339, "waitRatioMax": 0.02575107296137339, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.013948497854077254, "writeRatioMax": 0.013948497854077254 }, { "completedParallelInputs": "1", "computeMsAvg": "208", "computeMsMax": "208", "computeRatioAvg": 0.22317596566523606, "computeRatioMax": 0.22317596566523606, "endMs": "1665776565250", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.012875536480686695, "readRatioMax": 0.012875536480686695, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "233", "startMs": "1665776565102", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.012875536480686695, "writeRatioMax": 0.012875536480686695 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01072961373390558, "computeRatioMax": 0.01072961373390558, "endMs": "1665776565172", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.008583690987124463, "readRatioMax": 0.008583690987124463, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "93", "startMs": "1665776565128", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.028969957081545063, "writeRatioMax": 0.028969957081545063 }, { "completedParallelInputs": "1", "computeMsAvg": "222", "computeMsMax": "222", "computeRatioAvg": 0.23819742489270387, "computeRatioMax": 0.23819742489270387, "endMs": "1665776565372", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.02145922746781116, "readRatioMax": 0.02145922746781116, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "302", "startMs": "1665776565166", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0203862660944206, "writeRatioMax": 0.0203862660944206 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01072961373390558, "computeRatioMax": 0.01072961373390558, "endMs": "1665776565223", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006437768240343348, "readRatioMax": 0.006437768240343348, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776565186", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002145922746781116, "waitRatioMax": 0.002145922746781116, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.013948497854077254, "writeRatioMax": 0.013948497854077254 }, { "completedParallelInputs": "1", "computeMsAvg": "194", "computeMsMax": "194", "computeRatioAvg": 0.20815450643776823, "computeRatioMax": 0.20815450643776823, "endMs": "1665776565398", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.016094420600858368, "readRatioMax": 0.016094420600858368, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "268", "startMs": "1665776565218", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0203862660944206, "writeRatioMax": 0.0203862660944206 }, { "completedParallelInputs": "6", "computeMsAvg": "764", "computeMsMax": "932", "computeRatioAvg": 0.8197424892703863, "computeRatioMax": 1, "endMs": "1665776565824", "id": "12", "inputStages": [ "0", "2" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "18", "readRatioAvg": 0.017167381974248927, "readRatioMax": 0.019313304721030045, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "5211", "startMs": "1665776565229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.0075107296137339056, "writeRatioMax": 0.008583690987124463 }, { "completedParallelInputs": "1", "computeMsAvg": "586", "computeMsMax": "586", "computeRatioAvg": 0.628755364806867, "computeRatioMax": 0.628755364806867, "endMs": "1665776565682", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "27", "readMsMax": "27", "readRatioAvg": 0.028969957081545063, "readRatioMax": 0.028969957081545063, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "668", "startMs": "1665776565276", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0D_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002145922746781116, "waitRatioMax": 0.002145922746781116, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.02575107296137339, "writeRatioMax": 0.02575107296137339 }, { "completedParallelInputs": "6", "computeMsAvg": "708", "computeMsMax": "772", "computeRatioAvg": 0.759656652360515, "computeRatioMax": 0.8283261802575107, "endMs": "1665776565944", "id": "14", "inputStages": [ "6", "8" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "17", "readRatioAvg": 0.017167381974248927, "readRatioMax": 0.018240343347639486, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "4157", "startMs": "1665776565420", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0E_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.002145922746781116, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.006437768240343348, "writeRatioMax": 0.008583690987124463 }, { "completedParallelInputs": "1", "computeMsAvg": "601", "computeMsMax": "601", "computeRatioAvg": 0.6448497854077253, "computeRatioMax": 0.6448497854077253, "endMs": "1665776565779", "id": "15", "inputStages": [ "9", "11" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.019313304721030045, "readRatioMax": 0.019313304721030045, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "534", "startMs": "1665776565436", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.019313304721030045, "writeRatioMax": 0.019313304721030045 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.032188841201716736, "computeRatioMax": 0.032188841201716736, "endMs": "1665776566027", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665776565970", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.022532188841201718, "writeRatioMax": 0.022532188841201718 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.03969957081545064, "computeRatioMax": 0.03969957081545064, "endMs": "1665776566043", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "67", "startMs": "1665776565985", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0203862660944206, "writeRatioMax": 0.0203862660944206 }, { "completedParallelInputs": "1", "computeMsAvg": "327", "computeMsMax": "327", "computeRatioAvg": 0.35085836909871243, "computeRatioMax": 0.35085836909871243, "endMs": "1665776566214", "id": "19", "inputStages": [ "12" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "403", "startMs": "1665776566020", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$160, $280", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.001072961373390558, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.02467811158798283, "writeRatioMax": 0.02467811158798283 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.008583690987124463, "computeRatioMax": 0.017167381974248927, "endMs": "1665776566292", "id": "20", "inputStages": [ "19" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "5225", "startMs": "1665776566229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.001072961373390558, "waitRatioMax": 0.003218884120171674, "writeMsAvg": "17", "writeMsMax": "29", "writeRatioAvg": 0.018240343347639486, "writeRatioMax": 0.03111587982832618 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.0075107296137339056, "computeRatioMax": 0.012875536480686695, "endMs": "1665776566290", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "4961", "startMs": "1665776566229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.003218884120171674, "waitRatioMax": 0.00536480686695279, "writeMsAvg": "18", "writeMsMax": "30", "writeRatioAvg": 0.019313304721030045, "writeRatioMax": 0.032188841201716736 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.008583690987124463, "computeRatioMax": 0.016094420600858368, "endMs": "1665776566283", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "4423", "startMs": "1665776566229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.004291845493562232, "waitRatioMax": 0.00536480686695279, "writeMsAvg": "14", "writeMsMax": "20", "writeRatioAvg": 0.015021459227467811, "writeRatioMax": 0.02145922746781116 }, { "completedParallelInputs": "1", "computeMsAvg": "299", "computeMsMax": "299", "computeRatioAvg": 0.3208154506437768, "computeRatioMax": 0.3208154506437768, "endMs": "1665776566459", "id": "23", "inputStages": [ "21", "22", "20", "14" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "262866", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "264", "startMs": "1665776566240", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$160, $280", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130, $340 := $280, $341 := $160", "INNER HASH JOIN EACH WITH ALL ON $330 = $280" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.006437768240343348, "waitRatioMax": 0.006437768240343348, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001072961373390558, "writeRatioMax": 0.001072961373390558 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.006437768240343348, "computeRatioMax": 0.006437768240343348, "endMs": "1665776566465", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "290", "startMs": "1665776566248", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.003218884120171674, "waitRatioMax": 0.003218884120171674, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.004291845493562232, "writeRatioMax": 0.004291845493562232 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "641", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "3652" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1694", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "28090" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "28090", "transferredBytes": "0" }, "startTime": "1665776564842", "totalBytesProcessed": "176020858", "totalSlotMs": "28090" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon23941802_82c8_4c38_8b2a_b7a78f9eaf1e" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "WJoaOTjmN+NRS1yj4DCCFg==", "id": "test-project-364309:europe-west1.query11_1665776568", "jobReference": { "jobId": "query11_1665776568", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776568?location=europe-west1", "statistics": { "creationTime": "1665776568696", "endTime": "1665776570531", "finalExecutionDurationMs": "1594", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1685" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.01338432122370937, "computeRatioMax": 0.01338432122370937, "endMs": "1665776568911", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.010516252390057362, "readRatioMax": 0.010516252390057362, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665776568862", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01338432122370937, "writeRatioMax": 0.01338432122370937 }, { "completedParallelInputs": "1", "computeMsAvg": "225", "computeMsMax": "225", "computeRatioAvg": 0.21510516252390058, "computeRatioMax": 0.21510516252390058, "endMs": "1665776569074", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.014340344168260038, "readRatioMax": 0.014340344168260038, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "255", "startMs": "1665776568894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.016252390057361378, "writeRatioMax": 0.016252390057361378 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.006692160611854685, "computeRatioMax": 0.006692160611854685, "endMs": "1665776568945", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.010516252390057362, "readRatioMax": 0.010516252390057362, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776568910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0057361376673040155, "writeRatioMax": 0.0057361376673040155 }, { "completedParallelInputs": "1", "computeMsAvg": "252", "computeMsMax": "252", "computeRatioAvg": 0.24091778202676864, "computeRatioMax": 0.24091778202676864, "endMs": "1665776569273", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.01338432122370937, "readRatioMax": 0.01338432122370937, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "510", "startMs": "1665776569056", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "120", "waitMsMax": "120", "waitRatioAvg": 0.1147227533460803, "waitRatioMax": 0.1147227533460803, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.01338432122370937, "writeRatioMax": 0.01338432122370937 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.009560229445506692, "computeRatioMax": 0.009560229445506692, "endMs": "1665776569101", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.0057361376673040155, "readRatioMax": 0.0057361376673040155, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776569059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "106", "waitMsMax": "106", "waitRatioAvg": 0.10133843212237094, "waitRatioMax": 0.10133843212237094, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.0124282982791587, "writeRatioMax": 0.0124282982791587 }, { "completedParallelInputs": "1", "computeMsAvg": "189", "computeMsMax": "189", "computeRatioAvg": 0.1806883365200765, "computeRatioMax": 0.1806883365200765, "endMs": "1665776569222", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.016252390057361378, "readRatioMax": 0.016252390057361378, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "238", "startMs": "1665776569058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "77", "waitMsMax": "77", "waitRatioAvg": 0.07361376673040153, "waitRatioMax": 0.07361376673040153, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.020076481835564052, "writeRatioMax": 0.020076481835564052 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.0057361376673040155, "computeRatioMax": 0.0057361376673040155, "endMs": "1665776569094", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004780114722753346, "readRatioMax": 0.004780114722753346, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776569059", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "62", "waitMsMax": "62", "waitRatioAvg": 0.05927342256214149, "waitRatioMax": 0.05927342256214149, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.011472275334608031, "writeRatioMax": 0.011472275334608031 }, { "completedParallelInputs": "1", "computeMsAvg": "279", "computeMsMax": "279", "computeRatioAvg": 0.26673040152963673, "computeRatioMax": 0.26673040152963673, "endMs": "1665776569284", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "35", "readMsMax": "35", "readRatioAvg": 0.033460803059273424, "readRatioMax": 0.033460803059273424, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "478", "startMs": "1665776569058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "33", "waitMsMax": "33", "waitRatioAvg": 0.03154875717017208, "waitRatioMax": 0.03154875717017208, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.020076481835564052, "writeRatioMax": 0.020076481835564052 }, { "completedParallelInputs": "6", "computeMsAvg": "760", "computeMsMax": "1046", "computeRatioAvg": 0.7265774378585086, "computeRatioMax": 1, "endMs": "1665776569694", "id": "12", "inputStages": [ "0", "2" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "27", "readRatioAvg": 0.019120458891013385, "readRatioMax": 0.02581261950286807, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "5173", "startMs": "1665776569084", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019120458891013384, "waitRatioMax": 0.0019120458891013384, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.006692160611854685, "writeRatioMax": 0.008604206500956023 }, { "completedParallelInputs": "6", "computeMsAvg": "698", "computeMsMax": "903", "computeRatioAvg": 0.6673040152963671, "computeRatioMax": 0.8632887189292543, "endMs": "1665776569747", "id": "13", "inputStages": [ "8", "6" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "22", "readRatioAvg": 0.016252390057361378, "readRatioMax": 0.021032504780114723, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "4502", "startMs": "1665776569248", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0D_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "8", "writeMsMax": "13", "writeRatioAvg": 0.0076481835564053535, "writeRatioMax": 0.0124282982791587 }, { "completedParallelInputs": "1", "computeMsAvg": "761", "computeMsMax": "761", "computeRatioAvg": 0.7275334608030593, "computeRatioMax": 0.7275334608030593, "endMs": "1665776569731", "id": "14", "inputStages": [ "5", "3" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.019120458891013385, "readRatioMax": 0.019120458891013385, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "668", "startMs": "1665776569318", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0E_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.018164435946462717, "writeRatioMax": 0.018164435946462717 }, { "completedParallelInputs": "1", "computeMsAvg": "520", "computeMsMax": "520", "computeRatioAvg": 0.497131931166348, "computeRatioMax": 0.497131931166348, "endMs": "1665776569702", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.020076481835564052, "readRatioMax": 0.020076481835564052, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "525", "startMs": "1665776569337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.018164435946462717, "writeRatioMax": 0.018164435946462717 }, { "completedParallelInputs": "1", "computeMsAvg": "37", "computeMsMax": "37", "computeRatioAvg": 0.03537284894837476, "computeRatioMax": 0.03537284894837476, "endMs": "1665776569877", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665776569827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.02198852772466539, "writeRatioMax": 0.02198852772466539 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.02390057361376673, "computeRatioMax": 0.02390057361376673, "endMs": "1665776569890", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "91", "startMs": "1665776569841", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0E_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.017208413001912046, "writeRatioMax": 0.017208413001912046 }, { "completedParallelInputs": "1", "computeMsAvg": "383", "computeMsMax": "383", "computeRatioAvg": 0.36615678776290633, "computeRatioMax": 0.36615678776290633, "endMs": "1665776570080", "id": "19", "inputStages": [ "12" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "301", "startMs": "1665776569870", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$160, $280", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.021032504780114723, "writeRatioMax": 0.021032504780114723 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.0076481835564053535, "computeRatioMax": 0.01338432122370937, "endMs": "1665776570191", "id": "20", "inputStages": [ "19" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "5958", "startMs": "1665776570111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0019120458891013384, "waitRatioMax": 0.0038240917782026767, "writeMsAvg": "34", "writeMsMax": "56", "writeRatioAvg": 0.032504780114722756, "writeRatioMax": 0.05353728489483748 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.006692160611854685, "computeRatioMax": 0.014340344168260038, "endMs": "1665776570191", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "5793", "startMs": "1665776570112", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.004780114722753346, "waitRatioMax": 0.0057361376673040155, "writeMsAvg": "33", "writeMsMax": "54", "writeRatioAvg": 0.03154875717017208, "writeRatioMax": 0.05162523900573614 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.0076481835564053535, "computeRatioMax": 0.01338432122370937, "endMs": "1665776570191", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "5160", "startMs": "1665776570112", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "6", "waitMsMax": "14", "waitRatioAvg": 0.0057361376673040155, "waitRatioMax": 0.01338432122370937, "writeMsAvg": "16", "writeMsMax": "43", "writeRatioAvg": 0.015296367112810707, "writeRatioMax": 0.04110898661567878 }, { "completedParallelInputs": "1", "computeMsAvg": "528", "computeMsMax": "528", "computeRatioAvg": 0.5047801147227533, "computeRatioMax": 0.5047801147227533, "endMs": "1665776570398", "id": "23", "inputStages": [ "13", "21", "22", "20" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "262866", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "423", "startMs": "1665776570125", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$160, $280", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130, $340 := $280, $341 := $160", "INNER HASH JOIN EACH WITH ALL ON $330 = $280" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.0124282982791587, "waitRatioMax": 0.0124282982791587, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0028680688336520078, "writeRatioMax": 0.0028680688336520078 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.0038240917782026767, "computeRatioMax": 0.0038240917782026767, "endMs": "1665776570421", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "382", "startMs": "1665776570141", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009560229445506692, "waitRatioMax": 0.0009560229445506692, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.0019120458891013384, "writeRatioMax": 0.0019120458891013384 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "610", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "4319" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1719", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "31839" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "31839", "transferredBytes": "0" }, "startTime": "1665776568754", "totalBytesProcessed": "176020858", "totalSlotMs": "31839" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8ff3737e_6d9a_4c23_a032_bd399ebb0946" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "YzAQChmgY5s82UcuvF6dDQ==", "id": "test-project-364309:europe-west1.query11_1665776571", "jobReference": { "jobId": "query11_1665776571", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776571?location=europe-west1", "statistics": { "creationTime": "1665776572442", "endTime": "1665776574266", "finalExecutionDurationMs": "1599", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1676" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00984251968503937, "computeRatioMax": 0.00984251968503937, "endMs": "1665776572640", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.006889763779527559, "readRatioMax": 0.006889763779527559, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776572597", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000984251968503937, "waitRatioMax": 0.000984251968503937, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.014763779527559055, "writeRatioMax": 0.014763779527559055 }, { "completedParallelInputs": "1", "computeMsAvg": "186", "computeMsMax": "186", "computeRatioAvg": 0.1830708661417323, "computeRatioMax": 0.1830708661417323, "endMs": "1665776572809", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.014763779527559055, "readRatioMax": 0.014763779527559055, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "384", "startMs": "1665776572629", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000984251968503937, "waitRatioMax": 0.000984251968503937, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.011811023622047244, "writeRatioMax": 0.011811023622047244 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00984251968503937, "computeRatioMax": 0.00984251968503937, "endMs": "1665776572789", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.003937007874015748, "readRatioMax": 0.003937007874015748, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665776572754", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "111", "waitMsMax": "111", "waitRatioAvg": 0.10925196850393701, "waitRatioMax": 0.10925196850393701, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.013779527559055118, "writeRatioMax": 0.013779527559055118 }, { "completedParallelInputs": "1", "computeMsAvg": "218", "computeMsMax": "218", "computeRatioAvg": 0.21456692913385828, "computeRatioMax": 0.21456692913385828, "endMs": "1665776572912", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.010826771653543307, "readRatioMax": 0.010826771653543307, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "268", "startMs": "1665776572755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "80", "waitMsMax": "80", "waitRatioAvg": 0.07874015748031496, "waitRatioMax": 0.07874015748031496, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.013779527559055118, "writeRatioMax": 0.013779527559055118 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.007874015748031496, "computeRatioMax": 0.007874015748031496, "endMs": "1665776572795", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.00984251968503937, "readRatioMax": 0.00984251968503937, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776572756", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "67", "waitMsMax": "67", "waitRatioAvg": 0.06594488188976377, "waitRatioMax": 0.06594488188976377, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.011811023622047244, "writeRatioMax": 0.011811023622047244 }, { "completedParallelInputs": "1", "computeMsAvg": "293", "computeMsMax": "293", "computeRatioAvg": 0.28838582677165353, "computeRatioMax": 0.28838582677165353, "endMs": "1665776572964", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.012795275590551181, "readRatioMax": 0.012795275590551181, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "435", "startMs": "1665776572755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "37", "waitMsMax": "37", "waitRatioAvg": 0.03641732283464567, "waitRatioMax": 0.03641732283464567, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.013779527559055118, "writeRatioMax": 0.013779527559055118 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.008858267716535433, "computeRatioMax": 0.008858267716535433, "endMs": "1665776572793", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005905511811023622, "readRatioMax": 0.005905511811023622, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776572756", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "21", "waitMsMax": "21", "waitRatioAvg": 0.02066929133858268, "waitRatioMax": 0.02066929133858268, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.012795275590551181, "writeRatioMax": 0.012795275590551181 }, { "completedParallelInputs": "1", "computeMsAvg": "365", "computeMsMax": "365", "computeRatioAvg": 0.359251968503937, "computeRatioMax": 0.359251968503937, "endMs": "1665776573070", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.014763779527559055, "readRatioMax": 0.014763779527559055, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "451", "startMs": "1665776572769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000984251968503937, "waitRatioMax": 0.000984251968503937, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.02066929133858268, "writeRatioMax": 0.02066929133858268 }, { "completedParallelInputs": "6", "computeMsAvg": "763", "computeMsMax": "1016", "computeRatioAvg": 0.7509842519685039, "computeRatioMax": 1, "endMs": "1665776573385", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "30", "readRatioAvg": 0.01968503937007874, "readRatioMax": 0.02952755905511811, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "4727", "startMs": "1665776572831", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000984251968503937, "waitRatioMax": 0.001968503937007874, "writeMsAvg": "8", "writeMsMax": "12", "writeRatioAvg": 0.007874015748031496, "writeRatioMax": 0.011811023622047244 }, { "completedParallelInputs": "1", "computeMsAvg": "574", "computeMsMax": "574", "computeRatioAvg": 0.5649606299212598, "computeRatioMax": 0.5649606299212598, "endMs": "1665776573337", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.01968503937007874, "readRatioMax": 0.01968503937007874, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "719", "startMs": "1665776572929", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0D_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001968503937007874, "waitRatioMax": 0.001968503937007874, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.02066929133858268, "writeRatioMax": 0.02066929133858268 }, { "completedParallelInputs": "6", "computeMsAvg": "687", "computeMsMax": "852", "computeRatioAvg": 0.6761811023622047, "computeRatioMax": 0.8385826771653543, "endMs": "1665776573469", "id": "14", "inputStages": [ "8", "6" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "21", "readRatioAvg": 0.017716535433070866, "readRatioMax": 0.02066929133858268, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "4311", "startMs": "1665776573029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0E_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001968503937007874, "waitRatioMax": 0.001968503937007874, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.006889763779527559, "writeRatioMax": 0.007874015748031496 }, { "completedParallelInputs": "1", "computeMsAvg": "555", "computeMsMax": "555", "computeRatioAvg": 0.5462598425196851, "computeRatioMax": 0.5462598425196851, "endMs": "1665776573510", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "34", "readMsMax": "34", "readRatioAvg": 0.03346456692913386, "readRatioMax": 0.03346456692913386, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "718", "startMs": "1665776573110", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001968503937007874, "waitRatioMax": 0.001968503937007874, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.027559055118110236, "writeRatioMax": 0.027559055118110236 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.03051181102362205, "computeRatioMax": 0.03051181102362205, "endMs": "1665776573602", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665776573559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001968503937007874, "waitRatioMax": 0.001968503937007874, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.018700787401574805, "writeRatioMax": 0.018700787401574805 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.03248031496062992, "computeRatioMax": 0.03248031496062992, "endMs": "1665776573611", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776573572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000984251968503937, "waitRatioMax": 0.000984251968503937, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.018700787401574805, "writeRatioMax": 0.018700787401574805 }, { "completedParallelInputs": "1", "computeMsAvg": "233", "computeMsMax": "233", "computeRatioAvg": 0.22933070866141733, "computeRatioMax": 0.22933070866141733, "endMs": "1665776573752", "id": "19", "inputStages": [ "12" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "241", "startMs": "1665776573605", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$160, $280", "TO __stage13_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000984251968503937, "waitRatioMax": 0.000984251968503937, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.018700787401574805, "writeRatioMax": 0.018700787401574805 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.007874015748031496, "computeRatioMax": 0.013779527559055118, "endMs": "1665776573817", "id": "20", "inputStages": [ "19" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "6241", "startMs": "1665776573761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.001968503937007874, "waitRatioMax": 0.003937007874015748, "writeMsAvg": "19", "writeMsMax": "30", "writeRatioAvg": 0.018700787401574805, "writeRatioMax": 0.02952755905511811 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.006889763779527559, "computeRatioMax": 0.011811023622047244, "endMs": "1665776573816", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "4694", "startMs": "1665776573761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "7", "waitRatioAvg": 0.003937007874015748, "waitRatioMax": 0.006889763779527559, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.014763779527559055, "writeRatioMax": 0.028543307086614175 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.006889763779527559, "computeRatioMax": 0.015748031496062992, "endMs": "1665776573817", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "4703", "startMs": "1665776573761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.005905511811023622, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "12", "writeMsMax": "22", "writeRatioAvg": 0.011811023622047244, "writeRatioMax": 0.021653543307086614 }, { "completedParallelInputs": "1", "computeMsAvg": "378", "computeMsMax": "378", "computeRatioAvg": 0.3720472440944882, "computeRatioMax": 0.3720472440944882, "endMs": "1665776574050", "id": "23", "inputStages": [ "20", "14", "22", "21" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "262866", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "595", "startMs": "1665776573773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$160, $280", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130, $340 := $280, $341 := $160", "INNER HASH JOIN EACH WITH ALL ON $330 = $280" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.010826771653543307, "waitRatioMax": 0.010826771653543307, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.000984251968503937, "writeRatioMax": 0.000984251968503937 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.003937007874015748, "computeRatioMax": 0.003937007874015748, "endMs": "1665776574100", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "311", "startMs": "1665776573783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001968503937007874, "waitRatioMax": 0.001968503937007874, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.003937007874015748, "writeRatioMax": 0.003937007874015748 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "13", "completedUnits": "8", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "4537" }, { "activeUnits": "3", "completedUnits": "327", "elapsedMs": "1724", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "31041" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "31041", "transferredBytes": "0" }, "startTime": "1665776572485", "totalBytesProcessed": "176020858", "totalSlotMs": "31041" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonb4322c56_1803_46ca_8251_c8ef6d671179" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "hQmO6eMm4Z8FgtJ9M9oa8A==", "id": "test-project-364309:europe-west1.query11_1665776822", "jobReference": { "jobId": "query11_1665776822", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776822?location=europe-west1", "statistics": { "creationTime": "1665776823426", "endTime": "1665776825222", "finalExecutionDurationMs": "1600", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1670" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.00861244019138756, "computeRatioMax": 0.00861244019138756, "endMs": "1665776823617", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005741626794258373, "readRatioMax": 0.005741626794258373, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776823575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009569377990430622, "waitRatioMax": 0.0009569377990430622, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.015311004784688996, "writeRatioMax": 0.015311004784688996 }, { "completedParallelInputs": "1", "computeMsAvg": "187", "computeMsMax": "187", "computeRatioAvg": 0.17894736842105263, "computeRatioMax": 0.17894736842105263, "endMs": "1665776823800", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.016267942583732056, "readRatioMax": 0.016267942583732056, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "244", "startMs": "1665776823605", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.004784688995215311, "writeMsAvg": "84", "writeMsMax": "84", "writeRatioAvg": 0.08038277511961722, "writeRatioMax": 0.08038277511961722 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.012440191387559809, "computeRatioMax": 0.012440191387559809, "endMs": "1665776823662", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.009569377990430622, "readRatioMax": 0.009569377990430622, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776823620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009569377990430622, "waitRatioMax": 0.0009569377990430622, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.009569377990430622, "writeRatioMax": 0.009569377990430622 }, { "completedParallelInputs": "1", "computeMsAvg": "248", "computeMsMax": "248", "computeRatioAvg": 0.23732057416267943, "computeRatioMax": 0.23732057416267943, "endMs": "1665776823880", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.01722488038277512, "readRatioMax": 0.01722488038277512, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "246", "startMs": "1665776823651", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009569377990430622, "waitRatioMax": 0.0009569377990430622, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.016267942583732056, "writeRatioMax": 0.016267942583732056 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.007655502392344498, "computeRatioMax": 0.007655502392344498, "endMs": "1665776823710", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005741626794258373, "readRatioMax": 0.005741626794258373, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776823669", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019138755980861245, "waitRatioMax": 0.0019138755980861245, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.014354066985645933, "writeRatioMax": 0.014354066985645933 }, { "completedParallelInputs": "1", "computeMsAvg": "193", "computeMsMax": "193", "computeRatioAvg": 0.184688995215311, "computeRatioMax": 0.184688995215311, "endMs": "1665776823871", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.015311004784688996, "readRatioMax": 0.015311004784688996, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "189", "startMs": "1665776823706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009569377990430622, "waitRatioMax": 0.0009569377990430622, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.01722488038277512, "writeRatioMax": 0.01722488038277512 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.011483253588516746, "computeRatioMax": 0.011483253588516746, "endMs": "1665776823759", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.00861244019138756, "readRatioMax": 0.00861244019138756, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776823723", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019138755980861245, "waitRatioMax": 0.0019138755980861245, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.00861244019138756, "writeRatioMax": 0.00861244019138756 }, { "completedParallelInputs": "1", "computeMsAvg": "202", "computeMsMax": "202", "computeRatioAvg": 0.19330143540669856, "computeRatioMax": 0.19330143540669856, "endMs": "1665776823944", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.016267942583732056, "readRatioMax": 0.016267942583732056, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "237", "startMs": "1665776823754", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009569377990430622, "waitRatioMax": 0.0009569377990430622, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.016267942583732056, "writeRatioMax": 0.016267942583732056 }, { "completedParallelInputs": "6", "computeMsAvg": "899", "computeMsMax": "1045", "computeRatioAvg": 0.8602870813397129, "computeRatioMax": 1, "endMs": "1665776824504", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "29", "readMsMax": "63", "readRatioAvg": 0.027751196172248804, "readRatioMax": 0.06028708133971292, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "5179", "startMs": "1665776823811", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019138755980861245, "waitRatioMax": 0.0019138755980861245, "writeMsAvg": "10", "writeMsMax": "13", "writeRatioAvg": 0.009569377990430622, "writeRatioMax": 0.012440191387559809 }, { "completedParallelInputs": "6", "computeMsAvg": "795", "computeMsMax": "1009", "computeRatioAvg": 0.7607655502392344, "computeRatioMax": 0.9655502392344497, "endMs": "1665776824444", "id": "13", "inputStages": [ "8", "6" ], "name": "S0D: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.015311004784688996, "readRatioMax": 0.01818181818181818, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "3872", "startMs": "1665776823901", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0D_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019138755980861245, "waitRatioMax": 0.0019138755980861245, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.0066985645933014355, "writeRatioMax": 0.00861244019138756 }, { "completedParallelInputs": "1", "computeMsAvg": "599", "computeMsMax": "599", "computeRatioAvg": 0.5732057416267943, "computeRatioMax": 0.5732057416267943, "endMs": "1665776824345", "id": "14", "inputStages": [ "5", "3" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.021052631578947368, "readRatioMax": 0.021052631578947368, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "582", "startMs": "1665776823920", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0E_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019138755980861245, "waitRatioMax": 0.0019138755980861245, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.02200956937799043, "writeRatioMax": 0.02200956937799043 }, { "completedParallelInputs": "1", "computeMsAvg": "637", "computeMsMax": "637", "computeRatioAvg": 0.6095693779904306, "computeRatioMax": 0.6095693779904306, "endMs": "1665776824368", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.021052631578947368, "readRatioMax": 0.021052631578947368, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "537", "startMs": "1665776823964", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009569377990430622, "waitRatioMax": 0.0009569377990430622, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.019138755980861243, "writeRatioMax": 0.019138755980861243 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.031578947368421054, "computeRatioMax": 0.031578947368421054, "endMs": "1665776824581", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776824532", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0009569377990430622, "waitRatioMax": 0.0009569377990430622, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.02200956937799043, "writeRatioMax": 0.02200956937799043 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.023923444976076555, "computeRatioMax": 0.023923444976076555, "endMs": "1665776824600", "id": "17", "inputStages": [ "14" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776824549", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0E_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019138755980861245, "waitRatioMax": 0.0019138755980861245, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.020095693779904306, "writeRatioMax": 0.020095693779904306 }, { "completedParallelInputs": "1", "computeMsAvg": "369", "computeMsMax": "369", "computeRatioAvg": 0.35311004784688993, "computeRatioMax": 0.35311004784688993, "endMs": "1665776824762", "id": "18", "inputStages": [ "13" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "232", "startMs": "1665776824564", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$130, $330, $331, $332, $333", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0019138755980861245, "waitRatioMax": 0.0019138755980861245, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.019138755980861243, "writeRatioMax": 0.019138755980861243 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.007655502392344498, "computeRatioMax": 0.013397129186602871, "endMs": "1665776824836", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "3898", "startMs": "1665776824776", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0019138755980861245, "waitRatioMax": 0.005741626794258373, "writeMsAvg": "22", "writeMsMax": "31", "writeRatioAvg": 0.021052631578947368, "writeRatioMax": 0.02966507177033493 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.007655502392344498, "computeRatioMax": 0.01818181818181818, "endMs": "1665776824840", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "3634", "startMs": "1665776824776", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.005741626794258373, "waitRatioMax": 0.0066985645933014355, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.015311004784688996, "writeRatioMax": 0.028708133971291867 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.007655502392344498, "computeRatioMax": 0.016267942583732056, "endMs": "1665776824844", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3888", "startMs": "1665776824777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.0066985645933014355, "waitRatioMax": 0.007655502392344498, "writeMsAvg": "17", "writeMsMax": "40", "writeRatioAvg": 0.016267942583732056, "writeRatioMax": 0.03827751196172249 }, { "completedParallelInputs": "1", "computeMsAvg": "266", "computeMsMax": "266", "computeRatioAvg": 0.2545454545454545, "computeRatioMax": 0.2545454545454545, "endMs": "1665776825021", "id": "23", "inputStages": [ "12", "21", "20", "22" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "259", "startMs": "1665776824789", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $330, $331, $332, $333", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$340 := $280, $341 := $160, $342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130", "INNER HASH JOIN EACH WITH ALL ON $280 = $330" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "13", "waitMsMax": "13", "waitRatioAvg": 0.012440191387559809, "waitRatioMax": 0.012440191387559809, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0009569377990430622, "writeRatioMax": 0.0009569377990430622 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.005741626794258373, "computeRatioMax": 0.005741626794258373, "endMs": "1665776825071", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "208", "startMs": "1665776824800", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0028708133971291866, "waitRatioMax": 0.0028708133971291866, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.003827751196172249, "writeRatioMax": 0.003827751196172249 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "602", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "3057" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1702", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "24386" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "24386", "transferredBytes": "0" }, "startTime": "1665776823474", "totalBytesProcessed": "176020858", "totalSlotMs": "24386" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0bde8c77_b332_4a01_bd45_2d16bdf15ddb" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "7xBc2QCblt8gpxjqg3eAPg==", "id": "test-project-364309:europe-west1.query11_1665776826", "jobReference": { "jobId": "query11_1665776826", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776826?location=europe-west1", "statistics": { "creationTime": "1665776827313", "endTime": "1665776829068", "finalExecutionDurationMs": "1547", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1665" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.012987012987012988, "computeRatioMax": 0.012987012987012988, "endMs": "1665776827513", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.007992007992007992, "readRatioMax": 0.007992007992007992, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776827471", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001998001998001998, "waitRatioMax": 0.001998001998001998, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.012987012987012988, "writeRatioMax": 0.012987012987012988 }, { "completedParallelInputs": "1", "computeMsAvg": "256", "computeMsMax": "256", "computeRatioAvg": 0.25574425574425574, "computeRatioMax": 0.25574425574425574, "endMs": "1665776827698", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.012987012987012988, "readRatioMax": 0.012987012987012988, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "263", "startMs": "1665776827510", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000999000999000999, "waitRatioMax": 0.000999000999000999, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.012987012987012988, "writeRatioMax": 0.012987012987012988 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00999000999000999, "computeRatioMax": 0.00999000999000999, "endMs": "1665776827673", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.004995004995004995, "readRatioMax": 0.004995004995004995, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776827621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "91", "waitMsMax": "91", "waitRatioAvg": 0.09090909090909091, "waitRatioMax": 0.09090909090909091, "writeMsAvg": "40", "writeMsMax": "40", "writeRatioAvg": 0.03996003996003996, "writeRatioMax": 0.03996003996003996 }, { "completedParallelInputs": "1", "computeMsAvg": "290", "computeMsMax": "290", "computeRatioAvg": 0.2897102897102897, "computeRatioMax": 0.2897102897102897, "endMs": "1665776827829", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.017982017982017984, "readRatioMax": 0.017982017982017984, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "269", "startMs": "1665776827621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "56", "waitMsMax": "56", "waitRatioAvg": 0.055944055944055944, "waitRatioMax": 0.055944055944055944, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.015984015984015984, "writeRatioMax": 0.015984015984015984 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01098901098901099, "computeRatioMax": 0.01098901098901099, "endMs": "1665776827666", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.006993006993006993, "readRatioMax": 0.006993006993006993, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776827622", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "38", "waitMsMax": "38", "waitRatioAvg": 0.03796203796203796, "waitRatioMax": 0.03796203796203796, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.015984015984015984, "writeRatioMax": 0.015984015984015984 }, { "completedParallelInputs": "1", "computeMsAvg": "169", "computeMsMax": "169", "computeRatioAvg": 0.16883116883116883, "computeRatioMax": 0.16883116883116883, "endMs": "1665776827839", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.01898101898101898, "readRatioMax": 0.01898101898101898, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "163", "startMs": "1665776827677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001998001998001998, "waitRatioMax": 0.001998001998001998, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.012987012987012988, "writeRatioMax": 0.012987012987012988 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.011988011988011988, "computeRatioMax": 0.011988011988011988, "endMs": "1665776827740", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.012987012987012988, "readRatioMax": 0.012987012987012988, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776827699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001998001998001998, "waitRatioMax": 0.001998001998001998, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.007992007992007992, "writeRatioMax": 0.007992007992007992 }, { "completedParallelInputs": "1", "computeMsAvg": "164", "computeMsMax": "164", "computeRatioAvg": 0.16383616383616384, "computeRatioMax": 0.16383616383616384, "endMs": "1665776827869", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.014985014985014986, "readRatioMax": 0.014985014985014986, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "169", "startMs": "1665776827738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000999000999000999, "waitRatioMax": 0.000999000999000999, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.013986013986013986, "writeRatioMax": 0.013986013986013986 }, { "completedParallelInputs": "6", "computeMsAvg": "758", "computeMsMax": "1001", "computeRatioAvg": 0.7572427572427572, "computeRatioMax": 1, "endMs": "1665776828258", "id": "12", "inputStages": [ "0", "2" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.015984015984015984, "readRatioMax": 0.01998001998001998, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "3803", "startMs": "1665776827745", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000999000999000999, "waitRatioMax": 0.001998001998001998, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.007992007992007992 }, { "completedParallelInputs": "1", "computeMsAvg": "792", "computeMsMax": "792", "computeRatioAvg": 0.7912087912087912, "computeRatioMax": 0.7912087912087912, "endMs": "1665776828399", "id": "13", "inputStages": [ "3", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.030969030969030968, "readRatioMax": 0.030969030969030968, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "692", "startMs": "1665776827895", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0D_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000999000999000999, "waitRatioMax": 0.000999000999000999, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.023976023976023976, "writeRatioMax": 0.023976023976023976 }, { "completedParallelInputs": "6", "computeMsAvg": "762", "computeMsMax": "977", "computeRatioAvg": 0.7612387612387612, "computeRatioMax": 0.9760239760239761, "endMs": "1665776828430", "id": "14", "inputStages": [ "6", "8" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "23", "readRatioAvg": 0.017982017982017984, "readRatioMax": 0.022977022977022976, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "3813", "startMs": "1665776827901", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0E_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000999000999000999, "waitRatioMax": 0.001998001998001998, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.006993006993006993, "writeRatioMax": 0.00999000999000999 }, { "completedParallelInputs": "1", "computeMsAvg": "721", "computeMsMax": "721", "computeRatioAvg": 0.7202797202797203, "computeRatioMax": 0.7202797202797203, "endMs": "1665776828339", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.022977022977022976, "readRatioMax": 0.022977022977022976, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "611", "startMs": "1665776827921", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001998001998001998, "waitRatioMax": 0.001998001998001998, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.02197802197802198, "writeRatioMax": 0.02197802197802198 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.03496503496503497, "computeRatioMax": 0.03496503496503497, "endMs": "1665776828536", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776828489", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000999000999000999, "waitRatioMax": 0.000999000999000999, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.02197802197802198, "writeRatioMax": 0.02197802197802198 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.03596403596403597, "computeRatioMax": 0.03596403596403597, "endMs": "1665776828565", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "68", "startMs": "1665776828509", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000999000999000999, "waitRatioMax": 0.000999000999000999, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.02197802197802198, "writeRatioMax": 0.02197802197802198 }, { "completedParallelInputs": "1", "computeMsAvg": "299", "computeMsMax": "299", "computeRatioAvg": 0.2987012987012987, "computeRatioMax": 0.2987012987012987, "endMs": "1665776828716", "id": "18", "inputStages": [ "14" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "265", "startMs": "1665776828530", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$130, $330, $331, $332, $333", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001998001998001998, "waitRatioMax": 0.001998001998001998, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.022977022977022976, "writeRatioMax": 0.022977022977022976 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.007992007992007992, "computeRatioMax": 0.01898101898101898, "endMs": "1665776828776", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "3558", "startMs": "1665776828723", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.002997002997002997, "waitRatioMax": 0.004995004995004995, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.014985014985014986, "writeRatioMax": 0.02097902097902098 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.007992007992007992, "computeRatioMax": 0.013986013986013986, "endMs": "1665776828776", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "3370", "startMs": "1665776828724", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.005994005994005994, "waitRatioMax": 0.007992007992007992, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.013986013986013986, "writeRatioMax": 0.02097902097902098 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.007992007992007992, "computeRatioMax": 0.014985014985014986, "endMs": "1665776828779", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "2905", "startMs": "1665776828726", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "7", "waitMsMax": "8", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.007992007992007992, "writeMsAvg": "8", "writeMsMax": "18", "writeRatioAvg": 0.007992007992007992, "writeRatioMax": 0.017982017982017984 }, { "completedParallelInputs": "1", "computeMsAvg": "270", "computeMsMax": "270", "computeRatioAvg": 0.26973026973026976, "computeRatioMax": 0.26973026973026976, "endMs": "1665776828951", "id": "23", "inputStages": [ "20", "21", "22", "12" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "243", "startMs": "1665776828739", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $330, $331, $332, $333", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$340 := $280, $341 := $160, $342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130", "INNER HASH JOIN EACH WITH ALL ON $280 = $330" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.008991008991008992, "waitRatioMax": 0.008991008991008992, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.000999000999000999, "writeRatioMax": 0.000999000999000999 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.003996003996003996, "computeRatioMax": 0.003996003996003996, "endMs": "1665776828968", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "156", "startMs": "1665776828747", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.002997002997002997, "waitRatioMax": 0.002997002997002997, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.002997002997002997, "writeRatioMax": 0.002997002997002997 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "616", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "3358" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1668", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "22063" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "22063", "transferredBytes": "0" }, "startTime": "1665776827356", "totalBytesProcessed": "176020858", "totalSlotMs": "22063" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9264007c_738b_4bc6_b80f_d8c7dd2d86e4" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "XFxMSxw38j7ikwIcI/jfZg==", "id": "test-project-364309:europe-west1.query11_1665776830", "jobReference": { "jobId": "query11_1665776830", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776830?location=europe-west1", "statistics": { "creationTime": "1665776831223", "endTime": "1665776832900", "finalExecutionDurationMs": "1467", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1656" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.009240246406570842, "computeRatioMax": 0.009240246406570842, "endMs": "1665776831415", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.006160164271047228, "readRatioMax": 0.006160164271047228, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776831376", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.013347022587268994, "writeRatioMax": 0.013347022587268994 }, { "completedParallelInputs": "1", "computeMsAvg": "233", "computeMsMax": "233", "computeRatioAvg": 0.23921971252566734, "computeRatioMax": 0.23921971252566734, "endMs": "1665776831565", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.013347022587268994, "readRatioMax": 0.013347022587268994, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "204", "startMs": "1665776831404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.013347022587268994, "writeRatioMax": 0.013347022587268994 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.014373716632443531, "computeRatioMax": 0.014373716632443531, "endMs": "1665776831462", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007186858316221766, "readRatioMax": 0.007186858316221766, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776831421", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.014373716632443531, "writeRatioMax": 0.014373716632443531 }, { "completedParallelInputs": "1", "computeMsAvg": "261", "computeMsMax": "261", "computeRatioAvg": 0.2679671457905544, "computeRatioMax": 0.2679671457905544, "endMs": "1665776831659", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.014373716632443531, "readRatioMax": 0.014373716632443531, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "248", "startMs": "1665776831456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.01642710472279261, "writeRatioMax": 0.01642710472279261 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.006160164271047228, "computeRatioMax": 0.006160164271047228, "endMs": "1665776831509", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00513347022587269, "readRatioMax": 0.00513347022587269, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776831471", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002053388090349076, "waitRatioMax": 0.002053388090349076, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.017453798767967144, "writeRatioMax": 0.017453798767967144 }, { "completedParallelInputs": "1", "computeMsAvg": "201", "computeMsMax": "201", "computeRatioAvg": 0.20636550308008214, "computeRatioMax": 0.20636550308008214, "endMs": "1665776831723", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.023613963039014373, "readRatioMax": 0.023613963039014373, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "225", "startMs": "1665776831499", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.02566735112936345, "writeRatioMax": 0.02566735112936345 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01026694045174538, "computeRatioMax": 0.01026694045174538, "endMs": "1665776831545", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.007186858316221766, "readRatioMax": 0.007186858316221766, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "18", "startMs": "1665776831515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.015400410677618069, "writeRatioMax": 0.015400410677618069 }, { "completedParallelInputs": "1", "computeMsAvg": "212", "computeMsMax": "212", "computeRatioAvg": 0.21765913757700206, "computeRatioMax": 0.21765913757700206, "endMs": "1665776831765", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.015400410677618069, "readRatioMax": 0.015400410677618069, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "237", "startMs": "1665776831544", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002053388090349076, "waitRatioMax": 0.002053388090349076, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.02053388090349076, "writeRatioMax": 0.02053388090349076 }, { "completedParallelInputs": "6", "computeMsAvg": "824", "computeMsMax": "974", "computeRatioAvg": 0.8459958932238193, "computeRatioMax": 1, "endMs": "1665776832154", "id": "12", "inputStages": [ "0", "2" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "24", "readRatioAvg": 0.02053388090349076, "readRatioMax": 0.024640657084188913, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "4214", "startMs": "1665776831585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "7", "writeMsMax": "11", "writeRatioAvg": 0.007186858316221766, "writeRatioMax": 0.011293634496919919 }, { "completedParallelInputs": "1", "computeMsAvg": "550", "computeMsMax": "550", "computeRatioAvg": 0.5646817248459959, "computeRatioMax": 0.5646817248459959, "endMs": "1665776832080", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.022587268993839837, "readRatioMax": 0.022587268993839837, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "528", "startMs": "1665776831697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0D_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.023613963039014373, "writeRatioMax": 0.023613963039014373 }, { "completedParallelInputs": "6", "computeMsAvg": "767", "computeMsMax": "892", "computeRatioAvg": 0.7874743326488707, "computeRatioMax": 0.9158110882956879, "endMs": "1665776832317", "id": "14", "inputStages": [ "8", "6" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "29", "readRatioAvg": 0.02053388090349076, "readRatioMax": 0.029774127310061602, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "3961", "startMs": "1665776831741", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0E_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.008213552361396304, "writeRatioMax": 0.01026694045174538 }, { "completedParallelInputs": "1", "computeMsAvg": "585", "computeMsMax": "585", "computeRatioAvg": 0.6006160164271047, "computeRatioMax": 0.6006160164271047, "endMs": "1665776832196", "id": "15", "inputStages": [ "9", "11" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "25", "readMsMax": "25", "readRatioAvg": 0.02566735112936345, "readRatioMax": 0.02566735112936345, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "563", "startMs": "1665776831816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002053388090349076, "waitRatioMax": 0.002053388090349076, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.022587268993839837, "writeRatioMax": 0.022587268993839837 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.03696098562628337, "computeRatioMax": 0.03696098562628337, "endMs": "1665776832384", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776832340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.002053388090349076, "waitRatioMax": 0.002053388090349076, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.018480492813141684, "writeRatioMax": 0.018480492813141684 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.045174537987679675, "computeRatioMax": 0.045174537987679675, "endMs": "1665776832392", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776832354", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.018480492813141684, "writeRatioMax": 0.018480492813141684 }, { "completedParallelInputs": "1", "computeMsAvg": "243", "computeMsMax": "243", "computeRatioAvg": 0.24948665297741274, "computeRatioMax": 0.24948665297741274, "endMs": "1665776832541", "id": "18", "inputStages": [ "14" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "230", "startMs": "1665776832371", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$130, $330, $331, $332, $333", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.001026694045174538, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.021560574948665298, "writeRatioMax": 0.021560574948665298 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.008213552361396304, "computeRatioMax": 0.013347022587268994, "endMs": "1665776832605", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "3143", "startMs": "1665776832559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.001026694045174538, "waitRatioMax": 0.004106776180698152, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.015400410677618069, "writeRatioMax": 0.018480492813141684 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.008213552361396304, "computeRatioMax": 0.015400410677618069, "endMs": "1665776832621", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "2949", "startMs": "1665776832559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.004106776180698152, "waitRatioMax": 0.006160164271047228, "writeMsAvg": "26", "writeMsMax": "34", "writeRatioAvg": 0.026694045174537988, "writeRatioMax": 0.03490759753593429 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.008213552361396304, "computeRatioMax": 0.017453798767967144, "endMs": "1665776832612", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "2438", "startMs": "1665776832560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "5", "waitMsMax": "7", "waitRatioAvg": 0.00513347022587269, "waitRatioMax": 0.007186858316221766, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.015400410677618069, "writeRatioMax": 0.018480492813141684 }, { "completedParallelInputs": "1", "computeMsAvg": "307", "computeMsMax": "307", "computeRatioAvg": 0.31519507186858314, "computeRatioMax": 0.31519507186858314, "endMs": "1665776832781", "id": "23", "inputStages": [ "22", "12", "20", "21" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "261", "startMs": "1665776832569", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $330, $331, $332, $333", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$340 := $280, $341 := $160, $342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130", "INNER HASH JOIN EACH WITH ALL ON $280 = $330" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.007186858316221766, "waitRatioMax": 0.007186858316221766, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.001026694045174538, "writeRatioMax": 0.001026694045174538 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.008213552361396304, "computeRatioMax": 0.008213552361396304, "endMs": "1665776832798", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665776832576", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.004106776180698152, "waitRatioMax": 0.004106776180698152, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.00513347022587269, "writeRatioMax": 0.00513347022587269 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "600", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "2903" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1571", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "20720" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "20720", "transferredBytes": "0" }, "startTime": "1665776831276", "totalBytesProcessed": "176020858", "totalSlotMs": "20720" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf41f28e0_fe5a_4b29_bc89_21308a0de5fa" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "z8Wdf+MBH495RdUGhC3T0Q==", "id": "test-project-364309:europe-west1.query11_1665776834", "jobReference": { "jobId": "query11_1665776834", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776834?location=europe-west1", "statistics": { "creationTime": "1665776835110", "endTime": "1665776836888", "finalExecutionDurationMs": "1569", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1644" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.01488095238095238, "computeRatioMax": 0.01488095238095238, "endMs": "1665776835307", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.007936507936507936, "readRatioMax": 0.007936507936507936, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776835268", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.007936507936507936, "writeRatioMax": 0.007936507936507936 }, { "completedParallelInputs": "1", "computeMsAvg": "222", "computeMsMax": "222", "computeRatioAvg": 0.22023809523809523, "computeRatioMax": 0.22023809523809523, "endMs": "1665776835479", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.021825396825396824, "readRatioMax": 0.021825396825396824, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "239", "startMs": "1665776835295", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.017857142857142856, "writeRatioMax": 0.017857142857142856 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.011904761904761904, "computeRatioMax": 0.011904761904761904, "endMs": "1665776835341", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005952380952380952, "readRatioMax": 0.005952380952380952, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776835310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.006944444444444444, "writeRatioMax": 0.006944444444444444 }, { "completedParallelInputs": "1", "computeMsAvg": "237", "computeMsMax": "237", "computeRatioAvg": 0.23511904761904762, "computeRatioMax": 0.23511904761904762, "endMs": "1665776835479", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.012896825396825396, "readRatioMax": 0.012896825396825396, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "268", "startMs": "1665776835332", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.016865079365079364, "writeRatioMax": 0.016865079365079364 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00992063492063492, "computeRatioMax": 0.00992063492063492, "endMs": "1665776835373", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.00496031746031746, "readRatioMax": 0.00496031746031746, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776835344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.015873015873015872, "writeRatioMax": 0.015873015873015872 }, { "completedParallelInputs": "1", "computeMsAvg": "242", "computeMsMax": "242", "computeRatioAvg": 0.2400793650793651, "computeRatioMax": 0.2400793650793651, "endMs": "1665776835585", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.011904761904761904, "readRatioMax": 0.011904761904761904, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665776835369", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.013888888888888888 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.013888888888888888, "computeRatioMax": 0.013888888888888888, "endMs": "1665776835414", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.005952380952380952, "readRatioMax": 0.005952380952380952, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776835382", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.016865079365079364, "writeRatioMax": 0.016865079365079364 }, { "completedParallelInputs": "1", "computeMsAvg": "149", "computeMsMax": "149", "computeRatioAvg": 0.14781746031746032, "computeRatioMax": 0.14781746031746032, "endMs": "1665776835550", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "22", "readMsMax": "22", "readRatioAvg": 0.021825396825396824, "readRatioMax": 0.021825396825396824, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "186", "startMs": "1665776835405", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.015873015873015872, "writeRatioMax": 0.015873015873015872 }, { "completedParallelInputs": "6", "computeMsAvg": "778", "computeMsMax": "1008", "computeRatioAvg": 0.7718253968253969, "computeRatioMax": 1, "endMs": "1665776836110", "id": "12", "inputStages": [ "0", "2" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "20", "readRatioAvg": 0.017857142857142856, "readRatioMax": 0.01984126984126984, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "4152", "startMs": "1665776835529", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.006944444444444444, "writeRatioMax": 0.007936507936507936 }, { "completedParallelInputs": "1", "computeMsAvg": "518", "computeMsMax": "518", "computeRatioAvg": 0.5138888888888888, "computeRatioMax": 0.5138888888888888, "endMs": "1665776835859", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.017857142857142856, "readRatioMax": 0.017857142857142856, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "387", "startMs": "1665776835541", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0D_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.018849206349206348, "writeRatioMax": 0.018849206349206348 }, { "completedParallelInputs": "1", "computeMsAvg": "506", "computeMsMax": "506", "computeRatioAvg": 0.501984126984127, "computeRatioMax": 0.501984126984127, "endMs": "1665776835950", "id": "14", "inputStages": [ "11", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.01984126984126984, "readRatioMax": 0.01984126984126984, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "513", "startMs": "1665776835612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0E_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.025793650793650792, "writeRatioMax": 0.025793650793650792 }, { "completedParallelInputs": "6", "computeMsAvg": "737", "computeMsMax": "918", "computeRatioAvg": 0.7311507936507936, "computeRatioMax": 0.9107142857142857, "endMs": "1665776836188", "id": "15", "inputStages": [ "8", "6" ], "name": "S0F: Join+", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "21", "readRatioAvg": 0.015873015873015872, "readRatioMax": 0.020833333333333332, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "4021", "startMs": "1665776835619", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0F_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.001984126984126984, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.005952380952380952, "writeRatioMax": 0.007936507936507936 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.03869047619047619, "computeRatioMax": 0.03869047619047619, "endMs": "1665776836273", "id": "16", "inputStages": [ "14" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776836227", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0E_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.003968253968253968, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01984126984126984, "writeRatioMax": 0.01984126984126984 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.026785714285714284, "computeRatioMax": 0.026785714285714284, "endMs": "1665776836277", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776836237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.01984126984126984, "writeRatioMax": 0.01984126984126984 }, { "completedParallelInputs": "1", "computeMsAvg": "401", "computeMsMax": "401", "computeRatioAvg": 0.3978174603174603, "computeRatioMax": 0.3978174603174603, "endMs": "1665776836466", "id": "18", "inputStages": [ "15" ], "name": "S12: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "202139", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "297", "startMs": "1665776836251", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$130, $330, $331, $332, $333", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.000992063492063492, "waitRatioMax": 0.000992063492063492, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.021825396825396824, "writeRatioMax": 0.021825396825396824 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.008928571428571428, "computeRatioMax": 0.017857142857142856, "endMs": "1665776836573", "id": "20", "inputStages": [ "18" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "38175", "recordsWritten": "38175", "shuffleOutputBytes": "2484363", "shuffleOutputBytesSpilled": "0", "slotMs": "4154", "startMs": "1665776836508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.001984126984126984, "waitRatioMax": 0.00496031746031746, "writeMsAvg": "28", "writeMsMax": "54", "writeRatioAvg": 0.027777777777777776, "writeRatioMax": 0.05357142857142857 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.007936507936507936, "computeRatioMax": 0.017857142857142856, "endMs": "1665776836564", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "3483", "startMs": "1665776836508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.00496031746031746, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.01488095238095238, "writeRatioMax": 0.025793650793650792 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.006944444444444444, "computeRatioMax": 0.013888888888888888, "endMs": "1665776836564", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3313", "startMs": "1665776836508", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.003968253968253968, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.01488095238095238, "writeRatioMax": 0.028769841269841268 }, { "completedParallelInputs": "1", "computeMsAvg": "226", "computeMsMax": "226", "computeRatioAvg": 0.22420634920634921, "computeRatioMax": 0.22420634920634921, "endMs": "1665776836714", "id": "23", "inputStages": [ "22", "20", "12", "21" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "261730", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "210", "startMs": "1665776836519", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$130, $330, $331, $332, $333", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$340 := $280, $341 := $160, $342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130", "INNER HASH JOIN EACH WITH ALL ON $280 = $330" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.00496031746031746, "waitRatioMax": 0.00496031746031746, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.000992063492063492, "writeRatioMax": 0.000992063492063492 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.00992063492063492, "computeRatioMax": 0.00992063492063492, "endMs": "1665776836752", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "169", "startMs": "1665776836527", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.003968253968253968, "writeRatioMax": 0.003968253968253968 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "609", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "1834" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1673", "estimatedRunnableUnits": "6", "pendingUnits": "0", "totalSlotMs": "22050" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "22050", "transferredBytes": "0" }, "startTime": "1665776835160", "totalBytesProcessed": "176020858", "totalSlotMs": "22050" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon23b834fe_56d0_4342_980f_da40cc7c454a" }, "priority": "INTERACTIVE", "query": "-- start query 11 in stream 0 using template query11.tpl\nwith year_total as (\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n ,'s' sale_type\n from customer\n ,store_sales\n ,date_dim\n where c_customer_sk = ss_customer_sk\n and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year \n union all\n select c_customer_id customer_id\n ,c_first_name customer_first_name\n ,c_last_name customer_last_name\n ,c_preferred_cust_flag customer_preferred_cust_flag\n ,c_birth_country customer_birth_country\n ,c_login customer_login\n ,c_email_address customer_email_address\n ,d_year dyear\n ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n ,'w' sale_type\n from customer\n ,web_sales\n ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n ,c_first_name\n ,c_last_name\n ,c_preferred_cust_flag \n ,c_birth_country\n ,c_login\n ,c_email_address\n ,d_year\n )\n select\n t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n ,year_total t_s_secyear\n ,year_total t_w_firstyear\n ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n and t_s_firstyear.customer_id = t_w_secyear.customer_id\n and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n and t_s_firstyear.sale_type = 's'\n and t_w_firstyear.sale_type = 'w'\n and t_s_secyear.sale_type = 's'\n and t_w_secyear.sale_type = 'w'\n and t_s_firstyear.dyear = 2001\n and t_s_secyear.dyear = 2001+1\n and t_w_firstyear.dyear = 2001\n and t_w_secyear.dyear = 2001+1\n and t_s_firstyear.year_total > 0\n and t_w_firstyear.year_total > 0\n and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n ,t_s_secyear.customer_first_name\n ,t_s_secyear.customer_last_name\n ,t_s_secyear.customer_preferred_cust_flag\n limit 100\n;\n\n-- end query 11 in stream 0 using template query11.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "E4DDzVsVS3vUaKGaKtL9cg==", "id": "test-project-364309:europe-west1.query11_1665776838", "jobReference": { "jobId": "query11_1665776838", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query11_1665776838?location=europe-west1", "statistics": { "creationTime": "1665776839142", "endTime": "1665776841083", "finalExecutionDurationMs": "1708", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "176020858", "performanceInsights": { "avgPreviousExecutionMs": "1639" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.010462074978204011, "computeRatioMax": 0.010462074978204011, "endMs": "1665776839348", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.008718395815170008, "readRatioMax": 0.008718395815170008, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776839310", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$110:d_date_sk, $111:d_year", "FROM date_dim", "WHERE equal($111, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.007846556233653008, "writeRatioMax": 0.007846556233653008 }, { "completedParallelInputs": "1", "computeMsAvg": "192", "computeMsMax": "192", "computeRatioAvg": 0.16739319965126417, "computeRatioMax": 0.16739319965126417, "endMs": "1665776839526", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.014821272885789015, "readRatioMax": 0.014821272885789015, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "237", "startMs": "1665776839342", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.018308631211857017, "writeRatioMax": 0.018308631211857017 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.007846556233653008, "computeRatioMax": 0.007846556233653008, "endMs": "1665776839398", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.006102877070619006, "readRatioMax": 0.006102877070619006, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776839359", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_year", "FROM date_dim", "WHERE equal($81, 2001)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.010462074978204011, "writeRatioMax": 0.010462074978204011 }, { "completedParallelInputs": "1", "computeMsAvg": "215", "computeMsMax": "215", "computeRatioAvg": 0.1874455100261552, "computeRatioMax": 0.1874455100261552, "endMs": "1665776839555", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.013949433304272014, "readRatioMax": 0.013949433304272014, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665776839391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.012205754141238012, "writeRatioMax": 0.012205754141238012 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.010462074978204011, "computeRatioMax": 0.010462074978204011, "endMs": "1665776839436", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.006102877070619006, "readRatioMax": 0.006102877070619006, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665776839406", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$50, $51", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.012205754141238012, "writeRatioMax": 0.012205754141238012 }, { "completedParallelInputs": "1", "computeMsAvg": "219", "computeMsMax": "219", "computeRatioAvg": 0.1909328683522232, "computeRatioMax": 0.1909328683522232, "endMs": "1665776839615", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.011333914559721011, "readRatioMax": 0.011333914559721011, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "243", "startMs": "1665776839434", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.013949433304272014, "writeRatioMax": 0.013949433304272014 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.012205754141238012, "computeRatioMax": 0.012205754141238012, "endMs": "1665776839482", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.00959023539668701, "readRatioMax": 0.00959023539668701, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776839451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $21:d_year", "FROM date_dim", "WHERE equal($21, 2002)" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.008718395815170008, "writeRatioMax": 0.008718395815170008 }, { "completedParallelInputs": "1", "computeMsAvg": "233", "computeMsMax": "233", "computeRatioAvg": 0.2031386224934612, "computeRatioMax": 0.2031386224934612, "endMs": "1665776839688", "id": "11", "name": "S0B: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.017436791630340016, "readRatioMax": 0.017436791630340016, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "10271188", "shuffleOutputBytesSpilled": "0", "slotMs": "272", "startMs": "1665776839482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.014821272885789015, "writeRatioMax": 0.014821272885789015 }, { "completedParallelInputs": "6", "computeMsAvg": "787", "computeMsMax": "958", "computeRatioAvg": 0.6861377506538797, "computeRatioMax": 0.8352223190932868, "endMs": "1665776840096", "id": "12", "inputStages": [ "2", "0" ], "name": "S0C: Join+", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "21", "readRatioAvg": 0.014821272885789015, "readRatioMax": 0.018308631211857017, "recordsRead": "3482594", "recordsWritten": "200751", "shuffleOutputBytes": "24006339", "shuffleOutputBytesSpilled": "0", "slotMs": "4295", "startMs": "1665776839538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$90, $91, $92, $93, $94, $95, $96, $97", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$110, $111", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269", "$200 := SUM($230)" ] }, { "kind": "COMPUTE", "substeps": [ "$230 := subtract($268, $267)" ] }, { "kind": "JOIN", "substeps": [ "$260 := $240, $261 := $241, $262 := $242, $263 := $243, $264 := $244, $265 := $245, $266 := $246, $267 := $248, $268 := $249, $269 := $111", "INNER HASH JOIN EACH WITH ALL ON $247 = $110" ] }, { "kind": "JOIN", "substeps": [ "$247 := $100, $248 := $102, $249 := $103, $240 := $91, $241 := $92, $242 := $93, $243 := $94, $244 := $95, $245 := $96, $246 := $97", "INNER HASH JOIN EACH WITH ALL ON $101 = $90" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "TO __stage0C_output", "BY HASH($270, $271, $272, $273, $274, $275, $276, $277)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.006102877070619006, "writeRatioMax": 0.006974716652136007 }, { "completedParallelInputs": "1", "computeMsAvg": "836", "computeMsMax": "836", "computeRatioAvg": 0.7288578901482128, "computeRatioMax": 0.7288578901482128, "endMs": "1665776840061", "id": "13", "inputStages": [ "5", "3" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.02005231037489102, "readRatioMax": 0.02005231037489102, "recordsRead": "819749", "recordsWritten": "11552", "shuffleOutputBytes": "1382919", "shuffleOutputBytesSpilled": "0", "slotMs": "752", "startMs": "1665776839606", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60, $61, $62, $63, $64, $65, $66, $67", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$80, $81", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379", "$190 := SUM($220)" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := subtract($378, $377)" ] }, { "kind": "JOIN", "substeps": [ "$370 := $350, $371 := $351, $372 := $352, $373 := $353, $374 := $354, $375 := $355, $376 := $356, $377 := $358, $378 := $359, $379 := $81", "INNER HASH JOIN EACH WITH ALL ON $357 = $80" ] }, { "kind": "JOIN", "substeps": [ "$357 := $70, $358 := $72, $359 := $73, $350 := $61, $351 := $62, $352 := $63, $353 := $64, $354 := $65, $355 := $66, $356 := $67", "INNER HASH JOIN EACH WITH ALL ON $71 = $60" ] }, { "kind": "WRITE", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "TO __stage0D_output", "BY HASH($380, $381, $382, $383, $384, $385, $386, $387)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0017436791630340018, "waitRatioMax": 0.0017436791630340018, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.02005231037489102, "writeRatioMax": 0.02005231037489102 }, { "completedParallelInputs": "6", "computeMsAvg": "895", "computeMsMax": "1147", "computeRatioAvg": 0.7802964254577158, "computeRatioMax": 1, "endMs": "1665776840309", "id": "14", "inputStages": [ "8", "6" ], "name": "S0E: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "36", "readRatioAvg": 0.01918047079337402, "readRatioMax": 0.03138622493461203, "recordsRead": "3482594", "recordsWritten": "202139", "shuffleOutputBytes": "24175857", "shuffleOutputBytesSpilled": "0", "slotMs": "4551", "startMs": "1665776839635", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33, $34, $35, $36, $37", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$50, $51", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319", "$180 := SUM($210)" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := subtract($318, $317)" ] }, { "kind": "JOIN", "substeps": [ "$310 := $290, $311 := $291, $312 := $292, $313 := $293, $314 := $294, $315 := $295, $316 := $296, $317 := $298, $318 := $299, $319 := $51", "INNER HASH JOIN EACH WITH ALL ON $297 = $50" ] }, { "kind": "JOIN", "substeps": [ "$297 := $40, $298 := $42, $299 := $43, $290 := $31, $291 := $32, $292 := $33, $293 := $34, $294 := $35, $295 := $36, $296 := $37", "INNER HASH JOIN EACH WITH ALL ON $41 = $30" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "TO __stage0E_output", "BY HASH($320, $321, $322, $323, $324, $325, $326, $327)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0017436791630340018, "waitRatioMax": 0.0017436791630340018, "writeMsAvg": "10", "writeMsMax": "21", "writeRatioAvg": 0.008718395815170008, "writeRatioMax": 0.018308631211857017 }, { "completedParallelInputs": "1", "computeMsAvg": "714", "computeMsMax": "714", "computeRatioAvg": 0.6224934612031386, "computeRatioMax": 0.6224934612031386, "endMs": "1665776840195", "id": "15", "inputStages": [ "11", "9" ], "name": "S0F: Join+", "parallelInputs": "1", "readMsAvg": "30", "readMsMax": "30", "readRatioAvg": 0.026155187445510025, "readRatioMax": 0.026155187445510025, "recordsRead": "819749", "recordsWritten": "11252", "shuffleOutputBytes": "1347982", "shuffleOutputBytesSpilled": "0", "slotMs": "624", "startMs": "1665776839745", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3, $4, $5, $6, $7, $8", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439", "$150 := SUM($170)" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := subtract($438, $437)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $410, $431 := $411, $432 := $412, $433 := $413, $434 := $414, $435 := $415, $436 := $416, $437 := $418, $438 := $419, $439 := $21", "INNER HASH JOIN EACH WITH ALL ON $417 = $20" ] }, { "kind": "JOIN", "substeps": [ "$417 := $10, $418 := $12, $419 := $13, $410 := $2, $411 := $3, $412 := $4, $413 := $5, $414 := $6, $415 := $7, $416 := $8", "INNER HASH JOIN EACH WITH ALL ON $11 = $1" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "TO __stage0F_output", "BY HASH($440, $441, $442, $443, $444, $445, $446, $447)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.020924149956408022, "writeRatioMax": 0.020924149956408022 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.018308631211857017, "computeRatioMax": 0.018308631211857017, "endMs": "1665776840375", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776840329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442, $443, $444, $445, $446, $447, $150", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447", "$120 := SUM($150)" ] }, { "kind": "WRITE", "substeps": [ "$120, $450", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.015693112467306015, "writeRatioMax": 0.015693112467306015 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.023539668700959023, "computeRatioMax": 0.023539668700959023, "endMs": "1665776840402", "id": "17", "inputStages": [ "13" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665776840344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$380, $381, $382, $383, $384, $385, $386, $387, $190", "FROM __stage0D_output" ] }, { "kind": "FILTER", "substeps": [ "greater($140, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387", "$140 := SUM($190)" ] }, { "kind": "WRITE", "substeps": [ "$140, $390", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.01918047079337402, "writeRatioMax": 0.01918047079337402 }, { "completedParallelInputs": "1", "computeMsAvg": "228", "computeMsMax": "228", "computeRatioAvg": 0.1987794245858762, "computeRatioMax": 0.1987794245858762, "endMs": "1665776840535", "id": "19", "inputStages": [ "12" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "200751", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "217", "startMs": "1665776840375", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$270, $271, $272, $273, $274, $275, $276, $277, $200", "FROM __stage0C_output" ] }, { "kind": "FILTER", "substeps": [ "greater($160, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277", "$160 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$160, $280", "TO __stage13_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.016564952048823016, "writeRatioMax": 0.016564952048823016 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.006974716652136007, "computeRatioMax": 0.011333914559721011, "endMs": "1665776840622", "id": "20", "inputStages": [ "19" ], "name": "S14: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "37923", "recordsWritten": "37923", "shuffleOutputBytes": "1441074", "shuffleOutputBytesSpilled": "0", "slotMs": "3665", "startMs": "1665776840566", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.0017436791630340018, "waitRatioMax": 0.0052310374891020054, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.013077593722755012, "writeRatioMax": 0.016564952048823016 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.006974716652136007, "computeRatioMax": 0.011333914559721011, "endMs": "1665776840622", "id": "21", "inputStages": [ "17" ], "name": "S15: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11552", "recordsWritten": "11552", "shuffleOutputBytes": "438976", "shuffleOutputBytesSpilled": "0", "slotMs": "3888", "startMs": "1665776840566", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.004359197907585004, "waitRatioMax": 0.0052310374891020054, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.013077593722755012, "writeRatioMax": 0.026155187445510025 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.006102877070619006, "computeRatioMax": 0.012205754141238012, "endMs": "1665776840627", "id": "22", "inputStages": [ "16" ], "name": "S16: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "11252", "recordsWritten": "11252", "shuffleOutputBytes": "427576", "shuffleOutputBytesSpilled": "0", "slotMs": "3041", "startMs": "1665776840566", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.0052310374891020054, "waitRatioMax": 0.006102877070619006, "writeMsAvg": "7", "writeMsMax": "22", "writeRatioAvg": 0.006102877070619006, "writeRatioMax": 0.01918047079337402 }, { "completedParallelInputs": "1", "computeMsAvg": "433", "computeMsMax": "433", "computeRatioAvg": 0.37750653879686136, "computeRatioMax": 0.37750653879686136, "endMs": "1665776840870", "id": "23", "inputStages": [ "20", "21", "22", "14" ], "name": "S17: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "262866", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "394", "startMs": "1665776840582", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327, $180", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$160, $280", "FROM __stage14_output" ] }, { "kind": "READ", "substeps": [ "$140, $390", "FROM __stage15_output" ] }, { "kind": "READ", "substeps": [ "$120, $450", "FROM __stage16_output" ] }, { "kind": "SORT", "substeps": [ "$460 ASC, $461 ASC, $462 ASC, $463 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(greater($465, NUMERIC<...>), divide($467, $465), NUMERIC<...>), ...)" ] }, { "kind": "JOIN", "substeps": [ "$460 := $400, $461 := $401, $462 := $402, $463 := $403, $464 := $405, $465 := $407, $466 := $406, $467 := $120", "INNER HASH JOIN EACH WITH ALL ON $404 = $450" ] }, { "kind": "JOIN", "substeps": [ "$400 := $342, $401 := $343, $402 := $344, $403 := $345, $404 := $340, $405 := $346, $406 := $341, $407 := $140", "INNER HASH JOIN EACH WITH ALL ON $340 = $390" ] }, { "kind": "JOIN", "substeps": [ "$342 := $330, $343 := $331, $344 := $332, $345 := $333, $346 := $130, $340 := $280, $341 := $160", "INNER HASH JOIN EACH WITH ALL ON $330 = $280" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327", "$130 := SUM($180)" ] }, { "kind": "WRITE", "substeps": [ "$470, $471, $472, $473", "TO __stage17_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.0052310374891020054, "waitRatioMax": 0.0052310374891020054, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0008718395815170009, "writeRatioMax": 0.0008718395815170009 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.006102877070619006, "computeRatioMax": 0.006102877070619006, "endMs": "1665776840926", "id": "24", "inputStages": [ "23" ], "name": "S18: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "88", "recordsWritten": "88", "shuffleOutputBytes": "4304", "shuffleOutputBytesSpilled": "0", "slotMs": "287", "startMs": "1665776840584", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$470, $471, $472, $473", "FROM __stage17_output" ] }, { "kind": "SORT", "substeps": [ "$470 ASC, $471 ASC, $472 ASC, $473 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$480, $481, $482, $483", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0008718395815170009, "waitRatioMax": 0.0008718395815170009, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0026155187445510027, "writeRatioMax": 0.0026155187445510027 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "8", "elapsedMs": "621", "estimatedRunnableUnits": "0", "pendingUnits": "14", "totalSlotMs": "3073" }, { "activeUnits": "2", "completedUnits": "327", "elapsedMs": "1838", "estimatedRunnableUnits": "6", "pendingUnits": "0", "totalSlotMs": "23507" } ], "totalBytesBilled": "176160768", "totalBytesProcessed": "176020858", "totalPartitionsProcessed": "0", "totalSlotMs": "23507", "transferredBytes": "0" }, "startTime": "1665776839190", "totalBytesProcessed": "176020858", "totalSlotMs": "23507" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
