{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0e47ca5a_68aa_4913_a033_312e36715da6" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8dj7ZJkhSO0bIvvae6NZjA==", "id": "test-project-364309:europe-west1.query10_1665768226", "jobReference": { "jobId": "query10_1665768226", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665768226?location=europe-west1", "statistics": { "creationTime": "1665768227321", "endTime": "1665768228639", "finalExecutionDurationMs": "1057", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1093" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03296703296703297, "computeRatioMax": 0.03296703296703297, "endMs": "1665768227559", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02197802197802198, "readRatioMax": 0.02197802197802198, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768227524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02197802197802198, "writeRatioMax": 0.02197802197802198 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02197802197802198, "computeRatioMax": 0.02197802197802198, "endMs": "1665768227602", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013736263736263736, "readRatioMax": 0.013736263736263736, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665768227577", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "14", "waitMsMax": "14", "waitRatioAvg": 0.038461538461538464, "waitRatioMax": 0.038461538461538464, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.038461538461538464 }, { "completedParallelInputs": "6", "computeMsAvg": "79", "computeMsMax": "112", "computeRatioAvg": 0.21703296703296704, "computeRatioMax": 0.3076923076923077, "endMs": "1665768227680", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.027472527472527472, "readRatioMax": 0.03571428571428571, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "526", "startMs": "1665768227589", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "8", "writeMsMax": "11", "writeRatioAvg": 0.02197802197802198, "writeRatioMax": 0.03021978021978022 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.07692307692307693, "computeRatioMax": 0.07692307692307693, "endMs": "1665768227662", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02197802197802198, "readRatioMax": 0.02197802197802198, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665768227625", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.024725274725274724, "writeRatioMax": 0.024725274725274724 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.02197802197802198, "computeRatioMax": 0.038461538461538464, "endMs": "1665768227723", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "3782", "startMs": "1665768227672", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.04120879120879121, "writeRatioMax": 0.057692307692307696 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.024725274725274724, "computeRatioMax": 0.0521978021978022, "endMs": "1665768227737", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "3360", "startMs": "1665768227689", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.04120879120879121, "writeRatioMax": 0.0521978021978022 }, { "completedParallelInputs": "1", "computeMsAvg": "364", "computeMsMax": "364", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768227975", "id": "9", "inputStages": [ "8", "7" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03021978021978022, "readRatioMax": 0.03021978021978022, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "344", "startMs": "1665768227692", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.01098901098901099, "waitRatioMax": 0.01098901098901099, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01098901098901099, "writeRatioMax": 0.01098901098901099 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03296703296703297, "computeRatioMax": 0.03296703296703297, "endMs": "1665768228055", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.019230769230769232, "readRatioMax": 0.019230769230769232, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665768228019", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02197802197802198, "writeRatioMax": 0.02197802197802198 }, { "completedParallelInputs": "1", "computeMsAvg": "93", "computeMsMax": "93", "computeRatioAvg": 0.2554945054945055, "computeRatioMax": 0.2554945054945055, "endMs": "1665768228152", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03021978021978022, "readRatioMax": 0.03021978021978022, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "109", "startMs": "1665768228075", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03021978021978022, "writeRatioMax": 0.03021978021978022 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.024725274725274724, "computeRatioMax": 0.04120879120879121, "endMs": "1665768228206", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "3460", "startMs": "1665768228157", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.04120879120879121, "writeRatioMax": 0.0521978021978022 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.07417582417582418, "computeRatioMax": 0.07417582417582418, "endMs": "1665768228229", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768228160", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005494505494505495, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02197802197802198, "writeRatioMax": 0.02197802197802198 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02197802197802198, "computeRatioMax": 0.02197802197802198, "endMs": "1665768228285", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03021978021978022, "readRatioMax": 0.03021978021978022, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768228256", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.027472527472527472, "writeRatioMax": 0.027472527472527472 }, { "completedParallelInputs": "5", "computeMsAvg": "66", "computeMsMax": "93", "computeRatioAvg": 0.1813186813186813, "computeRatioMax": 0.2554945054945055, "endMs": "1665768228371", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.03296703296703297, "readRatioMax": 0.04120879120879121, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "398", "startMs": "1665768228301", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "9", "writeMsMax": "11", "writeRatioAvg": 0.024725274725274724, "writeRatioMax": 0.03021978021978022 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.024725274725274724, "computeRatioMax": 0.046703296703296704, "endMs": "1665768228428", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "3649", "startMs": "1665768228380", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.005494505494505495, "writeMsAvg": "15", "writeMsMax": "18", "writeRatioAvg": 0.04120879120879121, "writeRatioMax": 0.04945054945054945 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.057692307692307696, "computeRatioMax": 0.057692307692307696, "endMs": "1665768228451", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665768228394", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008241758241758242, "waitRatioMax": 0.008241758241758242, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.013736263736263736, "writeRatioMax": 0.013736263736263736 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.016483516483516484, "computeRatioMax": 0.016483516483516484, "endMs": "1665768228506", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768228470", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.04395604395604396, "writeRatioMax": 0.04395604395604396 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.016483516483516484, "computeRatioMax": 0.016483516483516484, "endMs": "1665768228547", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768228515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.038461538461538464, "writeRatioMax": 0.038461538461538464 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.024725274725274724, "computeRatioMax": 0.024725274725274724, "endMs": "1665768228555", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768228527", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027472527472527475, "waitRatioMax": 0.0027472527472527475, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.016483516483516484, "writeRatioMax": 0.016483516483516484 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "210", "elapsedMs": "645", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "8121" }, { "activeUnits": "2", "completedUnits": "423", "elapsedMs": "1210", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15975" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "15975", "transferredBytes": "0" }, "startTime": "1665768227381", "totalBytesProcessed": "211635233", "totalSlotMs": "15975" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond9a00616_ed59_4ea0_ba28_beb316afe9f4" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "x36UIJTneSWZ2oAML5z2pw==", "id": "test-project-364309:europe-west1.query10_1665776538", "jobReference": { "jobId": "query10_1665776538", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776538?location=europe-west1", "statistics": { "creationTime": "1665776538896", "endTime": "1665776540274", "finalExecutionDurationMs": "1129", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1092" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026246719160104987, "computeRatioMax": 0.026246719160104987, "endMs": "1665776539130", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01837270341207349, "readRatioMax": 0.01837270341207349, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665776539094", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026246719160104987, "waitRatioMax": 0.0026246719160104987, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.028871391076115485, "writeRatioMax": 0.028871391076115485 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03412073490813648, "computeRatioMax": 0.03412073490813648, "endMs": "1665776539197", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01837270341207349, "readRatioMax": 0.01837270341207349, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "88", "startMs": "1665776539158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "16", "waitMsMax": "16", "waitRatioAvg": 0.04199475065616798, "waitRatioMax": 0.04199475065616798, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.023622047244094488, "writeRatioMax": 0.023622047244094488 }, { "completedParallelInputs": "6", "computeMsAvg": "86", "computeMsMax": "122", "computeRatioAvg": 0.22572178477690288, "computeRatioMax": 0.32020997375328086, "endMs": "1665776539263", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "8", "readMsMax": "11", "readRatioAvg": 0.02099737532808399, "readRatioMax": 0.028871391076115485, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "625", "startMs": "1665776539174", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005249343832020997, "waitRatioMax": 0.005249343832020997, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.01837270341207349, "writeRatioMax": 0.023622047244094488 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.06299212598425197, "computeRatioMax": 0.06299212598425197, "endMs": "1665776539250", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013123359580052493, "readRatioMax": 0.013123359580052493, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776539220", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005249343832020997, "waitRatioMax": 0.005249343832020997, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01837270341207349, "writeRatioMax": 0.01837270341207349 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.023622047244094488, "computeRatioMax": 0.049868766404199474, "endMs": "1665776539324", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "7366", "startMs": "1665776539255", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005249343832020997, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "16", "writeMsMax": "20", "writeRatioAvg": 0.04199475065616798, "writeRatioMax": 0.05249343832020997 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.023622047244094488, "computeRatioMax": 0.049868766404199474, "endMs": "1665776539331", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "6551", "startMs": "1665776539273", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005249343832020997, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.05249343832020997, "writeRatioMax": 0.08136482939632546 }, { "completedParallelInputs": "1", "computeMsAvg": "381", "computeMsMax": "381", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776539542", "id": "9", "inputStages": [ "8", "7" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.026246719160104987, "readRatioMax": 0.026246719160104987, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "554", "startMs": "1665776539278", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.013123359580052493, "waitRatioMax": 0.013123359580052493, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007874015748031496, "writeRatioMax": 0.007874015748031496 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.028871391076115485, "computeRatioMax": 0.028871391076115485, "endMs": "1665776539632", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.028871391076115485, "readRatioMax": 0.028871391076115485, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776539601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026246719160104987, "waitRatioMax": 0.0026246719160104987, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.026246719160104987, "writeRatioMax": 0.026246719160104987 }, { "completedParallelInputs": "1", "computeMsAvg": "71", "computeMsMax": "71", "computeRatioAvg": 0.18635170603674542, "computeRatioMax": 0.18635170603674542, "endMs": "1665776539706", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013123359580052493, "readRatioMax": 0.013123359580052493, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776539649", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026246719160104987, "waitRatioMax": 0.0026246719160104987, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.015748031496062992, "writeRatioMax": 0.015748031496062992 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.01837270341207349, "computeRatioMax": 0.03674540682414698, "endMs": "1665776539779", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "5207", "startMs": "1665776539720", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.007874015748031496, "waitRatioMax": 0.015748031496062992, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.03674540682414698, "writeRatioMax": 0.047244094488188976 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03412073490813648, "computeRatioMax": 0.03412073490813648, "endMs": "1665776539790", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665776539728", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.013123359580052493, "waitRatioMax": 0.013123359580052493, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007874015748031496, "writeRatioMax": 0.007874015748031496 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.04199475065616798, "computeRatioMax": 0.04199475065616798, "endMs": "1665776539860", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.026246719160104987, "readRatioMax": 0.026246719160104987, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "132", "startMs": "1665776539819", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005249343832020997, "waitRatioMax": 0.005249343832020997, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.023622047244094488, "writeRatioMax": 0.023622047244094488 }, { "completedParallelInputs": "5", "computeMsAvg": "67", "computeMsMax": "100", "computeRatioAvg": 0.17585301837270342, "computeRatioMax": 0.26246719160104987, "endMs": "1665776539959", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "10", "readRatioAvg": 0.023622047244094488, "readRatioMax": 0.026246719160104987, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "469", "startMs": "1665776539889", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005249343832020997, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.02099737532808399, "writeRatioMax": 0.023622047244094488 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.02099737532808399, "computeRatioMax": 0.04461942257217848, "endMs": "1665776540019", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "5627", "startMs": "1665776539963", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0026246719160104987, "waitRatioMax": 0.007874015748031496, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.03937007874015748, "writeRatioMax": 0.07349081364829396 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.07349081364829396, "computeRatioMax": 0.07349081364829396, "endMs": "1665776540045", "id": "19", "inputStages": [ "14", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776539979", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005249343832020997, "waitRatioMax": 0.005249343832020997, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010498687664041995, "writeRatioMax": 0.010498687664041995 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02099737532808399, "computeRatioMax": 0.02099737532808399, "endMs": "1665776540110", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776540074", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005249343832020997, "waitRatioMax": 0.005249343832020997, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.04199475065616798, "writeRatioMax": 0.04199475065616798 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02099737532808399, "computeRatioMax": 0.02099737532808399, "endMs": "1665776540161", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665776540124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026246719160104987, "waitRatioMax": 0.0026246719160104987, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03412073490813648, "writeRatioMax": 0.03412073490813648 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.028871391076115485, "computeRatioMax": 0.028871391076115485, "endMs": "1665776540180", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "89", "startMs": "1665776540139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0026246719160104987, "waitRatioMax": 0.0026246719160104987, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02099737532808399, "writeRatioMax": 0.02099737532808399 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "210", "elapsedMs": "652", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "15270" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1289", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "27036" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "27036", "transferredBytes": "0" }, "startTime": "1665776538943", "totalBytesProcessed": "211635233", "totalSlotMs": "27036" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone5f776ba_97af_489b_8790_66a34d12cc72" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "qb2YoUQ56+F6gesIxDYjjQ==", "id": "test-project-364309:europe-west1.query10_1665776542", "jobReference": { "jobId": "query10_1665776542", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776542?location=europe-west1", "statistics": { "creationTime": "1665776542815", "endTime": "1665776544200", "finalExecutionDurationMs": "1126", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1093" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03869047619047619, "computeRatioMax": 0.03869047619047619, "endMs": "1665776543052", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.020833333333333332, "readRatioMax": 0.020833333333333332, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "66", "startMs": "1665776543022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.020833333333333332, "waitRatioMax": 0.020833333333333332, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03869047619047619, "computeRatioMax": 0.03869047619047619, "endMs": "1665776543118", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.023809523809523808, "readRatioMax": 0.023809523809523808, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776543079", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "18", "waitMsMax": "18", "waitRatioAvg": 0.05357142857142857, "waitRatioMax": 0.05357142857142857, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.023809523809523808 }, { "completedParallelInputs": "6", "computeMsAvg": "84", "computeMsMax": "96", "computeRatioAvg": 0.25, "computeRatioMax": 0.2857142857142857, "endMs": "1665776543172", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "15", "readRatioAvg": 0.02976190476190476, "readRatioMax": 0.044642857142857144, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "999", "startMs": "1665776543094", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "8", "writeMsMax": "12", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.07738095238095238, "computeRatioMax": 0.07738095238095238, "endMs": "1665776543176", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.023809523809523808, "readRatioMax": 0.023809523809523808, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665776543140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.023809523809523808 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.023809523809523808, "computeRatioMax": 0.05654761904761905, "endMs": "1665776543246", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "6140", "startMs": "1665776543186", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "27", "writeMsMax": "52", "writeRatioAvg": 0.08035714285714286, "writeRatioMax": 0.15476190476190477 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.023809523809523808, "computeRatioMax": 0.050595238095238096, "endMs": "1665776543234", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "5411", "startMs": "1665776543187", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.01488095238095238, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.05357142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "336", "computeMsMax": "336", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776543441", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.03273809523809524, "readRatioMax": 0.03273809523809524, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "440", "startMs": "1665776543195", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.01488095238095238, "waitRatioMax": 0.01488095238095238, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.008928571428571428, "writeRatioMax": 0.008928571428571428 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.047619047619047616, "endMs": "1665776543553", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.02976190476190476, "readRatioMax": 0.02976190476190476, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "70", "startMs": "1665776543523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.026785714285714284, "writeRatioMax": 0.026785714285714284 }, { "completedParallelInputs": "1", "computeMsAvg": "93", "computeMsMax": "93", "computeRatioAvg": 0.2767857142857143, "computeRatioMax": 0.2767857142857143, "endMs": "1665776543653", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.023809523809523808, "readRatioMax": 0.023809523809523808, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "326", "startMs": "1665776543569", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.020833333333333332, "writeRatioMax": 0.020833333333333332 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.023809523809523808, "computeRatioMax": 0.03869047619047619, "endMs": "1665776543717", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "5947", "startMs": "1665776543665", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.044642857142857144, "writeRatioMax": 0.08333333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.07738095238095238, "computeRatioMax": 0.07738095238095238, "endMs": "1665776543739", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665776543669", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.017857142857142856, "writeRatioMax": 0.017857142857142856 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03571428571428571, "computeRatioMax": 0.03571428571428571, "endMs": "1665776543809", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.023809523809523808, "readRatioMax": 0.023809523809523808, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776543777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.044642857142857144, "writeRatioMax": 0.044642857142857144 }, { "completedParallelInputs": "5", "computeMsAvg": "69", "computeMsMax": "105", "computeRatioAvg": 0.20535714285714285, "computeRatioMax": 0.3125, "endMs": "1665776543909", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.02976190476190476, "readRatioMax": 0.03571428571428571, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "628", "startMs": "1665776543827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008928571428571428, "waitRatioMax": 0.008928571428571428, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.02976190476190476 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "21", "computeRatioAvg": 0.023809523809523808, "computeRatioMax": 0.0625, "endMs": "1665776543968", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "5960", "startMs": "1665776543914", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.06547619047619048 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.08035714285714286, "computeRatioMax": 0.08035714285714286, "endMs": "1665776543988", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665776543930", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.011904761904761904, "writeRatioMax": 0.011904761904761904 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03869047619047619, "computeRatioMax": 0.03869047619047619, "endMs": "1665776544050", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776544012", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.041666666666666664, "endMs": "1665776544095", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776544056", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.026785714285714284, "computeRatioMax": 0.026785714285714284, "endMs": "1665776544113", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776544068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002976190476190476, "waitRatioMax": 0.002976190476190476, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.020833333333333332, "writeRatioMax": 0.020833333333333332 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "210", "elapsedMs": "645", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "13196" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1268", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "26460" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "26460", "transferredBytes": "0" }, "startTime": "1665776542878", "totalBytesProcessed": "211635233", "totalSlotMs": "26460" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc1488ad7_5545_4f35_9a0c_61520bf2d9a3" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "wTjUGHiQ1IpEvsZQaejCfA==", "id": "test-project-364309:europe-west1.query10_1665776546", "jobReference": { "jobId": "query10_1665776546", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776546?location=europe-west1", "statistics": { "creationTime": "1665776546751", "endTime": "1665776548145", "finalExecutionDurationMs": "1129", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1093" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.025, "computeRatioMax": 0.025, "endMs": "1665776547003", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013888888888888888, "readRatioMax": 0.013888888888888888, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776546962", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.019444444444444445, "computeRatioMax": 0.019444444444444445, "endMs": "1665776547043", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.011111111111111112, "readRatioMax": 0.011111111111111112, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665776547004", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.044444444444444446, "writeRatioMax": 0.044444444444444446 }, { "completedParallelInputs": "6", "computeMsAvg": "80", "computeMsMax": "118", "computeRatioAvg": 0.2222222222222222, "computeRatioMax": 0.3277777777777778, "endMs": "1665776547136", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "15", "readRatioAvg": 0.025, "readRatioMax": 0.041666666666666664, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "1126", "startMs": "1665776547032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "8", "writeMsMax": "15", "writeRatioAvg": 0.022222222222222223, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.05277777777777778, "computeRatioMax": 0.05277777777777778, "endMs": "1665776547100", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.016666666666666666, "readRatioMax": 0.016666666666666666, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665776547062", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.044444444444444446, "endMs": "1665776547169", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "7408", "startMs": "1665776547104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005555555555555556, "waitRatioMax": 0.008333333333333333, "writeMsAvg": "30", "writeMsMax": "53", "writeRatioAvg": 0.08333333333333333, "writeRatioMax": 0.14722222222222223 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.03888888888888889, "endMs": "1665776547194", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "6542", "startMs": "1665776547140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "4", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.011111111111111112, "writeMsAvg": "14", "writeMsMax": "21", "writeRatioAvg": 0.03888888888888889, "writeRatioMax": 0.058333333333333334 }, { "completedParallelInputs": "1", "computeMsAvg": "360", "computeMsMax": "360", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776547420", "id": "9", "inputStages": [ "8", "7" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.022222222222222223, "readRatioMax": 0.022222222222222223, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "460", "startMs": "1665776547148", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.019444444444444445, "waitRatioMax": 0.019444444444444445, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.013888888888888888 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.022222222222222223, "endMs": "1665776547529", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013888888888888888, "readRatioMax": 0.013888888888888888, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "108", "startMs": "1665776547488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03888888888888889, "writeRatioMax": 0.03888888888888889 }, { "completedParallelInputs": "1", "computeMsAvg": "66", "computeMsMax": "66", "computeRatioAvg": 0.18333333333333332, "computeRatioMax": 0.18333333333333332, "endMs": "1665776547613", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.016666666666666666, "readRatioMax": 0.016666666666666666, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665776547554", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.025, "writeRatioMax": 0.025 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.044444444444444446, "endMs": "1665776547670", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "5954", "startMs": "1665776547616", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005555555555555556, "waitRatioMax": 0.008333333333333333, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.05555555555555555 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.04722222222222222, "computeRatioMax": 0.04722222222222222, "endMs": "1665776547680", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776547622", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.011111111111111112, "writeRatioMax": 0.011111111111111112 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.025, "computeRatioMax": 0.025, "endMs": "1665776547750", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013888888888888888, "readRatioMax": 0.013888888888888888, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776547707", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.04722222222222222, "writeRatioMax": 0.04722222222222222 }, { "completedParallelInputs": "5", "computeMsAvg": "73", "computeMsMax": "102", "computeRatioAvg": 0.20277777777777778, "computeRatioMax": 0.2833333333333333, "endMs": "1665776547847", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "13", "readRatioAvg": 0.030555555555555555, "readRatioMax": 0.03611111111111111, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "737", "startMs": "1665776547771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "7", "writeMsMax": "11", "writeRatioAvg": 0.019444444444444445, "writeRatioMax": 0.030555555555555555 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.03888888888888889, "endMs": "1665776547904", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "5919", "startMs": "1665776547850", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005555555555555556, "waitRatioMax": 0.008333333333333333, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.03888888888888889, "writeRatioMax": 0.04722222222222222 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.075, "computeRatioMax": 0.075, "endMs": "1665776547922", "id": "19", "inputStages": [ "14", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776547864", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.011111111111111112, "writeRatioMax": 0.011111111111111112 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.019444444444444445, "computeRatioMax": 0.019444444444444445, "endMs": "1665776547985", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776547951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.022222222222222223, "computeRatioMax": 0.022222222222222223, "endMs": "1665776548033", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776547997", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03611111111111111, "writeRatioMax": 0.03611111111111111 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.030555555555555555, "computeRatioMax": 0.030555555555555555, "endMs": "1665776548052", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776548012", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002777777777777778, "waitRatioMax": 0.002777777777777778, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.016666666666666666, "writeRatioMax": 0.016666666666666666 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "210", "elapsedMs": "655", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "15723" }, { "activeUnits": "0", "completedUnits": "423", "elapsedMs": "1286", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "28641" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "28641", "transferredBytes": "0" }, "startTime": "1665776546808", "totalBytesProcessed": "211635233", "totalSlotMs": "28641" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc7aa04e3_5b36_4b70_8b3a_03f1d2f65cb9" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "1AbQF4E/PIY5RhorZh3ajA==", "id": "test-project-364309:europe-west1.query10_1665776550", "jobReference": { "jobId": "query10_1665776550", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776550?location=europe-west1", "statistics": { "creationTime": "1665776550797", "endTime": "1665776552142", "finalExecutionDurationMs": "1067", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1094" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.01680672268907563, "endMs": "1665776551053", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012605042016806723, "readRatioMax": 0.012605042016806723, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776551022", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.012605042016806723, "writeRatioMax": 0.012605042016806723 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.01680672268907563, "endMs": "1665776551112", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012605042016806723, "readRatioMax": 0.012605042016806723, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776551074", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "15", "waitMsMax": "15", "waitRatioAvg": 0.031512605042016806, "waitRatioMax": 0.031512605042016806, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.031512605042016806, "writeRatioMax": 0.031512605042016806 }, { "completedParallelInputs": "6", "computeMsAvg": "75", "computeMsMax": "98", "computeRatioAvg": 0.15756302521008403, "computeRatioMax": 0.20588235294117646, "endMs": "1665776551174", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.023109243697478993, "readRatioMax": 0.029411764705882353, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "810", "startMs": "1665776551090", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.01680672268907563, "writeRatioMax": 0.018907563025210083 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.046218487394957986, "computeRatioMax": 0.046218487394957986, "endMs": "1665776551170", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01050420168067227, "readRatioMax": 0.01050420168067227, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776551135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01050420168067227, "writeRatioMax": 0.01050420168067227 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.037815126050420166, "endMs": "1665776551232", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "5683", "startMs": "1665776551184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0063025210084033615, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.031512605042016806, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.031512605042016806, "endMs": "1665776551235", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "4560", "startMs": "1665776551184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "8", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.01680672268907563, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.04831932773109244 }, { "completedParallelInputs": "1", "computeMsAvg": "476", "computeMsMax": "476", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776551484", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.0273109243697479, "readRatioMax": 0.0273109243697479, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "553", "startMs": "1665776551193", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.02100840336134454, "waitRatioMax": 0.02100840336134454, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0063025210084033615, "writeRatioMax": 0.0063025210084033615 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.018907563025210083, "computeRatioMax": 0.018907563025210083, "endMs": "1665776551548", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01050420168067227, "readRatioMax": 0.01050420168067227, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665776551512", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.023109243697478993, "writeRatioMax": 0.023109243697478993 }, { "completedParallelInputs": "1", "computeMsAvg": "60", "computeMsMax": "60", "computeRatioAvg": 0.12605042016806722, "computeRatioMax": 0.12605042016806722, "endMs": "1665776551622", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.012605042016806723, "readRatioMax": 0.012605042016806723, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665776551569", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.01680672268907563, "writeRatioMax": 0.01680672268907563 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.031512605042016806, "endMs": "1665776551692", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "5383", "startMs": "1665776551638", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "19", "writeMsMax": "29", "writeRatioAvg": 0.03991596638655462, "writeRatioMax": 0.06092436974789916 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.04831932773109244, "computeRatioMax": 0.04831932773109244, "endMs": "1665776551711", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776551642", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.0063025210084033615, "waitRatioMax": 0.0063025210084033615, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008403361344537815, "writeRatioMax": 0.008403361344537815 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02100840336134454, "computeRatioMax": 0.02100840336134454, "endMs": "1665776551766", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.01680672268907563, "readRatioMax": 0.01680672268907563, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776551734", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004201680672268907, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "5", "computeMsAvg": "73", "computeMsMax": "98", "computeRatioAvg": 0.15336134453781514, "computeRatioMax": 0.20588235294117646, "endMs": "1665776551852", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "12", "readRatioAvg": 0.018907563025210083, "readRatioMax": 0.025210084033613446, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "607", "startMs": "1665776551782", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.014705882352941176, "writeRatioMax": 0.018907563025210083 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.01680672268907563, "computeRatioMax": 0.029411764705882353, "endMs": "1665776551910", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "5159", "startMs": "1665776551860", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.004201680672268907, "writeMsAvg": "15", "writeMsMax": "17", "writeRatioAvg": 0.031512605042016806, "writeRatioMax": 0.03571428571428571 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.04411764705882353, "computeRatioMax": 0.04411764705882353, "endMs": "1665776551925", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776551874", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.0063025210084033615, "writeRatioMax": 0.0063025210084033615 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.023109243697478993, "computeRatioMax": 0.023109243697478993, "endMs": "1665776551987", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665776551951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.031512605042016806, "writeRatioMax": 0.031512605042016806 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.018907563025210083, "computeRatioMax": 0.018907563025210083, "endMs": "1665776552030", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776551999", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02100840336134454, "computeRatioMax": 0.02100840336134454, "endMs": "1665776552052", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665776552013", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021008403361344537, "waitRatioMax": 0.0021008403361344537, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.014705882352941176, "writeRatioMax": 0.014705882352941176 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "210", "elapsedMs": "652", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "11843" }, { "activeUnits": "2", "completedUnits": "423", "elapsedMs": "1224", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "23463" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "23463", "transferredBytes": "0" }, "startTime": "1665776550870", "totalBytesProcessed": "211635233", "totalSlotMs": "23463" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon493c16ed_c3fb_45b3_82a5_e18d2caf2436" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NBDgiKX/I72bNlppXWUHxQ==", "id": "test-project-364309:europe-west1.query10_1665776553", "jobReference": { "jobId": "query10_1665776553", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776553?location=europe-west1", "statistics": { "creationTime": "1665776553773", "endTime": "1665776555184", "finalExecutionDurationMs": "1133", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1093" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03597122302158273, "computeRatioMax": 0.03597122302158273, "endMs": "1665776554021", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02158273381294964, "readRatioMax": 0.02158273381294964, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665776553984", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.04316546762589928, "writeRatioMax": 0.04316546762589928 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.05755395683453238, "endMs": "1665776554123", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02877697841726619, "readRatioMax": 0.02877697841726619, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776554078", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "36", "waitMsMax": "36", "waitRatioAvg": 0.12949640287769784, "waitRatioMax": 0.12949640287769784, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0539568345323741, "writeRatioMax": 0.0539568345323741 }, { "completedParallelInputs": "6", "computeMsAvg": "94", "computeMsMax": "111", "computeRatioAvg": 0.3381294964028777, "computeRatioMax": 0.39928057553956836, "endMs": "1665776554160", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "8", "readMsMax": "10", "readRatioAvg": 0.02877697841726619, "readRatioMax": 0.03597122302158273, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "734", "startMs": "1665776554084", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.02877697841726619, "writeRatioMax": 0.03237410071942446 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.1079136690647482, "computeRatioMax": 0.1079136690647482, "endMs": "1665776554181", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.025179856115107913, "readRatioMax": 0.025179856115107913, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776554147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02877697841726619, "writeRatioMax": 0.02877697841726619 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.02877697841726619, "computeRatioMax": 0.06115107913669065, "endMs": "1665776554245", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "5789", "startMs": "1665776554190", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.017985611510791366, "writeMsAvg": "20", "writeMsMax": "32", "writeRatioAvg": 0.07194244604316546, "writeRatioMax": 0.11510791366906475 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.03237410071942446, "computeRatioMax": 0.0539568345323741, "endMs": "1665776554259", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "5745", "startMs": "1665776554191", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.01079136690647482, "waitRatioMax": 0.017985611510791366, "writeMsAvg": "17", "writeMsMax": "36", "writeRatioAvg": 0.06115107913669065, "writeRatioMax": 0.12949640287769784 }, { "completedParallelInputs": "1", "computeMsAvg": "278", "computeMsMax": "278", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776554422", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.03237410071942446, "readRatioMax": 0.03237410071942446, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "250", "startMs": "1665776554203", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.02158273381294964, "waitRatioMax": 0.02158273381294964, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.014388489208633094, "writeRatioMax": 0.014388489208633094 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03597122302158273, "computeRatioMax": 0.03597122302158273, "endMs": "1665776554501", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02158273381294964, "readRatioMax": 0.02158273381294964, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "77", "startMs": "1665776554458", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.10071942446043165, "writeRatioMax": 0.10071942446043165 }, { "completedParallelInputs": "1", "computeMsAvg": "92", "computeMsMax": "92", "computeRatioAvg": 0.33093525179856115, "computeRatioMax": 0.33093525179856115, "endMs": "1665776554600", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.017985611510791366, "readRatioMax": 0.017985611510791366, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "143", "startMs": "1665776554537", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.025179856115107913, "writeRatioMax": 0.025179856115107913 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.03237410071942446, "computeRatioMax": 0.05755395683453238, "endMs": "1665776554672", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "5959", "startMs": "1665776554609", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.01079136690647482, "writeMsAvg": "16", "writeMsMax": "30", "writeRatioAvg": 0.05755395683453238, "writeRatioMax": 0.1079136690647482 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.07194244604316546, "computeRatioMax": 0.07194244604316546, "endMs": "1665776554685", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776554614", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.007194244604316547, "writeRatioMax": 0.007194244604316547 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.046762589928057555, "computeRatioMax": 0.046762589928057555, "endMs": "1665776554777", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.02877697841726619, "readRatioMax": 0.02877697841726619, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665776554731", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05755395683453238, "writeRatioMax": 0.05755395683453238 }, { "completedParallelInputs": "5", "computeMsAvg": "68", "computeMsMax": "90", "computeRatioAvg": 0.2446043165467626, "computeRatioMax": 0.3237410071942446, "endMs": "1665776554867", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "15", "readRatioAvg": 0.04316546762589928, "readRatioMax": 0.0539568345323741, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "499", "startMs": "1665776554802", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.02877697841726619, "writeRatioMax": 0.03237410071942446 }, { "completedParallelInputs": "100", "computeMsAvg": "10", "computeMsMax": "21", "computeRatioAvg": 0.03597122302158273, "computeRatioMax": 0.07553956834532374, "endMs": "1665776554927", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "5223", "startMs": "1665776554874", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "15", "writeMsMax": "24", "writeRatioAvg": 0.0539568345323741, "writeRatioMax": 0.08633093525179857 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.07913669064748201, "computeRatioMax": 0.07913669064748201, "endMs": "1665776554952", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776554888", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.014388489208633094, "writeRatioMax": 0.014388489208633094 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03237410071942446, "computeRatioMax": 0.03237410071942446, "endMs": "1665776555013", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776554976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0539568345323741, "writeRatioMax": 0.0539568345323741 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.025179856115107913, "computeRatioMax": 0.025179856115107913, "endMs": "1665776555064", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665776555027", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0539568345323741, "writeRatioMax": 0.0539568345323741 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0539568345323741, "computeRatioMax": 0.0539568345323741, "endMs": "1665776555083", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776555048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03237410071942446, "writeRatioMax": 0.03237410071942446 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "210", "elapsedMs": "652", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "12702" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1294", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "24932" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "24932", "transferredBytes": "0" }, "startTime": "1665776553833", "totalBytesProcessed": "211635233", "totalSlotMs": "24932" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbe72b835_cf99_42d6_ae38_b424b8717ad6" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "PJlhQLchPrfAHOsMCrK4Fg==", "id": "test-project-364309:europe-west1.query10_1665776803", "jobReference": { "jobId": "query10_1665776803", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776803?location=europe-west1", "statistics": { "creationTime": "1665776804001", "endTime": "1665776805409", "finalExecutionDurationMs": "1138", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1094" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03713527851458886, "computeRatioMax": 0.03713527851458886, "endMs": "1665776804241", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015915119363395226, "readRatioMax": 0.015915119363395226, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776804214", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002652519893899204, "waitRatioMax": 0.002652519893899204, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.034482758620689655, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026525198938992044, "computeRatioMax": 0.026525198938992044, "endMs": "1665776804299", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015915119363395226, "readRatioMax": 0.015915119363395226, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776804259", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005305039787798408, "waitRatioMax": 0.005305039787798408, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.034482758620689655, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "6", "computeMsAvg": "80", "computeMsMax": "106", "computeRatioAvg": 0.21220159151193635, "computeRatioMax": 0.28116710875331563, "endMs": "1665776804361", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.026525198938992044, "readRatioMax": 0.03183023872679045, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "439", "startMs": "1665776804285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002652519893899204, "waitRatioMax": 0.002652519893899204, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01856763925729443, "writeRatioMax": 0.01856763925729443 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.0610079575596817, "computeRatioMax": 0.0610079575596817, "endMs": "1665776804351", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.010610079575596816, "readRatioMax": 0.010610079575596816, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776804316", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002652519893899204, "waitRatioMax": 0.002652519893899204, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01856763925729443, "writeRatioMax": 0.01856763925729443 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.021220159151193633, "computeRatioMax": 0.042440318302387266, "endMs": "1665776804409", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "2727", "startMs": "1665776804363", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.005305039787798408, "waitRatioMax": 0.013262599469496022, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.03713527851458886, "writeRatioMax": 0.04509283819628647 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.021220159151193633, "computeRatioMax": 0.042440318302387266, "endMs": "1665776804415", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "2721", "startMs": "1665776804364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "7", "waitRatioAvg": 0.007957559681697613, "waitRatioMax": 0.01856763925729443, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.03713527851458886, "writeRatioMax": 0.050397877984084884 }, { "completedParallelInputs": "1", "computeMsAvg": "377", "computeMsMax": "377", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776804661", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.04509283819628647, "readRatioMax": 0.04509283819628647, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "361", "startMs": "1665776804371", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.01856763925729443, "waitRatioMax": 0.01856763925729443, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010610079575596816, "writeRatioMax": 0.010610079575596816 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01856763925729443, "computeRatioMax": 0.01856763925729443, "endMs": "1665776804793", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013262599469496022, "readRatioMax": 0.013262599469496022, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665776804765", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002652519893899204, "waitRatioMax": 0.002652519893899204, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.042440318302387266, "writeRatioMax": 0.042440318302387266 }, { "completedParallelInputs": "1", "computeMsAvg": "109", "computeMsMax": "109", "computeRatioAvg": 0.2891246684350133, "computeRatioMax": 0.2891246684350133, "endMs": "1665776804891", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.029177718832891247, "readRatioMax": 0.029177718832891247, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "114", "startMs": "1665776804808", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005305039787798408, "waitRatioMax": 0.005305039787798408, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.026525198938992044, "writeRatioMax": 0.026525198938992044 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "26", "computeRatioAvg": 0.023872679045092837, "computeRatioMax": 0.06896551724137931, "endMs": "1665776804966", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "3702", "startMs": "1665776804912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.002652519893899204, "waitRatioMax": 0.007957559681697613, "writeMsAvg": "21", "writeMsMax": "29", "writeRatioAvg": 0.05570291777188329, "writeRatioMax": 0.07692307692307693 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.0610079575596817, "computeRatioMax": 0.0610079575596817, "endMs": "1665776804985", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665776804917", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005305039787798408, "waitRatioMax": 0.005305039787798408, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007957559681697613, "writeRatioMax": 0.007957559681697613 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026525198938992044, "computeRatioMax": 0.026525198938992044, "endMs": "1665776805044", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01856763925729443, "readRatioMax": 0.01856763925729443, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776805008", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005305039787798408, "waitRatioMax": 0.005305039787798408, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.029177718832891247, "writeRatioMax": 0.029177718832891247 }, { "completedParallelInputs": "5", "computeMsAvg": "59", "computeMsMax": "70", "computeRatioAvg": 0.15649867374005305, "computeRatioMax": 0.1856763925729443, "endMs": "1665776805137", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "16", "readRatioAvg": 0.029177718832891247, "readRatioMax": 0.042440318302387266, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "362", "startMs": "1665776805068", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002652519893899204, "waitRatioMax": 0.002652519893899204, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.021220159151193633, "writeRatioMax": 0.026525198938992044 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.021220159151193633, "computeRatioMax": 0.05305039787798409, "endMs": "1665776805193", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "3227", "startMs": "1665776805142", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "6", "waitRatioAvg": 0.005305039787798408, "waitRatioMax": 0.015915119363395226, "writeMsAvg": "15", "writeMsMax": "22", "writeRatioAvg": 0.03978779840848806, "writeRatioMax": 0.058355437665782495 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.06896551724137931, "computeRatioMax": 0.06896551724137931, "endMs": "1665776805211", "id": "19", "inputStages": [ "14", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776805155", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005305039787798408, "waitRatioMax": 0.005305039787798408, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010610079575596816, "writeRatioMax": 0.010610079575596816 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.026525198938992044, "computeRatioMax": 0.026525198938992044, "endMs": "1665776805272", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776805236", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005305039787798408, "waitRatioMax": 0.005305039787798408, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07161803713527852, "writeRatioMax": 0.07161803713527852 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01856763925729443, "computeRatioMax": 0.01856763925729443, "endMs": "1665776805312", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776805277", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002652519893899204, "waitRatioMax": 0.002652519893899204, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03713527851458886, "writeRatioMax": 0.03713527851458886 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.023872679045092837, "computeRatioMax": 0.023872679045092837, "endMs": "1665776805319", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776805290", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002652519893899204, "waitRatioMax": 0.002652519893899204, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01856763925729443, "writeRatioMax": 0.01856763925729443 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "210", "elapsedMs": "655", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6342" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1294", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13892" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "13892", "transferredBytes": "0" }, "startTime": "1665776804060", "totalBytesProcessed": "211635233", "totalSlotMs": "13892" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone5f85268_7fec_469f_a22d_dc1423500aab" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "JoyBR44QmapLrvon0uPdDg==", "id": "test-project-364309:europe-west1.query10_1665776807", "jobReference": { "jobId": "query10_1665776807", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776807?location=europe-west1", "statistics": { "creationTime": "1665776808073", "endTime": "1665776809558", "finalExecutionDurationMs": "1216", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1094" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03631961259079903, "computeRatioMax": 0.03631961259079903, "endMs": "1665776808301", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.01937046004842615, "readRatioMax": 0.01937046004842615, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776808273", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.021791767554479417, "writeRatioMax": 0.021791767554479417 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.0387409200968523, "computeRatioMax": 0.0387409200968523, "endMs": "1665776808339", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.024213075060532687, "readRatioMax": 0.024213075060532687, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776808309", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.021791767554479417, "writeRatioMax": 0.021791767554479417 }, { "completedParallelInputs": "6", "computeMsAvg": "81", "computeMsMax": "95", "computeRatioAvg": 0.19612590799031476, "computeRatioMax": 0.23002421307506055, "endMs": "1665776808432", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "16", "readRatioAvg": 0.026634382566585957, "readRatioMax": 0.0387409200968523, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "495", "startMs": "1665776808334", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "11", "writeMsMax": "31", "writeRatioAvg": 0.026634382566585957, "writeRatioMax": 0.07506053268765134 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.07021791767554479, "computeRatioMax": 0.07021791767554479, "endMs": "1665776808391", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01694915254237288, "readRatioMax": 0.01694915254237288, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776808362", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.01937046004842615, "computeRatioMax": 0.0387409200968523, "endMs": "1665776808445", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "3575", "startMs": "1665776808396", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004842615012106538, "waitRatioMax": 0.007263922518159807, "writeMsAvg": "21", "writeMsMax": "30", "writeRatioAvg": 0.05084745762711865, "writeRatioMax": 0.07263922518159806 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.01937046004842615, "computeRatioMax": 0.0387409200968523, "endMs": "1665776808487", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "2513", "startMs": "1665776808434", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.007263922518159807, "waitRatioMax": 0.009685230024213076, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.03389830508474576, "writeRatioMax": 0.06295399515738499 }, { "completedParallelInputs": "1", "computeMsAvg": "413", "computeMsMax": "413", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776808773", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.031476997578692496, "readRatioMax": 0.031476997578692496, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "403", "startMs": "1665776808440", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004842615012106538, "waitRatioMax": 0.004842615012106538, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.01937046004842615, "computeRatioMax": 0.01937046004842615, "endMs": "1665776808892", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.012106537530266344, "readRatioMax": 0.012106537530266344, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665776808854", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.031476997578692496, "writeRatioMax": 0.031476997578692496 }, { "completedParallelInputs": "1", "computeMsAvg": "107", "computeMsMax": "107", "computeRatioAvg": 0.25907990314769974, "computeRatioMax": 0.25907990314769974, "endMs": "1665776809022", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.04600484261501211, "readRatioMax": 0.04600484261501211, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "136", "startMs": "1665776808917", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.026634382566585957, "writeRatioMax": 0.026634382566585957 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.01937046004842615, "computeRatioMax": 0.0387409200968523, "endMs": "1665776809073", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "2829", "startMs": "1665776809025", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.004842615012106538, "writeMsAvg": "14", "writeMsMax": "22", "writeRatioAvg": 0.03389830508474576, "writeRatioMax": 0.053268765133171914 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.04600484261501211, "computeRatioMax": 0.04600484261501211, "endMs": "1665776809098", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665776809029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007263922518159807, "waitRatioMax": 0.007263922518159807, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007263922518159807, "writeRatioMax": 0.007263922518159807 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.029055690072639227, "computeRatioMax": 0.029055690072639227, "endMs": "1665776809153", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01694915254237288, "readRatioMax": 0.01694915254237288, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776809119", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.01937046004842615, "writeRatioMax": 0.01937046004842615 }, { "completedParallelInputs": "5", "computeMsAvg": "72", "computeMsMax": "108", "computeRatioAvg": 0.17433414043583534, "computeRatioMax": 0.26150121065375304, "endMs": "1665776809260", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "12", "readRatioAvg": 0.024213075060532687, "readRatioMax": 0.029055690072639227, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "396", "startMs": "1665776809178", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "8", "writeMsMax": "12", "writeRatioAvg": 0.01937046004842615, "writeRatioMax": 0.029055690072639227 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.01937046004842615, "computeRatioMax": 0.04600484261501211, "endMs": "1665776809317", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "3072", "startMs": "1665776809266", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.004842615012106538, "waitRatioMax": 0.007263922518159807, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.03631961259079903, "writeRatioMax": 0.04600484261501211 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.07021791767554479, "computeRatioMax": 0.07021791767554479, "endMs": "1665776809347", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776809279", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004842615012106538, "waitRatioMax": 0.004842615012106538, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.021791767554479417, "writeRatioMax": 0.021791767554479417 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.026634382566585957, "computeRatioMax": 0.026634382566585957, "endMs": "1665776809410", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776809375", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03389830508474576, "writeRatioMax": 0.03389830508474576 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.021791767554479417, "computeRatioMax": 0.021791767554479417, "endMs": "1665776809445", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665776809421", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.029055690072639227, "writeRatioMax": 0.029055690072639227 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03389830508474576, "computeRatioMax": 0.03389830508474576, "endMs": "1665776809461", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776809432", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002421307506053269, "waitRatioMax": 0.002421307506053269, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0387409200968523, "writeRatioMax": 0.0387409200968523 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "632", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6834" }, { "activeUnits": "100", "completedUnits": "423", "elapsedMs": "1357", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "13761" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "13761", "transferredBytes": "0" }, "startTime": "1665776808142", "totalBytesProcessed": "211635233", "totalSlotMs": "13761" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonbb021cda_3f71_458a_8236_653f56d9eada" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "kzfapNEjx0WX372qGwdHxw==", "id": "test-project-364309:europe-west1.query10_1665776811", "jobReference": { "jobId": "query10_1665776811", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776811?location=europe-west1", "statistics": { "creationTime": "1665776812093", "endTime": "1665776813493", "finalExecutionDurationMs": "1120", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1096" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.023195876288659795, "computeRatioMax": 0.023195876288659795, "endMs": "1665776812334", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01804123711340206, "readRatioMax": 0.01804123711340206, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776812301", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01804123711340206, "writeRatioMax": 0.01804123711340206 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02577319587628866, "computeRatioMax": 0.02577319587628866, "endMs": "1665776812379", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015463917525773196, "readRatioMax": 0.015463917525773196, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776812343", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.03350515463917526, "writeRatioMax": 0.03350515463917526 }, { "completedParallelInputs": "6", "computeMsAvg": "82", "computeMsMax": "110", "computeRatioAvg": 0.211340206185567, "computeRatioMax": 0.28350515463917525, "endMs": "1665776812444", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "8", "readMsMax": "10", "readRatioAvg": 0.020618556701030927, "readRatioMax": 0.02577319587628866, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "457", "startMs": "1665776812372", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.015463917525773196, "writeRatioMax": 0.01804123711340206 }, { "completedParallelInputs": "1", "computeMsAvg": "32", "computeMsMax": "32", "computeRatioAvg": 0.08247422680412371, "computeRatioMax": 0.08247422680412371, "endMs": "1665776812438", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01804123711340206, "readRatioMax": 0.01804123711340206, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776812405", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.015463917525773196, "writeRatioMax": 0.015463917525773196 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.01804123711340206, "computeRatioMax": 0.041237113402061855, "endMs": "1665776812498", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "3175", "startMs": "1665776812444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.01288659793814433, "writeMsAvg": "14", "writeMsMax": "28", "writeRatioAvg": 0.03608247422680412, "writeRatioMax": 0.07216494845360824 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.020618556701030927, "computeRatioMax": 0.041237113402061855, "endMs": "1665776812507", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "3503", "startMs": "1665776812450", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.010309278350515464, "writeMsAvg": "15", "writeMsMax": "20", "writeRatioAvg": 0.03865979381443299, "writeRatioMax": 0.05154639175257732 }, { "completedParallelInputs": "1", "computeMsAvg": "388", "computeMsMax": "388", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776812715", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.03350515463917526, "readRatioMax": 0.03350515463917526, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "319", "startMs": "1665776812456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007731958762886598, "waitRatioMax": 0.007731958762886598, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010309278350515464, "writeRatioMax": 0.010309278350515464 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.020618556701030927, "computeRatioMax": 0.020618556701030927, "endMs": "1665776812833", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01288659793814433, "readRatioMax": 0.01288659793814433, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776812795", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03608247422680412, "writeRatioMax": 0.03608247422680412 }, { "completedParallelInputs": "1", "computeMsAvg": "75", "computeMsMax": "75", "computeRatioAvg": 0.19329896907216496, "computeRatioMax": 0.19329896907216496, "endMs": "1665776812925", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.03865979381443299, "readRatioMax": 0.03865979381443299, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "90", "startMs": "1665776812853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.023195876288659795, "writeRatioMax": 0.023195876288659795 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.023195876288659795, "computeRatioMax": 0.04381443298969072, "endMs": "1665776813003", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "3698", "startMs": "1665776812946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.005154639175257732, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.03865979381443299, "writeRatioMax": 0.06958762886597938 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.059278350515463915, "computeRatioMax": 0.059278350515463915, "endMs": "1665776813018", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776812951", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.01288659793814433, "waitRatioMax": 0.01288659793814433, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010309278350515464, "writeRatioMax": 0.010309278350515464 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02577319587628866, "computeRatioMax": 0.02577319587628866, "endMs": "1665776813094", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020618556701030927, "readRatioMax": 0.020618556701030927, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776813058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.020618556701030927, "writeRatioMax": 0.020618556701030927 }, { "completedParallelInputs": "5", "computeMsAvg": "62", "computeMsMax": "82", "computeRatioAvg": 0.15979381443298968, "computeRatioMax": 0.211340206185567, "endMs": "1665776813196", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.02577319587628866, "readRatioMax": 0.03350515463917526, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "349", "startMs": "1665776813122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.020618556701030927, "writeRatioMax": 0.023195876288659795 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.023195876288659795, "computeRatioMax": 0.04639175257731959, "endMs": "1665776813256", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "3356", "startMs": "1665776813199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005154639175257732, "waitRatioMax": 0.007731958762886598, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.03865979381443299, "writeRatioMax": 0.07216494845360824 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.059278350515463915, "computeRatioMax": 0.059278350515463915, "endMs": "1665776813268", "id": "19", "inputStages": [ "14", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776813212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.007731958762886598, "waitRatioMax": 0.007731958762886598, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007731958762886598, "writeRatioMax": 0.007731958762886598 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.020618556701030927, "computeRatioMax": 0.020618556701030927, "endMs": "1665776813332", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776813295", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.07474226804123711, "writeRatioMax": 0.07474226804123711 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.023195876288659795, "computeRatioMax": 0.023195876288659795, "endMs": "1665776813380", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776813343", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.07216494845360824, "writeRatioMax": 0.07216494845360824 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01804123711340206, "computeRatioMax": 0.01804123711340206, "endMs": "1665776813387", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776813358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002577319587628866, "waitRatioMax": 0.002577319587628866, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01804123711340206, "writeRatioMax": 0.01804123711340206 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "210", "elapsedMs": "648", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "7457" }, { "activeUnits": "1", "completedUnits": "423", "elapsedMs": "1277", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "15169" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "15169", "transferredBytes": "0" }, "startTime": "1665776812155", "totalBytesProcessed": "211635233", "totalSlotMs": "15169" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona1dfd5cf_d341_419b_9353_191aadd1ba60" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Pjt77Le/oHYnGdlkzoGHKA==", "id": "test-project-364309:europe-west1.query10_1665776815", "jobReference": { "jobId": "query10_1665776815", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776815?location=europe-west1", "statistics": { "creationTime": "1665776816264", "endTime": "1665776817704", "finalExecutionDurationMs": "1150", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1096" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.034031413612565446, "computeRatioMax": 0.034031413612565446, "endMs": "1665776816532", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01832460732984293, "readRatioMax": 0.01832460732984293, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776816494", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.020942408376963352, "writeRatioMax": 0.020942408376963352 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.028795811518324606, "computeRatioMax": 0.028795811518324606, "endMs": "1665776816595", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013089005235602094, "readRatioMax": 0.013089005235602094, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776816556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "17", "waitMsMax": "17", "waitRatioAvg": 0.04450261780104712, "waitRatioMax": 0.04450261780104712, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03664921465968586, "writeRatioMax": 0.03664921465968586 }, { "completedParallelInputs": "6", "computeMsAvg": "75", "computeMsMax": "95", "computeRatioAvg": 0.19633507853403143, "computeRatioMax": 0.2486910994764398, "endMs": "1665776816645", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "14", "readRatioAvg": 0.02617801047120419, "readRatioMax": 0.03664921465968586, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "461", "startMs": "1665776816572", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.01832460732984293, "writeRatioMax": 0.020942408376963352 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.0549738219895288, "computeRatioMax": 0.0549738219895288, "endMs": "1665776816659", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013089005235602094, "readRatioMax": 0.013089005235602094, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776816620", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01832460732984293, "writeRatioMax": 0.01832460732984293 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.020942408376963352, "computeRatioMax": 0.034031413612565446, "endMs": "1665776816718", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "2942", "startMs": "1665776816664", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "8", "waitRatioAvg": 0.005235602094240838, "waitRatioMax": 0.020942408376963352, "writeMsAvg": "21", "writeMsMax": "31", "writeRatioAvg": 0.0549738219895288, "writeRatioMax": 0.08115183246073299 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "18", "computeRatioAvg": 0.01832460732984293, "computeRatioMax": 0.04712041884816754, "endMs": "1665776816726", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "2767", "startMs": "1665776816665", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.015706806282722512, "waitRatioMax": 0.020942408376963352, "writeMsAvg": "17", "writeMsMax": "45", "writeRatioAvg": 0.04450261780104712, "writeRatioMax": 0.11780104712041885 }, { "completedParallelInputs": "1", "computeMsAvg": "382", "computeMsMax": "382", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776816957", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03664921465968586, "readRatioMax": 0.03664921465968586, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "380", "startMs": "1665776816674", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.02356020942408377, "waitRatioMax": 0.02356020942408377, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01832460732984293, "writeRatioMax": 0.01832460732984293 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.034031413612565446, "computeRatioMax": 0.034031413612565446, "endMs": "1665776817010", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020942408376963352, "readRatioMax": 0.020942408376963352, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776816976", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.020942408376963352, "writeRatioMax": 0.020942408376963352 }, { "completedParallelInputs": "1", "computeMsAvg": "81", "computeMsMax": "81", "computeRatioAvg": 0.21204188481675393, "computeRatioMax": 0.21204188481675393, "endMs": "1665776817092", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.015706806282722512, "readRatioMax": 0.015706806282722512, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665776817031", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01832460732984293, "writeRatioMax": 0.01832460732984293 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.01832460732984293, "computeRatioMax": 0.034031413612565446, "endMs": "1665776817175", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "3254", "startMs": "1665776817097", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005235602094240838, "waitRatioMax": 0.007853403141361256, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.034031413612565446, "writeRatioMax": 0.049738219895287955 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.041884816753926704, "computeRatioMax": 0.041884816753926704, "endMs": "1665776817167", "id": "14", "inputStages": [ "9", "13" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665776817103", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.010471204188481676, "waitRatioMax": 0.010471204188481676, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.005235602094240838, "writeRatioMax": 0.005235602094240838 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.028795811518324606, "computeRatioMax": 0.028795811518324606, "endMs": "1665776817235", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.020942408376963352, "readRatioMax": 0.020942408376963352, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776817195", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02356020942408377, "writeRatioMax": 0.02356020942408377 }, { "completedParallelInputs": "5", "computeMsAvg": "60", "computeMsMax": "65", "computeRatioAvg": 0.15706806282722513, "computeRatioMax": 0.17015706806282724, "endMs": "1665776817358", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.02617801047120419, "readRatioMax": 0.034031413612565446, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "370", "startMs": "1665776817257", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.005235602094240838, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.015706806282722512, "writeRatioMax": 0.020942408376963352 }, { "completedParallelInputs": "99", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.020942408376963352, "computeRatioMax": 0.041884816753926704, "endMs": "1665776817466", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "53547", "recordsWritten": "53547", "shuffleOutputBytes": "963846", "shuffleOutputBytesSpilled": "0", "slotMs": "3818", "startMs": "1665776817370", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005235602094240838, "waitRatioMax": 0.007853403141361256, "writeMsAvg": "15", "writeMsMax": "50", "writeRatioAvg": 0.03926701570680628, "writeRatioMax": 0.13089005235602094 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.07591623036649214, "computeRatioMax": 0.07591623036649214, "endMs": "1665776817453", "id": "19", "inputStages": [ "14", "18" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776817385", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.010471204188481676, "waitRatioMax": 0.010471204188481676, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.007853403141361256, "writeRatioMax": 0.007853403141361256 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02356020942408377, "computeRatioMax": 0.02356020942408377, "endMs": "1665776817539", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776817482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.0549738219895288, "writeRatioMax": 0.0549738219895288 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01832460732984293, "computeRatioMax": 0.01832460732984293, "endMs": "1665776817590", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776817555", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.041884816753926704, "writeRatioMax": 0.041884816753926704 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01832460732984293, "computeRatioMax": 0.01832460732984293, "endMs": "1665776817609", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776817568", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002617801047120419, "waitRatioMax": 0.002617801047120419, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.015706806282722512, "writeRatioMax": 0.015706806282722512 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "210", "elapsedMs": "644", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "6579" }, { "activeUnits": "1", "completedUnits": "422", "elapsedMs": "1295", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "14416" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "14416", "transferredBytes": "0" }, "startTime": "1665776816351", "totalBytesProcessed": "211635233", "totalSlotMs": "14416" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon26b5cb7a_38c8_4a07_b271_d623cedcbf8e" }, "priority": "INTERACTIVE", "query": "-- start query 10 in stream 0 using template query10.tpl\nselect\n cd_gender,\n cd_marital_status,\n cd_education_status,\n count(*) cnt1,\n cd_purchase_estimate,\n count(*) cnt2,\n cd_credit_rating,\n count(*) cnt3,\n cd_dep_count,\n count(*) cnt4,\n cd_dep_employed_count,\n count(*) cnt5,\n cd_dep_college_count,\n count(*) cnt6\n from\n customer c,customer_address ca,customer_demographics\n where\n c.c_current_addr_sk = ca.ca_address_sk and\n ca_county in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') and\n cd_demo_sk = c.c_current_cdemo_sk and \n exists (select *\n from store_sales,date_dim\n where c.c_customer_sk = ss_customer_sk and\n ss_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3) and\n (exists (select *\n from web_sales,date_dim\n where c.c_customer_sk = ws_bill_customer_sk and\n ws_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 ANd 1+3) or \n exists (select benchmark.sh benchmark_938pm.sh benchmark_alaa.sh json_bq_result_per_query queries query query_alaa query_not_for_benchmarking query_results query_results_alaa results tmp validation_set_tmp \n from catalog_sales,date_dim\n where c.c_customer_sk = cs_ship_customer_sk and\n cs_sold_date_sk = d_date_sk and\n d_year = 2002 and\n d_moy between 1 and 1+3))\n group by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\n order by cd_gender,\n cd_marital_status,\n cd_education_status,\n cd_purchase_estimate,\n cd_credit_rating,\n cd_dep_count,\n cd_dep_employed_count,\n cd_dep_college_count\nlimit 100\n;\n\n-- end query 10 in stream 0 using template query10.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8TkmK12f0huSeTDh/SeolQ==", "id": "test-project-364309:europe-west1.query10_1665776818", "jobReference": { "jobId": "query10_1665776818", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query10_1665776818?location=europe-west1", "statistics": { "creationTime": "1665776819416", "endTime": "1665776820829", "finalExecutionDurationMs": "1110", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "211635233", "performanceInsights": { "avgPreviousExecutionMs": "1097" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.027491408934707903, "computeRatioMax": 0.027491408934707903, "endMs": "1665776819676", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020618556701030927, "readRatioMax": 0.020618556701030927, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776819638", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_year, $62:d_moy", "FROM date_dim", "WHERE and(equal($61, 2002), between($62, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.048109965635738834, "writeRatioMax": 0.048109965635738834 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.041237113402061855, "endMs": "1665776819713", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01718213058419244, "readRatioMax": 0.01718213058419244, "recordsRead": "50000", "recordsWritten": "459", "shuffleOutputBytes": "4131", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776819676", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:ca_address_sk, $81:ca_county", "FROM customer_address", "WHERE in($81, 'Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006872852233676976, "waitRatioMax": 0.006872852233676976, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.044673539518900345, "writeRatioMax": 0.044673539518900345 }, { "completedParallelInputs": "6", "computeMsAvg": "84", "computeMsMax": "107", "computeRatioAvg": 0.28865979381443296, "computeRatioMax": 0.36769759450171824, "endMs": "1665776819839", "id": "5", "inputStages": [ "0" ], "name": "S05: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "13", "readRatioAvg": 0.037800687285223365, "readRatioMax": 0.044673539518900345, "recordsRead": "2881124", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "581", "startMs": "1665776819699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:ss_sold_date_sk, $51:ss_customer_sk", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage00_output" ] }, { "kind": "JOIN", "substeps": [ "$320 := $51, $321 := $280", "INNER HASH JOIN EACH WITH ALL ON $50 = $60" ] }, { "kind": "COMPUTE", "substeps": [ "$280 := 1" ] }, { "kind": "WRITE", "substeps": [ "$320, $321", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.030927835051546393, "writeRatioMax": 0.030927835051546393 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.09965635738831616, "computeRatioMax": 0.09965635738831616, "endMs": "1665776819769", "id": "6", "inputStages": [ "3" ], "name": "S06: Join", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020618556701030927, "readRatioMax": 0.020618556701030927, "recordsRead": "100459", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776819736", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:c_customer_sk, $71:c_current_cdemo_sk, $72:c_current_addr_sk", "FROM customer" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage03_output" ] }, { "kind": "JOIN", "substeps": [ "$290 := $70, $291 := $71", "INNER HASH JOIN EACH WITH ALL ON $72 = $80" ] }, { "kind": "WRITE", "substeps": [ "$290, $291", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.024054982817869417, "writeRatioMax": 0.024054982817869417 }, { "completedParallelInputs": "100", "computeMsAvg": "6", "computeMsMax": "11", "computeRatioAvg": 0.020618556701030927, "computeRatioMax": 0.037800687285223365, "endMs": "1665776819828", "id": "7", "inputStages": [ "6" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "897", "recordsWritten": "897", "shuffleOutputBytes": "16146", "shuffleOutputBytesSpilled": "0", "slotMs": "3151", "startMs": "1665776819782", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.010309278350515464, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.044673539518900345, "writeRatioMax": 0.061855670103092786 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.030927835051546393, "computeRatioMax": 0.061855670103092786, "endMs": "1665776819952", "id": "8", "inputStages": [ "5" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "106367", "recordsWritten": "106367", "shuffleOutputBytes": "1914606", "shuffleOutputBytesSpilled": "0", "slotMs": "3440", "startMs": "1665776819847", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "7", "waitRatioAvg": 0.006872852233676976, "waitRatioMax": 0.024054982817869417, "writeMsAvg": "12", "writeMsMax": "19", "writeRatioAvg": 0.041237113402061855, "writeRatioMax": 0.06529209621993128 }, { "completedParallelInputs": "1", "computeMsAvg": "291", "computeMsMax": "291", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776820144", "id": "9", "inputStages": [ "7", "8" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.041237113402061855, "readRatioMax": 0.041237113402061855, "recordsRead": "2028064", "recordsWritten": "897", "shuffleOutputBytes": "114372", "shuffleOutputBytesSpilled": "0", "slotMs": "253", "startMs": "1665776819853", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status, $44:cd_purchase_estimate, $45:cd_credit_rating, $46:cd_dep_count, $47:cd_dep_employed_count, $48:cd_dep_college_count", "FROM customer_demographics" ] }, { "kind": "READ", "substeps": [ "$290, $291", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$320, $321", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $350 := $339", "$250 := COUNT_STAR()", "$251 := ANY_VALUE($338)", "$252 := ANY_VALUE($337)", "$253 := ANY_VALUE($336)", "$254 := ANY_VALUE($335)", "$255 := ANY_VALUE($334)", "$256 := ANY_VALUE($333)", "$257 := ANY_VALUE($332)", "$258 := ANY_VALUE($331)", "$259 := ANY_VALUE($330)", "$260 := SUM($340)" ] }, { "kind": "JOIN", "substeps": [ "$330 := $301, $331 := $302, $332 := $303, $333 := $304, $334 := $305, $335 := $306, $336 := $307, $337 := $308, $338 := $300, $339 := $270, $340 := $321", "LEFT OUTER HASH JOIN EACH WITH ALL ON $300 = $320" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := UNIQUE_ROW_ID()" ] }, { "kind": "JOIN", "substeps": [ "$301 := $41, $302 := $42, $303 := $43, $304 := $44, $305 := $45, $306 := $46, $307 := $47, $308 := $48, $300 := $290", "INNER HASH JOIN EACH WITH ALL ON $40 = $291" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "TO __stage09_output", "BY HASH($350)" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.027491408934707903, "waitRatioMax": 0.027491408934707903, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010309278350515464, "writeRatioMax": 0.010309278350515464 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.048109965635738834, "computeRatioMax": 0.048109965635738834, "endMs": "1665776820197", "id": "10", "name": "S0A: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.030927835051546393, "readRatioMax": 0.030927835051546393, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776820165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year, $32:d_moy", "FROM date_dim", "WHERE and(equal($31, 2002), between($32, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.037800687285223365, "writeRatioMax": 0.037800687285223365 }, { "completedParallelInputs": "1", "computeMsAvg": "71", "computeMsMax": "71", "computeRatioAvg": 0.24398625429553264, "computeRatioMax": 0.24398625429553264, "endMs": "1665776820275", "id": "12", "inputStages": [ "10" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.020618556701030927, "readRatioMax": 0.020618556701030927, "recordsRead": "719504", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665776820214", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_bill_customer_sk", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage0A_output" ] }, { "kind": "JOIN", "substeps": [ "$370 := $21, $371 := $220", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "COMPUTE", "substeps": [ "$220 := 1" ] }, { "kind": "WRITE", "substeps": [ "$370, $371", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.027491408934707903, "writeRatioMax": 0.027491408934707903 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.027491408934707903, "computeRatioMax": 0.048109965635738834, "endMs": "1665776820343", "id": "13", "inputStages": [ "12" ], "name": "S0D: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "27784", "recordsWritten": "27784", "shuffleOutputBytes": "500112", "shuffleOutputBytesSpilled": "0", "slotMs": "3493", "startMs": "1665776820278", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006872852233676976, "waitRatioMax": 0.010309278350515464, "writeMsAvg": "16", "writeMsMax": "47", "writeRatioAvg": 0.054982817869415807, "writeRatioMax": 0.16151202749140894 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.058419243986254296, "computeRatioMax": 0.058419243986254296, "endMs": "1665776820360", "id": "14", "inputStages": [ "13", "9" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "28681", "recordsWritten": "92", "shuffleOutputBytes": "11566", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776820283", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $350", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$370, $371", "FROM __stage0D_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $380", "$190 := COUNT_STAR()", "$191 := ANY_VALUE($389)", "$192 := ANY_VALUE($388)", "$193 := ANY_VALUE($387)", "$194 := ANY_VALUE($386)", "$195 := ANY_VALUE($385)", "$196 := ANY_VALUE($384)", "$197 := ANY_VALUE($383)", "$198 := ANY_VALUE($382)", "$199 := ANY_VALUE($381)", "$200 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$380 := $210, $381 := $231, $382 := $232, $383 := $233, $384 := $234, $385 := $235, $386 := $236, $387 := $237, $388 := $238, $389 := $239, $390 := $371", "LEFT OUTER HASH JOIN EACH WITH ALL ON $231 = $370" ] }, { "kind": "COMPUTE", "substeps": [ "$210 := UNIQUE_ROW_ID()" ] }, { "kind": "FILTER", "substeps": [ "greater(if(is_null($240), 0, $230), 0)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $350", "$230 := SUM_OF_COUNTS($250)", "$231 := ANY_VALUE($251)", "$232 := ANY_VALUE($252)", "$233 := ANY_VALUE($253)", "$234 := ANY_VALUE($254)", "$235 := ANY_VALUE($255)", "$236 := ANY_VALUE($256)", "$237 := ANY_VALUE($257)", "$238 := ANY_VALUE($258)", "$239 := ANY_VALUE($259)", "$240 := SUM($260)" ] }, { "kind": "WRITE", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "TO __stage0E_output", "BY HASH($400)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010309278350515464, "waitRatioMax": 0.010309278350515464, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010309278350515464, "writeRatioMax": 0.010309278350515464 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03436426116838488, "computeRatioMax": 0.03436426116838488, "endMs": "1665776820427", "id": "15", "name": "S0F: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.024054982817869417, "readRatioMax": 0.024054982817869417, "recordsRead": "73049", "recordsWritten": "120", "shuffleOutputBytes": "1080", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776820397", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_year, $12:d_moy", "FROM date_dim", "WHERE and(equal($11, 2002), between($12, 1, 4))" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05154639175257732, "writeRatioMax": 0.05154639175257732 }, { "completedParallelInputs": "5", "computeMsAvg": "66", "computeMsMax": "99", "computeRatioAvg": 0.2268041237113402, "computeRatioMax": 0.3402061855670103, "endMs": "1665776820513", "id": "17", "inputStages": [ "15" ], "name": "S11: Join+", "parallelInputs": "5", "readMsAvg": "9", "readMsMax": "10", "readRatioAvg": 0.030927835051546393, "readRatioMax": 0.03436426116838488, "recordsRead": "1442148", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "358", "startMs": "1665776820443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:cs_sold_date_sk, $2:cs_ship_customer_sk", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage0F_output" ] }, { "kind": "JOIN", "substeps": [ "$420 := $2, $421 := $180", "INNER HASH JOIN EACH WITH ALL ON $1 = $10" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 1" ] }, { "kind": "WRITE", "substeps": [ "$420, $421", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.024054982817869417, "writeRatioMax": 0.027491408934707903 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.030927835051546393, "computeRatioMax": 0.05154639175257732, "endMs": "1665776820563", "id": "18", "inputStages": [ "17" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54219", "recordsWritten": "54219", "shuffleOutputBytes": "975942", "shuffleOutputBytesSpilled": "0", "slotMs": "3291", "startMs": "1665776820516", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.006872852233676976, "waitRatioMax": 0.013745704467353952, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.044673539518900345, "writeRatioMax": 0.06529209621993128 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.058419243986254296, "computeRatioMax": 0.058419243986254296, "endMs": "1665776820584", "id": "19", "inputStages": [ "18", "14" ], "name": "S13: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "54311", "recordsWritten": "92", "shuffleOutputBytes": "11574", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665776820529", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$190, $191, $192, $193, $194, $195, $196, $197, $198, $199, $200, $400", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$420, $421", "FROM __stage12_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $450 := $430", "$130 := COUNT_STAR()", "$131 := ANY_VALUE($439)", "$132 := ANY_VALUE($438)", "$133 := ANY_VALUE($437)", "$134 := ANY_VALUE($436)", "$135 := ANY_VALUE($435)", "$136 := ANY_VALUE($434)", "$137 := ANY_VALUE($433)", "$138 := ANY_VALUE($432)", "$139 := ANY_VALUE($431)", "$140 := SUM($440)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $150, $431 := $151, $432 := $161, $433 := $162, $434 := $163, $435 := $164, $436 := $165, $437 := $166, $438 := $167, $439 := $168, $440 := $421", "LEFT OUTER HASH JOIN EACH WITH ALL ON $169 = $420" ] }, { "kind": "COMPUTE", "substeps": [ "$150 := UNIQUE_ROW_ID()", "$151 := if(is_null($170), 0, $160)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$160 := SUM_OF_COUNTS($190)", "$161 := ANY_VALUE($191)", "$162 := ANY_VALUE($192)", "$163 := ANY_VALUE($193)", "$164 := ANY_VALUE($194)", "$165 := ANY_VALUE($195)", "$166 := ANY_VALUE($196)", "$167 := ANY_VALUE($197)", "$168 := ANY_VALUE($198)", "$169 := ANY_VALUE($199)", "$170 := SUM($200)" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "TO __stage13_output", "BY HASH($450)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006872852233676976, "waitRatioMax": 0.006872852233676976, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010309278350515464, "writeRatioMax": 0.010309278350515464 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.041237113402061855, "computeRatioMax": 0.041237113402061855, "endMs": "1665776820643", "id": "20", "inputStages": [ "19" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "92", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776820608", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135, $136, $137, $138, $139, $140, $450", "FROM __stage13_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $470 := $118, $471 := $117, $472 := $116, $473 := $115, $474 := $114, $475 := $113, $476 := $112, $477 := $111", "$100 := COUNT_STAR()" ] }, { "kind": "FILTER", "substeps": [ "or(greater($119, 0), greater(if(is_null($120), 0, $110), 0))" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $460 := $450", "$110 := SUM_OF_COUNTS($130)", "$111 := ANY_VALUE($131)", "$112 := ANY_VALUE($132)", "$113 := ANY_VALUE($133)", "$114 := ANY_VALUE($134)", "$115 := ANY_VALUE($135)", "$116 := ANY_VALUE($136)", "$117 := ANY_VALUE($137)", "$118 := ANY_VALUE($138)", "$119 := ANY_VALUE($139)", "$120 := SUM($140)" ] }, { "kind": "WRITE", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "TO __stage14_output", "BY HASH($470, $471, $472, $473, $474, $475, $476, $477)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.044673539518900345, "writeRatioMax": 0.044673539518900345 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.027491408934707903, "computeRatioMax": 0.027491408934707903, "endMs": "1665776820695", "id": "21", "inputStages": [ "20" ], "name": "S15: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776820659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $477, $476, $475, $474, $473, $472, $471, $470", "FROM __stage14_output" ] }, { "kind": "SORT", "substeps": [ "$480 ASC, $481 ASC, $482 ASC, $483 ASC, $484 ASC, $485 ASC, $486 ASC, $487 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $480 := $470, $481 := $471, $482 := $472, $483 := $473, $484 := $474, $485 := $475, $486 := $476, $487 := $477", "$90 := SUM_OF_COUNTS($100)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.048109965635738834, "writeRatioMax": 0.048109965635738834 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.024054982817869417, "computeRatioMax": 0.024054982817869417, "endMs": "1665776820712", "id": "22", "inputStages": [ "21" ], "name": "S16: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "5", "recordsWritten": "5", "shuffleOutputBytes": "410", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776820671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $493, $494, $495, $496, $497, $498", "FROM __stage15_output" ] }, { "kind": "SORT", "substeps": [ "$498 ASC, $497 ASC, $496 ASC, $495 ASC, $494 ASC, $493 ASC, $492 ASC, $491 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$500, $501, $502, $503, $504, $505, $506, $507, $508", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003436426116838488, "waitRatioMax": 0.003436426116838488, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.020618556701030927, "writeRatioMax": 0.020618556701030927 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_demographics" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "209", "elapsedMs": "647", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7134" }, { "activeUnits": "0", "completedUnits": "423", "elapsedMs": "1266", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "14805" } ], "totalBytesBilled": "211812352", "totalBytesProcessed": "211635233", "totalPartitionsProcessed": "0", "totalSlotMs": "14805", "transferredBytes": "0" }, "startTime": "1665776819492", "totalBytesProcessed": "211635233", "totalSlotMs": "14805" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
