{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon881f68a5_ae63_49b7_808a_a64f3d00cf04" }, "priority": "INTERACTIVE", "query": "select *\nfrom(\nselect i_category, i_class, i_brand,\n s_store_name, s_company_name,\n d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand, s_store_name, s_company_name)\n avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n d_year in (1999) and\n ((i_category in ('Women','Jewelry','Men') and\n i_class in ('dresses','birdal','shirts')\n )\n or (i_category in ('Sports','Electronics','Books') and\n i_class in ('football','stereo','computers') \n ))\ngroup by i_category, i_class, i_brand,\n s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "t0hc87G+zp+1pcr/dXUOyg==", "id": "test-project-364309:europe-west1.query89_1665768508", "jobReference": { "jobId": "query89_1665768508", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query89_1665768508?location=europe-west1", "statistics": { "creationTime": "1665768508889", "endTime": "1665768509625", "finalExecutionDurationMs": "448", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113602091", "performanceInsights": { "avgPreviousExecutionMs": "382" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.049689440993788817, "computeRatioMax": 0.049689440993788817, "endMs": "1665768509144", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.024844720496894408, "readRatioMax": 0.024844720496894408, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768509104", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.09937888198757763, "writeRatioMax": 0.09937888198757763 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665768509160", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.037267080745341616, "readRatioMax": 0.037267080745341616, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665768509121", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_year", "FROM date_dim", "WHERE in($21, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.09316770186335403, "writeRatioMax": 0.09316770186335403 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.06832298136645963, "computeRatioMax": 0.06832298136645963, "endMs": "1665768509195", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.024844720496894408, "readRatioMax": 0.024844720496894408, "recordsRead": "18000", "recordsWritten": "1368", "shuffleOutputBytes": "69790", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768509153", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Women', 'Jewelry', 'Men'), in($32, 'dresses', 'birdal', 'shirts')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012422360248447204, "waitRatioMax": 0.012422360248447204, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.09937888198757763, "writeRatioMax": 0.09937888198757763 }, { "completedParallelInputs": "6", "computeMsAvg": "133", "computeMsMax": "161", "computeRatioAvg": 0.8260869565217391, "computeRatioMax": 1, "endMs": "1665768509320", "id": "4", "inputStages": [ "1", "3", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.062111801242236024, "readRatioMax": 0.08074534161490683, "recordsRead": "2890874", "recordsWritten": "9789", "shuffleOutputBytes": "897614", "shuffleOutputBytesSpilled": "0", "slotMs": "697", "startMs": "1665768509207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $224, $231 := $223, $232 := $222, $233 := $225, $234 := $226, $235 := $221", "$120 := SUM($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $215, $222 := $212, $223 := $213, $224 := $214, $225 := $2, $226 := $3", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $204, $211 := $205, $212 := $200, $213 := $201, $214 := $202, $215 := $22", "INNER HASH JOIN EACH WITH ALL ON $203 = $20" ] }, { "kind": "JOIN", "substeps": [ "$203 := $10, $204 := $12, $205 := $13, $200 := $31, $201 := $32, $202 := $33", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "TO __stage04_output", "BY HASH($230, $231, $232, $233, $234, $235)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.031055900621118012, "writeRatioMax": 0.031055900621118012 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.13043478260869565, "computeRatioMax": 0.13043478260869565, "endMs": "1665768509354", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9789", "recordsWritten": "2980", "shuffleOutputBytes": "276535", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768509330", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231, $242 := $232, $243 := $233, $244 := $234, $245 := $235", "$80 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.037267080745341616, "writeRatioMax": 0.037267080745341616 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.049689440993788817, "computeRatioMax": 0.049689440993788817, "endMs": "1665768509440", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768509405", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146", "FROM __SHUFFLE2" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($150, '')", "$101 := coalesce($150, '0')", "$102 := coalesce($151, '')", "$103 := coalesce($151, '0')", "$104 := coalesce($153, '')", "$105 := coalesce($153, '0')", "$106 := coalesce($155, '')", "$107 := coalesce($155, '0')" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $150, $151, $152, $153, $154, $155, $156", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.18012422360248448, "writeRatioMax": 0.18012422360248448 }, { "completedParallelInputs": "99", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.055900621118012424, "computeRatioMax": 0.11801242236024845, "endMs": "1665768509507", "id": "8", "inputStages": [ "7" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3356", "startMs": "1665768509450", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.012422360248447204, "waitRatioMax": 0.024844720496894408, "writeMsAvg": "15", "writeMsMax": "21", "writeRatioAvg": 0.09316770186335403, "writeRatioMax": 0.13043478260869565 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "21", "computeRatioAvg": 0.062111801242236024, "computeRatioMax": 0.13043478260869565, "endMs": "1665768509506", "id": "9", "inputStages": [ "5", "8" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2980", "recordsWritten": "2695", "shuffleOutputBytes": "341927", "shuffleOutputBytesSpilled": "0", "slotMs": "3148", "startMs": "1665768509456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$170, $280, $281, $282, $283", "FROM __SHUFFLE3" ] }, { "kind": "READ", "substeps": [ "$100, $101, $102, $103, $104, $105, $106, $107, $150, $151, $152, $153, $154, $155, $156", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$40 ASC, $60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$40 := subtract($67, $66)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(not_equal($66, NUMERIC<...>), divide(abs(subtract($67, $66)), $66), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$70 := AVG($256) OVER (PARTITION BY $255, $253, $250, $251 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$135 ASC, $133 ASC, $130 ASC, $131 ASC" ] }, { "kind": "JOIN", "substeps": [ "$307 := $160, $300 := $150, $301 := $151, $302 := $152, $303 := $153, $304 := $154, $305 := $155, $306 := $156", "INNER HASH JOIN EACH WITH ALL ON $110 = $100, $111 = $101, $112 = $102, $113 = $103, $114 = $104, $115 = $105, $116 = $106, $117 = $107" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($290, '')", "$111 := coalesce($290, '0')", "$112 := coalesce($291, '')", "$113 := coalesce($291, '0')", "$114 := coalesce($292, '')", "$115 := coalesce($292, '0')", "$116 := coalesce($293, '')", "$117 := coalesce($293, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282, $293 := $283", "$160 := ROOT_AVG($170)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "TO __stage09_output" ] } ], "waitMsAvg": "5", "waitMsMax": "8", "waitRatioAvg": 0.031055900621118012, "waitRatioMax": 0.049689440993788817, "writeMsAvg": "13", "writeMsMax": "25", "writeRatioAvg": 0.08074534161490683, "writeRatioMax": 0.15527950310559005 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.07453416149068323, "computeRatioMax": 0.07453416149068323, "endMs": "1665768509521", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2695", "recordsWritten": "100", "shuffleOutputBytes": "10448", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665768509470", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.018633540372670808, "writeRatioMax": 0.018633540372670808 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "212", "elapsedMs": "557", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "7264" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113602091", "totalPartitionsProcessed": "0", "totalSlotMs": "7264", "transferredBytes": "0" }, "startTime": "1665768508993", "totalBytesProcessed": "113602091", "totalSlotMs": "7264" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc96e602f_61e9_4bdd_8762_6848a470abf7" }, "priority": "INTERACTIVE", "query": "select *\nfrom(\nselect i_category, i_class, i_brand,\n s_store_name, s_company_name,\n d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand, s_store_name, s_company_name)\n avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n d_year in (1999) and\n ((i_category in ('Women','Jewelry','Men') and\n i_class in ('dresses','birdal','shirts')\n )\n or (i_category in ('Sports','Electronics','Books') and\n i_class in ('football','stereo','computers') \n ))\ngroup by i_category, i_class, i_brand,\n s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "m6xiE9zAtvlwwQ4hlOl3SQ==", "id": "test-project-364309:europe-west1.query89_1665778772", "jobReference": { "jobId": "query89_1665778772", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query89_1665778772?location=europe-west1", "statistics": { "creationTime": "1665778772963", "endTime": "1665778773662", "finalExecutionDurationMs": "501", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113602091", "performanceInsights": { "avgPreviousExecutionMs": "395" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04419889502762431, "computeRatioMax": 0.04419889502762431, "endMs": "1665778773149", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.027624309392265192, "readRatioMax": 0.027624309392265192, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778773106", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.09944751381215469, "writeRatioMax": 0.09944751381215469 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.08287292817679558, "computeRatioMax": 0.08287292817679558, "endMs": "1665778773166", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03867403314917127, "readRatioMax": 0.03867403314917127, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778773128", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_year", "FROM date_dim", "WHERE in($21, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.04419889502762431, "writeRatioMax": 0.04419889502762431 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.0718232044198895, "computeRatioMax": 0.0718232044198895, "endMs": "1665778773220", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.027624309392265192, "readRatioMax": 0.027624309392265192, "recordsRead": "18000", "recordsWritten": "1368", "shuffleOutputBytes": "69790", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665778773167", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Women', 'Jewelry', 'Men'), in($32, 'dresses', 'birdal', 'shirts')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.03314917127071823, "waitRatioMax": 0.03314917127071823, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.14917127071823205, "writeRatioMax": 0.14917127071823205 }, { "completedParallelInputs": "6", "computeMsAvg": "133", "computeMsMax": "181", "computeRatioAvg": 0.7348066298342542, "computeRatioMax": 1, "endMs": "1665778773367", "id": "4", "inputStages": [ "3", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "16", "readRatioAvg": 0.06077348066298342, "readRatioMax": 0.08839779005524862, "recordsRead": "2890874", "recordsWritten": "9789", "shuffleOutputBytes": "897614", "shuffleOutputBytesSpilled": "0", "slotMs": "821", "startMs": "1665778773237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $224, $231 := $223, $232 := $222, $233 := $225, $234 := $226, $235 := $221", "$120 := SUM($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $215, $222 := $212, $223 := $213, $224 := $214, $225 := $2, $226 := $3", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $204, $211 := $205, $212 := $200, $213 := $201, $214 := $202, $215 := $22", "INNER HASH JOIN EACH WITH ALL ON $203 = $20" ] }, { "kind": "JOIN", "substeps": [ "$203 := $10, $204 := $12, $205 := $13, $200 := $31, $201 := $32, $202 := $33", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "TO __stage04_output", "BY HASH($230, $231, $232, $233, $234, $235)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011049723756906077, "waitRatioMax": 0.011049723756906077, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.027624309392265192, "writeRatioMax": 0.03867403314917127 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.11049723756906077, "computeRatioMax": 0.11049723756906077, "endMs": "1665778773406", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9789", "recordsWritten": "2980", "shuffleOutputBytes": "276535", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778773387", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231, $242 := $232, $243 := $233, $244 := $234, $245 := $235", "$80 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.022099447513812154, "writeRatioMax": 0.022099447513812154 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.12154696132596685, "computeRatioMax": 0.12154696132596685, "endMs": "1665778773483", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665778773443", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $280, $281, $282, $283", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($290, '')", "$111 := coalesce($290, '0')", "$112 := coalesce($291, '')", "$113 := coalesce($291, '0')", "$114 := coalesce($292, '')", "$115 := coalesce($292, '0')", "$116 := coalesce($293, '')", "$117 := coalesce($293, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282, $293 := $283", "$160 := ROOT_AVG($170)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.10497237569060773, "writeRatioMax": 0.10497237569060773 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.04419889502762431, "computeRatioMax": 0.11049723756906077, "endMs": "1665778773543", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3405", "startMs": "1665778773488", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.016574585635359115, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.08287292817679558, "writeRatioMax": 0.16022099447513813 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.049723756906077346, "computeRatioMax": 0.08287292817679558, "endMs": "1665778773547", "id": "9", "inputStages": [ "5", "8" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2980", "recordsWritten": "2695", "shuffleOutputBytes": "341927", "shuffleOutputBytesSpilled": "0", "slotMs": "3453", "startMs": "1665778773493", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$40 ASC, $60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$40 := subtract($67, $66)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(not_equal($66, NUMERIC<...>), divide(abs(subtract($67, $66)), $66), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$70 := AVG($256) OVER (PARTITION BY $255, $253, $250, $251 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$135 ASC, $133 ASC, $130 ASC, $131 ASC" ] }, { "kind": "JOIN", "substeps": [ "$300 := $150, $301 := $151, $302 := $152, $303 := $153, $304 := $154, $305 := $155, $306 := $156, $307 := $160", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111, $102 = $112, $103 = $113, $104 = $114, $105 = $115, $106 = $116, $107 = $117" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($150, '')", "$101 := coalesce($150, '0')", "$102 := coalesce($151, '')", "$103 := coalesce($151, '0')", "$104 := coalesce($153, '')", "$105 := coalesce($153, '0')", "$106 := coalesce($155, '')", "$107 := coalesce($155, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "TO __stage09_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.022099447513812154, "waitRatioMax": 0.027624309392265192, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.11049723756906077, "writeRatioMax": 0.1712707182320442 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.049723756906077346, "computeRatioMax": 0.049723756906077346, "endMs": "1665778773558", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2695", "recordsWritten": "100", "shuffleOutputBytes": "10448", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778773504", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0055248618784530384, "waitRatioMax": 0.0055248618784530384, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.011049723756906077, "writeRatioMax": 0.011049723756906077 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7838" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113602091", "totalPartitionsProcessed": "0", "totalSlotMs": "7838", "transferredBytes": "0" }, "startTime": "1665778773008", "totalBytesProcessed": "113602091", "totalSlotMs": "7838" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon0e62b81f_8058_438c_a095_e1296193c9df" }, "priority": "INTERACTIVE", "query": "select *\nfrom(\nselect i_category, i_class, i_brand,\n s_store_name, s_company_name,\n d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand, s_store_name, s_company_name)\n avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n d_year in (1999) and\n ((i_category in ('Women','Jewelry','Men') and\n i_class in ('dresses','birdal','shirts')\n )\n or (i_category in ('Sports','Electronics','Books') and\n i_class in ('football','stereo','computers') \n ))\ngroup by i_category, i_class, i_brand,\n s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "DB0/DFUWMXUgL7+WduQnqA==", "id": "test-project-364309:europe-west1.query89_1665778774", "jobReference": { "jobId": "query89_1665778774", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query89_1665778774?location=europe-west1", "statistics": { "creationTime": "1665778775288", "endTime": "1665778775942", "finalExecutionDurationMs": "444", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113602091", "performanceInsights": { "avgPreviousExecutionMs": "413" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.048484848484848485, "computeRatioMax": 0.048484848484848485, "endMs": "1665778775460", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.024242424242424242, "readRatioMax": 0.024242424242424242, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778775432", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006060606060606061, "waitRatioMax": 0.006060606060606061, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.09090909090909091, "writeRatioMax": 0.09090909090909091 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05454545454545454, "computeRatioMax": 0.05454545454545454, "endMs": "1665778775479", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04242424242424243, "readRatioMax": 0.04242424242424243, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665778775446", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_year", "FROM date_dim", "WHERE in($21, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006060606060606061, "waitRatioMax": 0.006060606060606061, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.04242424242424243, "writeRatioMax": 0.04242424242424243 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.08484848484848485, "computeRatioMax": 0.08484848484848485, "endMs": "1665778775513", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04242424242424243, "readRatioMax": 0.04242424242424243, "recordsRead": "18000", "recordsWritten": "1368", "shuffleOutputBytes": "69790", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778775480", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Women', 'Jewelry', 'Men'), in($32, 'dresses', 'birdal', 'shirts')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.06060606060606061, "waitRatioMax": 0.06060606060606061, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "6", "computeMsAvg": "123", "computeMsMax": "165", "computeRatioAvg": 0.7454545454545455, "computeRatioMax": 1, "endMs": "1665778775630", "id": "4", "inputStages": [ "3", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "9", "readMsMax": "13", "readRatioAvg": 0.05454545454545454, "readRatioMax": 0.07878787878787878, "recordsRead": "2890874", "recordsWritten": "9789", "shuffleOutputBytes": "897614", "shuffleOutputBytesSpilled": "0", "slotMs": "613", "startMs": "1665778775531", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $224, $231 := $223, $232 := $222, $233 := $225, $234 := $226, $235 := $221", "$120 := SUM($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $215, $222 := $212, $223 := $213, $224 := $214, $225 := $2, $226 := $3", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $204, $211 := $205, $212 := $200, $213 := $201, $214 := $202, $215 := $22", "INNER HASH JOIN EACH WITH ALL ON $203 = $20" ] }, { "kind": "JOIN", "substeps": [ "$203 := $10, $204 := $12, $205 := $13, $200 := $31, $201 := $32, $202 := $33", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "TO __stage04_output", "BY HASH($230, $231, $232, $233, $234, $235)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006060606060606061, "waitRatioMax": 0.006060606060606061, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.024242424242424242, "writeRatioMax": 0.024242424242424242 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.1393939393939394, "computeRatioMax": 0.1393939393939394, "endMs": "1665778775676", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9789", "recordsWritten": "2980", "shuffleOutputBytes": "276535", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778775654", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231, $242 := $232, $243 := $233, $244 := $234, $245 := $235", "$80 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006060606060606061, "waitRatioMax": 0.006060606060606061, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03636363636363636, "writeRatioMax": 0.03636363636363636 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.048484848484848485, "computeRatioMax": 0.048484848484848485, "endMs": "1665778775754", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778775705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $280, $281, $282, $283", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($290, '')", "$111 := coalesce($290, '0')", "$112 := coalesce($291, '')", "$113 := coalesce($291, '0')", "$114 := coalesce($292, '')", "$115 := coalesce($292, '0')", "$116 := coalesce($293, '')", "$117 := coalesce($293, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282, $293 := $283", "$160 := ROOT_AVG($170)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006060606060606061, "waitRatioMax": 0.006060606060606061, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.10303030303030303, "writeRatioMax": 0.10303030303030303 }, { "completedParallelInputs": "95", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.04242424242424243, "computeRatioMax": 0.08484848484848485, "endMs": "1665778775810", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2627", "startMs": "1665778775768", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012121212121212121, "waitRatioMax": 0.01818181818181818, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.08484848484848485, "writeRatioMax": 0.1393939393939394 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "14", "computeRatioAvg": 0.05454545454545454, "computeRatioMax": 0.08484848484848485, "endMs": "1665778775810", "id": "9", "inputStages": [ "5", "8" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2980", "recordsWritten": "2695", "shuffleOutputBytes": "341927", "shuffleOutputBytesSpilled": "0", "slotMs": "2303", "startMs": "1665778775772", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$40 ASC, $60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$40 := subtract($67, $66)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(not_equal($66, NUMERIC<...>), divide(abs(subtract($67, $66)), $66), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$70 := AVG($256) OVER (PARTITION BY $255, $253, $250, $251 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$135 ASC, $133 ASC, $130 ASC, $131 ASC" ] }, { "kind": "JOIN", "substeps": [ "$300 := $150, $301 := $151, $302 := $152, $303 := $153, $304 := $154, $305 := $155, $306 := $156, $307 := $160", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111, $102 = $112, $103 = $113, $104 = $114, $105 = $115, $106 = $116, $107 = $117" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($150, '')", "$101 := coalesce($150, '0')", "$102 := coalesce($151, '')", "$103 := coalesce($151, '0')", "$104 := coalesce($153, '')", "$105 := coalesce($153, '0')", "$106 := coalesce($155, '')", "$107 := coalesce($155, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "TO __stage09_output" ] } ], "waitMsAvg": "5", "waitMsMax": "8", "waitRatioAvg": 0.030303030303030304, "waitRatioMax": 0.048484848484848485, "writeMsAvg": "12", "writeMsMax": "22", "writeRatioAvg": 0.07272727272727272, "writeRatioMax": 0.13333333333333333 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.10909090909090909, "computeRatioMax": 0.10909090909090909, "endMs": "1665778775841", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2695", "recordsWritten": "100", "shuffleOutputBytes": "10448", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778775784", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.012121212121212121, "waitRatioMax": 0.012121212121212121, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05454545454545454, "writeRatioMax": 0.05454545454545454 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "208", "elapsedMs": "536", "estimatedRunnableUnits": "0", "pendingUnits": "5", "totalSlotMs": "5737" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113602091", "totalPartitionsProcessed": "0", "totalSlotMs": "5737", "transferredBytes": "0" }, "startTime": "1665778775341", "totalBytesProcessed": "113602091", "totalSlotMs": "5737" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon148dd37b_77c7_4784_8d18_19b2bfd7800c" }, "priority": "INTERACTIVE", "query": "select *\nfrom(\nselect i_category, i_class, i_brand,\n s_store_name, s_company_name,\n d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand, s_store_name, s_company_name)\n avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n d_year in (1999) and\n ((i_category in ('Women','Jewelry','Men') and\n i_class in ('dresses','birdal','shirts')\n )\n or (i_category in ('Sports','Electronics','Books') and\n i_class in ('football','stereo','computers') \n ))\ngroup by i_category, i_class, i_brand,\n s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "n2XtHjS+C/vJPY5wHZ0hHw==", "id": "test-project-364309:europe-west1.query89_1665778777", "jobReference": { "jobId": "query89_1665778777", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query89_1665778777?location=europe-west1", "statistics": { "creationTime": "1665778777642", "endTime": "1665778778310", "finalExecutionDurationMs": "424", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113602091", "performanceInsights": { "avgPreviousExecutionMs": "417" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665778777825", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.018633540372670808, "readRatioMax": 0.018633540372670808, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778777788", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08695652173913043, "writeRatioMax": 0.08695652173913043 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.06832298136645963, "computeRatioMax": 0.06832298136645963, "endMs": "1665778777833", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778777803", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_year", "FROM date_dim", "WHERE in($21, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.09316770186335403, "writeRatioMax": 0.09316770186335403 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.08074534161490683, "computeRatioMax": 0.08074534161490683, "endMs": "1665778777878", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "18000", "recordsWritten": "1368", "shuffleOutputBytes": "69790", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778777834", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Women', 'Jewelry', 'Men'), in($32, 'dresses', 'birdal', 'shirts')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.024844720496894408, "waitRatioMax": 0.024844720496894408, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08695652173913043, "writeRatioMax": 0.08695652173913043 }, { "completedParallelInputs": "6", "computeMsAvg": "122", "computeMsMax": "161", "computeRatioAvg": 0.7577639751552795, "computeRatioMax": 1, "endMs": "1665778778001", "id": "4", "inputStages": [ "3", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "10", "readMsMax": "13", "readRatioAvg": 0.062111801242236024, "readRatioMax": 0.08074534161490683, "recordsRead": "2890874", "recordsWritten": "9789", "shuffleOutputBytes": "897614", "shuffleOutputBytesSpilled": "0", "slotMs": "697", "startMs": "1665778777893", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $224, $231 := $223, $232 := $222, $233 := $225, $234 := $226, $235 := $221", "$120 := SUM($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $215, $222 := $212, $223 := $213, $224 := $214, $225 := $2, $226 := $3", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $204, $211 := $205, $212 := $200, $213 := $201, $214 := $202, $215 := $22", "INNER HASH JOIN EACH WITH ALL ON $203 = $20" ] }, { "kind": "JOIN", "substeps": [ "$203 := $10, $204 := $12, $205 := $13, $200 := $31, $201 := $32, $202 := $33", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "TO __stage04_output", "BY HASH($230, $231, $232, $233, $234, $235)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.031055900621118012, "writeRatioMax": 0.037267080745341616 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.08074534161490683, "computeRatioMax": 0.08074534161490683, "endMs": "1665778778028", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9789", "recordsWritten": "2980", "shuffleOutputBytes": "276535", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665778778013", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231, $242 := $232, $243 := $233, $244 := $234, $245 := $235", "$80 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.024844720496894408, "writeRatioMax": 0.024844720496894408 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.049689440993788817, "computeRatioMax": 0.049689440993788817, "endMs": "1665778778091", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778778057", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $280, $281, $282, $283", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($290, '')", "$111 := coalesce($290, '0')", "$112 := coalesce($291, '')", "$113 := coalesce($291, '0')", "$114 := coalesce($292, '')", "$115 := coalesce($292, '0')", "$116 := coalesce($293, '')", "$117 := coalesce($293, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282, $293 := $283", "$160 := ROOT_AVG($170)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006211180124223602, "waitRatioMax": 0.006211180124223602, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.09937888198757763, "writeRatioMax": 0.09937888198757763 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.055900621118012424, "computeRatioMax": 0.10559006211180125, "endMs": "1665778778164", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3710", "startMs": "1665778778101", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.012422360248447204, "waitRatioMax": 0.018633540372670808, "writeMsAvg": "19", "writeMsMax": "32", "writeRatioAvg": 0.11801242236024845, "writeRatioMax": 0.19875776397515527 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.049689440993788817, "computeRatioMax": 0.09316770186335403, "endMs": "1665778778175", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2980", "recordsWritten": "2695", "shuffleOutputBytes": "341927", "shuffleOutputBytesSpilled": "0", "slotMs": "3278", "startMs": "1665778778112", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$40 ASC, $60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$40 := subtract($67, $66)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(not_equal($66, NUMERIC<...>), divide(abs(subtract($67, $66)), $66), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$70 := AVG($256) OVER (PARTITION BY $255, $253, $250, $251 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$135 ASC, $133 ASC, $130 ASC, $131 ASC" ] }, { "kind": "JOIN", "substeps": [ "$300 := $150, $301 := $151, $302 := $152, $303 := $153, $304 := $154, $305 := $155, $306 := $156, $307 := $160", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111, $102 = $112, $103 = $113, $104 = $114, $105 = $115, $106 = $116, $107 = $117" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($150, '')", "$101 := coalesce($150, '0')", "$102 := coalesce($151, '')", "$103 := coalesce($151, '0')", "$104 := coalesce($153, '')", "$105 := coalesce($153, '0')", "$106 := coalesce($155, '')", "$107 := coalesce($155, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "TO __stage09_output" ] } ], "waitMsAvg": "6", "waitMsMax": "9", "waitRatioAvg": 0.037267080745341616, "waitRatioMax": 0.055900621118012424, "writeMsAvg": "18", "writeMsMax": "30", "writeRatioAvg": 0.11180124223602485, "writeRatioMax": 0.18633540372670807 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.09937888198757763, "computeRatioMax": 0.09937888198757763, "endMs": "1665778778182", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2695", "recordsWritten": "100", "shuffleOutputBytes": "10448", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665778778122", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.018633540372670808, "waitRatioMax": 0.018633540372670808, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.037267080745341616, "writeRatioMax": 0.037267080745341616 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "531", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7846" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113602091", "totalPartitionsProcessed": "0", "totalSlotMs": "7846", "transferredBytes": "0" }, "startTime": "1665778777687", "totalBytesProcessed": "113602091", "totalSlotMs": "7846" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon79f8644e_f227_453a_86a3_4c00cc687635" }, "priority": "INTERACTIVE", "query": "select *\nfrom(\nselect i_category, i_class, i_brand,\n s_store_name, s_company_name,\n d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand, s_store_name, s_company_name)\n avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n d_year in (1999) and\n ((i_category in ('Women','Jewelry','Men') and\n i_class in ('dresses','birdal','shirts')\n )\n or (i_category in ('Sports','Electronics','Books') and\n i_class in ('football','stereo','computers') \n ))\ngroup by i_category, i_class, i_brand,\n s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "s/9UUBWVHLRb6IthxH/GDw==", "id": "test-project-364309:europe-west1.query89_1665778779", "jobReference": { "jobId": "query89_1665778779", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query89_1665778779?location=europe-west1", "statistics": { "creationTime": "1665778780008", "endTime": "1665778780716", "finalExecutionDurationMs": "492", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113602091", "performanceInsights": { "avgPreviousExecutionMs": "418" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.06547619047619048, "computeRatioMax": 0.06547619047619048, "endMs": "1665778780209", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03571428571428571, "readRatioMax": 0.03571428571428571, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778780165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.1130952380952381, "writeRatioMax": 0.1130952380952381 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.07738095238095238, "computeRatioMax": 0.07738095238095238, "endMs": "1665778780215", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.03571428571428571, "readRatioMax": 0.03571428571428571, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665778780184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_year", "FROM date_dim", "WHERE in($21, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.10714285714285714, "writeRatioMax": 0.10714285714285714 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.10714285714285714, "computeRatioMax": 0.10714285714285714, "endMs": "1665778780260", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02976190476190476, "readRatioMax": 0.02976190476190476, "recordsRead": "18000", "recordsWritten": "1368", "shuffleOutputBytes": "69790", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665778780217", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Women', 'Jewelry', 'Men'), in($32, 'dresses', 'birdal', 'shirts')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011904761904761904, "waitRatioMax": 0.011904761904761904, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.09523809523809523, "writeRatioMax": 0.09523809523809523 }, { "completedParallelInputs": "6", "computeMsAvg": "133", "computeMsMax": "168", "computeRatioAvg": 0.7916666666666666, "computeRatioMax": 1, "endMs": "1665778780436", "id": "4", "inputStages": [ "3", "1", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "11", "readMsMax": "16", "readRatioAvg": 0.06547619047619048, "readRatioMax": 0.09523809523809523, "recordsRead": "2890874", "recordsWritten": "9789", "shuffleOutputBytes": "897614", "shuffleOutputBytesSpilled": "0", "slotMs": "870", "startMs": "1665778780272", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $224, $231 := $223, $232 := $222, $233 := $225, $234 := $226, $235 := $221", "$120 := SUM($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $215, $222 := $212, $223 := $213, $224 := $214, $225 := $2, $226 := $3", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $204, $211 := $205, $212 := $200, $213 := $201, $214 := $202, $215 := $22", "INNER HASH JOIN EACH WITH ALL ON $203 = $20" ] }, { "kind": "JOIN", "substeps": [ "$203 := $10, $204 := $12, $205 := $13, $200 := $31, $201 := $32, $202 := $33", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "TO __stage04_output", "BY HASH($230, $231, $232, $233, $234, $235)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.011904761904761904, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.03571428571428571, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.11904761904761904, "computeRatioMax": 0.11904761904761904, "endMs": "1665778780467", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9789", "recordsWritten": "2980", "shuffleOutputBytes": "276535", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778780447", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231, $242 := $232, $243 := $233, $244 := $234, $245 := $235", "$80 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.02976190476190476, "writeRatioMax": 0.02976190476190476 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.047619047619047616, "endMs": "1665778780530", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778780496", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $280, $281, $282, $283", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($290, '')", "$111 := coalesce($290, '0')", "$112 := coalesce($291, '')", "$113 := coalesce($291, '0')", "$114 := coalesce($292, '')", "$115 := coalesce($292, '0')", "$116 := coalesce($293, '')", "$117 := coalesce($293, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282, $293 := $283", "$160 := ROOT_AVG($170)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.005952380952380952, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.16666666666666666, "writeRatioMax": 0.16666666666666666 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.047619047619047616, "computeRatioMax": 0.10714285714285714, "endMs": "1665778780596", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3541", "startMs": "1665778780537", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.005952380952380952, "waitRatioMax": 0.017857142857142856, "writeMsAvg": "16", "writeMsMax": "29", "writeRatioAvg": 0.09523809523809523, "writeRatioMax": 0.17261904761904762 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "23", "computeRatioAvg": 0.05952380952380952, "computeRatioMax": 0.13690476190476192, "endMs": "1665778780610", "id": "9", "inputStages": [ "5", "8" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2980", "recordsWritten": "2695", "shuffleOutputBytes": "341927", "shuffleOutputBytesSpilled": "0", "slotMs": "3190", "startMs": "1665778780543", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$40 ASC, $60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$40 := subtract($67, $66)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(not_equal($66, NUMERIC<...>), divide(abs(subtract($67, $66)), $66), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$70 := AVG($256) OVER (PARTITION BY $255, $253, $250, $251 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$135 ASC, $133 ASC, $130 ASC, $131 ASC" ] }, { "kind": "JOIN", "substeps": [ "$300 := $150, $301 := $151, $302 := $152, $303 := $153, $304 := $154, $305 := $155, $306 := $156, $307 := $160", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111, $102 = $112, $103 = $113, $104 = $114, $105 = $115, $106 = $116, $107 = $117" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($150, '')", "$101 := coalesce($150, '0')", "$102 := coalesce($151, '')", "$103 := coalesce($151, '0')", "$104 := coalesce($153, '')", "$105 := coalesce($153, '0')", "$106 := coalesce($155, '')", "$107 := coalesce($155, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.017857142857142856, "waitRatioMax": 0.023809523809523808, "writeMsAvg": "15", "writeMsMax": "28", "writeRatioAvg": 0.08928571428571429, "writeRatioMax": 0.16666666666666666 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03571428571428571, "computeRatioMax": 0.03571428571428571, "endMs": "1665778780602", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2695", "recordsWritten": "100", "shuffleOutputBytes": "10448", "shuffleOutputBytesSpilled": "0", "slotMs": "13", "startMs": "1665778780556", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011904761904761904, "waitRatioMax": 0.011904761904761904, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.023809523809523808, "writeRatioMax": 0.023809523809523808 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "590", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7765" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113602091", "totalPartitionsProcessed": "0", "totalSlotMs": "7765", "transferredBytes": "0" }, "startTime": "1665778780065", "totalBytesProcessed": "113602091", "totalSlotMs": "7765" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonc5584c49_9c0c_4e80_a110_f1ca6b2e6f8b" }, "priority": "INTERACTIVE", "query": "select *\nfrom(\nselect i_category, i_class, i_brand,\n s_store_name, s_company_name,\n d_moy,\n sum(ss_sales_price) sum_sales,\n avg(sum(ss_sales_price)) over\n (partition by i_category, i_brand, s_store_name, s_company_name)\n avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n ss_sold_date_sk = d_date_sk and\n ss_store_sk = s_store_sk and\n d_year in (1999) and\n ((i_category in ('Women','Jewelry','Men') and\n i_class in ('dresses','birdal','shirts')\n )\n or (i_category in ('Sports','Electronics','Books') and\n i_class in ('football','stereo','computers') \n ))\ngroup by i_category, i_class, i_brand,\n s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n;", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "jPM8glPzeOwEJffTUwva/A==", "id": "test-project-364309:europe-west1.query89_1665778781", "jobReference": { "jobId": "query89_1665778781", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query89_1665778781?location=europe-west1", "statistics": { "creationTime": "1665778782334", "endTime": "1665778783021", "finalExecutionDurationMs": "480", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "113602091", "performanceInsights": { "avgPreviousExecutionMs": "426" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06756756756756757, "computeRatioMax": 0.06756756756756757, "endMs": "1665778782532", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.033783783783783786, "readRatioMax": 0.033783783783783786, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "363", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778782490", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_store_name, $3:s_company_name", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006756756756756757, "waitRatioMax": 0.006756756756756757, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.12162162162162163, "writeRatioMax": 0.12162162162162163 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.10810810810810811, "computeRatioMax": 0.10810810810810811, "endMs": "1665778782544", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.04054054054054054, "readRatioMax": 0.04054054054054054, "recordsRead": "73049", "recordsWritten": "365", "shuffleOutputBytes": "6570", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778782507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:d_date_sk, $22:d_moy, $21:d_year", "FROM date_dim", "WHERE in($21, 1999)" ] }, { "kind": "WRITE", "substeps": [ "$20, $22", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006756756756756757, "waitRatioMax": 0.006756756756756757, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.08108108108108109, "writeRatioMax": 0.08108108108108109 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.12162162162162163, "computeRatioMax": 0.12162162162162163, "endMs": "1665778782585", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0472972972972973, "readRatioMax": 0.0472972972972973, "recordsRead": "18000", "recordsWritten": "1368", "shuffleOutputBytes": "69790", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665778782545", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category", "FROM item", "WHERE or(and(in($33, 'Women', 'Jewelry', 'Men'), in($32, 'dresses', 'birdal', 'shirts')), ...)" ] }, { "kind": "WRITE", "substeps": [ "$30, $31, $32, $33", "TO __stage03_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.02702702702702703, "waitRatioMax": 0.02702702702702703, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.08108108108108109, "writeRatioMax": 0.08108108108108109 }, { "completedParallelInputs": "6", "computeMsAvg": "123", "computeMsMax": "148", "computeRatioAvg": 0.831081081081081, "computeRatioMax": 1, "endMs": "1665778782726", "id": "4", "inputStages": [ "1", "3", "0" ], "name": "S04: Join+", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.10135135135135136, "readRatioMax": 0.12162162162162163, "recordsRead": "2890874", "recordsWritten": "9789", "shuffleOutputBytes": "897614", "shuffleOutputBytesSpilled": "0", "slotMs": "808", "startMs": "1665778782597", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31, $32, $33", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $22", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $230 := $224, $231 := $223, $232 := $222, $233 := $225, $234 := $226, $235 := $221", "$120 := SUM($220)" ] }, { "kind": "JOIN", "substeps": [ "$220 := $211, $221 := $215, $222 := $212, $223 := $213, $224 := $214, $225 := $2, $226 := $3", "INNER HASH JOIN EACH WITH ALL ON $210 = $1" ] }, { "kind": "JOIN", "substeps": [ "$210 := $204, $211 := $205, $212 := $200, $213 := $201, $214 := $202, $215 := $22", "INNER HASH JOIN EACH WITH ALL ON $203 = $20" ] }, { "kind": "JOIN", "substeps": [ "$203 := $10, $204 := $12, $205 := $13, $200 := $31, $201 := $32, $202 := $33", "INNER HASH JOIN EACH WITH ALL ON $11 = $30" ] }, { "kind": "WRITE", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "TO __stage04_output", "BY HASH($230, $231, $232, $233, $234, $235)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.006756756756756757, "waitRatioMax": 0.013513513513513514, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.04054054054054054, "writeRatioMax": 0.0472972972972973 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.12837837837837837, "computeRatioMax": 0.12837837837837837, "endMs": "1665778782768", "id": "5", "inputStages": [ "4" ], "name": "S05: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "9789", "recordsWritten": "2980", "shuffleOutputBytes": "276535", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778782744", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$233, $234, $235, $232, $231, $230, $120", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $240 := $230, $241 := $231, $242 := $232, $243 := $233, $244 := $234, $245 := $235", "$80 := SUM($120)" ] }, { "kind": "WRITE", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006756756756756757, "waitRatioMax": 0.006756756756756757, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.04054054054054054, "writeRatioMax": 0.04054054054054054 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.07432432432432433, "computeRatioMax": 0.07432432432432433, "endMs": "1665778782830", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778782793", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $280, $281, $282, $283", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := coalesce($290, '')", "$111 := coalesce($290, '0')", "$112 := coalesce($291, '')", "$113 := coalesce($291, '0')", "$114 := coalesce($292, '')", "$115 := coalesce($292, '0')", "$116 := coalesce($293, '')", "$117 := coalesce($293, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $290 := $280, $291 := $281, $292 := $282, $293 := $283", "$160 := ROOT_AVG($170)" ] }, { "kind": "WRITE", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006756756756756757, "waitRatioMax": 0.006756756756756757, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.21621621621621623, "writeRatioMax": 0.21621621621621623 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.05405405405405406, "computeRatioMax": 0.12162162162162163, "endMs": "1665778782913", "id": "8", "inputStages": [ "6" ], "name": "S08: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3459", "startMs": "1665778782849", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "5", "waitRatioAvg": 0.013513513513513514, "waitRatioMax": 0.033783783783783786, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.11486486486486487, "writeRatioMax": 0.20270270270270271 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.060810810810810814, "computeRatioMax": 0.10810810810810811, "endMs": "1665778782913", "id": "9", "inputStages": [ "8", "5" ], "name": "S09: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2980", "recordsWritten": "2695", "shuffleOutputBytes": "341927", "shuffleOutputBytesSpilled": "0", "slotMs": "3304", "startMs": "1665778782859", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$243, $244, $245, $242, $241, $240, $80", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$140, $141, $142, $143, $144, $145, $146", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$110, $111, $112, $113, $114, $115, $116, $117, $160", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$40 ASC, $60 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$40 := subtract($67, $66)" ] }, { "kind": "FILTER", "substeps": [ "greater(case_no_value(not_equal($66, NUMERIC<...>), divide(abs(subtract($67, $66)), $66), NULL), NUMERIC<...>)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$70 := AVG($256) OVER (PARTITION BY $255, $253, $250, $251 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$135 ASC, $133 ASC, $130 ASC, $131 ASC" ] }, { "kind": "JOIN", "substeps": [ "$300 := $150, $301 := $151, $302 := $152, $303 := $153, $304 := $154, $305 := $155, $306 := $156, $307 := $160", "INNER HASH JOIN EACH WITH ALL ON $100 = $110, $101 = $111, $102 = $112, $103 = $113, $104 = $114, $105 = $115, $106 = $116, $107 = $117" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($150, '')", "$101 := coalesce($150, '0')", "$102 := coalesce($151, '')", "$103 := coalesce($151, '0')", "$104 := coalesce($153, '')", "$105 := coalesce($153, '0')", "$106 := coalesce($155, '')", "$107 := coalesce($155, '0')" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "TO __stage09_output" ] } ], "waitMsAvg": "6", "waitMsMax": "7", "waitRatioAvg": 0.04054054054054054, "waitRatioMax": 0.0472972972972973, "writeMsAvg": "20", "writeMsMax": "30", "writeRatioAvg": 0.13513513513513514, "writeRatioMax": 0.20270270270270271 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.04054054054054054, "computeRatioMax": 0.04054054054054054, "endMs": "1665778782924", "id": "10", "inputStages": [ "9" ], "name": "S0A: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2695", "recordsWritten": "100", "shuffleOutputBytes": "10448", "shuffleOutputBytesSpilled": "0", "slotMs": "14", "startMs": "1665778782873", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312, $313, $314, $315, $316, $317, $318", "FROM __stage09_output" ] }, { "kind": "SORT", "substeps": [ "$310 ASC, $311 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$320, $321, $322, $323, $324, $325, $326, $327", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006756756756756757, "waitRatioMax": 0.006756756756756757, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.013513513513513514, "writeRatioMax": 0.013513513513513514 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "213", "elapsedMs": "585", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7811" } ], "totalBytesBilled": "114294784", "totalBytesProcessed": "113602091", "totalPartitionsProcessed": "0", "totalSlotMs": "7811", "transferredBytes": "0" }, "startTime": "1665778782387", "totalBytesProcessed": "113602091", "totalSlotMs": "7811" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
