{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon768aab41_c3eb_4dc6_ac1a_9919241d53e7" }, "priority": "INTERACTIVE", "query": "-- start query 86 in stream 0 using template query86.tpl\nwith results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n web_sales\n ,date_dim d1\n ,item\n where\n d1.d_month_seq between 1200 and 1200+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n union all\n select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n union all\n select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\nselect \n total_sum ,i_category ,i_class, lochierarchy \n ,rank() over (\n partition by lochierarchy,\n case when g_class = 0 then i_category end \n order by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n lochierarchy desc,\n case when lochierarchy = 0 then i_category end,\n rank_within_parent \nLIMIT 100;\n-- end query 86 in stream 0 using template query86.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "r352FJfPFh0IPKYnlL6HhA==", "id": "test-project-364309:europe-west1.query86_1665768499", "jobReference": { "jobId": "query86_1665768499", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query86_1665768499?location=europe-west1", "statistics": { "creationTime": "1665768499810", "endTime": "1665768500654", "finalExecutionDurationMs": "632", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24646191", "performanceInsights": { "avgPreviousExecutionMs": "687" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.035422343324250684, "computeRatioMax": 0.035422343324250684, "endMs": "1665768500007", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013623978201634877, "readRatioMax": 0.013623978201634877, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768499966", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.07629427792915532, "writeRatioMax": 0.07629427792915532 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.02997275204359673, "computeRatioMax": 0.02997275204359673, "endMs": "1665768500028", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01634877384196185, "readRatioMax": 0.01634877384196185, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768499988", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.0681198910081744, "writeRatioMax": 0.0681198910081744 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.06267029972752043, "computeRatioMax": 0.06267029972752043, "endMs": "1665768500075", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01907356948228883, "readRatioMax": 0.01907356948228883, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768500032", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02452316076294278, "writeRatioMax": 0.02452316076294278 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.027247956403269755, "computeRatioMax": 0.027247956403269755, "endMs": "1665768500088", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01634877384196185, "readRatioMax": 0.01634877384196185, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768500048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04087193460490463, "writeRatioMax": 0.04087193460490463 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.04904632152588556, "computeRatioMax": 0.04904632152588556, "endMs": "1665768500127", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.01907356948228883, "readRatioMax": 0.01907356948228883, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768500082", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.07084468664850137, "writeRatioMax": 0.07084468664850137 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.021798365122615803, "computeRatioMax": 0.021798365122615803, "endMs": "1665768500141", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.013623978201634877, "readRatioMax": 0.013623978201634877, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768500101", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.07356948228882834, "writeRatioMax": 0.07356948228882834 }, { "completedParallelInputs": "1", "computeMsAvg": "367", "computeMsMax": "367", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768500279", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03814713896457766, "readRatioMax": 0.03814713896457766, "recordsRead": "737750", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "285", "startMs": "1665768500119", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$330 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421", "INNER HASH JOIN EACH WITH ALL ON $420 = $40" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$330", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005449591280653951, "waitRatioMax": 0.005449591280653951, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0027247956403269754, "writeRatioMax": 0.0027247956403269754 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.013623978201634877, "computeRatioMax": 0.013623978201634877, "endMs": "1665768500311", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "149", "startMs": "1665768500119", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := NULL", "$261 := 1", "$262 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$270 := SUM($330)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $270", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.008174386920980926, "writeRatioMax": 0.008174386920980926 }, { "completedParallelInputs": "1", "computeMsAvg": "238", "computeMsMax": "238", "computeRatioAvg": 0.6485013623978202, "computeRatioMax": 0.6485013623978202, "endMs": "1665768500316", "id": "11", "inputStages": [ "4", "3" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.051771117166212535, "readRatioMax": 0.051771117166212535, "recordsRead": "737750", "recordsWritten": "11", "shuffleOutputBytes": "297", "shuffleOutputBytesSpilled": "0", "slotMs": "229", "startMs": "1665768500139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391", "$310 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $11", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $31, $381 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$400, $310", "TO __stage0B_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02452316076294278, "writeRatioMax": 0.02452316076294278 }, { "completedParallelInputs": "1", "computeMsAvg": "341", "computeMsMax": "341", "computeRatioAvg": 0.9291553133514986, "computeRatioMax": 0.9291553133514986, "endMs": "1665768500356", "id": "12", "inputStages": [ "7", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.02997275204359673, "readRatioMax": 0.02997275204359673, "recordsRead": "737750", "recordsWritten": "121", "shuffleOutputBytes": "4746", "shuffleOutputBytesSpilled": "0", "slotMs": "277", "startMs": "1665768500169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $352, $361 := $351", "$300 := SUM($350)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $341, $351 := $2, $352 := $3", "INNER HASH JOIN EACH WITH ALL ON $340 = $1" ] }, { "kind": "JOIN", "substeps": [ "$340 := $21, $341 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$361, $360, $300", "TO __stage0C_output", "BY HASH($360, $361)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01907356948228883, "writeRatioMax": 0.01907356948228883 }, { "completedParallelInputs": "3", "computeMsAvg": "13", "computeMsMax": "15", "computeRatioAvg": 0.035422343324250684, "computeRatioMax": 0.04087193460490463, "endMs": "1665768500434", "id": "13", "inputStages": [ "10", "11", "12" ], "name": "S0D: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "7503", "shuffleOutputBytesSpilled": "0", "slotMs": "126", "startMs": "1665768500381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$361, $360, $300", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$400, $310", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $270", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($153, 0), $151, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361", "$240 := SUM($300)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := NULL", "$191 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$130, $150, $151, $152, $154", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "23", "writeMsMax": "27", "writeRatioAvg": 0.06267029972752043, "writeRatioMax": 0.07356948228882834 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.01907356948228883, "computeRatioMax": 0.01907356948228883, "endMs": "1665768500491", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665768500456", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $501, $502, $500", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($510, 0)", "$171 := coalesce($510, 1)", "$172 := coalesce($511, '')", "$173 := coalesce($511, '0')", "$174 := coalesce($512, NUMERIC<...>)", "$175 := coalesce($512, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$230 := MIN($290)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.0027247956403269754, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.04632152588555858, "writeRatioMax": 0.04632152588555858 }, { "completedParallelInputs": "97", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.021798365122615803, "computeRatioMax": 0.04904632152588556, "endMs": "1665768500554", "id": "16", "inputStages": [ "14" ], "name": "S10: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3361", "startMs": "1665768500502", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0027247956403269754, "waitRatioMax": 0.005449591280653951, "writeMsAvg": "17", "writeMsMax": "28", "writeRatioAvg": 0.04632152588555858, "writeRatioMax": 0.07629427792915532 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "16", "computeRatioAvg": 0.02452316076294278, "computeRatioMax": 0.043596730245231606, "endMs": "1665768500553", "id": "17", "inputStages": [ "16", "13" ], "name": "S11: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8700", "shuffleOutputBytesSpilled": "0", "slotMs": "3199", "startMs": "1665768500507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $150, $151, $152, $154", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$210, $470, $471, $472, $473, $474", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$114 DESC, $90 ASC, $110 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := case_no_value(equal($114, 0), $112, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := RANK() OVER (PARTITION BY $444, $440 ORDER BY $441 DESC)" ] }, { "kind": "SORT", "substeps": [ "$204 ASC, $200 ASC, $201 DESC" ] }, { "kind": "JOIN", "substeps": [ "$520 := $221, $521 := $222, $522 := $223, $523 := $224, $524 := $230", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171, $162 = $172, $163 = $173, $164 = $174, $165 = $175" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($224, 0)", "$161 := coalesce($224, 1)", "$162 := coalesce($220, '')", "$163 := coalesce($220, '0')", "$164 := coalesce($221, NUMERIC<...>)", "$165 := coalesce($221, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.008174386920980926, "waitRatioMax": 0.010899182561307902, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.03814713896457766, "writeRatioMax": 0.07901907356948229 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.027247956403269755, "computeRatioMax": 0.027247956403269755, "endMs": "1665768500565", "id": "18", "inputStages": [ "17" ], "name": "S12: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5608", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665768500518", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535", "FROM __stage11_output" ] }, { "kind": "SORT", "substeps": [ "$535 DESC, $530 ASC, $531 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$540, $541, $542, $543, $544", "TO __stage12_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008174386920980926, "waitRatioMax": 0.008174386920980926, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010899182561307902, "writeRatioMax": 0.010899182561307902 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "13", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "1292" }, { "activeUnits": "1", "completedUnits": "213", "elapsedMs": "735", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "7861" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24646191", "totalPartitionsProcessed": "0", "totalSlotMs": "7861", "transferredBytes": "0" }, "startTime": "1665768499860", "totalBytesProcessed": "24646191", "totalSlotMs": "7861" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon140b5288_76ef_4ff0_a2a0_b9f945a6e104" }, "priority": "INTERACTIVE", "query": "-- start query 86 in stream 0 using template query86.tpl\nwith results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n web_sales\n ,date_dim d1\n ,item\n where\n d1.d_month_seq between 1200 and 1200+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n union all\n select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n union all\n select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\nselect \n total_sum ,i_category ,i_class, lochierarchy \n ,rank() over (\n partition by lochierarchy,\n case when g_class = 0 then i_category end \n order by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n lochierarchy desc,\n case when lochierarchy = 0 then i_category end,\n rank_within_parent \nLIMIT 100;\n-- end query 86 in stream 0 using template query86.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "eL/L6A3ZeIEtTCyaeUdDaw==", "id": "test-project-364309:europe-west1.query86_1665778728", "jobReference": { "jobId": "query86_1665778728", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query86_1665778728?location=europe-west1", "statistics": { "creationTime": "1665778728972", "endTime": "1665778729857", "finalExecutionDurationMs": "662", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24646191", "performanceInsights": { "avgPreviousExecutionMs": "677" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.041935483870967745, "computeRatioMax": 0.041935483870967745, "endMs": "1665778729155", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01935483870967742, "readRatioMax": 0.01935483870967742, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665778729127", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.041935483870967745, "writeRatioMax": 0.041935483870967745 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03870967741935484, "computeRatioMax": 0.03870967741935484, "endMs": "1665778729174", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01935483870967742, "readRatioMax": 0.01935483870967742, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778729142", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04838709677419355, "writeRatioMax": 0.04838709677419355 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.054838709677419356, "computeRatioMax": 0.054838709677419356, "endMs": "1665778729205", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.00967741935483871, "readRatioMax": 0.00967741935483871, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778729170", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.041935483870967745, "writeRatioMax": 0.041935483870967745 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02258064516129032, "computeRatioMax": 0.02258064516129032, "endMs": "1665778729215", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.06774193548387097, "readRatioMax": 0.06774193548387097, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665778729183", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012903225806451613, "writeRatioMax": 0.012903225806451613 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.05806451612903226, "computeRatioMax": 0.05806451612903226, "endMs": "1665778729258", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.016129032258064516, "readRatioMax": 0.016129032258064516, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665778729214", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.08387096774193549, "writeRatioMax": 0.08387096774193549 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.054838709677419356, "computeRatioMax": 0.054838709677419356, "endMs": "1665778729259", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.035483870967741936, "readRatioMax": 0.035483870967741936, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778729227", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "1", "computeMsAvg": "271", "computeMsMax": "271", "computeRatioAvg": 0.8741935483870967, "computeRatioMax": 0.8741935483870967, "endMs": "1665778729403", "id": "9", "inputStages": [ "1", "0" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.041935483870967745, "readRatioMax": 0.041935483870967745, "recordsRead": "737750", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "181", "startMs": "1665778729243", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$330 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421", "INNER HASH JOIN EACH WITH ALL ON $420 = $40" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$330", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0064516129032258064, "waitRatioMax": 0.0064516129032258064, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0032258064516129032, "writeRatioMax": 0.0032258064516129032 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.01935483870967742, "computeRatioMax": 0.01935483870967742, "endMs": "1665778729423", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "146", "startMs": "1665778729246", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := NULL", "$261 := 1", "$262 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$270 := SUM($330)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $270", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00967741935483871, "waitRatioMax": 0.00967741935483871, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.00967741935483871, "writeRatioMax": 0.00967741935483871 }, { "completedParallelInputs": "1", "computeMsAvg": "300", "computeMsMax": "300", "computeRatioAvg": 0.967741935483871, "computeRatioMax": 0.967741935483871, "endMs": "1665778729431", "id": "11", "inputStages": [ "4", "3" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.05161290322580645, "readRatioMax": 0.05161290322580645, "recordsRead": "737750", "recordsWritten": "11", "shuffleOutputBytes": "297", "shuffleOutputBytesSpilled": "0", "slotMs": "285", "startMs": "1665778729257", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391", "$310 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $11", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $31, $381 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$400, $310", "TO __stage0B_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02258064516129032, "writeRatioMax": 0.02258064516129032 }, { "completedParallelInputs": "1", "computeMsAvg": "310", "computeMsMax": "310", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778729534", "id": "12", "inputStages": [ "7", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "32", "readMsMax": "32", "readRatioAvg": 0.1032258064516129, "readRatioMax": 0.1032258064516129, "recordsRead": "737750", "recordsWritten": "121", "shuffleOutputBytes": "4746", "shuffleOutputBytesSpilled": "0", "slotMs": "322", "startMs": "1665778729284", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $352, $361 := $351", "$300 := SUM($350)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $341, $351 := $2, $352 := $3", "INNER HASH JOIN EACH WITH ALL ON $340 = $1" ] }, { "kind": "JOIN", "substeps": [ "$340 := $21, $341 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$361, $360, $300", "TO __stage0C_output", "BY HASH($360, $361)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "3", "computeMsAvg": "11", "computeMsMax": "16", "computeRatioAvg": 0.035483870967741936, "computeRatioMax": 0.05161290322580645, "endMs": "1665778729607", "id": "13", "inputStages": [ "10", "11", "12" ], "name": "S0D: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "7503", "shuffleOutputBytesSpilled": "0", "slotMs": "135", "startMs": "1665778729555", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$361, $360, $300", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$400, $310", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $270", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($153, 0), $151, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361", "$240 := SUM($300)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := NULL", "$191 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$130, $150, $151, $152, $154", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "20", "writeMsMax": "28", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.09032258064516129 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02903225806451613, "computeRatioMax": 0.02903225806451613, "endMs": "1665778729671", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778729631", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $501, $502, $500", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($510, 0)", "$171 := coalesce($510, 1)", "$172 := coalesce($511, '')", "$173 := coalesce($511, '0')", "$174 := coalesce($512, NUMERIC<...>)", "$175 := coalesce($512, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$230 := MIN($290)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.05806451612903226, "writeRatioMax": 0.05806451612903226 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.025806451612903226, "computeRatioMax": 0.04838709677419355, "endMs": "1665778729733", "id": "16", "inputStages": [ "14" ], "name": "S10: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3082", "startMs": "1665778729682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0064516129032258064, "waitRatioMax": 0.012903225806451613, "writeMsAvg": "17", "writeMsMax": "28", "writeRatioAvg": 0.054838709677419356, "writeRatioMax": 0.09032258064516129 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.025806451612903226, "computeRatioMax": 0.054838709677419356, "endMs": "1665778729740", "id": "17", "inputStages": [ "16", "13" ], "name": "S11: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8700", "shuffleOutputBytesSpilled": "0", "slotMs": "2763", "startMs": "1665778729689", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $150, $151, $152, $154", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$210, $470, $471, $472, $473, $474", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$114 DESC, $90 ASC, $110 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := case_no_value(equal($114, 0), $112, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := RANK() OVER (PARTITION BY $444, $440 ORDER BY $441 DESC)" ] }, { "kind": "SORT", "substeps": [ "$204 ASC, $200 ASC, $201 DESC" ] }, { "kind": "JOIN", "substeps": [ "$520 := $221, $521 := $222, $522 := $223, $523 := $224, $524 := $230", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171, $162 = $172, $163 = $173, $164 = $174, $165 = $175" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($224, 0)", "$161 := coalesce($224, 1)", "$162 := coalesce($220, '')", "$163 := coalesce($220, '0')", "$164 := coalesce($221, NUMERIC<...>)", "$165 := coalesce($221, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535", "TO __stage11_output" ] } ], "waitMsAvg": "6", "waitMsMax": "8", "waitRatioAvg": 0.01935483870967742, "waitRatioMax": 0.025806451612903226, "writeMsAvg": "13", "writeMsMax": "19", "writeRatioAvg": 0.041935483870967745, "writeRatioMax": 0.06129032258064516 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03870967741935484, "computeRatioMax": 0.03870967741935484, "endMs": "1665778729749", "id": "18", "inputStages": [ "17" ], "name": "S12: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5608", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665778729697", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535", "FROM __stage11_output" ] }, { "kind": "SORT", "substeps": [ "$535 DESC, $530 ASC, $531 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$540, $541, $542, $543, $544", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0032258064516129032, "waitRatioMax": 0.0032258064516129032, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012903225806451613, "writeRatioMax": 0.012903225806451613 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "13", "elapsedMs": "603", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1286" }, { "activeUnits": "0", "completedUnits": "216", "elapsedMs": "765", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7125" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24646191", "totalPartitionsProcessed": "0", "totalSlotMs": "7125", "transferredBytes": "0" }, "startTime": "1665778729025", "totalBytesProcessed": "24646191", "totalSlotMs": "7125" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncd18decc_4960_4001_9a60_46eca68cfa86" }, "priority": "INTERACTIVE", "query": "-- start query 86 in stream 0 using template query86.tpl\nwith results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n web_sales\n ,date_dim d1\n ,item\n where\n d1.d_month_seq between 1200 and 1200+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n union all\n select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n union all\n select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\nselect \n total_sum ,i_category ,i_class, lochierarchy \n ,rank() over (\n partition by lochierarchy,\n case when g_class = 0 then i_category end \n order by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n lochierarchy desc,\n case when lochierarchy = 0 then i_category end,\n rank_within_parent \nLIMIT 100;\n-- end query 86 in stream 0 using template query86.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "gsgATvg5PVReXTsyyN5DNQ==", "id": "test-project-364309:europe-west1.query86_1665778730", "jobReference": { "jobId": "query86_1665778730", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query86_1665778730?location=europe-west1", "statistics": { "creationTime": "1665778731460", "endTime": "1665778732315", "finalExecutionDurationMs": "626", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24646191", "performanceInsights": { "avgPreviousExecutionMs": "675" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03389830508474576, "computeRatioMax": 0.03389830508474576, "endMs": "1665778731674", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.014124293785310734, "readRatioMax": 0.014124293785310734, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778731630", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0423728813559322, "writeRatioMax": 0.0423728813559322 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.01694915254237288, "computeRatioMax": 0.01694915254237288, "endMs": "1665778731669", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.014124293785310734, "readRatioMax": 0.014124293785310734, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665778731642", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.0423728813559322, "writeRatioMax": 0.0423728813559322 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03954802259887006, "computeRatioMax": 0.03954802259887006, "endMs": "1665778731696", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.014124293785310734, "readRatioMax": 0.014124293785310734, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778731665", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.04519774011299435, "writeRatioMax": 0.04519774011299435 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03954802259887006, "computeRatioMax": 0.03954802259887006, "endMs": "1665778731716", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.022598870056497175, "readRatioMax": 0.022598870056497175, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778731678", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.0480225988700565, "computeRatioMax": 0.0480225988700565, "endMs": "1665778731750", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.011299435028248588, "readRatioMax": 0.011299435028248588, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778731709", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.07062146892655367, "writeRatioMax": 0.07062146892655367 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0423728813559322, "computeRatioMax": 0.0423728813559322, "endMs": "1665778731748", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.025423728813559324, "readRatioMax": 0.025423728813559324, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778731721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "1", "computeMsAvg": "258", "computeMsMax": "258", "computeRatioAvg": 0.7288135593220338, "computeRatioMax": 0.7288135593220338, "endMs": "1665778731902", "id": "10", "inputStages": [ "0", "1" ], "name": "S0A: Join+", "parallelInputs": "1", "readMsAvg": "19", "readMsMax": "19", "readRatioAvg": 0.05367231638418079, "readRatioMax": 0.05367231638418079, "recordsRead": "737750", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "258", "startMs": "1665778731746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$330 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421", "INNER HASH JOIN EACH WITH ALL ON $420 = $40" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$330", "TO __stage0A_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002824858757062147, "writeRatioMax": 0.002824858757062147 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03389830508474576, "computeRatioMax": 0.03389830508474576, "endMs": "1665778731933", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "242", "startMs": "1665778731748", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := NULL", "$261 := 1", "$262 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$270 := SUM($330)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $270", "TO __stage0B_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.00847457627118644, "writeRatioMax": 0.00847457627118644 }, { "completedParallelInputs": "1", "computeMsAvg": "354", "computeMsMax": "354", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778731957", "id": "12", "inputStages": [ "4", "3" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0423728813559322, "readRatioMax": 0.0423728813559322, "recordsRead": "737750", "recordsWritten": "11", "shuffleOutputBytes": "297", "shuffleOutputBytesSpilled": "0", "slotMs": "222", "startMs": "1665778731761", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391", "$310 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $11", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $31, $381 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$400, $310", "TO __stage0C_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.01977401129943503, "writeRatioMax": 0.01977401129943503 }, { "completedParallelInputs": "1", "computeMsAvg": "301", "computeMsMax": "301", "computeRatioAvg": 0.8502824858757062, "computeRatioMax": 0.8502824858757062, "endMs": "1665778731997", "id": "14", "inputStages": [ "6", "7" ], "name": "S0E: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.03954802259887006, "readRatioMax": 0.03954802259887006, "recordsRead": "737750", "recordsWritten": "121", "shuffleOutputBytes": "4746", "shuffleOutputBytesSpilled": "0", "slotMs": "290", "startMs": "1665778731786", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $352, $361 := $351", "$300 := SUM($350)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $341, $351 := $2, $352 := $3", "INNER HASH JOIN EACH WITH ALL ON $340 = $1" ] }, { "kind": "JOIN", "substeps": [ "$340 := $21, $341 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$361, $360, $300", "TO __stage0E_output", "BY HASH($360, $361)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "3", "computeMsAvg": "10", "computeMsMax": "11", "computeRatioAvg": 0.02824858757062147, "computeRatioMax": 0.031073446327683617, "endMs": "1665778732089", "id": "15", "inputStages": [ "14", "11", "12" ], "name": "S0F: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "7503", "shuffleOutputBytesSpilled": "0", "slotMs": "135", "startMs": "1665778732037", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$361, $360, $300", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$400, $310", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $270", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($153, 0), $151, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361", "$240 := SUM($300)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := NULL", "$191 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$130, $150, $151, $152, $154", "TO __stage0F_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "29", "writeMsMax": "43", "writeRatioAvg": 0.08192090395480225, "writeRatioMax": 0.12146892655367232 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.025423728813559324, "computeRatioMax": 0.025423728813559324, "endMs": "1665778732151", "id": "16", "name": "S10: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665778732116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $501, $502, $500", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($510, 0)", "$171 := coalesce($510, 1)", "$172 := coalesce($511, '')", "$173 := coalesce($511, '0')", "$174 := coalesce($512, NUMERIC<...>)", "$175 := coalesce($512, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$230 := MIN($290)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.05367231638418079, "writeRatioMax": 0.05367231638418079 }, { "completedParallelInputs": "90", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.022598870056497175, "computeRatioMax": 0.04519774011299435, "endMs": "1665778732207", "id": "18", "inputStages": [ "16" ], "name": "S12: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2907", "startMs": "1665778732162", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.03954802259887006, "writeRatioMax": 0.0480225988700565 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.022598870056497175, "computeRatioMax": 0.0423728813559322, "endMs": "1665778732207", "id": "19", "inputStages": [ "18", "15" ], "name": "S13: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8700", "shuffleOutputBytesSpilled": "0", "slotMs": "2285", "startMs": "1665778732168", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $150, $151, $152, $154", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$210, $470, $471, $472, $473, $474", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "FROM __stage12_output" ] }, { "kind": "SORT", "substeps": [ "$114 DESC, $90 ASC, $110 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := case_no_value(equal($114, 0), $112, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := RANK() OVER (PARTITION BY $444, $440 ORDER BY $441 DESC)" ] }, { "kind": "SORT", "substeps": [ "$204 ASC, $200 ASC, $201 DESC" ] }, { "kind": "JOIN", "substeps": [ "$520 := $221, $521 := $222, $522 := $223, $523 := $224, $524 := $230", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171, $162 = $172, $163 = $173, $164 = $174, $165 = $175" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($224, 0)", "$161 := coalesce($224, 1)", "$162 := coalesce($220, '')", "$163 := coalesce($220, '0')", "$164 := coalesce($221, NUMERIC<...>)", "$165 := coalesce($221, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535", "TO __stage13_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.00847457627118644, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "13", "writeMsMax": "18", "writeRatioAvg": 0.03672316384180791, "writeRatioMax": 0.05084745762711865 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.02824858757062147, "computeRatioMax": 0.02824858757062147, "endMs": "1665778732220", "id": "20", "inputStages": [ "19" ], "name": "S14: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5608", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665778732177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535", "FROM __stage13_output" ] }, { "kind": "SORT", "substeps": [ "$535 DESC, $530 ASC, $531 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$540, $541, $542, $543, $544", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002824858757062147, "waitRatioMax": 0.002824858757062147, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.00847457627118644, "writeRatioMax": 0.00847457627118644 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "13", "elapsedMs": "602", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "1377" }, { "activeUnits": "2", "completedUnits": "206", "elapsedMs": "727", "estimatedRunnableUnits": "0", "pendingUnits": "10", "totalSlotMs": "6595" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24646191", "totalPartitionsProcessed": "0", "totalSlotMs": "6595", "transferredBytes": "0" }, "startTime": "1665778731530", "totalBytesProcessed": "24646191", "totalSlotMs": "6595" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon1bbddc22_8ebd_4e2f_8991_a8bb4f19817d" }, "priority": "INTERACTIVE", "query": "-- start query 86 in stream 0 using template query86.tpl\nwith results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n web_sales\n ,date_dim d1\n ,item\n where\n d1.d_month_seq between 1200 and 1200+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n union all\n select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n union all\n select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\nselect \n total_sum ,i_category ,i_class, lochierarchy \n ,rank() over (\n partition by lochierarchy,\n case when g_class = 0 then i_category end \n order by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n lochierarchy desc,\n case when lochierarchy = 0 then i_category end,\n rank_within_parent \nLIMIT 100;\n-- end query 86 in stream 0 using template query86.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "VUMCP9sjKZmRKIRdbj4srQ==", "id": "test-project-364309:europe-west1.query86_1665778733", "jobReference": { "jobId": "query86_1665778733", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query86_1665778733?location=europe-west1", "statistics": { "creationTime": "1665778734172", "endTime": "1665778734912", "finalExecutionDurationMs": "561", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24646191", "performanceInsights": { "avgPreviousExecutionMs": "669" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03557312252964427, "computeRatioMax": 0.03557312252964427, "endMs": "1665778734339", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.015810276679841896, "readRatioMax": 0.015810276679841896, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778734311", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06324110671936758, "writeRatioMax": 0.06324110671936758 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05138339920948617, "computeRatioMax": 0.05138339920948617, "endMs": "1665778734368", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02766798418972332, "readRatioMax": 0.02766798418972332, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778734327", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05138339920948617, "writeRatioMax": 0.05138339920948617 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.05533596837944664, "computeRatioMax": 0.05533596837944664, "endMs": "1665778734401", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02766798418972332, "readRatioMax": 0.02766798418972332, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778734368", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage03_output" ] } ], "waitMsAvg": "17", "waitMsMax": "17", "waitRatioAvg": 0.06719367588932806, "waitRatioMax": 0.06719367588932806, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06324110671936758, "writeRatioMax": 0.06324110671936758 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.06324110671936758, "computeRatioMax": 0.06324110671936758, "endMs": "1665778734419", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.043478260869565216, "readRatioMax": 0.043478260869565216, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665778734370", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.019762845849802372, "waitRatioMax": 0.019762845849802372, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05928853754940711, "writeRatioMax": 0.05928853754940711 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.07905138339920949, "computeRatioMax": 0.07905138339920949, "endMs": "1665778734438", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03162055335968379, "readRatioMax": 0.03162055335968379, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778734392", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.09486166007905138, "writeRatioMax": 0.09486166007905138 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02766798418972332, "computeRatioMax": 0.02766798418972332, "endMs": "1665778734444", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.019762845849802372, "readRatioMax": 0.019762845849802372, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665778734407", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05928853754940711, "writeRatioMax": 0.05928853754940711 }, { "completedParallelInputs": "1", "computeMsAvg": "253", "computeMsMax": "253", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778734598", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "26", "readMsMax": "26", "readRatioAvg": 0.10276679841897234, "readRatioMax": 0.10276679841897234, "recordsRead": "737750", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "242", "startMs": "1665778734419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$330 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421", "INNER HASH JOIN EACH WITH ALL ON $420 = $40" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$330", "TO __stage09_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.007905138339920948, "writeRatioMax": 0.007905138339920948 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.019762845849802372, "computeRatioMax": 0.019762845849802372, "endMs": "1665778734615", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "215", "startMs": "1665778734421", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := NULL", "$261 := 1", "$262 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$270 := SUM($330)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $270", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.007905138339920948, "writeRatioMax": 0.007905138339920948 }, { "completedParallelInputs": "1", "computeMsAvg": "245", "computeMsMax": "245", "computeRatioAvg": 0.9683794466403162, "computeRatioMax": 0.9683794466403162, "endMs": "1665778734580", "id": "11", "inputStages": [ "3", "4" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.05533596837944664, "readRatioMax": 0.05533596837944664, "recordsRead": "737750", "recordsWritten": "11", "shuffleOutputBytes": "297", "shuffleOutputBytesSpilled": "0", "slotMs": "221", "startMs": "1665778734435", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391", "$310 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $11", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $31, $381 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$400, $310", "TO __stage0B_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02766798418972332, "writeRatioMax": 0.02766798418972332 }, { "completedParallelInputs": "1", "computeMsAvg": "216", "computeMsMax": "216", "computeRatioAvg": 0.8537549407114624, "computeRatioMax": 0.8537549407114624, "endMs": "1665778734628", "id": "12", "inputStages": [ "7", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.05928853754940711, "readRatioMax": 0.05928853754940711, "recordsRead": "737750", "recordsWritten": "121", "shuffleOutputBytes": "4746", "shuffleOutputBytesSpilled": "0", "slotMs": "204", "startMs": "1665778734470", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $352, $361 := $351", "$300 := SUM($350)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $341, $351 := $2, $352 := $3", "INNER HASH JOIN EACH WITH ALL ON $340 = $1" ] }, { "kind": "JOIN", "substeps": [ "$340 := $21, $341 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$361, $360, $300", "TO __stage0C_output", "BY HASH($360, $361)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.023715415019762844, "writeRatioMax": 0.023715415019762844 }, { "completedParallelInputs": "3", "computeMsAvg": "13", "computeMsMax": "14", "computeRatioAvg": 0.05138339920948617, "computeRatioMax": 0.05533596837944664, "endMs": "1665778734718", "id": "13", "inputStages": [ "10", "11", "12" ], "name": "S0D: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "7503", "shuffleOutputBytesSpilled": "0", "slotMs": "131", "startMs": "1665778734668", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$361, $360, $300", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$400, $310", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $270", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($153, 0), $151, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361", "$240 := SUM($300)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := NULL", "$191 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$130, $150, $151, $152, $154", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "19", "writeMsMax": "26", "writeRatioAvg": 0.07509881422924901, "writeRatioMax": 0.10276679841897234 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03162055335968379, "computeRatioMax": 0.03162055335968379, "endMs": "1665778734773", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665778734737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $501, $502, $500", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($510, 0)", "$171 := coalesce($510, 1)", "$172 := coalesce($511, '')", "$173 := coalesce($511, '0')", "$174 := coalesce($512, NUMERIC<...>)", "$175 := coalesce($512, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$230 := MIN($290)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.003952569169960474, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07114624505928854, "writeRatioMax": 0.07114624505928854 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.03162055335968379, "computeRatioMax": 0.05138339920948617, "endMs": "1665778734831", "id": "16", "inputStages": [ "14" ], "name": "S10: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3382", "startMs": "1665778734783", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003952569169960474, "waitRatioMax": 0.007905138339920948, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.05533596837944664, "writeRatioMax": 0.07509881422924901 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "15", "computeRatioAvg": 0.03557312252964427, "computeRatioMax": 0.05928853754940711, "endMs": "1665778734831", "id": "17", "inputStages": [ "16", "13" ], "name": "S11: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8700", "shuffleOutputBytesSpilled": "0", "slotMs": "3147", "startMs": "1665778734787", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $150, $151, $152, $154", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$210, $470, $471, $472, $473, $474", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$114 DESC, $90 ASC, $110 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := case_no_value(equal($114, 0), $112, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := RANK() OVER (PARTITION BY $444, $440 ORDER BY $441 DESC)" ] }, { "kind": "SORT", "substeps": [ "$204 ASC, $200 ASC, $201 DESC" ] }, { "kind": "JOIN", "substeps": [ "$520 := $221, $521 := $222, $522 := $223, $523 := $224, $524 := $230", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171, $162 = $172, $163 = $173, $164 = $174, $165 = $175" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($224, 0)", "$161 := coalesce($224, 1)", "$162 := coalesce($220, '')", "$163 := coalesce($220, '0')", "$164 := coalesce($221, NUMERIC<...>)", "$165 := coalesce($221, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.011857707509881422, "waitRatioMax": 0.015810276679841896, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.05533596837944664, "writeRatioMax": 0.07509881422924901 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.039525691699604744, "computeRatioMax": 0.039525691699604744, "endMs": "1665778734844", "id": "18", "inputStages": [ "17" ], "name": "S12: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5608", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665778734798", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535", "FROM __stage11_output" ] }, { "kind": "SORT", "substeps": [ "$535 DESC, $530 ASC, $531 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$540, $541, $542, $543, $544", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007905138339920948, "waitRatioMax": 0.007905138339920948, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.015810276679841896, "writeRatioMax": 0.015810276679841896 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "202", "completedUnits": "14", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "202", "totalSlotMs": "1428" }, { "activeUnits": "202", "completedUnits": "216", "elapsedMs": "655", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7901" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24646191", "totalPartitionsProcessed": "0", "totalSlotMs": "7901", "transferredBytes": "0" }, "startTime": "1665778734214", "totalBytesProcessed": "24646191", "totalSlotMs": "7901" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon35e69c96_c257_4b92_b229_fbb6d6886829" }, "priority": "INTERACTIVE", "query": "-- start query 86 in stream 0 using template query86.tpl\nwith results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n web_sales\n ,date_dim d1\n ,item\n where\n d1.d_month_seq between 1200 and 1200+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n union all\n select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n union all\n select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\nselect \n total_sum ,i_category ,i_class, lochierarchy \n ,rank() over (\n partition by lochierarchy,\n case when g_class = 0 then i_category end \n order by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n lochierarchy desc,\n case when lochierarchy = 0 then i_category end,\n rank_within_parent \nLIMIT 100;\n-- end query 86 in stream 0 using template query86.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "00BcRJuROkxEwCKxJhp93g==", "id": "test-project-364309:europe-west1.query86_1665778735", "jobReference": { "jobId": "query86_1665778735", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query86_1665778735?location=europe-west1", "statistics": { "creationTime": "1665778736500", "endTime": "1665778737421", "finalExecutionDurationMs": "717", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24646191", "performanceInsights": { "avgPreviousExecutionMs": "657" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04100946372239748, "computeRatioMax": 0.04100946372239748, "endMs": "1665778736704", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.015772870662460567, "readRatioMax": 0.015772870662460567, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665778736663", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006309148264984227, "waitRatioMax": 0.006309148264984227, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.050473186119873815, "writeRatioMax": 0.050473186119873815 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04100946372239748, "computeRatioMax": 0.04100946372239748, "endMs": "1665778736736", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.015772870662460567, "readRatioMax": 0.015772870662460567, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665778736682", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.08832807570977919, "writeRatioMax": 0.08832807570977919 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.06309148264984227, "computeRatioMax": 0.06309148264984227, "endMs": "1665778736768", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.015772870662460567, "readRatioMax": 0.015772870662460567, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665778736725", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006309148264984227, "waitRatioMax": 0.006309148264984227, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03785488958990536, "writeRatioMax": 0.03785488958990536 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.028391167192429023, "computeRatioMax": 0.028391167192429023, "endMs": "1665778736779", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.01892744479495268, "readRatioMax": 0.01892744479495268, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665778736742", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.03785488958990536, "writeRatioMax": 0.03785488958990536 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.04416403785488959, "computeRatioMax": 0.04416403785488959, "endMs": "1665778736830", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.015772870662460567, "readRatioMax": 0.015772870662460567, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665778736777", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.06624605678233439, "writeRatioMax": 0.06624605678233439 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03785488958990536, "computeRatioMax": 0.03785488958990536, "endMs": "1665778736834", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.025236593059936908, "readRatioMax": 0.025236593059936908, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665778736793", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006309148264984227, "waitRatioMax": 0.006309148264984227, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.025236593059936908, "writeRatioMax": 0.025236593059936908 }, { "completedParallelInputs": "1", "computeMsAvg": "179", "computeMsMax": "179", "computeRatioAvg": 0.5646687697160884, "computeRatioMax": 0.5646687697160884, "endMs": "1665778736964", "id": "9", "inputStages": [ "0", "1" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0473186119873817, "readRatioMax": 0.0473186119873817, "recordsRead": "737750", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "139", "startMs": "1665778736827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$330 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421", "INNER HASH JOIN EACH WITH ALL ON $420 = $40" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$330", "TO __stage09_output" ] } ], "waitMsAvg": "10", "waitMsMax": "10", "waitRatioAvg": 0.031545741324921134, "waitRatioMax": 0.031545741324921134, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0031545741324921135, "writeRatioMax": 0.0031545741324921135 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.01892744479495268, "computeRatioMax": 0.01892744479495268, "endMs": "1665778737009", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "131", "startMs": "1665778736827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := NULL", "$261 := 1", "$262 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$270 := SUM($330)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $270", "TO __stage0A_output" ] } ], "waitMsAvg": "11", "waitMsMax": "11", "waitRatioAvg": 0.03470031545741325, "waitRatioMax": 0.03470031545741325, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.006309148264984227, "writeRatioMax": 0.006309148264984227 }, { "completedParallelInputs": "1", "computeMsAvg": "317", "computeMsMax": "317", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778737047", "id": "11", "inputStages": [ "4", "3" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0473186119873817, "readRatioMax": 0.0473186119873817, "recordsRead": "737750", "recordsWritten": "11", "shuffleOutputBytes": "297", "shuffleOutputBytesSpilled": "0", "slotMs": "273", "startMs": "1665778736857", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391", "$310 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $11", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $31, $381 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$400, $310", "TO __stage0B_output", "BY HASH($400)" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.01892744479495268, "waitRatioMax": 0.01892744479495268, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.022082018927444796, "writeRatioMax": 0.022082018927444796 }, { "completedParallelInputs": "1", "computeMsAvg": "254", "computeMsMax": "254", "computeRatioAvg": 0.8012618296529969, "computeRatioMax": 0.8012618296529969, "endMs": "1665778737079", "id": "12", "inputStages": [ "7", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "29", "readMsMax": "29", "readRatioAvg": 0.0914826498422713, "readRatioMax": 0.0914826498422713, "recordsRead": "737750", "recordsWritten": "121", "shuffleOutputBytes": "4746", "shuffleOutputBytesSpilled": "0", "slotMs": "261", "startMs": "1665778736879", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $352, $361 := $351", "$300 := SUM($350)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $341, $351 := $2, $352 := $3", "INNER HASH JOIN EACH WITH ALL ON $340 = $1" ] }, { "kind": "JOIN", "substeps": [ "$340 := $21, $341 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$361, $360, $300", "TO __stage0C_output", "BY HASH($360, $361)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00946372239747634, "waitRatioMax": 0.00946372239747634, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.025236593059936908, "writeRatioMax": 0.025236593059936908 }, { "completedParallelInputs": "3", "computeMsAvg": "11", "computeMsMax": "14", "computeRatioAvg": 0.03470031545741325, "computeRatioMax": 0.04416403785488959, "endMs": "1665778737200", "id": "13", "inputStages": [ "10", "11", "12" ], "name": "S0D: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "7503", "shuffleOutputBytesSpilled": "0", "slotMs": "105", "startMs": "1665778737151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$361, $360, $300", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$400, $310", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $270", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($153, 0), $151, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361", "$240 := SUM($300)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := NULL", "$191 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$130, $150, $151, $152, $154", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "18", "writeMsMax": "25", "writeRatioAvg": 0.056782334384858045, "writeRatioMax": 0.07886435331230283 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.022082018927444796, "computeRatioMax": 0.022082018927444796, "endMs": "1665778737264", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665778737229", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $501, $502, $500", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($510, 0)", "$171 := coalesce($510, 1)", "$172 := coalesce($511, '')", "$173 := coalesce($511, '0')", "$174 := coalesce($512, NUMERIC<...>)", "$175 := coalesce($512, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$230 := MIN($290)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0031545741324921135, "waitRatioMax": 0.0031545741324921135, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.056782334384858045, "writeRatioMax": 0.056782334384858045 }, { "completedParallelInputs": "92", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.025236593059936908, "computeRatioMax": 0.04100946372239748, "endMs": "1665778737326", "id": "16", "inputStages": [ "14" ], "name": "S10: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2735", "startMs": "1665778737281", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.006309148264984227, "waitRatioMax": 0.012618296529968454, "writeMsAvg": "14", "writeMsMax": "18", "writeRatioAvg": 0.04416403785488959, "writeRatioMax": 0.056782334384858045 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.025236593059936908, "computeRatioMax": 0.04416403785488959, "endMs": "1665778737326", "id": "17", "inputStages": [ "16", "13" ], "name": "S11: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8700", "shuffleOutputBytesSpilled": "0", "slotMs": "2150", "startMs": "1665778737286", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $150, $151, $152, $154", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$210, $470, $471, $472, $473, $474", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$114 DESC, $90 ASC, $110 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := case_no_value(equal($114, 0), $112, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := RANK() OVER (PARTITION BY $444, $440 ORDER BY $441 DESC)" ] }, { "kind": "SORT", "substeps": [ "$204 ASC, $200 ASC, $201 DESC" ] }, { "kind": "JOIN", "substeps": [ "$520 := $221, $521 := $222, $522 := $223, $523 := $224, $524 := $230", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171, $162 = $172, $163 = $173, $164 = $174, $165 = $175" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($224, 0)", "$161 := coalesce($224, 1)", "$162 := coalesce($220, '')", "$163 := coalesce($220, '0')", "$164 := coalesce($221, NUMERIC<...>)", "$165 := coalesce($221, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535", "TO __stage11_output" ] } ], "waitMsAvg": "5", "waitMsMax": "6", "waitRatioAvg": 0.015772870662460567, "waitRatioMax": 0.01892744479495268, "writeMsAvg": "13", "writeMsMax": "21", "writeRatioAvg": 0.04100946372239748, "writeRatioMax": 0.06624605678233439 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.01892744479495268, "computeRatioMax": 0.01892744479495268, "endMs": "1665778737343", "id": "18", "inputStages": [ "17" ], "name": "S12: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5608", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778737298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535", "FROM __stage11_output" ] }, { "kind": "SORT", "substeps": [ "$535 DESC, $530 ASC, $531 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$540, $541, $542, $543, $544", "TO __stage12_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00946372239747634, "waitRatioMax": 0.00946372239747634, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.012618296529968454, "writeRatioMax": 0.012618296529968454 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "3", "completedUnits": "10", "elapsedMs": "621", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "1086" }, { "activeUnits": "3", "completedUnits": "208", "elapsedMs": "835", "estimatedRunnableUnits": "0", "pendingUnits": "8", "totalSlotMs": "6102" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24646191", "totalPartitionsProcessed": "0", "totalSlotMs": "6102", "transferredBytes": "0" }, "startTime": "1665778736543", "totalBytesProcessed": "24646191", "totalSlotMs": "6102" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6efbfac2_0682_4a62_b6cb_8de04fe1c289" }, "priority": "INTERACTIVE", "query": "-- start query 86 in stream 0 using template query86.tpl\nwith results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n web_sales\n ,date_dim d1\n ,item\n where\n d1.d_month_seq between 1200 and 1200+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n union all\n select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n union all\n select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\nselect \n total_sum ,i_category ,i_class, lochierarchy \n ,rank() over (\n partition by lochierarchy,\n case when g_class = 0 then i_category end \n order by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n lochierarchy desc,\n case when lochierarchy = 0 then i_category end,\n rank_within_parent \nLIMIT 100;\n-- end query 86 in stream 0 using template query86.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "PnErWHP6f4C5wnZeR5Jzrg==", "id": "test-project-364309:europe-west1.query86_1665778738", "jobReference": { "jobId": "query86_1665778738", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query86_1665778738?location=europe-west1", "statistics": { "creationTime": "1665778739140", "endTime": "1665778739883", "finalExecutionDurationMs": "569", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "24646191", "performanceInsights": { "avgPreviousExecutionMs": "663" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05485232067510549, "computeRatioMax": 0.05485232067510549, "endMs": "1665778739303", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02531645569620253, "readRatioMax": 0.02531645569620253, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "162000", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778739270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$40", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.0759493670886076, "writeRatioMax": 0.0759493670886076 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.029535864978902954, "computeRatioMax": 0.029535864978902954, "endMs": "1665778739317", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.029535864978902954, "readRatioMax": 0.029535864978902954, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665778739285", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$80:d_date_sk, $81:d_month_seq", "FROM date_dim", "WHERE between($81, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$80", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.029535864978902954, "writeRatioMax": 0.029535864978902954 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.0759493670886076, "computeRatioMax": 0.0759493670886076, "endMs": "1665778739346", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.046413502109704644, "readRatioMax": 0.046413502109704644, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "357677", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665778739314", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:i_item_sk, $11:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.04219409282700422, "writeRatioMax": 0.04219409282700422 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.05063291139240506, "endMs": "1665778739373", "id": "4", "name": "S04: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03375527426160337, "readRatioMax": 0.03375527426160337, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665778739329", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$60:d_date_sk, $61:d_month_seq", "FROM date_dim", "WHERE between($61, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$60", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05063291139240506, "writeRatioMax": 0.05063291139240506 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.07172995780590717, "computeRatioMax": 0.07172995780590717, "endMs": "1665778739399", "id": "6", "name": "S06: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02109704641350211, "readRatioMax": 0.02109704641350211, "recordsRead": "18000", "recordsWritten": "18000", "shuffleOutputBytes": "587163", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665778739358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:i_item_sk, $2:i_class, $3:i_category", "FROM item" ] }, { "kind": "WRITE", "substeps": [ "$1, $2, $3", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.10548523206751055, "writeRatioMax": 0.10548523206751055 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.06751054852320675, "computeRatioMax": 0.06751054852320675, "endMs": "1665778739405", "id": "7", "name": "S07: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.0379746835443038, "readRatioMax": 0.0379746835443038, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665778739374", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_month_seq", "FROM date_dim", "WHERE between($51, 1200, 1211)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage07_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0379746835443038, "writeRatioMax": 0.0379746835443038 }, { "completedParallelInputs": "1", "computeMsAvg": "209", "computeMsMax": "209", "computeRatioAvg": 0.8818565400843882, "computeRatioMax": 0.8818565400843882, "endMs": "1665778739561", "id": "9", "inputStages": [ "1", "0" ], "name": "S09: Join+", "parallelInputs": "1", "readMsAvg": "30", "readMsMax": "30", "readRatioAvg": 0.12658227848101267, "readRatioMax": 0.12658227848101267, "recordsRead": "737750", "recordsWritten": "1", "shuffleOutputBytes": "17", "shuffleOutputBytesSpilled": "0", "slotMs": "252", "startMs": "1665778739391", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$80", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$40", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$330 := SUM($430)" ] }, { "kind": "JOIN", "substeps": [ "$430 := $421", "INNER HASH JOIN EACH WITH ALL ON $420 = $40" ] }, { "kind": "JOIN", "substeps": [ "$420 := $71, $421 := $72", "INNER HASH JOIN EACH WITH ALL ON $70 = $80" ] }, { "kind": "WRITE", "substeps": [ "$330", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008438818565400843, "waitRatioMax": 0.008438818565400843, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.008438818565400843, "writeRatioMax": 0.008438818565400843 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0379746835443038, "computeRatioMax": 0.0379746835443038, "endMs": "1665778739578", "id": "10", "inputStages": [ "9" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "36", "shuffleOutputBytesSpilled": "0", "slotMs": "143", "startMs": "1665778739393", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$330", "FROM __stage09_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := NULL", "$261 := 1", "$262 := 2" ] }, { "kind": "AGGREGATE", "substeps": [ "$270 := SUM($330)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $262, $270", "TO __stage0A_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.012658227848101266, "waitRatioMax": 0.012658227848101266, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.016877637130801686, "writeRatioMax": 0.016877637130801686 }, { "completedParallelInputs": "1", "computeMsAvg": "168", "computeMsMax": "168", "computeRatioAvg": 0.7088607594936709, "computeRatioMax": 0.7088607594936709, "endMs": "1665778739528", "id": "11", "inputStages": [ "3", "4" ], "name": "S0B: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.05063291139240506, "readRatioMax": 0.05063291139240506, "recordsRead": "737750", "recordsWritten": "11", "shuffleOutputBytes": "297", "shuffleOutputBytesSpilled": "0", "slotMs": "164", "startMs": "1665778739404", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$60", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $400 := $391", "$310 := SUM($390)" ] }, { "kind": "JOIN", "substeps": [ "$390 := $381, $391 := $11", "INNER HASH JOIN EACH WITH ALL ON $380 = $10" ] }, { "kind": "JOIN", "substeps": [ "$380 := $31, $381 := $32", "INNER HASH JOIN EACH WITH ALL ON $30 = $60" ] }, { "kind": "WRITE", "substeps": [ "$400, $310", "TO __stage0B_output", "BY HASH($400)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.02109704641350211, "writeRatioMax": 0.02109704641350211 }, { "completedParallelInputs": "1", "computeMsAvg": "237", "computeMsMax": "237", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665778739573", "id": "12", "inputStages": [ "7", "6" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.0759493670886076, "readRatioMax": 0.0759493670886076, "recordsRead": "737750", "recordsWritten": "121", "shuffleOutputBytes": "4746", "shuffleOutputBytesSpilled": "0", "slotMs": "225", "startMs": "1665778739423", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_net_paid", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage07_output" ] }, { "kind": "READ", "substeps": [ "$1, $2, $3", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $360 := $352, $361 := $351", "$300 := SUM($350)" ] }, { "kind": "JOIN", "substeps": [ "$350 := $341, $351 := $2, $352 := $3", "INNER HASH JOIN EACH WITH ALL ON $340 = $1" ] }, { "kind": "JOIN", "substeps": [ "$340 := $21, $341 := $22", "INNER HASH JOIN EACH WITH ALL ON $20 = $50" ] }, { "kind": "WRITE", "substeps": [ "$361, $360, $300", "TO __stage0C_output", "BY HASH($360, $361)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02531645569620253, "writeRatioMax": 0.02531645569620253 }, { "completedParallelInputs": "3", "computeMsAvg": "12", "computeMsMax": "23", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.0970464135021097, "endMs": "1665778739684", "id": "13", "inputStages": [ "10", "11", "12" ], "name": "S0D: Aggregate+", "parallelInputs": "3", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "7503", "shuffleOutputBytesSpilled": "0", "slotMs": "147", "startMs": "1665778739628", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$361, $360, $300", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$400, $310", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$260, $261, $262, $270", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$130 := case_no_value(equal($153, 0), $151, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := 0" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $370 := $360, $371 := $361", "$240 := SUM($300)" ] }, { "kind": "COMPUTE", "substeps": [ "$190 := NULL", "$191 := 1" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $410 := $400", "$250 := SUM($310)" ] }, { "kind": "WRITE", "substeps": [ "$130, $150, $151, $152, $154", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "20", "writeMsMax": "30", "writeRatioAvg": 0.08438818565400844, "writeRatioMax": 0.12658227848101267 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05063291139240506, "computeRatioMax": 0.05063291139240506, "endMs": "1665778739734", "id": "14", "name": "S0E: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665778739701", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$290, $501, $502, $500", "FROM __SHUFFLE5" ] }, { "kind": "COMPUTE", "substeps": [ "$170 := coalesce($510, 0)", "$171 := coalesce($510, 1)", "$172 := coalesce($511, '')", "$173 := coalesce($511, '0')", "$174 := coalesce($512, NUMERIC<...>)", "$175 := coalesce($512, NUMERIC<...>)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $510 := $500, $511 := $501, $512 := $502", "$230 := MIN($290)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004219409282700422, "waitRatioMax": 0.004219409282700422, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.08860759493670886, "writeRatioMax": 0.08860759493670886 }, { "completedParallelInputs": "91", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.03375527426160337, "computeRatioMax": 0.07172995780590717, "endMs": "1665778739782", "id": "16", "inputStages": [ "14" ], "name": "S10: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3246", "startMs": "1665778739740", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008438818565400843, "waitRatioMax": 0.012658227848101266, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.05907172995780591, "writeRatioMax": 0.08016877637130802 }, { "completedParallelInputs": "101", "computeMsAvg": "7", "computeMsMax": "16", "computeRatioAvg": 0.029535864978902954, "computeRatioMax": 0.06751054852320675, "endMs": "1665778739781", "id": "17", "inputStages": [ "16", "13" ], "name": "S11: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "133", "shuffleOutputBytes": "8700", "shuffleOutputBytesSpilled": "0", "slotMs": "2471", "startMs": "1665778739745", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $150, $151, $152, $154", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$210, $470, $471, $472, $473, $474", "FROM __SHUFFLE4" ] }, { "kind": "READ", "substeps": [ "$170, $171, $172, $173, $174, $175, $230", "FROM __stage10_output" ] }, { "kind": "SORT", "substeps": [ "$114 DESC, $90 ASC, $110 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := case_no_value(equal($114, 0), $112, NULL)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$120 := RANK() OVER (PARTITION BY $444, $440 ORDER BY $441 DESC)" ] }, { "kind": "SORT", "substeps": [ "$204 ASC, $200 ASC, $201 DESC" ] }, { "kind": "JOIN", "substeps": [ "$520 := $221, $521 := $222, $522 := $223, $523 := $224, $524 := $230", "INNER HASH JOIN EACH WITH ALL ON $160 = $170, $161 = $171, $162 = $172, $163 = $173, $164 = $174, $165 = $175" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := coalesce($224, 0)", "$161 := coalesce($224, 1)", "$162 := coalesce($220, '')", "$163 := coalesce($220, '0')", "$164 := coalesce($221, NUMERIC<...>)", "$165 := coalesce($221, NUMERIC<...>)" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $532, $533, $534, $535", "TO __stage11_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.016877637130801686, "waitRatioMax": 0.02109704641350211, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.05485232067510549, "writeRatioMax": 0.08438818565400844 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.06329113924050633, "computeRatioMax": 0.06329113924050633, "endMs": "1665778739805", "id": "18", "inputStages": [ "17" ], "name": "S12: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "133", "recordsWritten": "100", "shuffleOutputBytes": "5608", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665778739755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $532, $533, $534, $535", "FROM __stage11_output" ] }, { "kind": "SORT", "substeps": [ "$535 DESC, $530 ASC, $531 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$540, $541, $542, $543, $544", "TO __stage12_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.012658227848101266, "waitRatioMax": 0.012658227848101266, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.02109704641350211, "writeRatioMax": 0.02109704641350211 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "176", "completedUnits": "37", "elapsedMs": "592", "estimatedRunnableUnits": "0", "pendingUnits": "179", "totalSlotMs": "1954" }, { "activeUnits": "145", "completedUnits": "207", "elapsedMs": "658", "estimatedRunnableUnits": "0", "pendingUnits": "9", "totalSlotMs": "6913" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "24646191", "totalPartitionsProcessed": "0", "totalSlotMs": "6913", "transferredBytes": "0" }, "startTime": "1665778739181", "totalBytesProcessed": "24646191", "totalSlotMs": "6913" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
