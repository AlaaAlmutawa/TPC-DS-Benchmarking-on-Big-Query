{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond906c356_989b_4c45_8e6d_7efef5a6f29e" }, "priority": "INTERACTIVE", "query": "-- start query 19 in stream 0 using template query19.tpl\n\n/*\nSelect the top revenue generating products bought by out of zip code customers for a given year, month and manager. \nQualification Substitution Parameters\n*/\n\nselect i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n from date_dim, store_sales, item,customer,customer_address,store\n where d_date_sk = ss_sold_date_sk\n and ss_item_sk = i_item_sk\n and i_manager_id=8\n and d_moy=11\n and d_year=1998\n and ss_customer_sk = c_customer_sk \n and c_current_addr_sk = ca_address_sk\n and substr(ca_zip,1,5) <> substr(s_zip,1,5) \n and ss_store_sk = s_store_sk \n group by i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n order by ext_price desc\n ,i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n limit 100\n ;\n\n-- end query 19 in stream 0 using template query19.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Th1cSMsT3uFWCR73w4ZpAA==", "id": "test-project-364309:europe-west1.query19_1665768260", "jobReference": { "jobId": "query19_1665768260", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query19_1665768260?location=europe-west1", "statistics": { "creationTime": "1665768260798", "endTime": "1665768261524", "finalExecutionDurationMs": "522", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "138289140", "performanceInsights": { "avgPreviousExecutionMs": "474" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.011990407673860911, "computeRatioMax": 0.011990407673860911, "endMs": "1665768261007", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.007194244604316547, "readRatioMax": 0.007194244604316547, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "228", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768260971", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03836930455635491, "writeRatioMax": 0.03836930455635491 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.05755395683453238, "computeRatioMax": 0.05755395683453238, "endMs": "1665768261023", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014388489208633094, "readRatioMax": 0.014388489208633094, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768260987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03357314148681055, "writeRatioMax": 0.03357314148681055 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.10311750599520383, "computeRatioMax": 0.10311750599520383, "endMs": "1665768261054", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.011990407673860911, "readRatioMax": 0.011990407673860911, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665768261002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.023980815347721823, "writeRatioMax": 0.023980815347721823 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.02158273381294964, "computeRatioMax": 0.02158273381294964, "endMs": "1665768261054", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016786570743405275, "readRatioMax": 0.016786570743405275, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "20641", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768261024", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id", "FROM item", "WHERE equal($45, 8)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43, $44", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03836930455635491, "writeRatioMax": 0.03836930455635491 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.026378896882494004, "computeRatioMax": 0.026378896882494004, "endMs": "1665768261087", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014388489208633094, "readRatioMax": 0.014388489208633094, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768261054", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.016786570743405275, "writeRatioMax": 0.016786570743405275 }, { "completedParallelInputs": "6", "computeMsAvg": "291", "computeMsMax": "417", "computeRatioAvg": 0.697841726618705, "computeRatioMax": 1, "endMs": "1665768261360", "id": "6", "inputStages": [ "3", "5", "1", "2", "0" ], "name": "S06: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "32", "readRatioAvg": 0.05515587529976019, "readRatioMax": 0.07673860911270983, "recordsRead": "3782582", "recordsWritten": "740", "shuffleOutputBytes": "53611", "shuffleOutputBytesSpilled": "0", "slotMs": "1757", "startMs": "1665768261094", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43, $44", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125", "$70 := SUM($121)" ] }, { "kind": "FILTER", "substeps": [ "not_equal(substr($120, 1, 5), substr($126, 1, 5))" ] }, { "kind": "JOIN", "substeps": [ "$120 := $116, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115, $126 := $2", "INNER HASH JOIN EACH WITH ALL ON $110 = $1" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $105, $116 := $11", "INNER HASH JOIN EACH WITH ALL ON $106 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $92, $102 := $93, $103 := $94, $104 := $95, $105 := $96, $106 := $21", "INNER HASH JOIN EACH WITH ALL ON $90 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $81, $91 := $82, $92 := $83, $93 := $41, $94 := $42, $95 := $43, $96 := $44", "INNER HASH JOIN EACH WITH ALL ON $80 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $31, $81 := $32, $82 := $33, $83 := $34", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132, $133, $70", "TO __stage06_output", "BY HASH($130, $131, $132, $133)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.004796163069544364, "writeMsAvg": "6", "writeMsMax": "11", "writeRatioAvg": 0.014388489208633094, "writeRatioMax": 0.026378896882494004 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.011990407673860911, "computeRatioMax": 0.011990407673860911, "endMs": "1665768261377", "id": "7", "inputStages": [ "6" ], "name": "S07: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "740", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665768261368", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132, $133, $70", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.002398081534772182, "writeRatioMax": 0.002398081534772182 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.019184652278177457, "computeRatioMax": 0.019184652278177457, "endMs": "1665768261451", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665768261413", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002398081534772182, "waitRatioMax": 0.002398081534772182, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0407673860911271, "writeRatioMax": 0.0407673860911271 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "13", "elapsedMs": "634", "pendingUnits": "0", "totalSlotMs": "2061" }, { "activeUnits": "0", "completedUnits": "13", "elapsedMs": "648", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2061" } ], "totalBytesBilled": "138412032", "totalBytesProcessed": "138289140", "totalPartitionsProcessed": "0", "totalSlotMs": "2061", "transferredBytes": "0" }, "startTime": "1665768260839", "totalBytesProcessed": "138289140", "totalSlotMs": "2061" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon394c2e15_35c0_41db_9e83_d50e37471a7b" }, "priority": "INTERACTIVE", "query": "-- start query 19 in stream 0 using template query19.tpl\n\n/*\nSelect the top revenue generating products bought by out of zip code customers for a given year, month and manager. \nQualification Substitution Parameters\n*/\n\nselect i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n from date_dim, store_sales, item,customer,customer_address,store\n where d_date_sk = ss_sold_date_sk\n and ss_item_sk = i_item_sk\n and i_manager_id=8\n and d_moy=11\n and d_year=1998\n and ss_customer_sk = c_customer_sk \n and c_current_addr_sk = ca_address_sk\n and substr(ca_zip,1,5) <> substr(s_zip,1,5) \n and ss_store_sk = s_store_sk \n group by i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n order by ext_price desc\n ,i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n limit 100\n ;\n\n-- end query 19 in stream 0 using template query19.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "7gGRd5dzNwnaOuwpeP1KiQ==", "id": "test-project-364309:europe-west1.query19_1665776981", "jobReference": { "jobId": "query19_1665776981", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query19_1665776981?location=europe-west1", "statistics": { "creationTime": "1665776982401", "endTime": "1665776983026", "finalExecutionDurationMs": "405", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "138289140", "performanceInsights": { "avgPreviousExecutionMs": "484" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.021604938271604937, "computeRatioMax": 0.021604938271604937, "endMs": "1665776982608", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.015432098765432098, "readRatioMax": 0.015432098765432098, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "228", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776982576", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030864197530864196, "waitRatioMax": 0.0030864197530864196, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.06481481481481481, "writeRatioMax": 0.06481481481481481 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.08333333333333333, "computeRatioMax": 0.08333333333333333, "endMs": "1665776982623", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.021604938271604937, "readRatioMax": 0.021604938271604937, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776982588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030864197530864196, "waitRatioMax": 0.0030864197530864196, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.027777777777777776, "writeRatioMax": 0.027777777777777776 }, { "completedParallelInputs": "1", "computeMsAvg": "70", "computeMsMax": "70", "computeRatioAvg": 0.21604938271604937, "computeRatioMax": 0.21604938271604937, "endMs": "1665776982654", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.024691358024691357, "readRatioMax": 0.024691358024691357, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "76", "startMs": "1665776982601", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030864197530864196, "waitRatioMax": 0.0030864197530864196, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.037037037037037035, "writeRatioMax": 0.037037037037037035 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.024691358024691357, "computeRatioMax": 0.024691358024691357, "endMs": "1665776982650", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.012345679012345678, "readRatioMax": 0.012345679012345678, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "20641", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776982615", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id", "FROM item", "WHERE equal($45, 8)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43, $44", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030864197530864196, "waitRatioMax": 0.0030864197530864196, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.043209876543209874, "writeRatioMax": 0.043209876543209874 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.021604938271604937, "computeRatioMax": 0.021604938271604937, "endMs": "1665776982680", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.012345679012345678, "readRatioMax": 0.012345679012345678, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776982643", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030864197530864196, "waitRatioMax": 0.0030864197530864196, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.040123456790123455, "writeRatioMax": 0.040123456790123455 }, { "completedParallelInputs": "6", "computeMsAvg": "236", "computeMsMax": "324", "computeRatioAvg": 0.7283950617283951, "computeRatioMax": 1, "endMs": "1665776982894", "id": "6", "inputStages": [ "3", "1", "2", "0", "5" ], "name": "S06: Join+", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "36", "readRatioAvg": 0.06481481481481481, "readRatioMax": 0.1111111111111111, "recordsRead": "3782582", "recordsWritten": "740", "shuffleOutputBytes": "53611", "shuffleOutputBytesSpilled": "0", "slotMs": "1325", "startMs": "1665776982691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43, $44", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125", "$70 := SUM($121)" ] }, { "kind": "FILTER", "substeps": [ "not_equal(substr($120, 1, 5), substr($126, 1, 5))" ] }, { "kind": "JOIN", "substeps": [ "$120 := $116, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115, $126 := $2", "INNER HASH JOIN EACH WITH ALL ON $110 = $1" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $105, $116 := $11", "INNER HASH JOIN EACH WITH ALL ON $106 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $92, $102 := $93, $103 := $94, $104 := $95, $105 := $96, $106 := $21", "INNER HASH JOIN EACH WITH ALL ON $90 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $81, $91 := $82, $92 := $83, $93 := $41, $94 := $42, $95 := $43, $96 := $44", "INNER HASH JOIN EACH WITH ALL ON $80 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $31, $81 := $32, $82 := $33, $83 := $34", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132, $133, $70", "TO __stage06_output", "BY HASH($130, $131, $132, $133)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030864197530864196, "waitRatioMax": 0.0030864197530864196, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.015432098765432098, "writeRatioMax": 0.018518518518518517 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.015432098765432098, "computeRatioMax": 0.015432098765432098, "endMs": "1665776982910", "id": "7", "inputStages": [ "6" ], "name": "S07: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "740", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "9", "startMs": "1665776982900", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132, $133, $70", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030864197530864196, "waitRatioMax": 0.0030864197530864196, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0030864197530864196, "writeRatioMax": 0.0030864197530864196 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.024691358024691357, "computeRatioMax": 0.024691358024691357, "endMs": "1665776982948", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776982912", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0030864197530864196, "waitRatioMax": 0.0030864197530864196, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.046296296296296294, "writeRatioMax": 0.046296296296296294 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "13", "elapsedMs": "526", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1671" } ], "totalBytesBilled": "138412032", "totalBytesProcessed": "138289140", "totalPartitionsProcessed": "0", "totalSlotMs": "1671", "transferredBytes": "0" }, "startTime": "1665776982454", "totalBytesProcessed": "138289140", "totalSlotMs": "1671" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anone990aada_c741_4269_857c_99ab1e43c2ad" }, "priority": "INTERACTIVE", "query": "-- start query 19 in stream 0 using template query19.tpl\n\n/*\nSelect the top revenue generating products bought by out of zip code customers for a given year, month and manager. \nQualification Substitution Parameters\n*/\n\nselect i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n from date_dim, store_sales, item,customer,customer_address,store\n where d_date_sk = ss_sold_date_sk\n and ss_item_sk = i_item_sk\n and i_manager_id=8\n and d_moy=11\n and d_year=1998\n and ss_customer_sk = c_customer_sk \n and c_current_addr_sk = ca_address_sk\n and substr(ca_zip,1,5) <> substr(s_zip,1,5) \n and ss_store_sk = s_store_sk \n group by i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n order by ext_price desc\n ,i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n limit 100\n ;\n\n-- end query 19 in stream 0 using template query19.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "DcNjfmWfytGeqn6PPEdubw==", "id": "test-project-364309:europe-west1.query19_1665776984", "jobReference": { "jobId": "query19_1665776984", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query19_1665776984?location=europe-west1", "statistics": { "creationTime": "1665776984656", "endTime": "1665776985314", "finalExecutionDurationMs": "449", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "138289140", "performanceInsights": { "avgPreviousExecutionMs": "471" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.047021943573667714, "computeRatioMax": 0.047021943573667714, "endMs": "1665776984870", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.025078369905956112, "readRatioMax": 0.025078369905956112, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "228", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776984824", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003134796238244514, "waitRatioMax": 0.003134796238244514, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.034482758620689655, "writeRatioMax": 0.034482758620689655 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.12225705329153605, "computeRatioMax": 0.12225705329153605, "endMs": "1665776984890", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.050156739811912224, "readRatioMax": 0.050156739811912224, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665776984838", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003134796238244514, "waitRatioMax": 0.003134796238244514, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04075235109717868, "writeRatioMax": 0.04075235109717868 }, { "completedParallelInputs": "1", "computeMsAvg": "66", "computeMsMax": "66", "computeRatioAvg": 0.20689655172413793, "computeRatioMax": 0.20689655172413793, "endMs": "1665776984913", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.025078369905956112, "readRatioMax": 0.025078369905956112, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665776984851", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003134796238244514, "waitRatioMax": 0.003134796238244514, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0438871473354232, "writeRatioMax": 0.0438871473354232 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.025078369905956112, "computeRatioMax": 0.025078369905956112, "endMs": "1665776984898", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01567398119122257, "readRatioMax": 0.01567398119122257, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "20641", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776984866", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id", "FROM item", "WHERE equal($45, 8)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43, $44", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003134796238244514, "waitRatioMax": 0.003134796238244514, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.05642633228840126, "writeRatioMax": 0.05642633228840126 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.05329153605015674, "computeRatioMax": 0.05329153605015674, "endMs": "1665776984924", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.04075235109717868, "readRatioMax": 0.04075235109717868, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776984891", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0219435736677116, "writeRatioMax": 0.0219435736677116 }, { "completedParallelInputs": "6", "computeMsAvg": "272", "computeMsMax": "319", "computeRatioAvg": 0.8526645768025078, "computeRatioMax": 1, "endMs": "1665776985167", "id": "6", "inputStages": [ "0", "3", "2", "1", "5" ], "name": "S06: Join+", "parallelInputs": "6", "readMsAvg": "22", "readMsMax": "35", "readRatioAvg": 0.06896551724137931, "readRatioMax": 0.109717868338558, "recordsRead": "3782582", "recordsWritten": "740", "shuffleOutputBytes": "53611", "shuffleOutputBytesSpilled": "0", "slotMs": "1588", "startMs": "1665776984929", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43, $44", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125", "$70 := SUM($121)" ] }, { "kind": "FILTER", "substeps": [ "not_equal(substr($120, 1, 5), substr($126, 1, 5))" ] }, { "kind": "JOIN", "substeps": [ "$120 := $116, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115, $126 := $2", "INNER HASH JOIN EACH WITH ALL ON $110 = $1" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $105, $116 := $11", "INNER HASH JOIN EACH WITH ALL ON $106 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $92, $102 := $93, $103 := $94, $104 := $95, $105 := $96, $106 := $21", "INNER HASH JOIN EACH WITH ALL ON $90 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $81, $91 := $82, $92 := $83, $93 := $41, $94 := $42, $95 := $43, $96 := $44", "INNER HASH JOIN EACH WITH ALL ON $80 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $31, $81 := $32, $82 := $33, $83 := $34", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132, $133, $70", "TO __stage06_output", "BY HASH($130, $131, $132, $133)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.003134796238244514, "waitRatioMax": 0.006269592476489028, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.01567398119122257, "writeRatioMax": 0.025078369905956112 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0219435736677116, "computeRatioMax": 0.0219435736677116, "endMs": "1665776985201", "id": "7", "inputStages": [ "6" ], "name": "S07: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "740", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665776985188", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132, $133, $70", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003134796238244514, "waitRatioMax": 0.003134796238244514, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.003134796238244514, "writeRatioMax": 0.003134796238244514 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.047021943573667714, "computeRatioMax": 0.047021943573667714, "endMs": "1665776985249", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776985201", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164", "TO __stage08_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.047021943573667714, "writeRatioMax": 0.047021943573667714 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "13", "elapsedMs": "565", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1979" } ], "totalBytesBilled": "138412032", "totalBytesProcessed": "138289140", "totalPartitionsProcessed": "0", "totalSlotMs": "1979", "transferredBytes": "0" }, "startTime": "1665776984703", "totalBytesProcessed": "138289140", "totalSlotMs": "1979" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8100ac42_e83d_4501_b8b2_c403d91b0b17" }, "priority": "INTERACTIVE", "query": "-- start query 19 in stream 0 using template query19.tpl\n\n/*\nSelect the top revenue generating products bought by out of zip code customers for a given year, month and manager. \nQualification Substitution Parameters\n*/\n\nselect i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n from date_dim, store_sales, item,customer,customer_address,store\n where d_date_sk = ss_sold_date_sk\n and ss_item_sk = i_item_sk\n and i_manager_id=8\n and d_moy=11\n and d_year=1998\n and ss_customer_sk = c_customer_sk \n and c_current_addr_sk = ca_address_sk\n and substr(ca_zip,1,5) <> substr(s_zip,1,5) \n and ss_store_sk = s_store_sk \n group by i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n order by ext_price desc\n ,i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n limit 100\n ;\n\n-- end query 19 in stream 0 using template query19.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "IJrGNVw3CzY8iz1uXsN7mQ==", "id": "test-project-364309:europe-west1.query19_1665776986", "jobReference": { "jobId": "query19_1665776986", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query19_1665776986?location=europe-west1", "statistics": { "creationTime": "1665776987007", "endTime": "1665776987648", "finalExecutionDurationMs": "423", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "138289140", "performanceInsights": { "avgPreviousExecutionMs": "468" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.03858520900321544, "computeRatioMax": 0.03858520900321544, "endMs": "1665776987225", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.022508038585209004, "readRatioMax": 0.022508038585209004, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "228", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776987179", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003215434083601286, "waitRatioMax": 0.003215434083601286, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.08360128617363344, "writeRatioMax": 0.08360128617363344 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.07717041800643087, "computeRatioMax": 0.07717041800643087, "endMs": "1665776987222", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.022508038585209004, "readRatioMax": 0.022508038585209004, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776987191", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006430868167202572, "waitRatioMax": 0.006430868167202572, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02572347266881029, "writeRatioMax": 0.02572347266881029 }, { "completedParallelInputs": "1", "computeMsAvg": "54", "computeMsMax": "54", "computeRatioAvg": 0.17363344051446947, "computeRatioMax": 0.17363344051446947, "endMs": "1665776987252", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.022508038585209004, "readRatioMax": 0.022508038585209004, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776987206", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006430868167202572, "waitRatioMax": 0.006430868167202572, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.03536977491961415, "writeRatioMax": 0.03536977491961415 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04180064308681672, "computeRatioMax": 0.04180064308681672, "endMs": "1665776987257", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.022508038585209004, "readRatioMax": 0.022508038585209004, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "20641", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776987221", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id", "FROM item", "WHERE equal($45, 8)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43, $44", "TO __stage03_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006430868167202572, "waitRatioMax": 0.006430868167202572, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.028938906752411574, "writeRatioMax": 0.028938906752411574 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.022508038585209004, "computeRatioMax": 0.022508038585209004, "endMs": "1665776987277", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.022508038585209004, "readRatioMax": 0.022508038585209004, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665776987247", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003215434083601286, "waitRatioMax": 0.003215434083601286, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05144694533762058, "writeRatioMax": 0.05144694533762058 }, { "completedParallelInputs": "6", "computeMsAvg": "268", "computeMsMax": "311", "computeRatioAvg": 0.8617363344051447, "computeRatioMax": 1, "endMs": "1665776987520", "id": "6", "inputStages": [ "5", "0", "2", "3", "1" ], "name": "S06: Join+", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "40", "readRatioAvg": 0.07395498392282958, "readRatioMax": 0.12861736334405144, "recordsRead": "3782582", "recordsWritten": "740", "shuffleOutputBytes": "53611", "shuffleOutputBytesSpilled": "0", "slotMs": "1523", "startMs": "1665776987282", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43, $44", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125", "$70 := SUM($121)" ] }, { "kind": "FILTER", "substeps": [ "not_equal(substr($120, 1, 5), substr($126, 1, 5))" ] }, { "kind": "JOIN", "substeps": [ "$120 := $116, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115, $126 := $2", "INNER HASH JOIN EACH WITH ALL ON $110 = $1" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $105, $116 := $11", "INNER HASH JOIN EACH WITH ALL ON $106 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $92, $102 := $93, $103 := $94, $104 := $95, $105 := $96, $106 := $21", "INNER HASH JOIN EACH WITH ALL ON $90 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $81, $91 := $82, $92 := $83, $93 := $41, $94 := $42, $95 := $43, $96 := $44", "INNER HASH JOIN EACH WITH ALL ON $80 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $31, $81 := $32, $82 := $33, $83 := $34", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132, $133, $70", "TO __stage06_output", "BY HASH($130, $131, $132, $133)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003215434083601286, "waitRatioMax": 0.003215434083601286, "writeMsAvg": "6", "writeMsMax": "14", "writeRatioAvg": 0.01929260450160772, "writeRatioMax": 0.04501607717041801 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.02572347266881029, "computeRatioMax": 0.02572347266881029, "endMs": "1665776987536", "id": "7", "inputStages": [ "6" ], "name": "S07: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "740", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665776987524", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132, $133, $70", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003215434083601286, "waitRatioMax": 0.003215434083601286, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.003215434083601286, "writeRatioMax": 0.003215434083601286 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.022508038585209004, "computeRatioMax": 0.022508038585209004, "endMs": "1665776987573", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776987536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.003215434083601286, "waitRatioMax": 0.003215434083601286, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.05144694533762058, "writeRatioMax": 0.05144694533762058 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "13", "elapsedMs": "538", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1771" } ], "totalBytesBilled": "138412032", "totalBytesProcessed": "138289140", "totalPartitionsProcessed": "0", "totalSlotMs": "1771", "transferredBytes": "0" }, "startTime": "1665776987061", "totalBytesProcessed": "138289140", "totalSlotMs": "1771" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4fcfb505_b8f2_4beb_a497_40779c0b0fdd" }, "priority": "INTERACTIVE", "query": "-- start query 19 in stream 0 using template query19.tpl\n\n/*\nSelect the top revenue generating products bought by out of zip code customers for a given year, month and manager. \nQualification Substitution Parameters\n*/\n\nselect i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n from date_dim, store_sales, item,customer,customer_address,store\n where d_date_sk = ss_sold_date_sk\n and ss_item_sk = i_item_sk\n and i_manager_id=8\n and d_moy=11\n and d_year=1998\n and ss_customer_sk = c_customer_sk \n and c_current_addr_sk = ca_address_sk\n and substr(ca_zip,1,5) <> substr(s_zip,1,5) \n and ss_store_sk = s_store_sk \n group by i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n order by ext_price desc\n ,i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n limit 100\n ;\n\n-- end query 19 in stream 0 using template query19.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "szh1m5JeaHXWtfj1LvM05w==", "id": "test-project-364309:europe-west1.query19_1665776988", "jobReference": { "jobId": "query19_1665776988", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query19_1665776988?location=europe-west1", "statistics": { "creationTime": "1665776989310", "endTime": "1665776990047", "finalExecutionDurationMs": "470", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "138289140", "performanceInsights": { "avgPreviousExecutionMs": "462" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.017412935323383085, "computeRatioMax": 0.017412935323383085, "endMs": "1665776989544", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.014925373134328358, "readRatioMax": 0.014925373134328358, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "228", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776989515", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024875621890547263, "waitRatioMax": 0.0024875621890547263, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.04228855721393035, "writeRatioMax": 0.04228855721393035 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.08208955223880597, "computeRatioMax": 0.08208955223880597, "endMs": "1665776989575", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017412935323383085, "readRatioMax": 0.017412935323383085, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776989531", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024875621890547263, "waitRatioMax": 0.0024875621890547263, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.04477611940298507, "writeRatioMax": 0.04477611940298507 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.11194029850746269, "computeRatioMax": 0.11194029850746269, "endMs": "1665776989591", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.017412935323383085, "readRatioMax": 0.017412935323383085, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776989545", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024875621890547263, "waitRatioMax": 0.0024875621890547263, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.024875621890547265, "writeRatioMax": 0.024875621890547265 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.022388059701492536, "computeRatioMax": 0.022388059701492536, "endMs": "1665776989599", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.012437810945273632, "readRatioMax": 0.012437810945273632, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "20641", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665776989561", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id", "FROM item", "WHERE equal($45, 8)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43, $44", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024875621890547263, "waitRatioMax": 0.0024875621890547263, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.03731343283582089, "writeRatioMax": 0.03731343283582089 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.03233830845771144, "computeRatioMax": 0.03233830845771144, "endMs": "1665776989644", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.02736318407960199, "readRatioMax": 0.02736318407960199, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776989598", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.022388059701492536, "writeRatioMax": 0.022388059701492536 }, { "completedParallelInputs": "6", "computeMsAvg": "281", "computeMsMax": "402", "computeRatioAvg": 0.6990049751243781, "computeRatioMax": 1, "endMs": "1665776989885", "id": "6", "inputStages": [ "5", "0", "1", "3", "2" ], "name": "S06: Join+", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "23", "readRatioAvg": 0.04477611940298507, "readRatioMax": 0.05721393034825871, "recordsRead": "3782582", "recordsWritten": "740", "shuffleOutputBytes": "53611", "shuffleOutputBytesSpilled": "0", "slotMs": "1533", "startMs": "1665776989651", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43, $44", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125", "$70 := SUM($121)" ] }, { "kind": "FILTER", "substeps": [ "not_equal(substr($120, 1, 5), substr($126, 1, 5))" ] }, { "kind": "JOIN", "substeps": [ "$120 := $116, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115, $126 := $2", "INNER HASH JOIN EACH WITH ALL ON $110 = $1" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $105, $116 := $11", "INNER HASH JOIN EACH WITH ALL ON $106 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $92, $102 := $93, $103 := $94, $104 := $95, $105 := $96, $106 := $21", "INNER HASH JOIN EACH WITH ALL ON $90 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $81, $91 := $82, $92 := $83, $93 := $41, $94 := $42, $95 := $43, $96 := $44", "INNER HASH JOIN EACH WITH ALL ON $80 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $31, $81 := $32, $82 := $33, $83 := $34", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132, $133, $70", "TO __stage06_output", "BY HASH($130, $131, $132, $133)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.012437810945273632, "writeRatioMax": 0.014925373134328358 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.017412935323383085, "computeRatioMax": 0.017412935323383085, "endMs": "1665776989908", "id": "7", "inputStages": [ "6" ], "name": "S07: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "740", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "12", "startMs": "1665776989895", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132, $133, $70", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024875621890547263, "waitRatioMax": 0.0024875621890547263, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.004975124378109453, "writeRatioMax": 0.004975124378109453 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.0472636815920398, "computeRatioMax": 0.0472636815920398, "endMs": "1665776989948", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776989910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0024875621890547263, "waitRatioMax": 0.0024875621890547263, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03482587064676617, "writeRatioMax": 0.03482587064676617 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "13", "elapsedMs": "601", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1797" } ], "totalBytesBilled": "138412032", "totalBytesProcessed": "138289140", "totalPartitionsProcessed": "0", "totalSlotMs": "1797", "transferredBytes": "0" }, "startTime": "1665776989379", "totalBytesProcessed": "138289140", "totalSlotMs": "1797" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon460c15d3_e255_4bfd_945b_49612f5295f5" }, "priority": "INTERACTIVE", "query": "-- start query 19 in stream 0 using template query19.tpl\n\n/*\nSelect the top revenue generating products bought by out of zip code customers for a given year, month and manager. \nQualification Substitution Parameters\n*/\n\nselect i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n from date_dim, store_sales, item,customer,customer_address,store\n where d_date_sk = ss_sold_date_sk\n and ss_item_sk = i_item_sk\n and i_manager_id=8\n and d_moy=11\n and d_year=1998\n and ss_customer_sk = c_customer_sk \n and c_current_addr_sk = ca_address_sk\n and substr(ca_zip,1,5) <> substr(s_zip,1,5) \n and ss_store_sk = s_store_sk \n group by i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n order by ext_price desc\n ,i_brand\n ,i_brand_id\n ,i_manufact_id\n ,i_manufact\n limit 100\n ;\n\n-- end query 19 in stream 0 using template query19.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "NINYnltlOGUBeQVeyhtKgg==", "id": "test-project-364309:europe-west1.query19_1665776991", "jobReference": { "jobId": "query19_1665776991", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query19_1665776991?location=europe-west1", "statistics": { "creationTime": "1665776991771", "endTime": "1665776992500", "finalExecutionDurationMs": "497", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "138289140", "performanceInsights": { "avgPreviousExecutionMs": "463" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.06143344709897611, "computeRatioMax": 0.06143344709897611, "endMs": "1665776992100", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "122", "readMsMax": "122", "readRatioAvg": 0.41638225255972694, "readRatioMax": 0.41638225255972694, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "228", "shuffleOutputBytesSpilled": "0", "slotMs": "133", "startMs": "1665776991960", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:s_store_sk, $2:s_zip", "FROM store" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.020477815699658702, "writeRatioMax": 0.020477815699658702 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.09556313993174062, "computeRatioMax": 0.09556313993174062, "endMs": "1665776992023", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "23", "readMsMax": "23", "readRatioAvg": 0.07849829351535836, "readRatioMax": 0.07849829351535836, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "936149", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776991974", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.023890784982935155, "writeRatioMax": 0.023890784982935155 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.16382252559726962, "computeRatioMax": 0.16382252559726962, "endMs": "1665776992046", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.04778156996587031, "readRatioMax": 0.04778156996587031, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "65", "startMs": "1665776991990", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:c_customer_sk, $21:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$20, $21", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.040955631399317405, "writeRatioMax": 0.040955631399317405 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.027303754266211604, "computeRatioMax": 0.027303754266211604, "endMs": "1665776992101", "id": "3", "name": "S03: Input", "parallelInputs": "1", "readMsAvg": "87", "readMsMax": "87", "readRatioAvg": 0.29692832764505117, "readRatioMax": 0.29692832764505117, "recordsRead": "18000", "recordsWritten": "321", "shuffleOutputBytes": "20641", "shuffleOutputBytesSpilled": "0", "slotMs": "79", "startMs": "1665776992002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id", "FROM item", "WHERE equal($45, 8)" ] }, { "kind": "WRITE", "substeps": [ "$40, $41, $42, $43, $44", "TO __stage03_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013651877133105802, "writeRatioMax": 0.013651877133105802 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.030716723549488054, "computeRatioMax": 0.030716723549488054, "endMs": "1665776992117", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "59", "readMsMax": "59", "readRatioAvg": 0.20136518771331058, "readRatioMax": 0.20136518771331058, "recordsRead": "73049", "recordsWritten": "30", "shuffleOutputBytes": "270", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665776992047", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year, $52:d_moy", "FROM date_dim", "WHERE and(equal($52, 11), equal($51, 1998))" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage05_output" ] } ], "waitMsAvg": "15", "waitMsMax": "15", "waitRatioAvg": 0.051194539249146756, "waitRatioMax": 0.051194539249146756, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013651877133105802, "writeRatioMax": 0.013651877133105802 }, { "completedParallelInputs": "6", "computeMsAvg": "258", "computeMsMax": "293", "computeRatioAvg": 0.8805460750853242, "computeRatioMax": 1, "endMs": "1665776992363", "id": "6", "inputStages": [ "1", "5", "2", "0", "3" ], "name": "S06: Join+", "parallelInputs": "6", "readMsAvg": "35", "readMsMax": "42", "readRatioAvg": 0.11945392491467577, "readRatioMax": 0.14334470989761092, "recordsRead": "3782582", "recordsWritten": "740", "shuffleOutputBytes": "53611", "shuffleOutputBytesSpilled": "0", "slotMs": "1426", "startMs": "1665776992150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price", "FROM store_sales" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$40, $41, $42, $43, $44", "FROM __stage03_output" ] }, { "kind": "READ", "substeps": [ "$20, $21", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125", "$70 := SUM($121)" ] }, { "kind": "FILTER", "substeps": [ "not_equal(substr($120, 1, 5), substr($126, 1, 5))" ] }, { "kind": "JOIN", "substeps": [ "$120 := $116, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115, $126 := $2", "INNER HASH JOIN EACH WITH ALL ON $110 = $1" ] }, { "kind": "JOIN", "substeps": [ "$110 := $100, $111 := $101, $112 := $102, $113 := $103, $114 := $104, $115 := $105, $116 := $11", "INNER HASH JOIN EACH WITH ALL ON $106 = $10" ] }, { "kind": "JOIN", "substeps": [ "$100 := $91, $101 := $92, $102 := $93, $103 := $94, $104 := $95, $105 := $96, $106 := $21", "INNER HASH JOIN EACH WITH ALL ON $90 = $20" ] }, { "kind": "JOIN", "substeps": [ "$90 := $81, $91 := $82, $92 := $83, $93 := $41, $94 := $42, $95 := $43, $96 := $44", "INNER HASH JOIN EACH WITH ALL ON $80 = $40" ] }, { "kind": "JOIN", "substeps": [ "$80 := $31, $81 := $32, $82 := $33, $83 := $34", "INNER HASH JOIN EACH WITH ALL ON $30 = $50" ] }, { "kind": "WRITE", "substeps": [ "$131, $130, $132, $133, $70", "TO __stage06_output", "BY HASH($130, $131, $132, $133)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.013651877133105802, "writeRatioMax": 0.017064846416382253 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.030716723549488054, "computeRatioMax": 0.030716723549488054, "endMs": "1665776992395", "id": "7", "inputStages": [ "6" ], "name": "S07: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "740", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665776992382", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$131, $130, $132, $133, $70", "FROM __stage06_output" ] }, { "kind": "SORT", "substeps": [ "$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133", "$60 := SUM($70)" ] }, { "kind": "WRITE", "substeps": [ "$150, $151, $152, $153, $154", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0034129692832764505, "writeRatioMax": 0.0034129692832764505 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.03754266211604096, "computeRatioMax": 0.03754266211604096, "endMs": "1665776992431", "id": "8", "inputStages": [ "7" ], "name": "S08: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "7283", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665776992395", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$150, $151, $152, $153, $154", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$160, $161, $162, $163, $164", "TO __stage08_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.09215017064846416, "writeRatioMax": 0.09215017064846416 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "13", "elapsedMs": "617", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2151" } ], "totalBytesBilled": "138412032", "totalBytesProcessed": "138289140", "totalPartitionsProcessed": "0", "totalSlotMs": "2151", "transferredBytes": "0" }, "startTime": "1665776991835", "totalBytesProcessed": "138289140", "totalSlotMs": "2151" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
