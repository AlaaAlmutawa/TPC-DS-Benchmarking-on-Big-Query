{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon828f51c9_66fa_4349_8fcb_e080b2a5a8a5" }, "priority": "INTERACTIVE", "query": "-- start query 15 in stream 0 using template query15.tpl\n\n/*\nReport the total catalog sales for customers in selected geographical regions or who made large purchases for a given year and quarter.\n*/\n\nselect ca_zip\n ,sum(cs_sales_price)\n from catalog_sales\n ,customer\n ,customer_address\n ,date_dim\n where cs_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n '85392', '85460', '80348', '81792')\n \t or ca_state in ('CA','WA','GA')\n \t or cs_sales_price > 500)\n \tand cs_sold_date_sk = d_date_sk\n \tand d_qoy = 2 and d_year = 2001\n group by ca_zip\n order by ca_zip\n limit 100\n ;\n-- end query 15 in stream 0 using template query15.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "F+gV576PDf9uDUS/PqnRDA==", "id": "test-project-364309:europe-west1.query15_1665768247", "jobReference": { "jobId": "query15_1665768247", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query15_1665768247?location=europe-west1", "statistics": { "creationTime": "1665768248033", "endTime": "1665768248822", "finalExecutionDurationMs": "595", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50189827", "performanceInsights": { "avgPreviousExecutionMs": "593" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.017889087656529516, "computeRatioMax": 0.017889087656529516, "endMs": "1665768248238", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012522361359570662, "readRatioMax": 0.012522361359570662, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768248199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim", "WHERE and(equal($3, 2), equal($2, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0035778175313059034, "waitRatioMax": 0.0035778175313059034, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.03756708407871199, "writeRatioMax": 0.03756708407871199 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.05008944543828265, "computeRatioMax": 0.05008944543828265, "endMs": "1665768248261", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.014311270125223614, "readRatioMax": 0.014311270125223614, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1276849", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665768248219", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0035778175313059034, "waitRatioMax": 0.0035778175313059034, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02146690518783542, "writeRatioMax": 0.02146690518783542 }, { "completedParallelInputs": "1", "computeMsAvg": "55", "computeMsMax": "55", "computeRatioAvg": 0.09838998211091235, "computeRatioMax": 0.09838998211091235, "endMs": "1665768248285", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012522361359570662, "readRatioMax": 0.012522361359570662, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "69", "startMs": "1665768248237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0035778175313059034, "waitRatioMax": 0.0035778175313059034, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.017889087656529516, "writeRatioMax": 0.017889087656529516 }, { "completedParallelInputs": "5", "computeMsAvg": "390", "computeMsMax": "559", "computeRatioAvg": 0.6976744186046512, "computeRatioMax": 1, "endMs": "1665768248644", "id": "4", "inputStages": [ "2", "1", "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "12", "readMsMax": "17", "readRatioAvg": 0.02146690518783542, "readRatioMax": 0.03041144901610018, "recordsRead": "2192003", "recordsWritten": "908", "shuffleOutputBytes": "24471", "shuffleOutputBytesSpilled": "0", "slotMs": "1970", "startMs": "1665768248297", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_bill_customer_sk, $22:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90", "$50 := SUM($91)" ] }, { "kind": "JOIN", "substeps": [ "$90 := $73, $91 := $71", "INNER HASH JOIN EACH WITH ALL ON $70 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(in(substr($73, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $11, $73 := $12", "INNER HASH JOIN EACH WITH ALL ON $62 = $10" ] }, { "kind": "JOIN", "substeps": [ "$60 := $20, $61 := $22, $62 := $31", "INNER HASH JOIN EACH WITH ALL ON $21 = $30" ] }, { "kind": "WRITE", "substeps": [ "$100, $50", "TO __stage04_output", "BY HASH($100)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005366726296958855, "waitRatioMax": 0.005366726296958855, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.008944543828264758, "writeRatioMax": 0.014311270125223614 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.012522361359570662, "computeRatioMax": 0.012522361359570662, "endMs": "1665768248680", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "908", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665768248666", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $50", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$110 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100", "$40 := SUM($50)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005366726296958855, "waitRatioMax": 0.005366726296958855, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0017889087656529517, "writeRatioMax": 0.0017889087656529517 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.016100178890876567, "computeRatioMax": 0.016100178890876567, "endMs": "1665768248735", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665768248685", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage06_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0035778175313059034, "waitRatioMax": 0.0035778175313059034, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.04830053667262969, "writeRatioMax": 0.04830053667262969 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "624", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2171" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "702", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2229" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50189827", "totalPartitionsProcessed": "0", "totalSlotMs": "2229", "transferredBytes": "0" }, "startTime": "1665768248075", "totalBytesProcessed": "50189827", "totalSlotMs": "2229" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncb33a960_a065_41be_a834_836c20af3c63" }, "priority": "INTERACTIVE", "query": "-- start query 15 in stream 0 using template query15.tpl\n\n/*\nReport the total catalog sales for customers in selected geographical regions or who made large purchases for a given year and quarter.\n*/\n\nselect ca_zip\n ,sum(cs_sales_price)\n from catalog_sales\n ,customer\n ,customer_address\n ,date_dim\n where cs_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n '85392', '85460', '80348', '81792')\n \t or ca_state in ('CA','WA','GA')\n \t or cs_sales_price > 500)\n \tand cs_sold_date_sk = d_date_sk\n \tand d_qoy = 2 and d_year = 2001\n group by ca_zip\n order by ca_zip\n limit 100\n ;\n-- end query 15 in stream 0 using template query15.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "hAY9AThtc5AhLa7UlLd1nQ==", "id": "test-project-364309:europe-west1.query15_1665776915", "jobReference": { "jobId": "query15_1665776915", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query15_1665776915?location=europe-west1", "statistics": { "creationTime": "1665776916421", "endTime": "1665776917126", "finalExecutionDurationMs": "484", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50189827", "performanceInsights": { "avgPreviousExecutionMs": "593" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.018115942028985508, "computeRatioMax": 0.018115942028985508, "endMs": "1665776916628", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012681159420289856, "readRatioMax": 0.012681159420289856, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776916587", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim", "WHERE and(equal($3, 2), equal($2, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005434782608695652, "waitRatioMax": 0.005434782608695652, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02355072463768116, "writeRatioMax": 0.02355072463768116 }, { "completedParallelInputs": "1", "computeMsAvg": "38", "computeMsMax": "38", "computeRatioAvg": 0.06884057971014493, "computeRatioMax": 0.06884057971014493, "endMs": "1665776916644", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.014492753623188406, "readRatioMax": 0.014492753623188406, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1276849", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776916600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0036231884057971015, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "1", "computeMsAvg": "83", "computeMsMax": "83", "computeRatioAvg": 0.1503623188405797, "computeRatioMax": 0.1503623188405797, "endMs": "1665776916676", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.014492753623188406, "readRatioMax": 0.014492753623188406, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665776916613", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018115942028985507, "waitRatioMax": 0.0018115942028985507, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02355072463768116, "writeRatioMax": 0.02355072463768116 }, { "completedParallelInputs": "5", "computeMsAvg": "479", "computeMsMax": "552", "computeRatioAvg": 0.8677536231884058, "computeRatioMax": 1, "endMs": "1665776916962", "id": "4", "inputStages": [ "1", "2", "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "15", "readRatioAvg": 0.019927536231884056, "readRatioMax": 0.02717391304347826, "recordsRead": "2192003", "recordsWritten": "908", "shuffleOutputBytes": "24471", "shuffleOutputBytesSpilled": "0", "slotMs": "1861", "startMs": "1665776916687", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_bill_customer_sk, $22:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90", "$50 := SUM($91)" ] }, { "kind": "JOIN", "substeps": [ "$90 := $73, $91 := $71", "INNER HASH JOIN EACH WITH ALL ON $70 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(in(substr($73, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $11, $73 := $12", "INNER HASH JOIN EACH WITH ALL ON $62 = $10" ] }, { "kind": "JOIN", "substeps": [ "$60 := $20, $61 := $22, $62 := $31", "INNER HASH JOIN EACH WITH ALL ON $21 = $30" ] }, { "kind": "WRITE", "substeps": [ "$100, $50", "TO __stage04_output", "BY HASH($100)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0018115942028985507, "waitRatioMax": 0.0036231884057971015, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.009057971014492754, "writeRatioMax": 0.014492753623188406 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.012681159420289856, "computeRatioMax": 0.012681159420289856, "endMs": "1665776916988", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "908", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "15", "startMs": "1665776916972", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $50", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$110 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100", "$40 := SUM($50)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018115942028985507, "waitRatioMax": 0.0018115942028985507, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.010869565217391304, "writeRatioMax": 0.010869565217391304 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.025362318840579712, "computeRatioMax": 0.025362318840579712, "endMs": "1665776917026", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776916987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018115942028985507, "waitRatioMax": 0.0018115942028985507, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.028985507246376812, "writeRatioMax": 0.028985507246376812 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "10", "elapsedMs": "585", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2085" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50189827", "totalPartitionsProcessed": "0", "totalSlotMs": "2085", "transferredBytes": "0" }, "startTime": "1665776916478", "totalBytesProcessed": "50189827", "totalSlotMs": "2085" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon2cbde808_26e8_411e_b86e_0d371bab93d6" }, "priority": "INTERACTIVE", "query": "-- start query 15 in stream 0 using template query15.tpl\n\n/*\nReport the total catalog sales for customers in selected geographical regions or who made large purchases for a given year and quarter.\n*/\n\nselect ca_zip\n ,sum(cs_sales_price)\n from catalog_sales\n ,customer\n ,customer_address\n ,date_dim\n where cs_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n '85392', '85460', '80348', '81792')\n \t or ca_state in ('CA','WA','GA')\n \t or cs_sales_price > 500)\n \tand cs_sold_date_sk = d_date_sk\n \tand d_qoy = 2 and d_year = 2001\n group by ca_zip\n order by ca_zip\n limit 100\n ;\n-- end query 15 in stream 0 using template query15.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "3V8Q/L17Wwgd+Gi/b8CA+g==", "id": "test-project-364309:europe-west1.query15_1665776918", "jobReference": { "jobId": "query15_1665776918", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query15_1665776918?location=europe-west1", "statistics": { "creationTime": "1665776918659", "endTime": "1665776919412", "finalExecutionDurationMs": "573", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50189827", "performanceInsights": { "avgPreviousExecutionMs": "575" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.027303754266211604, "computeRatioMax": 0.027303754266211604, "endMs": "1665776918846", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.020477815699658702, "readRatioMax": 0.020477815699658702, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776918799", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim", "WHERE and(equal($3, 2), equal($2, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017064846416382253, "waitRatioMax": 0.0017064846416382253, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.015358361774744027, "writeRatioMax": 0.015358361774744027 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.04607508532423208, "computeRatioMax": 0.04607508532423208, "endMs": "1665776918851", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.008532423208191127, "readRatioMax": 0.008532423208191127, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1276849", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776918816", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017064846416382253, "waitRatioMax": 0.0017064846416382253, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01877133105802048, "writeRatioMax": 0.01877133105802048 }, { "completedParallelInputs": "1", "computeMsAvg": "60", "computeMsMax": "60", "computeRatioAvg": 0.10238907849829351, "computeRatioMax": 0.10238907849829351, "endMs": "1665776918883", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010238907849829351, "readRatioMax": 0.010238907849829351, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776918837", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017064846416382253, "waitRatioMax": 0.0017064846416382253, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01877133105802048, "writeRatioMax": 0.01877133105802048 }, { "completedParallelInputs": "5", "computeMsAvg": "504", "computeMsMax": "586", "computeRatioAvg": 0.8600682593856656, "computeRatioMax": 1, "endMs": "1665776919247", "id": "4", "inputStages": [ "2", "1", "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "18", "readRatioAvg": 0.02218430034129693, "readRatioMax": 0.030716723549488054, "recordsRead": "2192003", "recordsWritten": "908", "shuffleOutputBytes": "24471", "shuffleOutputBytesSpilled": "0", "slotMs": "2024", "startMs": "1665776918911", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_bill_customer_sk, $22:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90", "$50 := SUM($91)" ] }, { "kind": "JOIN", "substeps": [ "$90 := $73, $91 := $71", "INNER HASH JOIN EACH WITH ALL ON $70 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(in(substr($73, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $11, $73 := $12", "INNER HASH JOIN EACH WITH ALL ON $62 = $10" ] }, { "kind": "JOIN", "substeps": [ "$60 := $20, $61 := $22, $62 := $31", "INNER HASH JOIN EACH WITH ALL ON $21 = $30" ] }, { "kind": "WRITE", "substeps": [ "$100, $50", "TO __stage04_output", "BY HASH($100)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.005119453924914676, "waitRatioMax": 0.005119453924914676, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.008532423208191127, "writeRatioMax": 0.008532423208191127 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.013651877133105802, "computeRatioMax": 0.013651877133105802, "endMs": "1665776919263", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "908", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665776919252", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $50", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$110 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100", "$40 := SUM($50)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017064846416382253, "waitRatioMax": 0.0017064846416382253, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0017064846416382253, "writeRatioMax": 0.0017064846416382253 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.020477815699658702, "computeRatioMax": 0.020477815699658702, "endMs": "1665776919341", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "64", "startMs": "1665776919277", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0017064846416382253, "waitRatioMax": 0.0017064846416382253, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.09215017064846416, "writeRatioMax": 0.09215017064846416 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "594", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "2183" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "658", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2248" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50189827", "totalPartitionsProcessed": "0", "totalSlotMs": "2248", "transferredBytes": "0" }, "startTime": "1665776918706", "totalBytesProcessed": "50189827", "totalSlotMs": "2248" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6cad343d_1008_44bc_97c4_4089dab73506" }, "priority": "INTERACTIVE", "query": "-- start query 15 in stream 0 using template query15.tpl\n\n/*\nReport the total catalog sales for customers in selected geographical regions or who made large purchases for a given year and quarter.\n*/\n\nselect ca_zip\n ,sum(cs_sales_price)\n from catalog_sales\n ,customer\n ,customer_address\n ,date_dim\n where cs_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n '85392', '85460', '80348', '81792')\n \t or ca_state in ('CA','WA','GA')\n \t or cs_sales_price > 500)\n \tand cs_sold_date_sk = d_date_sk\n \tand d_qoy = 2 and d_year = 2001\n group by ca_zip\n order by ca_zip\n limit 100\n ;\n-- end query 15 in stream 0 using template query15.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Wa6MN2/Oh61vLFX6n79ryA==", "id": "test-project-364309:europe-west1.query15_1665776920", "jobReference": { "jobId": "query15_1665776920", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query15_1665776920?location=europe-west1", "statistics": { "creationTime": "1665776921033", "endTime": "1665776921840", "finalExecutionDurationMs": "562", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50189827", "performanceInsights": { "avgPreviousExecutionMs": "575" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.025404157043879907, "computeRatioMax": 0.025404157043879907, "endMs": "1665776921246", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.016166281755196306, "readRatioMax": 0.016166281755196306, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776921207", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim", "WHERE and(equal($3, 2), equal($2, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023094688221709007, "waitRatioMax": 0.0023094688221709007, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02771362586605081, "writeRatioMax": 0.02771362586605081 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.06697459584295612, "computeRatioMax": 0.06697459584295612, "endMs": "1665776921343", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.009237875288683603, "readRatioMax": 0.009237875288683603, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1276849", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665776921312", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023094688221709007, "waitRatioMax": 0.0023094688221709007, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.025404157043879907, "writeRatioMax": 0.025404157043879907 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.11778290993071594, "computeRatioMax": 0.11778290993071594, "endMs": "1665776921377", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.020785219399538105, "readRatioMax": 0.020785219399538105, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776921328", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023094688221709007, "waitRatioMax": 0.0023094688221709007, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02771362586605081, "writeRatioMax": 0.02771362586605081 }, { "completedParallelInputs": "5", "computeMsAvg": "391", "computeMsMax": "433", "computeRatioAvg": 0.9030023094688222, "computeRatioMax": 1, "endMs": "1665776921662", "id": "4", "inputStages": [ "1", "2", "0" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "14", "readRatioAvg": 0.025404157043879907, "readRatioMax": 0.03233256351039261, "recordsRead": "2192003", "recordsWritten": "908", "shuffleOutputBytes": "24471", "shuffleOutputBytesSpilled": "0", "slotMs": "1676", "startMs": "1665776921384", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_bill_customer_sk, $22:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90", "$50 := SUM($91)" ] }, { "kind": "JOIN", "substeps": [ "$90 := $73, $91 := $71", "INNER HASH JOIN EACH WITH ALL ON $70 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(in(substr($73, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $11, $73 := $12", "INNER HASH JOIN EACH WITH ALL ON $62 = $10" ] }, { "kind": "JOIN", "substeps": [ "$60 := $20, $61 := $22, $62 := $31", "INNER HASH JOIN EACH WITH ALL ON $21 = $30" ] }, { "kind": "WRITE", "substeps": [ "$100, $50", "TO __stage04_output", "BY HASH($100)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023094688221709007, "waitRatioMax": 0.0023094688221709007, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.009237875288683603, "writeRatioMax": 0.011547344110854504 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.020785219399538105, "computeRatioMax": 0.020785219399538105, "endMs": "1665776921689", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "908", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "11", "startMs": "1665776921677", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $50", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$110 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100", "$40 := SUM($50)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023094688221709007, "waitRatioMax": 0.0023094688221709007, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.0023094688221709007, "writeRatioMax": 0.0023094688221709007 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.025404157043879907, "computeRatioMax": 0.025404157043879907, "endMs": "1665776921725", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776921690", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0023094688221709007, "waitRatioMax": 0.0023094688221709007, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.03695150115473441, "writeRatioMax": 0.03695150115473441 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "9", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "1817" }, { "activeUnits": "1", "completedUnits": "10", "elapsedMs": "663", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "1854" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50189827", "totalPartitionsProcessed": "0", "totalSlotMs": "1854", "transferredBytes": "0" }, "startTime": "1665776921100", "totalBytesProcessed": "50189827", "totalSlotMs": "1854" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3b1cdb96_8da2_4b78_9d4c_428ab8d4b872" }, "priority": "INTERACTIVE", "query": "-- start query 15 in stream 0 using template query15.tpl\n\n/*\nReport the total catalog sales for customers in selected geographical regions or who made large purchases for a given year and quarter.\n*/\n\nselect ca_zip\n ,sum(cs_sales_price)\n from catalog_sales\n ,customer\n ,customer_address\n ,date_dim\n where cs_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n '85392', '85460', '80348', '81792')\n \t or ca_state in ('CA','WA','GA')\n \t or cs_sales_price > 500)\n \tand cs_sold_date_sk = d_date_sk\n \tand d_qoy = 2 and d_year = 2001\n group by ca_zip\n order by ca_zip\n limit 100\n ;\n-- end query 15 in stream 0 using template query15.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "EvHVJYJLOU/FPGTwoINNDQ==", "id": "test-project-364309:europe-west1.query15_1665776922", "jobReference": { "jobId": "query15_1665776922", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query15_1665776922?location=europe-west1", "statistics": { "creationTime": "1665776923511", "endTime": "1665776924247", "finalExecutionDurationMs": "536", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50189827", "performanceInsights": { "avgPreviousExecutionMs": "573" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.01779935275080906, "computeRatioMax": 0.01779935275080906, "endMs": "1665776923712", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.011326860841423949, "readRatioMax": 0.011326860841423949, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776923672", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim", "WHERE and(equal($3, 2), equal($2, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.021035598705501618, "writeRatioMax": 0.021035598705501618 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.05339805825242718, "computeRatioMax": 0.05339805825242718, "endMs": "1665776923725", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.012944983818770227, "readRatioMax": 0.012944983818770227, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1276849", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776923686", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.01779935275080906, "writeRatioMax": 0.01779935275080906 }, { "completedParallelInputs": "1", "computeMsAvg": "69", "computeMsMax": "69", "computeRatioAvg": 0.11165048543689321, "computeRatioMax": 0.11165048543689321, "endMs": "1665776923763", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.012944983818770227, "readRatioMax": 0.012944983818770227, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665776923706", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.022653721682847898, "writeRatioMax": 0.022653721682847898 }, { "completedParallelInputs": "5", "computeMsAvg": "521", "computeMsMax": "618", "computeRatioAvg": 0.843042071197411, "computeRatioMax": 1, "endMs": "1665776924102", "id": "4", "inputStages": [ "0", "2", "1" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "13", "readMsMax": "14", "readRatioAvg": 0.021035598705501618, "readRatioMax": 0.022653721682847898, "recordsRead": "2192003", "recordsWritten": "908", "shuffleOutputBytes": "24471", "shuffleOutputBytesSpilled": "0", "slotMs": "2149", "startMs": "1665776923779", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_bill_customer_sk, $22:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90", "$50 := SUM($91)" ] }, { "kind": "JOIN", "substeps": [ "$90 := $73, $91 := $71", "INNER HASH JOIN EACH WITH ALL ON $70 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(in(substr($73, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $11, $73 := $12", "INNER HASH JOIN EACH WITH ALL ON $62 = $10" ] }, { "kind": "JOIN", "substeps": [ "$60 := $20, $61 := $22, $62 := $31", "INNER HASH JOIN EACH WITH ALL ON $21 = $30" ] }, { "kind": "WRITE", "substeps": [ "$100, $50", "TO __stage04_output", "BY HASH($100)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.003236245954692557, "waitRatioMax": 0.003236245954692557, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.006472491909385114, "writeRatioMax": 0.008090614886731391 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.011326860841423949, "computeRatioMax": 0.011326860841423949, "endMs": "1665776924131", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "908", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665776924114", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $50", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$110 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100", "$40 := SUM($50)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.003236245954692557, "writeRatioMax": 0.003236245954692557 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.014563106796116505, "computeRatioMax": 0.014563106796116505, "endMs": "1665776924167", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776924130", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0016181229773462784, "waitRatioMax": 0.0016181229773462784, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.024271844660194174, "writeRatioMax": 0.024271844660194174 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "10", "elapsedMs": "613", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2355" }, { "activeUnits": "0", "completedUnits": "10", "elapsedMs": "643", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2355" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50189827", "totalPartitionsProcessed": "0", "totalSlotMs": "2355", "transferredBytes": "0" }, "startTime": "1665776923559", "totalBytesProcessed": "50189827", "totalSlotMs": "2355" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anona26000d0_cad0_4799_8cba_297cd3a36b88" }, "priority": "INTERACTIVE", "query": "-- start query 15 in stream 0 using template query15.tpl\n\n/*\nReport the total catalog sales for customers in selected geographical regions or who made large purchases for a given year and quarter.\n*/\n\nselect ca_zip\n ,sum(cs_sales_price)\n from catalog_sales\n ,customer\n ,customer_address\n ,date_dim\n where cs_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n '85392', '85460', '80348', '81792')\n \t or ca_state in ('CA','WA','GA')\n \t or cs_sales_price > 500)\n \tand cs_sold_date_sk = d_date_sk\n \tand d_qoy = 2 and d_year = 2001\n group by ca_zip\n order by ca_zip\n limit 100\n ;\n-- end query 15 in stream 0 using template query15.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "zL48KXXoPeZWHFxKKsEloQ==", "id": "test-project-364309:europe-west1.query15_1665776925", "jobReference": { "jobId": "query15_1665776925", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query15_1665776925?location=europe-west1", "statistics": { "creationTime": "1665776925849", "endTime": "1665776926557", "finalExecutionDurationMs": "526", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "50189827", "performanceInsights": { "avgPreviousExecutionMs": "569" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01824817518248175, "computeRatioMax": 0.01824817518248175, "endMs": "1665776926034", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.012773722627737226, "readRatioMax": 0.012773722627737226, "recordsRead": "73049", "recordsWritten": "91", "shuffleOutputBytes": "819", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665776925998", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:d_date_sk, $2:d_year, $3:d_qoy", "FROM date_dim", "WHERE and(equal($3, 2), equal($2, 2001))" ] }, { "kind": "WRITE", "substeps": [ "$1", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.012773722627737226, "writeRatioMax": 0.012773722627737226 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.05291970802919708, "computeRatioMax": 0.05291970802919708, "endMs": "1665776926058", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.010948905109489052, "readRatioMax": 0.010948905109489052, "recordsRead": "50000", "recordsWritten": "50000", "shuffleOutputBytes": "1276849", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776926012", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:ca_address_sk, $11:ca_state, $12:ca_zip", "FROM customer_address" ] }, { "kind": "WRITE", "substeps": [ "$10, $11, $12", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.016423357664233577, "writeRatioMax": 0.016423357664233577 }, { "completedParallelInputs": "1", "computeMsAvg": "53", "computeMsMax": "53", "computeRatioAvg": 0.09671532846715329, "computeRatioMax": 0.09671532846715329, "endMs": "1665776926081", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.014598540145985401, "readRatioMax": 0.014598540145985401, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "1800000", "shuffleOutputBytesSpilled": "0", "slotMs": "63", "startMs": "1665776926029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:c_customer_sk, $31:c_current_addr_sk", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$30, $31", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.021897810218978103, "writeRatioMax": 0.021897810218978103 }, { "completedParallelInputs": "5", "computeMsAvg": "460", "computeMsMax": "548", "computeRatioAvg": 0.8394160583941606, "computeRatioMax": 1, "endMs": "1665776926440", "id": "4", "inputStages": [ "0", "2", "1" ], "name": "S04: Join+", "parallelInputs": "5", "readMsAvg": "11", "readMsMax": "13", "readRatioAvg": 0.020072992700729927, "readRatioMax": 0.023722627737226276, "recordsRead": "2192003", "recordsWritten": "908", "shuffleOutputBytes": "24471", "shuffleOutputBytesSpilled": "0", "slotMs": "1893", "startMs": "1665776926098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:cs_sold_date_sk, $21:cs_bill_customer_sk, $22:cs_sales_price", "FROM catalog_sales" ] }, { "kind": "READ", "substeps": [ "$30, $31", "FROM __stage02_output" ] }, { "kind": "READ", "substeps": [ "$10, $11, $12", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$1", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $100 := $90", "$50 := SUM($91)" ] }, { "kind": "JOIN", "substeps": [ "$90 := $73, $91 := $71", "INNER HASH JOIN EACH WITH ALL ON $70 = $1" ] }, { "kind": "FILTER", "substeps": [ "or(in(substr($73, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)" ] }, { "kind": "JOIN", "substeps": [ "$70 := $60, $71 := $61, $72 := $11, $73 := $12", "INNER HASH JOIN EACH WITH ALL ON $62 = $10" ] }, { "kind": "JOIN", "substeps": [ "$60 := $20, $61 := $22, $62 := $31", "INNER HASH JOIN EACH WITH ALL ON $21 = $30" ] }, { "kind": "WRITE", "substeps": [ "$100, $50", "TO __stage04_output", "BY HASH($100)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "5", "writeMsMax": "7", "writeRatioAvg": 0.009124087591240875, "writeRatioMax": 0.012773722627737226 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.0072992700729927005, "computeRatioMax": 0.0072992700729927005, "endMs": "1665776926453", "id": "5", "inputStages": [ "4" ], "name": "S05: Sort+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "908", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "7", "startMs": "1665776926444", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$100, $50", "FROM __stage04_output" ] }, { "kind": "SORT", "substeps": [ "$110 ASC", "LIMIT 100" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $110 := $100", "$40 := SUM($50)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "0", "writeMsMax": "0", "writeRatioAvg": 0, "writeRatioMax": 0 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.01824817518248175, "computeRatioMax": 0.01824817518248175, "endMs": "1665776926491", "id": "6", "inputStages": [ "5" ], "name": "S06: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2691", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776926459", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$120, $121", "FROM __stage05_output" ] }, { "kind": "SORT", "substeps": [ "$120 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$130, $131", "TO __stage06_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0018248175182481751, "waitRatioMax": 0.0018248175182481751, "writeMsAvg": "25", "writeMsMax": "25", "writeRatioAvg": 0.04562043795620438, "writeRatioMax": 0.04562043795620438 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "catalog_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer_address" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "10", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2083" }, { "activeUnits": "0", "completedUnits": "10", "elapsedMs": "622", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2083" } ], "totalBytesBilled": "50331648", "totalBytesProcessed": "50189827", "totalPartitionsProcessed": "0", "totalSlotMs": "2083", "transferredBytes": "0" }, "startTime": "1665776925894", "totalBytesProcessed": "50189827", "totalSlotMs": "2083" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
