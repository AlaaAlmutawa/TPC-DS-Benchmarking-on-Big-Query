{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anoncae6ea87_6e64_4b7e_a2a9_53abd05aa71e" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "comeDIrrv9w2aGbvnzLfjw==", "id": "test-project-364309:europe-west1.query01_1665768197", "jobReference": { "jobId": "query01_1665768197", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665768197?location=europe-west1", "statistics": { "creationTime": "1665768198147", "endTime": "1665768198853", "finalExecutionDurationMs": "488", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "591" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.07344632768361582, "computeRatioMax": 0.07344632768361582, "endMs": "1665768198336", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.04519774011299435, "readRatioMax": 0.04519774011299435, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665768198305", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07909604519774012, "writeRatioMax": 0.07909604519774012 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.0847457627118644, "computeRatioMax": 0.0847457627118644, "endMs": "1665768198379", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02824858757062147, "readRatioMax": 0.02824858757062147, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768198337", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.096045197740113, "writeRatioMax": 0.096045197740113 }, { "completedParallelInputs": "1", "computeMsAvg": "155", "computeMsMax": "155", "computeRatioAvg": 0.8757062146892656, "computeRatioMax": 0.8757062146892656, "endMs": "1665768198470", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.06779661016949153, "readRatioMax": 0.06779661016949153, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "147", "startMs": "1665768198356", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03389830508474576, "writeRatioMax": 0.03389830508474576 }, { "completedParallelInputs": "1", "computeMsAvg": "177", "computeMsMax": "177", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768198495", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.06779661016949153, "readRatioMax": 0.06779661016949153, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "166", "startMs": "1665768198387", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03954802259887006, "writeRatioMax": 0.03954802259887006 }, { "completedParallelInputs": "1", "computeMsAvg": "52", "computeMsMax": "52", "computeRatioAvg": 0.2937853107344633, "computeRatioMax": 0.2937853107344633, "endMs": "1665768198544", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665768198506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.04519774011299435, "writeRatioMax": 0.04519774011299435 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04519774011299435, "computeRatioMax": 0.04519774011299435, "endMs": "1665768198608", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768198568", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0903954802259887, "writeRatioMax": 0.0903954802259887 }, { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.2655367231638418, "computeRatioMax": 0.2655367231638418, "endMs": "1665768198637", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.05649717514124294, "readRatioMax": 0.05649717514124294, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665768198583", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.05084745762711865, "writeRatioMax": 0.05084745762711865 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.062146892655367235, "computeRatioMax": 0.062146892655367235, "endMs": "1665768198639", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03954802259887006, "readRatioMax": 0.03954802259887006, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768198600", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.011299435028248588, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.12429378531073447, "writeRatioMax": 0.12429378531073447 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.04519774011299435, "computeRatioMax": 0.096045197740113, "endMs": "1665768198708", "id": "11", "inputStages": [ "7" ], "name": "S0B: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "3622", "startMs": "1665768198652", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.011299435028248588, "waitRatioMax": 0.01694915254237288, "writeMsAvg": "18", "writeMsMax": "30", "writeRatioAvg": 0.1016949152542373, "writeRatioMax": 0.1694915254237288 }, { "completedParallelInputs": "1", "computeMsAvg": "98", "computeMsMax": "98", "computeRatioAvg": 0.5536723163841808, "computeRatioMax": 0.5536723163841808, "endMs": "1665768198744", "id": "12", "inputStages": [ "11", "9", "8", "5" ], "name": "S0C: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "106", "startMs": "1665768198659", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0B_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0C_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.022598870056497175, "waitRatioMax": 0.022598870056497175, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.01694915254237288, "writeRatioMax": 0.01694915254237288 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03954802259887006, "computeRatioMax": 0.03954802259887006, "endMs": "1665768198758", "id": "13", "inputStages": [ "12" ], "name": "S0D: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665768198671", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005649717514124294, "waitRatioMax": 0.005649717514124294, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.011299435028248588, "writeRatioMax": 0.011299435028248588 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "110", "elapsedMs": "586", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4334" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "4334", "transferredBytes": "0" }, "startTime": "1665768198207", "totalBytesProcessed": "14868320", "totalSlotMs": "4334" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon36131e93_b328_4369_9c0a_22a9838798f2" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "/UzTpg6rCONmi0IjIRn6Ww==", "id": "test-project-364309:europe-west1.query01_1665776404", "jobReference": { "jobId": "query01_1665776404", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776404?location=europe-west1", "statistics": { "creationTime": "1665776405232", "endTime": "1665776406245", "finalExecutionDurationMs": "745", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "585" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.035, "computeRatioMax": 0.035, "endMs": "1665776405491", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.035, "readRatioMax": 0.035, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776405454", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.055, "writeRatioMax": 0.055 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04, "computeRatioMax": 0.04, "endMs": "1665776405530", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.055, "readRatioMax": 0.055, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "80", "startMs": "1665776405495", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.085, "writeRatioMax": 0.085 }, { "completedParallelInputs": "1", "computeMsAvg": "200", "computeMsMax": "200", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776405675", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.07, "readRatioMax": 0.07, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "232", "startMs": "1665776405523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.035, "writeRatioMax": 0.035 }, { "completedParallelInputs": "1", "computeMsAvg": "180", "computeMsMax": "180", "computeRatioAvg": 0.9, "computeRatioMax": 0.9, "endMs": "1665776405670", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.08, "readRatioMax": 0.08, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "183", "startMs": "1665776405541", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.07, "writeRatioMax": 0.07 }, { "completedParallelInputs": "1", "computeMsAvg": "44", "computeMsMax": "44", "computeRatioAvg": 0.22, "computeRatioMax": 0.22, "endMs": "1665776405772", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665776405725", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.035, "writeRatioMax": 0.035 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03, "computeRatioMax": 0.03, "endMs": "1665776405844", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776405809", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.14, "writeRatioMax": 0.14 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.315, "computeRatioMax": 0.315, "endMs": "1665776405925", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.09, "readRatioMax": 0.09, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "126", "startMs": "1665776405829", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005, "waitRatioMax": 0.005, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.065, "writeRatioMax": 0.065 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.04, "computeRatioMax": 0.04, "endMs": "1665776405904", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.035, "readRatioMax": 0.035, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776405856", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.095, "writeRatioMax": 0.095 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "17", "computeRatioAvg": 0.045, "computeRatioMax": 0.085, "endMs": "1665776406023", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "5829", "startMs": "1665776405950", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.01, "waitRatioMax": 0.015, "writeMsAvg": "14", "writeMsMax": "29", "writeRatioAvg": 0.07, "writeRatioMax": 0.145 }, { "completedParallelInputs": "1", "computeMsAvg": "171", "computeMsMax": "171", "computeRatioAvg": 0.855, "computeRatioMax": 0.855, "endMs": "1665776406121", "id": "13", "inputStages": [ "12", "8", "9", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "197", "startMs": "1665776405958", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.02, "waitRatioMax": 0.02, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.015, "writeRatioMax": 0.015 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.035, "computeRatioMax": 0.035, "endMs": "1665776406150", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "120", "startMs": "1665776405975", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.01, "waitRatioMax": 0.01, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.025, "writeRatioMax": 0.025 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "101", "completedUnits": "8", "elapsedMs": "658", "estimatedRunnableUnits": "0", "pendingUnits": "101", "totalSlotMs": "838" }, { "activeUnits": "101", "completedUnits": "110", "elapsedMs": "897", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6987" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "6987", "transferredBytes": "0" }, "startTime": "1665776405300", "totalBytesProcessed": "14868320", "totalSlotMs": "6987" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf496ca14_1e76_41d3_82ed_3e49f7df8f15" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "pn6NJYp2qzr/8sSYJu0mdg==", "id": "test-project-364309:europe-west1.query01_1665776407", "jobReference": { "jobId": "query01_1665776407", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776407?location=europe-west1", "statistics": { "creationTime": "1665776407957", "endTime": "1665776408667", "finalExecutionDurationMs": "508", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "588" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05263157894736842, "computeRatioMax": 0.05263157894736842, "endMs": "1665776408151", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.029239766081871343, "readRatioMax": 0.029239766081871343, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776408113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.011695906432748537, "waitRatioMax": 0.011695906432748537, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0935672514619883, "writeRatioMax": 0.0935672514619883 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.05263157894736842, "computeRatioMax": 0.05263157894736842, "endMs": "1665776408187", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.029239766081871343, "readRatioMax": 0.029239766081871343, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776408144", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0935672514619883, "writeRatioMax": 0.0935672514619883 }, { "completedParallelInputs": "1", "computeMsAvg": "121", "computeMsMax": "121", "computeRatioAvg": 0.7076023391812866, "computeRatioMax": 0.7076023391812866, "endMs": "1665776408255", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.06432748538011696, "readRatioMax": 0.06432748538011696, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "107", "startMs": "1665776408169", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03508771929824561, "writeRatioMax": 0.03508771929824561 }, { "completedParallelInputs": "1", "computeMsAvg": "171", "computeMsMax": "171", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776408329", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.07602339181286549, "readRatioMax": 0.07602339181286549, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "199", "startMs": "1665776408198", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.04093567251461988, "writeRatioMax": 0.04093567251461988 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.3333333333333333, "computeRatioMax": 0.3333333333333333, "endMs": "1665776408329", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776408288", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03508771929824561, "writeRatioMax": 0.03508771929824561 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.07017543859649122, "computeRatioMax": 0.07017543859649122, "endMs": "1665776408395", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776408358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.09941520467836257, "writeRatioMax": 0.09941520467836257 }, { "completedParallelInputs": "1", "computeMsAvg": "83", "computeMsMax": "83", "computeRatioAvg": 0.4853801169590643, "computeRatioMax": 0.4853801169590643, "endMs": "1665776408473", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.05263157894736842, "readRatioMax": 0.05263157894736842, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "132", "startMs": "1665776408381", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.06432748538011696, "writeRatioMax": 0.06432748538011696 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05847953216374269, "computeRatioMax": 0.05847953216374269, "endMs": "1665776408435", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.023391812865497075, "readRatioMax": 0.023391812865497075, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776408395", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005847953216374269, "waitRatioMax": 0.005847953216374269, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.0935672514619883, "writeRatioMax": 0.0935672514619883 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.04678362573099415, "computeRatioMax": 0.11695906432748537, "endMs": "1665776408532", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "5289", "startMs": "1665776408477", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.011695906432748537, "waitRatioMax": 0.017543859649122806, "writeMsAvg": "17", "writeMsMax": "29", "writeRatioAvg": 0.09941520467836257, "writeRatioMax": 0.1695906432748538 }, { "completedParallelInputs": "1", "computeMsAvg": "118", "computeMsMax": "118", "computeRatioAvg": 0.6900584795321637, "computeRatioMax": 0.6900584795321637, "endMs": "1665776408567", "id": "13", "inputStages": [ "9", "8", "5", "12" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "140", "startMs": "1665776408484", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.023391812865497075, "waitRatioMax": 0.023391812865497075, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.011695906432748537, "writeRatioMax": 0.011695906432748537 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.029239766081871343, "computeRatioMax": 0.029239766081871343, "endMs": "1665776408585", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665776408496", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.017543859649122806, "waitRatioMax": 0.017543859649122806, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.011695906432748537, "writeRatioMax": 0.011695906432748537 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "110", "elapsedMs": "605", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6154" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "6154", "transferredBytes": "0" }, "startTime": "1665776408008", "totalBytesProcessed": "14868320", "totalSlotMs": "6154" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon549885c8_55bd_4fba_86bf_4b04bed00cd7" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "tuBoT+9FJ2+XdoHCQ+OfTw==", "id": "test-project-364309:europe-west1.query01_1665776409", "jobReference": { "jobId": "query01_1665776409", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776409?location=europe-west1", "statistics": { "creationTime": "1665776410462", "endTime": "1665776411259", "finalExecutionDurationMs": "615", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "587" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0364963503649635, "computeRatioMax": 0.0364963503649635, "endMs": "1665776410645", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.025547445255474453, "readRatioMax": 0.025547445255474453, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665776410608", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.07664233576642336, "writeRatioMax": 0.07664233576642336 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0364963503649635, "computeRatioMax": 0.0364963503649635, "endMs": "1665776410678", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.021897810218978103, "readRatioMax": 0.021897810218978103, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776410639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.058394160583941604, "writeRatioMax": 0.058394160583941604 }, { "completedParallelInputs": "1", "computeMsAvg": "166", "computeMsMax": "166", "computeRatioAvg": 0.6058394160583942, "computeRatioMax": 0.6058394160583942, "endMs": "1665776410796", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.06204379562043796, "readRatioMax": 0.06204379562043796, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "200", "startMs": "1665776410662", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010948905109489052, "waitRatioMax": 0.010948905109489052, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.025547445255474453, "writeRatioMax": 0.025547445255474453 }, { "completedParallelInputs": "1", "computeMsAvg": "274", "computeMsMax": "274", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776410847", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.058394160583941604, "readRatioMax": 0.058394160583941604, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "259", "startMs": "1665776410690", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.025547445255474453, "writeRatioMax": 0.025547445255474453 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.22992700729927007, "computeRatioMax": 0.22992700729927007, "endMs": "1665776410877", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776410842", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.021897810218978103, "writeRatioMax": 0.021897810218978103 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.043795620437956206, "computeRatioMax": 0.043795620437956206, "endMs": "1665776410936", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665776410903", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.051094890510948905, "writeRatioMax": 0.051094890510948905 }, { "completedParallelInputs": "1", "computeMsAvg": "69", "computeMsMax": "69", "computeRatioAvg": 0.2518248175182482, "computeRatioMax": 0.2518248175182482, "endMs": "1665776411008", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0364963503649635, "readRatioMax": 0.0364963503649635, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "146", "startMs": "1665776410918", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.043795620437956206, "writeRatioMax": 0.043795620437956206 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.021897810218978103, "computeRatioMax": 0.021897810218978103, "endMs": "1665776410971", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.010948905109489052, "readRatioMax": 0.010948905109489052, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776410933", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0036496350364963502, "waitRatioMax": 0.0036496350364963502, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.05474452554744526, "writeRatioMax": 0.05474452554744526 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "18", "computeRatioAvg": 0.025547445255474453, "computeRatioMax": 0.06569343065693431, "endMs": "1665776411084", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4403", "startMs": "1665776411033", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.014598540145985401, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.051094890510948905, "writeRatioMax": 0.06934306569343066 }, { "completedParallelInputs": "1", "computeMsAvg": "187", "computeMsMax": "187", "computeRatioAvg": 0.6824817518248175, "computeRatioMax": 0.6824817518248175, "endMs": "1665776411170", "id": "13", "inputStages": [ "12", "9", "8", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "202", "startMs": "1665776411039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.014598540145985401, "waitRatioMax": 0.014598540145985401, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.014598540145985401, "writeRatioMax": 0.014598540145985401 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0364963503649635, "computeRatioMax": 0.0364963503649635, "endMs": "1665776411187", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "171", "startMs": "1665776411048", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0072992700729927005, "waitRatioMax": 0.0072992700729927005, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.021897810218978103, "writeRatioMax": 0.021897810218978103 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "108", "elapsedMs": "602", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "5203" }, { "activeUnits": "2", "completedUnits": "110", "elapsedMs": "710", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5576" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "5576", "transferredBytes": "0" }, "startTime": "1665776410507", "totalBytesProcessed": "14868320", "totalSlotMs": "5576" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon86dd1463_f49f_4271_8a77_9ec7ef0532d8" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Hhj6g0xiK04itOENl98TkQ==", "id": "test-project-364309:europe-west1.query01_1665776412", "jobReference": { "jobId": "query01_1665776412", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776412?location=europe-west1", "statistics": { "creationTime": "1665776412853", "endTime": "1665776413755", "finalExecutionDurationMs": "680", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "587" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.03643724696356275, "computeRatioMax": 0.03643724696356275, "endMs": "1665776413053", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.024291497975708502, "readRatioMax": 0.024291497975708502, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776413014", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004048582995951417, "waitRatioMax": 0.004048582995951417, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05263157894736842, "writeRatioMax": 0.05263157894736842 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04048582995951417, "computeRatioMax": 0.04048582995951417, "endMs": "1665776413079", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02834008097165992, "readRatioMax": 0.02834008097165992, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776413042", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004048582995951417, "waitRatioMax": 0.004048582995951417, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02834008097165992, "writeRatioMax": 0.02834008097165992 }, { "completedParallelInputs": "1", "computeMsAvg": "247", "computeMsMax": "247", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776413226", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.05668016194331984, "readRatioMax": 0.05668016194331984, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "247", "startMs": "1665776413067", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.016194331983805668, "waitRatioMax": 0.016194331983805668, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.03643724696356275, "writeRatioMax": 0.03643724696356275 }, { "completedParallelInputs": "1", "computeMsAvg": "145", "computeMsMax": "145", "computeRatioAvg": 0.5870445344129555, "computeRatioMax": 0.5870445344129555, "endMs": "1665776413200", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.044534412955465584, "readRatioMax": 0.044534412955465584, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "161", "startMs": "1665776413093", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004048582995951417, "waitRatioMax": 0.004048582995951417, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02834008097165992, "writeRatioMax": 0.02834008097165992 }, { "completedParallelInputs": "1", "computeMsAvg": "40", "computeMsMax": "40", "computeRatioAvg": 0.16194331983805668, "computeRatioMax": 0.16194331983805668, "endMs": "1665776413288", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776413259", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008097165991902834, "waitRatioMax": 0.008097165991902834, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.016194331983805668, "writeRatioMax": 0.016194331983805668 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.044534412955465584, "computeRatioMax": 0.044534412955465584, "endMs": "1665776413341", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776413307", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004048582995951417, "waitRatioMax": 0.004048582995951417, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06072874493927125, "writeRatioMax": 0.06072874493927125 }, { "completedParallelInputs": "1", "computeMsAvg": "63", "computeMsMax": "63", "computeRatioAvg": 0.2550607287449393, "computeRatioMax": 0.2550607287449393, "endMs": "1665776413411", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.048582995951417005, "readRatioMax": 0.048582995951417005, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "155", "startMs": "1665776413323", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004048582995951417, "waitRatioMax": 0.004048582995951417, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06477732793522267, "writeRatioMax": 0.06477732793522267 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.024291497975708502, "computeRatioMax": 0.024291497975708502, "endMs": "1665776413378", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.016194331983805668, "readRatioMax": 0.016194331983805668, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776413340", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004048582995951417, "waitRatioMax": 0.004048582995951417, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06477732793522267, "writeRatioMax": 0.06477732793522267 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "12", "computeRatioAvg": 0.032388663967611336, "computeRatioMax": 0.048582995951417005, "endMs": "1665776413474", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "5128", "startMs": "1665776413419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.008097165991902834, "waitRatioMax": 0.012145748987854251, "writeMsAvg": "14", "writeMsMax": "25", "writeRatioAvg": 0.05668016194331984, "writeRatioMax": 0.10121457489878542 }, { "completedParallelInputs": "1", "computeMsAvg": "139", "computeMsMax": "139", "computeRatioAvg": 0.562753036437247, "computeRatioMax": 0.562753036437247, "endMs": "1665776413624", "id": "13", "inputStages": [ "8", "12", "9", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "274", "startMs": "1665776413424", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.012145748987854251, "waitRatioMax": 0.012145748987854251, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.012145748987854251, "writeRatioMax": 0.012145748987854251 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.020242914979757085, "computeRatioMax": 0.020242914979757085, "endMs": "1665776413633", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "152", "startMs": "1665776413437", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.016194331983805668, "waitRatioMax": 0.016194331983805668, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.016194331983805668, "writeRatioMax": 0.016194331983805668 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "108", "elapsedMs": "606", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "5957" }, { "activeUnits": "2", "completedUnits": "110", "elapsedMs": "779", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6328" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "6328", "transferredBytes": "0" }, "startTime": "1665776412910", "totalBytesProcessed": "14868320", "totalSlotMs": "6328" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anondeb39116_799b_4bdc_82cb_800f08067ef0" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "6oPZmQ/cFV3LrheQIZ3b0g==", "id": "test-project-364309:europe-west1.query01_1665776414", "jobReference": { "jobId": "query01_1665776414", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776414?location=europe-west1", "statistics": { "creationTime": "1665776415511", "endTime": "1665776416257", "finalExecutionDurationMs": "532", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "589" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.040955631399317405, "computeRatioMax": 0.040955631399317405, "endMs": "1665776415697", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.027303754266211604, "readRatioMax": 0.027303754266211604, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776415660", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.027303754266211604, "writeRatioMax": 0.027303754266211604 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.030716723549488054, "computeRatioMax": 0.030716723549488054, "endMs": "1665776415730", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.017064846416382253, "readRatioMax": 0.017064846416382253, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665776415691", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.04778156996587031, "writeRatioMax": 0.04778156996587031 }, { "completedParallelInputs": "1", "computeMsAvg": "162", "computeMsMax": "162", "computeRatioAvg": 0.552901023890785, "computeRatioMax": 0.552901023890785, "endMs": "1665776415834", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.05802047781569966, "readRatioMax": 0.05802047781569966, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "204", "startMs": "1665776415708", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.030716723549488054, "writeRatioMax": 0.030716723549488054 }, { "completedParallelInputs": "1", "computeMsAvg": "293", "computeMsMax": "293", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776415916", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.04436860068259386, "readRatioMax": 0.04436860068259386, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "329", "startMs": "1665776415743", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.023890784982935155, "writeRatioMax": 0.023890784982935155 }, { "completedParallelInputs": "1", "computeMsAvg": "57", "computeMsMax": "57", "computeRatioAvg": 0.1945392491467577, "computeRatioMax": 0.1945392491467577, "endMs": "1665776415903", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "74", "startMs": "1665776415857", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.020477815699658702, "writeRatioMax": 0.020477815699658702 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.027303754266211604, "computeRatioMax": 0.027303754266211604, "endMs": "1665776415969", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776415934", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.051194539249146756, "writeRatioMax": 0.051194539249146756 }, { "completedParallelInputs": "1", "computeMsAvg": "50", "computeMsMax": "50", "computeRatioAvg": 0.17064846416382254, "computeRatioMax": 0.17064846416382254, "endMs": "1665776416015", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.023890784982935155, "readRatioMax": 0.023890784982935155, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "126", "startMs": "1665776415946", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.030716723549488054, "writeRatioMax": 0.030716723549488054 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.027303754266211604, "computeRatioMax": 0.027303754266211604, "endMs": "1665776416006", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.010238907849829351, "readRatioMax": 0.010238907849829351, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665776415964", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0034129692832764505, "waitRatioMax": 0.0034129692832764505, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.08191126279863481, "writeRatioMax": 0.08191126279863481 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "18", "computeRatioAvg": 0.023890784982935155, "computeRatioMax": 0.06143344709897611, "endMs": "1665776416111", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4954", "startMs": "1665776416053", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.010238907849829351, "waitRatioMax": 0.017064846416382253, "writeMsAvg": "15", "writeMsMax": "30", "writeRatioAvg": 0.051194539249146756, "writeRatioMax": 0.10238907849829351 }, { "completedParallelInputs": "1", "computeMsAvg": "82", "computeMsMax": "82", "computeRatioAvg": 0.27986348122866894, "computeRatioMax": 0.27986348122866894, "endMs": "1665776416139", "id": "13", "inputStages": [ "8", "5", "9", "12" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "114", "startMs": "1665776416060", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.013651877133105802, "waitRatioMax": 0.013651877133105802, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.010238907849829351, "writeRatioMax": 0.010238907849829351 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.034129692832764506, "computeRatioMax": 0.034129692832764506, "endMs": "1665776416151", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776416073", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.013651877133105802, "waitRatioMax": 0.013651877133105802, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.020477815699658702, "writeRatioMax": 0.020477815699658702 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "110", "elapsedMs": "602", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6079" }, { "activeUnits": "0", "completedUnits": "110", "elapsedMs": "628", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6079" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "6079", "transferredBytes": "0" }, "startTime": "1665776415559", "totalBytesProcessed": "14868320", "totalSlotMs": "6079" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon8920fc16_1f74_4196_ae78_dc4231754bd7" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "DRAuTWwQQKXpVJ8T6hSJUA==", "id": "test-project-364309:europe-west1.query01_1665776674", "jobReference": { "jobId": "query01_1665776674", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776674?location=europe-west1", "statistics": { "creationTime": "1665776675070", "endTime": "1665776675823", "finalExecutionDurationMs": "540", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "588" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05472636815920398, "computeRatioMax": 0.05472636815920398, "endMs": "1665776675269", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03980099502487562, "readRatioMax": 0.03980099502487562, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665776675237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07462686567164178, "writeRatioMax": 0.07462686567164178 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.029850746268656716, "computeRatioMax": 0.029850746268656716, "endMs": "1665776675305", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03482587064676617, "readRatioMax": 0.03482587064676617, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776675265", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06965174129353234, "writeRatioMax": 0.06965174129353234 }, { "completedParallelInputs": "1", "computeMsAvg": "201", "computeMsMax": "201", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776675407", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.06965174129353234, "readRatioMax": 0.06965174129353234, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "157", "startMs": "1665776675289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009950248756218905, "waitRatioMax": 0.009950248756218905, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.029850746268656716, "writeRatioMax": 0.029850746268656716 }, { "completedParallelInputs": "1", "computeMsAvg": "153", "computeMsMax": "153", "computeRatioAvg": 0.7611940298507462, "computeRatioMax": 0.7611940298507462, "endMs": "1665776675420", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.06965174129353234, "readRatioMax": 0.06965174129353234, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "148", "startMs": "1665776675316", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03482587064676617, "writeRatioMax": 0.03482587064676617 }, { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.23383084577114427, "computeRatioMax": 0.23383084577114427, "endMs": "1665776675484", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776675438", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03482587064676617, "writeRatioMax": 0.03482587064676617 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.06965174129353234, "computeRatioMax": 0.06965174129353234, "endMs": "1665776675536", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665776675507", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.0845771144278607, "writeRatioMax": 0.0845771144278607 }, { "completedParallelInputs": "1", "computeMsAvg": "82", "computeMsMax": "82", "computeRatioAvg": 0.4079601990049751, "computeRatioMax": 0.4079601990049751, "endMs": "1665776675598", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.05472636815920398, "readRatioMax": 0.05472636815920398, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665776675523", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05472636815920398, "writeRatioMax": 0.05472636815920398 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03482587064676617, "computeRatioMax": 0.03482587064676617, "endMs": "1665776675575", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "3", "readMsMax": "3", "readRatioAvg": 0.014925373134328358, "readRatioMax": 0.014925373134328358, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776675538", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004975124378109453, "waitRatioMax": 0.004975124378109453, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07960199004975124, "writeRatioMax": 0.07960199004975124 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.03980099502487562, "computeRatioMax": 0.08955223880597014, "endMs": "1665776675699", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "5841", "startMs": "1665776675613", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "4", "waitMsMax": "8", "waitRatioAvg": 0.01990049751243781, "waitRatioMax": 0.03980099502487562, "writeMsAvg": "14", "writeMsMax": "23", "writeRatioAvg": 0.06965174129353234, "writeRatioMax": 0.11442786069651742 }, { "completedParallelInputs": "1", "computeMsAvg": "160", "computeMsMax": "160", "computeRatioAvg": 0.7960199004975125, "computeRatioMax": 0.7960199004975125, "endMs": "1665776675746", "id": "13", "inputStages": [ "5", "9", "8", "12" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "209", "startMs": "1665776675621", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "9", "waitMsMax": "9", "waitRatioAvg": 0.04477611940298507, "waitRatioMax": 0.04477611940298507, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.024875621890547265, "writeRatioMax": 0.024875621890547265 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.024875621890547265, "computeRatioMax": 0.024875621890547265, "endMs": "1665776675746", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776675636", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.014925373134328358, "waitRatioMax": 0.014925373134328358, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.014925373134328358, "writeRatioMax": 0.014925373134328358 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "108", "elapsedMs": "607", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "6471" }, { "activeUnits": "2", "completedUnits": "110", "elapsedMs": "645", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6731" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "6731", "transferredBytes": "0" }, "startTime": "1665776675131", "totalBytesProcessed": "14868320", "totalSlotMs": "6731" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon60b51c75_4f0c_432f_98ce_49dbef2bb611" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "CqnWLpNEm0Emp/VnuPREzg==", "id": "test-project-364309:europe-west1.query01_1665776676", "jobReference": { "jobId": "query01_1665776676", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776676?location=europe-west1", "statistics": { "creationTime": "1665776677356", "endTime": "1665776678229", "finalExecutionDurationMs": "651", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "587" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06382978723404255, "computeRatioMax": 0.06382978723404255, "endMs": "1665776677673", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03723404255319149, "readRatioMax": 0.03723404255319149, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665776677604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "54", "writeMsMax": "54", "writeRatioAvg": 0.2872340425531915, "writeRatioMax": 0.2872340425531915 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.05319148936170213, "computeRatioMax": 0.05319148936170213, "endMs": "1665776677708", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03723404255319149, "readRatioMax": 0.03723404255319149, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665776677667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.06914893617021277, "writeRatioMax": 0.06914893617021277 }, { "completedParallelInputs": "1", "computeMsAvg": "149", "computeMsMax": "149", "computeRatioAvg": 0.7925531914893617, "computeRatioMax": 0.7925531914893617, "endMs": "1665776677796", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0797872340425532, "readRatioMax": 0.0797872340425532, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "161", "startMs": "1665776677690", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0425531914893617, "writeRatioMax": 0.0425531914893617 }, { "completedParallelInputs": "1", "computeMsAvg": "188", "computeMsMax": "188", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776677852", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.0851063829787234, "readRatioMax": 0.0851063829787234, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "186", "startMs": "1665776677721", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.047872340425531915, "writeRatioMax": 0.047872340425531915 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.18617021276595744, "computeRatioMax": 0.18617021276595744, "endMs": "1665776677886", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776677843", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0425531914893617, "writeRatioMax": 0.0425531914893617 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.031914893617021274, "computeRatioMax": 0.031914893617021274, "endMs": "1665776677957", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776677921", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "30", "writeMsMax": "30", "writeRatioAvg": 0.1595744680851064, "writeRatioMax": 0.1595744680851064 }, { "completedParallelInputs": "1", "computeMsAvg": "76", "computeMsMax": "76", "computeRatioAvg": 0.40425531914893614, "computeRatioMax": 0.40425531914893614, "endMs": "1665776678024", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.0425531914893617, "readRatioMax": 0.0425531914893617, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "114", "startMs": "1665776677939", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05851063829787234, "writeRatioMax": 0.05851063829787234 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.05851063829787234, "computeRatioMax": 0.05851063829787234, "endMs": "1665776678002", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.026595744680851064, "readRatioMax": 0.026595744680851064, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776677957", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.005319148936170213, "waitRatioMax": 0.005319148936170213, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.10106382978723404, "writeRatioMax": 0.10106382978723404 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.0425531914893617, "computeRatioMax": 0.0851063829787234, "endMs": "1665776678101", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4703", "startMs": "1665776678036", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "6", "waitRatioAvg": 0.015957446808510637, "waitRatioMax": 0.031914893617021274, "writeMsAvg": "19", "writeMsMax": "31", "writeRatioAvg": 0.10106382978723404, "writeRatioMax": 0.16489361702127658 }, { "completedParallelInputs": "1", "computeMsAvg": "163", "computeMsMax": "163", "computeRatioAvg": 0.8670212765957447, "computeRatioMax": 0.8670212765957447, "endMs": "1665776678132", "id": "13", "inputStages": [ "12", "8", "5", "9" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "160", "startMs": "1665776678045", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "6", "waitMsMax": "6", "waitRatioAvg": 0.031914893617021274, "waitRatioMax": 0.031914893617021274, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.015957446808510637, "writeRatioMax": 0.015957446808510637 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.06382978723404255, "computeRatioMax": 0.06382978723404255, "endMs": "1665776678139", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665776678058", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.015957446808510637, "waitRatioMax": 0.015957446808510637, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.02127659574468085, "writeRatioMax": 0.02127659574468085 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "108", "elapsedMs": "701", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "5454" }, { "activeUnits": "2", "completedUnits": "110", "elapsedMs": "773", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5670" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "5670", "transferredBytes": "0" }, "startTime": "1665776677404", "totalBytesProcessed": "14868320", "totalSlotMs": "5670" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4a12afd2_e3c4_4628_bef9_477af410b66b" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "XCVmFP/5fQCz0EVxp6223Q==", "id": "test-project-364309:europe-west1.query01_1665776679", "jobReference": { "jobId": "query01_1665776679", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776679?location=europe-west1", "statistics": { "creationTime": "1665776679690", "endTime": "1665776680499", "finalExecutionDurationMs": "613", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "588" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.039603960396039604, "computeRatioMax": 0.039603960396039604, "endMs": "1665776679882", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026402640264026403, "readRatioMax": 0.026402640264026403, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776679845", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.0033003300330033004, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.026402640264026403, "writeRatioMax": 0.026402640264026403 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0297029702970297, "computeRatioMax": 0.0297029702970297, "endMs": "1665776679910", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.0231023102310231, "readRatioMax": 0.0231023102310231, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776679879", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.0033003300330033004, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.052805280528052806, "writeRatioMax": 0.052805280528052806 }, { "completedParallelInputs": "1", "computeMsAvg": "303", "computeMsMax": "303", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776680081", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.0462046204620462, "readRatioMax": 0.0462046204620462, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "284", "startMs": "1665776679910", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.0033003300330033004, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0297029702970297, "writeRatioMax": 0.0297029702970297 }, { "completedParallelInputs": "1", "computeMsAvg": "262", "computeMsMax": "262", "computeRatioAvg": 0.8646864686468647, "computeRatioMax": 0.8646864686468647, "endMs": "1665776680050", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.066006600660066, "readRatioMax": 0.066006600660066, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "335", "startMs": "1665776679919", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.0033003300330033004, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.019801980198019802, "writeRatioMax": 0.019801980198019802 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.13861386138613863, "computeRatioMax": 0.13861386138613863, "endMs": "1665776680176", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776680138", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.0033003300330033004, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.0165016501650165, "writeRatioMax": 0.0165016501650165 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.036303630363036306, "computeRatioMax": 0.036303630363036306, "endMs": "1665776680254", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665776680212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.0033003300330033004, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.056105610561056105, "writeRatioMax": 0.056105610561056105 }, { "completedParallelInputs": "1", "computeMsAvg": "66", "computeMsMax": "66", "computeRatioAvg": 0.21782178217821782, "computeRatioMax": 0.21782178217821782, "endMs": "1665776680293", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026402640264026403, "readRatioMax": 0.026402640264026403, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "95", "startMs": "1665776680227", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.0033003300330033004, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.036303630363036306, "writeRatioMax": 0.036303630363036306 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.039603960396039604, "computeRatioMax": 0.039603960396039604, "endMs": "1665776680269", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.026402640264026403, "readRatioMax": 0.026402640264026403, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776680241", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.0033003300330033004, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.033003300330033, "writeRatioMax": 0.033003300330033 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.026402640264026403, "computeRatioMax": 0.052805280528052806, "endMs": "1665776680349", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4009", "startMs": "1665776680298", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0033003300330033004, "waitRatioMax": 0.006600660066006601, "writeMsAvg": "14", "writeMsMax": "24", "writeRatioAvg": 0.0462046204620462, "writeRatioMax": 0.07920792079207921 }, { "completedParallelInputs": "1", "computeMsAvg": "130", "computeMsMax": "130", "computeRatioAvg": 0.429042904290429, "computeRatioMax": 0.429042904290429, "endMs": "1665776680398", "id": "13", "inputStages": [ "9", "5", "8", "12" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "324", "startMs": "1665776680302", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013201320132013201, "writeRatioMax": 0.013201320132013201 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.04950495049504951, "computeRatioMax": 0.04950495049504951, "endMs": "1665776680410", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "107", "startMs": "1665776680316", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.009900990099009901, "waitRatioMax": 0.009900990099009901, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.0231023102310231, "writeRatioMax": 0.0231023102310231 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "14", "completedUnits": "102", "elapsedMs": "604", "estimatedRunnableUnits": "0", "pendingUnits": "8", "totalSlotMs": "4749" }, { "activeUnits": "11", "completedUnits": "110", "elapsedMs": "711", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5313" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "5313", "transferredBytes": "0" }, "startTime": "1665776679739", "totalBytesProcessed": "14868320", "totalSlotMs": "5313" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon4a006008_30e5_41d2_8301_8f6461189e6e" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "xwL7kZ/is5Z1qe3suEzChA==", "id": "test-project-364309:europe-west1.query01_1665776681", "jobReference": { "jobId": "query01_1665776681", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776681?location=europe-west1", "statistics": { "creationTime": "1665776682187", "endTime": "1665776682952", "finalExecutionDurationMs": "568", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "589" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.07975460122699386, "computeRatioMax": 0.07975460122699386, "endMs": "1665776682372", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.04294478527607362, "readRatioMax": 0.04294478527607362, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665776682338", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006134969325153374, "waitRatioMax": 0.006134969325153374, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.049079754601226995, "writeRatioMax": 0.049079754601226995 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03680981595092025, "computeRatioMax": 0.03680981595092025, "endMs": "1665776682391", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03067484662576687, "readRatioMax": 0.03067484662576687, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776682364", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006134969325153374, "waitRatioMax": 0.006134969325153374, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.09202453987730061, "writeRatioMax": 0.09202453987730061 }, { "completedParallelInputs": "1", "computeMsAvg": "163", "computeMsMax": "163", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776682512", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.07975460122699386, "readRatioMax": 0.07975460122699386, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "213", "startMs": "1665776682388", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006134969325153374, "waitRatioMax": 0.006134969325153374, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03680981595092025, "writeRatioMax": 0.03680981595092025 }, { "completedParallelInputs": "1", "computeMsAvg": "161", "computeMsMax": "161", "computeRatioAvg": 0.9877300613496932, "computeRatioMax": 0.9877300613496932, "endMs": "1665776682509", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0736196319018405, "readRatioMax": 0.0736196319018405, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "186", "startMs": "1665776682400", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006134969325153374, "waitRatioMax": 0.006134969325153374, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.04294478527607362, "writeRatioMax": 0.04294478527607362 }, { "completedParallelInputs": "1", "computeMsAvg": "43", "computeMsMax": "43", "computeRatioAvg": 0.26380368098159507, "computeRatioMax": 0.26380368098159507, "endMs": "1665776682569", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776682536", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006134969325153374, "waitRatioMax": 0.006134969325153374, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.03680981595092025, "writeRatioMax": 0.03680981595092025 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.09815950920245399, "computeRatioMax": 0.09815950920245399, "endMs": "1665776682645", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665776682604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006134969325153374, "waitRatioMax": 0.006134969325153374, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.10429447852760736, "writeRatioMax": 0.10429447852760736 }, { "completedParallelInputs": "1", "computeMsAvg": "64", "computeMsMax": "64", "computeRatioAvg": 0.39263803680981596, "computeRatioMax": 0.39263803680981596, "endMs": "1665776682702", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.0736196319018405, "readRatioMax": 0.0736196319018405, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "125", "startMs": "1665776682617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006134969325153374, "waitRatioMax": 0.006134969325153374, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.08588957055214724, "writeRatioMax": 0.08588957055214724 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.06134969325153374, "computeRatioMax": 0.06134969325153374, "endMs": "1665776682666", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.03067484662576687, "readRatioMax": 0.03067484662576687, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776682632", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.006134969325153374, "waitRatioMax": 0.006134969325153374, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.12883435582822086, "writeRatioMax": 0.12883435582822086 }, { "completedParallelInputs": "100", "computeMsAvg": "9", "computeMsMax": "19", "computeRatioAvg": 0.05521472392638037, "computeRatioMax": 0.1165644171779141, "endMs": "1665776682764", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4938", "startMs": "1665776682705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "21", "waitRatioAvg": 0.012269938650306749, "waitRatioMax": 0.12883435582822086, "writeMsAvg": "22", "writeMsMax": "36", "writeRatioAvg": 0.13496932515337423, "writeRatioMax": 0.22085889570552147 }, { "completedParallelInputs": "1", "computeMsAvg": "155", "computeMsMax": "155", "computeRatioAvg": 0.950920245398773, "computeRatioMax": 0.950920245398773, "endMs": "1665776682837", "id": "13", "inputStages": [ "12", "8", "5", "9" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "183", "startMs": "1665776682725", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "20", "waitMsMax": "20", "waitRatioAvg": 0.12269938650306748, "waitRatioMax": 0.12269938650306748, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.012269938650306749, "writeRatioMax": 0.012269938650306749 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.03680981595092025, "computeRatioMax": 0.03680981595092025, "endMs": "1665776682867", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "153", "startMs": "1665776682730", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.018404907975460124, "waitRatioMax": 0.018404907975460124, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.024539877300613498, "writeRatioMax": 0.024539877300613498 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "108", "elapsedMs": "599", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "5699" }, { "activeUnits": "2", "completedUnits": "110", "elapsedMs": "662", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "6036" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "6036", "transferredBytes": "0" }, "startTime": "1665776682240", "totalBytesProcessed": "14868320", "totalSlotMs": "6036" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anond1bd7716_9897_471e_afa8_4d0146933926" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "txfO6x3uIWFSUbOAVE0cew==", "id": "test-project-364309:europe-west1.query01_1665776684", "jobReference": { "jobId": "query01_1665776684", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665776684?location=europe-west1", "statistics": { "creationTime": "1665776684651", "endTime": "1665776685482", "finalExecutionDurationMs": "585", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "588" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.041666666666666664, "computeRatioMax": 0.041666666666666664, "endMs": "1665776684883", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.023148148148148147, "readRatioMax": 0.023148148148148147, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665776684845", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.06944444444444445, "writeRatioMax": 0.06944444444444445 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.046296296296296294, "computeRatioMax": 0.046296296296296294, "endMs": "1665776684909", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.027777777777777776, "readRatioMax": 0.027777777777777776, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665776684871", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06481481481481481, "writeRatioMax": 0.06481481481481481 }, { "completedParallelInputs": "1", "computeMsAvg": "216", "computeMsMax": "216", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776685052", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.08333333333333333, "readRatioMax": 0.08333333333333333, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "237", "startMs": "1665776684894", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.05092592592592592, "writeRatioMax": 0.05092592592592592 }, { "completedParallelInputs": "1", "computeMsAvg": "125", "computeMsMax": "125", "computeRatioAvg": 0.5787037037037037, "computeRatioMax": 0.5787037037037037, "endMs": "1665776685021", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.05092592592592592, "readRatioMax": 0.05092592592592592, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "148", "startMs": "1665776684921", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.027777777777777776, "writeRatioMax": 0.027777777777777776 }, { "completedParallelInputs": "1", "computeMsAvg": "51", "computeMsMax": "51", "computeRatioAvg": 0.2361111111111111, "computeRatioMax": 0.2361111111111111, "endMs": "1665776685119", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "71", "startMs": "1665776685074", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.046296296296296294, "computeRatioMax": 0.046296296296296294, "endMs": "1665776685179", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665776685144", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06481481481481481, "writeRatioMax": 0.06481481481481481 }, { "completedParallelInputs": "1", "computeMsAvg": "65", "computeMsMax": "65", "computeRatioAvg": 0.30092592592592593, "computeRatioMax": 0.30092592592592593, "endMs": "1665776685244", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.046296296296296294, "readRatioMax": 0.046296296296296294, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "115", "startMs": "1665776685158", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.046296296296296294, "writeRatioMax": 0.046296296296296294 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.037037037037037035, "computeRatioMax": 0.037037037037037035, "endMs": "1665776685202", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.023148148148148147, "readRatioMax": 0.023148148148148147, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776685171", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004629629629629629, "waitRatioMax": 0.004629629629629629, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.037037037037037035, "writeRatioMax": 0.037037037037037035 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.037037037037037035, "computeRatioMax": 0.08333333333333333, "endMs": "1665776685330", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "4471", "startMs": "1665776685272", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "2", "waitMsMax": "4", "waitRatioAvg": 0.009259259259259259, "waitRatioMax": 0.018518518518518517, "writeMsAvg": "15", "writeMsMax": "22", "writeRatioAvg": 0.06944444444444445, "writeRatioMax": 0.10185185185185185 }, { "completedParallelInputs": "1", "computeMsAvg": "143", "computeMsMax": "143", "computeRatioAvg": 0.6620370370370371, "computeRatioMax": 0.6620370370370371, "endMs": "1665776685383", "id": "13", "inputStages": [ "9", "12", "8", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "187", "startMs": "1665776685278", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.023148148148148147, "waitRatioMax": 0.023148148148148147, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.013888888888888888, "writeRatioMax": 0.013888888888888888 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.032407407407407406, "computeRatioMax": 0.032407407407407406, "endMs": "1665776685399", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "94", "startMs": "1665776685289", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.013888888888888888, "waitRatioMax": 0.013888888888888888, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.027777777777777776, "writeRatioMax": 0.027777777777777776 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "108", "elapsedMs": "620", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "5239" }, { "activeUnits": "2", "completedUnits": "110", "elapsedMs": "701", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5521" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "5521", "transferredBytes": "0" }, "startTime": "1665776684726", "totalBytesProcessed": "14868320", "totalSlotMs": "5521" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon02236b70_f4ea_4377_afa6_c682d4cc7e26" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "Dtuaxd71WPWmenmuT86hSw==", "id": "test-project-364309:europe-west1.query01_1665777626", "jobReference": { "jobId": "query01_1665777626", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665777626?location=europe-west1", "statistics": { "creationTime": "1665777627271", "endTime": "1665777628181", "finalExecutionDurationMs": "687", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "588" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.046875, "computeRatioMax": 0.046875, "endMs": "1665777627566", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.02734375, "readRatioMax": 0.02734375, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "115", "startMs": "1665777627442", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.05078125, "writeRatioMax": 0.05078125 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.0546875, "computeRatioMax": 0.0546875, "endMs": "1665777627582", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.03125, "readRatioMax": 0.03125, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777627539", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.04296875, "writeRatioMax": 0.04296875 }, { "completedParallelInputs": "1", "computeMsAvg": "126", "computeMsMax": "126", "computeRatioAvg": 0.4921875, "computeRatioMax": 0.4921875, "endMs": "1665777627667", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0390625, "readRatioMax": 0.0390625, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "115", "startMs": "1665777627573", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.0234375, "writeRatioMax": 0.0234375 }, { "completedParallelInputs": "1", "computeMsAvg": "256", "computeMsMax": "256", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777627743", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "11", "readMsMax": "11", "readRatioAvg": 0.04296875, "readRatioMax": 0.04296875, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "215", "startMs": "1665777627596", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.015625, "waitRatioMax": 0.015625, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.03125, "writeRatioMax": 0.03125 }, { "completedParallelInputs": "1", "computeMsAvg": "48", "computeMsMax": "48", "computeRatioAvg": 0.1875, "computeRatioMax": 0.1875, "endMs": "1665777627737", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777627695", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02734375, "writeRatioMax": 0.02734375 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03125, "computeRatioMax": 0.03125, "endMs": "1665777627820", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777627785", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.10546875, "writeRatioMax": 0.10546875 }, { "completedParallelInputs": "1", "computeMsAvg": "64", "computeMsMax": "64", "computeRatioAvg": 0.25, "computeRatioMax": 0.25, "endMs": "1665777627883", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.0390625, "readRatioMax": 0.0390625, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "91", "startMs": "1665777627798", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0546875, "writeRatioMax": 0.0546875 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.0390625, "computeRatioMax": 0.0390625, "endMs": "1665777627849", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01953125, "readRatioMax": 0.01953125, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777627814", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00390625, "waitRatioMax": 0.00390625, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.08203125, "writeRatioMax": 0.08203125 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.03125, "computeRatioMax": 0.05859375, "endMs": "1665777627952", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "3763", "startMs": "1665777627897", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.01171875, "waitRatioMax": 0.015625, "writeMsAvg": "20", "writeMsMax": "31", "writeRatioAvg": 0.078125, "writeRatioMax": 0.12109375 }, { "completedParallelInputs": "1", "computeMsAvg": "134", "computeMsMax": "134", "computeRatioAvg": 0.5234375, "computeRatioMax": 0.5234375, "endMs": "1665777628037", "id": "13", "inputStages": [ "12", "9", "8", "5" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "121", "startMs": "1665777627903", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.01953125, "waitRatioMax": 0.01953125, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.00390625, "writeRatioMax": 0.00390625 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05078125, "computeRatioMax": 0.05078125, "endMs": "1665777628059", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "100", "startMs": "1665777627914", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0078125, "waitRatioMax": 0.0078125, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01953125, "writeRatioMax": 0.01953125 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "53", "completedUnits": "53", "elapsedMs": "607", "estimatedRunnableUnits": "0", "pendingUnits": "57", "totalSlotMs": "2371" }, { "activeUnits": "41", "completedUnits": "110", "elapsedMs": "793", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4683" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "4683", "transferredBytes": "0" }, "startTime": "1665777627337", "totalBytesProcessed": "14868320", "totalSlotMs": "4683" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon155ff387_9673_4064_b417_e1aad4e55b61" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "VjNBaErkgF0ta/S4A6d3sw==", "id": "test-project-364309:europe-west1.query01_1665777629", "jobReference": { "jobId": "query01_1665777629", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665777629?location=europe-west1", "statistics": { "creationTime": "1665777629812", "endTime": "1665777630516", "finalExecutionDurationMs": "520", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "590" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.045871559633027525, "computeRatioMax": 0.045871559633027525, "endMs": "1665777629992", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.027522935779816515, "readRatioMax": 0.027522935779816515, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777629956", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05504587155963303, "writeRatioMax": 0.05504587155963303 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04128440366972477, "computeRatioMax": 0.04128440366972477, "endMs": "1665777630017", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.022935779816513763, "readRatioMax": 0.022935779816513763, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777629982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05504587155963303, "writeRatioMax": 0.05504587155963303 }, { "completedParallelInputs": "1", "computeMsAvg": "152", "computeMsMax": "152", "computeRatioAvg": 0.6972477064220184, "computeRatioMax": 0.6972477064220184, "endMs": "1665777630127", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.07339449541284404, "readRatioMax": 0.07339449541284404, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "164", "startMs": "1665777630006", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03211009174311927, "writeRatioMax": 0.03211009174311927 }, { "completedParallelInputs": "1", "computeMsAvg": "218", "computeMsMax": "218", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777630162", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.05963302752293578, "readRatioMax": 0.05963302752293578, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "144", "startMs": "1665777630029", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03211009174311927, "writeRatioMax": 0.03211009174311927 }, { "completedParallelInputs": "1", "computeMsAvg": "60", "computeMsMax": "60", "computeRatioAvg": 0.27522935779816515, "computeRatioMax": 0.27522935779816515, "endMs": "1665777630207", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777630164", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03211009174311927, "writeRatioMax": 0.03211009174311927 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.05963302752293578, "computeRatioMax": 0.05963302752293578, "endMs": "1665777630263", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777630227", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07339449541284404, "writeRatioMax": 0.07339449541284404 }, { "completedParallelInputs": "1", "computeMsAvg": "74", "computeMsMax": "74", "computeRatioAvg": 0.3394495412844037, "computeRatioMax": 0.3394495412844037, "endMs": "1665777630301", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.04128440366972477, "readRatioMax": 0.04128440366972477, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "91", "startMs": "1665777630241", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.045871559633027525, "writeRatioMax": 0.045871559633027525 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03669724770642202, "computeRatioMax": 0.03669724770642202, "endMs": "1665777630294", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.01834862385321101, "readRatioMax": 0.01834862385321101, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777630255", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07339449541284404, "writeRatioMax": 0.07339449541284404 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.03669724770642202, "computeRatioMax": 0.06880733944954129, "endMs": "1665777630362", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "3222", "startMs": "1665777630315", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.013761467889908258, "waitRatioMax": 0.01834862385321101, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.06422018348623854, "writeRatioMax": 0.0871559633027523 }, { "completedParallelInputs": "1", "computeMsAvg": "155", "computeMsMax": "155", "computeRatioAvg": 0.7110091743119266, "computeRatioMax": 0.7110091743119266, "endMs": "1665777630421", "id": "13", "inputStages": [ "12", "5", "8", "9" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "129", "startMs": "1665777630322", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.01834862385321101, "waitRatioMax": 0.01834862385321101, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.013761467889908258, "writeRatioMax": 0.013761467889908258 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04128440366972477, "computeRatioMax": 0.04128440366972477, "endMs": "1665777630425", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777630331", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0045871559633027525, "waitRatioMax": 0.0045871559633027525, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.013761467889908258, "writeRatioMax": 0.013761467889908258 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "110", "elapsedMs": "596", "pendingUnits": "0", "totalSlotMs": "3989" }, { "activeUnits": "0", "completedUnits": "110", "elapsedMs": "609", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3989" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "3989", "transferredBytes": "0" }, "startTime": "1665777629862", "totalBytesProcessed": "14868320", "totalSlotMs": "3989" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonada6ab99_1c62_44b7_8b56_5d0ad55d1921" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "WzKXqbmPE0DJgJY6nxFZag==", "id": "test-project-364309:europe-west1.query01_1665777631", "jobReference": { "jobId": "query01_1665777631", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665777631?location=europe-west1", "statistics": { "creationTime": "1665777632213", "endTime": "1665777633034", "finalExecutionDurationMs": "590", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "589" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.057777777777777775, "computeRatioMax": 0.057777777777777775, "endMs": "1665777632438", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.035555555555555556, "readRatioMax": 0.035555555555555556, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777632396", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.04888888888888889, "writeRatioMax": 0.04888888888888889 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.05333333333333334, "computeRatioMax": 0.05333333333333334, "endMs": "1665777632465", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.035555555555555556, "readRatioMax": 0.035555555555555556, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665777632425", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.05333333333333334, "writeRatioMax": 0.05333333333333334 }, { "completedParallelInputs": "1", "computeMsAvg": "225", "computeMsMax": "225", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777632597", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "14", "readMsMax": "14", "readRatioAvg": 0.06222222222222222, "readRatioMax": 0.06222222222222222, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "145", "startMs": "1665777632465", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "19", "waitMsMax": "19", "waitRatioAvg": 0.08444444444444445, "waitRatioMax": 0.08444444444444445, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02666666666666667, "writeRatioMax": 0.02666666666666667 }, { "completedParallelInputs": "1", "computeMsAvg": "151", "computeMsMax": "151", "computeRatioAvg": 0.6711111111111111, "computeRatioMax": 0.6711111111111111, "endMs": "1665777632597", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "12", "readMsMax": "12", "readRatioAvg": 0.05333333333333334, "readRatioMax": 0.05333333333333334, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "153", "startMs": "1665777632482", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008888888888888889, "waitRatioMax": 0.008888888888888889, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04, "writeRatioMax": 0.04 }, { "completedParallelInputs": "1", "computeMsAvg": "42", "computeMsMax": "42", "computeRatioAvg": 0.18666666666666668, "computeRatioMax": 0.18666666666666668, "endMs": "1665777632687", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777632650", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.03111111111111111, "writeRatioMax": 0.03111111111111111 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.04, "computeRatioMax": 0.04, "endMs": "1665777632765", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777632714", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07111111111111111, "writeRatioMax": 0.07111111111111111 }, { "completedParallelInputs": "1", "computeMsAvg": "45", "computeMsMax": "45", "computeRatioAvg": 0.2, "computeRatioMax": 0.2, "endMs": "1665777632783", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "7", "readMsMax": "7", "readRatioAvg": 0.03111111111111111, "readRatioMax": 0.03111111111111111, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777632729", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.04, "writeRatioMax": 0.04 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03111111111111111, "computeRatioMax": 0.03111111111111111, "endMs": "1665777632779", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "4", "readMsMax": "4", "readRatioAvg": 0.017777777777777778, "readRatioMax": 0.017777777777777778, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665777632743", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0044444444444444444, "waitRatioMax": 0.0044444444444444444, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.07111111111111111, "writeRatioMax": 0.07111111111111111 }, { "completedParallelInputs": "100", "computeMsAvg": "7", "computeMsMax": "15", "computeRatioAvg": 0.03111111111111111, "computeRatioMax": 0.06666666666666667, "endMs": "1665777632855", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "2248", "startMs": "1665777632804", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.013333333333333334, "waitRatioMax": 0.017777777777777778, "writeMsAvg": "14", "writeMsMax": "26", "writeRatioAvg": 0.06222222222222222, "writeRatioMax": 0.11555555555555555 }, { "completedParallelInputs": "1", "computeMsAvg": "139", "computeMsMax": "139", "computeRatioAvg": 0.6177777777777778, "computeRatioMax": 0.6177777777777778, "endMs": "1665777632905", "id": "13", "inputStages": [ "8", "5", "9", "12" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "121", "startMs": "1665777632811", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.017777777777777778, "waitRatioMax": 0.017777777777777778, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.008888888888888889, "writeRatioMax": 0.008888888888888889 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.035555555555555556, "computeRatioMax": 0.035555555555555556, "endMs": "1665777632935", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777632819", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.013333333333333334, "waitRatioMax": 0.013333333333333334, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.017777777777777778, "writeRatioMax": 0.017777777777777778 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "108", "elapsedMs": "635", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "2737" }, { "activeUnits": "2", "completedUnits": "110", "elapsedMs": "719", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "2913" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "2913", "transferredBytes": "0" }, "startTime": "1665777632262", "totalBytesProcessed": "14868320", "totalSlotMs": "2913" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3ccdc685_c3d5_47f2_85d3_c1790b78ae06" }, "priority": "INTERACTIVE", "query": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return \nas(select sr_customer_sk as ctr_customer_sk\n ,sr_store_sk as ctr_store_sk\n ,sum(SR_RETURN_AMT) as ctr_total_return\n from store_returns\n ,date_dim\n where sr_returned_date_sk = d_date_sk\n and d_year =2000\n group by sr_customer_sk\n ,sr_store_sk), \n\nhigh_return as (\n select ctr_store_sk,avg(ctr_total_return)*1.2 as limit_return\n from customer_total_return ctr2\n group by ctr_store_sk\n)\n\nselect c_customer_id\nfrom customer_total_return ctr1\n ,store\n ,customer\n ,high_return\nwhere ctr1.ctr_total_return > high_return.limit_return\n and s_store_sk = ctr1.ctr_store_sk\n and s_state = 'TN'\n and ctr1.ctr_customer_sk = c_customer_sk\n and ctr1.ctr_store_sk = high_return.ctr_store_sk\norder by c_customer_id\nlimit 100\n;\n\n-- end query 1 in stream 0 using template query1.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "6Z4um2SNKCmpKJuNNtJByw==", "id": "test-project-364309:europe-west1.query01_1665777634", "jobReference": { "jobId": "query01_1665777634", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query01_1665777634?location=europe-west1", "statistics": { "creationTime": "1665777634557", "endTime": "1665777635369", "finalExecutionDurationMs": "618", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "14868320", "performanceInsights": { "avgPreviousExecutionMs": "589" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.028688524590163935, "computeRatioMax": 0.028688524590163935, "endMs": "1665777634729", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02459016393442623, "readRatioMax": 0.02459016393442623, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777634688", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$50:d_date_sk, $51:d_year", "FROM date_dim", "WHERE equal($51, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$50", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06557377049180328, "writeRatioMax": 0.06557377049180328 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04918032786885246, "computeRatioMax": 0.04918032786885246, "endMs": "1665777634766", "id": "2", "name": "S02: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02459016393442623, "readRatioMax": 0.02459016393442623, "recordsRead": "73049", "recordsWritten": "366", "shuffleOutputBytes": "3294", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777634716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$30:d_date_sk, $31:d_year", "FROM date_dim", "WHERE equal($31, 2000)" ] }, { "kind": "WRITE", "substeps": [ "$30", "TO __stage02_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.06967213114754098, "writeRatioMax": 0.06967213114754098 }, { "completedParallelInputs": "1", "computeMsAvg": "182", "computeMsMax": "182", "computeRatioAvg": 0.7459016393442623, "computeRatioMax": 0.7459016393442623, "endMs": "1665777634885", "id": "4", "inputStages": [ "0" ], "name": "S04: Join+", "parallelInputs": "1", "readMsAvg": "17", "readMsMax": "17", "readRatioAvg": 0.06967213114754098, "readRatioMax": 0.06967213114754098, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "193", "startMs": "1665777634737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$50", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $180 := $170, $181 := $171", "$110 := SUM($172)" ] }, { "kind": "JOIN", "substeps": [ "$170 := $41, $171 := $42, $172 := $43", "INNER HASH JOIN EACH WITH ALL ON $40 = $50" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $110", "TO __stage04_output", "BY HASH($180, $181)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.045081967213114756, "writeRatioMax": 0.045081967213114756 }, { "completedParallelInputs": "1", "computeMsAvg": "244", "computeMsMax": "244", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665777634919", "id": "5", "inputStages": [ "2" ], "name": "S05: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.06147540983606557, "readRatioMax": 0.06147540983606557, "recordsRead": "287880", "recordsWritten": "50441", "shuffleOutputBytes": "1754227", "shuffleOutputBytesSpilled": "0", "slotMs": "212", "startMs": "1665777634771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt", "FROM store_returns" ] }, { "kind": "READ", "substeps": [ "$30", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $130 := $120, $131 := $121", "$100 := SUM($122)" ] }, { "kind": "JOIN", "substeps": [ "$120 := $21, $121 := $22, $122 := $23", "INNER HASH JOIN EACH WITH ALL ON $20 = $30" ] }, { "kind": "WRITE", "substeps": [ "$130, $131, $100", "TO __stage05_output", "BY HASH($130, $131)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02459016393442623, "writeRatioMax": 0.02459016393442623 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.1598360655737705, "computeRatioMax": 0.1598360655737705, "endMs": "1665777634977", "id": "6", "inputStages": [ "4" ], "name": "S06: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "50441", "recordsWritten": "7", "shuffleOutputBytes": "174", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665777634941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$180, $181, $110", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191", "$80 := SHARD_AVG($90)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $190 := $180, $191 := $181", "$90 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$200, $80", "TO __stage06_output", "BY HASH($200)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.028688524590163935, "writeRatioMax": 0.028688524590163935 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.040983606557377046, "computeRatioMax": 0.040983606557377046, "endMs": "1665777635038", "id": "7", "inputStages": [ "6" ], "name": "S07: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "7", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777635002", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $80", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200", "$60 := ROOT_AVG($80)" ] }, { "kind": "WRITE", "substeps": [ "$60, $210", "TO __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.06557377049180328, "writeRatioMax": 0.06557377049180328 }, { "completedParallelInputs": "1", "computeMsAvg": "89", "computeMsMax": "89", "computeRatioAvg": 0.36475409836065575, "computeRatioMax": 0.36475409836065575, "endMs": "1665777635092", "id": "8", "name": "S08: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.036885245901639344, "readRatioMax": 0.036885245901639344, "recordsRead": "100000", "recordsWritten": "100000", "shuffleOutputBytes": "3000000", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665777635017", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:c_customer_sk, $2:c_customer_id", "FROM customer" ] }, { "kind": "WRITE", "substeps": [ "$1, $2", "TO __stage08_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.040983606557377046, "writeRatioMax": 0.040983606557377046 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03278688524590164, "computeRatioMax": 0.03278688524590164, "endMs": "1665777635061", "id": "9", "name": "S09: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.020491803278688523, "readRatioMax": 0.020491803278688523, "recordsRead": "12", "recordsWritten": "12", "shuffleOutputBytes": "108", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777635030", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:s_store_sk, $11:s_state", "FROM store", "WHERE equal($11, 'TN')" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.004098360655737705, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.08196721311475409, "writeRatioMax": 0.08196721311475409 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.03278688524590164, "computeRatioMax": 0.05737704918032787, "endMs": "1665777635162", "id": "12", "inputStages": [ "7" ], "name": "S0C: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "6", "recordsWritten": "6", "shuffleOutputBytes": "156", "shuffleOutputBytesSpilled": "0", "slotMs": "3428", "startMs": "1665777635113", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage07_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004098360655737705, "waitRatioMax": 0.00819672131147541, "writeMsAvg": "14", "writeMsMax": "30", "writeRatioAvg": 0.05737704918032787, "writeRatioMax": 0.12295081967213115 }, { "completedParallelInputs": "1", "computeMsAvg": "185", "computeMsMax": "185", "computeRatioAvg": 0.7581967213114754, "computeRatioMax": 0.7581967213114754, "endMs": "1665777635236", "id": "13", "inputStages": [ "9", "12", "5", "8" ], "name": "S0D: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "150459", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "164", "startMs": "1665777635118", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$130, $131, $100", "FROM __stage05_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage09_output" ] }, { "kind": "READ", "substeps": [ "$1, $2", "FROM __stage08_output" ] }, { "kind": "READ", "substeps": [ "$60, $210", "FROM __stage0C_output" ] }, { "kind": "SORT", "substeps": [ "$220 ASC", "LIMIT 100" ] }, { "kind": "FILTER", "substeps": [ "greater($221, multiply($222, NUMERIC<...>))" ] }, { "kind": "JOIN", "substeps": [ "$220 := $162, $221 := $161, $222 := $60", "INNER HASH JOIN EACH WITH ALL ON $160 = $210" ] }, { "kind": "JOIN", "substeps": [ "$160 := $151, $161 := $152, $162 := $2", "INNER HASH JOIN EACH WITH ALL ON $150 = $1" ] }, { "kind": "JOIN", "substeps": [ "$150 := $140, $151 := $141, $152 := $70", "INNER HASH JOIN EACH WITH ALL ON $141 = $10" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $140 := $130, $141 := $131", "$70 := SUM($100)" ] }, { "kind": "WRITE", "substeps": [ "$230", "TO __stage0D_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.012295081967213115, "waitRatioMax": 0.012295081967213115, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.01639344262295082, "writeRatioMax": 0.01639344262295082 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.01639344262295082, "computeRatioMax": 0.01639344262295082, "endMs": "1665777635256", "id": "14", "inputStages": [ "13" ], "name": "S0E: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "100", "recordsWritten": "100", "shuffleOutputBytes": "2100", "shuffleOutputBytesSpilled": "0", "slotMs": "92", "startMs": "1665777635131", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$230", "FROM __stage0D_output" ] }, { "kind": "SORT", "substeps": [ "$230 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$240", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.012295081967213115, "waitRatioMax": 0.012295081967213115, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.00819672131147541, "writeRatioMax": 0.00819672131147541 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_returns" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "customer" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "108", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "4112" }, { "activeUnits": "2", "completedUnits": "110", "elapsedMs": "702", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "4370" } ], "totalBytesBilled": "41943040", "totalBytesProcessed": "14868320", "totalPartitionsProcessed": "0", "totalSlotMs": "4370", "transferredBytes": "0" }, "startTime": "1665777634600", "totalBytesProcessed": "14868320", "totalSlotMs": "4370" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
BigQuery error in show operation: Not found: Job test-project-364309:europe- west1.query01_1665777635
