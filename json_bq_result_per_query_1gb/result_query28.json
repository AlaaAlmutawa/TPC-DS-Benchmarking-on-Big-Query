{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon64e59148_6954_4e40_9c25_12087fc94751" }, "priority": "INTERACTIVE", "query": "select *\nfrom (select avg(ss_list_price) B1_LP\n ,count(ss_list_price) B1_CNT\n ,count(distinct ss_list_price) B1_CNTD\n from store_sales\n where ss_quantity between 0 and 5\n and (ss_list_price between 107 and 107+10 \n or ss_coupon_amt between 1319 and 1319+1000\n or ss_wholesale_cost between 60 and 60+20)) B1,\n (select avg(ss_list_price) B2_LP\n ,count(ss_list_price) B2_CNT\n ,count(distinct ss_list_price) B2_CNTD\n from store_sales\n where ss_quantity between 6 and 10\n and (ss_list_price between 23 and 23+10\n or ss_coupon_amt between 825 and 825+1000\n or ss_wholesale_cost between 43 and 43+20)) B2,\n (select avg(ss_list_price) B3_LP\n ,count(ss_list_price) B3_CNT\n ,count(distinct ss_list_price) B3_CNTD\n from store_sales\n where ss_quantity between 11 and 15\n and (ss_list_price between 74 and 74+10\n or ss_coupon_amt between 4381 and 4381+1000\n or ss_wholesale_cost between 57 and 57+20)) B3,\n (select avg(ss_list_price) B4_LP\n ,count(ss_list_price) B4_CNT\n ,count(distinct ss_list_price) B4_CNTD\n from store_sales\n where ss_quantity between 16 and 20\n and (ss_list_price between 89 and 89+10\n or ss_coupon_amt between 3117 and 3117+1000\n or ss_wholesale_cost between 68 and 68+20)) B4,\n (select avg(ss_list_price) B5_LP\n ,count(ss_list_price) B5_CNT\n ,count(distinct ss_list_price) B5_CNTD\n from store_sales\n where ss_quantity between 21 and 25\n and (ss_list_price between 58 and 58+10\n or ss_coupon_amt between 9402 and 9402+1000\n or ss_wholesale_cost between 38 and 38+20)) B5,\n (select avg(ss_list_price) B6_LP\n ,count(ss_list_price) B6_CNT\n ,count(distinct ss_list_price) B6_CNTD\n from store_sales\n where ss_quantity between 26 and 30\n and (ss_list_price between 64 and 64+10\n or ss_coupon_amt between 5792 and 5792+1000\n or ss_wholesale_cost between 73 and 73+20)) B6\nlimit 100;\n\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8T6XUU0HSVoQti9zpIo/Bg==", "id": "test-project-364309:europe-west1.query28_1665768304", "jobReference": { "jobId": "query28_1665768304", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query28_1665768304?location=europe-west1", "statistics": { "creationTime": "1665768305407", "endTime": "1665768306145", "finalExecutionDurationMs": "502", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "154024832", "performanceInsights": { "avgPreviousExecutionMs": "533" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "69", "computeMsMax": "93", "computeRatioAvg": 0.7419354838709677, "computeRatioMax": 1, "endMs": "1665768305643", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "29", "readRatioAvg": 0.22580645161290322, "readRatioMax": 0.3118279569892473, "recordsRead": "2880404", "recordsWritten": "24650", "shuffleOutputBytes": "887304", "shuffleOutputBytesSpilled": "0", "slotMs": "543", "startMs": "1665768305559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$52:ss_list_price, $50:ss_quantity, $51:ss_wholesale_cost, $53:ss_coupon_amt", "FROM store_sales", "WHERE and(between($50, 6, 10), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $770, $831 := $730", "$690 := SHARD_AVG($731)", "$691 := COUNT($731)" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := if(equal($770, 1), $52, NULL)", "$731 := if(equal($770, 0), $52, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$760 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$690, $691, $831, $830", "TO __stage00_output", "BY HASH($830, $831)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.08602150537634409 }, { "completedParallelInputs": "6", "computeMsAvg": "72", "computeMsMax": "88", "computeRatioAvg": 0.7741935483870968, "computeRatioMax": 0.946236559139785, "endMs": "1665768305632", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "19", "readRatioAvg": 0.1827956989247312, "readRatioMax": 0.20430107526881722, "recordsRead": "2880404", "recordsWritten": "21915", "shuffleOutputBytes": "788844", "shuffleOutputBytesSpilled": "0", "slotMs": "459", "startMs": "1665768305562", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$42:ss_list_price, $40:ss_quantity, $41:ss_wholesale_cost, $43:ss_coupon_amt", "FROM store_sales", "WHERE and(between($40, 0, 5), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $750, $781 := $720", "$680 := SHARD_AVG($721)", "$681 := COUNT($721)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := if(equal($750, 1), $42, NULL)", "$721 := if(equal($750, 0), $42, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$740 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$680, $681, $781, $780", "TO __stage01_output", "BY HASH($780, $781)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.043010752688172046, "writeRatioMax": 0.053763440860215055 }, { "completedParallelInputs": "6", "computeMsAvg": "59", "computeMsMax": "78", "computeRatioAvg": 0.6344086021505376, "computeRatioMax": 0.8387096774193549, "endMs": "1665768305640", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "17", "readRatioAvg": 0.16129032258064516, "readRatioMax": 0.1827956989247312, "recordsRead": "2880404", "recordsWritten": "22409", "shuffleOutputBytes": "806628", "shuffleOutputBytesSpilled": "0", "slotMs": "412", "startMs": "1665768305574", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$32:ss_list_price, $30:ss_quantity, $31:ss_wholesale_cost, $33:ss_coupon_amt", "FROM store_sales", "WHERE and(between($30, 11, 15), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $710, $891 := $670", "$620 := SHARD_AVG($671)", "$621 := COUNT($671)" ] }, { "kind": "COMPUTE", "substeps": [ "$670 := if(equal($710, 1), $32, NULL)", "$671 := if(equal($710, 0), $32, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $891, $890", "TO __stage02_output", "BY HASH($890, $891)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.08602150537634409 }, { "completedParallelInputs": "6", "computeMsAvg": "70", "computeMsMax": "83", "computeRatioAvg": 0.7526881720430108, "computeRatioMax": 0.8924731182795699, "endMs": "1665768305668", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "24", "readRatioAvg": 0.16129032258064516, "readRatioMax": 0.25806451612903225, "recordsRead": "2880404", "recordsWritten": "23321", "shuffleOutputBytes": "839460", "shuffleOutputBytesSpilled": "0", "slotMs": "481", "startMs": "1665768305588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$22:ss_list_price, $20:ss_quantity, $21:ss_wholesale_cost, $23:ss_coupon_amt", "FROM store_sales", "WHERE and(between($20, 16, 20), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $950 := $640, $951 := $570", "$530 := SHARD_AVG($571)", "$531 := COUNT($571)" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := if(equal($640, 1), $22, NULL)", "$571 := if(equal($640, 0), $22, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $951, $950", "TO __stage03_output", "BY HASH($950, $951)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "6", "writeMsMax": "9", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.0967741935483871 }, { "completedParallelInputs": "6", "computeMsAvg": "72", "computeMsMax": "91", "computeRatioAvg": 0.7741935483870968, "computeRatioMax": 0.978494623655914, "endMs": "1665768305695", "id": "4", "name": "S04: Input", "parallelInputs": "6", "readMsAvg": "18", "readMsMax": "28", "readRatioAvg": 0.1935483870967742, "readRatioMax": 0.3010752688172043, "recordsRead": "2880404", "recordsWritten": "20177", "shuffleOutputBytes": "726276", "shuffleOutputBytesSpilled": "0", "slotMs": "572", "startMs": "1665768305604", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$12:ss_list_price, $10:ss_quantity, $11:ss_wholesale_cost, $13:ss_coupon_amt", "FROM store_sales", "WHERE and(between($10, 21, 25), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1010 := $550, $1011 := $460", "$400 := SHARD_AVG($461)", "$401 := COUNT($461)" ] }, { "kind": "COMPUTE", "substeps": [ "$460 := if(equal($550, 1), $12, NULL)", "$461 := if(equal($550, 0), $12, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$540 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $1011, $1010", "TO __stage04_output", "BY HASH($1010, $1011)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "7", "writeMsMax": "10", "writeRatioAvg": 0.07526881720430108, "writeRatioMax": 0.10752688172043011 }, { "completedParallelInputs": "6", "computeMsAvg": "68", "computeMsMax": "90", "computeRatioAvg": 0.7311827956989247, "computeRatioMax": 0.967741935483871, "endMs": "1665768305690", "id": "5", "name": "S05: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "17", "readRatioAvg": 0.16129032258064516, "readRatioMax": 0.1827956989247312, "recordsRead": "2880404", "recordsWritten": "26095", "shuffleOutputBytes": "939324", "shuffleOutputBytesSpilled": "0", "slotMs": "479", "startMs": "1665768305622", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$3:ss_list_price, $1:ss_quantity, $2:ss_wholesale_cost, $4:ss_coupon_amt", "FROM store_sales", "WHERE and(between($1, 26, 30), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $420, $1081 := $330", "$300 := SHARD_AVG($331)", "$301 := COUNT($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := if(equal($420, 1), $3, NULL)", "$331 := if(equal($420, 0), $3, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $1081, $1080", "TO __stage05_output", "BY HASH($1080, $1081)" ] } ], "waitMsAvg": "0", "waitMsMax": "1", "waitRatioAvg": 0, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.06451612903225806, "writeRatioMax": 0.07526881720430108 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.21505376344086022, "computeRatioMax": 0.21505376344086022, "endMs": "1665768305684", "id": "6", "inputStages": [ "1" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21915", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768305648", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$680, $681, $781, $780", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $800 := $790", "$580 := COUNT($602)", "$581 := ANY_VALUE($601)", "$582 := ANY_VALUE($600)" ] }, { "kind": "COMPUTE", "substeps": [ "$600 := if(equal($790, 0), $651, NULL)", "$601 := if(equal($790, 0), $650, NULL)", "$602 := if(equal($790, 1), $791, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $790 := $780, $791 := $781", "$650 := ROOT_AVG($680)", "$651 := SUM_OF_COUNTS($681)" ] }, { "kind": "WRITE", "substeps": [ "$580, $581, $582, $800", "TO __stage06_output", "BY HASH($800)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.03225806451612903, "waitRatioMax": 0.03225806451612903, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.07526881720430108, "writeRatioMax": 0.07526881720430108 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.3118279569892473, "computeRatioMax": 0.3118279569892473, "endMs": "1665768305690", "id": "7", "inputStages": [ "2" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22409", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665768305661", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $621, $891, $890", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$490 := COUNT($522)", "$491 := ANY_VALUE($521)", "$492 := ANY_VALUE($520)" ] }, { "kind": "COMPUTE", "substeps": [ "$520 := if(equal($900, 0), $561, NULL)", "$521 := if(equal($900, 0), $560, NULL)", "$522 := if(equal($900, 1), $901, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891", "$560 := ROOT_AVG($620)", "$561 := SUM_OF_COUNTS($621)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $910", "TO __stage07_output", "BY HASH($910)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.08602150537634409, "writeRatioMax": 0.08602150537634409 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.16129032258064516, "computeRatioMax": 0.16129032258064516, "endMs": "1665768305708", "id": "8", "inputStages": [ "0" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24650", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768305674", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $691, $831, $830", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $850 := $840", "$590 := COUNT($612)", "$591 := ANY_VALUE($611)", "$592 := ANY_VALUE($610)" ] }, { "kind": "COMPUTE", "substeps": [ "$610 := if(equal($840, 0), $661, NULL)", "$611 := if(equal($840, 0), $660, NULL)", "$612 := if(equal($840, 1), $841, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830, $841 := $831", "$660 := ROOT_AVG($690)", "$661 := SUM_OF_COUNTS($691)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $850", "TO __stage08_output", "BY HASH($850)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.0967741935483871, "writeRatioMax": 0.0967741935483871 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.3225806451612903, "computeRatioMax": 0.3225806451612903, "endMs": "1665768305724", "id": "9", "inputStages": [ "3" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "23321", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768305688", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $951, $950", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960", "$370 := COUNT($392)", "$371 := ANY_VALUE($391)", "$372 := ANY_VALUE($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$390 := if(equal($960, 0), $451, NULL)", "$391 := if(equal($960, 0), $450, NULL)", "$392 := if(equal($960, 1), $961, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $950, $961 := $951", "$450 := ROOT_AVG($530)", "$451 := SUM_OF_COUNTS($531)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $970", "TO __stage09_output", "BY HASH($970)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.053763440860215055, "writeRatioMax": 0.053763440860215055 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.1827956989247312, "computeRatioMax": 0.1827956989247312, "endMs": "1665768305735", "id": "10", "inputStages": [ "6" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "73", "startMs": "1665768305695", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $581, $582, $800", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$430 := ANY_VALUE($472)", "$431 := ANY_VALUE($471)", "$432 := ANY_VALUE($470)" ] }, { "kind": "COMPUTE", "substeps": [ "$470 := if(equal($810, 0), $502, NULL)", "$471 := if(equal($810, 0), $501, NULL)", "$472 := if(equal($810, 1), $500, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800", "$500 := SUM_OF_COUNTS($580)", "$501 := ANY_VALUE($581)", "$502 := ANY_VALUE($582)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432", "TO __stage0A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.1827956989247312, "writeRatioMax": 0.1827956989247312 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.16129032258064516, "computeRatioMax": 0.16129032258064516, "endMs": "1665768305758", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665768305696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$430, $431, $432", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := if(is_null($342), 0, $342)", "$261 := if(is_null($340), 0, $340)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$340 := ANY_VALUE($430)", "$341 := ANY_VALUE($431)", "$342 := ANY_VALUE($432)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $341", "TO __stage0B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.20430107526881722, "computeRatioMax": 0.20430107526881722, "endMs": "1665768305751", "id": "12", "inputStages": [ "5" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26095", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768305716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $1081, $1080", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$170 := COUNT($202)", "$171 := ANY_VALUE($201)", "$172 := ANY_VALUE($200)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal($1090, 0), $221, NULL)", "$201 := if(equal($1090, 0), $220, NULL)", "$202 := if(equal($1090, 1), $1091, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080, $1091 := $1081", "$220 := ROOT_AVG($300)", "$221 := SUM_OF_COUNTS($301)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $1100", "TO __stage0C_output", "BY HASH($1100)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.07526881720430108, "writeRatioMax": 0.07526881720430108 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.17204301075268819, "computeRatioMax": 0.17204301075268819, "endMs": "1665768305761", "id": "13", "inputStages": [ "7" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665768305718", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $910", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$310 := ANY_VALUE($362)", "$311 := ANY_VALUE($361)", "$312 := ANY_VALUE($360)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := if(equal($920, 0), $382, NULL)", "$361 := if(equal($920, 0), $381, NULL)", "$362 := if(equal($920, 1), $380, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $910", "$380 := SUM_OF_COUNTS($490)", "$381 := ANY_VALUE($491)", "$382 := ANY_VALUE($492)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.021505376344086023, "waitRatioMax": 0.021505376344086023, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.1827956989247312, "writeRatioMax": 0.1827956989247312 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.10752688172043011, "computeRatioMax": 0.10752688172043011, "endMs": "1665768305768", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665768305718", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(is_null($232), 0, $232)", "$181 := if(is_null($230), 0, $230)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_VALUE($310)", "$231 := ANY_VALUE($311)", "$232 := ANY_VALUE($312)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $231", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.021505376344086023, "waitRatioMax": 0.021505376344086023, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.021505376344086023, "writeRatioMax": 0.021505376344086023 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.1935483870967742, "computeRatioMax": 0.1935483870967742, "endMs": "1665768305762", "id": "15", "inputStages": [ "4" ], "name": "S0F: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20177", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665768305728", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $1011, $1010", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1020", "$250 := COUNT($292)", "$251 := ANY_VALUE($291)", "$252 := ANY_VALUE($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := if(equal($1020, 0), $321, NULL)", "$291 := if(equal($1020, 0), $320, NULL)", "$292 := if(equal($1020, 1), $1021, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1020 := $1010, $1021 := $1011", "$320 := ROOT_AVG($400)", "$321 := SUM_OF_COUNTS($401)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $1030", "TO __stage0F_output", "BY HASH($1030)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.17204301075268819, "writeRatioMax": 0.17204301075268819 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.08602150537634409, "computeRatioMax": 0.08602150537634409, "endMs": "1665768305768", "id": "16", "inputStages": [ "8" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768305730", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $850", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$440 := ANY_VALUE($482)", "$441 := ANY_VALUE($481)", "$442 := ANY_VALUE($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := if(equal($860, 0), $512, NULL)", "$481 := if(equal($860, 0), $511, NULL)", "$482 := if(equal($860, 1), $510, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $860 := $850", "$510 := SUM_OF_COUNTS($590)", "$511 := ANY_VALUE($591)", "$512 := ANY_VALUE($592)" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.021505376344086023, "waitRatioMax": 0.021505376344086023, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.1827956989247312, "writeRatioMax": 0.1827956989247312 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.053763440860215055, "computeRatioMax": 0.053763440860215055, "endMs": "1665768305780", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768305731", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := if(is_null($352), 0, $352)", "$271 := if(is_null($350), 0, $350)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$350 := ANY_VALUE($440)", "$351 := ANY_VALUE($441)", "$352 := ANY_VALUE($442)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $351", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.021505376344086023, "writeRatioMax": 0.021505376344086023 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.1827956989247312, "computeRatioMax": 0.1827956989247312, "endMs": "1665768305777", "id": "18", "inputStages": [ "9" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "75", "startMs": "1665768305736", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370, $371, $372, $970", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$210 := ANY_VALUE($242)", "$211 := ANY_VALUE($241)", "$212 := ANY_VALUE($240)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := if(equal($980, 0), $282, NULL)", "$241 := if(equal($980, 0), $281, NULL)", "$242 := if(equal($980, 1), $280, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$280 := SUM_OF_COUNTS($370)", "$281 := ANY_VALUE($371)", "$282 := ANY_VALUE($372)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212", "TO __stage12_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.15053763440860216, "writeRatioMax": 0.15053763440860216 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.11827956989247312, "computeRatioMax": 0.11827956989247312, "endMs": "1665768305792", "id": "19", "inputStages": [ "18" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "51", "startMs": "1665768305737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212", "FROM __stage12_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(is_null($152), 0, $152)", "$121 := if(is_null($150), 0, $150)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := ANY_VALUE($210)", "$151 := ANY_VALUE($211)", "$152 := ANY_VALUE($212)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $151", "TO __stage13_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.021505376344086023, "writeRatioMax": 0.021505376344086023 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0967741935483871, "computeRatioMax": 0.0967741935483871, "endMs": "1665768305806", "id": "20", "inputStages": [ "12" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665768305768", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $1100", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($112)", "$91 := ANY_VALUE($111)", "$92 := ANY_VALUE($110)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := if(equal($1110, 0), $132, NULL)", "$111 := if(equal($1110, 0), $131, NULL)", "$112 := if(equal($1110, 1), $130, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $1100", "$130 := SUM_OF_COUNTS($170)", "$131 := ANY_VALUE($171)", "$132 := ANY_VALUE($172)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.17204301075268819, "writeRatioMax": 0.17204301075268819 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.10752688172043011, "computeRatioMax": 0.10752688172043011, "endMs": "1665768305826", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665768305769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage14_output" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($72), 0, $72)", "$61 := if(is_null($70), 0, $70)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($90)", "$71 := ANY_VALUE($91)", "$72 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $71", "TO __stage15_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.03225806451612903, "writeRatioMax": 0.03225806451612903 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.06451612903225806, "computeRatioMax": 0.06451612903225806, "endMs": "1665768305804", "id": "22", "inputStages": [ "15" ], "name": "S16: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665768305769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $1030", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := ANY_VALUE($162)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($160)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($1040, 0), $192, NULL)", "$161 := if(equal($1040, 0), $191, NULL)", "$162 := if(equal($1040, 1), $190, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030", "$190 := SUM_OF_COUNTS($250)", "$191 := ANY_VALUE($251)", "$192 := ANY_VALUE($252)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142", "TO __stage16_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.16129032258064516, "writeRatioMax": 0.16129032258064516 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.07526881720430108, "computeRatioMax": 0.07526881720430108, "endMs": "1665768305818", "id": "23", "inputStages": [ "22" ], "name": "S17: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768305771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142", "FROM __stage16_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := if(is_null($102), 0, $102)", "$81 := if(is_null($100), 0, $100)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_VALUE($140)", "$101 := ANY_VALUE($141)", "$102 := ANY_VALUE($142)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $101", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.021505376344086023, "writeRatioMax": 0.021505376344086023 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0967741935483871, "computeRatioMax": 0.0967741935483871, "endMs": "1665768305825", "id": "24", "inputStages": [ "17", "11" ], "name": "S18: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "70", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665768305792", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $341", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $351", "FROM __stage11_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$870 := $260, $871 := $261, $872 := $341, $873 := $270, $874 := $271, $875 := $351", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$870, $871, $873, $874, $872, $875", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.12903225806451613, "writeRatioMax": 0.12903225806451613 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.11827956989247312, "computeRatioMax": 0.11827956989247312, "endMs": "1665768305878", "id": "25", "inputStages": [ "24", "14" ], "name": "S19: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665768305840", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$870, $871, $873, $874, $872, $875", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $231", "FROM __stage0E_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$930 := $870, $931 := $871, $932 := $873, $933 := $874, $934 := $872, $935 := $875, $936 := $180, $937 := $181, $938 := $231", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.12903225806451613, "writeRatioMax": 0.12903225806451613 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.0967741935483871, "computeRatioMax": 0.0967741935483871, "endMs": "1665768305922", "id": "26", "inputStages": [ "25", "19" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "140", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665768305888", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$120, $121, $151", "FROM __stage13_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$990 := $936, $991 := $937, $992 := $938, $993 := $930, $994 := $931, $995 := $932, $996 := $933, $997 := $934, $998 := $935, $999 := $120, $1000 := $121, $1001 := $151", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.12903225806451613, "writeRatioMax": 0.12903225806451613 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.12903225806451613, "computeRatioMax": 0.12903225806451613, "endMs": "1665768305974", "id": "27", "inputStages": [ "23", "26" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "175", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665768305935", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $101", "FROM __stage17_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $999, $1051 := $1000, $1052 := $1001, $1053 := $990, $1054 := $991, $1055 := $992, $1056 := $993, $1057 := $994, $1058 := $995, $1059 := $996, $1060 := $997, $1061 := $998, $1062 := $80, $1063 := $81, $1064 := $101", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.13978494623655913, "writeRatioMax": 0.13978494623655913 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.16129032258064516, "computeRatioMax": 0.16129032258064516, "endMs": "1665768306035", "id": "28", "inputStages": [ "27", "21" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "195", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665768305997", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $71", "FROM __stage15_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1062, $1121 := $1063, $1122 := $1064, $1123 := $1050, $1124 := $1051, $1125 := $1052, $1126 := $1053, $1127 := $1054, $1128 := $1055, $1129 := $1056, $1130 := $1057, $1131 := $1058, $1132 := $1059, $1133 := $1060, $1134 := $1061, $1135 := $60", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1135, $1136, $1137, $1120, $1121, $1122, $1123, $1124, $1125, $1126, $1127, $1128, $1129, $1130, $1131, $1132", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010752688172043012, "waitRatioMax": 0.010752688172043012, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.11827956989247312, "writeRatioMax": 0.11827956989247312 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "59", "elapsedMs": "629", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3992" } ], "totalBytesBilled": "154140672", "totalBytesProcessed": "154024832", "totalPartitionsProcessed": "0", "totalSlotMs": "3992", "transferredBytes": "0" }, "startTime": "1665768305457", "totalBytesProcessed": "154024832", "totalSlotMs": "3992" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon21f42640_5e62_4c63_8403_9ac39e876eef" }, "priority": "INTERACTIVE", "query": "select *\nfrom (select avg(ss_list_price) B1_LP\n ,count(ss_list_price) B1_CNT\n ,count(distinct ss_list_price) B1_CNTD\n from store_sales\n where ss_quantity between 0 and 5\n and (ss_list_price between 107 and 107+10 \n or ss_coupon_amt between 1319 and 1319+1000\n or ss_wholesale_cost between 60 and 60+20)) B1,\n (select avg(ss_list_price) B2_LP\n ,count(ss_list_price) B2_CNT\n ,count(distinct ss_list_price) B2_CNTD\n from store_sales\n where ss_quantity between 6 and 10\n and (ss_list_price between 23 and 23+10\n or ss_coupon_amt between 825 and 825+1000\n or ss_wholesale_cost between 43 and 43+20)) B2,\n (select avg(ss_list_price) B3_LP\n ,count(ss_list_price) B3_CNT\n ,count(distinct ss_list_price) B3_CNTD\n from store_sales\n where ss_quantity between 11 and 15\n and (ss_list_price between 74 and 74+10\n or ss_coupon_amt between 4381 and 4381+1000\n or ss_wholesale_cost between 57 and 57+20)) B3,\n (select avg(ss_list_price) B4_LP\n ,count(ss_list_price) B4_CNT\n ,count(distinct ss_list_price) B4_CNTD\n from store_sales\n where ss_quantity between 16 and 20\n and (ss_list_price between 89 and 89+10\n or ss_coupon_amt between 3117 and 3117+1000\n or ss_wholesale_cost between 68 and 68+20)) B4,\n (select avg(ss_list_price) B5_LP\n ,count(ss_list_price) B5_CNT\n ,count(distinct ss_list_price) B5_CNTD\n from store_sales\n where ss_quantity between 21 and 25\n and (ss_list_price between 58 and 58+10\n or ss_coupon_amt between 9402 and 9402+1000\n or ss_wholesale_cost between 38 and 38+20)) B5,\n (select avg(ss_list_price) B6_LP\n ,count(ss_list_price) B6_CNT\n ,count(distinct ss_list_price) B6_CNTD\n from store_sales\n where ss_quantity between 26 and 30\n and (ss_list_price between 64 and 64+10\n or ss_coupon_amt between 5792 and 5792+1000\n or ss_wholesale_cost between 73 and 73+20)) B6\nlimit 100;\n\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "+z9W/XHq/iv+EIrHYxSWsw==", "id": "test-project-364309:europe-west1.query28_1665777215", "jobReference": { "jobId": "query28_1665777215", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query28_1665777215?location=europe-west1", "statistics": { "creationTime": "1665777216408", "endTime": "1665777217211", "finalExecutionDurationMs": "553", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "154024832", "performanceInsights": { "avgPreviousExecutionMs": "528" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "70", "computeMsMax": "80", "computeRatioAvg": 0.7446808510638298, "computeRatioMax": 0.851063829787234, "endMs": "1665777216649", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "31", "readRatioAvg": 0.2127659574468085, "readRatioMax": 0.32978723404255317, "recordsRead": "2880404", "recordsWritten": "24650", "shuffleOutputBytes": "887304", "shuffleOutputBytesSpilled": "0", "slotMs": "452", "startMs": "1665777216558", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$52:ss_list_price, $50:ss_quantity, $51:ss_wholesale_cost, $53:ss_coupon_amt", "FROM store_sales", "WHERE and(between($50, 6, 10), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $770, $831 := $730", "$690 := SHARD_AVG($731)", "$691 := COUNT($731)" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := if(equal($770, 1), $52, NULL)", "$731 := if(equal($770, 0), $52, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$760 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$690, $691, $831, $830", "TO __stage00_output", "BY HASH($830, $831)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "5", "writeMsMax": "8", "writeRatioAvg": 0.05319148936170213, "writeRatioMax": 0.0851063829787234 }, { "completedParallelInputs": "6", "computeMsAvg": "60", "computeMsMax": "75", "computeRatioAvg": 0.6382978723404256, "computeRatioMax": 0.7978723404255319, "endMs": "1665777216624", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "16", "readRatioAvg": 0.14893617021276595, "readRatioMax": 0.1702127659574468, "recordsRead": "2880404", "recordsWritten": "21915", "shuffleOutputBytes": "788844", "shuffleOutputBytesSpilled": "0", "slotMs": "376", "startMs": "1665777216563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$42:ss_list_price, $40:ss_quantity, $41:ss_wholesale_cost, $43:ss_coupon_amt", "FROM store_sales", "WHERE and(between($40, 0, 5), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $750, $781 := $720", "$680 := SHARD_AVG($721)", "$681 := COUNT($721)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := if(equal($750, 1), $42, NULL)", "$721 := if(equal($750, 0), $42, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$740 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$680, $681, $781, $780", "TO __stage01_output", "BY HASH($780, $781)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "5", "writeMsMax": "11", "writeRatioAvg": 0.05319148936170213, "writeRatioMax": 0.11702127659574468 }, { "completedParallelInputs": "6", "computeMsAvg": "57", "computeMsMax": "70", "computeRatioAvg": 0.6063829787234043, "computeRatioMax": 0.7446808510638298, "endMs": "1665777216640", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.1702127659574468, "readRatioMax": 0.20212765957446807, "recordsRead": "2880404", "recordsWritten": "22409", "shuffleOutputBytes": "806628", "shuffleOutputBytesSpilled": "0", "slotMs": "364", "startMs": "1665777216580", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$32:ss_list_price, $30:ss_quantity, $31:ss_wholesale_cost, $33:ss_coupon_amt", "FROM store_sales", "WHERE and(between($30, 11, 15), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $710, $891 := $670", "$620 := SHARD_AVG($671)", "$621 := COUNT($671)" ] }, { "kind": "COMPUTE", "substeps": [ "$670 := if(equal($710, 1), $32, NULL)", "$671 := if(equal($710, 0), $32, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $891, $890", "TO __stage02_output", "BY HASH($890, $891)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.07446808510638298, "writeRatioMax": 0.0851063829787234 }, { "completedParallelInputs": "6", "computeMsAvg": "66", "computeMsMax": "90", "computeRatioAvg": 0.7021276595744681, "computeRatioMax": 0.9574468085106383, "endMs": "1665777216662", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.14893617021276595, "readRatioMax": 0.18085106382978725, "recordsRead": "2880404", "recordsWritten": "23321", "shuffleOutputBytes": "839460", "shuffleOutputBytesSpilled": "0", "slotMs": "398", "startMs": "1665777216598", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$22:ss_list_price, $20:ss_quantity, $21:ss_wholesale_cost, $23:ss_coupon_amt", "FROM store_sales", "WHERE and(between($20, 16, 20), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $950 := $640, $951 := $570", "$530 := SHARD_AVG($571)", "$531 := COUNT($571)" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := if(equal($640, 1), $22, NULL)", "$571 := if(equal($640, 0), $22, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $951, $950", "TO __stage03_output", "BY HASH($950, $951)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.05319148936170213, "writeRatioMax": 0.06382978723404255 }, { "completedParallelInputs": "6", "computeMsAvg": "73", "computeMsMax": "91", "computeRatioAvg": 0.776595744680851, "computeRatioMax": 0.9680851063829787, "endMs": "1665777216691", "id": "4", "name": "S04: Input", "parallelInputs": "6", "readMsAvg": "13", "readMsMax": "16", "readRatioAvg": 0.13829787234042554, "readRatioMax": 0.1702127659574468, "recordsRead": "2880404", "recordsWritten": "20177", "shuffleOutputBytes": "726276", "shuffleOutputBytesSpilled": "0", "slotMs": "457", "startMs": "1665777216617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$12:ss_list_price, $10:ss_quantity, $11:ss_wholesale_cost, $13:ss_coupon_amt", "FROM store_sales", "WHERE and(between($10, 21, 25), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1010 := $550, $1011 := $460", "$400 := SHARD_AVG($461)", "$401 := COUNT($461)" ] }, { "kind": "COMPUTE", "substeps": [ "$460 := if(equal($550, 1), $12, NULL)", "$461 := if(equal($550, 0), $12, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$540 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $1011, $1010", "TO __stage04_output", "BY HASH($1010, $1011)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.06382978723404255, "writeRatioMax": 0.06382978723404255 }, { "completedParallelInputs": "6", "computeMsAvg": "77", "computeMsMax": "94", "computeRatioAvg": 0.8191489361702128, "computeRatioMax": 1, "endMs": "1665777216706", "id": "5", "name": "S05: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "19", "readRatioAvg": 0.1595744680851064, "readRatioMax": 0.20212765957446807, "recordsRead": "2880404", "recordsWritten": "26095", "shuffleOutputBytes": "939324", "shuffleOutputBytesSpilled": "0", "slotMs": "509", "startMs": "1665777216633", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$3:ss_list_price, $1:ss_quantity, $2:ss_wholesale_cost, $4:ss_coupon_amt", "FROM store_sales", "WHERE and(between($1, 26, 30), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $420, $1081 := $330", "$300 := SHARD_AVG($331)", "$301 := COUNT($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := if(equal($420, 1), $3, NULL)", "$331 := if(equal($420, 0), $3, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $1081, $1080", "TO __stage05_output", "BY HASH($1080, $1081)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02127659574468085, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "6", "writeMsMax": "7", "writeRatioAvg": 0.06382978723404255, "writeRatioMax": 0.07446808510638298 }, { "completedParallelInputs": "1", "computeMsAvg": "36", "computeMsMax": "36", "computeRatioAvg": 0.3829787234042553, "computeRatioMax": 0.3829787234042553, "endMs": "1665777216714", "id": "6", "inputStages": [ "1" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21915", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665777216646", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$680, $681, $781, $780", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $800 := $790", "$580 := COUNT($602)", "$581 := ANY_VALUE($601)", "$582 := ANY_VALUE($600)" ] }, { "kind": "COMPUTE", "substeps": [ "$600 := if(equal($790, 0), $651, NULL)", "$601 := if(equal($790, 0), $650, NULL)", "$602 := if(equal($790, 1), $791, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $790 := $780, $791 := $781", "$650 := ROOT_AVG($680)", "$651 := SUM_OF_COUNTS($681)" ] }, { "kind": "WRITE", "substeps": [ "$580, $581, $582, $800", "TO __stage06_output", "BY HASH($800)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02127659574468085, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "42", "writeMsMax": "42", "writeRatioAvg": 0.44680851063829785, "writeRatioMax": 0.44680851063829785 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.1702127659574468, "computeRatioMax": 0.1702127659574468, "endMs": "1665777216724", "id": "7", "inputStages": [ "2" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22409", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777216675", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $621, $891, $890", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$490 := COUNT($522)", "$491 := ANY_VALUE($521)", "$492 := ANY_VALUE($520)" ] }, { "kind": "COMPUTE", "substeps": [ "$520 := if(equal($900, 0), $561, NULL)", "$521 := if(equal($900, 0), $560, NULL)", "$522 := if(equal($900, 1), $901, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891", "$560 := ROOT_AVG($620)", "$561 := SUM_OF_COUNTS($621)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $910", "TO __stage07_output", "BY HASH($910)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.23404255319148937, "writeRatioMax": 0.23404255319148937 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.2978723404255319, "computeRatioMax": 0.2978723404255319, "endMs": "1665777216748", "id": "8", "inputStages": [ "0" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24650", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665777216699", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $691, $831, $830", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $850 := $840", "$590 := COUNT($612)", "$591 := ANY_VALUE($611)", "$592 := ANY_VALUE($610)" ] }, { "kind": "COMPUTE", "substeps": [ "$610 := if(equal($840, 0), $661, NULL)", "$611 := if(equal($840, 0), $660, NULL)", "$612 := if(equal($840, 1), $841, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830, $841 := $831", "$660 := ROOT_AVG($690)", "$661 := SUM_OF_COUNTS($691)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $850", "TO __stage08_output", "BY HASH($850)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02127659574468085, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.2127659574468085, "writeRatioMax": 0.2127659574468085 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.2127659574468085, "computeRatioMax": 0.2127659574468085, "endMs": "1665777216759", "id": "9", "inputStages": [ "3" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "23321", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777216724", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $951, $950", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960", "$370 := COUNT($392)", "$371 := ANY_VALUE($391)", "$372 := ANY_VALUE($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$390 := if(equal($960, 0), $451, NULL)", "$391 := if(equal($960, 0), $450, NULL)", "$392 := if(equal($960, 1), $961, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $950, $961 := $951", "$450 := ROOT_AVG($530)", "$451 := SUM_OF_COUNTS($531)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $970", "TO __stage09_output", "BY HASH($970)" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.031914893617021274, "waitRatioMax": 0.031914893617021274, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.07446808510638298, "writeRatioMax": 0.07446808510638298 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.26595744680851063, "computeRatioMax": 0.26595744680851063, "endMs": "1665777216778", "id": "10", "inputStages": [ "4" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20177", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777216741", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $1011, $1010", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1020", "$250 := COUNT($292)", "$251 := ANY_VALUE($291)", "$252 := ANY_VALUE($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := if(equal($1020, 0), $321, NULL)", "$291 := if(equal($1020, 0), $320, NULL)", "$292 := if(equal($1020, 1), $1021, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1020 := $1010, $1021 := $1011", "$320 := ROOT_AVG($400)", "$321 := SUM_OF_COUNTS($401)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $1030", "TO __stage0A_output", "BY HASH($1030)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.07446808510638298, "writeRatioMax": 0.07446808510638298 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.2765957446808511, "computeRatioMax": 0.2765957446808511, "endMs": "1665777216794", "id": "11", "inputStages": [ "5" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26095", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777216755", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $1081, $1080", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$170 := COUNT($202)", "$171 := ANY_VALUE($201)", "$172 := ANY_VALUE($200)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal($1090, 0), $221, NULL)", "$201 := if(equal($1090, 0), $220, NULL)", "$202 := if(equal($1090, 1), $1091, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080, $1091 := $1081", "$220 := ROOT_AVG($300)", "$221 := SUM_OF_COUNTS($301)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $1100", "TO __stage0B_output", "BY HASH($1100)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.07446808510638298, "writeRatioMax": 0.07446808510638298 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.05319148936170213, "computeRatioMax": 0.05319148936170213, "endMs": "1665777216793", "id": "12", "inputStages": [ "6" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777216756", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $581, $582, $800", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$430 := ANY_VALUE($472)", "$431 := ANY_VALUE($471)", "$432 := ANY_VALUE($470)" ] }, { "kind": "COMPUTE", "substeps": [ "$470 := if(equal($810, 0), $502, NULL)", "$471 := if(equal($810, 0), $501, NULL)", "$472 := if(equal($810, 1), $500, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800", "$500 := SUM_OF_COUNTS($580)", "$501 := ANY_VALUE($581)", "$502 := ANY_VALUE($582)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02127659574468085, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1595744680851064, "writeRatioMax": 0.1595744680851064 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.06382978723404255, "computeRatioMax": 0.06382978723404255, "endMs": "1665777216811", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777216756", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$430, $431, $432", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := if(is_null($342), 0, $342)", "$261 := if(is_null($340), 0, $340)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$340 := ANY_VALUE($430)", "$341 := ANY_VALUE($431)", "$342 := ANY_VALUE($432)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $341", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02127659574468085, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.02127659574468085, "writeRatioMax": 0.02127659574468085 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.10638297872340426, "computeRatioMax": 0.10638297872340426, "endMs": "1665777216798", "id": "14", "inputStages": [ "7" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777216757", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $910", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$310 := ANY_VALUE($362)", "$311 := ANY_VALUE($361)", "$312 := ANY_VALUE($360)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := if(equal($920, 0), $382, NULL)", "$361 := if(equal($920, 0), $381, NULL)", "$362 := if(equal($920, 1), $380, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $910", "$380 := SUM_OF_COUNTS($490)", "$381 := ANY_VALUE($491)", "$382 := ANY_VALUE($492)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1702127659574468, "writeRatioMax": 0.1702127659574468 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0851063829787234, "computeRatioMax": 0.0851063829787234, "endMs": "1665777216812", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777216757", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312", "FROM __stage0E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(is_null($232), 0, $232)", "$181 := if(is_null($230), 0, $230)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_VALUE($310)", "$231 := ANY_VALUE($311)", "$232 := ANY_VALUE($312)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $231", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.031914893617021274, "writeRatioMax": 0.031914893617021274 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09574468085106383, "computeRatioMax": 0.09574468085106383, "endMs": "1665777216797", "id": "16", "inputStages": [ "8" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777216760", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $850", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$440 := ANY_VALUE($482)", "$441 := ANY_VALUE($481)", "$442 := ANY_VALUE($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := if(equal($860, 0), $512, NULL)", "$481 := if(equal($860, 0), $511, NULL)", "$482 := if(equal($860, 1), $510, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $860 := $850", "$510 := SUM_OF_COUNTS($590)", "$511 := ANY_VALUE($591)", "$512 := ANY_VALUE($592)" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.1595744680851064, "writeRatioMax": 0.1595744680851064 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.05319148936170213, "computeRatioMax": 0.05319148936170213, "endMs": "1665777216816", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777216763", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := if(is_null($352), 0, $352)", "$271 := if(is_null($350), 0, $350)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$350 := ANY_VALUE($440)", "$351 := ANY_VALUE($441)", "$352 := ANY_VALUE($442)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $351", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.031914893617021274, "waitRatioMax": 0.031914893617021274, "writeMsAvg": "1", "writeMsMax": "1", "writeRatioAvg": 0.010638297872340425, "writeRatioMax": 0.010638297872340425 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.11702127659574468, "computeRatioMax": 0.11702127659574468, "endMs": "1665777216816", "id": "18", "inputStages": [ "9" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777216775", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370, $371, $372, $970", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$210 := ANY_VALUE($242)", "$211 := ANY_VALUE($241)", "$212 := ANY_VALUE($240)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := if(equal($980, 0), $282, NULL)", "$241 := if(equal($980, 0), $281, NULL)", "$242 := if(equal($980, 1), $280, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$280 := SUM_OF_COUNTS($370)", "$281 := ANY_VALUE($371)", "$282 := ANY_VALUE($372)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1702127659574468, "writeRatioMax": 0.1702127659574468 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.07446808510638298, "computeRatioMax": 0.07446808510638298, "endMs": "1665777216819", "id": "19", "inputStages": [ "18" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777216778", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212", "FROM __stage12_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(is_null($152), 0, $152)", "$121 := if(is_null($150), 0, $150)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := ANY_VALUE($210)", "$151 := ANY_VALUE($211)", "$152 := ANY_VALUE($212)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $151", "TO __stage13_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.031914893617021274, "waitRatioMax": 0.031914893617021274, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.031914893617021274, "writeRatioMax": 0.031914893617021274 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.07446808510638298, "computeRatioMax": 0.07446808510638298, "endMs": "1665777216829", "id": "20", "inputStages": [ "10" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777216791", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $1030", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := ANY_VALUE($162)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($160)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($1040, 0), $192, NULL)", "$161 := if(equal($1040, 0), $191, NULL)", "$162 := if(equal($1040, 1), $190, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030", "$190 := SUM_OF_COUNTS($250)", "$191 := ANY_VALUE($251)", "$192 := ANY_VALUE($252)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "29", "writeMsMax": "29", "writeRatioAvg": 0.30851063829787234, "writeRatioMax": 0.30851063829787234 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.05319148936170213, "computeRatioMax": 0.05319148936170213, "endMs": "1665777216837", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777216794", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142", "FROM __stage14_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := if(is_null($102), 0, $102)", "$81 := if(is_null($100), 0, $100)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_VALUE($140)", "$101 := ANY_VALUE($141)", "$102 := ANY_VALUE($142)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $101", "TO __stage15_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.031914893617021274, "waitRatioMax": 0.031914893617021274, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.031914893617021274, "writeRatioMax": 0.031914893617021274 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0851063829787234, "computeRatioMax": 0.0851063829787234, "endMs": "1665777216844", "id": "22", "inputStages": [ "11" ], "name": "S16: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777216807", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $1100", "FROM __stage0B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($112)", "$91 := ANY_VALUE($111)", "$92 := ANY_VALUE($110)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := if(equal($1110, 0), $132, NULL)", "$111 := if(equal($1110, 0), $131, NULL)", "$112 := if(equal($1110, 1), $130, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $1100", "$130 := SUM_OF_COUNTS($170)", "$131 := ANY_VALUE($171)", "$132 := ANY_VALUE($172)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage16_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02127659574468085, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.14893617021276595, "writeRatioMax": 0.14893617021276595 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.05319148936170213, "computeRatioMax": 0.05319148936170213, "endMs": "1665777216849", "id": "23", "inputStages": [ "22" ], "name": "S17: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665777216810", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage16_output" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($72), 0, $72)", "$61 := if(is_null($70), 0, $70)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($90)", "$71 := ANY_VALUE($91)", "$72 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $71", "TO __stage17_output" ] } ], "waitMsAvg": "4", "waitMsMax": "4", "waitRatioAvg": 0.0425531914893617, "waitRatioMax": 0.0425531914893617, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.02127659574468085, "writeRatioMax": 0.02127659574468085 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.07446808510638298, "computeRatioMax": 0.07446808510638298, "endMs": "1665777216867", "id": "24", "inputStages": [ "17", "13" ], "name": "S18: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "70", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777216828", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $341", "FROM __stage0D_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $351", "FROM __stage11_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$870 := $260, $871 := $261, $872 := $341, $873 := $270, $874 := $271, $875 := $351", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$870, $871, $873, $874, $872, $875", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02127659574468085, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.13829787234042554, "writeRatioMax": 0.13829787234042554 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.07446808510638298, "computeRatioMax": 0.07446808510638298, "endMs": "1665777216919", "id": "25", "inputStages": [ "15", "24" ], "name": "S19: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777216877", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$870, $871, $873, $874, $872, $875", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $231", "FROM __stage0F_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$930 := $870, $931 := $871, $932 := $873, $933 := $874, $934 := $872, $935 := $875, $936 := $180, $937 := $181, $938 := $231", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.14893617021276595, "writeRatioMax": 0.14893617021276595 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.0851063829787234, "computeRatioMax": 0.0851063829787234, "endMs": "1665777216965", "id": "26", "inputStages": [ "19", "25" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "140", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777216929", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$120, $121, $151", "FROM __stage13_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$990 := $936, $991 := $937, $992 := $938, $993 := $930, $994 := $931, $995 := $932, $996 := $933, $997 := $934, $998 := $935, $999 := $120, $1000 := $121, $1001 := $151", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010638297872340425, "waitRatioMax": 0.010638297872340425, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.1276595744680851, "writeRatioMax": 0.1276595744680851 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.1276595744680851, "computeRatioMax": 0.1276595744680851, "endMs": "1665777217012", "id": "27", "inputStages": [ "26", "21" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "175", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777216980", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $101", "FROM __stage15_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $999, $1051 := $1000, $1052 := $1001, $1053 := $990, $1054 := $991, $1055 := $992, $1056 := $993, $1057 := $994, $1058 := $995, $1059 := $996, $1060 := $997, $1061 := $998, $1062 := $80, $1063 := $81, $1064 := $101", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "TO __stage1B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02127659574468085, "waitRatioMax": 0.02127659574468085, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.13829787234042554, "writeRatioMax": 0.13829787234042554 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.11702127659574468, "computeRatioMax": 0.11702127659574468, "endMs": "1665777217073", "id": "28", "inputStages": [ "27", "23" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "195", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777217034", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $71", "FROM __stage17_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1062, $1121 := $1063, $1122 := $1064, $1123 := $1050, $1124 := $1051, $1125 := $1052, $1126 := $1053, $1127 := $1054, $1128 := $1055, $1129 := $1056, $1130 := $1057, $1131 := $1058, $1132 := $1059, $1133 := $1060, $1134 := $1061, $1135 := $60", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1135, $1136, $1137, $1120, $1121, $1122, $1123, $1124, $1125, $1126, $1127, $1128, $1129, $1130, $1131, $1132", "TO __stage1C_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.031914893617021274, "waitRatioMax": 0.031914893617021274, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.14893617021276595, "writeRatioMax": 0.14893617021276595 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "58", "elapsedMs": "603", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3419" }, { "activeUnits": "1", "completedUnits": "59", "elapsedMs": "691", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3450" } ], "totalBytesBilled": "154140672", "totalBytesProcessed": "154024832", "totalPartitionsProcessed": "0", "totalSlotMs": "3450", "transferredBytes": "0" }, "startTime": "1665777216456", "totalBytesProcessed": "154024832", "totalSlotMs": "3450" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon210812c1_623f_4a1a_8197_8068722187c0" }, "priority": "INTERACTIVE", "query": "select *\nfrom (select avg(ss_list_price) B1_LP\n ,count(ss_list_price) B1_CNT\n ,count(distinct ss_list_price) B1_CNTD\n from store_sales\n where ss_quantity between 0 and 5\n and (ss_list_price between 107 and 107+10 \n or ss_coupon_amt between 1319 and 1319+1000\n or ss_wholesale_cost between 60 and 60+20)) B1,\n (select avg(ss_list_price) B2_LP\n ,count(ss_list_price) B2_CNT\n ,count(distinct ss_list_price) B2_CNTD\n from store_sales\n where ss_quantity between 6 and 10\n and (ss_list_price between 23 and 23+10\n or ss_coupon_amt between 825 and 825+1000\n or ss_wholesale_cost between 43 and 43+20)) B2,\n (select avg(ss_list_price) B3_LP\n ,count(ss_list_price) B3_CNT\n ,count(distinct ss_list_price) B3_CNTD\n from store_sales\n where ss_quantity between 11 and 15\n and (ss_list_price between 74 and 74+10\n or ss_coupon_amt between 4381 and 4381+1000\n or ss_wholesale_cost between 57 and 57+20)) B3,\n (select avg(ss_list_price) B4_LP\n ,count(ss_list_price) B4_CNT\n ,count(distinct ss_list_price) B4_CNTD\n from store_sales\n where ss_quantity between 16 and 20\n and (ss_list_price between 89 and 89+10\n or ss_coupon_amt between 3117 and 3117+1000\n or ss_wholesale_cost between 68 and 68+20)) B4,\n (select avg(ss_list_price) B5_LP\n ,count(ss_list_price) B5_CNT\n ,count(distinct ss_list_price) B5_CNTD\n from store_sales\n where ss_quantity between 21 and 25\n and (ss_list_price between 58 and 58+10\n or ss_coupon_amt between 9402 and 9402+1000\n or ss_wholesale_cost between 38 and 38+20)) B5,\n (select avg(ss_list_price) B6_LP\n ,count(ss_list_price) B6_CNT\n ,count(distinct ss_list_price) B6_CNTD\n from store_sales\n where ss_quantity between 26 and 30\n and (ss_list_price between 64 and 64+10\n or ss_coupon_amt between 5792 and 5792+1000\n or ss_wholesale_cost between 73 and 73+20)) B6\nlimit 100;\n\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "o3UZpiOirddxcpKKDu7tPA==", "id": "test-project-364309:europe-west1.query28_1665777219", "jobReference": { "jobId": "query28_1665777219", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query28_1665777219?location=europe-west1", "statistics": { "creationTime": "1665777220439", "endTime": "1665777221211", "finalExecutionDurationMs": "553", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "154024832", "performanceInsights": { "avgPreviousExecutionMs": "531" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "70", "computeMsMax": "77", "computeRatioAvg": 0.7070707070707071, "computeRatioMax": 0.7777777777777778, "endMs": "1665777220661", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "19", "readRatioAvg": 0.15151515151515152, "readRatioMax": 0.1919191919191919, "recordsRead": "2880404", "recordsWritten": "24650", "shuffleOutputBytes": "887304", "shuffleOutputBytesSpilled": "0", "slotMs": "425", "startMs": "1665777220585", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$52:ss_list_price, $50:ss_quantity, $51:ss_wholesale_cost, $53:ss_coupon_amt", "FROM store_sales", "WHERE and(between($50, 6, 10), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $770, $831 := $730", "$690 := SHARD_AVG($731)", "$691 := COUNT($731)" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := if(equal($770, 1), $52, NULL)", "$731 := if(equal($770, 0), $52, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$760 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$690, $691, $831, $830", "TO __stage00_output", "BY HASH($830, $831)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "4", "writeMsMax": "5", "writeRatioAvg": 0.04040404040404041, "writeRatioMax": 0.050505050505050504 }, { "completedParallelInputs": "6", "computeMsAvg": "76", "computeMsMax": "86", "computeRatioAvg": 0.7676767676767676, "computeRatioMax": 0.8686868686868687, "endMs": "1665777220647", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "15", "readRatioAvg": 0.1414141414141414, "readRatioMax": 0.15151515151515152, "recordsRead": "2880404", "recordsWritten": "21915", "shuffleOutputBytes": "788844", "shuffleOutputBytesSpilled": "0", "slotMs": "424", "startMs": "1665777220588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$42:ss_list_price, $40:ss_quantity, $41:ss_wholesale_cost, $43:ss_coupon_amt", "FROM store_sales", "WHERE and(between($40, 0, 5), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $750, $781 := $720", "$680 := SHARD_AVG($721)", "$681 := COUNT($721)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := if(equal($750, 1), $42, NULL)", "$721 := if(equal($750, 0), $42, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$740 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$680, $681, $781, $780", "TO __stage01_output", "BY HASH($780, $781)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "4", "writeMsMax": "6", "writeRatioAvg": 0.04040404040404041, "writeRatioMax": 0.06060606060606061 }, { "completedParallelInputs": "6", "computeMsAvg": "72", "computeMsMax": "99", "computeRatioAvg": 0.7272727272727273, "computeRatioMax": 1, "endMs": "1665777220681", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "17", "readRatioAvg": 0.15151515151515152, "readRatioMax": 0.1717171717171717, "recordsRead": "2880404", "recordsWritten": "22409", "shuffleOutputBytes": "806628", "shuffleOutputBytesSpilled": "0", "slotMs": "454", "startMs": "1665777220605", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$32:ss_list_price, $30:ss_quantity, $31:ss_wholesale_cost, $33:ss_coupon_amt", "FROM store_sales", "WHERE and(between($30, 11, 15), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $710, $891 := $670", "$620 := SHARD_AVG($671)", "$621 := COUNT($671)" ] }, { "kind": "COMPUTE", "substeps": [ "$670 := if(equal($710, 1), $32, NULL)", "$671 := if(equal($710, 0), $32, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $891, $890", "TO __stage02_output", "BY HASH($890, $891)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.0707070707070707, "writeRatioMax": 0.08080808080808081 }, { "completedParallelInputs": "6", "computeMsAvg": "77", "computeMsMax": "90", "computeRatioAvg": 0.7777777777777778, "computeRatioMax": 0.9090909090909091, "endMs": "1665777220701", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "20", "readRatioAvg": 0.1717171717171717, "readRatioMax": 0.20202020202020202, "recordsRead": "2880404", "recordsWritten": "23321", "shuffleOutputBytes": "839460", "shuffleOutputBytesSpilled": "0", "slotMs": "491", "startMs": "1665777220624", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$22:ss_list_price, $20:ss_quantity, $21:ss_wholesale_cost, $23:ss_coupon_amt", "FROM store_sales", "WHERE and(between($20, 16, 20), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $950 := $640, $951 := $570", "$530 := SHARD_AVG($571)", "$531 := COUNT($571)" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := if(equal($640, 1), $22, NULL)", "$571 := if(equal($640, 0), $22, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $951, $950", "TO __stage03_output", "BY HASH($950, $951)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.0707070707070707, "writeRatioMax": 0.08080808080808081 }, { "completedParallelInputs": "6", "computeMsAvg": "68", "computeMsMax": "87", "computeRatioAvg": 0.6868686868686869, "computeRatioMax": 0.8787878787878788, "endMs": "1665777220717", "id": "4", "name": "S04: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.16161616161616163, "readRatioMax": 0.1919191919191919, "recordsRead": "2880404", "recordsWritten": "20177", "shuffleOutputBytes": "726276", "shuffleOutputBytesSpilled": "0", "slotMs": "441", "startMs": "1665777220639", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$12:ss_list_price, $10:ss_quantity, $11:ss_wholesale_cost, $13:ss_coupon_amt", "FROM store_sales", "WHERE and(between($10, 21, 25), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1010 := $550, $1011 := $460", "$400 := SHARD_AVG($461)", "$401 := COUNT($461)" ] }, { "kind": "COMPUTE", "substeps": [ "$460 := if(equal($550, 1), $12, NULL)", "$461 := if(equal($550, 0), $12, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$540 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $1011, $1010", "TO __stage04_output", "BY HASH($1010, $1011)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "8", "writeMsMax": "9", "writeRatioAvg": 0.08080808080808081, "writeRatioMax": 0.09090909090909091 }, { "completedParallelInputs": "6", "computeMsAvg": "67", "computeMsMax": "75", "computeRatioAvg": 0.6767676767676768, "computeRatioMax": 0.7575757575757576, "endMs": "1665777220740", "id": "5", "name": "S05: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "27", "readRatioAvg": 0.16161616161616163, "readRatioMax": 0.2727272727272727, "recordsRead": "2880404", "recordsWritten": "26095", "shuffleOutputBytes": "939324", "shuffleOutputBytesSpilled": "0", "slotMs": "441", "startMs": "1665777220655", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$3:ss_list_price, $1:ss_quantity, $2:ss_wholesale_cost, $4:ss_coupon_amt", "FROM store_sales", "WHERE and(between($1, 26, 30), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $420, $1081 := $330", "$300 := SHARD_AVG($331)", "$301 := COUNT($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := if(equal($420, 1), $3, NULL)", "$331 := if(equal($420, 0), $3, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $1081, $1080", "TO __stage05_output", "BY HASH($1080, $1081)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.0707070707070707, "writeRatioMax": 0.09090909090909091 }, { "completedParallelInputs": "1", "computeMsAvg": "33", "computeMsMax": "33", "computeRatioAvg": 0.3333333333333333, "computeRatioMax": 0.3333333333333333, "endMs": "1665777220712", "id": "6", "inputStages": [ "1" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21915", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777220670", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$680, $681, $781, $780", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $800 := $790", "$580 := COUNT($602)", "$581 := ANY_VALUE($601)", "$582 := ANY_VALUE($600)" ] }, { "kind": "COMPUTE", "substeps": [ "$600 := if(equal($790, 0), $651, NULL)", "$601 := if(equal($790, 0), $650, NULL)", "$602 := if(equal($790, 1), $791, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $790 := $780, $791 := $781", "$650 := ROOT_AVG($680)", "$651 := SUM_OF_COUNTS($681)" ] }, { "kind": "WRITE", "substeps": [ "$580, $581, $582, $800", "TO __stage06_output", "BY HASH($800)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.21212121212121213, "writeRatioMax": 0.21212121212121213 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.31313131313131315, "computeRatioMax": 0.31313131313131315, "endMs": "1665777220731", "id": "7", "inputStages": [ "0" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24650", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777220692", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $691, $831, $830", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $850 := $840", "$590 := COUNT($612)", "$591 := ANY_VALUE($611)", "$592 := ANY_VALUE($610)" ] }, { "kind": "COMPUTE", "substeps": [ "$610 := if(equal($840, 0), $661, NULL)", "$611 := if(equal($840, 0), $660, NULL)", "$612 := if(equal($840, 1), $841, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830, $841 := $831", "$660 := ROOT_AVG($690)", "$661 := SUM_OF_COUNTS($691)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $850", "TO __stage07_output", "BY HASH($850)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.20202020202020202, "writeRatioMax": 0.20202020202020202 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.16161616161616163, "computeRatioMax": 0.16161616161616163, "endMs": "1665777220761", "id": "8", "inputStages": [ "2" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22409", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777220716", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $621, $891, $890", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$490 := COUNT($522)", "$491 := ANY_VALUE($521)", "$492 := ANY_VALUE($520)" ] }, { "kind": "COMPUTE", "substeps": [ "$520 := if(equal($900, 0), $561, NULL)", "$521 := if(equal($900, 0), $560, NULL)", "$522 := if(equal($900, 1), $901, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891", "$560 := ROOT_AVG($620)", "$561 := SUM_OF_COUNTS($621)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $910", "TO __stage08_output", "BY HASH($910)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.23232323232323232, "writeRatioMax": 0.23232323232323232 }, { "completedParallelInputs": "1", "computeMsAvg": "30", "computeMsMax": "30", "computeRatioAvg": 0.30303030303030304, "computeRatioMax": 0.30303030303030304, "endMs": "1665777220775", "id": "9", "inputStages": [ "3" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "23321", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777220737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $951, $950", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960", "$370 := COUNT($392)", "$371 := ANY_VALUE($391)", "$372 := ANY_VALUE($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$390 := if(equal($960, 0), $451, NULL)", "$391 := if(equal($960, 0), $450, NULL)", "$392 := if(equal($960, 1), $961, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $950, $961 := $951", "$450 := ROOT_AVG($530)", "$451 := SUM_OF_COUNTS($531)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $970", "TO __stage09_output", "BY HASH($970)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.20202020202020202, "writeRatioMax": 0.20202020202020202 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0707070707070707, "computeRatioMax": 0.0707070707070707, "endMs": "1665777220775", "id": "10", "inputStages": [ "6" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777220739", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $581, $582, $800", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$430 := ANY_VALUE($472)", "$431 := ANY_VALUE($471)", "$432 := ANY_VALUE($470)" ] }, { "kind": "COMPUTE", "substeps": [ "$470 := if(equal($810, 0), $502, NULL)", "$471 := if(equal($810, 0), $501, NULL)", "$472 := if(equal($810, 1), $500, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800", "$500 := SUM_OF_COUNTS($580)", "$501 := ANY_VALUE($581)", "$502 := ANY_VALUE($582)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432", "TO __stage0A_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.2828282828282828, "writeRatioMax": 0.2828282828282828 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.04040404040404041, "computeRatioMax": 0.04040404040404041, "endMs": "1665777220797", "id": "11", "inputStages": [ "10" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777220739", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$430, $431, $432", "FROM __stage0A_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := if(is_null($342), 0, $342)", "$261 := if(is_null($340), 0, $340)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$340 := ANY_VALUE($430)", "$341 := ANY_VALUE($431)", "$342 := ANY_VALUE($432)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $341", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.020202020202020204, "writeRatioMax": 0.020202020202020204 }, { "completedParallelInputs": "1", "computeMsAvg": "22", "computeMsMax": "22", "computeRatioAvg": 0.2222222222222222, "computeRatioMax": 0.2222222222222222, "endMs": "1665777220801", "id": "12", "inputStages": [ "4" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20177", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777220754", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $1011, $1010", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1020", "$250 := COUNT($292)", "$251 := ANY_VALUE($291)", "$252 := ANY_VALUE($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := if(equal($1020, 0), $321, NULL)", "$291 := if(equal($1020, 0), $320, NULL)", "$292 := if(equal($1020, 1), $1021, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1020 := $1010, $1021 := $1011", "$320 := ROOT_AVG($400)", "$321 := SUM_OF_COUNTS($401)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $1030", "TO __stage0C_output", "BY HASH($1030)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.20202020202020202, "writeRatioMax": 0.20202020202020202 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0707070707070707, "computeRatioMax": 0.0707070707070707, "endMs": "1665777220794", "id": "13", "inputStages": [ "7" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777220756", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $850", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$440 := ANY_VALUE($482)", "$441 := ANY_VALUE($481)", "$442 := ANY_VALUE($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := if(equal($860, 0), $512, NULL)", "$481 := if(equal($860, 0), $511, NULL)", "$482 := if(equal($860, 1), $510, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $860 := $850", "$510 := SUM_OF_COUNTS($590)", "$511 := ANY_VALUE($591)", "$512 := ANY_VALUE($592)" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.2828282828282828, "writeRatioMax": 0.2828282828282828 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0707070707070707, "computeRatioMax": 0.0707070707070707, "endMs": "1665777220812", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777220757", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := if(is_null($352), 0, $352)", "$271 := if(is_null($350), 0, $350)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$350 := ANY_VALUE($440)", "$351 := ANY_VALUE($441)", "$352 := ANY_VALUE($442)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $351", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.2727272727272727, "computeRatioMax": 0.2727272727272727, "endMs": "1665777220832", "id": "15", "inputStages": [ "5" ], "name": "S0F: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26095", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "62", "startMs": "1665777220770", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $1081, $1080", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$170 := COUNT($202)", "$171 := ANY_VALUE($201)", "$172 := ANY_VALUE($200)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal($1090, 0), $221, NULL)", "$201 := if(equal($1090, 0), $220, NULL)", "$202 := if(equal($1090, 1), $1091, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080, $1091 := $1081", "$220 := ROOT_AVG($300)", "$221 := SUM_OF_COUNTS($301)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $1100", "TO __stage0F_output", "BY HASH($1100)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "46", "writeMsMax": "46", "writeRatioAvg": 0.46464646464646464, "writeRatioMax": 0.46464646464646464 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09090909090909091, "computeRatioMax": 0.09090909090909091, "endMs": "1665777220831", "id": "16", "inputStages": [ "8" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777220773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $910", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$310 := ANY_VALUE($362)", "$311 := ANY_VALUE($361)", "$312 := ANY_VALUE($360)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := if(equal($920, 0), $382, NULL)", "$361 := if(equal($920, 0), $381, NULL)", "$362 := if(equal($920, 1), $380, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $910", "$380 := SUM_OF_COUNTS($490)", "$381 := ANY_VALUE($491)", "$382 := ANY_VALUE($492)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "32", "writeMsMax": "32", "writeRatioAvg": 0.32323232323232326, "writeRatioMax": 0.32323232323232326 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.06060606060606061, "computeRatioMax": 0.06060606060606061, "endMs": "1665777220842", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777220773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(is_null($232), 0, $232)", "$181 := if(is_null($230), 0, $230)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_VALUE($310)", "$231 := ANY_VALUE($311)", "$232 := ANY_VALUE($312)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $231", "TO __stage11_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.0707070707070707, "computeRatioMax": 0.0707070707070707, "endMs": "1665777220819", "id": "18", "inputStages": [ "9" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777220779", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370, $371, $372, $970", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$210 := ANY_VALUE($242)", "$211 := ANY_VALUE($241)", "$212 := ANY_VALUE($240)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := if(equal($980, 0), $282, NULL)", "$241 := if(equal($980, 0), $281, NULL)", "$242 := if(equal($980, 1), $280, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$280 := SUM_OF_COUNTS($370)", "$281 := ANY_VALUE($371)", "$282 := ANY_VALUE($372)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.31313131313131315, "writeRatioMax": 0.31313131313131315 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.13131313131313133, "computeRatioMax": 0.13131313131313133, "endMs": "1665777220839", "id": "19", "inputStages": [ "18" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777220781", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212", "FROM __stage12_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(is_null($152), 0, $152)", "$121 := if(is_null($150), 0, $150)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := ANY_VALUE($210)", "$151 := ANY_VALUE($211)", "$152 := ANY_VALUE($212)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $151", "TO __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.050505050505050504, "writeRatioMax": 0.050505050505050504 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09090909090909091, "computeRatioMax": 0.09090909090909091, "endMs": "1665777220842", "id": "20", "inputStages": [ "12" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777220806", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $1030", "FROM __stage0C_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := ANY_VALUE($162)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($160)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($1040, 0), $192, NULL)", "$161 := if(equal($1040, 0), $191, NULL)", "$162 := if(equal($1040, 1), $190, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030", "$190 := SUM_OF_COUNTS($250)", "$191 := ANY_VALUE($251)", "$192 := ANY_VALUE($252)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.15151515151515152, "writeRatioMax": 0.15151515151515152 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09090909090909091, "computeRatioMax": 0.09090909090909091, "endMs": "1665777220862", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "48", "startMs": "1665777220808", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142", "FROM __stage14_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := if(is_null($102), 0, $102)", "$81 := if(is_null($100), 0, $100)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_VALUE($140)", "$101 := ANY_VALUE($141)", "$102 := ANY_VALUE($142)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $101", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.030303030303030304, "writeRatioMax": 0.030303030303030304 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.15151515151515152, "computeRatioMax": 0.15151515151515152, "endMs": "1665777220881", "id": "22", "inputStages": [ "14", "11" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "70", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777220827", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $341", "FROM __stage0B_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $351", "FROM __stage0E_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$870 := $260, $871 := $261, $872 := $341, $873 := $270, $874 := $271, $875 := $351", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$870, $871, $873, $874, $872, $875", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.24242424242424243, "writeRatioMax": 0.24242424242424243 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.10101010101010101, "computeRatioMax": 0.10101010101010101, "endMs": "1665777220909", "id": "23", "inputStages": [ "15" ], "name": "S17: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777220846", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $1100", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($112)", "$91 := ANY_VALUE($111)", "$92 := ANY_VALUE($110)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := if(equal($1110, 0), $132, NULL)", "$111 := if(equal($1110, 0), $131, NULL)", "$112 := if(equal($1110, 1), $130, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $1100", "$130 := SUM_OF_COUNTS($170)", "$131 := ANY_VALUE($171)", "$132 := ANY_VALUE($172)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "53", "writeMsMax": "53", "writeRatioAvg": 0.5353535353535354, "writeRatioMax": 0.5353535353535354 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.06060606060606061, "computeRatioMax": 0.06060606060606061, "endMs": "1665777220913", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "49", "startMs": "1665777220847", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage17_output" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($72), 0, $72)", "$61 := if(is_null($70), 0, $70)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($90)", "$71 := ANY_VALUE($91)", "$72 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $71", "TO __stage18_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.020202020202020204, "waitRatioMax": 0.020202020202020204, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.020202020202020204, "writeRatioMax": 0.020202020202020204 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.12121212121212122, "computeRatioMax": 0.12121212121212122, "endMs": "1665777220934", "id": "25", "inputStages": [ "22", "17" ], "name": "S19: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "58", "startMs": "1665777220883", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$870, $871, $873, $874, $872, $875", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $231", "FROM __stage11_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$930 := $870, $931 := $871, $932 := $873, $933 := $874, $934 := $872, $935 := $875, $936 := $180, $937 := $181, $938 := $231", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.15151515151515152, "writeRatioMax": 0.15151515151515152 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.13131313131313133, "computeRatioMax": 0.13131313131313133, "endMs": "1665777220988", "id": "26", "inputStages": [ "25", "19" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "140", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777220941", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$120, $121, $151", "FROM __stage13_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$990 := $936, $991 := $937, $992 := $938, $993 := $930, $994 := $931, $995 := $932, $996 := $933, $997 := $934, $998 := $935, $999 := $120, $1000 := $121, $1001 := $151", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.18181818181818182, "writeRatioMax": 0.18181818181818182 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.1111111111111111, "computeRatioMax": 0.1111111111111111, "endMs": "1665777221036", "id": "27", "inputStages": [ "21", "26" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "175", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777220996", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $101", "FROM __stage15_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $999, $1051 := $1000, $1052 := $1001, $1053 := $990, $1054 := $991, $1055 := $992, $1056 := $993, $1057 := $994, $1058 := $995, $1059 := $996, $1060 := $997, $1061 := $998, $1062 := $80, $1063 := $81, $1064 := $101", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.26262626262626265, "writeRatioMax": 0.26262626262626265 }, { "completedParallelInputs": "1", "computeMsAvg": "26", "computeMsMax": "26", "computeRatioAvg": 0.26262626262626265, "computeRatioMax": 0.26262626262626265, "endMs": "1665777221113", "id": "28", "inputStages": [ "24", "27" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "195", "shuffleOutputBytesSpilled": "0", "slotMs": "52", "startMs": "1665777221062", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $71", "FROM __stage18_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1062, $1121 := $1063, $1122 := $1064, $1123 := $1050, $1124 := $1051, $1125 := $1052, $1126 := $1053, $1127 := $1054, $1128 := $1055, $1129 := $1056, $1130 := $1057, $1131 := $1058, $1132 := $1059, $1133 := $1060, $1134 := $1061, $1135 := $60", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1135, $1136, $1137, $1120, $1121, $1122, $1123, $1124, $1125, $1126, $1127, $1128, $1129, $1130, $1131, $1132", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.010101010101010102, "waitRatioMax": 0.010101010101010102, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.1111111111111111, "writeRatioMax": 0.1111111111111111 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "58", "elapsedMs": "608", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3688" }, { "activeUnits": "1", "completedUnits": "59", "elapsedMs": "685", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3741" } ], "totalBytesBilled": "154140672", "totalBytesProcessed": "154024832", "totalPartitionsProcessed": "0", "totalSlotMs": "3741", "transferredBytes": "0" }, "startTime": "1665777220478", "totalBytesProcessed": "154024832", "totalSlotMs": "3741" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonfbd8f198_43d3_4b60_b997_b1509e0a6ea6" }, "priority": "INTERACTIVE", "query": "select *\nfrom (select avg(ss_list_price) B1_LP\n ,count(ss_list_price) B1_CNT\n ,count(distinct ss_list_price) B1_CNTD\n from store_sales\n where ss_quantity between 0 and 5\n and (ss_list_price between 107 and 107+10 \n or ss_coupon_amt between 1319 and 1319+1000\n or ss_wholesale_cost between 60 and 60+20)) B1,\n (select avg(ss_list_price) B2_LP\n ,count(ss_list_price) B2_CNT\n ,count(distinct ss_list_price) B2_CNTD\n from store_sales\n where ss_quantity between 6 and 10\n and (ss_list_price between 23 and 23+10\n or ss_coupon_amt between 825 and 825+1000\n or ss_wholesale_cost between 43 and 43+20)) B2,\n (select avg(ss_list_price) B3_LP\n ,count(ss_list_price) B3_CNT\n ,count(distinct ss_list_price) B3_CNTD\n from store_sales\n where ss_quantity between 11 and 15\n and (ss_list_price between 74 and 74+10\n or ss_coupon_amt between 4381 and 4381+1000\n or ss_wholesale_cost between 57 and 57+20)) B3,\n (select avg(ss_list_price) B4_LP\n ,count(ss_list_price) B4_CNT\n ,count(distinct ss_list_price) B4_CNTD\n from store_sales\n where ss_quantity between 16 and 20\n and (ss_list_price between 89 and 89+10\n or ss_coupon_amt between 3117 and 3117+1000\n or ss_wholesale_cost between 68 and 68+20)) B4,\n (select avg(ss_list_price) B5_LP\n ,count(ss_list_price) B5_CNT\n ,count(distinct ss_list_price) B5_CNTD\n from store_sales\n where ss_quantity between 21 and 25\n and (ss_list_price between 58 and 58+10\n or ss_coupon_amt between 9402 and 9402+1000\n or ss_wholesale_cost between 38 and 38+20)) B5,\n (select avg(ss_list_price) B6_LP\n ,count(ss_list_price) B6_CNT\n ,count(distinct ss_list_price) B6_CNTD\n from store_sales\n where ss_quantity between 26 and 30\n and (ss_list_price between 64 and 64+10\n or ss_coupon_amt between 5792 and 5792+1000\n or ss_wholesale_cost between 73 and 73+20)) B6\nlimit 100;\n\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "ZR2i9HqMOBfDoLOt88K3DA==", "id": "test-project-364309:europe-west1.query28_1665777222", "jobReference": { "jobId": "query28_1665777222", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query28_1665777222?location=europe-west1", "statistics": { "creationTime": "1665777222943", "endTime": "1665777223737", "finalExecutionDurationMs": "581", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "154024832", "performanceInsights": { "avgPreviousExecutionMs": "534" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "69", "computeMsMax": "80", "computeRatioAvg": 0.6764705882352942, "computeRatioMax": 0.7843137254901961, "endMs": "1665777223177", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "24", "readRatioAvg": 0.18627450980392157, "readRatioMax": 0.23529411764705882, "recordsRead": "2880404", "recordsWritten": "24650", "shuffleOutputBytes": "887304", "shuffleOutputBytesSpilled": "0", "slotMs": "490", "startMs": "1665777223094", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$52:ss_list_price, $50:ss_quantity, $51:ss_wholesale_cost, $53:ss_coupon_amt", "FROM store_sales", "WHERE and(between($50, 6, 10), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $770, $831 := $730", "$690 := SHARD_AVG($731)", "$691 := COUNT($731)" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := if(equal($770, 1), $52, NULL)", "$731 := if(equal($770, 0), $52, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$760 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$690, $691, $831, $830", "TO __stage00_output", "BY HASH($830, $831)" ] } ], "waitMsAvg": "1", "waitMsMax": "3", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.029411764705882353, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.0784313725490196 }, { "completedParallelInputs": "6", "computeMsAvg": "72", "computeMsMax": "79", "computeRatioAvg": 0.7058823529411765, "computeRatioMax": 0.7745098039215687, "endMs": "1665777223181", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "28", "readRatioAvg": 0.18627450980392157, "readRatioMax": 0.27450980392156865, "recordsRead": "2880404", "recordsWritten": "21915", "shuffleOutputBytes": "788844", "shuffleOutputBytesSpilled": "0", "slotMs": "461", "startMs": "1665777223097", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$42:ss_list_price, $40:ss_quantity, $41:ss_wholesale_cost, $43:ss_coupon_amt", "FROM store_sales", "WHERE and(between($40, 0, 5), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $750, $781 := $720", "$680 := SHARD_AVG($721)", "$681 := COUNT($721)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := if(equal($750, 1), $42, NULL)", "$721 := if(equal($750, 0), $42, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$740 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$680, $681, $781, $780", "TO __stage01_output", "BY HASH($780, $781)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.049019607843137254, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "6", "computeMsAvg": "72", "computeMsMax": "79", "computeRatioAvg": 0.7058823529411765, "computeRatioMax": 0.7745098039215687, "endMs": "1665777223187", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "20", "readRatioAvg": 0.16666666666666666, "readRatioMax": 0.19607843137254902, "recordsRead": "2880404", "recordsWritten": "22409", "shuffleOutputBytes": "806628", "shuffleOutputBytesSpilled": "0", "slotMs": "471", "startMs": "1665777223111", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$32:ss_list_price, $30:ss_quantity, $31:ss_wholesale_cost, $33:ss_coupon_amt", "FROM store_sales", "WHERE and(between($30, 11, 15), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $710, $891 := $670", "$620 := SHARD_AVG($671)", "$621 := COUNT($671)" ] }, { "kind": "COMPUTE", "substeps": [ "$670 := if(equal($710, 1), $32, NULL)", "$671 := if(equal($710, 0), $32, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $891, $890", "TO __stage02_output", "BY HASH($890, $891)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "8", "writeMsMax": "13", "writeRatioAvg": 0.0784313725490196, "writeRatioMax": 0.12745098039215685 }, { "completedParallelInputs": "6", "computeMsAvg": "74", "computeMsMax": "84", "computeRatioAvg": 0.7254901960784313, "computeRatioMax": 0.8235294117647058, "endMs": "1665777223211", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "29", "readRatioAvg": 0.19607843137254902, "readRatioMax": 0.28431372549019607, "recordsRead": "2880404", "recordsWritten": "23321", "shuffleOutputBytes": "839460", "shuffleOutputBytesSpilled": "0", "slotMs": "493", "startMs": "1665777223126", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$22:ss_list_price, $20:ss_quantity, $21:ss_wholesale_cost, $23:ss_coupon_amt", "FROM store_sales", "WHERE and(between($20, 16, 20), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $950 := $640, $951 := $570", "$530 := SHARD_AVG($571)", "$531 := COUNT($571)" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := if(equal($640, 1), $22, NULL)", "$571 := if(equal($640, 0), $22, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $951, $950", "TO __stage03_output", "BY HASH($950, $951)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "8", "writeMsMax": "11", "writeRatioAvg": 0.0784313725490196, "writeRatioMax": 0.10784313725490197 }, { "completedParallelInputs": "6", "computeMsAvg": "60", "computeMsMax": "70", "computeRatioAvg": 0.5882352941176471, "computeRatioMax": 0.6862745098039216, "endMs": "1665777223214", "id": "4", "name": "S04: Input", "parallelInputs": "6", "readMsAvg": "14", "readMsMax": "17", "readRatioAvg": 0.13725490196078433, "readRatioMax": 0.16666666666666666, "recordsRead": "2880404", "recordsWritten": "20177", "shuffleOutputBytes": "726276", "shuffleOutputBytesSpilled": "0", "slotMs": "400", "startMs": "1665777223149", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$12:ss_list_price, $10:ss_quantity, $11:ss_wholesale_cost, $13:ss_coupon_amt", "FROM store_sales", "WHERE and(between($10, 21, 25), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1010 := $550, $1011 := $460", "$400 := SHARD_AVG($461)", "$401 := COUNT($461)" ] }, { "kind": "COMPUTE", "substeps": [ "$460 := if(equal($550, 1), $12, NULL)", "$461 := if(equal($550, 0), $12, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$540 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $1011, $1010", "TO __stage04_output", "BY HASH($1010, $1011)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.0784313725490196 }, { "completedParallelInputs": "6", "computeMsAvg": "78", "computeMsMax": "102", "computeRatioAvg": 0.7647058823529411, "computeRatioMax": 1, "endMs": "1665777223261", "id": "5", "name": "S05: Input", "parallelInputs": "6", "readMsAvg": "21", "readMsMax": "28", "readRatioAvg": 0.20588235294117646, "readRatioMax": 0.27450980392156865, "recordsRead": "2880404", "recordsWritten": "26095", "shuffleOutputBytes": "939324", "shuffleOutputBytesSpilled": "0", "slotMs": "589", "startMs": "1665777223164", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$3:ss_list_price, $1:ss_quantity, $2:ss_wholesale_cost, $4:ss_coupon_amt", "FROM store_sales", "WHERE and(between($1, 26, 30), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $420, $1081 := $330", "$300 := SHARD_AVG($331)", "$301 := COUNT($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := if(equal($420, 1), $3, NULL)", "$331 := if(equal($420, 0), $3, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $1081, $1080", "TO __stage05_output", "BY HASH($1080, $1081)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "8", "writeMsMax": "11", "writeRatioAvg": 0.0784313725490196, "writeRatioMax": 0.10784313725490197 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.18627450980392157, "computeRatioMax": 0.18627450980392157, "endMs": "1665777223232", "id": "6", "inputStages": [ "0" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24650", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777223196", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $691, $831, $830", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $850 := $840", "$590 := COUNT($612)", "$591 := ANY_VALUE($611)", "$592 := ANY_VALUE($610)" ] }, { "kind": "COMPUTE", "substeps": [ "$610 := if(equal($840, 0), $661, NULL)", "$611 := if(equal($840, 0), $660, NULL)", "$612 := if(equal($840, 1), $841, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830, $841 := $831", "$660 := ROOT_AVG($690)", "$661 := SUM_OF_COUNTS($691)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $850", "TO __stage06_output", "BY HASH($850)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.0784313725490196, "writeRatioMax": 0.0784313725490196 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.22549019607843138, "computeRatioMax": 0.22549019607843138, "endMs": "1665777223241", "id": "7", "inputStages": [ "1" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21915", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777223211", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$680, $681, $781, $780", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $800 := $790", "$580 := COUNT($602)", "$581 := ANY_VALUE($601)", "$582 := ANY_VALUE($600)" ] }, { "kind": "COMPUTE", "substeps": [ "$600 := if(equal($790, 0), $651, NULL)", "$601 := if(equal($790, 0), $650, NULL)", "$602 := if(equal($790, 1), $791, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $790 := $780, $791 := $781", "$650 := ROOT_AVG($680)", "$651 := SUM_OF_COUNTS($681)" ] }, { "kind": "WRITE", "substeps": [ "$580, $581, $582, $800", "TO __stage07_output", "BY HASH($800)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.09803921568627451, "writeRatioMax": 0.09803921568627451 }, { "completedParallelInputs": "1", "computeMsAvg": "35", "computeMsMax": "35", "computeRatioAvg": 0.3431372549019608, "computeRatioMax": 0.3431372549019608, "endMs": "1665777223300", "id": "8", "inputStages": [ "2" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22409", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "72", "startMs": "1665777223228", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $621, $891, $890", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$490 := COUNT($522)", "$491 := ANY_VALUE($521)", "$492 := ANY_VALUE($520)" ] }, { "kind": "COMPUTE", "substeps": [ "$520 := if(equal($900, 0), $561, NULL)", "$521 := if(equal($900, 0), $560, NULL)", "$522 := if(equal($900, 1), $901, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891", "$560 := ROOT_AVG($620)", "$561 := SUM_OF_COUNTS($621)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $910", "TO __stage08_output", "BY HASH($910)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.22549019607843138, "writeRatioMax": 0.22549019607843138 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.16666666666666666, "computeRatioMax": 0.16666666666666666, "endMs": "1665777223304", "id": "9", "inputStages": [ "3" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "23321", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665777223270", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $951, $950", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960", "$370 := COUNT($392)", "$371 := ANY_VALUE($391)", "$372 := ANY_VALUE($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$390 := if(equal($960, 0), $451, NULL)", "$391 := if(equal($960, 0), $450, NULL)", "$392 := if(equal($960, 1), $961, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $950, $961 := $951", "$450 := ROOT_AVG($530)", "$451 := SUM_OF_COUNTS($531)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $970", "TO __stage09_output", "BY HASH($970)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.19607843137254902, "writeRatioMax": 0.19607843137254902 }, { "completedParallelInputs": "1", "computeMsAvg": "28", "computeMsMax": "28", "computeRatioAvg": 0.27450980392156865, "computeRatioMax": 0.27450980392156865, "endMs": "1665777223329", "id": "10", "inputStages": [ "4" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20177", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777223291", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $1011, $1010", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1020", "$250 := COUNT($292)", "$251 := ANY_VALUE($291)", "$252 := ANY_VALUE($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := if(equal($1020, 0), $321, NULL)", "$291 := if(equal($1020, 0), $320, NULL)", "$292 := if(equal($1020, 1), $1021, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1020 := $1010, $1021 := $1011", "$320 := ROOT_AVG($400)", "$321 := SUM_OF_COUNTS($401)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $1030", "TO __stage0A_output", "BY HASH($1030)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.18627450980392157, "writeRatioMax": 0.18627450980392157 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06862745098039216, "computeRatioMax": 0.06862745098039216, "endMs": "1665777223331", "id": "11", "inputStages": [ "6" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777223293", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $850", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$440 := ANY_VALUE($482)", "$441 := ANY_VALUE($481)", "$442 := ANY_VALUE($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := if(equal($860, 0), $512, NULL)", "$481 := if(equal($860, 0), $511, NULL)", "$482 := if(equal($860, 1), $510, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $860 := $850", "$510 := SUM_OF_COUNTS($590)", "$511 := ANY_VALUE($591)", "$512 := ANY_VALUE($592)" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.27450980392156865, "writeRatioMax": 0.27450980392156865 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.08823529411764706, "computeRatioMax": 0.08823529411764706, "endMs": "1665777223348", "id": "12", "inputStages": [ "11" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777223293", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := if(is_null($352), 0, $352)", "$271 := if(is_null($350), 0, $350)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$350 := ANY_VALUE($440)", "$351 := ANY_VALUE($441)", "$352 := ANY_VALUE($442)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $351", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0392156862745098, "writeRatioMax": 0.0392156862745098 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09803921568627451, "computeRatioMax": 0.09803921568627451, "endMs": "1665777223331", "id": "13", "inputStages": [ "7" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777223293", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $581, $582, $800", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$430 := ANY_VALUE($472)", "$431 := ANY_VALUE($471)", "$432 := ANY_VALUE($470)" ] }, { "kind": "COMPUTE", "substeps": [ "$470 := if(equal($810, 0), $502, NULL)", "$471 := if(equal($810, 0), $501, NULL)", "$472 := if(equal($810, 1), $500, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800", "$500 := SUM_OF_COUNTS($580)", "$501 := ANY_VALUE($581)", "$502 := ANY_VALUE($582)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432", "TO __stage0D_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.2647058823529412, "writeRatioMax": 0.2647058823529412 }, { "completedParallelInputs": "1", "computeMsAvg": "20", "computeMsMax": "20", "computeRatioAvg": 0.19607843137254902, "computeRatioMax": 0.19607843137254902, "endMs": "1665777223344", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777223295", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$430, $431, $432", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := if(is_null($342), 0, $342)", "$261 := if(is_null($340), 0, $340)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$340 := ANY_VALUE($430)", "$341 := ANY_VALUE($431)", "$342 := ANY_VALUE($432)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $341", "TO __stage0E_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.029411764705882353, "waitRatioMax": 0.029411764705882353, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.058823529411764705, "writeRatioMax": 0.058823529411764705 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.16666666666666666, "computeRatioMax": 0.16666666666666666, "endMs": "1665777223339", "id": "15", "inputStages": [ "5" ], "name": "S0F: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26095", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777223313", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $1081, $1080", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$170 := COUNT($202)", "$171 := ANY_VALUE($201)", "$172 := ANY_VALUE($200)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal($1090, 0), $221, NULL)", "$201 := if(equal($1090, 0), $220, NULL)", "$202 := if(equal($1090, 1), $1091, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080, $1091 := $1081", "$220 := ROOT_AVG($300)", "$221 := SUM_OF_COUNTS($301)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $1100", "TO __stage0F_output", "BY HASH($1100)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.10784313725490197, "writeRatioMax": 0.10784313725490197 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.13725490196078433, "computeRatioMax": 0.13725490196078433, "endMs": "1665777223343", "id": "16", "inputStages": [ "8" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777223315", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $910", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$310 := ANY_VALUE($362)", "$311 := ANY_VALUE($361)", "$312 := ANY_VALUE($360)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := if(equal($920, 0), $382, NULL)", "$361 := if(equal($920, 0), $381, NULL)", "$362 := if(equal($920, 1), $380, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $910", "$380 := SUM_OF_COUNTS($490)", "$381 := ANY_VALUE($491)", "$382 := ANY_VALUE($492)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.16666666666666666, "writeRatioMax": 0.16666666666666666 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09803921568627451, "computeRatioMax": 0.09803921568627451, "endMs": "1665777223359", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777223315", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(is_null($232), 0, $232)", "$181 := if(is_null($230), 0, $230)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_VALUE($310)", "$231 := ANY_VALUE($311)", "$232 := ANY_VALUE($312)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $231", "TO __stage11_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.0392156862745098, "writeRatioMax": 0.0392156862745098 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.11764705882352941, "computeRatioMax": 0.11764705882352941, "endMs": "1665777223358", "id": "18", "inputStages": [ "9" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665777223315", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370, $371, $372, $970", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$210 := ANY_VALUE($242)", "$211 := ANY_VALUE($241)", "$212 := ANY_VALUE($240)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := if(equal($980, 0), $282, NULL)", "$241 := if(equal($980, 0), $281, NULL)", "$242 := if(equal($980, 1), $280, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$280 := SUM_OF_COUNTS($370)", "$281 := ANY_VALUE($371)", "$282 := ANY_VALUE($372)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212", "TO __stage12_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.12745098039215685, "writeRatioMax": 0.12745098039215685 }, { "completedParallelInputs": "1", "computeMsAvg": "19", "computeMsMax": "19", "computeRatioAvg": 0.18627450980392157, "computeRatioMax": 0.18627450980392157, "endMs": "1665777223401", "id": "19", "inputStages": [ "18" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "78", "startMs": "1665777223317", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212", "FROM __stage12_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(is_null($152), 0, $152)", "$121 := if(is_null($150), 0, $150)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := ANY_VALUE($210)", "$151 := ANY_VALUE($211)", "$152 := ANY_VALUE($212)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $151", "TO __stage13_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.029411764705882353, "waitRatioMax": 0.029411764705882353, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.11764705882352941, "writeRatioMax": 0.11764705882352941 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.08823529411764706, "computeRatioMax": 0.08823529411764706, "endMs": "1665777223383", "id": "20", "inputStages": [ "10" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777223342", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $1030", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := ANY_VALUE($162)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($160)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($1040, 0), $192, NULL)", "$161 := if(equal($1040, 0), $191, NULL)", "$162 := if(equal($1040, 1), $190, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030", "$190 := SUM_OF_COUNTS($250)", "$191 := ANY_VALUE($251)", "$192 := ANY_VALUE($252)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1568627450980392, "writeRatioMax": 0.1568627450980392 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.10784313725490197, "computeRatioMax": 0.10784313725490197, "endMs": "1665777223401", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777223344", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142", "FROM __stage14_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := if(is_null($102), 0, $102)", "$81 := if(is_null($100), 0, $100)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_VALUE($140)", "$101 := ANY_VALUE($141)", "$102 := ANY_VALUE($142)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $101", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.058823529411764705, "computeRatioMax": 0.058823529411764705, "endMs": "1665777223383", "id": "22", "inputStages": [ "15" ], "name": "S16: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777223347", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $1100", "FROM __stage0F_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($112)", "$91 := ANY_VALUE($111)", "$92 := ANY_VALUE($110)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := if(equal($1110, 0), $132, NULL)", "$111 := if(equal($1110, 0), $131, NULL)", "$112 := if(equal($1110, 1), $130, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $1100", "$130 := SUM_OF_COUNTS($170)", "$131 := ANY_VALUE($171)", "$132 := ANY_VALUE($172)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.1568627450980392, "writeRatioMax": 0.1568627450980392 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.08823529411764706, "computeRatioMax": 0.08823529411764706, "endMs": "1665777223401", "id": "23", "inputStages": [ "22" ], "name": "S17: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777223348", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage16_output" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($72), 0, $72)", "$61 := if(is_null($70), 0, $70)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($90)", "$71 := ANY_VALUE($91)", "$72 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $71", "TO __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0196078431372549, "waitRatioMax": 0.0196078431372549, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.029411764705882353, "writeRatioMax": 0.029411764705882353 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.16666666666666666, "computeRatioMax": 0.16666666666666666, "endMs": "1665777223401", "id": "24", "inputStages": [ "12", "14" ], "name": "S18: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "70", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777223358", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $341", "FROM __stage0E_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $351", "FROM __stage0C_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$870 := $260, $871 := $261, $872 := $341, $873 := $270, $874 := $271, $875 := $351", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$870, $871, $873, $874, $872, $875", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.11764705882352941, "writeRatioMax": 0.11764705882352941 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09803921568627451, "computeRatioMax": 0.09803921568627451, "endMs": "1665777223472", "id": "25", "inputStages": [ "17", "24" ], "name": "S19: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777223419", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$870, $871, $873, $874, $872, $875", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $231", "FROM __stage11_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$930 := $870, $931 := $871, $932 := $873, $933 := $874, $934 := $872, $935 := $875, $936 := $180, $937 := $181, $938 := $231", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.27450980392156865, "writeRatioMax": 0.27450980392156865 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.13725490196078433, "computeRatioMax": 0.13725490196078433, "endMs": "1665777223520", "id": "26", "inputStages": [ "19", "25" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "140", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777223485", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$120, $121, $151", "FROM __stage13_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$990 := $936, $991 := $937, $992 := $938, $993 := $930, $994 := $931, $995 := $932, $996 := $933, $997 := $934, $998 := $935, $999 := $120, $1000 := $121, $1001 := $151", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.21568627450980393, "writeRatioMax": 0.21568627450980393 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.08823529411764706, "computeRatioMax": 0.08823529411764706, "endMs": "1665777223564", "id": "27", "inputStages": [ "21", "26" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "175", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777223527", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $101", "FROM __stage15_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $999, $1051 := $1000, $1052 := $1001, $1053 := $990, $1054 := $991, $1055 := $992, $1056 := $993, $1057 := $994, $1058 := $995, $1059 := $996, $1060 := $997, $1061 := $998, $1062 := $80, $1063 := $81, $1064 := $101", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.23529411764705882, "writeRatioMax": 0.23529411764705882 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.16666666666666666, "computeRatioMax": 0.16666666666666666, "endMs": "1665777223634", "id": "28", "inputStages": [ "23", "27" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "195", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777223596", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $71", "FROM __stage17_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1062, $1121 := $1063, $1122 := $1064, $1123 := $1050, $1124 := $1051, $1125 := $1052, $1126 := $1053, $1127 := $1054, $1128 := $1055, $1129 := $1056, $1130 := $1057, $1131 := $1058, $1132 := $1059, $1133 := $1060, $1134 := $1061, $1135 := $60", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1135, $1136, $1137, $1120, $1121, $1122, $1123, $1124, $1125, $1126, $1127, $1128, $1129, $1130, $1131, $1132", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.00980392156862745, "waitRatioMax": 0.00980392156862745, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.11764705882352941, "writeRatioMax": 0.11764705882352941 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "0", "completedUnits": "58", "elapsedMs": "597", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "3823" }, { "activeUnits": "0", "completedUnits": "59", "elapsedMs": "694", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3862" } ], "totalBytesBilled": "154140672", "totalBytesProcessed": "154024832", "totalPartitionsProcessed": "0", "totalSlotMs": "3862", "transferredBytes": "0" }, "startTime": "1665777222998", "totalBytesProcessed": "154024832", "totalSlotMs": "3862" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonda1a1354_f82f_4841_a615_1dd9eceac392" }, "priority": "INTERACTIVE", "query": "select *\nfrom (select avg(ss_list_price) B1_LP\n ,count(ss_list_price) B1_CNT\n ,count(distinct ss_list_price) B1_CNTD\n from store_sales\n where ss_quantity between 0 and 5\n and (ss_list_price between 107 and 107+10 \n or ss_coupon_amt between 1319 and 1319+1000\n or ss_wholesale_cost between 60 and 60+20)) B1,\n (select avg(ss_list_price) B2_LP\n ,count(ss_list_price) B2_CNT\n ,count(distinct ss_list_price) B2_CNTD\n from store_sales\n where ss_quantity between 6 and 10\n and (ss_list_price between 23 and 23+10\n or ss_coupon_amt between 825 and 825+1000\n or ss_wholesale_cost between 43 and 43+20)) B2,\n (select avg(ss_list_price) B3_LP\n ,count(ss_list_price) B3_CNT\n ,count(distinct ss_list_price) B3_CNTD\n from store_sales\n where ss_quantity between 11 and 15\n and (ss_list_price between 74 and 74+10\n or ss_coupon_amt between 4381 and 4381+1000\n or ss_wholesale_cost between 57 and 57+20)) B3,\n (select avg(ss_list_price) B4_LP\n ,count(ss_list_price) B4_CNT\n ,count(distinct ss_list_price) B4_CNTD\n from store_sales\n where ss_quantity between 16 and 20\n and (ss_list_price between 89 and 89+10\n or ss_coupon_amt between 3117 and 3117+1000\n or ss_wholesale_cost between 68 and 68+20)) B4,\n (select avg(ss_list_price) B5_LP\n ,count(ss_list_price) B5_CNT\n ,count(distinct ss_list_price) B5_CNTD\n from store_sales\n where ss_quantity between 21 and 25\n and (ss_list_price between 58 and 58+10\n or ss_coupon_amt between 9402 and 9402+1000\n or ss_wholesale_cost between 38 and 38+20)) B5,\n (select avg(ss_list_price) B6_LP\n ,count(ss_list_price) B6_CNT\n ,count(distinct ss_list_price) B6_CNTD\n from store_sales\n where ss_quantity between 26 and 30\n and (ss_list_price between 64 and 64+10\n or ss_coupon_amt between 5792 and 5792+1000\n or ss_wholesale_cost between 73 and 73+20)) B6\nlimit 100;\n\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "rvC3MgVmQS80W8i2he5rAg==", "id": "test-project-364309:europe-west1.query28_1665777224", "jobReference": { "jobId": "query28_1665777224", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query28_1665777224?location=europe-west1", "statistics": { "creationTime": "1665777225412", "endTime": "1665777226147", "finalExecutionDurationMs": "498", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "154024832", "performanceInsights": { "avgPreviousExecutionMs": "538" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "69", "computeMsMax": "84", "computeRatioAvg": 0.7040816326530612, "computeRatioMax": 0.8571428571428571, "endMs": "1665777225645", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "32", "readRatioAvg": 0.23469387755102042, "readRatioMax": 0.32653061224489793, "recordsRead": "2880404", "recordsWritten": "24650", "shuffleOutputBytes": "887304", "shuffleOutputBytesSpilled": "0", "slotMs": "451", "startMs": "1665777225560", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$52:ss_list_price, $50:ss_quantity, $51:ss_wholesale_cost, $53:ss_coupon_amt", "FROM store_sales", "WHERE and(between($50, 6, 10), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $770, $831 := $730", "$690 := SHARD_AVG($731)", "$691 := COUNT($731)" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := if(equal($770, 1), $52, NULL)", "$731 := if(equal($770, 0), $52, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$760 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$690, $691, $831, $830", "TO __stage00_output", "BY HASH($830, $831)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "6", "writeMsMax": "8", "writeRatioAvg": 0.061224489795918366, "writeRatioMax": 0.08163265306122448 }, { "completedParallelInputs": "6", "computeMsAvg": "61", "computeMsMax": "62", "computeRatioAvg": 0.6224489795918368, "computeRatioMax": 0.6326530612244898, "endMs": "1665777225665", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "27", "readMsMax": "61", "readRatioAvg": 0.2755102040816326, "readRatioMax": 0.6224489795918368, "recordsRead": "2880404", "recordsWritten": "21915", "shuffleOutputBytes": "788844", "shuffleOutputBytesSpilled": "0", "slotMs": "439", "startMs": "1665777225563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$42:ss_list_price, $40:ss_quantity, $41:ss_wholesale_cost, $43:ss_coupon_amt", "FROM store_sales", "WHERE and(between($40, 0, 5), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $750, $781 := $720", "$680 := SHARD_AVG($721)", "$681 := COUNT($721)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := if(equal($750, 1), $42, NULL)", "$721 := if(equal($750, 0), $42, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$740 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$680, $681, $781, $780", "TO __stage01_output", "BY HASH($780, $781)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.05102040816326531, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "6", "computeMsAvg": "77", "computeMsMax": "93", "computeRatioAvg": 0.7857142857142857, "computeRatioMax": 0.9489795918367347, "endMs": "1665777225674", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "23", "readMsMax": "30", "readRatioAvg": 0.23469387755102042, "readRatioMax": 0.30612244897959184, "recordsRead": "2880404", "recordsWritten": "22409", "shuffleOutputBytes": "806628", "shuffleOutputBytesSpilled": "0", "slotMs": "635", "startMs": "1665777225578", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$32:ss_list_price, $30:ss_quantity, $31:ss_wholesale_cost, $33:ss_coupon_amt", "FROM store_sales", "WHERE and(between($30, 11, 15), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $710, $891 := $670", "$620 := SHARD_AVG($671)", "$621 := COUNT($671)" ] }, { "kind": "COMPUTE", "substeps": [ "$670 := if(equal($710, 1), $32, NULL)", "$671 := if(equal($710, 0), $32, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $891, $890", "TO __stage02_output", "BY HASH($890, $891)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "8", "writeMsMax": "11", "writeRatioAvg": 0.08163265306122448, "writeRatioMax": 0.11224489795918367 }, { "completedParallelInputs": "6", "computeMsAvg": "69", "computeMsMax": "82", "computeRatioAvg": 0.7040816326530612, "computeRatioMax": 0.8367346938775511, "endMs": "1665777225677", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "20", "readMsMax": "26", "readRatioAvg": 0.20408163265306123, "readRatioMax": 0.2653061224489796, "recordsRead": "2880404", "recordsWritten": "23321", "shuffleOutputBytes": "839460", "shuffleOutputBytesSpilled": "0", "slotMs": "496", "startMs": "1665777225592", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$22:ss_list_price, $20:ss_quantity, $21:ss_wholesale_cost, $23:ss_coupon_amt", "FROM store_sales", "WHERE and(between($20, 16, 20), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $950 := $640, $951 := $570", "$530 := SHARD_AVG($571)", "$531 := COUNT($571)" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := if(equal($640, 1), $22, NULL)", "$571 := if(equal($640, 0), $22, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $951, $950", "TO __stage03_output", "BY HASH($950, $951)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "9", "writeMsMax": "15", "writeRatioAvg": 0.09183673469387756, "writeRatioMax": 0.15306122448979592 }, { "completedParallelInputs": "6", "computeMsAvg": "67", "computeMsMax": "98", "computeRatioAvg": 0.6836734693877551, "computeRatioMax": 1, "endMs": "1665777225679", "id": "4", "name": "S04: Input", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "22", "readRatioAvg": 0.17346938775510204, "readRatioMax": 0.22448979591836735, "recordsRead": "2880404", "recordsWritten": "20177", "shuffleOutputBytes": "726276", "shuffleOutputBytesSpilled": "0", "slotMs": "464", "startMs": "1665777225605", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$12:ss_list_price, $10:ss_quantity, $11:ss_wholesale_cost, $13:ss_coupon_amt", "FROM store_sales", "WHERE and(between($10, 21, 25), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1010 := $550, $1011 := $460", "$400 := SHARD_AVG($461)", "$401 := COUNT($461)" ] }, { "kind": "COMPUTE", "substeps": [ "$460 := if(equal($550, 1), $12, NULL)", "$461 := if(equal($550, 0), $12, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$540 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $1011, $1010", "TO __stage04_output", "BY HASH($1010, $1011)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "8", "writeMsMax": "10", "writeRatioAvg": 0.08163265306122448, "writeRatioMax": 0.10204081632653061 }, { "completedParallelInputs": "6", "computeMsAvg": "64", "computeMsMax": "72", "computeRatioAvg": 0.6530612244897959, "computeRatioMax": 0.7346938775510204, "endMs": "1665777225687", "id": "5", "name": "S05: Input", "parallelInputs": "6", "readMsAvg": "15", "readMsMax": "18", "readRatioAvg": 0.15306122448979592, "readRatioMax": 0.1836734693877551, "recordsRead": "2880404", "recordsWritten": "26095", "shuffleOutputBytes": "939324", "shuffleOutputBytesSpilled": "0", "slotMs": "425", "startMs": "1665777225617", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$3:ss_list_price, $1:ss_quantity, $2:ss_wholesale_cost, $4:ss_coupon_amt", "FROM store_sales", "WHERE and(between($1, 26, 30), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $420, $1081 := $330", "$300 := SHARD_AVG($331)", "$301 := COUNT($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := if(equal($420, 1), $3, NULL)", "$331 := if(equal($420, 0), $3, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $1081, $1080", "TO __stage05_output", "BY HASH($1080, $1081)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.08163265306122448 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.2755102040816326, "computeRatioMax": 0.2755102040816326, "endMs": "1665777225702", "id": "6", "inputStages": [ "0" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24650", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777225665", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $691, $831, $830", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $850 := $840", "$590 := COUNT($612)", "$591 := ANY_VALUE($611)", "$592 := ANY_VALUE($610)" ] }, { "kind": "COMPUTE", "substeps": [ "$610 := if(equal($840, 0), $661, NULL)", "$611 := if(equal($840, 0), $660, NULL)", "$612 := if(equal($840, 1), $841, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830, $841 := $831", "$660 := ROOT_AVG($690)", "$661 := SUM_OF_COUNTS($691)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $850", "TO __stage06_output", "BY HASH($850)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.061224489795918366, "writeRatioMax": 0.061224489795918366 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.15306122448979592, "computeRatioMax": 0.15306122448979592, "endMs": "1665777225715", "id": "7", "inputStages": [ "1" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21915", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777225683", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$680, $681, $781, $780", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $800 := $790", "$580 := COUNT($602)", "$581 := ANY_VALUE($601)", "$582 := ANY_VALUE($600)" ] }, { "kind": "COMPUTE", "substeps": [ "$600 := if(equal($790, 0), $651, NULL)", "$601 := if(equal($790, 0), $650, NULL)", "$602 := if(equal($790, 1), $791, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $790 := $780, $791 := $781", "$650 := ROOT_AVG($680)", "$651 := SUM_OF_COUNTS($681)" ] }, { "kind": "WRITE", "substeps": [ "$580, $581, $582, $800", "TO __stage07_output", "BY HASH($800)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.19387755102040816, "writeRatioMax": 0.19387755102040816 }, { "completedParallelInputs": "1", "computeMsAvg": "24", "computeMsMax": "24", "computeRatioAvg": 0.24489795918367346, "computeRatioMax": 0.24489795918367346, "endMs": "1665777225731", "id": "8", "inputStages": [ "2" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22409", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "40", "startMs": "1665777225696", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $621, $891, $890", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$490 := COUNT($522)", "$491 := ANY_VALUE($521)", "$492 := ANY_VALUE($520)" ] }, { "kind": "COMPUTE", "substeps": [ "$520 := if(equal($900, 0), $561, NULL)", "$521 := if(equal($900, 0), $560, NULL)", "$522 := if(equal($900, 1), $901, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891", "$560 := ROOT_AVG($620)", "$561 := SUM_OF_COUNTS($621)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $910", "TO __stage08_output", "BY HASH($910)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.07142857142857142, "writeRatioMax": 0.07142857142857142 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.23469387755102042, "computeRatioMax": 0.23469387755102042, "endMs": "1665777225748", "id": "9", "inputStages": [ "3" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "23321", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777225712", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $951, $950", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960", "$370 := COUNT($392)", "$371 := ANY_VALUE($391)", "$372 := ANY_VALUE($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$390 := if(equal($960, 0), $451, NULL)", "$391 := if(equal($960, 0), $450, NULL)", "$392 := if(equal($960, 1), $961, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $950, $961 := $951", "$450 := ROOT_AVG($530)", "$451 := SUM_OF_COUNTS($531)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $970", "TO __stage09_output", "BY HASH($970)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.08163265306122448, "writeRatioMax": 0.08163265306122448 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.2755102040816326, "computeRatioMax": 0.2755102040816326, "endMs": "1665777225766", "id": "10", "inputStages": [ "4" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20177", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "47", "startMs": "1665777225725", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $1011, $1010", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1020", "$250 := COUNT($292)", "$251 := ANY_VALUE($291)", "$252 := ANY_VALUE($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := if(equal($1020, 0), $321, NULL)", "$291 := if(equal($1020, 0), $320, NULL)", "$292 := if(equal($1020, 1), $1021, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1020 := $1010, $1021 := $1011", "$320 := ROOT_AVG($400)", "$321 := SUM_OF_COUNTS($401)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $1030", "TO __stage0A_output", "BY HASH($1030)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.14285714285714285, "writeRatioMax": 0.14285714285714285 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.25510204081632654, "computeRatioMax": 0.25510204081632654, "endMs": "1665777225769", "id": "11", "inputStages": [ "5" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26095", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777225735", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $1081, $1080", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$170 := COUNT($202)", "$171 := ANY_VALUE($201)", "$172 := ANY_VALUE($200)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal($1090, 0), $221, NULL)", "$201 := if(equal($1090, 0), $220, NULL)", "$202 := if(equal($1090, 1), $1091, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080, $1091 := $1081", "$220 := ROOT_AVG($300)", "$221 := SUM_OF_COUNTS($301)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $1100", "TO __stage0B_output", "BY HASH($1100)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "22", "writeMsMax": "22", "writeRatioAvg": 0.22448979591836735, "writeRatioMax": 0.22448979591836735 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.08163265306122448, "computeRatioMax": 0.08163265306122448, "endMs": "1665777225785", "id": "12", "inputStages": [ "6" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777225737", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $850", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$440 := ANY_VALUE($482)", "$441 := ANY_VALUE($481)", "$442 := ANY_VALUE($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := if(equal($860, 0), $512, NULL)", "$481 := if(equal($860, 0), $511, NULL)", "$482 := if(equal($860, 1), $510, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $860 := $850", "$510 := SUM_OF_COUNTS($590)", "$511 := ANY_VALUE($591)", "$512 := ANY_VALUE($592)" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442", "TO __stage0C_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02040816326530612, "waitRatioMax": 0.02040816326530612, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.2755102040816326, "writeRatioMax": 0.2755102040816326 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.08163265306122448, "computeRatioMax": 0.08163265306122448, "endMs": "1665777225792", "id": "13", "inputStages": [ "12" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777225738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442", "FROM __stage0C_output" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := if(is_null($352), 0, $352)", "$271 := if(is_null($350), 0, $350)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$350 := ANY_VALUE($440)", "$351 := ANY_VALUE($441)", "$352 := ANY_VALUE($442)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $351", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02040816326530612, "waitRatioMax": 0.02040816326530612, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.030612244897959183, "writeRatioMax": 0.030612244897959183 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.061224489795918366, "computeRatioMax": 0.061224489795918366, "endMs": "1665777225772", "id": "14", "inputStages": [ "7" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665777225738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $581, $582, $800", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$430 := ANY_VALUE($472)", "$431 := ANY_VALUE($471)", "$432 := ANY_VALUE($470)" ] }, { "kind": "COMPUTE", "substeps": [ "$470 := if(equal($810, 0), $502, NULL)", "$471 := if(equal($810, 0), $501, NULL)", "$472 := if(equal($810, 1), $500, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800", "$500 := SUM_OF_COUNTS($580)", "$501 := ANY_VALUE($581)", "$502 := ANY_VALUE($582)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432", "TO __stage0E_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.2857142857142857, "writeRatioMax": 0.2857142857142857 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.07142857142857142, "computeRatioMax": 0.07142857142857142, "endMs": "1665777225791", "id": "15", "inputStages": [ "14" ], "name": "S0F: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777225738", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$430, $431, $432", "FROM __stage0E_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := if(is_null($342), 0, $342)", "$261 := if(is_null($340), 0, $340)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$340 := ANY_VALUE($430)", "$341 := ANY_VALUE($431)", "$342 := ANY_VALUE($432)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $341", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.02040816326530612, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.11224489795918367, "computeRatioMax": 0.11224489795918367, "endMs": "1665777225780", "id": "16", "inputStages": [ "8" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665777225743", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $910", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$310 := ANY_VALUE($362)", "$311 := ANY_VALUE($361)", "$312 := ANY_VALUE($360)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := if(equal($920, 0), $382, NULL)", "$361 := if(equal($920, 0), $381, NULL)", "$362 := if(equal($920, 1), $380, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $910", "$380 := SUM_OF_COUNTS($490)", "$381 := ANY_VALUE($491)", "$382 := ANY_VALUE($492)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312", "TO __stage10_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.15306122448979592, "writeRatioMax": 0.15306122448979592 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09183673469387756, "computeRatioMax": 0.09183673469387756, "endMs": "1665777225788", "id": "17", "inputStages": [ "16" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777225746", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312", "FROM __stage10_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(is_null($232), 0, $232)", "$181 := if(is_null($230), 0, $230)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_VALUE($310)", "$231 := ANY_VALUE($311)", "$232 := ANY_VALUE($312)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $231", "TO __stage11_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.030612244897959183, "waitRatioMax": 0.030612244897959183, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.04081632653061224, "writeRatioMax": 0.04081632653061224 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09183673469387756, "computeRatioMax": 0.09183673469387756, "endMs": "1665777225799", "id": "18", "inputStages": [ "9" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "25", "startMs": "1665777225762", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370, $371, $372, $970", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$210 := ANY_VALUE($242)", "$211 := ANY_VALUE($241)", "$212 := ANY_VALUE($240)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := if(equal($980, 0), $282, NULL)", "$241 := if(equal($980, 0), $281, NULL)", "$242 := if(equal($980, 1), $280, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$280 := SUM_OF_COUNTS($370)", "$281 := ANY_VALUE($371)", "$282 := ANY_VALUE($372)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.14285714285714285, "writeRatioMax": 0.14285714285714285 }, { "completedParallelInputs": "1", "computeMsAvg": "4", "computeMsMax": "4", "computeRatioAvg": 0.04081632653061224, "computeRatioMax": 0.04081632653061224, "endMs": "1665777225813", "id": "19", "inputStages": [ "18" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777225764", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212", "FROM __stage12_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(is_null($152), 0, $152)", "$121 := if(is_null($150), 0, $150)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := ANY_VALUE($210)", "$151 := ANY_VALUE($211)", "$152 := ANY_VALUE($212)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $151", "TO __stage13_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.030612244897959183, "waitRatioMax": 0.030612244897959183, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.02040816326530612, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09183673469387756, "computeRatioMax": 0.09183673469387756, "endMs": "1665777225806", "id": "20", "inputStages": [ "10" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "27", "startMs": "1665777225769", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $1030", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := ANY_VALUE($162)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($160)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($1040, 0), $192, NULL)", "$161 := if(equal($1040, 0), $191, NULL)", "$162 := if(equal($1040, 1), $190, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030", "$190 := SUM_OF_COUNTS($250)", "$191 := ANY_VALUE($251)", "$192 := ANY_VALUE($252)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.2755102040816326, "writeRatioMax": 0.2755102040816326 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.061224489795918366, "computeRatioMax": 0.061224489795918366, "endMs": "1665777225822", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777225771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142", "FROM __stage14_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := if(is_null($102), 0, $102)", "$81 := if(is_null($100), 0, $100)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_VALUE($140)", "$101 := ANY_VALUE($141)", "$102 := ANY_VALUE($142)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $101", "TO __stage15_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.02040816326530612, "writeRatioMax": 0.02040816326530612 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.08163265306122448, "computeRatioMax": 0.08163265306122448, "endMs": "1665777225812", "id": "22", "inputStages": [ "11" ], "name": "S16: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "30", "startMs": "1665777225773", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $1100", "FROM __stage0B_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($112)", "$91 := ANY_VALUE($111)", "$92 := ANY_VALUE($110)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := if(equal($1110, 0), $132, NULL)", "$111 := if(equal($1110, 0), $131, NULL)", "$112 := if(equal($1110, 1), $130, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $1100", "$130 := SUM_OF_COUNTS($170)", "$131 := ANY_VALUE($171)", "$132 := ANY_VALUE($172)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage16_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.1326530612244898, "writeRatioMax": 0.1326530612244898 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.07142857142857142, "computeRatioMax": 0.07142857142857142, "endMs": "1665777225831", "id": "23", "inputStages": [ "22" ], "name": "S17: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665777225776", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage16_output" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($72), 0, $72)", "$61 := if(is_null($70), 0, $70)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($90)", "$71 := ANY_VALUE($91)", "$72 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $71", "TO __stage17_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.02040816326530612, "waitRatioMax": 0.02040816326530612, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.030612244897959183, "writeRatioMax": 0.030612244897959183 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.1836734693877551, "computeRatioMax": 0.1836734693877551, "endMs": "1665777225850", "id": "24", "inputStages": [ "13", "15" ], "name": "S18: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "70", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777225808", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $341", "FROM __stage0F_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $351", "FROM __stage0D_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$870 := $260, $871 := $261, $872 := $341, $873 := $270, $874 := $271, $875 := $351", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$870, $871, $873, $874, $872, $875", "TO __stage18_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.12244897959183673, "writeRatioMax": 0.12244897959183673 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.08163265306122448, "computeRatioMax": 0.08163265306122448, "endMs": "1665777225892", "id": "25", "inputStages": [ "24", "17" ], "name": "S19: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777225859", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$870, $871, $873, $874, $872, $875", "FROM __stage18_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $231", "FROM __stage11_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$930 := $870, $931 := $871, $932 := $873, $933 := $874, $934 := $872, $935 := $875, $936 := $180, $937 := $181, $938 := $231", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.1326530612244898, "writeRatioMax": 0.1326530612244898 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.08163265306122448, "computeRatioMax": 0.08163265306122448, "endMs": "1665777225941", "id": "26", "inputStages": [ "25", "19" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "140", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665777225905", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$120, $121, $151", "FROM __stage13_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$990 := $936, $991 := $937, $992 := $938, $993 := $930, $994 := $931, $995 := $932, $996 := $933, $997 := $934, $998 := $935, $999 := $120, $1000 := $121, $1001 := $151", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "24", "writeMsMax": "24", "writeRatioAvg": 0.24489795918367346, "writeRatioMax": 0.24489795918367346 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.21428571428571427, "computeRatioMax": 0.21428571428571427, "endMs": "1665777225980", "id": "27", "inputStages": [ "26", "21" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "175", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665777225944", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $101", "FROM __stage15_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $999, $1051 := $1000, $1052 := $1001, $1053 := $990, $1054 := $991, $1055 := $992, $1056 := $993, $1057 := $994, $1058 := $995, $1059 := $996, $1060 := $997, $1061 := $998, $1062 := $80, $1063 := $81, $1064 := $101", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.11224489795918367, "writeRatioMax": 0.11224489795918367 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.09183673469387756, "computeRatioMax": 0.09183673469387756, "endMs": "1665777226033", "id": "28", "inputStages": [ "27", "23" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "195", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665777225996", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $71", "FROM __stage17_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1062, $1121 := $1063, $1122 := $1064, $1123 := $1050, $1124 := $1051, $1125 := $1052, $1126 := $1053, $1127 := $1054, $1128 := $1055, $1129 := $1056, $1130 := $1057, $1131 := $1058, $1132 := $1059, $1133 := $1060, $1134 := $1061, $1135 := $60", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1135, $1136, $1137, $1120, $1121, $1122, $1123, $1124, $1125, $1126, $1127, $1128, $1129, $1130, $1131, $1132", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.01020408163265306, "waitRatioMax": 0.01020408163265306, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.11224489795918367, "writeRatioMax": 0.11224489795918367 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "59", "elapsedMs": "631", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3734" } ], "totalBytesBilled": "154140672", "totalBytesProcessed": "154024832", "totalPartitionsProcessed": "0", "totalSlotMs": "3734", "transferredBytes": "0" }, "startTime": "1665777225454", "totalBytesProcessed": "154024832", "totalSlotMs": "3734" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon9193b23e_0ee3_4f63_a0db_247aa218b5b9" }, "priority": "INTERACTIVE", "query": "select *\nfrom (select avg(ss_list_price) B1_LP\n ,count(ss_list_price) B1_CNT\n ,count(distinct ss_list_price) B1_CNTD\n from store_sales\n where ss_quantity between 0 and 5\n and (ss_list_price between 107 and 107+10 \n or ss_coupon_amt between 1319 and 1319+1000\n or ss_wholesale_cost between 60 and 60+20)) B1,\n (select avg(ss_list_price) B2_LP\n ,count(ss_list_price) B2_CNT\n ,count(distinct ss_list_price) B2_CNTD\n from store_sales\n where ss_quantity between 6 and 10\n and (ss_list_price between 23 and 23+10\n or ss_coupon_amt between 825 and 825+1000\n or ss_wholesale_cost between 43 and 43+20)) B2,\n (select avg(ss_list_price) B3_LP\n ,count(ss_list_price) B3_CNT\n ,count(distinct ss_list_price) B3_CNTD\n from store_sales\n where ss_quantity between 11 and 15\n and (ss_list_price between 74 and 74+10\n or ss_coupon_amt between 4381 and 4381+1000\n or ss_wholesale_cost between 57 and 57+20)) B3,\n (select avg(ss_list_price) B4_LP\n ,count(ss_list_price) B4_CNT\n ,count(distinct ss_list_price) B4_CNTD\n from store_sales\n where ss_quantity between 16 and 20\n and (ss_list_price between 89 and 89+10\n or ss_coupon_amt between 3117 and 3117+1000\n or ss_wholesale_cost between 68 and 68+20)) B4,\n (select avg(ss_list_price) B5_LP\n ,count(ss_list_price) B5_CNT\n ,count(distinct ss_list_price) B5_CNTD\n from store_sales\n where ss_quantity between 21 and 25\n and (ss_list_price between 58 and 58+10\n or ss_coupon_amt between 9402 and 9402+1000\n or ss_wholesale_cost between 38 and 38+20)) B5,\n (select avg(ss_list_price) B6_LP\n ,count(ss_list_price) B6_CNT\n ,count(distinct ss_list_price) B6_CNTD\n from store_sales\n where ss_quantity between 26 and 30\n and (ss_list_price between 64 and 64+10\n or ss_coupon_amt between 5792 and 5792+1000\n or ss_wholesale_cost between 73 and 73+20)) B6\nlimit 100;\n\n", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "hOwwK71HfIcN1JzhcA3SnQ==", "id": "test-project-364309:europe-west1.query28_1665777227", "jobReference": { "jobId": "query28_1665777227", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query28_1665777227?location=europe-west1", "statistics": { "creationTime": "1665777227815", "endTime": "1665777228567", "finalExecutionDurationMs": "498", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "154024832", "performanceInsights": { "avgPreviousExecutionMs": "535" }, "queryPlan": [ { "completedParallelInputs": "6", "computeMsAvg": "70", "computeMsMax": "82", "computeRatioAvg": 0.6306306306306306, "computeRatioMax": 0.7387387387387387, "endMs": "1665777228059", "id": "0", "name": "S00: Input", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "21", "readRatioAvg": 0.15315315315315314, "readRatioMax": 0.1891891891891892, "recordsRead": "2880404", "recordsWritten": "24650", "shuffleOutputBytes": "887304", "shuffleOutputBytesSpilled": "0", "slotMs": "464", "startMs": "1665777227979", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$52:ss_list_price, $50:ss_quantity, $51:ss_wholesale_cost, $53:ss_coupon_amt", "FROM store_sales", "WHERE and(between($50, 6, 10), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $830 := $770, $831 := $730", "$690 := SHARD_AVG($731)", "$691 := COUNT($731)" ] }, { "kind": "COMPUTE", "substeps": [ "$730 := if(equal($770, 1), $52, NULL)", "$731 := if(equal($770, 0), $52, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$760 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$690, $691, $831, $830", "TO __stage00_output", "BY HASH($830, $831)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.04504504504504504, "writeRatioMax": 0.05405405405405406 }, { "completedParallelInputs": "6", "computeMsAvg": "62", "computeMsMax": "81", "computeRatioAvg": 0.5585585585585585, "computeRatioMax": 0.7297297297297297, "endMs": "1665777228047", "id": "1", "name": "S01: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "20", "readRatioAvg": 0.14414414414414414, "readRatioMax": 0.18018018018018017, "recordsRead": "2880404", "recordsWritten": "21915", "shuffleOutputBytes": "788844", "shuffleOutputBytesSpilled": "0", "slotMs": "385", "startMs": "1665777227983", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$42:ss_list_price, $40:ss_quantity, $41:ss_wholesale_cost, $43:ss_coupon_amt", "FROM store_sales", "WHERE and(between($40, 0, 5), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $780 := $750, $781 := $720", "$680 := SHARD_AVG($721)", "$681 := COUNT($721)" ] }, { "kind": "COMPUTE", "substeps": [ "$720 := if(equal($750, 1), $42, NULL)", "$721 := if(equal($750, 0), $42, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$740 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$680, $681, $781, $780", "TO __stage01_output", "BY HASH($780, $781)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "5", "writeMsMax": "6", "writeRatioAvg": 0.04504504504504504, "writeRatioMax": 0.05405405405405406 }, { "completedParallelInputs": "6", "computeMsAvg": "68", "computeMsMax": "81", "computeRatioAvg": 0.6126126126126126, "computeRatioMax": 0.7297297297297297, "endMs": "1665777228071", "id": "2", "name": "S02: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.14414414414414414, "readRatioMax": 0.17117117117117117, "recordsRead": "2880404", "recordsWritten": "22409", "shuffleOutputBytes": "806628", "shuffleOutputBytesSpilled": "0", "slotMs": "445", "startMs": "1665777227997", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$32:ss_list_price, $30:ss_quantity, $31:ss_wholesale_cost, $33:ss_coupon_amt", "FROM store_sales", "WHERE and(between($30, 11, 15), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $890 := $710, $891 := $670", "$620 := SHARD_AVG($671)", "$621 := COUNT($671)" ] }, { "kind": "COMPUTE", "substeps": [ "$670 := if(equal($710, 1), $32, NULL)", "$671 := if(equal($710, 0), $32, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$700 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$620, $621, $891, $890", "TO __stage02_output", "BY HASH($890, $891)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.06306306306306306, "writeRatioMax": 0.06306306306306306 }, { "completedParallelInputs": "6", "computeMsAvg": "77", "computeMsMax": "111", "computeRatioAvg": 0.6936936936936937, "computeRatioMax": 1, "endMs": "1665777228100", "id": "3", "name": "S03: Input", "parallelInputs": "6", "readMsAvg": "17", "readMsMax": "21", "readRatioAvg": 0.15315315315315314, "readRatioMax": 0.1891891891891892, "recordsRead": "2880404", "recordsWritten": "23321", "shuffleOutputBytes": "839460", "shuffleOutputBytesSpilled": "0", "slotMs": "517", "startMs": "1665777228011", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$22:ss_list_price, $20:ss_quantity, $21:ss_wholesale_cost, $23:ss_coupon_amt", "FROM store_sales", "WHERE and(between($20, 16, 20), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $950 := $640, $951 := $570", "$530 := SHARD_AVG($571)", "$531 := COUNT($571)" ] }, { "kind": "COMPUTE", "substeps": [ "$570 := if(equal($640, 1), $22, NULL)", "$571 := if(equal($640, 0), $22, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$630 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$530, $531, $951, $950", "TO __stage03_output", "BY HASH($950, $951)" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.018018018018018018, "writeMsAvg": "7", "writeMsMax": "9", "writeRatioAvg": 0.06306306306306306, "writeRatioMax": 0.08108108108108109 }, { "completedParallelInputs": "6", "computeMsAvg": "63", "computeMsMax": "78", "computeRatioAvg": 0.5675675675675675, "computeRatioMax": 0.7027027027027027, "endMs": "1665777228091", "id": "4", "name": "S04: Input", "parallelInputs": "6", "readMsAvg": "16", "readMsMax": "19", "readRatioAvg": 0.14414414414414414, "readRatioMax": 0.17117117117117117, "recordsRead": "2880404", "recordsWritten": "20177", "shuffleOutputBytes": "726276", "shuffleOutputBytesSpilled": "0", "slotMs": "412", "startMs": "1665777228025", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$12:ss_list_price, $10:ss_quantity, $11:ss_wholesale_cost, $13:ss_coupon_amt", "FROM store_sales", "WHERE and(between($10, 21, 25), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1010 := $550, $1011 := $460", "$400 := SHARD_AVG($461)", "$401 := COUNT($461)" ] }, { "kind": "COMPUTE", "substeps": [ "$460 := if(equal($550, 1), $12, NULL)", "$461 := if(equal($550, 0), $12, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$540 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$400, $401, $1011, $1010", "TO __stage04_output", "BY HASH($1010, $1011)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "7", "writeMsMax": "8", "writeRatioAvg": 0.06306306306306306, "writeRatioMax": 0.07207207207207207 }, { "completedParallelInputs": "6", "computeMsAvg": "67", "computeMsMax": "98", "computeRatioAvg": 0.6036036036036037, "computeRatioMax": 0.8828828828828829, "endMs": "1665777228139", "id": "5", "name": "S05: Input", "parallelInputs": "6", "readMsAvg": "19", "readMsMax": "35", "readRatioAvg": 0.17117117117117117, "readRatioMax": 0.3153153153153153, "recordsRead": "2880404", "recordsWritten": "26095", "shuffleOutputBytes": "939324", "shuffleOutputBytesSpilled": "0", "slotMs": "491", "startMs": "1665777228039", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$3:ss_list_price, $1:ss_quantity, $2:ss_wholesale_cost, $4:ss_coupon_amt", "FROM store_sales", "WHERE and(between($1, 26, 30), ...)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1080 := $420, $1081 := $330", "$300 := SHARD_AVG($331)", "$301 := COUNT($331)" ] }, { "kind": "COMPUTE", "substeps": [ "$330 := if(equal($420, 1), $3, NULL)", "$331 := if(equal($420, 0), $3, NULL)" ] }, { "kind": "COMPUTE", "substeps": [ "$410 := ARRAY<...>" ] }, { "kind": "WRITE", "substeps": [ "$300, $301, $1081, $1080", "TO __stage05_output", "BY HASH($1080, $1081)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "8", "writeMsMax": "13", "writeRatioAvg": 0.07207207207207207, "writeRatioMax": 0.11711711711711711 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.15315315315315314, "computeRatioMax": 0.15315315315315314, "endMs": "1665777228100", "id": "6", "inputStages": [ "1" ], "name": "S06: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "21915", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777228066", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$680, $681, $781, $780", "FROM __stage01_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $800 := $790", "$580 := COUNT($602)", "$581 := ANY_VALUE($601)", "$582 := ANY_VALUE($600)" ] }, { "kind": "COMPUTE", "substeps": [ "$600 := if(equal($790, 0), $651, NULL)", "$601 := if(equal($790, 0), $650, NULL)", "$602 := if(equal($790, 1), $791, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $790 := $780, $791 := $781", "$650 := ROOT_AVG($680)", "$651 := SUM_OF_COUNTS($681)" ] }, { "kind": "WRITE", "substeps": [ "$580, $581, $582, $800", "TO __stage06_output", "BY HASH($800)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.08108108108108109, "writeRatioMax": 0.08108108108108109 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.22522522522522523, "computeRatioMax": 0.22522522522522523, "endMs": "1665777228129", "id": "7", "inputStages": [ "0" ], "name": "S07: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "24650", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665777228083", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$690, $691, $831, $830", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $850 := $840", "$590 := COUNT($612)", "$591 := ANY_VALUE($611)", "$592 := ANY_VALUE($610)" ] }, { "kind": "COMPUTE", "substeps": [ "$610 := if(equal($840, 0), $661, NULL)", "$611 := if(equal($840, 0), $660, NULL)", "$612 := if(equal($840, 1), $841, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $840 := $830, $841 := $831", "$660 := ROOT_AVG($690)", "$661 := SUM_OF_COUNTS($691)" ] }, { "kind": "WRITE", "substeps": [ "$590, $591, $592, $850", "TO __stage07_output", "BY HASH($850)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.09009009009009009, "writeRatioMax": 0.09009009009009009 }, { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.1891891891891892, "computeRatioMax": 0.1891891891891892, "endMs": "1665777228134", "id": "8", "inputStages": [ "2" ], "name": "S08: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "22409", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665777228099", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$620, $621, $891, $890", "FROM __stage02_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $910 := $900", "$490 := COUNT($522)", "$491 := ANY_VALUE($521)", "$492 := ANY_VALUE($520)" ] }, { "kind": "COMPUTE", "substeps": [ "$520 := if(equal($900, 0), $561, NULL)", "$521 := if(equal($900, 0), $560, NULL)", "$522 := if(equal($900, 1), $901, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $900 := $890, $901 := $891", "$560 := ROOT_AVG($620)", "$561 := SUM_OF_COUNTS($621)" ] }, { "kind": "WRITE", "substeps": [ "$490, $491, $492, $910", "TO __stage08_output", "BY HASH($910)" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "21", "writeMsMax": "21", "writeRatioAvg": 0.1891891891891892, "writeRatioMax": 0.1891891891891892 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.14414414414414414, "computeRatioMax": 0.14414414414414414, "endMs": "1665777228152", "id": "9", "inputStages": [ "4" ], "name": "S09: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "20177", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777228116", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$400, $401, $1011, $1010", "FROM __stage04_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1030 := $1020", "$250 := COUNT($292)", "$251 := ANY_VALUE($291)", "$252 := ANY_VALUE($290)" ] }, { "kind": "COMPUTE", "substeps": [ "$290 := if(equal($1020, 0), $321, NULL)", "$291 := if(equal($1020, 0), $320, NULL)", "$292 := if(equal($1020, 1), $1021, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1020 := $1010, $1021 := $1011", "$320 := ROOT_AVG($400)", "$321 := SUM_OF_COUNTS($401)" ] }, { "kind": "WRITE", "substeps": [ "$250, $251, $252, $1030", "TO __stage09_output", "BY HASH($1030)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.09009009009009009, "writeRatioMax": 0.09009009009009009 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.26126126126126126, "computeRatioMax": 0.26126126126126126, "endMs": "1665777228172", "id": "10", "inputStages": [ "3" ], "name": "S0A: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "23321", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665777228131", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$530, $531, $951, $950", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $970 := $960", "$370 := COUNT($392)", "$371 := ANY_VALUE($391)", "$372 := ANY_VALUE($390)" ] }, { "kind": "COMPUTE", "substeps": [ "$390 := if(equal($960, 0), $451, NULL)", "$391 := if(equal($960, 0), $450, NULL)", "$392 := if(equal($960, 1), $961, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $960 := $950, $961 := $951", "$450 := ROOT_AVG($530)", "$451 := SUM_OF_COUNTS($531)" ] }, { "kind": "WRITE", "substeps": [ "$370, $371, $372, $970", "TO __stage0A_output", "BY HASH($970)" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.018018018018018018, "waitRatioMax": 0.018018018018018018, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.07207207207207207, "writeRatioMax": 0.07207207207207207 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06306306306306306, "computeRatioMax": 0.06306306306306306, "endMs": "1665777228170", "id": "11", "inputStages": [ "6" ], "name": "S0B: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777228133", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$580, $581, $582, $800", "FROM __stage06_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$430 := ANY_VALUE($472)", "$431 := ANY_VALUE($471)", "$432 := ANY_VALUE($470)" ] }, { "kind": "COMPUTE", "substeps": [ "$470 := if(equal($810, 0), $502, NULL)", "$471 := if(equal($810, 0), $501, NULL)", "$472 := if(equal($810, 1), $500, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $810 := $800", "$500 := SUM_OF_COUNTS($580)", "$501 := ANY_VALUE($581)", "$502 := ANY_VALUE($582)" ] }, { "kind": "WRITE", "substeps": [ "$430, $431, $432", "TO __stage0B_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.018018018018018018, "waitRatioMax": 0.018018018018018018, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.14414414414414414, "writeRatioMax": 0.14414414414414414 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.07207207207207207, "computeRatioMax": 0.07207207207207207, "endMs": "1665777228188", "id": "12", "inputStages": [ "11" ], "name": "S0C: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "53", "startMs": "1665777228132", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$430, $431, $432", "FROM __stage0B_output" ] }, { "kind": "COMPUTE", "substeps": [ "$260 := if(is_null($342), 0, $342)", "$261 := if(is_null($340), 0, $340)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$340 := ANY_VALUE($430)", "$341 := ANY_VALUE($431)", "$342 := ANY_VALUE($432)" ] }, { "kind": "WRITE", "substeps": [ "$260, $261, $341", "TO __stage0C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "3", "writeMsMax": "3", "writeRatioAvg": 0.02702702702702703, "writeRatioMax": 0.02702702702702703 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09009009009009009, "computeRatioMax": 0.09009009009009009, "endMs": "1665777228180", "id": "13", "inputStages": [ "7" ], "name": "S0D: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "59", "startMs": "1665777228135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$590, $591, $592, $850", "FROM __stage07_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$440 := ANY_VALUE($482)", "$441 := ANY_VALUE($481)", "$442 := ANY_VALUE($480)" ] }, { "kind": "COMPUTE", "substeps": [ "$480 := if(equal($860, 0), $512, NULL)", "$481 := if(equal($860, 0), $511, NULL)", "$482 := if(equal($860, 1), $510, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $860 := $850", "$510 := SUM_OF_COUNTS($590)", "$511 := ANY_VALUE($591)", "$512 := ANY_VALUE($592)" ] }, { "kind": "WRITE", "substeps": [ "$440, $441, $442", "TO __stage0D_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.018018018018018018, "waitRatioMax": 0.018018018018018018, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.25225225225225223, "writeRatioMax": 0.25225225225225223 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09009009009009009, "computeRatioMax": 0.09009009009009009, "endMs": "1665777228196", "id": "14", "inputStages": [ "13" ], "name": "S0E: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777228135", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$440, $441, $442", "FROM __stage0D_output" ] }, { "kind": "COMPUTE", "substeps": [ "$270 := if(is_null($352), 0, $352)", "$271 := if(is_null($350), 0, $350)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$350 := ANY_VALUE($440)", "$351 := ANY_VALUE($441)", "$352 := ANY_VALUE($442)" ] }, { "kind": "WRITE", "substeps": [ "$270, $271, $351", "TO __stage0E_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.018018018018018018, "waitRatioMax": 0.018018018018018018, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.036036036036036036, "writeRatioMax": 0.036036036036036036 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0990990990990991, "computeRatioMax": 0.0990990990990991, "endMs": "1665777228178", "id": "15", "inputStages": [ "8" ], "name": "S0F: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "32", "startMs": "1665777228139", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$490, $491, $492, $910", "FROM __stage08_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$310 := ANY_VALUE($362)", "$311 := ANY_VALUE($361)", "$312 := ANY_VALUE($360)" ] }, { "kind": "COMPUTE", "substeps": [ "$360 := if(equal($920, 0), $382, NULL)", "$361 := if(equal($920, 0), $381, NULL)", "$362 := if(equal($920, 1), $380, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $920 := $910", "$380 := SUM_OF_COUNTS($490)", "$381 := ANY_VALUE($491)", "$382 := ANY_VALUE($492)" ] }, { "kind": "WRITE", "substeps": [ "$310, $311, $312", "TO __stage0F_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.12612612612612611, "writeRatioMax": 0.12612612612612611 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.09009009009009009, "computeRatioMax": 0.09009009009009009, "endMs": "1665777228186", "id": "16", "inputStages": [ "15" ], "name": "S10: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "50", "startMs": "1665777228140", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$310, $311, $312", "FROM __stage0F_output" ] }, { "kind": "COMPUTE", "substeps": [ "$180 := if(is_null($232), 0, $232)", "$181 := if(is_null($230), 0, $230)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$230 := ANY_VALUE($310)", "$231 := ANY_VALUE($311)", "$232 := ANY_VALUE($312)" ] }, { "kind": "WRITE", "substeps": [ "$180, $181, $231", "TO __stage10_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.018018018018018018, "waitRatioMax": 0.018018018018018018, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.018018018018018018, "writeRatioMax": 0.018018018018018018 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.2072072072072072, "computeRatioMax": 0.2072072072072072, "endMs": "1665777228202", "id": "17", "inputStages": [ "5" ], "name": "S11: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "26095", "recordsWritten": "2", "shuffleOutputBytes": "64", "shuffleOutputBytesSpilled": "0", "slotMs": "43", "startMs": "1665777228161", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$300, $301, $1081, $1080", "FROM __stage05_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1100 := $1090", "$170 := COUNT($202)", "$171 := ANY_VALUE($201)", "$172 := ANY_VALUE($200)" ] }, { "kind": "COMPUTE", "substeps": [ "$200 := if(equal($1090, 0), $221, NULL)", "$201 := if(equal($1090, 0), $220, NULL)", "$202 := if(equal($1090, 1), $1091, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1090 := $1080, $1091 := $1081", "$220 := ROOT_AVG($300)", "$221 := SUM_OF_COUNTS($301)" ] }, { "kind": "WRITE", "substeps": [ "$170, $171, $172, $1100", "TO __stage11_output", "BY HASH($1100)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.06306306306306306, "writeRatioMax": 0.06306306306306306 }, { "completedParallelInputs": "1", "computeMsAvg": "17", "computeMsMax": "17", "computeRatioAvg": 0.15315315315315314, "computeRatioMax": 0.15315315315315314, "endMs": "1665777228202", "id": "18", "inputStages": [ "9" ], "name": "S12: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777228165", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$250, $251, $252, $1030", "FROM __stage09_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$140 := ANY_VALUE($162)", "$141 := ANY_VALUE($161)", "$142 := ANY_VALUE($160)" ] }, { "kind": "COMPUTE", "substeps": [ "$160 := if(equal($1040, 0), $192, NULL)", "$161 := if(equal($1040, 0), $191, NULL)", "$162 := if(equal($1040, 1), $190, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1040 := $1030", "$190 := SUM_OF_COUNTS($250)", "$191 := ANY_VALUE($251)", "$192 := ANY_VALUE($252)" ] }, { "kind": "WRITE", "substeps": [ "$140, $141, $142", "TO __stage12_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.12612612612612611, "writeRatioMax": 0.12612612612612611 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06306306306306306, "computeRatioMax": 0.06306306306306306, "endMs": "1665777228207", "id": "19", "inputStages": [ "18" ], "name": "S13: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665777228167", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$140, $141, $142", "FROM __stage12_output" ] }, { "kind": "COMPUTE", "substeps": [ "$80 := if(is_null($102), 0, $102)", "$81 := if(is_null($100), 0, $100)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$100 := ANY_VALUE($140)", "$101 := ANY_VALUE($141)", "$102 := ANY_VALUE($142)" ] }, { "kind": "WRITE", "substeps": [ "$80, $81, $101", "TO __stage13_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.018018018018018018, "waitRatioMax": 0.018018018018018018, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.018018018018018018, "writeRatioMax": 0.018018018018018018 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.06306306306306306, "computeRatioMax": 0.06306306306306306, "endMs": "1665777228219", "id": "20", "inputStages": [ "10" ], "name": "S14: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777228184", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$370, $371, $372, $970", "FROM __stage0A_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$210 := ANY_VALUE($242)", "$211 := ANY_VALUE($241)", "$212 := ANY_VALUE($240)" ] }, { "kind": "COMPUTE", "substeps": [ "$240 := if(equal($980, 0), $282, NULL)", "$241 := if(equal($980, 0), $281, NULL)", "$242 := if(equal($980, 1), $280, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $980 := $970", "$280 := SUM_OF_COUNTS($370)", "$281 := ANY_VALUE($371)", "$282 := ANY_VALUE($372)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $212", "TO __stage14_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.12612612612612611, "writeRatioMax": 0.12612612612612611 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.08108108108108109, "computeRatioMax": 0.08108108108108109, "endMs": "1665777228250", "id": "21", "inputStages": [ "20" ], "name": "S15: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "57", "startMs": "1665777228185", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $212", "FROM __stage14_output" ] }, { "kind": "COMPUTE", "substeps": [ "$120 := if(is_null($152), 0, $152)", "$121 := if(is_null($150), 0, $150)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$150 := ANY_VALUE($210)", "$151 := ANY_VALUE($211)", "$152 := ANY_VALUE($212)" ] }, { "kind": "WRITE", "substeps": [ "$120, $121, $151", "TO __stage15_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.018018018018018018, "waitRatioMax": 0.018018018018018018, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0990990990990991, "writeRatioMax": 0.0990990990990991 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.13513513513513514, "computeRatioMax": 0.13513513513513514, "endMs": "1665777228247", "id": "22", "inputStages": [ "14", "12" ], "name": "S16: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "70", "shuffleOutputBytesSpilled": "0", "slotMs": "44", "startMs": "1665777228202", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$260, $261, $341", "FROM __stage0C_output" ] }, { "kind": "READ", "substeps": [ "$270, $271, $351", "FROM __stage0E_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$870 := $260, $871 := $261, $872 := $341, $873 := $270, $874 := $271, $875 := $351", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$870, $871, $873, $874, $872, $875", "TO __stage16_output" ] } ], "waitMsAvg": "0", "waitMsMax": "0", "waitRatioAvg": 0, "waitRatioMax": 0, "writeMsAvg": "28", "writeMsMax": "28", "writeRatioAvg": 0.25225225225225223, "writeRatioMax": 0.25225225225225223 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.08108108108108109, "computeRatioMax": 0.08108108108108109, "endMs": "1665777228256", "id": "23", "inputStages": [ "17" ], "name": "S17: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "35", "startMs": "1665777228217", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$170, $171, $172, $1100", "FROM __stage11_output" ] }, { "kind": "AGGREGATE", "substeps": [ "$90 := ANY_VALUE($112)", "$91 := ANY_VALUE($111)", "$92 := ANY_VALUE($110)" ] }, { "kind": "COMPUTE", "substeps": [ "$110 := if(equal($1110, 0), $132, NULL)", "$111 := if(equal($1110, 0), $131, NULL)", "$112 := if(equal($1110, 1), $130, NULL)" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $1110 := $1100", "$130 := SUM_OF_COUNTS($170)", "$131 := ANY_VALUE($171)", "$132 := ANY_VALUE($172)" ] }, { "kind": "WRITE", "substeps": [ "$90, $91, $92", "TO __stage17_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "26", "writeMsMax": "26", "writeRatioAvg": 0.23423423423423423, "writeRatioMax": 0.23423423423423423 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.04504504504504504, "computeRatioMax": 0.04504504504504504, "endMs": "1665777228272", "id": "24", "inputStages": [ "23" ], "name": "S18: Aggregate+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1", "recordsWritten": "1", "shuffleOutputBytes": "35", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665777228219", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$90, $91, $92", "FROM __stage17_output" ] }, { "kind": "COMPUTE", "substeps": [ "$60 := if(is_null($72), 0, $72)", "$61 := if(is_null($70), 0, $70)" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "AGGREGATE", "substeps": [ "$70 := ANY_VALUE($90)", "$71 := ANY_VALUE($91)", "$72 := ANY_VALUE($92)" ] }, { "kind": "WRITE", "substeps": [ "$60, $61, $71", "TO __stage18_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.02702702702702703, "waitRatioMax": 0.02702702702702703, "writeMsAvg": "2", "writeMsMax": "2", "writeRatioAvg": 0.018018018018018018, "writeRatioMax": 0.018018018018018018 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.05405405405405406, "computeRatioMax": 0.05405405405405406, "endMs": "1665777228295", "id": "25", "inputStages": [ "22", "16" ], "name": "S19: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "105", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665777228259", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$870, $871, $873, $874, $872, $875", "FROM __stage16_output" ] }, { "kind": "READ", "substeps": [ "$180, $181, $231", "FROM __stage10_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$930 := $870, $931 := $871, $932 := $873, $933 := $874, $934 := $872, $935 := $875, $936 := $180, $937 := $181, $938 := $231", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "TO __stage19_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.12612612612612611, "writeRatioMax": 0.12612612612612611 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0990990990990991, "computeRatioMax": 0.0990990990990991, "endMs": "1665777228356", "id": "26", "inputStages": [ "25", "21" ], "name": "S1A: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "140", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665777228311", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$936, $937, $938, $930, $931, $932, $933, $934, $935", "FROM __stage19_output" ] }, { "kind": "READ", "substeps": [ "$120, $121, $151", "FROM __stage15_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$990 := $936, $991 := $937, $992 := $938, $993 := $930, $994 := $931, $995 := $932, $996 := $933, $997 := $934, $998 := $935, $999 := $120, $1000 := $121, $1001 := $151", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "TO __stage1A_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.11711711711711711, "writeRatioMax": 0.11711711711711711 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.11711711711711711, "computeRatioMax": 0.11711711711711711, "endMs": "1665777228390", "id": "27", "inputStages": [ "19", "26" ], "name": "S1B: Join+", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "175", "shuffleOutputBytesSpilled": "0", "slotMs": "24", "startMs": "1665777228362", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$999, $1000, $1001, $990, $991, $992, $993, $994, $995, $996, $997, $998", "FROM __stage1A_output" ] }, { "kind": "READ", "substeps": [ "$80, $81, $101", "FROM __stage13_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1050 := $999, $1051 := $1000, $1052 := $1001, $1053 := $990, $1054 := $991, $1055 := $992, $1056 := $993, $1057 := $994, $1058 := $995, $1059 := $996, $1060 := $997, $1061 := $998, $1062 := $80, $1063 := $81, $1064 := $101", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "TO __stage1B_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.0990990990990991, "writeRatioMax": 0.0990990990990991 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.0990990990990991, "computeRatioMax": 0.0990990990990991, "endMs": "1665777228450", "id": "28", "inputStages": [ "27", "24" ], "name": "S1C: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "2", "recordsWritten": "1", "shuffleOutputBytes": "195", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665777228416", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1062, $1063, $1064, $1050, $1051, $1052, $1053, $1054, $1055, $1056, $1057, $1058, $1059, $1060, $1061", "FROM __stage1B_output" ] }, { "kind": "READ", "substeps": [ "$60, $61, $71", "FROM __stage18_output" ] }, { "kind": "LIMIT", "substeps": [ "100" ] }, { "kind": "JOIN", "substeps": [ "$1120 := $1062, $1121 := $1063, $1122 := $1064, $1123 := $1050, $1124 := $1051, $1125 := $1052, $1126 := $1053, $1127 := $1054, $1128 := $1055, $1129 := $1056, $1130 := $1057, $1131 := $1058, $1132 := $1059, $1133 := $1060, $1134 := $1061, $1135 := $60", "CROSS ALL WITH ALL " ] }, { "kind": "WRITE", "substeps": [ "$1135, $1136, $1137, $1120, $1121, $1122, $1123, $1124, $1125, $1126, $1127, $1128, $1129, $1130, $1131, $1132", "TO __stage1C_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.009009009009009009, "waitRatioMax": 0.009009009009009009, "writeMsAvg": "20", "writeMsMax": "20", "writeRatioAvg": 0.18018018018018017, "writeRatioMax": 0.18018018018018017 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "store_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "59", "elapsedMs": "650", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "3664" } ], "totalBytesBilled": "154140672", "totalBytesProcessed": "154024832", "totalPartitionsProcessed": "0", "totalSlotMs": "3664", "transferredBytes": "0" }, "startTime": "1665777227860", "totalBytesProcessed": "154024832", "totalSlotMs": "3664" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
